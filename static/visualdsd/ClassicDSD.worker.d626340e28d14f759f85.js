!function(e){var t={};function n(h){if(t[h])return t[h].exports;var r=t[h]={i:h,l:!1,exports:{}};return e[h].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,h){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:h})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var h=Object.create(null);if(n.r(h),Object.defineProperty(h,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(h,r,function(t){return e[t]}.bind(null,r));return h},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=8)}([function(e,t){var n,h,r=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function f(){throw new Error("clearTimeout has not been defined")}function o(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(e){n=i}try{h="function"==typeof clearTimeout?clearTimeout:f}catch(e){h=f}}();var a,u=[],c=!1,s=-1;function $(){c&&a&&(c=!1,a.length?u=a.concat(u):s=-1,u.length&&l())}function l(){if(!c){var e=o($);c=!0;for(var t=u.length;t;){for(a=u,u=[];++s<t;)a&&a[s].run();s=-1,t=u.length}a=null,c=!1,function(e){if(h===clearTimeout)return clearTimeout(e);if((h===f||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(e);try{h(e)}catch(t){try{return h.call(null,e)}catch(t){return h.call(this,e)}}}(e)}}function C(e,t){this.fun=e,this.array=t}function d(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new C(e,t)),1!==u.length||c||o(l)},C.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=d,r.addListener=d,r.once=d,r.off=d,r.removeListener=d,r.removeAllListeners=d,r.emit=d,r.prependListener=d,r.prependOnceListener=d,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(e,t,n){(function(t){e.exports=function(e){var h,r=void 0!==(e=e||{})?e:{},i={};for(h in r)r.hasOwnProperty(h)&&(i[h]=r[h]);r.arguments=[],r.thisProgram="./this.program",r.quit=function(e,t){throw t},r.preRun=[],r.postRun=[];var f,o,a=!1,u=!1,c=!1,s=!1;if(r.ENVIRONMENT)if("WEB"===r.ENVIRONMENT)a=!0;else if("WORKER"===r.ENVIRONMENT)u=!0;else if("NODE"===r.ENVIRONMENT)c=!0;else{if("SHELL"!==r.ENVIRONMENT)throw new Error("Module['ENVIRONMENT'] value is not valid. must be one of: WEB|WORKER|NODE|SHELL.");s=!0}else a="object"==typeof window,u="function"==typeof importScripts,c="object"==typeof t&&!a&&!u,s=!a&&!c&&!u;if(c)r.read=function(e,t){var h;return f||(f=n(4)),o||(o=n(5)),e=o.normalize(e),h=f.readFileSync(e),t?h:h.toString()},r.readBinary=function(e){var t=r.read(e,!0);return t.buffer||(t=new Uint8Array(t)),m(t.buffer),t},t.argv.length>1&&(r.thisProgram=t.argv[1].replace(/\\/g,"/")),r.arguments=t.argv.slice(2),t.on("uncaughtException",(function(e){if(!(e instanceof rn))throw e})),t.on("unhandledRejection",(function(e,n){t.exit(1)})),r.inspect=function(){return"[Emscripten Module object]"};else if(s)"undefined"!=typeof read&&(r.read=function(e){return read(e)}),r.readBinary=function(e){var t;return"function"==typeof readbuffer?new Uint8Array(readbuffer(e)):(m("object"==typeof(t=read(e,"binary"))),t)},"undefined"!=typeof scriptArgs?r.arguments=scriptArgs:void 0!==arguments&&(r.arguments=arguments),"function"==typeof quit&&(r.quit=function(e,t){quit(e)});else{if(!a&&!u)throw new Error("not compiled for this environment");r.read=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},u&&(r.readBinary=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),r.readAsync=function(e,t,n){var h=new XMLHttpRequest;h.open("GET",e,!0),h.responseType="arraybuffer",h.onload=function(){200==h.status||0==h.status&&h.response?t(h.response):n()},h.onerror=n,h.send(null)},r.setWindowTitle=function(e){document.title=e}}for(h in r.print="undefined"!=typeof console?console.log.bind(console):"undefined"!=typeof print?print:null,r.printErr="undefined"!=typeof printErr?printErr:"undefined"!=typeof console&&console.warn.bind(console)||r.print,r.print=r.print,r.printErr=r.printErr,i)i.hasOwnProperty(h)&&(r[h]=i[h]);i=void 0;var $=16;function l(e){m(!X);var t=P;return P=P+e+15&-16,t}function C(e,t){return t||(t=$),e=Math.ceil(e/t)*t}var d=1,A=new Array(5);function T(e,t){for(var n=0;n<5;n++)if(!A[n])return A[n]=e,d+n;throw"Finished up all reserved function pointers. Use a higher value for RESERVED_FUNCTION_POINTERS."}function p(e){A[e-d]=null}var _=1024,b=0;function m(e,t){e||an("Assertion failed: "+t)}function g(e){var t=r["_"+e];return m(t,"Cannot call unknown function "+e+", make sure it is exported"),t}var I={stackSave:function(){hn()},stackRestore:function(){nn()},arrayToC:function(e){var t=tn(e.length);return Ae(e,t),t},stringToC:function(e){var t=0;if(null!=e&&0!==e){var n=1+(e.length<<2);y(e,t=tn(n),n)}return t}},J={string:I.stringToC,array:I.arrayToC};function L(e,t,n,h,r){var i=g(e),f=[],o=0;if(h)for(var a=0;a<h.length;a++){var u=J[n[a]];u?(0===o&&(o=hn()),f[a]=u(h[a])):f[a]=h[a]}var c=i.apply(null,f);return"string"===t?c=N(c):"boolean"===t&&(c=Boolean(c)),0!==o&&nn(o),c}function K(e,t,n){n=n||[];var h=g(e),r=n.every((function(e){return"number"===e}));return"string"!==t&&r?h:function(){return L(e,t,n,arguments)}}function N(e,t){if(0===t||!e)return"";for(var n,h=0,r=0;h|=n=B[e+r>>0],(0!=n||t)&&(r++,!t||r!=t););t||(t=r);var i="";if(h<128){for(var f;t>0;)f=String.fromCharCode.apply(String,B.subarray(e,e+Math.min(t,1024))),i=i?i+f:f,e+=1024,t-=1024;return i}return D(e)}var v="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function w(e,t){for(var n=t;e[n];)++n;if(n-t>16&&e.subarray&&v)return v.decode(e.subarray(t,n));for(var h,r,i,f,o,a="";;){if(!(h=e[t++]))return a;if(128&h)if(r=63&e[t++],192!=(224&h))if(i=63&e[t++],224==(240&h)?h=(15&h)<<12|r<<6|i:(f=63&e[t++],240==(248&h)?h=(7&h)<<18|r<<12|i<<6|f:(o=63&e[t++],h=248==(252&h)?(3&h)<<24|r<<18|i<<12|f<<6|o:(1&h)<<30|r<<24|i<<18|f<<12|o<<6|63&e[t++])),h<65536)a+=String.fromCharCode(h);else{var u=h-65536;a+=String.fromCharCode(55296|u>>10,56320|1023&u)}else a+=String.fromCharCode((31&h)<<6|r);else a+=String.fromCharCode(h)}}function D(e){return w(B,e)}function M(e,t,n,h){if(!(h>0))return 0;for(var r=n,i=n+h-1,f=0;f<e.length;++f){var o=e.charCodeAt(f);if(o>=55296&&o<=57343&&(o=65536+((1023&o)<<10)|1023&e.charCodeAt(++f)),o<=127){if(n>=i)break;t[n++]=o}else if(o<=2047){if(n+1>=i)break;t[n++]=192|o>>6,t[n++]=128|63&o}else if(o<=65535){if(n+2>=i)break;t[n++]=224|o>>12,t[n++]=128|o>>6&63,t[n++]=128|63&o}else if(o<=2097151){if(n+3>=i)break;t[n++]=240|o>>18,t[n++]=128|o>>12&63,t[n++]=128|o>>6&63,t[n++]=128|63&o}else if(o<=67108863){if(n+4>=i)break;t[n++]=248|o>>24,t[n++]=128|o>>18&63,t[n++]=128|o>>12&63,t[n++]=128|o>>6&63,t[n++]=128|63&o}else{if(n+5>=i)break;t[n++]=252|o>>30,t[n++]=128|o>>24&63,t[n++]=128|o>>18&63,t[n++]=128|o>>12&63,t[n++]=128|o>>6&63,t[n++]=128|63&o}}return t[n]=0,n-r}function y(e,t,n){return M(e,B,t,n)}"undefined"!=typeof TextDecoder&&new TextDecoder("utf-16le");var R,E,B,G,S,O,P,X,k,F,j,x,U,Q=65536,W=16777216;function Y(e,t){return e%t>0&&(e+=t-e%t),e}function Z(e){r.buffer=R=e}function V(){r.HEAP8=E=new Int8Array(R),r.HEAP16=G=new Int16Array(R),r.HEAP32=S=new Int32Array(R),r.HEAPU8=B=new Uint8Array(R),r.HEAPU16=new Uint16Array(R),r.HEAPU32=new Uint32Array(R),r.HEAPF32=new Float32Array(R),r.HEAPF64=new Float64Array(R)}function H(){an("Cannot enlarge memory arrays. Either (1) compile with  -s TOTAL_MEMORY=X  with X higher than the current value "+ee+", (2) compile with  -s ALLOW_MEMORY_GROWTH=1  which allows increasing the size at runtime, or (3) if you want malloc to return NULL (0) instead of this abort, compile with  -s ABORTING_MALLOC=0 ")}function q(){H()}O=P=k=F=j=x=U=0,X=!1;var z=r.TOTAL_STACK||5242880,ee=r.TOTAL_MEMORY||16777216;function te(){return ee}if(ee<z&&r.printErr("TOTAL_MEMORY should be larger than TOTAL_STACK, was "+ee+"! (TOTAL_STACK="+z+")"),r.buffer?R=r.buffer:("object"==typeof WebAssembly&&"function"==typeof WebAssembly.Memory?(r.wasmMemory=new WebAssembly.Memory({initial:ee/Q,maximum:ee/Q}),R=r.wasmMemory.buffer):R=new ArrayBuffer(ee),r.buffer=R),V(),S[0]=1668509029,G[1]=25459,115!==B[2]||99!==B[3])throw"Runtime error: expected the system to be little-endian!";function ne(e){for(;e.length>0;){var t=e.shift();if("function"!=typeof t){var n=t.func;"number"==typeof n?void 0===t.arg?r.dynCall_v(n):r.dynCall_vi(n,t.arg):n(void 0===t.arg?null:t.arg)}else t()}}var he=[],re=[],ie=[],fe=[],oe=[],ae=!1;function ue(){if(r.preRun)for("function"==typeof r.preRun&&(r.preRun=[r.preRun]);r.preRun.length;)Ce(r.preRun.shift());ne(he)}function ce(){ae||(ae=!0,ne(re))}function se(){ne(ie)}function $e(){ne(fe),!0}function le(){if(r.postRun)for("function"==typeof r.postRun&&(r.postRun=[r.postRun]);r.postRun.length;)de(r.postRun.shift());ne(oe)}function Ce(e){he.unshift(e)}function de(e){oe.unshift(e)}function Ae(e,t){E.set(e,t)}var Te=Math.abs,pe=(Math.cos,Math.sin,Math.tan,Math.acos,Math.asin,Math.atan,Math.atan2,Math.exp,Math.log,Math.sqrt,Math.ceil,Math.floor,Math.pow,Math.imul,Math.fround,Math.round,Math.min,Math.max,Math.clz32,Math.trunc,0),_e=null,be=null;function me(e){pe++,r.monitorRunDependencies&&r.monitorRunDependencies(pe)}function ge(e){if(pe--,r.monitorRunDependencies&&r.monitorRunDependencies(pe),0==pe&&(null!==_e&&(clearInterval(_e),_e=null),be)){var t=be;be=null,t()}}r.preloadedImages={},r.preloadedAudios={};var Ie="data:application/octet-stream;base64,";function Je(e){return String.prototype.startsWith?e.startsWith(Ie):0===e.indexOf(Ie)}function Le(){var e="SundialsSolver.wast",t="SundialsSolver.wasm",n="SundialsSolver.temp.asm.js";"function"==typeof r.locateFile&&(Je(e)||(e=r.locateFile(e)),Je(t)||(t=r.locateFile(t)),Je(n)||(n=r.locateFile(n)));var h={global:null,env:null,asm2wasm:{"f64-rem":function(e,t){return e%t},debugger:function(){}},parent:r},i=null;function f(){try{if(r.wasmBinary)return new Uint8Array(r.wasmBinary);if(r.readBinary)return r.readBinary(t);throw"on the web, we need the wasm binary to be preloaded and set on Module['wasmBinary']. emcc.py will do that for you when generating HTML (but not JS)"}catch(e){an(e)}}function o(e,n,o){if("object"!=typeof WebAssembly)return r.printErr("no native wasm support detected"),!1;if(!(r.wasmMemory instanceof WebAssembly.Memory))return r.printErr("no native wasm Memory in use"),!1;function c(e,t){(i=e.exports).memory&&function(e){var t=r.buffer;e.byteLength<t.byteLength&&r.printErr("the new buffer in mergeMemory is smaller than the previous one. in native wasm, we should grow memory here");var n=new Int8Array(t);new Int8Array(e).set(n),Z(e),V()}(i.memory),r.asm=i,r.usingWasm=!0,ge()}if(n.memory=r.wasmMemory,h.global={NaN:NaN,Infinity:1/0},h["global.Math"]=Math,h.env=n,me(),r.instantiateWasm)try{return r.instantiateWasm(h,c)}catch(e){return r.printErr("Module.instantiateWasm callback failed with error: "+e),!1}function s(e){c(e.instance,e.module)}function $(e){(r.wasmBinary||!a&&!u||"function"!=typeof fetch?new Promise((function(e,t){e(f())})):fetch(t,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+t+"'";return e.arrayBuffer()})).catch((function(){return f()}))).then((function(e){return WebAssembly.instantiate(e,h)})).then(e).catch((function(e){r.printErr("failed to asynchronously prepare wasm: "+e),an(e)}))}return r.wasmBinary||"function"!=typeof WebAssembly.instantiateStreaming||Je(t)||"function"!=typeof fetch?$(s):WebAssembly.instantiateStreaming(fetch(t,{credentials:"same-origin"}),h).then(s).catch((function(e){r.printErr("wasm streaming compile failed: "+e),r.printErr("falling back to ArrayBuffer instantiation"),$(s)})),{}}r.asmPreload=r.asm;var c=r.reallocBuffer;r.reallocBuffer=function(e){return"asmjs"===s?c(e):function(e){e=Y(e,r.usingWasm?Q:W);var t=r.buffer.byteLength;if(r.usingWasm)try{return-1!==r.wasmMemory.grow((e-t)/65536)?r.buffer=r.wasmMemory.buffer:null}catch(e){return null}}(e)};var s="";r.asm=function(e,t,n){if(!(t=t).table){var h=r.wasmTableSize;void 0===h&&(h=1024);var i=r.wasmMaxTableSize;"object"==typeof WebAssembly&&"function"==typeof WebAssembly.Table?t.table=void 0!==i?new WebAssembly.Table({initial:h,maximum:i,element:"anyfunc"}):new WebAssembly.Table({initial:h,element:"anyfunc"}):t.table=new Array(h),r.wasmTable=t.table}var f;return t.memoryBase||(t.memoryBase=r.STATIC_BASE),t.tableBase||(t.tableBase=0),m(f=o(0,t),"no binaryen method succeeded."),f}}Le(),P=(O=_)+9728,re.push();var Ke=9728;r.STATIC_BASE=O,r.STATIC_BUMP=Ke;var Ne=P;function ve(e){return zt(e)}function we(){return!!we.uncaught_exception}P+=16;var De={last:0,caught:[],infos:{},deAdjust:function(e){if(!e||De.infos[e])return e;for(var t in De.infos){var n=+t;if(De.infos[n].adjusted===e)return n}return e},addRef:function(e){e&&De.infos[e].refcount++},decRef:function(e){if(e){var t=De.infos[e];m(t.refcount>0),t.refcount--,0!==t.refcount||t.rethrown||(t.destructor&&r.dynCall_vi(t.destructor,e),delete De.infos[e],___cxa_free_exception(e))}},clearRef:function(e){e&&(De.infos[e].refcount=0)}};function Me(e){var t=De.infos[e];return t&&!t.caught&&(t.caught=!0,we.uncaught_exception--),t&&(t.rethrown=!1),De.caught.push(e),De.addRef(De.deAdjust(e)),e}function ye(e){throw De.last||(De.last=e),e+" - Exception catching is disabled, this exception cannot be caught. Compile with -s DISABLE_EXCEPTION_CATCHING=0 or DISABLE_EXCEPTION_CATCHING=2 to catch."}function Re(){var e=De.last;if(!e)return 0|(en(0),0);var t=De.infos[e],n=t.type;if(!n)return 0|(en(0),e);var h=Array.prototype.slice.call(arguments);r.___cxa_is_pointer_type(n);Re.buffer||(Re.buffer=zt(4)),S[Re.buffer>>2]=e,e=Re.buffer;for(var i=0;i<h.length;i++)if(h[i]&&r.___cxa_can_catch(h[i],n,e))return e=S[e>>2],t.adjusted=e,0|(en(h[i]),e);return e=S[e>>2],0|(en(n),e)}function Ee(e,t,n){throw De.infos[e]={ptr:e,adjusted:e,type:t,destructor:n,refcount:0,caught:!1,rethrown:!1},De.last=e,"uncaught_exception"in we?we.uncaught_exception++:we.uncaught_exception=1,e+" - Exception catching is disabled, this exception cannot be caught. Compile with -s DISABLE_EXCEPTION_CATCHING=0 or DISABLE_EXCEPTION_CATCHING=2 to catch."}function Be(){}var Ge={varargs:0,get:function(e){return Ge.varargs+=4,S[Ge.varargs-4>>2]},getStr:function(){return N(Ge.get())},get64:function(){var e=Ge.get(),t=Ge.get();return m(e>=0?0===t:-1===t),e},getZero:function(){m(0===Ge.get())}};function Se(e,t){Ge.varargs=t;try{var n=Ge.getStreamFromFD(),h=(Ge.get(),Ge.get()),r=Ge.get(),i=Ge.get(),f=h;return FS.llseek(n,f,i),S[r>>2]=n.position,n.getdents&&0===f&&0===i&&(n.getdents=null),0}catch(e){return"undefined"!=typeof FS&&e instanceof FS.ErrnoError||an(e),-e.errno}}function Oe(){var e=r._fflush;e&&e(0);var t=Pe.printChar;if(t){var n=Pe.buffers;n[1].length&&t(1,10),n[2].length&&t(2,10)}}function Pe(e,t){Ge.varargs=t;try{var n=Ge.get(),h=Ge.get(),i=Ge.get(),f=0;Pe.buffers||(Pe.buffers=[null,[],[]],Pe.printChar=function(e,t){var n=Pe.buffers[e];m(n),0===t||10===t?((1===e?r.print:r.printErr)(w(n,0)),n.length=0):n.push(t)});for(var o=0;o<i;o++){for(var a=S[h+8*o>>2],u=S[h+(8*o+4)>>2],c=0;c<u;c++)Pe.printChar(n,B[a+c]);f+=u}return f}catch(e){return"undefined"!=typeof FS&&e instanceof FS.ErrnoError||an(e),-e.errno}}function Xe(e,t){Ge.varargs=t;try{return 0}catch(e){return"undefined"!=typeof FS&&e instanceof FS.ErrnoError||an(e),-e.errno}}function ke(e,t){Ge.varargs=t;try{var n=Ge.getStreamFromFD();return FS.close(n),0}catch(e){return"undefined"!=typeof FS&&e instanceof FS.ErrnoError||an(e),-e.errno}}function Fe(){r.abort()}var je=Te;function xe(e,t,n){return B.set(B.subarray(t,t+n),e),e}var Ue={};function Qe(e){return Ue[e]||0}var We=1,Ye={EPERM:1,ENOENT:2,ESRCH:3,EINTR:4,EIO:5,ENXIO:6,E2BIG:7,ENOEXEC:8,EBADF:9,ECHILD:10,EAGAIN:11,EWOULDBLOCK:11,ENOMEM:12,EACCES:13,EFAULT:14,ENOTBLK:15,EBUSY:16,EEXIST:17,EXDEV:18,ENODEV:19,ENOTDIR:20,EISDIR:21,EINVAL:22,ENFILE:23,EMFILE:24,ENOTTY:25,ETXTBSY:26,EFBIG:27,ENOSPC:28,ESPIPE:29,EROFS:30,EMLINK:31,EPIPE:32,EDOM:33,ERANGE:34,ENOMSG:42,EIDRM:43,ECHRNG:44,EL2NSYNC:45,EL3HLT:46,EL3RST:47,ELNRNG:48,EUNATCH:49,ENOCSI:50,EL2HLT:51,EDEADLK:35,ENOLCK:37,EBADE:52,EBADR:53,EXFULL:54,ENOANO:55,EBADRQC:56,EBADSLT:57,EDEADLOCK:35,EBFONT:59,ENOSTR:60,ENODATA:61,ETIME:62,ENOSR:63,ENONET:64,ENOPKG:65,EREMOTE:66,ENOLINK:67,EADV:68,ESRMNT:69,ECOMM:70,EPROTO:71,EMULTIHOP:72,EDOTDOT:73,EBADMSG:74,ENOTUNIQ:76,EBADFD:77,EREMCHG:78,ELIBACC:79,ELIBBAD:80,ELIBSCN:81,ELIBMAX:82,ELIBEXEC:83,ENOSYS:38,ENOTEMPTY:39,ENAMETOOLONG:36,ELOOP:40,EOPNOTSUPP:95,EPFNOSUPPORT:96,ECONNRESET:104,ENOBUFS:105,EAFNOSUPPORT:97,EPROTOTYPE:91,ENOTSOCK:88,ENOPROTOOPT:92,ESHUTDOWN:108,ECONNREFUSED:111,EADDRINUSE:98,ECONNABORTED:103,ENETUNREACH:101,ENETDOWN:100,ETIMEDOUT:110,EHOSTDOWN:112,EHOSTUNREACH:113,EINPROGRESS:115,EALREADY:114,EDESTADDRREQ:89,EMSGSIZE:90,EPROTONOSUPPORT:93,ESOCKTNOSUPPORT:94,EADDRNOTAVAIL:99,ENETRESET:102,EISCONN:106,ENOTCONN:107,ETOOMANYREFS:109,EUSERS:87,EDQUOT:122,ESTALE:116,ENOTSUP:95,ENOMEDIUM:123,EILSEQ:84,EOVERFLOW:75,ECANCELED:125,ENOTRECOVERABLE:131,EOWNERDEAD:130,ESTRPIPE:86};function Ze(e,t){return 0==e?Ye.EINVAL:(S[e>>2]=We,Ue[We]=0,We++,0)}function Ve(e,t){Ve.seen||(Ve.seen={}),e in Ve.seen||(r.dynCall_v(t),Ve.seen[e]=1)}function He(e,t){return e in Ue?(Ue[e]=t,0):Ye.EINVAL}function qe(e){return r.___errno_location&&(S[r.___errno_location()>>2]=e),e}U=l(4),k=F=C(P),x=C(j=k+z),S[U>>2]=x,X=!0;function ze(e,t,n,h){try{return r.dynCall_ddii(e,t,n,h)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;r.setThrew(1,0)}}function et(e,t,n,h){return A[e](t,n,h)}function tt(e,t){try{return r.dynCall_di(e,t)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;r.setThrew(1,0)}}function nt(e,t){return A[e](t)}function ht(e,t,n){try{return r.dynCall_dii(e,t,n)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;r.setThrew(1,0)}}function rt(e,t,n){return A[e](t,n)}function it(e,t,n,h){try{return r.dynCall_diii(e,t,n,h)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;r.setThrew(1,0)}}function ft(e,t,n,h){return A[e](t,n,h)}function ot(e,t,n){try{return r.dynCall_idi(e,t,n)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;r.setThrew(1,0)}}function at(e,t,n){return A[e](t,n)}function ut(e,t,n,h){try{return r.dynCall_idii(e,t,n,h)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;r.setThrew(1,0)}}function ct(e,t,n,h){return A[e](t,n,h)}function st(e,t,n,h,i){try{return r.dynCall_idiii(e,t,n,h,i)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;r.setThrew(1,0)}}function $t(e,t,n,h,r){return A[e](t,n,h,r)}function lt(e,t,n,h,i,f,o,a,u){try{return r.dynCall_idiiiiiii(e,t,n,h,i,f,o,a,u)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;r.setThrew(1,0)}}function Ct(e,t,n,h,r,i,f,o,a){return A[e](t,n,h,r,i,f,o,a)}function dt(e,t){try{return r.dynCall_ii(e,t)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;r.setThrew(1,0)}}function At(e,t){return A[e](t)}function Tt(e,t,n){try{return r.dynCall_iii(e,t,n)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;r.setThrew(1,0)}}function pt(e,t,n){return A[e](t,n)}function _t(e,t,n,h){try{return r.dynCall_iiii(e,t,n,h)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;r.setThrew(1,0)}}function bt(e,t,n,h){return A[e](t,n,h)}function mt(e,t,n,h,i,f){try{return r.dynCall_iiiiid(e,t,n,h,i,f)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;r.setThrew(1,0)}}function gt(e,t,n,h,r,i){return A[e](t,n,h,r,i)}function It(e,t,n,h,i,f){try{return r.dynCall_iiiiii(e,t,n,h,i,f)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;r.setThrew(1,0)}}function Jt(e,t,n,h,r,i){return A[e](t,n,h,r,i)}function Lt(e,t,n,h,i,f,o,a,u){try{return r.dynCall_iiiiiiiii(e,t,n,h,i,f,o,a,u)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;r.setThrew(1,0)}}function Kt(e,t,n,h,r,i,f,o,a){return A[e](t,n,h,r,i,f,o,a)}function Nt(e){try{r.dynCall_v(e)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;r.setThrew(1,0)}}function vt(e){A[e]()}function wt(e,t,n){try{r.dynCall_vdi(e,t,n)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;r.setThrew(1,0)}}function Dt(e,t,n){A[e](t,n)}function Mt(e,t,n,h,i,f){try{r.dynCall_vdidii(e,t,n,h,i,f)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;r.setThrew(1,0)}}function yt(e,t,n,h,r,i){A[e](t,n,h,r,i)}function Rt(e,t,n,h){try{r.dynCall_vdii(e,t,n,h)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;r.setThrew(1,0)}}function Et(e,t,n,h){A[e](t,n,h)}function Bt(e,t,n,h,i){try{r.dynCall_vdiii(e,t,n,h,i)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;r.setThrew(1,0)}}function Gt(e,t,n,h,r){A[e](t,n,h,r)}function St(e,t){try{r.dynCall_vi(e,t)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;r.setThrew(1,0)}}function Ot(e,t){A[e](t)}function Pt(e,t,n,h){try{r.dynCall_vidi(e,t,n,h)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;r.setThrew(1,0)}}function Xt(e,t,n,h){A[e](t,n,h)}function kt(e,t,n){try{r.dynCall_vii(e,t,n)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;r.setThrew(1,0)}}function Ft(e,t,n){A[e](t,n)}function jt(e,t,n,h){try{r.dynCall_viii(e,t,n,h)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;r.setThrew(1,0)}}function xt(e,t,n,h){A[e](t,n,h)}function Ut(e,t,n,h,i){try{r.dynCall_viiii(e,t,n,h,i)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;r.setThrew(1,0)}}function Qt(e,t,n,h,r){A[e](t,n,h,r)}function Wt(e,t,n,h,i,f){try{r.dynCall_viiiii(e,t,n,h,i,f)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;r.setThrew(1,0)}}function Yt(e,t,n,h,r,i){A[e](t,n,h,r,i)}function Zt(e,t,n,h,i,f,o){try{r.dynCall_viiiiii(e,t,n,h,i,f,o)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;r.setThrew(1,0)}}function Vt(e,t,n,h,r,i,f){A[e](t,n,h,r,i,f)}r.wasmTableSize=312,r.wasmMaxTableSize=312,r.asmGlobalArg={},r.asmLibraryArg={abort:an,assert:m,enlargeMemory:q,getTotalMemory:te,abortOnCannotGrowMemory:H,invoke_ddii:ze,jsCall_ddii:et,invoke_di:tt,jsCall_di:nt,invoke_dii:ht,jsCall_dii:rt,invoke_diii:it,jsCall_diii:ft,invoke_idi:ot,jsCall_idi:at,invoke_idii:ut,jsCall_idii:ct,invoke_idiii:st,jsCall_idiii:$t,invoke_idiiiiiii:lt,jsCall_idiiiiiii:Ct,invoke_ii:dt,jsCall_ii:At,invoke_iii:Tt,jsCall_iii:pt,invoke_iiii:_t,jsCall_iiii:bt,invoke_iiiiid:mt,jsCall_iiiiid:gt,invoke_iiiiii:It,jsCall_iiiiii:Jt,invoke_iiiiiiiii:Lt,jsCall_iiiiiiiii:Kt,invoke_v:Nt,jsCall_v:vt,invoke_vdi:wt,jsCall_vdi:Dt,invoke_vdidii:Mt,jsCall_vdidii:yt,invoke_vdii:Rt,jsCall_vdii:Et,invoke_vdiii:Bt,jsCall_vdiii:Gt,invoke_vi:St,jsCall_vi:Ot,invoke_vidi:Pt,jsCall_vidi:Xt,invoke_vii:kt,jsCall_vii:Ft,invoke_viii:jt,jsCall_viii:xt,invoke_viiii:Ut,jsCall_viiii:Qt,invoke_viiiii:Wt,jsCall_viiiii:Yt,invoke_viiiiii:Zt,jsCall_viiiiii:Vt,__ZSt18uncaught_exceptionv:we,___cxa_allocate_exception:ve,___cxa_begin_catch:Me,___cxa_find_matching_catch:Re,___cxa_throw:Ee,___gxx_personality_v0:Be,___resumeException:ye,___setErrNo:qe,___syscall140:Se,___syscall146:Pe,___syscall54:Xe,___syscall6:ke,_abort:Fe,_emscripten_memcpy_big:xe,_llvm_fabs_f64:je,_pthread_getspecific:Qe,_pthread_key_create:Ze,_pthread_once:Ve,_pthread_setspecific:He,flush_NO_FILESYSTEM:Oe,DYNAMICTOP_PTR:U,tempDoublePtr:Ne,ABORT:b,STACKTOP:F,STACK_MAX:j};var Ht=r.asm(r.asmGlobalArg,r.asmLibraryArg,R);r.asm=Ht;r.___cxa_can_catch=function(){return r.asm.___cxa_can_catch.apply(null,arguments)},r.___cxa_is_pointer_type=function(){return r.asm.___cxa_is_pointer_type.apply(null,arguments)},r.___errno_location=function(){return r.asm.___errno_location.apply(null,arguments)},r._fnSundialsCMESolver=function(){return r.asm._fnSundialsCMESolver.apply(null,arguments)},r._fnSundialsSolver=function(){return r.asm._fnSundialsSolver.apply(null,arguments)},r._free=function(){return r.asm._free.apply(null,arguments)},r._llvm_bswap_i32=function(){return r.asm._llvm_bswap_i32.apply(null,arguments)};var qt,zt=r._malloc=function(){return r.asm._malloc.apply(null,arguments)},en=(r._memcpy=function(){return r.asm._memcpy.apply(null,arguments)},r._memset=function(){return r.asm._memset.apply(null,arguments)},r._sbrk=function(){return r.asm._sbrk.apply(null,arguments)},r.establishStackSpace=function(){return r.asm.establishStackSpace.apply(null,arguments)},r.getTempRet0=function(){return r.asm.getTempRet0.apply(null,arguments)},r.runPostSets=function(){return r.asm.runPostSets.apply(null,arguments)},r.setTempRet0=function(){return r.asm.setTempRet0.apply(null,arguments)}),tn=(r.setThrew=function(){return r.asm.setThrew.apply(null,arguments)},r.stackAlloc=function(){return r.asm.stackAlloc.apply(null,arguments)}),nn=r.stackRestore=function(){return r.asm.stackRestore.apply(null,arguments)},hn=r.stackSave=function(){return r.asm.stackSave.apply(null,arguments)};r.dynCall_ddii=function(){return r.asm.dynCall_ddii.apply(null,arguments)},r.dynCall_di=function(){return r.asm.dynCall_di.apply(null,arguments)},r.dynCall_dii=function(){return r.asm.dynCall_dii.apply(null,arguments)},r.dynCall_diii=function(){return r.asm.dynCall_diii.apply(null,arguments)},r.dynCall_idi=function(){return r.asm.dynCall_idi.apply(null,arguments)},r.dynCall_idii=function(){return r.asm.dynCall_idii.apply(null,arguments)},r.dynCall_idiii=function(){return r.asm.dynCall_idiii.apply(null,arguments)},r.dynCall_idiiiiiii=function(){return r.asm.dynCall_idiiiiiii.apply(null,arguments)},r.dynCall_ii=function(){return r.asm.dynCall_ii.apply(null,arguments)},r.dynCall_iii=function(){return r.asm.dynCall_iii.apply(null,arguments)},r.dynCall_iiii=function(){return r.asm.dynCall_iiii.apply(null,arguments)},r.dynCall_iiiiid=function(){return r.asm.dynCall_iiiiid.apply(null,arguments)},r.dynCall_iiiiii=function(){return r.asm.dynCall_iiiiii.apply(null,arguments)},r.dynCall_iiiiiiiii=function(){return r.asm.dynCall_iiiiiiiii.apply(null,arguments)},r.dynCall_v=function(){return r.asm.dynCall_v.apply(null,arguments)},r.dynCall_vdi=function(){return r.asm.dynCall_vdi.apply(null,arguments)},r.dynCall_vdidii=function(){return r.asm.dynCall_vdidii.apply(null,arguments)},r.dynCall_vdii=function(){return r.asm.dynCall_vdii.apply(null,arguments)},r.dynCall_vdiii=function(){return r.asm.dynCall_vdiii.apply(null,arguments)},r.dynCall_vi=function(){return r.asm.dynCall_vi.apply(null,arguments)},r.dynCall_vidi=function(){return r.asm.dynCall_vidi.apply(null,arguments)},r.dynCall_vii=function(){return r.asm.dynCall_vii.apply(null,arguments)},r.dynCall_viii=function(){return r.asm.dynCall_viii.apply(null,arguments)},r.dynCall_viiii=function(){return r.asm.dynCall_viiii.apply(null,arguments)},r.dynCall_viiiii=function(){return r.asm.dynCall_viiiii.apply(null,arguments)},r.dynCall_viiiiii=function(){return r.asm.dynCall_viiiiii.apply(null,arguments)};function rn(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function fn(e){function t(){r.calledRun||(r.calledRun=!0,b||(ce(),se(),r.onRuntimeInitialized&&r.onRuntimeInitialized(),le()))}e=e||r.arguments,pe>0||(ue(),pe>0||r.calledRun||(r.setStatus?(r.setStatus("Running..."),setTimeout((function(){setTimeout((function(){r.setStatus("")}),1),t()}),1)):t()))}function on(e,n){n&&r.noExitRuntime&&0===e||(r.noExitRuntime||(b=!0,e,F=qt,$e(),r.onExit&&r.onExit(e)),c&&t.exit(e),r.quit(e,new rn(e)))}function an(e){throw r.onAbort&&r.onAbort(e),void 0!==e?(r.print(e),r.printErr(e),e=JSON.stringify(e)):e="",b=!0,1,"abort("+e+"). Build with -s ASSERTIONS=1 for more info."}if(r.asm=Ht,r.ccall=L,r.cwrap=K,r.addFunction=T,r.removeFunction=p,r.then=function(e){if(r.calledRun)e(r);else{var t=r.onRuntimeInitialized;r.onRuntimeInitialized=function(){t&&t(),e(r)}}return r},rn.prototype=new Error,rn.prototype.constructor=rn,be=function e(){r.calledRun||fn(),r.calledRun||(be=e)},r.run=fn,r.exit=on,r.abort=an,r.preInit)for("function"==typeof r.preInit&&(r.preInit=[r.preInit]);r.preInit.length>0;)r.preInit.pop()();return r.noExitRuntime=!0,fn(),e}}).call(this,n(0))},function(e,t,n){e.exports=n.p+"c3cea96d61e0c717c244775efc64ee00.wasm"},function(e,t){e.exports='"use strict";\r\n// Copyright (c) Microsoft Corporation.\r\n// Licensed under the MIT License.\r\n//PhantomJS which is used in build agent test environment does not have console. Placing a stub here, so the scripts calling console won\'t crash\r\nif (typeof console === "undefined")\r\n    console = {\r\n        assert: function (test, message) {\r\n            var optionalParams = [];\r\n            for (var _i = 2; _i < arguments.length; _i++) {\r\n                optionalParams[_i - 2] = arguments[_i];\r\n            }\r\n            throw "Assertion not supported";\r\n        },\r\n        clear: function () { },\r\n        count: function (countTitle) { },\r\n        debug: function (message) {\r\n            var optionalParams = [];\r\n            for (var _i = 1; _i < arguments.length; _i++) {\r\n                optionalParams[_i - 1] = arguments[_i];\r\n            }\r\n        },\r\n        dir: function (value) {\r\n            var optionalParams = [];\r\n            for (var _i = 1; _i < arguments.length; _i++) {\r\n                optionalParams[_i - 1] = arguments[_i];\r\n            }\r\n        },\r\n        dirxml: function (value) { },\r\n        error: function (message) {\r\n            var optionalParams = [];\r\n            for (var _i = 1; _i < arguments.length; _i++) {\r\n                optionalParams[_i - 1] = arguments[_i];\r\n            }\r\n        },\r\n        group: function (groupTitle) { },\r\n        groupCollapsed: function (groupTitle) { },\r\n        groupEnd: function () { },\r\n        info: function (message) {\r\n            var optionalParams = [];\r\n            for (var _i = 1; _i < arguments.length; _i++) {\r\n                optionalParams[_i - 1] = arguments[_i];\r\n            }\r\n        },\r\n        log: function (message) {\r\n            var optionalParams = [];\r\n            for (var _i = 1; _i < arguments.length; _i++) {\r\n                optionalParams[_i - 1] = arguments[_i];\r\n            }\r\n        },\r\n        msIsIndependentlyComposed: function (element) { return false; },\r\n        profile: function (reportName) { },\r\n        profileEnd: function () { },\r\n        select: function (element) { },\r\n        time: function (timerName) { },\r\n        timeEnd: function (timerName) { },\r\n        trace: function () { },\r\n        warn: function (message) {\r\n            var optionalParams = [];\r\n            for (var _i = 1; _i < arguments.length; _i++) {\r\n                optionalParams[_i - 1] = arguments[_i];\r\n            }\r\n        },\r\n    };\r\n//# sourceMappingURL=WebWorkerSafeChecks.js.map'},function(e,t){},function(e,t,n){(function(e){function n(e,t){for(var n=0,h=e.length-1;h>=0;h--){var r=e[h];"."===r?e.splice(h,1):".."===r?(e.splice(h,1),n++):n&&(e.splice(h,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}function h(e,t){if(e.filter)return e.filter(t);for(var n=[],h=0;h<e.length;h++)t(e[h],h,e)&&n.push(e[h]);return n}t.resolve=function(){for(var t="",r=!1,i=arguments.length-1;i>=-1&&!r;i--){var f=i>=0?arguments[i]:e.cwd();if("string"!=typeof f)throw new TypeError("Arguments to path.resolve must be strings");f&&(t=f+"/"+t,r="/"===f.charAt(0))}return(r?"/":"")+(t=n(h(t.split("/"),(function(e){return!!e})),!r).join("/"))||"."},t.normalize=function(e){var i=t.isAbsolute(e),f="/"===r(e,-1);return(e=n(h(e.split("/"),(function(e){return!!e})),!i).join("/"))||i||(e="."),e&&f&&(e+="/"),(i?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(h(e,(function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e})).join("/"))},t.relative=function(e,n){function h(e){for(var t=0;t<e.length&&""===e[t];t++);for(var n=e.length-1;n>=0&&""===e[n];n--);return t>n?[]:e.slice(t,n-t+1)}e=t.resolve(e).substr(1),n=t.resolve(n).substr(1);for(var r=h(e.split("/")),i=h(n.split("/")),f=Math.min(r.length,i.length),o=f,a=0;a<f;a++)if(r[a]!==i[a]){o=a;break}var u=[];for(a=o;a<r.length;a++)u.push("..");return(u=u.concat(i.slice(o))).join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){if("string"!=typeof e&&(e+=""),0===e.length)return".";for(var t=e.charCodeAt(0),n=47===t,h=-1,r=!0,i=e.length-1;i>=1;--i)if(47===(t=e.charCodeAt(i))){if(!r){h=i;break}}else r=!1;return-1===h?n?"/":".":n&&1===h?"/":e.slice(0,h)},t.basename=function(e,t){var n=function(e){"string"!=typeof e&&(e+="");var t,n=0,h=-1,r=!0;for(t=e.length-1;t>=0;--t)if(47===e.charCodeAt(t)){if(!r){n=t+1;break}}else-1===h&&(r=!1,h=t+1);return-1===h?"":e.slice(n,h)}(e);return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},t.extname=function(e){"string"!=typeof e&&(e+="");for(var t=-1,n=0,h=-1,r=!0,i=0,f=e.length-1;f>=0;--f){var o=e.charCodeAt(f);if(47!==o)-1===h&&(r=!1,h=f+1),46===o?-1===t?t=f:1!==i&&(i=1):-1!==t&&(i=-1);else if(!r){n=f+1;break}}return-1===t||-1===h||0===i||1===i&&t===h-1&&t===n+1?"":e.slice(t,h)};var r="b"==="ab".substr(-1)?function(e,t,n){return e.substr(t,n)}:function(e,t,n){return t<0&&(t=e.length+t),e.substr(t,n)}}).call(this,n(0))},function(e,t){e.exports='function ignore(){}function id(n){return n}function fst(n){return n[0]}function snd(n){return n[1]}function trd(n){return n[2]}IntelliFactory={Runtime:{Ctor:function(n,t){return n.prototype=t.prototype,n},Class:function(n,t,i){var u=n,f,r,e;if(t){u=new t;for(f in n)u[f]=n[f]}if(r=function(n){if(n)for(var t in n)this[t]=n[t]},r.prototype=u,i)for(e in i)r[e]=i[e];return r},Clone:function(n){var t={};for(var i in n)t[i]=n[i];return t},NewObject:function(n){for(var i={},t=0;t<n.length;t++)i[n[t][0]]=n[t][1];return i},DeleteEmptyFields:function(n,t){for(var r,i=0;i<t.length;i++)r=t[i],n[r]===void 0&&delete n[r];return n},GetOptional:function(n){return n===void 0?null:{$:1,$0:n}},SetOptional:function(n,t,i){i?n[t]=i.$0:delete n[t]},SetOrDelete:function(n,t,i){i===void 0?delete n[t]:n[t]=i},Apply:function(n,t,i){return n.apply(t,i)},Bind:function(n){return function(){return n.apply(this,arguments)}},CreateFuncWithArgs:function(n){return function(){return n(Array.prototype.slice.call(arguments))}},CreateFuncWithOnlyThis:function(n){return function(){return n(this)}},CreateFuncWithThis:function(n){return function(){return n(this).apply(null,arguments)}},CreateFuncWithThisArgs:function(n){return function(){return n(this)(Array.prototype.slice.call(arguments))}},CreateFuncWithRest:function(n,t){return function(){return t(Array.prototype.slice.call(arguments,0,n).concat([Array.prototype.slice.call(arguments,n)]))}},CreateFuncWithArgsRest:function(n,t){return function(){return t([Array.prototype.slice.call(arguments,0,n),Array.prototype.slice.call(arguments,n)])}},BindDelegate:function(n,t){var i=n.bind(t);return i.$Func=n,i.$Target=t,i},CreateDelegate:function(n){if(n.length==0)return null;if(n.length==1)return n[0];var t=function(){for(var i,t=0;t<n.length;t++)i=n[t].apply(null,arguments);return i};return t.$Invokes=n,t},CombineDelegates:function(n){for(var t,i=[],r=0;r<n.length;r++)t=n[r],t&&("$Invokes"in t?i=i.concat(t.$Invokes):i.push(t));return IntelliFactory.Runtime.CreateDelegate(i)},DelegateEqual:function(n,t){var f,e,i,r,u;if(n===t)return!0;if(n==null||t==null||(f=n.$Invokes||[n],e=t.$Invokes||[t],f.length!=e.length))return!1;for(i=0;i<f.length;i++)if(r=f[i],u=e[i],!(r===u||"$Func"in r&&"$Func"in u&&r.$Func===u.$Func&&r.$Target==u.$Target))return!1;return!0},ThisFunc:function(n){return function(){var t=Array.prototype.slice.call(arguments);return t.unshift(this),n.apply(null,t)}},ThisFuncOut:function(n){return function(){var t=Array.prototype.slice.call(arguments);return n.apply(t.shift(),t)}},ParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat([i.slice(n)]))}},ParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat(i[n]))}},ThisParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return i.unshift(this),t.apply(null,i.slice(0,n+1).concat([i.slice(n+1)]))}},ThisParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(i.shift(),i.slice(0,n).concat(i[n]))}},Curried:function(n,t,i){return i=i||[],function(r){var u=i.concat([r===void 0?null:r]);return t==1?n.apply(null,u):t==2?function(t){return n.apply(null,u.concat([t===void 0?null:t]))}:IntelliFactory.Runtime.Curried(n,t-1,u)}},Curried2:function(n){return function(t){return function(i){return n(t,i)}}},Curried3:function(n){return function(t){return function(i){return function(r){return n(t,i,r)}}}},UnionByType:function(n,t,i){for(var u,f=typeof t,r=0;r<n.length;r++)if(u=n[r],typeof u=="number"){if(Array.isArray(t)&&(u==0||t.length==u))return{$:r,$0:t}}else if(u==f)return{$:r,$0:t};if(!i)throw new Error("Type not expected for creating Choice value.");},ScriptBasePath:"./",ScriptPath:function(n,t){return this.ScriptBasePath+(this.ScriptSkipAssemblyDir?"":n+"/")+t},OnLoad:function(n){"load"in this||(this.load=[]);this.load.push(n)},Start:function(){function n(n){for(var t=0;t<n.length;t++)n[t]()}"load"in this&&(n(this.load),this.load=[])}}};IntelliFactory.Runtime.OnLoad(function(){self.WebSharper&&WebSharper.Activator&&WebSharper.Activator.Activate&&WebSharper.Activator.Activate()});Date.now||(Date.now=function(){return(new Date).getTime()});Math.trunc||(Math.trunc=function(n){return n<0?Math.ceil(n):Math.floor(n)});Object.setPrototypeOf||(Object.setPrototypeOf=function(n,t){return n.__proto__=t,n});console||(console={count:ignore,dir:ignore,error:ignore,group:ignore,groupEnd:ignore,info:ignore,log:ignore,profile:ignore,profileEnd:ignore,time:ignore,timeEnd:ignore,trace:ignore,warn:ignore});\r\n(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_,$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX,bY,bZ,b0,b1,b2,b3,b4,b5,b6,b7,b8,b9,b_,b$,ca,cb,cc,cd,ce,cf,cg,ch,ci,cj,ck,cl,cm,cn,co,cp,cq,cr,cs,ct,cu,cv,cw,cx,cy,cz,cA,cB,cC,cD,cE,cF,cG,cH,cI,cJ,cK,cL,cM,cN,cO,cP,cQ,cR,cS,cT,cU,cV,cW,cX,cY,cZ,c0,c1,c2,c3,c4,c5,c6,c7,c8,c9,c_,c$,da,db,dc,dd,de,df,dg,dh,di,dj,dk,dl,dm,dn,_do,dp,dq,dr,ds,dt,du,dv,dw,dx,dy,dz,dA,dB,dC,dD,dE,dF,dG,dH,dI,dJ,dK,dL,dM,dN,dO,dP,dQ,dR,dS,dT,dU,dV,dW,dX,dY,dZ,d0,d1,d2,d3,d4,d5,d6,d7,d8,d9,d_,d$,ea,eb,ec,ed,ee,ef,eg,eh,ei,ej,ek,el,em,en,eo,ep,eq,er,es,et,eu,ev,ew,ex,ey,ez,eA,eB,eC,eD,eE,eF,eG,eH,eI,eJ,eK,eL,eM,eN,eO,eP,eQ,eR,eS,eT,eU,eV,eW,eX,eY,eZ,e0,e1,e2,e3,e4,e5,e6,e7,e8,e9,e_,e$,fa,fb,fc,fd,fe,ff,fg,fh,fi,fj,fk,fl,fm,fn,fo,fp,fq,fr,fs,ft,fu,fv,fw,fx,fy,fz,fA;a=self;b=a.Microsoft=a.Microsoft||{};c=b.Research=b.Research||{};d=c.CRNEngine=c.CRNEngine||{};e=d.JSAPI=d.JSAPI||{};f=e.export_def=e.export_def||{};g=e.sim_run=e.sim_run||{};h=e.probabilityMap=e.probabilityMap||{};i=e.transition=e.transition||{};j=e.state=e.state||{};k=e.state_space=e.state_space||{};l=e.inference_evaluated_values=e.inference_evaluated_values||{};m=e.inference_burnin=e.inference_burnin||{};n=e.inference_sampling=e.inference_sampling||{};o=e.inference_result=e.inference_result||{};p=e.InferenceParameterRange=e.InferenceParameterRange||{};q=e.InferenceParameter=e.InferenceParameter||{};r=e.InferenceParameters=e.InferenceParameters||{};s=e.column_array=e.column_array||{};t=e.table_array=e.table_array||{};u=d.JSONAPI=d.JSONAPI||{};v=a.WebSharper=a.WebSharper||{};w=v.Obj=v.Obj||{};x=v.Collections=v.Collections||{};y=x.FSharpMap=x.FSharpMap||{};z=d.Gui=d.Gui||{};A=v.List=v.List||{};B=A.T=A.T||{};C=d.Instance=d.Instance||{};D=a.Parser=a.Parser||{};E=d.InferenceSiteGraph=d.InferenceSiteGraph||{};F=v.Operators=v.Operators||{};G=a.Error;H=D.Exception=D.Exception||{};I=D.error=D.error||{};J=E.IGraph=E.IGraph||{};K=x.Map=x.Map||{};L=d.Model=d.Model||{};M=d.Crn=d.Crn||{};N=d.GuiIG=d.GuiIG||{};O=d.Crn_settings=d.Crn_settings||{};P=d.Simulation_settings=d.Simulation_settings||{};Q=d.Functional2=d.Functional2||{};R=d.Expression=d.Expression||{};S=d.Svg=d.Svg||{};T=d.Populations=d.Populations||{};U=v.Arrays=v.Arrays||{};V=d.Initial=d.Initial||{};W=d.Population=d.Population||{};X=d.OdeOslo=d.OdeOslo||{};Y=d.Ssa=d.Ssa||{};Z=d.Table=d.Table||{};_0=d.OdeSundials=d.OdeSundials||{};_1=d.Simulator=d.Simulator||{};_2=v.Utils=v.Utils||{};_3=d.Calculus=d.Calculus||{};_4=d.Lna=d.Lna||{};_5=d.Pde=d.Pde||{};_6=d.Spatial_settings=d.Spatial_settings||{};_7=d.Stochastic_settings=d.Stochastic_settings||{};_8=d.Attributes=d.Attributes||{};_9=d.Dictionary=d.Dictionary||{};_=d.Ctmc=d.Ctmc||{};$=x.List=x.List||{};ba=d.Transition=d.Transition||{};bb=d.Stringmap=d.Stringmap||{};bc=v.Seq=v.Seq||{};bd=x.Dictionary=x.Dictionary||{};be=d.Species=d.Species||{};bf=d.Simulation=d.Simulation||{};bg=d.Cme=d.Cme||{};bh=d.Probabilities=d.Probabilities||{};bi=d.Jit=d.Jit||{};bj=d.GuiModel=d.GuiModel||{};bk=v.Unchecked=v.Unchecked||{};bl=d.Sbml=d.Sbml||{};bm=c.Filzbach=c.Filzbach||{};bn=bm.Parameters=bm.Parameters||{};bo=bn.EvaluatedValues=bn.EvaluatedValues||{};bp=bm.DataStructures=bm.DataStructures||{};bq=bp.AssociativeArray=bp.AssociativeArray||{};br=bn.ParameterRange=bn.ParameterRange||{};bs=bn.AcceptanceStatistics=bn.AcceptanceStatistics||{};bt=d.Result=d.Result||{};bu=d.Inference=d.Inference||{};bv=bu.mcmc_intermediate_result=bu.mcmc_intermediate_result||{};bw=bm.Filzbach=bm.Filzbach||{};bx=bw.Sampling=bw.Sampling||{};by=bw.Burnin=bw.Burnin||{};bz=d.Plotting=d.Plotting||{};bA=bu.mcmc_result=bu.mcmc_result||{};bB=d.Html=d.Html||{};bC=bn.Parameter=bn.Parameter||{};bD=d.Moment_closure_settings=d.Moment_closure_settings||{};bE=d.Column=d.Column||{};bF=d.Parameters=d.Parameters||{};bG=d.Task=d.Task||{};bH=E.Location=E.Location||{};bI=E.PriorKind=E.PriorKind||{};bJ=d.GuiIGTargetParameter=d.GuiIGTargetParameter||{};bK=d.GuiIGEdge=d.GuiIGEdge||{};bL=a.CRNEngineJS_JsonDecoder=a.CRNEngineJS_JsonDecoder||{};bM=a.CRNEngineJS_JsonEncoder=a.CRNEngineJS_JsonEncoder||{};bN=a.CRNEngineJS_GeneratedPrintf=a.CRNEngineJS_GeneratedPrintf||{};bO=d.Deterministic_settings=d.Deterministic_settings||{};bP=d.Interval=d.Interval||{};bQ=d.Truncated=d.Truncated||{};bR=d.LogNormal=d.LogNormal||{};bS=d.Normal=d.Normal||{};bT=d.Uniform=d.Uniform||{};bU=d.Distribution=d.Distribution||{};bV=d.Variation=d.Variation||{};bW=d.Prior=d.Prior||{};bX=d.Parameter=d.Parameter||{};bY=d.Noise_model=d.Noise_model||{};bZ=d.Noise_parameter=d.Noise_parameter||{};b0=d.Inference_settings=d.Inference_settings||{};b1=bD.t=bD.t||{};b2=d.Synthesis_settings=d.Synthesis_settings||{};b3=d.Dataset=d.Dataset||{};b4=d.Concentration=d.Concentration||{};b5=d.Time=d.Time||{};b6=d.Space=d.Space||{};b7=d.Units=d.Units||{};b8=d.Assignment=d.Assignment||{};b9=d.Sweep=d.Sweep||{};b_=d.Plot_settings=d.Plot_settings||{};b$=d.Mset=d.Mset||{};ca=b$.entry=b$.entry||{};cb=d.Rate=d.Rate||{};cc=d.Reaction=d.Reaction||{};cd=d.Spatial_initial=d.Spatial_initial||{};ce=cd.core=cd.core||{};cf=cd.point=cd.point||{};cg=cd.rectangle=cd.rectangle||{};ch=cd.t=cd.t||{};ci=v.ClientSideJson=v.ClientSideJson||{};cj=ci.Provider=ci.Provider||{};ck=bn.ParameterType=bn.ParameterType||{};cl=bn.TruncatedNormal=bn.TruncatedNormal||{};cm=bn.LogNormal=bn.LogNormal||{};cn=bn.Normal=bn.Normal||{};co=d.Key=d.Key||{};cp=R.bexp=R.bexp||{};cq=R.modulo=R.modulo||{};cr=R.minus=R.minus||{};cs=R.power=R.power||{};ct=R.divide=R.divide||{};cu=d.Kinetics=d.Kinetics||{};cv=d.Row=d.Row||{};cw=d.Point=d.Point||{};cx=x.BalancedTree=x.BalancedTree||{};cy=cx.Tree=cx.Tree||{};cz=x.Pair=x.Pair||{};cA=a.StartupCode$CRNEngineJS$InferenceSiteGraph=a.StartupCode$CRNEngineJS$InferenceSiteGraph||{};cB=v.JavaScript=v.JavaScript||{};cC=cB.Pervasives=cB.Pervasives||{};cD=S.point=S.point||{};cE=S.box=S.box||{};cF=S.group=S.group||{};cG=a.Object;cH=d.VectorFSModule=d.VectorFSModule||{};cI=d.Oslo_integrator=d.Oslo_integrator||{};cJ=cI.t=cI.t||{};cK=a.Oslo=a.Oslo||{};cL=cK.VectorModule=cK.VectorModule||{};cM=d.VectorFS=d.VectorFS||{};cN=d.Lambda=d.Lambda||{};cO=cK.MatrixModule=cK.MatrixModule||{};cP=d.Ode=d.Ode||{};cQ=d.Rng=d.Rng||{};cR=cQ.Random=cQ.Random||{};cS=d.Hashtable=d.Hashtable||{};cT=d.Event=d.Event||{};cU=d.reaction_info=d.reaction_info||{};cV=d.Errors=d.Errors||{};cW=cV.EngineException=cV.EngineException||{};cX=cV.SimulatorErrorException=cV.SimulatorErrorException||{};cY=d.Inlined=d.Inlined||{};cZ=bi.JitSpecies=bi.JitSpecies||{};c0=bi.JitReaction=bi.JitReaction||{};c1=cK.Matrix=cK.Matrix||{};c2=v.Slice=v.Slice||{};c3=c.ReactionDiffusion=c.ReactionDiffusion||{};c4=c3.Solver1d=c3.Solver1d||{};c5=c4.point=c4.point||{};c6=c3.Lib=c3.Lib||{};c7=c6.settings=c6.settings||{};c8=c3.Solver2d=c3.Solver2d||{};c9=c8.point=c8.point||{};c_=d.Statistics=d.Statistics||{};c$=_9.t=_9.t||{};da=v.Enumerator=v.Enumerator||{};db=d.Lib=d.Lib||{};dc=da.T=da.T||{};dd=x.DictionaryUtil=x.DictionaryUtil||{};de=cK.SparseMatrix=cK.SparseMatrix||{};df=de.SparseMatrix=de.SparseMatrix||{};dg=x.Set=x.Set||{};dh=x.FSharpSet=x.FSharpSet||{};di=d.Environment=d.Environment||{};dj=cB.JS=cB.JS||{};dk=v.Strings=v.Strings||{};dl=d.Stringbuilder=d.Stringbuilder||{};dm=bp.NamesMap=bp.NamesMap||{};dn=bm.Lib=bm.Lib||{};_do=dn.NormalGenerator=dn.NormalGenerator||{};dp=bu.partial=bu.partial||{};dq=bu.full=bu.full||{};dr=d.ParameterSummary=d.ParameterSummary||{};ds=bu.McmcSummary=bu.McmcSummary||{};dt=bB.Results=bB.Results||{};du=bB.Comparison=bB.Comparison||{};dv=bz.html_content=bz.html_content||{};dw=a.FSharpIDD=a.FSharpIDD||{};dx=dw.HTML=dw.HTML||{};dy=bu.Summary=bu.Summary||{};dz=d.Operators=d.Operators||{};dA=a.StartupCode$CRNEngineJS$functional=a.StartupCode$CRNEngineJS$functional||{};dB=S.anchor=S.anchor||{};dC=cI.Stepper=cI.Stepper||{};dD=cK.GearBDF=cK.GearBDF||{};dE=dD.state=dD.state||{};dF=dD.options=dD.options||{};dG=cK.RK547M=cK.RK547M||{};dH=dG.state=dG.state||{};dI=dG.options=dG.options||{};dJ=d.OsloAbstract=d.OsloAbstract||{};dK=dn.LCGRng=dn.LCGRng||{};dL=d.SundialsAbstract=d.SundialsAbstract||{};dM=c3.Solver=c3.Solver||{};dN=a.StartupCode$CRNEngineJS$stringmap=a.StartupCode$CRNEngineJS$stringmap||{};dO=a.StartupCode$ParserCombinatorsJS$ParserCombinators=a.StartupCode$ParserCombinatorsJS$ParserCombinators||{};dP=x.ValueCollection=x.ValueCollection||{};dQ=x.MapUtil=x.MapUtil||{};dR=a.proxies=a.proxies||{};dS=dR.StringBuilder=dR.StringBuilder||{};dT=a.StartupCode$CRNEngineJS$sbml=a.StartupCode$CRNEngineJS$sbml||{};dU=bl.model=bl.model||{};dV=bl.unitKind=bl.unitKind||{};dW=bl.nOp=bl.nOp||{};dX=bl.bOp=bl.bOp||{};dY=dn.NormalGeneratorState=dn.NormalGeneratorState||{};dZ=v.Char=v.Char||{};d0=a.StartupCode$CRNEngineJS$plotting=a.StartupCode$CRNEngineJS$plotting||{};d1=bm.FilzbachMultiple=bm.FilzbachMultiple||{};d2=bn.Ids=bn.Ids||{};d3=bm.FilzbachAnalysis=bm.FilzbachAnalysis||{};d4=bw.RunOptions=bw.RunOptions||{};d5=dw.DOM=dw.DOM||{};d6=dw.HtmlConverters=dw.HtmlConverters||{};d7=dw.Subplots=dw.Subplots||{};d8=dw.Chart=dw.Chart||{};d9=dw.Colour=dw.Colour||{};d_=d8.Chart=d8.Chart||{};d$=d8.LegendVisibility=d8.LegendVisibility||{};ea=dw.Plots=dw.Plots||{};eb=ea.Heatmap=ea.Heatmap||{};ec=v.Arrays2D=v.Arrays2D||{};ed=ea.Markers=ea.Markers||{};ee=ed.Shape=ed.Shape||{};ef=ea.Polyline=ea.Polyline||{};eg=ea.Histogram=ea.Histogram||{};eh=d.Index=d.Index||{};ei=d.Adapter=d.Adapter||{};ej=d.Keywords=d.Keywords||{};ek=d.Sweeps=d.Sweeps||{};el=S.path=S.path||{};em=S.label=S.label||{};en=a.StartupCode$CRNEngineJS$svg=a.StartupCode$CRNEngineJS$svg||{};eo=dD.jacobian=dD.jacobian||{};ep=dG.corrStruct=dG.corrStruct||{};eq=v.ArgumentException=v.ArgumentException||{};er=cK.SparseVector=cK.SparseVector||{};es=er.SparseVector=er.SparseVector||{};et=D.ParserBuilder=D.ParserBuilder||{};eu=a.StartupCode$CRNEngineJS$mset=a.StartupCode$CRNEngineJS$mset||{};ev=bl.unitDefinition=bl.unitDefinition||{};ew=bl.compartment=bl.compartment||{};ex=bl.species=bl.species||{};ey=bl.parameter=bl.parameter||{};ez=bl.initialAssignment=bl.initialAssignment||{};eA=bl.reaction=bl.reaction||{};eB=bl.sbmlUnit=bl.sbmlUnit||{};eC=bl.speciesReference=bl.speciesReference||{};eD=bl.kineticLaw=bl.kineticLaw||{};eE=bl.uOp=bl.uOp||{};eF=d3.ParameterSummary=d3.ParameterSummary||{};eG=d3.summaryType=d3.summaryType||{};eH=d3.qsummaryType=d3.qsummaryType||{};eI=d3.InformationCriteria=d3.InformationCriteria||{};eJ=d5.Div=d5.Div||{};eK=d5.Attribute=d5.Attribute||{};eL=dw.Placement=dw.Placement||{};eM=d7.Subplots=d7.Subplots||{};eN=a.StartupCode$FSharpIDD_WS$Chart=a.StartupCode$FSharpIDD_WS$Chart||{};eO=a.StartupCode$FSharpIDD_WS$Colour=a.StartupCode$FSharpIDD_WS$Colour||{};eP=d8.LabelledAxisRecord=d8.LabelledAxisRecord||{};eQ=eb.Plot=eb.Plot||{};eR=eb.Palette=eb.Palette||{};eS=ed.Plot=ed.Plot||{};eT=d9.Colour=d9.Colour||{};eU=ef.Plot=ef.Plot||{};eV=ef.LineCap=ef.LineCap||{};eW=ef.LineJoin=ef.LineJoin||{};eX=eg.Plot=eg.Plot||{};eY=d.Instruction=d.Instruction||{};eZ=a.StartupCode$CRNEngineJS$Keywords=a.StartupCode$CRNEngineJS$Keywords||{};e0=d.Directive=d.Directive||{};e1=x.HashSet=x.HashSet||{};e2=S.path_command=S.path_command||{};e3=a.StartupCode$CRNEngineJS$spatial_initial=a.StartupCode$CRNEngineJS$spatial_initial||{};e4=bl.NotId=bl.NotId||{};e5=a.StartupCode$CRNEngineJS$lib=a.StartupCode$CRNEngineJS$lib||{};e6=bp.NamedObject=bp.NamedObject||{};e7=bp.BayesTable=bp.BayesTable||{};e8=d5.Node=d5.Node||{};e9=d9.RgbColour=d9.RgbColour||{};e_=ea.Bars=ea.Bars||{};e$=e_.Plot=e_.Plot||{};fa=v.FormatException=v.FormatException||{};fb=v.OverflowException=v.OverflowException||{};fc=a.StartupCode$CRNEngineJS$moment_closure_settings=a.StartupCode$CRNEngineJS$moment_closure_settings||{};fd=a.StartupCode$CRNEngineJS$environment=a.StartupCode$CRNEngineJS$environment||{};fe=dD.iteration=dD.iteration||{};ff=cK.Gauss=cK.Gauss||{};fg=bw.AcceptanceResult=bw.AcceptanceResult||{};fh=d7.Slot=d7.Slot||{};fi=dw.HistogramBuilder=dw.HistogramBuilder||{};fj=fi.Histogram=fi.Histogram||{};fk=e_.Shadow=e_.Shadow||{};fl=v.IndexOutOfRangeException=v.IndexOutOfRangeException||{};fm=a.StartupCode$CRNEngineJS$expression=a.StartupCode$CRNEngineJS$expression||{};fn=a.StartupCode$Filzbach_FSharp_JS$Lib=a.StartupCode$Filzbach_FSharp_JS$Lib||{};fo=ff.SolveCoreUtility=ff.SolveCoreUtility||{};fp=d7.BareChart=d7.BareChart||{};fq=x.HashSetUtil=x.HashSetUtil||{};fr=v.MatchFailureException=v.MatchFailureException||{};fs=v.ArgumentOutOfRangeException=v.ArgumentOutOfRangeException||{};ft=a.IntelliFactory;fu=ft&&ft.Runtime;fv=a.Math;fw=a.WS_EM_GLUE;fx=a.console;fy=a.Date;fz=a.Float64Array;fA=a.String;e.valueTypeCaseString=function(fB){return fB=="MeanStdev"?"MeanStdev":fB=="MeanStdevProbabilities"?"MeanStdevProbabilities":fB=="Spatial1D"?"Spatial1D":fB=="Spatial2D"?"Spatial2D":fB=="MeanStdevTable"?"MeanStdevTable":"Float";};e.parse_code=function(fB){var fC,fE,fF;function fD(fG){return L.New(fG.top.initialise(),A.map(function(fH){return fH.initialise();},fG.systems));}fE=D.from_string_first_error_with_msg(E.parse(),fB);if(fE.$==1){fF=fE.$0;throw new H.New(fF.text,[fF]);}else fC=fE.$0;return J.New(fC.task,K.Map(function(fG,fH){return fD(fH);},fC.nodes),fC.edges,fC.expanded);};e.prepare_Model=function(fB,fC){return E.expandAndLift(fB.to_ig()).nodes.get_Item(fC).merge_shared_settings();};e.prepare_CRN_for_sim=function(fB,fC,fD){var fE,fF,fG,fH,fI,fJ,fK;fE=e.prepare_Model(fB,fC);fF=(fG=fD.model,fG===""?fE.top:(fH=bc.tryFind(function(fL){return fL.name===fG;},fE.systems),fH==null?fE.top:fH.$0));return M.New(fF.name,fF.settings.update_simulation(fD.settings.map((fI=(fJ=(fK=fF.settings.rates,function(fL){return M.species_to_rates(fK,fL);}),function(fL){return R.map(fJ,fL);}),function(fL){return fI(Q.from_string_plot(fL));}))),fF.reactions,fF.initials,fF.attributes).substitute(fD.environment);};e.pop_to_svg=function(fB,fC){try{return S.to_string(M.get_default_svg_style(),M.initials_to_svg(M.New(fB.name,fB.settings,fB.reactions,A.ofArray(U.map(function(fD){return V.create$1({$:1,$0:fD.value},fD.species,null);},fC.index_to_species)),fB.attributes)));}catch(fD){return fD.message;}};e.get_instances=function(fB,fC){var fD;function fE(fF){return A.map(function(fG){return C.create$5(fG.model,fG.sweep,fG.assignment,fG.environment,fG.settings.map(Q.to_string_plot),fG.name);},fF.get_instances());}fD=e.prepare_Model(fB,fC);return fD.systems.$==0?fE(fD.top):A.collect(fE,fD.systems);};e.make_instance_name=function(fB){return fB.name!==""?fB.name:fB.sweep===""?fB.model:fB.model+"."+fB.sweep;};e.simulateFloat=function(fB,fC,fD,fE,fF,fG){var fH,fI,fJ;function fK(fL){fF(f.New("image/svg+xml","finals","Finals",{$:1,$0:fC},fI===""?null:{$:1,$0:fI},{$:1,$0:[e.pop_to_svg(fH,fL)]},null));}fH=e.prepare_CRN_for_sim(fB,fC,fD);fI=e.make_instance_name(fD);fJ=fH.settings.simulator;fJ=="Oslo"?fH.to_oslo().simulate_callback(fG,fE,fK):fJ=="SSA"?fH.to_ssa().simulate_callback(fG,fE,fK,{$:1,$0:fu.Curried3(function(fL,fM,fN){return null;})}):fJ=="Sundials"?A.iter(fE,Z.to_rows(fH.to_sundials().simulate())):(function(fL){return function(fM){return fL("The "+_2.toSafe(fM)+" simulator cannot be used here");};}(F.FailWith))(_1.get_to_string(fH.settings.simulator));};e.simulateMeanStdev=function(fB,fC,fD,fE,fF,fG){var fH,fI;fH=e.prepare_CRN_for_sim(fB,fC,fD);fI=fH.settings.simulator;fI=="LNA"?fH.to_lna().simulate_callback(fG,fE):fI=="CME"?fH.simulate_cme_callback(fG,a.ignore,fE):fI=="MC"?F.FailWith("MC simulator cannot be invoked this way"):F.FailWith("simulator does not return mean+stdev");};e.simulateSpatial1D=function(fB,fC,fD,fE,fF,fG){var fH;fH=e.prepare_CRN_for_sim(fB,fC,fD);fH.settings.simulator=="PDE"?fH.settings.spatial.dimensions===1?_5.simulate_1d_callback(fG,fE,fH.to_pde1d()):F.FailWith("wrong number of dimensions"):F.FailWith("simulator does not return 1d spatial");};e.simulateSpatial2D=function(fB,fC,fD,fE,fF,fG){var fH;fH=e.prepare_CRN_for_sim(fB,fC,fD);fH.settings.simulator=="PDE"?fH.settings.spatial.dimensions===2?_5.simulate_2d_callback(fG,fE,fH.to_pde2d()):F.FailWith("wrong number of dimensions"):F.FailWith("simulator does not return 2d spatial");};e.simulateMeanStdevTable=function(fB,fC,fD,fE,fF,fG){var fH;fH=e.prepare_CRN_for_sim(fB,fC,fD);fH.settings.stochastic.trajectories>1?fH.to_ssa().simulate_trajectories_callback(fG,fE):F.FailWith("simulator does not return mean+stdev table");};e.convert_state_space=function(fB,fC){var fD,fE,fF,fG;function fH(fJ){var fK;fK=fC(fJ);fF.push(fK);return fK.name;}function fI(fJ,fK){var fL;fL=fK[1];return function(fM){return j.New(fM.species,U.ofList(A.map(function(fN){return i.New(_9.find(fD,fN.target),R.to_string(a.id,fN.propensity));},fL)));};}fD=_9.empty();fE=U.ofSeq(_9.toSeq(fB.ctmc.graph));fF=[];return k.New((fG=U.mapi(function(fJ,fK){var fL;fL=fK[0];_9.add(fD,fL,fJ);return j.New(bb.of_list(A.ofSeq(bc.map(function(fM){return[fH(U.get(fB.to_species,fM.K)),fM.V];},fL))),[]);},fE),(((fu.Curried3(U.mapi2))(function(fJ,fK,fL){return(fI(fJ,fK))(fL);}))(fE))(fG)),_9.find(fD,fB.ctmc.initial_state),fF.slice());};e.simulateMeanStdevProbabilities=function(fB,fC,fD,fE,fF,fG,fH){var fI,fJ,fK,fL;function fM(fO){return bb.find(fO.name,fI.attributes);}function fN(fO){fE(e.convert_state_space(fO,fM));}fI=e.prepare_CRN_for_sim(fB,fC,fD);fJ=(fK=fI.settings.simulator,fK=="CME"?fI.simulate_cme_callback(fH,fN,fF):fK=="CMESundials"?(fI.simulate_cmesundials_callback(fH,fN,fF))[0]:F.FailWith("simulator does not return mean+stdev and probabilities"));fL=new bd.New$5();U.iter(function(fO){fL.Add(fO.species.name,fO.species);},fJ.simulator.populations.index_to_species);return fJ.probabilities;};e.getProbabilityMap=function(fB,fC,fD){var fE,fF;fE=bh.get_bounds(fB,fC);fF=fE[2];return h.New(bg.get_times(fB),A.init(fE[1]-fF+1,function(fG){return fG+fF;}),bh.probability_map({$:1,$0:fD},fB,fC));};e.simulateFloatJIT=function(fB,fC,fD,fE,fF,fG,fH){var fI,fJ,fK,fL,fM,fN;bi.simulate_callback(fH,fD,fE,fC.jit,fC.calculus);fM=fB.top.to_crn();fN=bi.to_crn(fC.jit,fM);fJ="";try{fJ=S.to_string(M.get_default_svg_style(),M.initials_to_svg(fN));}catch(fO){fJ=fO.message;}fF(f.New("image/svg+xml","finals","Finals",{$:1,$0:fB.top.name},null,{$:1,$0:[fJ]},null));fK="";try{fK=S.to_string(M.get_default_svg_style(),M.reactions_to_svg(fN));}catch(fP){fK=fP.message;}fF(f.New("image/svg+xml","reactions","Reactions",{$:1,$0:fB.top.name},null,{$:1,$0:[fK]},null));fL="";try{fL=fN.to_string();}catch(fQ){fL=fQ.message;}fF(f.New("text/plain","code","Code",{$:1,$0:fB.top.name},null,{$:1,$0:[fL]},null));fG(N.New(null,K.OfArray(U.ofSeq(A.ofArray([["",bj.New(z.from_crn(M.New(fN.name,fN.settings,fN.reactions,fM.initials,fN.attributes).saturate_initials()),B.Empty)]]))),new y.New([]),false));};e.simulator_to_value_type=function(fB){var fC,fD,fE;fD=fB.simulator;switch(fD=="CME"?1:fD=="CMESundials"?1:fD=="Oslo"?2:fD=="SSA"?3:fD=="Sundials"?4:fD=="PDE"?5:fD=="MC"?6:0){case 0:return"MeanStdev";case 1:return"MeanStdevProbabilities";case 2:return"Float";case 3:return fB.stochastic.trajectories>1?"MeanStdevTable":"Float";case 4:return"Float";case 5:fE=fB.spatial.dimensions;return fE===1?"Spatial1D":fE===2?"Spatial2D":F.FailWith("unsupported number of dimensions");case 6:return"MeanStdev";}};e.user_get_sim_runs=function(fB,fC){var fD,fE,fF;fD=E.expandAndLift(fB.to_ig()).nodes.get_Item(fC);fE=(fF=fD.systems,fF.$==1?fF.$0.settings:fD.top.settings);A.iter(function(fG){if(!bk.Equals(fG.settings.simulator,fE.simulator))F.FailWith("Systems with different simulators are not supported");},fD.systems);return g.New(e.simulator_to_value_type(fE),e.get_instances(fB,fC));};e.user_parse_code=function(fB){return N.from_ig(e.parse_code(fB));};e.model_to_single_export=function(fB,fC,fD){var fE,fF,fG,fH,fI,fJ,fK,fL;fK=fB.nodes.get_Item(fC).saturate_initials();if(fD==="code"){fE="";try{if(fC==="")fE=J.New(fB.task,K.OfArray(U.ofSeq(A.ofArray([["",fK]]))),new y.New([]),false).to_string();else fE=fK.string();}catch(fM){fE=fM.message;}return f.New("text/plain",fD,"Code",{$:1,$0:fC},null,{$:1,$0:[fE]},null);}else if(fD==="sbml"){fF="";try{fF=bl.to_xml(fK.to_sbml());}catch(fN){fF=fN.message;}return f.New("text/plain",fD,"SBML",{$:1,$0:fC},null,{$:1,$0:[fF]},null);}else if(fD==="initials"){fG="";try{fG=S.to_string(M.get_default_svg_style(),L.initials_to_svg(fK));}catch(fO){fG=fO.message;}return f.New("image/svg+xml",fD,"Initials",{$:1,$0:fC},null,{$:1,$0:[fG]},null);}else if(fD==="finals")return f.New("image/svg+xml",fD,"Finals",{$:1,$0:fC},null,{$:1,$0:["Finals not available for single export"]},null);else if(fD==="reactions"){fH=[];try{fH=U.ofList(A.map((fL=M.get_default_svg_style(),function(fP){return S.to_string(fL,fP);}),L.reactions_to_svgs(fK)));}catch(fP){fH=[fP.message];}fI="";try{fI=S.to_string(M.get_default_svg_style(),L.reactions_to_svg(fK));}catch(fQ){fI=fQ.message;}return f.New("image/svg+xml",fD,"Reactions",{$:1,$0:fC},null,{$:1,$0:fH},{$:1,$0:fI});}else if(fD==="matlab"){fJ="";try{fJ=fK.to_matlab();}catch(fR){fJ=fR.message;}return f.New("text/plain",fD,"Matlab",{$:1,$0:fC},null,{$:1,$0:[fJ]},null);}else return f.New("text/plain",fD,fD,{$:1,$0:fC},null,{$:1,$0:["Unknown export ID "+fD]},null);};e.model_to_export=function(fB,fC,fD){var fE,fF,fG;fG=fC.nodes.get_Item(fD).saturate_initials();try{fE=fB?null:{$:1,$0:S.to_string(M.get_default_svg_style(),L.initials_to_svg(fG))};}catch(fH){fE={$:1,$0:fH.message};}try{fF=fB?{$:1,$0:S.to_string(M.get_default_svg_style(),L.initials_to_svg(fG))}:{$:1,$0:""};}catch(fI){fF={$:1,$0:fI.message};}return[f.New("text/plain","code","Code",{$:1,$0:fD},null,null,null),f.New("text/plain","sbml","SBML",{$:1,$0:fD},null,null,null),f.New("image/svg+xml","initials","Initials",{$:1,$0:fD},null,fE==null?null:{$:1,$0:[fE.$0]},null),f.New("image/svg+xml","finals","Finals",{$:1,$0:fD},null,fF==null?null:{$:1,$0:[fF.$0]},null),f.New("image/svg+xml","reactions","Reactions",{$:1,$0:fD},null,null,null),f.New("text/plain","matlab","Matlab",{$:1,$0:fD},null,null,null)];};e.user_get_exports=function(fB,fC,fD){return e.model_to_export(fB,fC.to_ig(),fD);};e.user_get_export=function(fB,fC,fD){return e.model_to_single_export(fB.to_ig(),fC,fD);};e.convert_evaluated_values=function(fB){var fC,fD;return l.New((fC=fB.values,(fD=new bd.New$5(),(U.iter(function(fE){fD.Add(fE,fC.Item(fE));},fC.get_Names()),fD))),fB.logLikelihood);};e.convert_inference_result=function(fB,fC,fD){var fE,fF,fG;function fH(fI){var fJ;fJ=new bd.New$5();U.iter(function(fK){fJ.Add(fK,fI.Item(fK));},fI.get_Names());return fJ;}return o.New(fB,fC.iteration,fD,(fE=fC.state,fE.$==1?(fF=fE.$0,{$:1,$0:n.New(fH(fF.space),e.convert_evaluated_values(fF.state),fF.thinningSkippedCount,A.map(e.convert_evaluated_values,fF.chain),e.convert_evaluated_values(fF.mle),fF.priors,fF.indexes)}):(fG=fE.$0,{$:0,$0:m.New(fH(fG.space),e.convert_evaluated_values(fG.state),fG.stats,e.convert_evaluated_values(fG.mle),fG.priors,fG.indexes)})),fD?{$:1,$0:fC.mlesims}:null,fC.summary);};e.combine_dynchar_exports=function(fB){var fC,fD;return fB.$==1&&(fB.$1.$==0&&(fC=fB.$0[1],true))?f.New("text/html","dynamicCharacterization","Dynamic Characterization",null,null,{$:1,$0:[bz.structured_tabbed_embedded("top_tabs",fC)]},{$:1,$0:bz.structured_tabbed("","top_tabs",fC)}):(fD=A.ofSeq(A.mapi(function(fE,fF){return[fF[0],bz.structured_tabbed_embedded((function(fG){return function(fH){return fG("group"+a.String(fH));};}(a.id))(fE),fF[1])];},fB)),f.New("text/html","dynamicCharacterization","Dynamic Characterization",null,null,{$:1,$0:[bz.make_embedded(bz.arbitrary_tabbed_content("top_tabs",fD))]},{$:1,$0:bz.arbitrary_tabbed("Dynamic Characterisation",fD)}));};e.user_infer_gui=function(fB,fC,fD,fE,fF){var fG,fH;fG=E.expandAndLift(fB.to_ig());fH=[];E.inferWith(function(fI){var fJ,fK,fL,fM,fN;function fO(fP,fQ,fR){return fP!=null&&fP.$==1?{$:1,$0:e.convert_inference_result(fI.top.name,fP.$0,fR)}:null;}fJ=null;fK=fI.infer_seq(function(fP){fJ={$:1,$0:fP};});fL=A.map(function(fP){var fQ;return q.New(fP.name,p.New((fQ=fP.range.pType,fQ.$==1?"Log":fQ.$==2?"Fixed":"Real"),fP.range.lb,fP.range.ub),fP.initValue);},fK[1]);fM=bc.choose(function(fP){return fO(fP[0],fP[1],fP[2]);},fK[0]);fD(r.New(fI.top.name,fL));bc.iter(fE,fM);fJ==null?void 0:(fN=fJ.$0,fN.posterior.$!==0?fH.push([fI.top.name,bB.results_to_html_content(bB.mcmc_to_results(fI.top.settings,fI,fN))]):void 0);return fJ.$0.to_summary();},fG);fC(e.combine_dynchar_exports(A.ofSeq(fH)));};e.user_state_space=function(fB){var fC;fC=(bc.head(K.ToSeq(fB.nodes)))[1].top.to_crn();return e.convert_state_space(fC.to_ctmc(),function(fD){return bb.find(fD.name,fC.attributes);});};e.user_state_space_jit=function(fB){var fC;fC=bi.to_ctmc(fB.jit,fB.calculus);return e.convert_state_space(fC[0],fC[1]);};e.expression_to_string=function(fB){return R.to_string(a.id,fB);};e.mcplot_to_string=function(fB){return bD.to_string_monomial(fB);};e.test_crn_deterministic=function(fB){var fC;fC=D.from_string(M.get_parse(),fB).to_oslo().simulate();return t.New(U.ofList(fC.times),U.ofList(A.map(function(fD){return s.New(fD.name,U.ofList(fD.values));},fC.columns)));};e.test_crn_sundials=function(fB){var fC;fC=D.from_string(M.get_parse(),fB).to_sundials().simulate();return t.New(U.ofList(fC.times),U.ofList(A.map(function(fD){return s.New(fD.name,U.ofList(fD.values));},fC.columns)));};e.prepare_for_cme=function(fB){var fC;fC=D.from_string(M.get_parse(),fB);return[fC.to_cme(fC.to_ctmc()),bF.to_env(fC.settings.parameters),M.to_inlined_rates(fC.settings)];};e.test_crn_cme_sundials=function(fB){var fC,fD;fC=e.prepare_for_cme(fB);fD=(fC[0].simulate_sundials(fC[1],fC[2]))[1];return t.New(U.ofList(fD.times),U.ofList(A.map(function(fE){return s.New(fE.name,U.ofList(fE.values));},fD.columns)));};f.New=function(fB,fC,fD,fE,fF,fG,fH){return{content_type:fB,id:fC,display_name:fD,node_id:fE,instance:fF,content:fG,save_content:fH};};g.New=function(fB,fC){return{value_type:fB,instances:fC};};h.New=function(fB,fC,fD){return{times:fB,values:fC,probabilities:fD};};i.New=function(fB,fC){return{target:fB,propensity:fC};};j.New=function(fB,fC){return{species:fB,transitions:fC};};k.New=function(fB,fC,fD){return{states:fB,start_index:fC,attributes:fD};};l.New=function(fB,fC){return{values:fB,lglk:fC};};m.New=function(fB,fC,fD,fE,fF,fG){return{space:fB,state:fC,stats:fD,mle:fE,priors:fF,indexes:fG};};n.New=function(fB,fC,fD,fE,fF,fG,fH){return{space:fB,state:fC,thinningSkippedCount:fD,chain:fE,mle:fF,priors:fG,indexes:fH};};o.New=function(fB,fC,fD,fE,fF,fG){return{nodeId:fB,iteration:fC,lkincreased:fD,state:fE,mlesims:fF,summary:fG};};p.New=function(fB,fC,fD){return{pType:fB,lb:fC,ub:fD};};q.New=function(fB,fC,fD){return{name:fB,range:fC,initValue:fD};};r.New=function(fB,fC){return{nodeId:fB,parameters:fC};};s.New=function(fB,fC){return{name:fB,values:fC};};t.New=function(fB,fC){return{times:fB,columns:fC};};u.decodeIG=function(fB){return(bL.j$60())(fB);};u.encodeIG=function(fB){return(bM.j$13())(fB);};u.decodeModel=function(fB){return(bL.j$17())(fB);};u.encodeModel=function(fB){return(bM.j$16())(fB);};u.user_parse_code=function(fB){return(bM.j$13())(e.user_parse_code(fB));};u.user_get_exports=function(fB,fC,fD){var fE;fE=e.user_get_exports(fB,u.decodeIG(fC),fD);return((cj.EncodeArray(bM.j))())(fE);};u.user_get_export=function(fB,fC,fD){return(bM.j())(e.user_get_export(u.decodeIG(fB),fC,fD));};u.user_infer_gui=function(fB,fC,fD,fE,fF){e.user_infer_gui(u.decodeIG(fB),function(fG){fC((bM.j())(fG));},function(fG){fD((bM.j$105())(fG));},function(fG){fE((bM.j$82())(fG));},fF);};u.user_state_space=function(fB){return(bM.j$8())(e.user_state_space(u.decodeIG(fB)));};u.user_state_space_jit=function(fB){return(bM.j$8())(e.user_state_space_jit(fB));};u.user_get_sim_runs=function(fB,fC){return(bM.j$79())(e.user_get_sim_runs(u.decodeIG(fB),fC));};u.simulateFloat=function(fB,fC,fD,fE,fF,fG){e.simulateFloat(u.decodeIG(fB),fC,(bL.j$13())(fD),function(fH){fE((bM.j$78())(fH));},function(fH){fF((bM.j())(fH));},fG);};u.simulateFloatJIT=function(fB,fC,fD,fE,fF,fG,fH){e.simulateFloatJIT(u.decodeModel(fB),fC,function(fI){fD((bM.j$78())(fI));},function(fI){fE((bM.j$77())(fI));},function(fI){fF((bM.j())(fI));},function(fI){fG((bM.j$13())(fI));},fH);};u.simulateMeanStdev=function(fB,fC,fD,fE,fF,fG){e.simulateMeanStdev(u.decodeIG(fB),fC,(bL.j$13())(fD),function(fH){fE((bM.j$12())(fH));},function(fH){fF((bM.j())(fH));},fG);};u.simulateMeanStdevProbabilities=function(fB,fC,fD,fE,fF,fG,fH){return(bM.j$7())(e.simulateMeanStdevProbabilities(u.decodeIG(fB),fC,(bL.j$13())(fD),function(fI){fE((bM.j$8())(fI));},function(fI){fF((bM.j$12())(fI));},function(fI){fG((bM.j())(fI));},fH));};u.getProbabilityMap=function(fB,fC,fD){return(bM.j$6())(e.getProbabilityMap((bL.j$16())(fB),fC,fD));};u.simulateSpatial1D=function(fB,fC,fD,fE,fF,fG){e.simulateSpatial1D(u.decodeIG(fB),fC,(bL.j$13())(fD),function(fH){fE((bM.j$5())(fH));},function(fH){fF((bM.j())(fH));},fG);};u.simulateSpatial2D=function(fB,fC,fD,fE,fF,fG){e.simulateSpatial2D(u.decodeIG(fB),fC,(bL.j$13())(fD),function(fH){fE((bM.j$4())(fH));},function(fH){fF((bM.j())(fH));},fG);};u.simulateMeanStdevTable=function(fB,fC,fD,fE,fF,fG){e.simulateMeanStdevTable(u.decodeIG(fB),fC,(bL.j$13())(fD),function(fH){fE((bM.j$1())(fH));},function(fH){fF((bM.j())(fH));},fG);};u.expression_to_string=function(fB){return e.expression_to_string((bL.j$7())(fB));};u.mcplot_to_string=function(fB){return e.mcplot_to_string((bL.j())(fB));};w=v.Obj=fu.Class({Equals:function(fB){return this===fB;},GetHashCode:function(){return -1;}},null,w);w.New=fu.Ctor(function(){},w);y=x.FSharpMap=fu.Class({get_Item:function(fB){var fC;fC=this.TryFind(fB);return fC==null?F.FailWith("The given key was not present in the dictionary."):fC.$0;},TryFind:function(fB){var fC;fC=cx.TryFind(cz.New(fB,void 0),this.tree);return fC==null?null:{$:1,$0:fC.$0.Value};},ContainsKey:function(fB){return cx.Contains(cz.New(fB,void 0),this.tree);},get_Count:function(){var fB;fB=this.tree;return fB==null?0:fB.Count;},get_Tree:function(){return this.tree;},Add:function(fB,fC){return new y.New$1(cx.Add(cz.New(fB,fC),this.tree));},get_IsEmpty:function(){return this.tree==null;},GetEnumerator$1:function(){return da.Get(bc.map(function(fB){return{K:fB.Key,V:fB.Value};},cx.Enumerate(false,this.tree)));},Equals:function(fB){return this.get_Count()===fB.get_Count()&&bc.forall2(bk.Equals,this,fB);},Remove:function(fB){return new y.New$1(cx.Remove(cz.New(fB,void 0),this.tree));},GetHashCode:function(){return bk.Hash(U.ofSeq(this));},GetEnumerator:function(){return this.GetEnumerator$1();},GetEnumerator0:function(){return this.GetEnumerator$1();},CompareTo0:function(fB){return bc.compareWith(bk.Compare,this,fB);}},w,y);y.New=fu.Ctor(function(fB){y.New$1.call(this,dQ.fromSeq(fB));},y);y.New$1=fu.Ctor(function(fB){w.New.call(this);this.tree=fB;},y);z=d.Gui=fu.Class({to_crn:function(){var fB,fC,fD,fE,fF,fG,fH,fI,fJ,fK;function fL(fN){return R.from_string(D.name(),fN);}function fM(fN){return R.from_string(D.name(),fN);}fB=(fC=be.get_from_string(),function(fN){return cc.map(fC,fL,Q.from_string,fN);});fD=(fE=be.get_from_string(),function(fN){return V.from_gui(fE,fM,fN);});fF=this.settings.map_plots(Q.from_string,Q.from_string_plot);return M.New(this.name,fF.map((fG=(fH=fF.rates,function(fN){return M.species_to_rates(fH,fN);}),function(fN){return R.map(fG,fN);})),A.map((fI=(fJ=(fK=fF.rates,function(fN){return M.species_to_rates(fK,fN);}),function(fN){return R.map(fJ,fN);}),function(fN){return cc.map(a.id,a.id,fI,fN);}),A.map(fB,this.reactions)),A.map(fD,this.initials),this.attributes);}},null,z);z.from_crn=function(fB){var fC,fD;return z.New(fB.name,fB.settings.map_plots(Q.to_string,Q.to_string_plot),A.map((fC=function(fE){return R.to_string(a.id,fE);},function(fE){return cc.map(be.to_string,fC,Q.to_string,fE);}),fB.reactions),A.map((fD=function(fE){return R.to_string(a.id,fE);},function(fE){return V.to_gui(be.to_string,fD,fE);}),fB.initials),fB.attributes);};z.New=function(fB,fC,fD,fE,fF){return new z({name:fB,settings:fC,reactions:fD,initials:fE,attributes:fF});};B=A.T=fu.Class({get_Length:function(){return A.length(this);},get_Item:function(fB){return bc.nth(fB,this);},GetSlice:function(fB,fC){var fD;return fB!=null&&fB.$==1?fC!=null&&fC.$==1?(fD=fB.$0,A.ofSeq(bc.take(fC.$0-fD+1,A.skip(fD,this)))):A.skip(fB.$0,this):fC!=null&&fC.$==1?A.ofSeq(bc.take(fC.$0+1,this)):this;},GetEnumerator:function(){return new dc.New(this,null,function(fB){var fC;fC=fB.s;return fC.$==0?false:(fB.c=fC.$0,fB.s=fC.$1,true);},void 0);},GetEnumerator0:function(){return da.Get(this);}},null,B);B.Empty=new B({$:0});C=d.Instance=fu.Class({update_environment:function(fB){return C.New(this.model,this.sweep,this.assignment,new y.New(bc.concat([K.ToSeq(this.environment),K.ToSeq(fB)])),this.settings,this.name);}},null,C);C.create$5=function(fB,fC,fD,fE,fF,fG){return C.New(fB,fC,fD,fE,fF,fG);};C.same_sweep=function(fB,fC){return fB.model===fC.model&&fB.sweep===fC.sweep;};C.New=function(fB,fC,fD,fE,fF,fG){return new C({model:fB,sweep:fC,assignment:fD,environment:fE,settings:fF,name:fG});};D.from_string_first_error_with_msg=function(fB,fC){var fD,fG,fH,fI,fJ,fK,fL,fM,fN;function fE(fO){var fP;fP=D.run(D.manySatisfy(function(fQ){return fQ!==" "&&fQ!=="\\n"&&fQ!=="\\r";}),fO);return fP.$==1?"input":(function(fQ){return function(fR){return fQ("\'"+_2.toSafe(fR)+"\'");};}(a.id))(fP.$0);}function fF(fO,fP,fQ,fR){return{$:1,$0:I.New(fP,fQ,(function(fS){return function(fT){return fS("Unexpected "+_2.toSafe(fT)+".");};}(a.id))(fO)+(fR!==""?"\\nExpecting: "+fR:""))};}fG=D.do_run(fB,fC);switch(fG.$==1?fG.$1[0]===""?(fD=fG.$0,0):(fD=[fG.$1[1][1],fG.$1[1][0],fG.$1[0]],1):fG.$==2?(fD=[fG.$1[1],fG.$0,fG.$1[0]],2):fG.$==3?(fD=[fG.$1[1],fG.$0,fG.$1[0]],2):fG.$1[0]===""?(fD=fG.$0,0):(fD=[fG.$1[1][1],fG.$1[1][0],fG.$1[0]],1)){case 0:return{$:0,$0:fD};case 1:fH=fD[0];fI=fD[1];fJ=fD[2];return fJ===""?fF("end of input",fI+1,fH,""):fF(fE(fJ),fI+1,fH,"");case 2:fK=fD[0];fL=fD[1];fM=fD[2];fN=U.get(dk.SplitStrings(fC,["\\n","\\r\\n"],0),fM).substring(fK);return fN===""?fF("end of input",fM+1,fK,fL):fF(fE(fN),fM+1,fK,fL);}};D.from_string=function(fB,fC){var fD,fE,fF,fG,fH;fE=D.do_run(fB,fC);switch(fE.$==1?fE.$1[0]===""?(fD=fE.$0,0):(fD=[fE.$1[1][1],fE.$1[1][0],fE.$0,fE.$1[0]],1):fE.$==2?(fD=[fE.$1[1],fE.$0,fE.$1[0]],2):fE.$==3?(fD=[fE.$1[1],fE.$0,fE.$1[0]],2):fE.$1[0]===""?(fD=fE.$0,0):(fD=[fE.$1[1][1],fE.$1[1][0],fE.$0,fE.$1[0]],1)){case 0:return fD;case 1:fF=fD[0];fG=fD[1];throw new H.New((((fu.Curried3(function(fI,fJ,fK){return fI("Unexpected end of input at row "+a.String(fJ)+" column "+a.String(fK));}))(a.id))(fG))(fF),[I.New(fG+1,fF,(function(fI){return function(fJ){return fI("unexpected end of input at column "+a.String(fJ));};}(a.id))(fF))]);case 2:fH=fD[1];throw new H.New(fH,[I.New(fD[2]+1,fD[0],fH)]);}};D.run=function(fB,fC){var fD,fE,fF,fG,fH;fD=D.do_run(fB,fC);return fD.$==1?{$:0,$0:fD.$0,$1:fD.$1[0],$2:fD.$1[1]}:fD.$==2?(fE=fD.$1,(fF=fD.$0,{$:1,$0:D.errMsg(fF,fE[0],fE[1]),$1:fF,$2:fC})):fD.$==3?(fG=fD.$1,(fH=fD.$0,{$:1,$0:D.errMsg(fH,fG[0],fG[1]),$1:fH,$2:fC})):{$:0,$0:fD.$0,$1:fD.$1[0],$2:fD.$1[1]};};D.manySatisfy=function(fB){return function(fC){var fD,fE,fF,fG,fH,fI;function fJ(fK){return!fK;}fD=fC[0];fE=fC[1];fF=U.tryFindIndex(function(fK){return fJ(fB(fK));},dk.ToCharArray(fD));return fF!=null&&fF.$==1?(fG=fF.$0,(fH=dk.Substring(fD,0,fG),(fI=fD.substring(fG),fH.length>0?{$:1,$0:fH,$1:[fI,D.move(fH,fE)]}:{$:0,$0:fH,$1:[fI,D.move(fH,fE)]}))):{$:0,$0:fD,$1:["",D.add_cols(fD.length,fE)]};};};D.do_run=function(fB,fC){return(D.op_DotGreaterGreater(D.op_GreaterGreaterDot(D.spaces(),fB),D.spaces()))([fC,D.start_pos()]);};D.name=function(){dO.$cctor();return dO.name;};D.spaces=function(){dO.$cctor();return dO.spaces;};D.errMsg=function(fB,fC,fD){return((((fu.Curried(function(fE,fF,fG,fH){return fE("Expecting "+_2.toSafe(fF)+" at row "+a.String(fG)+" column "+a.String(fH));},4))(a.id))(fB))(fC+1))(fD+1);};D.move=function(fB,fC){var fD,fE;fD=dk.SplitStrings(fB,D.lineSeparators(),0);fE=U.length(fD)-1;return[fC[0]+fE,fE===0?fC[1]+U.get(fD,fE).length:U.get(fD,fE).length];};D.add_cols=function(fB,fC){return[fC[0],fC[1]+fB];};D.op_DotGreaterGreater=function(fB,fC){return D.op_BarGreaterGreater(D.op_DotGreaterGreaterDot(fB,fC),function(fD){return fD[0];});};D.op_GreaterGreaterDot=function(fB,fC){return D.op_BarGreaterGreater(D.op_DotGreaterGreaterDot(fB,fC),function(fD){return fD[1];});};D.start_pos=function(){dO.$cctor();return dO.start_pos;};D.op_GreaterGreaterEquals=function(fB,fC){return function(fD){var fE,fF;fE=fB(fD);return fE.$==1?(fF=(fC(fE.$0))(fE.$1),fF.$==1?{$:1,$0:fF.$0,$1:fF.$1}:fF.$==2?{$:3,$0:fF.$0,$1:fF.$1}:fF.$==3?{$:3,$0:fF.$0,$1:fF.$1}:{$:1,$0:fF.$0,$1:fF.$1}):fE.$==2?{$:2,$0:fE.$0,$1:fE.$1}:fE.$==3?{$:3,$0:fE.$0,$1:fE.$1}:(fC(fE.$0))(fE.$1);};};D.choice=function(fB){return bc.isEmpty(fB)?D.failParser("Malformed grammar, choice is empty."):bc.fold(D.op_LessBarGreater,bc.head(fB),bc.skip(1,fB));};D.pchar=function(fB){return function(fC){var fD,fE;fD=fC[0];fE=fC[1];return fD.length>0&&fD[0]===fB?{$:1,$0:fD[0],$1:[fD.substring(1),D.add_cols(1,fE)]}:D.mk_failEmpty(fE,fB);};};D.preturn=function(fB){return function(fC){return{$:0,$0:fB,$1:fC};};};D.kw=function(fB){return D.op_DotGreaterGreater(function(fC){return D.pstringkw(fB,fC[0],fC[1]);},D.spaces());};D.opt=function(fB){return function(fC){var fD;fD=fB(fC);return fD.$==0?{$:0,$0:{$:1,$0:fD.$0},$1:fD.$1}:fD.$==2?{$:0,$0:null,$1:fC}:fD.$==3?{$:3,$0:fD.$0,$1:fD.$1}:{$:1,$0:{$:1,$0:fD.$0},$1:fD.$1};};};D.pTry=function(fB){return function(fC){var fD;fD=fB(fC);return fD.$==3?{$:2,$0:fD.$0,$1:fD.$1}:fD;};};D.record=function(fB,fC){var fD;function fE(fG,fH){return D.op_GreaterGreaterDot(D.kw(fG),D.op_GreaterGreaterDot(D.kw("="),fH));}function fF(fG,fH){return fH(fG);}return D.op_BarGreaterGreater(D.op_GreaterGreaterGreaterGreater(D.kw("{"),D.sepEndByAmb((fD=D.choice(A.map(function(fG){return fE(fG[0],fG[1]);},fC)),function(fG){return fD([fG[0],fG[1]]);}),D.kw("}"),D.skw(";"))),function(fG){return bc.fold(fF,fB,fG);});};D.op_BarGreaterGreater=function(fB,fC){return D.op_GreaterGreaterEquals(fB,function(fD){return D.preturn(fC(fD));});};D.pint32=function(){dO.$cctor();return dO.pint32;};D.op_DotGreaterGreaterDot=function(fB,fC){return D.op_GreaterGreaterEquals(fB,function(fD){return D.op_GreaterGreaterEquals(fC,function(fE){return D.preturn([fD,fE]);});});};D.name_kw=function(fB){return D.pTry(D.op_GreaterGreaterEquals(D.name(),function(fC){return A.contains(fC,fB)?D.failParser("Keyword found"):D.preturn(fC);}));};D.lineSeparators=function(){dO.$cctor();return dO.lineSeparators;};D.failParser=function(fB){return function(fC){return{$:2,$0:fB,$1:fC[1]};};};D.op_LessBarGreater=function(fB,fC){return function(fD){var fE,fF;fE=fB(fD);return fE.$==2?(fF=fC(fD),fF.$==2?{$:2,$0:fE.$0+" or "+fF.$0,$1:fF.$1}:fF):fE;};};D.mk_failEmpty=function(fB,fC){function fD(fE,fF){return{$:2,$0:fE,$1:fF};}return D.mk_error(function(fE){return fD(fE[0],fE[1]);},fB[0],fB[1],fC);};D.pstringkw=function(fB,fC,fD){var fE,fF;return dk.StartsWith(fC,fB)?fC.length===fB.length?{$:1,$0:fB,$1:[fC.substring(fB.length),D.add_cols(fB.length,fD)]}:(fE=fB[fB.length-1],D.isDigit(fE)||D.isLetter(fE)||fE==="_"?(fF=fC[fB.length],D.isDigit(fF)||D.isLetter(fF)||fF==="_"?D.mk_failEmpty(fD,(function(fG){return function(fH){return fG("\'"+_2.toSafe(fH)+"\'");};}(a.id))(fB)):{$:1,$0:fB,$1:[fC.substring(fB.length),D.add_cols(fB.length,fD)]}):{$:1,$0:fB,$1:[fC.substring(fB.length),D.add_cols(fB.length,fD)]}):D.mk_failEmpty(fD,(function(fG){return function(fH){return fG("\'"+_2.toSafe(fH)+"\'");};}(a.id))(fB));};D.op_GreaterGreaterGreaterGreater=function(fB,fC){return D.op_GreaterGreaterEquals(fB,function(){return fC;});};D.sepEndByAmb=function(fB,fC,fD){return D.op_LessBarGreater(D.op_GreaterGreaterGreaterGreater(fC,D.preturn(B.Empty)),D.sepEndBy1Amb(fB,fC,fD));};D.skw=function(fB){return D.op_GreaterGreaterDot(D.spaces(),D.kw(fB));};D.many1=function(fB){return D.op_BarGreaterGreater(D.op_DotGreaterGreaterDot(fB,D.many(fB)),function(fC){return new B({$:1,$0:fC[0],$1:fC[1]});});};D.add_rows=function(fB,fC){return[fC[0]+fB,fC[1]];};D.op_LessQmarkGreater=function(fB,fC){return function(fD){var fE;fE=fB(fD);return fE.$==2?{$:2,$0:fC,$1:fE.$1}:fE.$==3?{$:3,$0:fC,$1:fE.$1}:fE;};};D.isDigit=function(fB){return dZ.IsDigit(fB);};D.many1Satisfy=function(fB){return function(fC){var fD,fE;fD=fC[0];fE=fC[1];return fD.length>0&&fB(fD[0])?(D.manySatisfy(fB))([fD,fE]):D.mk_failEmpty(fE,"a string satisying a predicate");};};D.newline=function(){dO.$cctor();return dO.newline;};D.skipString=function(fB){return D.op_BarGreaterGreater(D.pstring(fB),a.ignore);};D.pstring=function(fB){return function(fC){var fD,fE;fD=fC[0];fE=fC[1];return dk.StartsWith(fD,fB)?{$:1,$0:fB,$1:[fD.substring(fB.length),D.add_cols(fB.length,fE)]}:D.mk_failEmpty(fE,(function(fF){return function(fG){return fF("\'"+_2.toSafe(fG)+"\'");};}(a.id))(fB));};};D.sign=function(){dO.$cctor();return dO.sign;};D.digits1=function(){dO.$cctor();return dO.digits1;};D.guarded=function(fB,fC){return function(fD){var fE,fF,fG,fH;fE=fD[0];fF=fC([fE,fD[1]]);return fF.$==1?(fG=fF.$1,D.do_guarded(fE,fG[0],fG[1],fB,function(fI,fJ){return{$:1,$0:fI,$1:fJ};})):fF.$==2?{$:2,$0:fF.$0,$1:fF.$1}:fF.$==3?{$:3,$0:fF.$0,$1:fF.$1}:(fH=fF.$1,D.do_guarded(fE,fH[0],fH[1],fB,function(fI,fJ){return{$:0,$0:fI,$1:fJ};}));};};D.opt_sign=function(){dO.$cctor();return dO.opt_sign;};D.isLetter=function(fB){return dZ.IsLetter(fB);};D.linebreak=function(){dO.$cctor();return dO.linebreak;};D.skipChar=function(fB,fC,fD){var fE,fF;return fC.length>0&&fB(fC[0])?(fE=U.contains((fF=fC[0],a.String(fF)),D.lineSeparators())?[fD[0]+1,0]:D.add_cols(1,fD),{$:1,$0:null,$1:[fC.substring(1),fE]}):D.mk_failEmpty(fD,"a char satisying predicate");};D.isWhiteSpace=function(fB){return dZ.IsWhiteSpace(fB);};D.keyword=function(){dO.$cctor();return dO.keyword;};D.eof=function(){dO.$cctor();return dO.eof;};D.CommentSingle=function(){dO.$cctor();return dO.CommentSingle;};D.manyUntil=function(fB,fC,fD,fE){var fF,fG;fF=[fD,fE];fG=fC(fF);return fG.$==1?{$:1,$0:B.Empty,$1:fG.$1}:fG.$==2?(D.op_GreaterGreaterEquals(fB,function(fH){return D.op_GreaterGreaterEquals(function(fI){return D.manyUntil(fB,fC,fI[0],fI[1]);},function(fI){return D.preturn(new B({$:1,$0:fH,$1:fI}));});}))(fF):fG.$==3?{$:3,$0:fG.$0,$1:fG.$1}:{$:0,$0:B.Empty,$1:fG.$1};};D.anyChar_INTERNAL=function(){dO.$cctor();return dO.anyChar_INTERNAL;};D.many=function(fB){return function(fC){var fD,fE,fF;fD=fB(fC);return fD.$==1?(fE=fD.$0,(D.op_GreaterGreaterEquals(D.many(fB),function(fG){var fH;fH=new B({$:1,$0:fE,$1:fG});return function(fI){return D.preturnConsumed(fH,fI[0],fI[1]);};}))(fD.$1)):fD.$==2?{$:0,$0:B.Empty,$1:fC}:fD.$==3?{$:3,$0:fD.$0,$1:fD.$1}:(fF=fD.$0,(D.op_GreaterGreaterEquals(D.many(fB),function(fG){return D.preturn(new B({$:1,$0:fF,$1:fG}));}))(fD.$1));};};D.commentLine=function(){dO.$cctor();return dO.commentLine;};D.commentMultiline=function(){return D.op_BarGreaterGreater(D.op_GreaterGreaterDot((D.keyword())(D.CommentStart()),D.commentMultilineShield(1)),a.ignore);};D.whiteSpace=function(){dO.$cctor();return dO.whiteSpace;};D.op_GreaterGreaterPercent=function(fB,fC){return D.op_BarGreaterGreater(fB,function(){return fC;});};D.mk_error=function(fB,fC,fD,fE){return fB([fE,[fC,fD]]);};D.sepEndBy1Amb=function(fB,fC,fD){return D.op_GreaterGreaterEquals(D.op_DotGreaterGreater(fB,D.spaces()),function(fE){var fF,fG;return D.op_GreaterGreaterEquals((fF=D.op_DotGreaterGreater(D.op_GreaterGreaterGreaterGreater(fD,fB),D.spaces()),(fG=D.op_BarGreaterGreater(D.op_LessBarGreater(fC,D.pTry(D.op_GreaterGreaterGreaterGreater(fD,fC))),a.ignore),function(fH){return D.manyUntil(fF,fG,fH[0],fH[1]);})),function(fH){return D.preturn(new B({$:1,$0:fE,$1:fH}));});});};D.list_of=function(fB){return D.op_GreaterGreaterGreaterGreater(D.kw("["),D.sepEndByAmb(fB,D.kw("]"),D.kw(";")));};D.sqBrackets=function(fB){return(D.bracket("[","]"))(fB);};D.chainl1Try=function(fB,fC){return D.op_BarGreaterGreater(D.op_DotGreaterGreaterDot(fB,D.many(D.pTry(D.op_DotGreaterGreaterDot(fC,fB)))),function(fD){return bc.fold(function(fE,fF){return(fF[0](fE))(fF[1]);},fD[0],fD[1]);});};D.do_guarded=function(fB,fC,fD,fE,fF){var fG;fG=fB.length-fC.length;return fF(fE(dk.Substring(fB,0,fG)),[fB.substring(fG),fD]);};D.preturnConsumed=function(fB,fC,fD){return{$:1,$0:fB,$1:[fC,fD]};};D.CommentStart=function(){dO.$cctor();return dO.CommentStart;};D.commentMultilineShield=function(fB){function fC(fD,fE){var fF,fG,fH,fI,fJ,fK,fL,fM;while(true){fH=fE[0];fI=fE[1];fJ=fI[1];fK=fI[0];fL=[fK,fJ];if(fD===0)return{$:0,$0:null,$1:[fH,[fK,fJ]]};else if(fH==="")return{$:3,$0:"missing \\"*)\\" to close an open comment",$1:[fK,fJ]};else{fM=(fF=D.CommentStart().length,fG=D.CommentEnd().length,dk.StartsWith(fH,D.CommentStart())?[fD+1,[fH.substring(fF),D.add_cols(fF,fL)]]:dk.StartsWith(fH,D.CommentEnd())?[fD-1,[fH.substring(fG),D.add_cols(fG,fL)]]:dk.StartsWith(fH,"\\r\\n")?[fD,[fH.substring(2),[fK+1,0]]]:dk.StartsWith(fH,"\\r")||dk.StartsWith(fH,"\\n")?[fD,[fH.substring(1),[fK+1,0]]]:[fD,[fH.substring(1),D.add_cols(1,fL)]]);fD=fM[0];fE=fM[1];}}}return function(fD){return fC(fB,fD);};};D.sepBy=function(fB,fC){return D.op_BarGreaterGreater(D.opt(D.sepBy1(fB,fC)),function(fD){return fD!=null&&fD.$==1?fD.$0:B.Empty;});};D.braces=function(fB){return(D.bracket("{","}"))(fB);};D.paren=function(fB){return(D.bracket("(",")"))(fB);};D.pfix=function(fB,fC){var fD;fD=D.choice([D.op_GreaterGreaterEquals(fB(fC),function(fE){return D.pfix(fB,fE);}),D.preturn(fC)]);return function(fE){return fD([fE[0],fE[1]]);};};D.pbool=function(){dO.$cctor();return dO.pbool;};D.pfloat=function(){dO.$cctor();return dO.pfloat;};D.bracket=function(fB,fC){var fD,fE;fD=D.kw(fB);fE=D.op_GreaterGreaterDot(D.spaces(),D.kw(fC));return function(fF){return D.between(fD,fE,fF);};};D.CommentEnd=function(){dO.$cctor();return dO.CommentEnd;};D.sepBy1=function(fB,fC){return D.op_BarGreaterGreater(D.op_DotGreaterGreaterDot(fB,D.many(D.op_GreaterGreaterDot(fC,fB))),function(fD){return new B({$:1,$0:fD[0],$1:fD[1]});});};D.lookAhead=function(fB){return function(fC){var fD,fE;fD=fC[0];fE=fC[1];return dk.StartsWith(fD,fB)?{$:0,$0:null,$1:[fD,fE]}:{$:2,$0:fB,$1:fE};};};D.op_GreaterGreaterPlus=function(fB,fC){return D.op_BarGreaterGreater(D.op_PlusGreaterGreaterPlus(fB,fC),function(fD){return fD[1];});};D.op_PlusGreaterGreaterPlus=function(fB,fC){return D.op_DotGreaterGreaterDot(fB,D.op_GreaterGreaterDot(D.spaces(),fC));};D.op_PlusGreaterGreater=function(fB,fC){return D.op_BarGreaterGreater(D.op_PlusGreaterGreaterPlus(fB,fC),function(fD){return fD[0];});};D.angleBrackets=function(fB){return(D.bracket("<",">"))(fB);};D.plookAheadWith=function(fB){return function(fC){var fD,fE,fF;fD=fC[1];fE=[fC[0],fD];fF=fB(fE);return fF.$==1?{$:0,$0:fF.$0,$1:fE}:fF.$==2?{$:2,$0:fF.$0,$1:fD}:fF.$==3?{$:2,$0:fF.$0,$1:fD}:{$:0,$0:fF.$0,$1:fE};};};D.between=function(fB,fC,fD){return D.op_DotGreaterGreater(D.op_GreaterGreaterDot(fB,fD),fC);};D.pcolour=function(){dO.$cctor();return dO.pcolour;};D.tuple_of=function(fB){return D.op_LessBarGreater(D.paren(D.sepBy2(fB,D.skw(","))),D.op_BarGreaterGreater(fB,function(fC){return A.ofArray([fC]);}));};D.satisfy=function(fB){return function(fC){var fD,fE,fF,fG;fD=fC[0];fE=fC[1];fF=bc.tryHead(fD);return fF==null?{$:2,$0:fD,$1:fE}:(fG=fF.$0,fB(fG)?{$:1,$0:fG,$1:[dk.Substring(fD,1,fD.length-1),(D.add_row())(fE)]}:{$:2,$0:fD,$1:fE});};};D.manyChars=function(fB){return D.op_BarGreaterGreater(D.op_BarGreaterGreater(D.many(fB),function(fC){return A.map(a.id,fC);}),function(fC){return dk.concat("",fC);});};D.sepBy2=function(fB,fC){return D.op_BarGreaterGreater(D.op_DotGreaterGreaterDot(fB,D.many1(D.op_GreaterGreaterDot(fC,fB))),function(fD){return new B({$:1,$0:fD[0],$1:fD[1]});});};D.add_row=function(){dO.$cctor();return dO.add_row;};E.parse=function(){cA.$cctor();return cA.parse;};E.expandAndLift=function(fB){var fC,fD,fE,fF;function fG(fI,fJ){var fK;fK=fJ.expandAndLift();return[[fI,fK[0]],[fJ.top.name,fK[1]]];}function fH(fI,fJ,fK){var fL,fM,fN,fO,fP,fQ,fR,fS,fT,fU,fV,fW,fX,fY,fZ,f0,f1,f2,f3;function f4(f6){return F.FailWith(((((((fu.Curried(function(f7,f8,f9,f_,f$,ga){return f7(_2.toSafe(f8)+" in edge "+_2.toSafe(f9)+"."+_2.toSafe(f_)+"->"+_2.toSafe(f$)+"."+_2.toSafe(ga));},6))(a.id))(f6))(fO))(fP))(fQ))(fR));}function f5(f6,f7){return[f6,f7,fN];}fL=fK[0];fM=fK[1];fN=fK[2];return fI.$==1?fJ.$==0?F.FailWith(((((fu.Curried(function(f6,f7,f8,f9){return f6("Unsupported edge "+_2.toSafe(f7)+"."+_2.toSafe(f8)+"->"+_2.toSafe(f9)+"; only node->node and system->system edges are supported.");},4))(a.id))(fI.$0[0]))(fI.$0[1]))(fJ.$0)):(fO=fI.$0[0],(fP=fI.$0[1],(fQ=fJ.$0[0],(fR=fJ.$0[1],(fS=(fT=fE.TryFind(fO),fT==null?f4((function(f6){return function(f7){return f6("Source node "+_2.toSafe(f7)+" not found");};}(a.id))(fO)):fT.$0),(fU=(fV=fE.TryFind(fQ),fV==null?f4((function(f6){return function(f7){return f6("Target node "+_2.toSafe(f7)+" not found");};}(a.id))(fQ)):fV.$0),(fW=(fX=fS.TryFind(fP),fX==null?f4((function(f6){return function(f7){return f6("Source system "+_2.toSafe(f7)+" not found");};}(a.id))(fP)):fX.$0),(fY=(fZ=fU.TryFind(fR),fZ==null?f4((function(f6){return function(f7){return f6("Target system "+_2.toSafe(f7)+" not found");};}(a.id))(fR)):fZ.$0),(f0=(f1=fW.TryFind(fL),f1==null?f4((function(f6){return function(f7){return f6("Source parameter "+_2.toSafe(f7)+" not found");};}(a.id))(fL)):f1.$0),(f2=(f3=fY.TryFind(fM),f3==null?f4((function(f6){return function(f7){return f6("Target parameter "+_2.toSafe(f7)+" not found");};}(a.id))(fM)):f3.$0),(f0.get_Length()!==f2.get_Length()?f4((((fu.Curried3(function(f6,f7,f8){return f6("Mismatched multiples count ("+a.String(f7)+" source, "+a.String(f8)+" target)");}))(a.id))(f0.get_Length()))(f2.get_Length())):void 0,A.map(function(f6){return f5(f6[0],f6[1]);},A.zip(f0,f2))))))))))))):fJ.$==1?F.FailWith(((((fu.Curried(function(f6,f7,f8,f9){return f6("Unsupported edge "+_2.toSafe(f7)+"->"+_2.toSafe(f8)+"."+_2.toSafe(f9)+"; only node->node and system->system edges are supported.");},4))(a.id))(fI.$0))(fJ.$0[0]))(fJ.$0[1])):A.ofArray([[fL,fM,fN]]);}fC=(fD=A.unzip(A.map(function(fI){return fG(fI[0],fI[1]);},A.ofSeq(K.ToSeq(fB.nodes)))),[K.OfArray(U.ofSeq(fD[0])),K.OfArray(U.ofSeq(fD[1]))]);fE=fC[1];fF=E.collectEdges(function(fI,fJ){return function(fK){return fH(fI,fJ,fK);};},J.New(fB.task,fC[0],fB.edges,fB.expanded));return J.New(fF.task,fF.nodes,fF.edges,true);};E.inferWith=function(fB,fC){var fD,fE,fF;fD=E.getNextCandidates(fC);return fD.$==0?B.Empty:(fE=A.map(function(fG){return[fG,fB(fC.nodes.get_Item(fG))];},fD),(fF=bc.fold(function(fG,fH){return E.updateGraph(fG,fH[0],fH[1]);},fC,fE),A.append(A.zip(fD,fE),E.inferWith(fB,fF))));};E.collectEdges=function(fB,fC){return J.New(fC.task,fC.nodes,K.Map(function(fD,fE){function fF(fG,fH){return[fG,A.collect(fB(fD,fG),fH)];}return A.map(function(fG){return fF(fG[0],fG[1]);},fE);},fC.edges),fC.expanded);};E.getNextCandidates=function(fB){var fC;return fB.nodes.get_IsEmpty()?B.Empty:(fC=E.getRoots(fB),fC.get_IsEmpty()?F.FailWith("Inference graph is not acyclic."):A.ofSeq(fC));};E.updateGraph=function(fB,fC,fD){var fE,fF,fG;fE=fB.nodes.get_Item(fC);fF=bc.fold(function(fH,fI){var fJ,fK;fJ=fI[1];fK=fH.nodes.get_Item(E.toNodeID(fJ));return J.New(fH.task,fH.nodes.Add(fK.top.name,E.applyEdgeToNode(fI[0],fJ,fI[2],fK)),fH.edges,fH.expanded);},fB,A.collect(function(fH){function fI(fJ,fK){function fL(fM,fN,fO){var fP;fP=K.TryFind(fM,fD.parameters);return fP==null?(function(fQ){return function(fR){return fQ("Error: cannot find parameter "+_2.toSafe(fR)+" in results");};}(F.FailWith))(fM):[fN,[fP.$0,fO]];}return[fH,fJ,K.OfArray(U.ofSeq(A.map(function(fM){return fL(fM[0],fM[1],fM[2]);},fK)))];}return fB.edges.ContainsKey(fH)?A.map(function(fJ){return fI(fJ[0],fJ[1]);},fB.edges.get_Item(fH)):B.Empty;},new B({$:1,$0:new bH({$:0,$0:fC}),$1:A.map(function(fH){return new bH({$:1,$0:[fC,fH.name]});},fE.systems)})));fG=new B({$:1,$0:new bH({$:0,$0:fC}),$1:A.map(function(fH){return new bH({$:1,$0:[fC,fH.name]});},fF.nodes.get_Item(fC).systems)});return J.New(fF.task,fF.nodes.Remove(fC),bc.fold(function(fH,fI){return fH.Remove(fI);},fF.edges,fG),fF.expanded);};E.pid=function(){cA.$cctor();return cA.pid;};E.parseTask=function(){cA.$cctor();return cA.parseTask;};E.pinferenceGraph=function(fB,fC,fD){return D.op_BarGreaterGreater(D.op_GreaterGreaterDot(D.spaces(),D.many1(E.pline(fC,fD))),function(fE){var fF;function fG(fH,fI){return function(fJ){return fJ.$==1?[fH,new B({$:1,$0:fJ.$0,$1:fI})]:[new B({$:1,$0:fJ.$0,$1:fH}),fI];};}fF=bc.fold(function(fH,fI){return(function(fJ){return fG(fJ[0],fJ[1]);}(fH))(fI);},[B.Empty,B.Empty],fE);return J.New(fB,K.OfArray(U.ofSeq(A.map(function(fH){return[fH.top.name,fH];},fF[0]))),K.Map(function(fH,fI){function fJ(fK,fL,fM){return[fM,fL];}return A.map(function(fK){return fJ(fK[0],fK[1],fK[2]);},fI);},K.OfArray(U.ofSeq(A.groupBy(function(fH){return a.id(fH[0],fH[1],fH[2]);},fF[1])))),false);});};E.getRoots=function(fB){var fC,fD,fE,fF;function fG(fI){return fI[1];}function fH(fI){return fI[0];}fC=new dh.New$1(cx.OfSeq(bc.map(function(fI){return fI[0];},K.ToSeq(fB.nodes))));fD=new dh.New$1(cx.OfSeq(bc.collect((fE=(fF=function(fI){return E.toNodeID(fH(fI));},function(fI){return A.map(fF,fI);}),function(fI){return fE(fG(fI));}),K.ToSeq(fB.edges))));return dg.Filter(function(fI){return!fD.Contains(fI);},fC);};E.toNodeID=function(fB){return fB.$==1?fB.$0[0]:fB.$0;};E.applyEdgeToNode=function(fB,fC,fD,fE){var fF;function fG(fI){var fJ,fK;return fD.ContainsKey(fI.name)?(fJ=fD.get_Item(fI.name),(fK=fJ[0],bX.New(fI.name,fK.mle,E.toPrior(fJ[1],fI.prior,fK,E.printLoc(fB),E.printLoc(fC))))):fI;}function fH(fI){var fJ;return fI.update_settings((fJ=fI.settings,O.New(fJ.simulation,fJ.simulations,fJ.stochastic,fJ.deterministic,fJ.spatial,fJ.inference,fJ.moment_closure,fJ.synthesis,fJ.data,fJ.units,fJ.simulator,fF(fI.settings.parameters),fJ.sweeps,fJ.rates,fJ.plot,fJ.quiet)));}fF=function(fI){return A.map(fG,fI);};return L.New(fH(fE.top),A.map(fH,fE.systems));};E.pline=function(fB,fC){var fD;fD=D.choice([D.op_GreaterGreaterEquals(D.op_DotGreaterGreaterDot(D.op_DotGreaterGreaterDot(D.op_DotGreaterGreater(D.op_GreaterGreaterDot(D.kw("edge"),E.plocation()),D.kw("->")),D.list_of(E.pparameter())),E.plocation()),function(fE){var fF;fF=fE[0];return D.preturn({$:1,$0:[fF[0],fF[1],fE[1]]});}),D.op_GreaterGreaterEquals(D.op_GreaterGreaterDot(D.kw("node"),E.pid()),function(fE){var fF;return D.op_BarGreaterGreater(D.record(L.New((fF=fB.top,M.New(fE,fF.settings,fF.reactions,fF.initials,fF.attributes)),fB.systems),A.ofArray([["systems",D.op_BarGreaterGreater(D.list_of(D.name()),function(fG){return function(fH){return L.New(fH.top,A.map(function(fI){return fC.ContainsKey(fI)?fC.get_Item(fI):F.FailWith("Undefined system "+fI+" in node "+fE);},fG));};})],["inference",D.op_BarGreaterGreater(b0.parse_defaults(fB.top.settings.inference),function(fG){return function(fH){var fI,fJ;return L.New((fI=fH.top,M.New(fI.name,(fJ=fH.top.settings,O.New(fJ.simulation,fJ.simulations,fJ.stochastic,fJ.deterministic,fJ.spatial,fG,fJ.moment_closure,fJ.synthesis,fJ.data,fJ.units,fJ.simulator,fJ.parameters,fJ.sweeps,fJ.rates,fJ.plot,fJ.quiet)),fI.reactions,fI.initials,fI.attributes)),fH.systems);};})]])),function(fG){return{$:0,$0:fG};});})]);return function(fE){return fD([fE[0],fE[1]]);};};E.toPrior=function(fB,fC,fD,fE,fF){var fG,fH,fI,fJ,fK,fL;return fB=="Normal"?(fG=fD.toNormalDist(),fC==null?F.FailWith(((((fu.Curried(function(fM,fN,fO,fP){return fM("Cannot propagate parameter "+_2.toSafe(fN)+"\'s fixed prior in "+_2.toSafe(fO)+" to normal prior in "+_2.toSafe(fP));},4))(a.id))(fD.name))(fE))(fF)):(fH=fC.$0,{$:1,$0:bW.New(fH.interval,fG,fH.variation)})):fB=="LogNormal"?(fI=fD.toLogNormalDist(),fC==null?F.FailWith(((((fu.Curried(function(fM,fN,fO,fP){return fM("Cannot propagate parameter "+_2.toSafe(fN)+"\'s fixed prior in "+_2.toSafe(fO)+" to lognormal prior in "+_2.toSafe(fP));},4))(a.id))(fD.name))(fE))(fF)):(fJ=fC.$0,{$:1,$0:bW.New(fJ.interval,fI,fJ.variation)})):fB=="TruncatedNormal"?(fK=fD.toTruncatedNormalDist(),fC==null?F.FailWith(((((fu.Curried(function(fM,fN,fO,fP){return fM("Cannot propagate parameter "+_2.toSafe(fN)+"\'s fixed prior in "+_2.toSafe(fO)+" to truncated normal prior in "+_2.toSafe(fP));},4))(a.id))(fD.name))(fE))(fF)):(fL=fC.$0,{$:1,$0:bW.New(fL.interval,fK,fL.variation)})):null;};E.printLoc=function(fB){return fB.$==1?fB.$0[0]+"."+fB.$0[1]:fB.$0;};E.plocation=function(){cA.$cctor();return cA.plocation;};E.pparameter=function(){cA.$cctor();return cA.pparameter;};F.FailWith=function(fB){throw new G(fB);};F.toInt=function(fB){var fC;fC=F.toUInt(fB);return fC>=2147483648?fC-4294967296:fC;};F.range=function(fB,fC){var fD;fD=1+fC-fB;return fD<=0?[]:bc.init(fD,function(fE){return fE+fB;});};F.toUInt=function(fB){return(fB<0?fv.ceil(fB):fv.floor(fB))>>>0;};F.KeyValue=function(fB){return[fB.K,fB.V];};F.step=function(fB,fC,fD){var fE;fE=F.Sign(fC);return bc.takeWhile(function(fF){return fE*(fD-fF)>=0;},bc.initInfinite(function(fF){return fB+fF*fC;}));};F.Sign=function(fB){return fB===0?0:fB<0?-1:1;};H=D.Exception=fu.Class({},G,H);H.New=fu.Ctor(function(fB,fC){this.message=fB;cG.setPrototypeOf(this,H.prototype);this.errors=fC;},H);I.New=function(fB,fC,fD){return{row:fB,column:fC,text:fD};};J=E.IGraph=fu.Class({to_string:function(){var fB,fC,fD,fE,fF,fG,fH,fI,fJ,fK;function fL(fN,fO){return fO;}function fM(fN,fO){return"system "+fN+" =\\n{"+fO.to_string()+"\\n}";}this.expanded?F.FailWith("Cannot convert an Inference Graph to string after it has been expanded."):void 0;fB=(fC=this.task,fC!=null&&fC.$==1?fC.$0.to_string()+"\\n":"");return this.nodes.get_Count()===0?fB:(fD=bc.map(function(fN){return fL(fN[0],fN[1]);},K.ToSeq(this.nodes)),(fE=bc.map(function(fN){return A.map(function(fO){return[fO.name,fO];},fN.systems);},fD),(fF=db.string_of_list(a.id,"\\n",A.map(function(fN){return fM(fN[0],fN[1]);},A.ofSeq(K.ToSeq(K.OfArray(U.ofSeq(bc.isEmpty(fE)?B.Empty:bc.fold(function(fN,fO){return A.append(fO,fN);},B.Empty,fE))))))),(fG=bc.isEmpty(fD)?"":(fH=A.head(A.ofSeq(fD)).top,M.New(fH.name,(fI=fH.settings,O.New(fI.simulation,fI.simulations,fI.stochastic,fI.deterministic,fI.spatial,b0.get_defaults(),fI.moment_closure,fI.synthesis,fI.data,fI.units,fI.simulator,fI.parameters,fI.sweeps,fI.rates,fI.plot,fI.quiet)),fH.reactions,fH.initials,fH.attributes).to_string()),(fJ=db.string_of_list(function(fN){return J.node_to_igraph_string(fN[0],fN[1]);},"\\n",A.ofSeq(K.ToSeq(this.nodes))),(fK=db.string_of_list(function(fN){return J.edge_to_igraph_string(fN[0],fN[1]);},"\\n",A.ofSeq(K.ToSeq(this.edges))),fB+fG+"\\n"+fF+"\\n"+(this.nodes.get_Count()===1?(bc.head(K.ToSeq(this.nodes)))[1].systems.$==0?"":fJ:fJ+"\\n"+fK)))))));}},null,J);J.node_to_igraph_string=function(fB,fC){return"node "+fB+"{"+"systems = ["+db.string_of_list(function(fD){return fD.name;},"; ",fC.systems)+"]; "+"inference = "+(b0.get_to_string())(fC.top.settings.inference)+"}";};J.edge_to_igraph_string=function(fB,fC){var fD;function fE(fF,fG){function fH(fI,fJ,fK){return fI+" = "+bI.get_to_string(fK);}return"["+db.string_of_list(function(fI){return fH(fI[0],fI[1],fI[2]);},"; ",fG)+"] "+fF.get_to_string();}fD="edge "+fB.get_to_string()+" -> ";return db.string_of_list(function(fF){return fD+fE.apply(null,fF);},"\\n",fC);};J.New=function(fB,fC,fD,fE){return new J({task:fB,nodes:fC,edges:fD,expanded:fE});};K.Map=function(fB,fC){return new y.New$1(cx.OfSeq(bc.map(function(fD){return cz.New(fD.Key,fB(fD.Key,fD.Value));},cx.Enumerate(false,fC.get_Tree()))));};K.ToSeq=function(fB){return bc.map(function(fC){return[fC.Key,fC.Value];},cx.Enumerate(false,fB.get_Tree()));};K.TryFind=function(fB,fC){return fC.TryFind(fB);};K.FoldBack=function(fB,fC,fD){return bc.fold(function(fE,fF){return fB(fF.Key,fF.Value,fE);},fD,cx.Enumerate(true,fC.get_Tree()));};K.OfArray=function(fB){return new y.New$1(cx.OfSeq(bc.map(function(fC){return cz.New(fC[0],fC[1]);},fB)));};K.Fold=function(fB,fC,fD){return bc.fold(function(fE,fF){return fB(fE,fF.Key,fF.Value);},fC,cx.Enumerate(false,fD.get_Tree()));};K.Iterate=function(fB,fC){bc.iter(function(fD){fB(fD.K,fD.V);},fC);};K.Filter=function(fB,fC){var fD;return new y.New$1((fD=U.ofSeq(bc.filter(function(fE){return fB(fE.Key,fE.Value);},cx.Enumerate(false,fC.get_Tree()))),cx.Build(fD,0,fD.length-1)));};L=d.Model=fu.Class({merge_shared_settings:function(){var fB;fB=this;return L.New(this.top,A.map(function(fC){var fD;return M.New(fC.name,(fD=fC.settings,O.New(fD.simulation,fD.simulations,fD.stochastic,fD.deterministic,fD.spatial,fD.inference,fD.moment_closure,fD.synthesis,fD.data,fD.units,fD.simulator,A.append(fB.top.settings.parameters,fC.settings.parameters),fD.sweeps,fD.rates,fD.plot,fD.quiet)),fC.reactions,fC.initials,fC.attributes);},this.systems));},saturate_initials:function(){return L.New(this.top.saturate_initials(),A.map(function(fB){return fB.saturate_initials();},this.systems));},string:function(){var fB;fB=A.map(function(fC){return(((fu.Curried3(function(fD,fE,fF){return fD("system "+_2.toSafe(fE)+" = { \\n"+_2.toSafe(fF)+"\\n}");}))(a.id))(fC.name))(fC.to_string());},this.systems);return dk.concat("\\n\\n",new B({$:1,$0:this.top.to_string(),$1:fB}));},to_sbml:function(){return this.systems.$==0?this.top.to_sbml():F.FailWith("SBML export not implemented for multi-system models.");},to_matlab:function(){return this.systems.$==0?this.top.to_matlab():F.FailWith("Matlab export not implemented for multi-system models.");},infer_seq:function(fB){var fC,fD;fC=this.to_list_infer();fD=cP.list_to_inference(fC[0],fC[1]);return[bc.scan(function(fE,fF){var fG;fG=fF[1];return[{$:1,$0:fF[0]},fG,fE[0]==null||fG>fE[1]];},[null,-a.Infinity,false],bc.map(function(fE){var fF;return[fE,(fF=fE.state,fF.$==1?fF.$0.mle.logLikelihood:fF.$0.mle.logLikelihood)];},bu.run_mcmc_seq(fD,fB))),fD.$==1?fD.$0.parameters:fD.$0.parameters];},expandAndLift:function(){var fB,fC;fB=this;fC=A.unzip(A.map(function(fD){var fE,fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO,fP;function fQ(fV){return fD.name+"."+fV;}function fR(fV){return A.exists(function(fW){return fW.name===fV;},fD.settings.parameters)?fQ(fV):fV;}function fS(fV){return R.map(fR,fV);}function fT(fV){var fW;return fV.$==0?{$:0,$0:fR(fV.$0)}:fV.$==1?(fW=fV.$0,{$:1,$0:fD.settings.rates.ContainsKey(fW)?fQ(fW):fW}):fV;}function fU(fV,fW){return[fQ(fV),fM(fW)];}fE=(fF=bF.expand_multiples(A.ofArray([fD.settings.simulation.sweeps.$==0?fD.settings.sweeps:A.filter(function(fV){return A.contains(fV.name,fD.settings.simulation.sweeps);},A.append(fD.settings.sweeps,fB.top.settings.sweeps))]),fD.settings.parameters),[A.head(fF[0]),fF[1],fF[2]]);fG=fE[1];fH=fE[2];fI=A.map(function(fV){return bX.New(fQ(fV.name),fV.value,fV.prior);},fG);fJ=K.Map(function(fV,fW){return A.map(fQ,fW);},fH);fK=A.map(function(fV){return b9.New(fV.name,A.map(function(fW){var fX,fY;function fZ(f0){return A.exists(function(f1){return f1.name===f0;},fG)?fQ(f0):f0;}fX=A.map((fY=function(f0){return R.map(fZ,f0);},function(f0){return A.map(fY,f0);}),fW.values);return b8.New(A.map(function(f0){return fH.ContainsKey(f0)?fQ(f0):f0;},fW.variables),fX);},fV.assignments));},fE[0]);fL=A.map(function(fV){return V.mapValues(fS,fV);},fD.initials);fM=function(fV){return R.map(fT,fV);};fN=A.map(function(fV){return cc.map(a.id,fS,fM,fV);},fD.reactions);return[M.New(fD.name,(fO=fD.settings,O.New((fP=fD.settings.simulation,P.New(fP.name,fP.initial,fP["final"],fP.points,A.map(fM,fD.settings.simulation.plots),fP.plotcolours,fP.seed,fP.kinetics,fP.times,fP.prune,fP.multicore,fP.data,fP.sweeps)),fO.simulations,fO.stochastic,fO.deterministic,fO.spatial,fO.inference,fO.moment_closure,fO.synthesis,fO.data,fO.units,fO.simulator,fI,fK,K.FoldBack(function(fV,fW,fX){return fX.Add(fV,fW);},K.OfArray(U.ofSeq(A.map(function(fV){return fU(fV[0],fV[1]);},A.ofSeq(K.ToSeq(fD.settings.rates))))),fB.top.settings.rates),fO.plot,fO.quiet)),fN,fL,fD.attributes),[fD.name,fJ]];},this.systems));return[L.New(this.top,A.map(function(fD){return fD.disambiguate_species_to_rates();},fC[0])).trim_rates(),K.OfArray(U.ofSeq(fC[1]))];},to_list_infer:function(){var fB,fC;fB=L.New(this.top,A.filter(function(fD){return!(fD.settings.data.$==0);},this.systems)).trim_rates();return[(fC=fB.top.settings,O.New(fC.simulation,fC.simulations,fC.stochastic,fC.deterministic,fC.spatial,fC.inference,fC.moment_closure,fC.synthesis,fC.data,fC.units,fC.simulator,fB.used_parameters(),fC.sweeps,fC.rates,fC.plot,fC.quiet)),A.filter(function(fD){return!(fD.settings.data.$==0);},A.map(function(fD){return fD.saturate_initials().to_ode();},new B({$:1,$0:fB.top,$1:fB.systems})))];},trim_rates:function(){var fB,fC,fD;return this.systems.$==0?L.New((fB=this.top,M.New(fB.name,(fC=this.top.settings,O.New(fC.simulation,fC.simulations,fC.stochastic,fC.deterministic,fC.spatial,fC.inference,fC.moment_closure,fC.synthesis,fC.data,fC.units,fC.simulator,fC.parameters,fC.sweeps,this.top.all_used_rates(),fC.plot,fC.quiet)),fB.reactions,fB.initials,fB.attributes)),this.systems):L.New(this.top.update_settings((fD=this.top.settings,O.New(fD.simulation,fD.simulations,fD.stochastic,fD.deterministic,fD.spatial,fD.inference,fD.moment_closure,fD.synthesis,fD.data,fD.units,fD.simulator,fD.parameters,fD.sweeps,new y.New([]),fD.plot,fD.quiet))),A.map(function(fE){var fF;return fE.update_settings((fF=fE.settings,O.New(fF.simulation,fF.simulations,fF.stochastic,fF.deterministic,fF.spatial,fF.inference,fF.moment_closure,fF.synthesis,fF.data,fF.units,fF.simulator,fF.parameters,fF.sweeps,fE.all_used_rates(),fF.plot,fF.quiet)));},this.systems));},used_parameters:function(){var fB;fB=A.distinct(A.collect(function(fC){return fC.all_used_parameters();},new B({$:1,$0:this.top,$1:this.systems})));return A.distinct(A.filter(function(fC){return A.exists(function(fD){return fD===fC.name;},fB);},A.collect(function(fC){return fC.settings.parameters;},new B({$:1,$0:this.top,$1:this.systems}))));}},null,L);L.initials_to_svg=function(fB){return L.stack_crn_svg_exports(M.initials_to_svg,fB);};L.reactions_to_svgs=function(fB){return L.list_crn_svg_exports(function(fC){return A.map(function(fD){return M.reaction_to_svg(fC,fD);},fC.reactions);},fB);};L.reactions_to_svg=function(fB){return L.stack_crn_svg_exports(M.reactions_to_svg,fB);};L.stack_crn_svg_exports=function(fB,fC){return S.stackv(cD.New(0,0),50,new B({$:1,$0:fB(fC.top),$1:A.map(function(fD){var fE;fE=fB(fD);return S.stackv(cD.New(0,0),15,A.ofArray([S.label_box({$:1,$0:"c-export__system-header"},20,fD.name),fE]));},fC.systems)}));};L.list_crn_svg_exports=function(fB,fC){return A.append(fB(fC.top),A.concat(A.map(function(fD){return A.append(fB(fD),A.ofArray([S.label_box({$:1,$0:"c-export__system-header"},20,fD.name)]));},fC.systems)));};L.get_parse=function(){var fB;fB=M.parse_with_modules(B.Empty,O.get_defaults());return function(fC){return dz.op_GreaterGreaterEquals(fB,function(fD){return L.parse_model(fD[0],fD[1]);},fC[0],fC[1]);};};L.parse_model=function(fB,fC){var fD,fE;function fF(fG){return L.New(fB,fG);}fD=(fE=L.parse_systems(fB.settings,fC),function(fG){return dz.op_GreaterGreaterDot(D.spaces(),fE,fG[0],fG[1]);});return function(fG){return dz.op_BarGreaterGreater(fD,fF,fG[0],fG[1]);};};L.parse_systems=function(fB,fC){return D.pfix(function(fD){var fE;function fF(fG){return D.preturn(A.append(fD,A.ofArray([fG])));}fE=L.parse_with_systems(fB,fC,fD);return function(fG){return dz.op_GreaterGreaterEquals(fE,fF,fG[0],fG[1]);};},B.Empty);};L.parse_with_systems=function(fB,fC,fD){var fE,fF,fG,fH;function fI(fM){var fN;function fO(fP,fQ){var fR,fS,fT,fU,fV,fW;fR=A.map((fS=(fT=(fU=fB.rates,function(fX){return M.species_to_rates(fU,fX);}),function(fX){return R.map(fT,fX);}),function(fX){return cc.map(a.id,a.id,fS,fX);}),fP.reactions);return M.New(fM,fP.settings.map((fV=(fW=fB.rates,function(fX){return M.species_to_rates(fW,fX);}),function(fX){return R.map(fV,fX);})),fR,fP.initials,fP.attributes);}fN=M.parse_with_modules_defaultSettings(fC,O.New(fB.simulation,fB.simulations,fB.stochastic,fB.deterministic,fB.spatial,fB.inference,fB.moment_closure,fB.synthesis,fB.data,fB.units,fB.simulator,B.Empty,B.Empty,new y.New([]),fB.plot,fB.quiet));return function(fP){return dz.op_BarGreaterGreater(fN,function(fQ){return fO(fQ[0],fQ[1]);},fP[0],fP[1]);};}function fJ(fM,fN){var fO,fP;function fQ(fS,fT){return dz.op_DotGreaterGreater(D.name(),D.spaces(),fS,fT);}function fR(fS){var fT,fU,fV;function fW(fX,fY){var fZ,f0,f1,f2,f3,f4,f5,f6;fZ=A.map((f0=(f1=(f2=fB.rates,function(f7){return M.species_to_rates(f2,f7);}),function(f7){return R.map(f1,f7);}),function(f7){return cc.map(a.id,a.id,f0,f7);}),fX.reactions);f3=fX.settings.map((f4=(f5=fB.rates,function(f7){return M.species_to_rates(f5,f7);}),function(f7){return R.map(f4,f7);}));f6=bb.fold(function(f7,f8,f9){return f7.Add(f8,f9);},fX.attributes,fU.attributes);return M.New(fM,f3,A.append(fU.reactions,fZ),A.append(fU.initials,fX.initials),f6);}fT=bc.tryFind(function(fX){return fX.name===fS;},fN);return fT==null?F.FailWith("System "+fS+" not defined"):(fU=fT.$0,(fV=M.parse_with_modules_defaultSettings(fC,fU.settings),function(fX){return dz.op_BarGreaterGreater(fV,function(fY){return fW(fY[0],fY[1]);},fX[0],fX[1]);}));}fO=(fP=D.kw("with"),function(fS){return dz.op_DotGreaterGreater(function(fT){return fQ(fT[0],fT[1]);},fP,fS[0],fS[1]);});return function(fS){return dz.op_GreaterGreaterEquals(fO,fR,fS[0],fS[1]);};}function fK(fM,fN){return dz.op_DotGreaterGreater(D.name(),D.spaces(),fM,fN);}function fL(fM){var fN,fO,fP,fQ,fR,fS,fT;function fU(fW){return true;}function fV(fW){return fW?D.braces(fJ(fM,fD)):D.braces(fI(fM));}fN=D.plookAheadWith((fO=D.choice([D.pTry((fP=(fQ=(fR=(fS=D.kw("{"),function(fW){return dz.op_GreaterGreaterDot(fS,D.name(),fW[0],fW[1]);}),function(fW){return dz.op_DotGreaterGreater(fR,D.spaces(),fW[0],fW[1]);}),(fT=D.kw("with"),function(fW){return dz.op_DotGreaterGreater(fQ,fT,fW[0],fW[1]);})),function(fW){return dz.op_BarGreaterGreater(fP,fU,fW[0],fW[1]);})),D.preturn(false)]),function(fW){return fO([fW[0],fW[1]]);}));return function(fW){return dz.op_GreaterGreaterEquals(fN,fV,fW[0],fW[1]);};}fE=(fF=(fG=D.kw("system"),function(fM){return dz.op_GreaterGreaterDot(fG,function(fN){return fK(fN[0],fN[1]);},fM[0],fM[1]);}),(fH=D.kw("="),function(fM){return dz.op_DotGreaterGreater(fF,fH,fM[0],fM[1]);}));return function(fM){return dz.op_GreaterGreaterEquals(fE,fL,fM[0],fM[1]);};};L.New=function(fB,fC){return new L({top:fB,systems:fC});};M=d.Crn=fu.Class({initialise:function(){return this.create_blank_attributes().update_empty_plot_labels();},substitute:function(fB){var fC;return this.update_settings((fC=this.settings,O.New(fC.simulation,fC.simulations,fC.stochastic,fC.deterministic,fC.spatial,fC.inference,fC.moment_closure,fC.synthesis,fC.data,fC.units,fC.simulator,bF.substitute(fB,this.settings.parameters),fC.sweeps,fC.rates,fC.plot,fC.quiet)));},get_instances:function(){return(this.to_simulation_runs())[0];},to_oslo:function(){return this.to_ode().to_oslo();},to_ssa:function(){var fB,fC,fD,fE,fF,fG,fH;fB=this.scale();fC=bF.to_env(fB.settings.parameters);fD=co.inline_rates_env(fC,fB.settings.rates);fE=V.to_initialpops_events(fC,fB.settings.simulation.initial,fB.initials);fF=fB.settings.stochastic.scale;fG=bf.create(fE[0],fE[1],fB.settings.simulation,fF);fH=Y.make_sim_reactions_pops(fC,fD,fF,bk.Equals(fB.settings.simulation.kinetics,"Deterministic")?A.map(function(fI){return cc.New(fI.catalysts,fI.reactants,fI.reverse,fI.rate.map(function(fJ){return fI.stochastic_to_deterministic(fJ);},a.id),fI.products);},fB.reactions):fB.reactions,fG.populations);return Y.create(fG,fB.settings.stochastic,fH[0],fH[2],fB.settings.parameters,fD);},to_sundials:function(){return this.to_ode().to_sundials();},to_lna:function(){var fB;fB=this.scale();return fB.to_ode().to_lna(fB.settings.stochastic.scale);},simulate_cme_callback:function(fB,fC,fD){var fE,fF,fG,fH;fE=bF.to_env(this.settings.parameters);fF=M.to_inlined_rates(this.settings);fG=this.to_ctmc();fH=this.to_cme(fG);fC(fG);return bg.simulate_callback(fE,fF,fB,fD,false,fH);},to_pde1d:function(){var fB,fC,fD,fE;fB=bF.to_env(this.settings.parameters);fC=(fD=this.settings.simulation.seed,fD==null?new cR.New():new cR.New$1(fD.$0));return this.to_pde(fC,(V.to_initialpops_events_poly(fB,this.settings.simulation.initial,this.initials,(fE=this.settings.spatial.nx,function(fF){return _5.accumulator_1d(fC,fE,fF);})))[0]);},to_pde2d:function(){var fB,fC,fD,fE;fB=bF.to_env(this.settings.parameters);fC=(fD=this.settings.simulation.seed,fD==null?new cR.New():new cR.New$1(fD.$0));return this.to_pde(fC,(V.to_initialpops_events_poly(fB,this.settings.simulation.initial,this.initials,(fE=this.settings.spatial.nx,function(fF){return _5.accumulator_2d(fC,fE,fF);})))[0]);},simulate_cmesundials_callback:function(fB,fC,fD){var fE,fF,fG,fH;fE=bF.to_env(this.settings.parameters);fF=M.to_inlined_rates(this.settings);fG=this.to_ctmc();fH=this.to_cme(fG);fC(fG);return fH.simulate_sundials_callback(fB,fE,fF,fD);},to_string:function(){var fB;fB=this;return this.to_string_with(R.is_not_empty,function(fC){return!bk.Equals(R.simplify(fC),{$:1,$0:fB.settings.simulation.initial});},void 0);},saturate_initials:function(){var fB,fC;function fD(fE){return fE[1];}fB=A.distinct(A.append(b$.elements(b$.union_all(bk.Equals,A.map(function(fE){return b$.union_all(bk.Equals,A.ofArray([fE.reactants,fE.products,fE.catalysts]));},this.reactions))),bc.fold(function(fE,fF){return fF.$==2?new B({$:1,$0:fF.$0,$1:fE}):fE;},B.Empty,A.distinct(A.collect(function(fE){return R.mentions(fD(fE));},A.ofSeq(K.ToSeq(this.settings.rates)))))));fC=A.map(function(fE){return fE.species;},this.initials);return M.New(this.name,this.settings,this.reactions,A.rev(db.fold_left(function(fE,fF){return A.exists(function(fG){return bk.Equals(fF,fG);},fC)?fE:new B({$:1,$0:V.create$4(false,{$:1,$0:0},fF,null,null),$1:fE});},A.rev(this.initials),fB)),this.attributes);},to_ctmc:function(){var fB;fB=this.initialise_ctmc();return fB[0].to_ctmc(cS.ofMap(this.settings.rates),1,fB[1],fB[2],fB[3]);},to_cme:function(fB){var fC,fD,fE;fC=this.scale();fD=V.to_initialpops_events(bF.to_env(fC.settings.parameters),fC.settings.simulation.initial,fC.initials);fE=bg.create(fD[0],fD[1],fC.settings.deterministic,fC.settings.simulation,1);return bg.New(fE.name,fE.simulator,fE.settings,[fB.ctmc],fE.probabilities);},update_empty_plot_labels:function(){return M.New(this.name,this.settings.update_empty_plot_labels(),this.reactions,this.initials,this.attributes);},create_blank_attributes:function(){return M.New(this.name,this.settings,this.reactions,this.initials,bc.fold(function(fB,fC){return bb.tryFind(fC.species.name,fB)==null?bb.add(fC.species.name,_8.New(fC.species.name,"",""),fB):fB;},this.attributes,this.saturate_initials().initials));},update_settings:function(fB){return M.New(this.name,fB,this.reactions,this.initials,this.attributes);},to_simulation_runs:function(){return this.settings.to_simulation_runs(this.name);},to_ode:function(){var fB;fB=A.ofSeq(this.initials);return cP.create(this.name,cc.normalise_list(this.reactions),fB,this.settings);},scale:function(){var fB,fC,fD;function fE(fH,fI,fJ){return fI===0?{$:2,$0:A.ofArray([fJ,{$:1,$0:fH}])}:fI===1?fJ:fI===2?{$:3,$0:ct.New(fJ,{$:1,$0:fH})}:{$:2,$0:A.ofArray([fJ,{$:1,$0:fv.pow(fH,1-fI)}])};}function fF(fH){return{$:2,$0:A.ofArray([R.expand(function(fI){return co.scale(fB,fI);},fH),{$:1,$0:fB}])};}function fG(fH){return{$:2,$0:A.ofArray([fH,{$:1,$0:fB}])};}fB=this.settings.stochastic.scale;return fB===1?this:M.New(this.name,(fC=this.settings,O.New(fC.simulation,fC.simulations,(fD=this.settings.stochastic,_7.New(1,fD.steps,fD.trajectories,fD.stationary_skiptime)),fC.deterministic,fC.spatial,fC.inference,fC.moment_closure,fC.synthesis,fC.data,fC.units,fC.simulator,fC.parameters,fC.sweeps,fC.rates,fC.plot,fC.quiet)),A.map(function(fH){return fH.scale(function(fI,fJ){return function(fK){return fE(fI,fJ,fK);};},fB,fF);},this.reactions),A.map(function(fH){return fH.scale(fG);},this.initials),this.attributes);},to_pde:function(fB,fC){var fD,fE,fF;fD=cc.normalise_list(this.reactions);fE=cP.get_matrices(this.initials,fD);return _5.create(this.name,fC,this.settings.simulation,(fF=this.settings.spatial,_6.New(this.settings.parameters,fF.diffusibles,fF.dimensions,fF.boundary,fF.xmax,fF.nx,fF.dt,fF.default_diffusion,fF.random)),fE[1],fE[2],cP.get_rates(fE[0],fD,bk.Equals(this.settings.simulation.kinetics,"Stochastic")),this.settings.rates,fB);},to_string_with:function(fB,fC,fD){var fE,fF,fG,fH,fI,fJ,fK,fL,fM,fN;bF.to_env(this.settings.parameters);fE=this.settings.to_string(Q.to_string,Q.to_string_plot);fF=(fG=A.filter(function(fO){return fB(fO.value);},this.initials),A.map((fH=(fI=function(fO){return R.to_string(a.id,fO);},function(fO){return V.to_string(be.to_string,fI,fC,fO);}),(fJ=function(fO){return function(fP){return fO("| "+_2.toSafe(fP));};}(a.id),function(fO){return fJ(fH(fO));})),fG));fK=A.map((fL=(fM=function(fO){return R.to_string(a.id,fO);},function(fO){return cc.to_string(be.to_string,fM,Q.to_string,fO);}),(fN=function(fO){return function(fP){return fO("| "+_2.toSafe(fP));};}(a.id),function(fO){return fN(fL(fO));})),this.reactions);return fE+(fF.$===0?"":"\\n"+dk.concat("\\n",fF))+(fK.$===0?"":"\\n"+dk.concat("\\n",fK));},to_sbml:function(){var fB,fC,fD,fE,fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO,fP,fQ,fR,fS,fT,fU,fV,fW,fX,fY;function fZ(){var gd;gd=fG[0];fG[0]=gd+1;return gd;}function f0(gd){var ge;return bl.mkSId(gd+(ge=fZ(),a.String(ge)));}function f1(){return f0("s_id");}function f2(){return f0("r_id");}function f3(gd,ge,gf,gg,gh){return[gd,[gd,ge,gf,gg,gh]];}function f4(gd){var ge;ge=K.TryFind(gd,fI);return ge!=null&&ge.$==1?ge.$0[4]:F.FailWith("Error - getSId - key "+gd+" not found.");}function f5(gd){var ge,gf;ge=bl.mkUnitSId("k_unit_"+(gf=gd,a.String(gf)));return[ge,bl.create_unitDefinition(ge,new B({$:1,$0:bl.u_set_multiplier(fE,bl.u_set_scale(fD,bl.u_set_exponent(-1,bl.create_sbmlUnit(dV.Second)))),$1:gd!==1?A.ofArray([bl.u_set_scale(fF,bl.u_set_exponent(1-gd,bl.create_sbmlUnit(dV.Mole))),bl.u_set_exponent(gd-1,bl.create_sbmlUnit(dV.Litre))]):B.Empty}))];}function f6(gd){var ge,gf,gg;ge=cS.tryFind(fJ,gd);return ge==null?(gf=f5(gd),(gg=gf[0],(cS.add(fJ,gd,[gg,gf[1]]),gg))):ge.$0[0];}function f7(gd,ge){return function(gf){var gg,gh,gi;gg=cS.tryFind(fU,[gd,ge]);return gg==null?(gh=bl.mkSId(gd),(gi=bl.p_set_units(gf,bl.p_set_value(ge,bl.create_parameter(gh))),(cS.add(fU,[gd,ge],[gh,gi]),[gh,gi]))):[gg.$0[0],gg.$0[1]];};}function f8(gd,ge){return cS.add(fV,gd,ge);}function f9(gd,ge){var gf;gf=bl.create_initialAssignment(gd,{$:2,$0:dW.Times,$1:A.ofArray([{$:3,$0:{$:0,$0:1},$1:{$:1,$0:fP}},ge])});return function(gg){return bl.model_add_initialAssignment(gf,gg);};}function f_(gd){return((function(ge){return f7(ge[0],ge[1]);}([gd,R["eval"](fB,{$:0,$0:gd})]))(fO))[0];}function f$(gd,ge,gf,gg,gh){return gf.$==1?gg?bl.sp_set_boundaryCondition(true,bl.sp_set_constant(gg,bl.sp_set_initialConcentration(gf.$0,bl.sp_set_name(ge,bl.create_species(gh,fQ))))):bl.sp_set_constant(gg,bl.sp_set_initialConcentration(gf.$0,bl.sp_set_name(ge,bl.create_species(gh,fQ)))):(f8(gh,R.to_mathML(f_,gf)),gg?bl.sp_set_boundaryCondition(true,bl.sp_set_constant(gg,bl.sp_set_name(ge,bl.create_species(gh,fQ)))):bl.sp_set_constant(gg,bl.sp_set_name(ge,bl.create_species(gh,fQ))));}function ga(gd){return b$.collectm(function(ge){return bl.sr_set_stoichiometry(ge.multiplicity,bl.create_speciesReference(f4(ge.element)));},gd);}function gb(gd,ge){var gf;gf=ge[1];return function(gg){return bl.model_add_parameter(gf,gg);};}function gc(gd,ge){var gf;gf=ge[1];return function(gg){return bl.model_add_unitDefinition(gf,gg);};}fB=(fC=bF.to_env(this.settings.parameters),function(gd){return di.find(fC,gd);});fD=0;fE=1;fF=this.settings.units.concentration.$0;fG=[0];fH=A.map(function(gd){return[gd.species.name,bl.mkString(gd.species.name),gd.value,gd.constant,f1()];},this.initials);fI=K.OfArray(U.ofSeq(A.map(function(gd){return f3(gd[0],gd[1],gd[2],gd[3],gd[4]);},fH)));fJ=cS.empty();fK=bl.mkUnitSId("time");cS.add(fJ,-1,[fK,bl.create_unitDefinition(fK,A.ofArray([bl.u_set_multiplier(fE,bl.u_set_scale(fD,bl.create_sbmlUnit(dV.Second)))]))]);fL=bl.mkUnitSId("substance");fM=bl.u_set_scale(fF,bl.create_sbmlUnit(dV.Mole));cS.add(fJ,-2,[fL,bl.create_unitDefinition(fL,A.ofArray([fM]))]);fN=bl.mkUnitSId("volume");cS.add(fJ,-3,[fN,bl.create_unitDefinition(fN,A.ofArray([bl.create_sbmlUnit(dV.Litre)]))]);fO=bl.mkUnitSId("dimless");cS.add(fJ,-4,[fO,bl.create_unitDefinition(fO,A.ofArray([bl.create_sbmlUnit(dV.Dimensionless)]))]);fP=bl.mkUnitSId("concentration");cS.add(fJ,-5,[fP,bl.create_unitDefinition(fP,A.ofArray([fM,bl.u_set_exponent(-1,bl.create_sbmlUnit(dV.Litre))]))]);fQ=bl.mkSId("c");fR=bl.mkSId("c_size");fS=this.settings.stochastic.scale/6.0221415*fv.pow(10,-23-fF);fT=bl.p_set_units(fN,bl.p_set_value(fS,bl.create_parameter(fR)));fU=cS.empty();fV=cS.empty();cS.empty();fW=K.OfArray(U.ofSeq(A.map(function(gd){return[gd.name,{$:1,$0:gd.value}];},this.settings.parameters)));return cS.fold(function(gd,ge,gf){return(f9(gd,ge))(gf);},fV,cS.fold(function(gd,ge,gf){return(gb(gd,ge))(gf);},fU,cS.fold(function(gd,ge,gf){return(gc(gd,ge))(gf);},fJ,(fX=(fY=bl.model_add_compartment(bl.cmt_set_size(fS,bl.create_compartment(fQ)),bl.empty_model()),bl.model_set_species(A.map(function(gd){return f$(gd[0],gd[1],gd[2],gd[3],gd[4]);},fH),fY)),bl.model_set_reactions(A.map(function(gd){var ge,gf,gg,gh,gi,gj,gk,gl,gm,gn;function go(gq,gr){return gr===1?gq:{$:1,$0:dX.Power,$1:gq,$2:{$:3,$0:{$:0,$0:gr},$1:{$:1,$0:fO}}};}function gp(gq,gr){return gr===1?gq:{$:1,$0:dX.Divide,$1:gq,$2:{$:3,$0:{$:0,$0:gr},$1:{$:1,$0:fO}}};}ge=cc.map(function(gq){return gq.name;},a.id,a.id,gd);return bl.r_set_kineticLaw((gf=ge.rate,gf.$==1?bl.create_kineticLaw(R.to_mathML(f4,R.substitute(fW,R.map(function(gq){return co.to_matlab(be.to_string,"time",gq);},gf.$0)))):(gg=gf.$0,(gh=R["eval"](fB,gg),(gi=f6(b$.size(ge.reactants)),(gj=gg.$==0?(gk=(function(gq){return f7(gq[0],gq[1]);}([gg.$0,gh]))(gi),[gk[0],gk[1],false]):(gl=bl.mkSId("k"),[gl,bl.p_set_units(gi,bl.p_set_value(gh,bl.create_parameter(gl))),true]),gj[2]?bl.kl_add_parameter(gj[1],bl.kl_add_parameter(fT,bl.create_kineticLaw({$:2,$0:dW.Times,$1:new B({$:1,$0:{$:4,$0:fR},$1:new B({$:1,$0:{$:4,$0:gj[0]},$1:b$.collectm(function(gq){return gp(go({$:4,$0:f4(gq.element)},gq.multiplicity),db.fac(gq.multiplicity));},ge.reactants)})})}))):bl.kl_add_parameter(fT,bl.create_kineticLaw({$:2,$0:dW.Times,$1:new B({$:1,$0:{$:4,$0:fR},$1:new B({$:1,$0:{$:4,$0:gj[0]},$1:b$.collectm(function(gq){return gp(go({$:4,$0:f4(gq.element)},gq.multiplicity),db.fac(gq.multiplicity));},ge.reactants)})})}))))))),bl.r_set_reversible(false,(gm=(gn=bl.create_reaction(f2()),bl.r_set_reactants(ga(ge.reactants),gn)),bl.r_set_products(ga(ge.products),gm))));},cc.normalise_list(this.reactions)),fX)))));},to_matlab:function(){var fB,fC,fD;fB=this.saturate_initials().create_blank_attributes();fC=this.settings.simulator;return fC=="Oslo"||fC=="Sundials"?cP.to_matlab(fB.to_ode()):a.String(fC)+" simulator does not support MATLAB export, try Oslo or Sundials";},initialise_ctmc:function(){var fB,fC,fD,fE,fF,fG;function fH(fI,fJ){return fC;}fB=this.scale();fC=A.map(function(fI){return bk.Equals(fB.settings.simulation.kinetics,"Deterministic")?cc.New(fI.catalysts,fI.reactants,fI.reverse,fI.rate.map(function(fJ){return fI.stochastic_to_deterministic(fJ);},a.id),fI.products):fI;},cc.normalise_list(fB.reactions));fD=bF.to_env(fB.settings.parameters);fE=A.map(function(fI){return[fI.species,F.toInt(R["eval"](function(fJ){return di.find(fD,fJ);},fI.value))];},fB.initials);fF=_3.New(function(fI){return function(fJ){return fH(fI,fJ);};});fG=fF.initialise_ctmc(fE);return[fF,fG[0],fG[1],fG[2]];},disambiguate_species_to_rates:function(){var fB,fC,fD,fE,fF;return M.New(this.name,this.settings.map((fB=(fC=this.settings.rates,function(fG){return M.species_to_rates(fC,fG);}),function(fG){return R.map(fB,fG);})),A.map((fD=(fE=(fF=this.settings.rates,function(fG){return M.species_to_rates(fF,fG);}),function(fG){return R.map(fE,fG);}),function(fG){return cc.map(a.id,a.id,fD,fG);}),this.reactions),this.initials,this.attributes);},saturate_plots:function(){var fB,fC,fD,fE,fF;function fG(fH){return fH.plots.$==0?fB.settings.simulator=="MC"?fH:P.New(fH.name,fH.initial,fH["final"],fH.points,A.map(function(fI){return{$:0,$0:{$:2,$0:fI.species}};},fB.initials),fH.plotcolours,fH.seed,fH.kinetics,fH.times,fH.prune,fH.multicore,fH.data,fH.sweeps):fH;}fB=this.settings.simulation.plots.$==0?this.settings.simulator=="MC"?M.New(this.name,(fC=this.settings,O.New(fC.simulation,fC.simulations,fC.stochastic,fC.deterministic,fC.spatial,fC.inference,bD.saturate_plots(this.all_species(),this.settings.moment_closure),fC.synthesis,fC.data,fC.units,fC.simulator,fC.parameters,fC.sweeps,fC.rates,fC.plot,fC.quiet)),this.reactions,this.initials,this.attributes):M.New(this.name,(fD=this.settings,O.New((fE=this.settings.simulation,P.New(fE.name,fE.initial,fE["final"],fE.points,A.map(function(fH){return{$:0,$0:{$:2,$0:fH}};},this.all_species()),fE.plotcolours,fE.seed,fE.kinetics,fE.times,fE.prune,fE.multicore,fE.data,fE.sweeps)),fD.simulations,fD.stochastic,fD.deterministic,fD.spatial,fD.inference,fD.moment_closure,fD.synthesis,fD.data,fD.units,fD.simulator,fD.parameters,fD.sweeps,fD.rates,fD.plot,fD.quiet)),this.reactions,this.initials,this.attributes):this;return M.New(fB.name,(fF=fB.settings,O.New(fG(fB.settings.simulation),A.map(fG,fB.settings.simulations),fF.stochastic,fF.deterministic,fF.spatial,fF.inference,fF.moment_closure,fF.synthesis,fF.data,fF.units,fF.simulator,fF.parameters,fF.sweeps,fF.rates,fF.plot,fF.quiet)),fB.reactions,fB.initials,fB.attributes);},all_used_rates:function(){var fB;function fC(fD){return fD.$==1?{$:1,$0:fD.$0}:null;}return this.settings.all_used_rates((fB=function(fD){return A.choose(fC,fD);},function(fD){return fB(R.mentions(fD));}),this.reactions);},all_species:function(){return A.distinct(A.append(A.distinctBy(function(fB){return fB.name;},A.map(function(fB){return fB.species;},this.initials)),A.collect(function(fB){return fB.get_allSpecies();},this.reactions)));},all_used_parameters:function(){var fB,fC,fD,fE,fF,fG,fH;function fI(fJ){return fJ.$==0?{$:1,$0:fJ.$0}:null;}fB=(fC=function(fJ){return A.choose(fI,fJ);},function(fJ){return fC(R.mentions(fJ));});fD=A.collect(function(fJ){var fK;return A.append((fK=fJ.time,fK==null?B.Empty:R.mentions(fK.$0)),R.mentions(fJ.value));},this.initials);fE=A.collect(function(fJ){var fK,fL;return A.append((fK=fJ.rate,fK.$==1?fB(fK.$0):R.mentions(fK.$0)),(fL=fJ.reverse,fL!=null&&fL.$==1?fL.$0.$==1?fB(fL.$0.$0):R.mentions(fL.$0.$0):B.Empty));},this.reactions);fF=A.collect(fB,A.append(this.settings.simulation.plots,A.concat(A.map(function(fJ){return fJ.plots;},this.settings.simulations))));fG=A.collect(fB,A.map(function(fJ){return fJ[1];},A.ofSeq(K.ToSeq(this.settings.rates))));fH=A.collect(function(fJ){return fJ.sweeps;},this.settings.simulations);return A.distinct(A.append(fD,A.append(fE,A.append(fF,A.append(fG,A.collect(function(fJ){return A.collect(function(fK){return A.append(fK.variables,A.collect(R.mentions,A.concat(fK.values)));},fJ.assignments);},fH.$==0?this.settings.sweeps:A.filter(function(fJ){return A.contains(fJ.name,fH);},this.settings.sweeps)))))));}},null,M);M.species_to_rates=function(fB,fC){var fD;return fC.$==3?co.Time:fC.$==0?{$:0,$0:fC.$0}:fC.$==1?{$:1,$0:fC.$0}:(fD=fC.$0,fB.ContainsKey(fD.name)?{$:1,$0:fD.name}:{$:2,$0:fD});};M.get_default_svg_style=function(){return"\\r\\n  .crnsvgvalue {\\r\\n      text-anchor: end;\\r\\n      stroke: black;\\r\\n      fill: black;\\r\\n      stroke-width: 0;\\r\\n      font-family: Verdana, Arial, sans-serif;\\r\\n      font-size: 15px;\\r\\n  }\\r\\n  .crnsvgrate {\\r\\n      text-anchor: middle;\\r\\n      stroke: black;\\r\\n      fill: black;\\r\\n      stroke-width: 0;\\r\\n      font-family: Verdana, Arial, sans-serif;\\r\\n      font-size: 15px;\\r\\n  }\\r\\n  path.crnsvgrate { stroke-width: 2; fill: none; stroke-linejoin: round }\\r\\n  .crnsvgplus { text-anchor: start }\\r\\n  .crnsvgspeciestext { text-anchor: start }\\r\\n  ";};M.initials_to_svg=function(fB){var fC,fD,fE;function fF(fG){return A.head(fG).box_dim.x;}fC=cD.New(30,10);fD=A.map(function(fG){return A.ofArray([M.svg_label_box({$:1,$0:"crnsvgvalue"},R.to_string(a.id,fG.value)),M.get_svg(fB,fG.species.name,true)]);},A.filter(function(fG){return!bk.Equals(fG.value,{$:1,$0:0});},fB.initials));fE=fD.$==0?0:fF(A.maxBy(fF,fD));return S.stackv(fC,10,A.map(function(fG){var fH,fI;fH=S.stackhc(cD.New(fE+10,fC.y),M.get_svgListMargin(),fG);return cE.New((fI=fH.box_group,cF.New(fI.name,fI.content,fI.anchors,fI.debug_anchors,fI.sub_groups,{$:1,$0:cD.New(fE,0)})),fH.box_dim);},A.map(function(fG){var fH;return fG.$==1?(fH=fG.$0,new B({$:1,$0:cE.New(fH.box_group,cD.New(0,fH.box_dim.y)),$1:fG.$1})):B.Empty;},fD)));};M.reactions_to_svg=function(fB){var fC,fD;fC=fB.reactions;return fC.$==0?M.svg_raw_box(""):(fD=A.map(function(fE){return M.reaction_to_svg(fB,fE);},fC),S.stackv(cD.New(0,0),M.get_svgListMargin(),fD));};M.get_parse=function(){var fB,fC,fD,fE,fF;function fG(fH){return fH[0];}fB=(fC=(fD=O.parse(Q.parse(),Q.parse_plot()),function(fH){return dz.op_DotGreaterGreater(fD,D.spaces(),fH[0],fH[1]);}),(fE=(fF=be.get_parse(),function(fH){return M.parse_instructions(fF,fH);}),function(fH){return dz.op_GreaterGreaterEquals(fC,fE,fH[0],fH[1]);}));return function(fH){return dz.op_BarGreaterGreater(fB,fG,fH[0],fH[1]);};};M.to_inlined_rates=function(fB){return co.inline_rates_env(bF.to_env(fB.parameters),fB.rates);};M.svg_label_box=function(fB,fC){var fD;fD=S.label_box(fB,S.default_letter_width(),fC);return cE.New(fD.box_group,cD.New(fD.box_dim.x,22));};M.get_svg=function(fB,fC,fD){var fE,fF;fE=bb.tryFind(fC,fB.attributes);fF=fE!=null&&fE.$==1?fE.$0.svg:"";return fF===""?M.svg_label_box({$:1,$0:"crnsvgvalue crnsvgspeciestext"},fC):M.svg_raw_box(fD&&dk.StartsWith(fF,"<svg")?"<g"+dk.Remove(dk.Remove(fF,0,4),fF.length-10,6)+"</g>":fF);};M.get_svgListMargin=function(){return 20;};M.create=function(fB,fC,fD,fE,fF,fG){return fG?M.New(fB,fC,fD,fE,fF).saturate_initials().saturate_plots():M.New(fB,fC,fD,fE,fF).saturate_initials();};M.svg_raw_box=function(fB){return M.svg_raw_box_sized(fB,M.try_grab("width",150,fB),M.try_grab("height",60,fB));};M.reaction_to_svg=function(fB,fC){var fD,fE,fF,fG,fH,fI,fJ,fK;function fL(fN){return fN.multiplicity===1?A.ofArray([M.get_svg(fB,fN.element.name,true)]):A.ofArray([M.svg_label_box({$:1,$0:"crnsvgvalue"},a.String(fN.multiplicity)),M.get_svg(fB,fN.element.name,true)]);}function fM(fN){return S.stackhc(cD.New(0,0),10,A.collect(a.id,A.mapi(function(fO,fP){return fO===0?fP:new B({$:1,$0:M.svg_label_box({$:1,$0:"crnsvgvalue crnsvgplus"},"+"),$1:fP});},A.map(fL,fN))));}fD=cD.New(0,0);fE=b$.is_empty(fC.reactants)?null:{$:1,$0:fM(fC.reactants)};fF=b$.is_empty(fC.catalysts)?null:{$:1,$0:fM(fC.catalysts)};fG=b$.is_empty(fC.products)?null:{$:1,$0:fM(fC.products)};fH=fF!=null&&fF.$==1?(fI=fF.$0,fE!=null&&fE.$==1?{$:1,$0:S.stackhc(fD,20,A.ofArray([fE.$0,M.svg_label_box({$:1,$0:"crnsvgvalue"},"~"),fI]))}:{$:1,$0:fI}):fE;fJ=M.rate_box_svg(fC.rate,fC.reverse);fK=S.stackhc(fD,20,fH!=null&&fH.$==1?fG!=null&&fG.$==1?A.ofArray([fH.$0,fJ,fG.$0]):A.ofArray([fH.$0,fJ]):fG!=null&&fG.$==1?A.ofArray([fJ,fG.$0]):F.FailWith("invalid reaction"));return cE.New(fK.box_group,cD.New(fK.box_dim.x*1.05,fK.box_dim.y));};M.parse_instructions=function(fB,fC){return M.parse_instructions_modules(fB,B.Empty,fC);};M.svg_raw_box_sized=function(fB,fC,fD){return cE.New(cF.New("",{$:1,$0:fB},B.Empty,false,B.Empty,null),cD.New(fC,fD));};M.try_grab=function(fB,fC,fD){var fE,fF,fG;fE=(function(fH){return function(fI){return fH(_2.toSafe(fI)+"=\\"");};}(a.id))(fB);fF=fE.length;return fD.indexOf(fE)!=-1?(fG=fD.substring(fD.indexOf(fE)+fF),fG.indexOf("\\"")!=-1?a.Number(dk.Substring(fG,0,fG.indexOf("\\""))):fC):fC;};M.rate_box_svg=function(fB,fC){var fD,fE,fF,fG,fH,fI,fJ,fK;function fL(fM){return fM.to_string_bare(function(fN){return R.to_string(a.id,fN);},Q.to_string);}fD=13;fE=fL(fB);fF=fC!=null&&fC.$==1?{$:1,$0:fL(fC.$0)}:null;fG=(fH=fF!=null&&fF.$==1?fD*(fI=dk.length(fE),(fJ=dk.length(fF.$0),bk.Compare(fI,fJ)===1?fI:fJ)):fD*dk.length(fE),(fK=50,bk.Compare(fH,fK)===1?fH:fK));return cE.New(S.content_group(fF!=null&&fF.$==1?{$:0,$0:A.ofArray([el.New({$:1,$0:"crnsvgrate"},A.ofArray([{$:0,$0:cD.New(0,20)},{$:1,$0:cD.New(fG,20)},{$:1,$0:cD.New(fG-10,10)},{$:0,$0:cD.New(fG,25)},{$:1,$0:cD.New(0,25)},{$:1,$0:cD.New(10,35)}]),null),el.New(null,B.Empty,{$:1,$0:em.New(fE,cD.New(fG/2,17),{$:1,$0:"crnsvgrate"},S.default_letter_width(),cD.New(fG,17))}),el.New(null,B.Empty,{$:1,$0:em.New(fF.$0,cD.New(fG/2,38),{$:1,$0:"crnsvgrate"},S.default_letter_width(),cD.New(fG,38))})])}:{$:0,$0:A.ofArray([el.New({$:1,$0:"crnsvgrate"},A.ofArray([{$:0,$0:cD.New(0,20)},{$:1,$0:cD.New(fG,20)},{$:1,$0:cD.New(fG-10,10)}]),null),el.New(null,B.Empty,{$:1,$0:em.New(fE,cD.New(fG/2,17),{$:1,$0:"crnsvgrate"},S.default_letter_width(),cD.New(fG,17))})])}),cD.New(fG,40));};M.parse_instructions_modules=function(fB,fC,fD){var fE;function fF(fG,fH){var fI;fI=A.append(fC,fG);return[M.create_from_instructions(fD,[fI,fH]),fI];}fE=eY.parse(fB,fD);return function(fG){return dz.op_BarGreaterGreater(fE,function(fH){return fF(fH[0],fH[1]);},fG[0],fG[1]);};};M.parse_with_modules=function(fB,fC){var fD,fE,fF;fD=O.parse_defaults(Q.parse(),Q.parse_plot(),fC);fE=(fF=be.get_parse(),function(fG){return M.parse_instructions_modules(fF,fB,fG);});return function(fG){return dz.op_GreaterGreaterEquals(fD,fE,fG[0],fG[1]);};};M.create_from_instructions=function(fB,fC){var fD,fE,fF,fG,fH,fI,fJ,fK,fL;fD=eY.convert_instructions(fC[0],fC[1]);fE=fD[1];(function(fM){var fN,fO,fP;while(true)if(fM.$==1){if(fM.$1.$==0)return null;else{fN=fM.$0[0];fO=fM.$0[1];fP=fM.$1;A.iter(function(fQ,fR){return function(fS){var fT,fU;fT=(fU=fS[1],dg.Filter(function(fV){return fU.Contains(fV);},fQ));!fT.get_IsEmpty()?F.FailWith(((((fu.Curried(function(fV,fW,fX,fY){return fV("Naming conflict: "+_2.toSafe(fW)+" and "+_2.toSafe(fX)+" \\""+_2.toSafe(fY)+"\\" share the same name");},4))(a.id))(fR))(fS[0]))(A.head(A.ofSeq(fT)))):void 0;};}(fO,fN),fP);fM=fP;}}else return null;}(A.ofArray([["parameter",new dh.New$1(cx.OfSeq(A.map(function(fM){return fM.name;},fB.parameters)))],["initial",new dh.New$1(cx.OfSeq(A.map(function(fM){return fM.species.name;},fE)))],["rates",new dh.New$1(cx.OfSeq(A.map(function(fM){return fM[0];},A.ofSeq(K.ToSeq(fB.rates)))))]])));fF=A.filter((fG=fB.rates,function(fM){return fG.ContainsKey(fM);}),A.map(function(fM){return fM.species.name;},fE));return fF.$==0?M.create("",fB.map((fH=(fI=fB.rates,function(fM){return M.species_to_rates(fI,fM);}),function(fM){return R.map(fH,fM);})),A.map((fJ=(fK=(fL=fB.rates,function(fM){return M.species_to_rates(fL,fM);}),function(fM){return R.map(fK,fM);}),function(fM){return cc.map(a.id,a.id,fJ,fM);}),fD[0]),fE,bb.empty(),true):F.FailWith("Name conflict: an initial species and a rate share the name \\""+A.head(fF)+"\\"");};M.parse_with_modules_defaultSettings=function(fB,fC){var fD,fE,fF,fG;function fH(fI){return fC.from_default_directive_list(fI);}fD=(fE=O.parse_directives_defaults(fC,Q.parse(),Q.parse_plot()),function(fI){return dz.op_BarGreaterGreater(fE,fH,fI[0],fI[1]);});fF=(fG=be.get_parse(),function(fI){return M.parse_instructions_modules(fG,fB,fI);});return function(fI){return dz.op_GreaterGreaterEquals(fD,fF,fI[0],fI[1]);};};M.New=function(fB,fC,fD,fE,fF){return new M({name:fB,settings:fC,reactions:fD,initials:fE,attributes:fF});};A.map=function(fB,fC){var fD,fE,fF,fG,fH;if(fC.$==0)return fC;else{fG=new B({$:1});fD=fG;fE=fC;fF=true;while(fF){fD.$0=fB(fE.$0);fE=fE.$1;fE.$==0?fF=false:fD=(fH=new B({$:1}),fD.$1=fH,fH);}fD.$1=B.Empty;return fG;}};A.ofArray=function(fB){var fC,fD,fE;fC=B.Empty;for(fD=U.length(fB)-1,fE=0;fD>=fE;fD--)fC=new B({$:1,$0:U.get(fB,fD),$1:fC});return fC;};A.collect=function(fB,fC){return A.ofSeq(bc.collect(fB,fC));};A.iter=function(fB,fC){var fD;fD=fC;while(fD.$==1){fB(A.head(fD));fD=A.tail(fD);}};A.ofSeq=function(fB){var fC,fD,fE,fF,fG,fH;if(fB instanceof B)return fB;else if(fB instanceof a.Array)return A.ofArray(fB);else{fC=da.Get(fB);try{fE=fC.MoveNext();if(!fE)fD=B.Empty;else{fG=new B({$:1});fF=fG;while(fE){fF.$0=fC.Current();fC.MoveNext()?fF=(fH=new B({$:1}),fF.$1=fH,fH):fE=false;}fF.$1=B.Empty;fD=fG;}return fD;}finally{if(typeof fC=="object"&&"Dispose"in fC)fC.Dispose();}}};A.init=function(fB,fC){return A.ofArray(U.init(fB,fC));};A.mapi=function(fB,fC){var fD,fE,fF,fG,fH,fI;if(fC.$==0)return fC;else{fH=new B({$:1});fD=fH;fE=fC;fF=0;fG=true;while(fG){fD.$0=fB(fF,fE.$0);fE=fE.$1;fE.$==0?fG=false:(fD=(fI=new B({$:1}),fD.$1=fI,fI),fF=fF+1);}fD.$1=B.Empty;return fH;}};A.unzip=function(fB){var fC,fD,fE,fF;fC=[];fD=[];fE=da.Get(fB);try{while(fE.MoveNext()){fF=fE.Current();fC.push(fF[0]);fD.push(fF[1]);}}finally{if(typeof fE=="object"&&"Dispose"in fE)fE.Dispose();}return[A.ofArray(fC.slice(0)),A.ofArray(fD.slice(0))];};A.zip=function(fB,fC){return A.map2(function(fD,fE){return[fD,fE];},fB,fC);};A.maxBy=function(fB,fC){var fD,fE,fF,fG,fH;A.nonEmpty(fC);fD=fC.$0;fE=fB(fD);fF=fC.$1;while(fF.$==1){fG=fF.$0;fH=fB(fG);bk.Compare(fH,fE)===1?(fD=fG,fE=fH):void 0;fF=fF.$1;}return fD;};A.filter=function(fB,fC){return A.ofSeq(bc.filter(fB,fC));};A.rev=function(fB){var fC,fD;fC=B.Empty;fD=fB;while(fD.$==1){fC=new B({$:1,$0:fD.$0,$1:fC});fD=fD.$1;}return fC;};A.max=function(fB){var fC,fD,fE;A.nonEmpty(fB);fC=fB.$0;fD=fB.$1;while(fD.$==1){fE=fD.$0;bk.Compare(fE,fC)===1?fC=fE:void 0;fD=fD.$1;}return fC;};A.sort=function(fB){var fC;fC=U.ofList(fB);U.sortInPlace(fC);return A.ofArray(fC);};A.append=function(fB,fC){var fD,fE,fF,fG,fH;if(fB.$==0)return fC;else if(fC.$==0)return fB;else{fG=new B({$:1});fD=fG;fE=fB;fF=true;while(fF){fD.$0=fE.$0;fE=fE.$1;fE.$==0?fF=false:fD=(fH=new B({$:1}),fD.$1=fH,fH);}fD.$1=fC;return fG;}};A.length=function(fB){var fC,fD;fC=fB;fD=0;while(fC.$==1){fC=A.tail(fC);fD=fD+1;}return fD;};A.iteri=function(fB,fC){var fD,fE;fD=fC;fE=0;while(fD.$==1){fB(fE,A.head(fD));fD=A.tail(fD);fE=fE+1;}};A.exists=function(fB,fC){var fD,fE;fD=false;fE=fC;while(!fD&&fE.$==1){fD=fB(fE.$0);fE=fE.$1;}return fD;};A.map2=function(fB,fC,fD){var fE,fF,fG,fH,fI,fJ;fE=fC.$==1&&fD.$==1;if(!fE)return fC.$==1||fD.$==1?A.badLengths():fC;else{fI=new B({$:1});fF=fI;fG=fC;fH=fD;while(fE){fF.$0=fB(fG.$0,fH.$0);fG=fG.$1;fH=fH.$1;fG.$==1&&fH.$==1?fF=(fJ=new B({$:1}),fF.$1=fJ,fJ):fE=false;}if(fG.$==1||fH.$==1)A.badLengths();fF.$1=B.Empty;return fI;}};A.reduce=function(fB,fC){var fD,fE;A.nonEmpty(fC);fD=fC.$0;fE=fC.$1;while(fE.$==1){fD=fB(fD,fE.$0);fE=fE.$1;}return fD;};A.choose=function(fB,fC){return A.ofSeq(bc.choose(fB,fC));};A.distinct=function(fB){return A.ofSeq(bc.distinct(fB));};A.groupBy=function(fB,fC){var fD;function fE(fF,fG){return[fF,A.ofArray(fG)];}fD=U.groupBy(fB,U.ofList(fC));U.mapInPlace(function(fF){return fE(fF[0],fF[1]);},fD);return A.ofArray(fD);};A.contains=function(fB,fC){var fD,fE;fD=false;fE=fC;while(!fD&&fE.$==1){fD=bk.Equals(fB,fE.$0);fE=fE.$1;}return fD;};A.head=function(fB){return fB.$==1?fB.$0:A.listEmpty();};A.nonEmpty=function(fB){if(fB.$==0)A.listEmpty();};A.sortBy=function(fB,fC){var fD;fD=U.ofList(fC);U.sortInPlaceBy(fB,fD);return A.ofArray(fD);};A.min=function(fB){var fC,fD,fE;A.nonEmpty(fB);fC=fB.$0;fD=fB.$1;while(fD.$==1){fE=fD.$0;bk.Compare(fE,fC)===-1?fC=fE:void 0;fD=fD.$1;}return fC;};A.partition=function(fB,fC){var fD;fD=U.partition(fB,U.ofList(fC));return[A.ofArray(fD[0]),A.ofArray(fD[1])];};A.tail=function(fB){return fB.$==1?fB.$1:A.listEmpty();};A.foldBack=function(fB,fC,fD){return U.foldBack(fB,U.ofList(fC),fD);};A.badLengths=function(){return F.FailWith("The lists have different lengths.");};A.concat=function(fB){return A.ofSeq(bc.concat(fB));};A.zip3=function(fB,fC,fD){return A.map3(function(fE,fF,fG){return[fE,fF,fG];},fB,fC,fD);};A.listEmpty=function(){return F.FailWith("The input list was empty.");};A.distinctBy=function(fB,fC){return A.ofSeq(bc.distinctBy(fB,fC));};A.indexed=function(fB){return A.mapi(function(fC,fD){return[fC,fD];},fB);};A.map3=function(fB,fC,fD,fE){var fF,fG,fH,fI,fJ,fK,fL;fF=fC.$==1&&fD.$==1&&fE.$==1;if(!fF)return fC.$==1||fD.$==1||fE.$==1?A.badLengths():fC;else{fK=new B({$:1});fG=fK;fH=fC;fI=fD;fJ=fE;while(fF){fG.$0=fB(fH.$0,fI.$0,fJ.$0);fH=fH.$1;fI=fI.$1;fJ=fJ.$1;fH.$==1&&fI.$==1&&fJ.$==1?fG=(fL=new B({$:1}),fG.$1=fL,fL):fF=false;}if(fH.$==1||fI.$==1||fJ.$==1)A.badLengths();fG.$1=B.Empty;return fK;}};A.unzip3=function(fB){var fC,fD,fE,fF,fG;fC=[];fD=[];fE=[];fF=da.Get(fB);try{while(fF.MoveNext()){fG=fF.Current();fC.push(fG[0]);fD.push(fG[1]);fE.push(fG[2]);}}finally{if(typeof fF=="object"&&"Dispose"in fF)fF.Dispose();}return[A.ofArray(fC.slice(0)),A.ofArray(fD.slice(0)),A.ofArray(fE.slice(0))];};A.forAll=function(fB,fC){var fD,fE;fD=true;fE=fC;while(fD&&fE.$==1){fD=fB(fE.$0);fE=fE.$1;}return fD;};A.mapi2=function(fB,fC,fD){var fE,fF,fG,fH,fI,fJ,fK;fE=fC.$==1&&fD.$==1;if(!fE)return fC.$==1||fD.$==1?A.badLengths():fC;else{fJ=new B({$:1});fF=fJ;fG=fC;fH=fD;fI=0;while(fE){fF.$0=fB(fI,fG.$0,fH.$0);fG=fG.$1;fH=fH.$1;fG.$==1&&fH.$==1?(fF=(fK=new B({$:1}),fF.$1=fK,fK),fI=fI+1):fE=false;}if(fG.$==1||fH.$==1)A.badLengths();fF.$1=B.Empty;return fJ;}};A.replicate=function(fB,fC){return A.ofArray(U.create(fB,fC));};A.scan=function(fB,fC,fD){return A.ofSeq(bc.scan(fB,fC,fD));};N=d.GuiIG=fu.Class({to_ig:function(){function fB(fF){return[fF.source,fF.target,fF.prior];}function fC(fF){return[fF.location,A.map(fB,fF.parameters)];}function fD(fF){var fG,fH;fG=dk.SplitChars(fF,["."],0);return!bk.Equals(fG,null)&&fG.length===1?new bH({$:0,$0:U.get(fG,0)}):!bk.Equals(fG,null)&&fG.length===2?(fH=U.get(fG,1),new bH({$:1,$0:[U.get(fG,0),fH]})):(function(fI){return function(fJ){return fI("bad location encoding "+_2.toSafe(fJ));};}(F.FailWith))(fF);}function fE(fF,fG){return[fD(fF),A.map(fC,fG)];}return J.New(this.task,K.Map(function(fF,fG){return fG.to_model();},this.nodes),K.OfArray(U.ofSeq(bc.map(function(fF){return fE(fF[0],fF[1]);},K.ToSeq(this.edges)))),this.expanded);}},null,N);N.from_ig=function(fB){function fC(fF,fG){return bK.New(fF,A.map(function(fH){return bJ.New(fH[0],fH[1],fH[2]);},fG));}function fD(fF){return fF.$==1?fF.$0[0]+"."+fF.$0[1]:fF.$0;}function fE(fF,fG){return[fD(fF),A.map(function(fH){return fC(fH[0],fH[1]);},fG)];}return N.New(fB.task,K.Map(function(fF,fG){return bj.from_model(fG);},fB.nodes),K.OfArray(U.ofSeq(bc.map(function(fF){return fE(fF[0],fF[1]);},K.ToSeq(fB.edges)))),fB.expanded);};N.New=function(fB,fC,fD,fE){return new N({task:fB,nodes:fC,edges:fD,expanded:fE});};O=d.Crn_settings=fu.Class({update_simulation:function(fB){return O.New(fB,this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,this.parameters,this.sweeps,this.rates,this.plot,this.quiet);},map_plots:function(fB,fC){return O.New(this.simulation.map(fC),A.map(function(fD){return fD.map(fC);},this.simulations),this.stochastic,this.deterministic,_6.map(fC,this.spatial),this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,this.parameters,this.sweeps,K.Map(function(fD,fE){return(function(){return fB;}(fD))(fE);},this.rates),this.plot.map(fC),this.quiet);},map:function(fB){return O.New(this.simulation.map(fB),A.map(function(fC){return fC.map(fB);},this.simulations),this.stochastic,this.deterministic,_6.map(fB,this.spatial),this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,this.parameters,this.sweeps,K.Map(function(fC,fD){return(function(){return fB;}(fC))(fD);},this.rates),this.plot.map(fB),this.quiet);},update_empty_plot_labels:function(){var fB;fB=_1.plot_label(this.simulator,this.spatial.dimensions,this.units);return O.New(this.simulation,this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,this.parameters,this.sweeps,this.rates,this.plot.update_empty_labels(fB[0],fB[1]),this.quiet);},to_simulation_runs:function(fB){var fC,fD,fE;fC=this;fD=bF.to_env(this.parameters);fE=A.unzip(A.map(function(fF){var fG;function fH(fI,fJ,fK,fL){return C.create$5(fB,fI,fJ,fK,fF,fL);}fG=A.collect(function(fI){return fI.data;},fF.filter_data(fC.data));return[A.map(function(fI){return fH(fI[0],fI[1],fI[2],fI[3]);},ek.eval_label(fD,fF.filter_sweeps(fC.sweeps))),fG];},this.simulations.$===0?A.ofArray([this.simulation]):this.simulations));return[A.concat(fE[0]),A.concat(fE[1])];},to_string:function(fB,fC){var fD;function fE(fG,fH){return(function(fI){return function(fJ){return fI("[\\n  "+_2.toSafe(fJ)+"\\n]");};}(a.id))(dk.concat(";\\n  ",A.map(fG,fH)));}function fF(fG,fH,fI){return fG?"":(((fu.Curried3(function(fJ,fK,fL){return fJ("directive "+_2.toSafe(fK)+" "+_2.toSafe(fL)+"\\n");}))(a.id))(fH))(fI);}fD=O.get_defaults();return fF(bk.Equals(this.simulation,fD.simulation),"simulation",this.simulation.to_string(fC))+fF(bk.Equals(this.simulations,fD.simulations),"simulations",fE(function(fG){return(((fu.Curried3(function(fH,fI,fJ){return fH(_2.toSafe(fI)+" = "+_2.toSafe(fJ));}))(a.id))(fG.name))(fG.to_string(fC));},this.simulations))+fF(bk.Equals(this.simulator,fD.simulator),"simulator",_1.get_to_string(this.simulator))+fF(bk.Equals(this.stochastic,fD.stochastic),"stochastic",_7.to_string(this.stochastic))+fF(bk.Equals(this.deterministic,fD.deterministic),"deterministic",bO.to_string(this.deterministic))+fF(bk.Equals(this.units,fD.units),"units",this.units.get_to_string())+fF(bk.Equals(this.spatial,fD.spatial),"spatial",_6.to_string(fC,this.spatial))+fF(bk.Equals(this.parameters,fD.parameters),"parameters",bF.to_string(this.parameters))+fF(bk.Equals(this.inference,fD.inference),"inference",(b0.get_to_string())(this.inference))+fF(bk.Equals(this.sweeps,fD.sweeps),"sweeps",b9.list_to_string(this.sweeps))+fF(bk.Equals(this.data,fD.data),"data","["+dk.concat("; ",A.map(function(fG){return fG.file;},this.data))+"]")+fF(bk.Equals(this.rates,fD.rates),"rates",fE(function(fG){return(((fu.Curried3(function(fH,fI,fJ){return fH(_2.toSafe(fI)+" = "+_2.toSafe(fJ));}))(a.id))(fG[0]))(fB(fG[1]));},A.ofSeq(K.ToSeq(this.rates))));},update_times:function(fB){return O.New(this.simulation.update_times(fB),this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,this.parameters,this.sweeps,this.rates,this.plot,this.quiet);},to_inference_runs:function(fB){var fC,fD,fE;fC=A.unzip3(A.map(function(fF){var fG;fG=A.unzip3(A.map(function(fH){var fI,fJ,fK,fL,fM,fN;fI=fH.filter_data(fF.data);fJ=A.collect(function(fO){return A.map(function(fP){return fH["final"]<A.max(fP.times)?Z.filter_by_tmax(fH["final"],fP):fP;},fO.data);},fI);fK=fH.filter_sweeps(fF.sweeps);fL=fI.get_Length();fM=fK.get_Length();(fL===1?fM===0||(fN=[fL,fM],false):(fN=[fL,fM],false))?void 0:fN[0]!==fN[1]?(function(fO){return function(fP){return fO("Incompatible number of sweeps and data in simulation "+_2.toSafe(fP));};}(F.FailWith))(fH.name):void 0;return[A.map(function(fO){return fH.update_times(fO.times);},fJ),fJ,fK];},fF.simulations.$===0?A.ofArray([fF.simulation]):fF.simulations));return[A.concat(fG[0]),A.concat(fG[1]),A.concat(fG[2])];},fB));fD=fC[2];fE=bF.expand_multiples(bk.Equals(fD,A.ofArray([B.Empty]))?A.ofArray([A.ofArray([b9.create$7()])]):fD,this.parameters);return[fE[1],fC[1],fE[0],fC[0],fE[2]];},from_directive_list:function(fB){return O.checkSweepParameters(bc.fold(function(fC,fD){return fC.from_directive(fD);},this,fB));},all_used_rates:function(fB,fC){var fD;fD=this;return K.OfArray(U.ofSeq(A.map(function(fE){return[fE,fD.rates.get_Item(fE)];},function(fE){var fF,fG,fH;while(true){fG=new dh.New$1(cx.OfSeq((function(fI){return function(fJ){return A.collect(fI,fJ);};}(function(fI){return fB(fD.rates.get_Item(fI));}))(fE)));fH=A.ofSeq((fF=new dh.New$1(cx.OfSeq(fE)),dg.Filter(function(fI){return!fF.Contains(fI);},fG)));if(fH.$==0)return fE;else fE=A.append(fE,fH);}}(A.append(A.collect(function(fE){var fF,fG;return A.append((fF=fE.rate,fF.$==1?fB(fF.$0):B.Empty),(fG=fE.reverse,fG!=null&&fG.$==1?fG.$0.$==1?fB(fG.$0.$0):B.Empty:B.Empty));},fC),A.collect(fB,A.append(this.simulation.plots,A.concat(A.map(function(fE){return fE.plots;},this.simulations)))))))));},substitute:function(fB){return O.New(this.simulation,this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,bF.substitute(fB,this.parameters),this.sweeps,this.rates,this.plot,this.quiet);},from_directive:function(fB){return fB.$==1?O.New(this.simulation,fB.$0,this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,this.parameters,this.sweeps,this.rates,this.plot,this.quiet):fB.$==2?O.New(this.simulation,this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,this.units,fB.$0,this.parameters,this.sweeps,this.rates,this.plot,this.quiet):fB.$==3?O.New(this.simulation,this.simulations,fB.$0,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,this.parameters,this.sweeps,this.rates,this.plot,this.quiet):fB.$==4?O.New(this.simulation,this.simulations,this.stochastic,fB.$0,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,this.parameters,this.sweeps,this.rates,this.plot,this.quiet):fB.$==5?O.New(this.simulation,this.simulations,this.stochastic,this.deterministic,this.spatial,fB.$0,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,this.parameters,this.sweeps,this.rates,this.plot,this.quiet):fB.$==6?O.New(this.simulation,this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,fB.$0,this.sweeps,this.rates,this.plot,this.quiet):fB.$==7?O.New(this.simulation,this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,this.parameters,this.sweeps,fB.$0,this.plot,this.quiet):fB.$==8?O.New(this.simulation,this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,this.parameters,fB.$0,this.rates,this.plot,this.quiet):fB.$==9?O.New(this.simulation,this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,A.map(b3.empty,fB.$0),this.units,this.simulator,this.parameters,this.sweeps,this.rates,this.plot,this.quiet):fB.$==10?O.New(this.simulation,this.simulations,this.stochastic,this.deterministic,fB.$0,this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,this.parameters,this.sweeps,this.rates,this.plot,this.quiet):fB.$==11?O.New(this.simulation,this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,this.parameters,this.sweeps,this.rates,fB.$0,this.quiet):fB.$==12?O.New(this.simulation,this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,fB.$0,this.simulator,this.parameters,this.sweeps,this.rates,this.plot,this.quiet):fB.$==13?O.New(this.simulation,this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,fB.$0,this.synthesis,this.data,this.units,this.simulator,this.parameters,this.sweeps,this.rates,this.plot,this.quiet):fB.$==14?O.New(this.simulation,this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,fB.$0,this.data,this.units,this.simulator,this.parameters,this.sweeps,this.rates,this.plot,this.quiet):O.New(fB.$0,this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,this.parameters,this.sweeps,this.rates,this.plot,this.quiet);},from_default_directive_list:function(fB){return bc.fold(function(fC,fD){return fC.from__default_directive(fD);},this,fB);},from__default_directive:function(fB){var fC,fD,fE;function fF(fI){function fJ(fK){return fK.name!==fI.name;}return function(fK){return A.filter(fJ,fK);};}function fG(fI){function fJ(fK){return fK.name!==fI.name;}return function(fK){return A.filter(fJ,fK);};}function fH(fI){function fJ(fK){return fK.name!==fI.name;}return function(fK){return A.filter(fJ,fK);};}return fB.$==1?(fC=fB.$0,O.New(this.simulation,A.append(bc.fold(function(fI,fJ){return(fF(fJ))(fI);},this.simulations,fC),fC),this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,this.parameters,this.sweeps,this.rates,this.plot,this.quiet)):fB.$==2?O.New(this.simulation,this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,this.units,fB.$0,this.parameters,this.sweeps,this.rates,this.plot,this.quiet):fB.$==3?O.New(this.simulation,this.simulations,fB.$0,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,this.parameters,this.sweeps,this.rates,this.plot,this.quiet):fB.$==4?O.New(this.simulation,this.simulations,this.stochastic,fB.$0,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,this.parameters,this.sweeps,this.rates,this.plot,this.quiet):fB.$==5?O.New(this.simulation,this.simulations,this.stochastic,this.deterministic,this.spatial,fB.$0,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,this.parameters,this.sweeps,this.rates,this.plot,this.quiet):fB.$==6?(fD=fB.$0,O.New(this.simulation,this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,A.append(bc.fold(function(fI,fJ){return(fG(fJ))(fI);},this.parameters,fD),fD),this.sweeps,this.rates,this.plot,this.quiet)):fB.$==7?O.New(this.simulation,this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,this.parameters,this.sweeps,bc.fold(function(fI,fJ){return fI.Add(fJ[0],fJ[1]);},this.rates,A.ofSeq(K.ToSeq(fB.$0))),this.plot,this.quiet):fB.$==8?(fE=fB.$0,O.New(this.simulation,this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,this.parameters,A.append(bc.fold(function(fI,fJ){return(fH(fJ))(fI);},this.sweeps,fE),fE),this.rates,this.plot,this.quiet)):fB.$==9?O.New(this.simulation,this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,A.map(b3.empty,fB.$0),this.units,this.simulator,this.parameters,this.sweeps,this.rates,this.plot,this.quiet):fB.$==10?O.New(this.simulation,this.simulations,this.stochastic,this.deterministic,fB.$0,this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,this.parameters,this.sweeps,this.rates,this.plot,this.quiet):fB.$==11?O.New(this.simulation,this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,this.parameters,this.sweeps,this.rates,fB.$0,this.quiet):fB.$==12?O.New(this.simulation,this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,fB.$0,this.simulator,this.parameters,this.sweeps,this.rates,this.plot,this.quiet):fB.$==13?O.New(this.simulation,this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,fB.$0,this.synthesis,this.data,this.units,this.simulator,this.parameters,this.sweeps,this.rates,this.plot,this.quiet):fB.$==14?O.New(this.simulation,this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,fB.$0,this.data,this.units,this.simulator,this.parameters,this.sweeps,this.rates,this.plot,this.quiet):O.New(fB.$0,this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,this.parameters,this.sweeps,this.rates,this.plot,this.quiet);}},null,O);O.parse=function(fB,fC){return O.parse_defaults(fB,fC,O.get_defaults());};O.parse_defaults=function(fB,fC,fD){var fE;function fF(fG){return fD.from_directive_list(fG);}fE=e0.parse_list(fB,fC);return function(fG){return dz.op_BarGreaterGreater(fE,fF,fG[0],fG[1]);};};O.get_defaults=function(){return O.New(P.get_defaults(),B.Empty,_7.get_defaults(),bO.get_defaults(),_6.get_defaults(),b0.get_defaults(),bD.defaults(),b2.get_defaults(),B.Empty,b7.get_defaults(),_1.get_defaults(),B.Empty,B.Empty,new y.New([]),b_.get_defaults(),false);};O.checkSweepParameters=function(fB){var fC;fC=A.distinct(A.map(function(fD){return fD.name;},fB.parameters));A.iter(function(fD){if(!A.contains(fD,fC))((function(fE){return function(fF){return fE("Sweep variable "+_2.toSafe(fF)+" not initialised");};}(F.FailWith))(fD));},A.collect(function(fD){return fD.get_mentions();},fB.sweeps));return fB;};O.parse_directives_defaults=function(fB,fC,fD){var fE,fF;return D.sepBy((fE=D.kw("directive"),(fF=O.parse_directive_defaults(fB,fC,fD),function(fG){return dz.op_GreaterGreaterDot(fE,fF,fG[0],fG[1]);})),D.spaces());};O.parse_directive_defaults=function(fB,fC,fD){var fE,fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO,fP,fQ,fR,fS,fT,fU,fV,fW,fX,fY,fZ,f0,f1,f2,f3,f4,f5,f6,f7,f8,f9,f_,f$,ga,gb,gc,gd,ge,gf,gg,gh,gi,gj,gk,gl,gm;function gn(gC){return bc.fold(function(gD,gE){var gF;gF=gE[0];if(gD.ContainsKey(gF))throw new cW.New((function(gG){return function(gH){return gG("Failed trying to parse duplicate rate expression "+_2.toSafe(gH));};}(a.id))(gF));else return gD.Add(gF,gE[1]);},new y.New([]),gC);}function go(gC){return{$:4,$0:gC};}function gp(gC){return{$:3,$0:gC};}function gq(gC){return{$:1,$0:gC};}function gr(gC){return{$:0,$0:gC};}function gs(gC){return{$:2,$0:gC};}function gt(gC){return{$:6,$0:gC};}function gu(gC){return{$:8,$0:gC};}function gv(gC){return{$:9,$0:gC};}function gw(gC){return{$:5,$0:gC};}function gx(gC){return{$:10,$0:gC};}function gy(gC){return{$:7,$0:gC};}function gz(gC){return{$:11,$0:gC};}function gA(gC){return{$:13,$0:gC};}function gB(gC){return{$:12,$0:gC};}fE=(fF=D.list_of((fG=(fH=D.skw("="),function(gC){return dz.op_GreaterGreaterDot(fH,fC,gC[0],gC[1]);}),function(gC){return dz.op_DotGreaterGreaterDot(D.name(),fG,gC[0],gC[1]);})),(fI=function(gC){return D.preturn(gn(gC));},function(gC){return dz.op_GreaterGreaterEquals(fF,fI,gC[0],gC[1]);}));fJ=D.choice([(fK=(fL=D.kw("deterministic"),(fM=bO.parse_defaults(fB.deterministic),function(gC){return dz.op_GreaterGreaterDot(fL,fM,gC[0],gC[1]);})),function(gC){return dz.op_BarGreaterGreater(fK,go,gC[0],gC[1]);}),(fN=(fO=D.kw("stochastic"),(fP=_7.parse_defaults(fB.stochastic),function(gC){return dz.op_GreaterGreaterDot(fO,fP,gC[0],gC[1]);})),function(gC){return dz.op_BarGreaterGreater(fN,gp,gC[0],gC[1]);}),(fQ=(fR=D.kw("simulations"),(fS=D.list_of(P.parse_named_defaults(fB.simulation,fD)),function(gC){return dz.op_GreaterGreaterDot(fR,fS,gC[0],gC[1]);})),function(gC){return dz.op_BarGreaterGreater(fQ,gq,gC[0],gC[1]);}),(fT=(fU=D.kw("simulation"),(fV=P.parse_defaults(fB.simulation,fD),function(gC){return dz.op_GreaterGreaterDot(fU,fV,gC[0],gC[1]);})),function(gC){return dz.op_BarGreaterGreater(fT,gr,gC[0],gC[1]);}),(fW=(fX=D.kw("simulator"),(fY=_1.get_parse(),function(gC){return dz.op_GreaterGreaterDot(fX,fY,gC[0],gC[1]);})),function(gC){return dz.op_BarGreaterGreater(fW,gs,gC[0],gC[1]);}),(fZ=(f0=D.kw("parameters"),(f1=D.list_of(bX.get_parse()),function(gC){return dz.op_GreaterGreaterDot(f0,f1,gC[0],gC[1]);})),function(gC){return dz.op_BarGreaterGreater(fZ,gt,gC[0],gC[1]);}),(f2=(f3=D.kw("sweeps"),(f4=D.list_of(b9.get_parse()),function(gC){return dz.op_GreaterGreaterDot(f3,f4,gC[0],gC[1]);})),function(gC){return dz.op_BarGreaterGreater(f2,gu,gC[0],gC[1]);}),(f5=(f6=D.kw("data"),(f7=D.list_of(D.name()),function(gC){return dz.op_GreaterGreaterDot(f6,f7,gC[0],gC[1]);})),function(gC){return dz.op_BarGreaterGreater(f5,gv,gC[0],gC[1]);}),(f8=(f9=D.kw("inference"),(f_=b0.parse_defaults(fB.inference),function(gC){return dz.op_GreaterGreaterDot(f9,f_,gC[0],gC[1]);})),function(gC){return dz.op_BarGreaterGreater(f8,gw,gC[0],gC[1]);}),(f$=(ga=D.kw("spatial"),(gb=_6.parse_defaults(fB.spatial,fD),function(gC){return dz.op_GreaterGreaterDot(ga,gb,gC[0],gC[1]);})),function(gC){return dz.op_BarGreaterGreater(f$,gx,gC[0],gC[1]);}),(gc=(gd=D.kw("rates"),function(gC){return dz.op_GreaterGreaterDot(gd,fE,gC[0],gC[1]);}),function(gC){return dz.op_BarGreaterGreater(gc,gy,gC[0],gC[1]);}),(ge=(gf=D.kw("plot_settings"),(gg=b_.parse_defaults(fB.plot,fD),function(gC){return dz.op_GreaterGreaterDot(gf,gg,gC[0],gC[1]);})),function(gC){return dz.op_BarGreaterGreater(ge,gz,gC[0],gC[1]);}),(gh=(gi=D.kw("moments"),(gj=bD.parse_defaults(fB.moment_closure),function(gC){return dz.op_GreaterGreaterDot(gi,gj,gC[0],gC[1]);})),function(gC){return dz.op_BarGreaterGreater(gh,gA,gC[0],gC[1]);}),(gk=(gl=D.kw("units"),(gm=b7.get_parse(),function(gC){return dz.op_GreaterGreaterDot(gl,gm,gC[0],gC[1]);})),function(gC){return dz.op_BarGreaterGreater(gk,gB,gC[0],gC[1]);})]);return function(gC){return fJ([gC[0],gC[1]]);};};O.New=function(fB,fC,fD,fE,fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO,fP,fQ){return new O({simulation:fB,simulations:fC,stochastic:fD,deterministic:fE,spatial:fF,inference:fG,moment_closure:fH,synthesis:fI,data:fJ,units:fK,simulator:fL,parameters:fM,sweeps:fN,rates:fO,plot:fP,quiet:fQ});};P=d.Simulation_settings=fu.Class({map:function(fB){return P.New(this.name,this.initial,this["final"],this.points,A.map(fB,this.plots),this.plotcolours,this.seed,this.kinetics,this.times,this.prune,this.multicore,this.data,this.sweeps);},get_print_interval:function(){return this.points>0?(this["final"]-this.initial)/this.points:0;},filter_sweeps:function(fB){return this.sweeps.$===0?fB:A.map(function(fC){try{return bc.find(function(fD){return fD.name===fC;},fB);}catch(fD){return F.FailWith("sweep "+fC+" not found in settings");}},this.sweeps);},filter_data:function(fB){return this.data.$===0?fB:A.map(function(fC){try{return bc.find(function(fD){return fD.file===fC;},fB);}catch(fD){return F.FailWith("dataset "+fC+" not found in settings");}},this.data);},to_string:function(fB){return this.to_string_defaults(P.get_defaults(),fB);},to_string_defaults:function(fB,fC){return"{"+(this.initial===fB.initial?"":(function(fD){return function(fE){return fD("initial="+_2.toSafe(fE)+"; ");};}(a.id))(a.String(this.initial)))+(this["final"]===fB["final"]?"":(function(fD){return function(fE){return fD("final="+_2.toSafe(fE)+"; ");};}(a.id))(a.String(this["final"])))+(this.points===fB.points?"":(function(fD){return function(fE){return fD("points="+_2.toSafe(fE)+"; ");};}(a.id))(a.String(this.points)))+(bk.Equals(this.plots,fB.plots)?"":(function(fD){return function(fE){return fD("plots=["+_2.toSafe(fE)+"]; ");};}(a.id))(dk.concat("; ",A.map(fC,this.plots))))+(A.exists(function(fD){return fD!=="";},this.plotcolours)?(function(fD){return function(fE){return fD("plotcolours=["+_2.toSafe(fE)+"]; ");};}(a.id))(dk.concat("; ",A.map(function(fD){return"\\""+fD+"\\"";},this.plotcolours))):"")+(bk.Equals(this.seed,fB.seed)?"":(function(fD){return function(fE){return fD("seed="+a.String(fE));};}(a.id))(this.seed.$0))+(bk.Equals(this.kinetics,fB.kinetics)?"":(function(fD){return function(fE){return fD("kinetics="+_2.toSafe(fE)+"; ");};}(a.id))(cu.get_to_string(this.kinetics)))+(bk.Equals(this.times,fB.times)?"":(function(fD){return function(fE){return fD("times=["+_2.toSafe(fE)+"]; ");};}(a.id))(dk.concat("; ",A.map(function(fD){var fE;fE=fD;return a.String(fE);},this.times))))+(bk.Equals(this.prune,fB.prune)?"":(function(fD){return function(fE){return fD("prune="+_2.toSafe(fE)+"; ");};}(a.id))(a.String(this.prune)))+(bk.Equals(this.multicore,fB.multicore)?"":(function(fD){return function(fE){return fD("multicore="+_2.toSafe(fE)+"; ");};}(a.id))(a.String(this.multicore)))+(bk.Equals(this.data,fB.data)?"":(function(fD){return function(fE){return fD("data=["+_2.toSafe(fE)+"]; ");};}(a.id))(dk.concat("; ",this.data)))+(bk.Equals(this.sweeps,fB.sweeps)?"":(function(fD){return function(fE){return fD("sweeps=["+_2.toSafe(fE)+"]; ");};}(a.id))(dk.concat("; ",this.sweeps)))+"}";},update_times:function(fB){return P.New(this.name,this.initial,this["final"],this.points,this.plots,this.plotcolours,this.seed,this.kinetics,fB,this.prune,this.multicore,this.data,this.sweeps);}},null,P);P.get_defaults=function(){return P.New("",0,1000,1000,B.Empty,B.Empty,null,"Contextual",B.Empty,true,false,B.Empty,B.Empty);};P.parse_named=function(fB){return P.parse_named_defaults(P.get_defaults(),fB);};P.parse=function(fB){return P.parse_defaults(P.get_defaults(),fB);};P.parse_named_defaults=function(fB,fC){return D.op_BarGreaterGreater(D.op_DotGreaterGreaterDot(D.name(),D.op_GreaterGreaterDot(D.skw("="),P.parse_defaults(fB,fC))),function(fD){var fE;fE=fD[1];return P.New(fD[0],fE.initial,fE["final"],fE.points,fE.plots,fE.plotcolours,fE.seed,fE.kinetics,fE.times,fE.prune,fE.multicore,fE.data,fE.sweeps);});};P.parse_defaults=function(fB,fC){return D.record(fB,A.ofArray([["initial",D.op_BarGreaterGreater(D.op_DotGreaterGreater(D.pfloat(),D.spaces()),function(fD){return function(fE){return P.New(fE.name,fD,fE["final"],fE.points,fE.plots,fE.plotcolours,fE.seed,fE.kinetics,fE.times,fE.prune,fE.multicore,fE.data,fE.sweeps);};})],["final",D.op_BarGreaterGreater(D.op_DotGreaterGreater(D.pfloat(),D.spaces()),function(fD){return function(fE){return P.New(fE.name,fE.initial,fD,fE.points,fE.plots,fE.plotcolours,fE.seed,fE.kinetics,fE.times,fE.prune,fE.multicore,fE.data,fE.sweeps);};})],["points",D.op_BarGreaterGreater(D.op_DotGreaterGreater(D.pint32(),D.spaces()),function(fD){return function(fE){return P.New(fE.name,fE.initial,fE["final"],fD,fE.plots,fE.plotcolours,fE.seed,fE.kinetics,fE.times,fE.prune,fE.multicore,fE.data,fE.sweeps);};})],["plots",D.op_BarGreaterGreater(D.list_of(D.op_DotGreaterGreater(fC,D.spaces())),function(fD){return function(fE){return P.New(fE.name,fE.initial,fE["final"],fE.points,fD,fE.plotcolours,fE.seed,fE.kinetics,fE.times,fE.prune,fE.multicore,fE.data,fE.sweeps);};})],["plotcolours",D.op_BarGreaterGreater(D.list_of(D.op_DotGreaterGreater(D.pcolour(),D.spaces())),function(fD){return function(fE){return P.New(fE.name,fE.initial,fE["final"],fE.points,fE.plots,fD,fE.seed,fE.kinetics,fE.times,fE.prune,fE.multicore,fE.data,fE.sweeps);};})],["seed",D.op_BarGreaterGreater(D.op_DotGreaterGreater(D.pint32(),D.spaces()),function(fD){return function(fE){return P.New(fE.name,fE.initial,fE["final"],fE.points,fE.plots,fE.plotcolours,{$:1,$0:fD},fE.kinetics,fE.times,fE.prune,fE.multicore,fE.data,fE.sweeps);};})],["kinetics",D.op_BarGreaterGreater(D.op_DotGreaterGreater(cu.get_parse(),D.spaces()),function(fD){return function(fE){return P.New(fE.name,fE.initial,fE["final"],fE.points,fE.plots,fE.plotcolours,fE.seed,fD,fE.times,fE.prune,fE.multicore,fE.data,fE.sweeps);};})],["prune",D.op_BarGreaterGreater(D.op_DotGreaterGreater(D.pbool(),D.spaces()),function(fD){return function(fE){return P.New(fE.name,fE.initial,fE["final"],fE.points,fE.plots,fE.plotcolours,fE.seed,fE.kinetics,fE.times,fD,fE.multicore,fE.data,fE.sweeps);};})],["multicore",D.op_BarGreaterGreater(D.op_DotGreaterGreater(D.pbool(),D.spaces()),function(fD){return function(fE){return P.New(fE.name,fE.initial,fE["final"],fE.points,fE.plots,fE.plotcolours,fE.seed,fE.kinetics,fE.times,fE.prune,fD,fE.data,fE.sweeps);};})],["data",D.op_BarGreaterGreater(D.list_of(D.op_DotGreaterGreater(D.name(),D.spaces())),function(fD){return function(fE){return P.New(fE.name,fE.initial,fE["final"],fE.points,fE.plots,fE.plotcolours,fE.seed,fE.kinetics,fE.times,fE.prune,fE.multicore,fD,fE.sweeps);};})],["sweeps",D.op_BarGreaterGreater(D.list_of(D.op_DotGreaterGreater(D.name(),D.spaces())),function(fD){return function(fE){return P.New(fE.name,fE.initial,fE["final"],fE.points,fE.plots,fE.plotcolours,fE.seed,fE.kinetics,fE.times,fE.prune,fE.multicore,fE.data,fD);};})]]));};P.New=function(fB,fC,fD,fE,fF,fG,fH,fI,fJ,fK,fL,fM,fN){return new P({name:fB,initial:fC,"final":fD,points:fE,plots:fF,plotcolours:fG,seed:fH,kinetics:fI,times:fJ,prune:fK,multicore:fL,data:fM,sweeps:fN});};Q.from_string_plot=function(fB){return D.from_string(Q.parse_plot(),fB);};Q.to_string_plot=function(fB){var fC;return fB.$==0&&(fB.$0.$==2&&(fC=fB.$0.$0,true))?be.to_string(fC):Q.to_string(fB);};Q.parse_plot=function(){dA.$cctor();return dA.parse_plot;};Q.to_string=function(fB){return R.to_string(function(fC){return co.to_string(be.to_string,fC);},fB);};Q.from_string=function(fB){return D.from_string(Q.parse(),fB);};Q.parse=function(){dA.$cctor();return dA.parse;};Q.all_species=function(fB,fC){return A.collect(function(fD){return fD.$==2?A.ofArray([fD.$0]):fD.$==1?Q.all_species(fB,fB.get_Item(fD.$0)):B.Empty;},R.mentions(fC));};R.map=function(fB,fC){return fC.$==1?{$:1,$0:fC.$0}:fC.$==2?{$:2,$0:A.map(function(fD){return R.map(fB,fD);},fC.$0)}:fC.$==3?{$:3,$0:ct.New(R.map(fB,fC.$0.div1),R.map(fB,fC.$0.div2))}:fC.$==4?{$:4,$0:cs.New(R.map(fB,fC.$0.base_),R.map(fB,fC.$0.exponent))}:fC.$==5?{$:5,$0:A.map(function(fD){return R.map(fB,fD);},fC.$0)}:fC.$==6?{$:6,$0:cr.New(R.map(fB,fC.$0.sub1),R.map(fB,fC.$0.sub2))}:fC.$==7?{$:7,$0:R.map(fB,fC.$0)}:fC.$==8?{$:8,$0:R.map(fB,fC.$0)}:fC.$==9?{$:9,$0:cq.New(R.map(fB,fC.$0.div),R.map(fB,fC.$0.modulo))}:fC.$==10?{$:10,$0:R.map(fB,fC.$0)}:fC.$==11?{$:11,$0:R.map(fB,fC.$0)}:fC.$==12?{$:12,$0:R.map(fB,fC.$0)}:fC.$==13?{$:13,$0:R.mapBool(fB,fC.$0),$1:R.map(fB,fC.$1),$2:R.map(fB,fC.$2)}:{$:0,$0:fB(fC.$0)};};R.to_string=function(fB,fC){var fD,fE;function fF(fG){return R.to_string(fB,fG);}return fC.$==1?a.String(fC.$0):fC.$==3?"("+fF(fC.$0.div1)+" / "+fF(fC.$0.div2)+")":fC.$==4?"("+fF(fC.$0.base_)+" ^ "+fF(fC.$0.exponent)+")":fC.$==2?(fD=fC.$0,fD.get_Length()===1?"prod("+fF(A.head(fD))+")":R.bracket(A.reduce(function(fG,fH){return fG+" * "+fH;},A.map(fF,fD)))):fC.$==5?(fE=fC.$0,fE.get_Length()===1?"sum("+fF(A.head(fE))+")":R.bracket(A.reduce(function(fG,fH){return fG+" + "+fH;},A.map(fF,fE)))):fC.$==6?"("+fF(fC.$0.sub1)+" - "+fF(fC.$0.sub2)+")":fC.$==7?"|"+fF(fC.$0)+"|":fC.$==8?"log("+fF(fC.$0)+")":fC.$==9?fF(fC.$0.div)+" % "+fF(fC.$0.modulo):fC.$==10?"ceiling("+fF(fC.$0)+")":fC.$==11?"floor("+fF(fC.$0)+")":fC.$==12?"round("+fF(fC.$0)+")":fC.$==13?"if "+R.to_string_bool(fB,fC.$0)+" then "+fF(fC.$1)+" else "+fF(fC.$2):fB(fC.$0);};R.mapBool=function(fB,fC){function fD(fF){return R.mapBool(fB,fF);}function fE(fF){return R.map(fB,fF);}return fC.$==1?cp.BFalse:fC.$==2?{$:2,$0:fE(fC.$0),$1:fE(fC.$1)}:fC.$==3?{$:3,$0:fE(fC.$0),$1:fE(fC.$1)}:fC.$==4?{$:4,$0:fE(fC.$0),$1:fE(fC.$1)}:fC.$==5?{$:5,$0:fE(fC.$0),$1:fE(fC.$1)}:fC.$==6?{$:6,$0:fE(fC.$0),$1:fE(fC.$1)}:fC.$==7?{$:7,$0:fD(fC.$0)}:fC.$==8?{$:8,$0:fD(fC.$0),$1:fD(fC.$1)}:fC.$==9?{$:9,$0:fD(fC.$0),$1:fD(fC.$1)}:cp.BTrue;};R["eval"]=function(fB,fC){function fD(fE){return R["eval"](fB,fE);}return fC.$==1?fC.$0:fC.$==2?bc.fold(function(fE,fF){return fE*fD(fF);},1,fC.$0):fC.$==3?fD(fC.$0.div1)/fD(fC.$0.div2):fC.$==4?fv.pow(fD(fC.$0.base_),fD(fC.$0.exponent)):fC.$==5?bc.fold(function(fE,fF){return fE+fD(fF);},0,fC.$0):fC.$==6?fD(fC.$0.sub1)-fD(fC.$0.sub2):fC.$==7?fv.abs(fD(fC.$0)):fC.$==8?fv.log(fD(fC.$0)):fC.$==9?R.moduloFloat(fD(fC.$0.div),fD(fC.$0.modulo)):fC.$==10?fv.ceil(fD(fC.$0)):fC.$==11?fv.floor(fD(fC.$0)):fC.$==12?fv.round(fD(fC.$0)):fC.$==13?R.evalBool(fB,fC.$0)?fD(fC.$1):fD(fC.$2):fB(fC.$0);};R.to_lambda=function(fB){return new cN({$:0,$0:R.to_lambda_inner(fB)});};R.bracket=function(fB){return fB===""?"":"("+fB+")";};R.to_string_bool=function(fB,fC){function fD(fF){return R.to_string(fB,fF);}function fE(fF){return R.to_string_bool(fB,fF);}return fC.$==1?"false":fC.$==2?fD(fC.$0)+" < "+fD(fC.$1):fC.$==3?fD(fC.$0)+" <= "+fD(fC.$1):fC.$==4?fD(fC.$0)+" = "+fD(fC.$1):fC.$==5?fD(fC.$0)+" >= "+fD(fC.$1):fC.$==6?fD(fC.$0)+" >= "+fD(fC.$1):fC.$==7?"not "+fE(fC.$0):fC.$==8?fE(fC.$0)+" && "+fE(fC.$1):fC.$==9?fE(fC.$0)+" || "+fE(fC.$1):"true";};R.expand=function(fB,fC){function fD(fE){return R.expand(fB,fE);}return fC.$==1?{$:1,$0:fC.$0}:fC.$==2?{$:2,$0:A.map(fD,fC.$0)}:fC.$==3?{$:3,$0:ct.New(fD(fC.$0.div1),fD(fC.$0.div2))}:fC.$==4?{$:4,$0:cs.New(fD(fC.$0.base_),fD(fC.$0.exponent))}:fC.$==5?{$:5,$0:A.map(fD,fC.$0)}:fC.$==6?{$:6,$0:cr.New(fD(fC.$0.sub1),fD(fC.$0.sub2))}:fC.$==7?{$:7,$0:fD(fC.$0)}:fC.$==8?{$:8,$0:fD(fC.$0)}:fC.$==9?{$:9,$0:cq.New(fD(fC.$0.div),fD(fC.$0.modulo))}:fC.$==10?{$:10,$0:fD(fC.$0)}:fC.$==11?{$:11,$0:fD(fC.$0)}:fC.$==12?{$:12,$0:fD(fC.$0)}:fC.$==13?{$:13,$0:R.expandBool(fB,fC.$0),$1:fD(fC.$1),$2:fD(fC.$2)}:fB(fC.$0);};R.simplify=function(fB){var fC,fD,fE,fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO,fP,fQ,fR,fS,fT,fU,fV,fW,fX,fY,fZ,f0,f1,f2,f3,f4;switch(fB.$==1?1:fB.$==2?(fC=fB.$0,2):fB.$==3?(fC=[fB,fB.$0.div1,fB.$0.div2],3):fB.$==4?(fC=[fB.$0.base_,fB.$0.exponent],4):fB.$==5?fB.$0.$==1?fB.$0.$1.$==0?(fC=fB.$0.$0,5):(fC=fB.$0,6):(fC=fB.$0,6):fB.$==6?(fC=[fB.$0.sub1,fB.$0.sub2],7):fB.$==7?(fC=fB.$0,8):fB.$==8?(fC=fB.$0,9):fB.$==9?(fC=[fB.$0.div,fB.$0.modulo],10):fB.$==10?(fC=fB.$0,11):fB.$==11?(fC=fB.$0,12):fB.$==12?(fC=fB.$0,13):fB.$==13?(fC=[fB.$0,fB.$1,fB.$2],14):0){case 0:return fB;case 1:return fB;case 2:if(fC.$==1&&(fC.$1.$==0&&(fE=fC.$0,true)))fD=R.simplify(fE);else if(A.exists(function(f5){return bk.Equals(f5,{$:1,$0:0});},fC))fD={$:1,$0:0};else{fH=A.filter((fF={$:1,$0:1},function(f5){return!bk.Equals(fF,f5);}),fC);fI=A.collect(function(f5){return f5.$==2?f5.$0:A.ofArray([f5]);},fH);fJ=R.split_floats(A.map(R.simplify,fI));switch(fJ[0].$==0?fJ[1].$==0?0:(fG=[fJ[1],fJ[0]],2):fJ[1].$==0?1:(fG=[fJ[1],fJ[0]],2)){case 0:fD={$:1,$0:1};break;case 1:fD={$:1,$0:bc.fold(function(f5,f6){return f5*f6;},1,fJ[0])};break;case 2:fD=(fK=fG[0],fL={$:1,$0:bc.fold(function(f5,f6){return f5*f6;},1,fG[1])},bk.Equals(fL,{$:1,$0:0})?fL:bk.Equals(fL,{$:1,$0:1})?{$:2,$0:fK}:{$:2,$0:new B({$:1,$0:fL,$1:fK})});break;}}return fD;case 3:fM=R.simplify(fC[1]);fN=R.simplify(fC[2]);return bk.Equals(fM,{$:1,$0:0})?fM:R.div(fM,fN);case 4:fO=R.simplify(fC[0]);fP=R.simplify(fC[1]);return bk.Equals(fO,{$:1,$0:0})?fO:R.power$1(fO,fP);case 5:return R.simplify(fC);case 6:fS=R.split_floats(A.map(R.simplify,fC));switch(fS[0].$==0?fS[1].$==0?0:(fR=[fS[1],fS[0]],2):fS[1].$==0?1:(fR=[fS[1],fS[0]],2)){case 0:fQ={$:1,$0:0};break;case 1:fQ={$:1,$0:bc.sum(fS[0])};break;case 2:fQ=(fT={$:1,$0:bc.sum(fR[1])},fU=R.simpleFactoring(A.collect(function(f5){return f5.$==5?f5.$0:A.ofArray([f5]);},fR[0])),bk.Equals(fT,{$:1,$0:0})?fU.get_Length()===1?A.head(fU):{$:5,$0:fU}:{$:5,$0:new B({$:1,$0:fT,$1:fU})});break;}return fQ;case 7:fV=R.simplify(fC[0]);fW=R.simplify(fC[1]);return bk.Equals(fV,fW)?{$:1,$0:0}:R.sub(fV,fW);case 8:fZ=R.simplify(fC);switch(fZ.$==1?fZ.$0===0?0:(fY=fZ,2):fZ.$==6?fZ.$0.sub1.$==1?fZ.$0.sub1.$0===0?(fY=fZ.$0.sub2,1):(fY=fZ,2):(fY=fZ,2):(fY=fZ,2)){case 0:fX={$:1,$0:0};break;case 1:fX={$:7,$0:fY};break;case 2:fX={$:7,$0:fY};break;}return fX;case 9:return{$:8,$0:R.simplify(fC)};case 10:f0=R.simplify(fC[0]);f1=R.simplify(fC[1]);return bk.Equals(f1,{$:1,$0:1})||bk.Equals(f0,{$:1,$0:0})?{$:1,$0:0}:{$:9,$0:cq.New(f0,f1)};case 11:return{$:10,$0:R.simplify(fC)};case 12:return{$:11,$0:R.simplify(fC)};case 13:return{$:12,$0:R.simplify(fC)};case 14:f2=fC[1];f3=fC[2];f4=R.simplifyBool(fC[0]);return f4.$==0?R.simplify(f2):f4.$==1?R.simplify(f3):{$:13,$0:f4,$1:R.simplify(f2),$2:R.simplify(f3)};}};R.from_string=function(fB,fC){return D.from_string(R.parse(fB),fC);};R.is_not_empty=function(fB){return!bk.Equals(R.simplify(fB),{$:1,$0:0});};R.mentions=function(fB){function fC(fE,fF){var fG;switch(fF.$==1?1:fF.$==2?2:fF.$==3?3:fF.$==4?4:fF.$==5?5:fF.$==6?6:fF.$==7?(fG=fF.$0,7):fF.$==8?(fG=fF.$0,7):fF.$==9?8:fF.$==10?(fG=fF.$0,9):fF.$==11?(fG=fF.$0,9):fF.$==12?(fG=fF.$0,9):fF.$==13?10:0){case 0:return new B({$:1,$0:fF.$0,$1:fE});case 1:return fE;case 2:return bc.fold(fC,fE,fF.$0);case 3:return fC(fC(fE,fF.$0.div1),fF.$0.div2);case 4:return fC(fC(fE,fF.$0.base_),fF.$0.exponent);case 5:return bc.fold(fC,fE,fF.$0);case 6:return fC(fC(fE,fF.$0.sub1),fF.$0.sub2);case 7:return fC(fE,fG);case 8:return fC(fC(fE,fF.$0.div),fF.$0.modulo);case 9:return fC(fE,fG);case 10:return fC(fC(fD(fE,fF.$0),fF.$1),fF.$2);}}function fD(fE,fF){return fF.$==1?fE:fF.$==2?fC(fC(fE,fF.$0),fF.$1):fF.$==3?fC(fC(fE,fF.$0),fF.$1):fF.$==4?fC(fC(fE,fF.$0),fF.$1):fF.$==5?fC(fC(fE,fF.$0),fF.$1):fF.$==6?fC(fC(fE,fF.$0),fF.$1):fF.$==7?fD(fE,fF.$0):fF.$==8?fD(fD(fE,fF.$0),fF.$1):fF.$==9?fD(fD(fE,fF.$0),fF.$1):fE;}return A.rev(fC(B.Empty,fB));};R.moduloFloat=function(fB,fC){return(fB%fC+fC)%fC;};R.evalBool=function(fB,fC){function fD(fF){return R["eval"](fB,fF);}function fE(fF){return R.evalBool(fB,fF);}return fC.$==1?false:fC.$==2?fD(fC.$0)<fD(fC.$1):fC.$==3?fD(fC.$0)<=fD(fC.$1):fC.$==4?fD(fC.$0)===fD(fC.$1):fC.$==5?fD(fC.$0)>=fD(fC.$1):fC.$==6?fD(fC.$0)>fD(fC.$1):fC.$==7?!fE(fC.$0):fC.$==8?fE(fC.$0)&&fE(fC.$1):fC.$==9?fE(fC.$0)||fE(fC.$1):true;};R.mul=function(fB,fC){var fD;switch(fB.$==1?fB.$0===0?(fD=fC,0):fB.$0===1?fC.$==1?fC.$0===0?(fD=fB,0):fC.$0===1?(fD=fC,1):(fD=fC,1):fC.$==2?(fD=fC,1):(fD=fC,1):fC.$==1?fC.$0===0?(fD=fB,0):fC.$0===1?(fD=fB,1):(fD=[fB.$0,fC.$0],2):fC.$==2?fC.$0.$==1?fC.$0.$0.$==1?(fD=[fB.$0,fC.$0.$0.$0,fC.$0.$1],3):(fD=[fB,fC.$0],4):(fD=[fB,fC.$0],4):5:fB.$==2?fC.$==1?fC.$0===0?(fD=fB,0):fC.$0===1?(fD=fB,1):fB.$0.$==1?fB.$0.$0.$==1?(fD=[fB.$0.$0.$0,fC.$0,fB.$0.$1],3):(fD=[fC,fB.$0],4):(fD=[fC,fB.$0],4):fC.$==2?(fD=[fC,fB.$0],4):(fD=[fC,fB.$0],4):fC.$==1?fC.$0===0?(fD=fB,0):fC.$0===1?(fD=fB,1):5:fC.$==2?(fD=[fB,fC.$0],4):5){case 0:return{$:1,$0:0};case 1:return fD;case 2:return{$:1,$0:fD[0]*fD[1]};case 3:return{$:2,$0:new B({$:1,$0:{$:1,$0:fD[0]*fD[1]},$1:fD[2]})};case 4:return{$:2,$0:new B({$:1,$0:fD[0],$1:fD[1]})};case 5:return{$:2,$0:A.ofArray([fB,fC])};}};R.to_lambda_inner=function(fB){var fC,fD,fE,fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO,fP,fQ,fR,fS,fT,fU,fV,fW,fX,fY;switch(fB.$==1?(fC=fB.$0,1):fB.$==2?fB.$0.$==1?fB.$0.$1.$==1?fB.$0.$1.$1.$==0?(fC=[fB.$0.$0,fB.$0.$1.$0],2):(fC=fB.$0,3):(fC=fB.$0,3):(fC=fB.$0,3):fB.$==3?(fC=[fB.$0.div1,fB.$0.div2],4):fB.$==4?(fC=[fB.$0.base_,fB.$0.exponent],5):fB.$==5?fB.$0.$==1?fB.$0.$1.$==1?fB.$0.$1.$1.$==0?(fC=[fB.$0.$0,fB.$0.$1.$0],6):(fC=fB.$0,7):(fC=fB.$0,7):(fC=fB.$0,7):fB.$==6?(fC=[fB.$0.sub1,fB.$0.sub2],8):fB.$==7?(fC=fB.$0,9):fB.$==8?(fC=fB.$0,10):fB.$==9?(fC=[fB.$0.div,fB.$0.modulo],11):fB.$==10?(fC=fB.$0,12):fB.$==11?(fC=fB.$0,13):fB.$==12?(fC=fB.$0,14):fB.$==13?(fC=[fB.$0,fB.$1,fB.$2],15):(fC=fB.$0,0)){case 0:return function(fZ){return fZ(fC);};case 1:return function(){return fC;};case 2:fD=R.to_lambda_inner(fC[0]);fE=R.to_lambda_inner(fC[1]);return function(fZ){return fD(fZ)*fE(fZ);};case 3:fF=A.map(R.to_lambda_inner,fC);return function(fZ){var f0,f1;f0=1;f1=da.Get(fF);try{while(f1.MoveNext())f0=f0*(f1.Current())(fZ);}finally{if(typeof f1=="object"&&"Dispose"in f1)f1.Dispose();}return f0;};case 4:fG=R.to_lambda_inner(fC[0]);fH=R.to_lambda_inner(fC[1]);return function(fZ){return fG(fZ)/fH(fZ);};case 5:fI=R.to_lambda_inner(fC[0]);fJ=R.to_lambda_inner(fC[1]);return function(fZ){return fv.pow(fI(fZ),fJ(fZ));};case 6:fK=R.to_lambda_inner(fC[0]);fL=R.to_lambda_inner(fC[1]);return function(fZ){return fK(fZ)+fL(fZ);};case 7:fM=A.map(R.to_lambda_inner,fC);return function(fZ){var f0,f1;f0=0;f1=da.Get(fM);try{while(f1.MoveNext())f0=f0+(f1.Current())(fZ);}finally{if(typeof f1=="object"&&"Dispose"in f1)f1.Dispose();}return f0;};case 8:fN=R.to_lambda_inner(fC[0]);fO=R.to_lambda_inner(fC[1]);return function(fZ){return fN(fZ)-fO(fZ);};case 9:fP=R.to_lambda_inner(fC);return function(fZ){return fv.abs(fP(fZ));};case 10:fQ=R.to_lambda_inner(fC);return function(fZ){return fv.log(fQ(fZ));};case 11:fR=R.to_lambda_inner(fC[0]);fS=R.to_lambda_inner(fC[1]);return function(fZ){return R.moduloFloat(fR(fZ),fS(fZ));};case 12:fT=R.to_lambda_inner(fC);return function(fZ){return fv.ceil(fT(fZ));};case 13:fU=R.to_lambda_inner(fC);return function(fZ){return fv.floor(fU(fZ));};case 14:fV=R.to_lambda_inner(fC);return function(fZ){return fv.round(fV(fZ));};case 15:fW=R.to_lambda_bool(fC[0]);fX=R.to_lambda_inner(fC[1]);fY=R.to_lambda_inner(fC[2]);return function(fZ){return fW(fZ)?fX(fZ):fY(fZ);};}};R.expandBool=function(fB,fC){function fD(fF){return R.expandBool(fB,fF);}function fE(fF){return R.expand(fB,fF);}return fC.$==1?cp.BFalse:fC.$==2?{$:2,$0:fE(fC.$0),$1:fE(fC.$1)}:fC.$==3?{$:3,$0:fE(fC.$0),$1:fE(fC.$1)}:fC.$==4?{$:4,$0:fE(fC.$0),$1:fE(fC.$1)}:fC.$==5?{$:5,$0:fE(fC.$0),$1:fE(fC.$1)}:fC.$==6?{$:6,$0:fE(fC.$0),$1:fE(fC.$1)}:fC.$==7?{$:7,$0:fD(fC.$0)}:fC.$==8?{$:8,$0:fD(fC.$0),$1:fD(fC.$1)}:fC.$==9?{$:9,$0:fD(fC.$0),$1:fD(fC.$1)}:cp.BTrue;};R.split_floats=function(fB){var fC,fD,fE,fF,fG,fH,fI;fC=B.Empty;fD=B.Empty;fE=fB;while(true)if(fE.$==1){if(fE.$0.$==1){fF=fE.$1;fG=fE.$0.$0;fC=new B({$:1,$0:fG,$1:fC});fE=fF;}else{fH=fE.$0;fI=fE.$1;fD=new B({$:1,$0:fH,$1:fD});fE=fI;}}else return[A.rev(fC),A.rev(fD)];};R.div=function(fB,fC){var fD;switch(fC.$==1?fC.$0===0?(fD=fB,0):fC.$0===1?fB.$==1?fB.$0===0?(fD=fC,1):(fD=fB,2):(fD=fB,2):fB.$==1?fB.$0===0?(fD=fC,1):(fD=[fB.$0,fC.$0],3):4:fB.$==1?fB.$0===0?(fD=fC,1):4:4){case 0:return F.FailWith("Division by 0");case 1:return{$:1,$0:0};case 2:return fD;case 3:return{$:1,$0:fD[0]/fD[1]};case 4:return{$:3,$0:ct.New(fB,fC)};}};R.power$1=function(fB,fC){var fD;switch(fC.$==1?fC.$0===0?(fD=fB,0):fC.$0===1?fB.$==1?fB.$0===1?1:(fD=fB,2):(fD=fB,2):fB.$==1?fB.$0===1?1:(fD=[fB.$0,fC.$0],3):4:fB.$==1?fB.$0===1?1:4:4){case 0:return{$:1,$0:1};case 1:return{$:1,$0:1};case 2:return fD;case 3:return{$:1,$0:fv.pow(fD[0],fD[1])};case 4:return{$:4,$0:cs.New(fB,fC)};}};R.simpleFactoring=function(fB){var fC,fD,fE,fF;return fB.$==1?(fC=fB.$1,(fD=fB.$0,R.isFactor(fD)?(fE=(R.splitFactor(fD))[1],(fF=A.partition(function(fG){return R.isFactor(fG)&&bk.Equals((R.splitFactor(fG))[1],fE);},fC),new B({$:1,$0:bc.fold(R.addFactors,fD,fF[0]),$1:R.simpleFactoring(fF[1])}))):new B({$:1,$0:fD,$1:R.simpleFactoring(fC)}))):B.Empty;};R.sub=function(fB,fC){var fD;switch(fC.$==1?fC.$0===0?(fD=fB,0):fB.$==1?(fD=[fB.$0,fC.$0],1):2:2){case 0:return fD;case 1:return{$:1,$0:fD[0]-fD[1]};case 2:return{$:6,$0:cr.New(fB,fC)};}};R.simplifyBool=function(fB){var fC;function fD(fG){return fG?cp.BTrue:cp.BFalse;}function fE(fG,fH,fI,fJ){var fK,fL,fM;fK=R.simplify(fG);fL=R.simplify(fH);return(fK.$==1?fL.$==1?(fM=[fK.$0,fL.$0],true):(fM=[fK,fL],false):(fM=[fK,fL],false))?fD((fI(fM[0]))(fM[1])):fJ([fM[0],fM[1]]);}function fF(fG,fH,fI,fJ){var fK,fL,fM;fL=R.simplifyBool(fG);fM=R.simplifyBool(fH);switch(fL.$==0?fM.$==0?0:fM.$==1?1:(fK=[fL,fM],4):fL.$==1?fM.$==0?2:fM.$==1?3:(fK=[fL,fM],4):(fK=[fL,fM],4)){case 0:return fD((fI(true))(true));case 1:return fD((fI(true))(false));case 2:return fD((fI(false))(true));case 3:return fD((fI(false))(false));case 4:return fJ([fK[0],fK[1]]);}}return fB.$==1?cp.BFalse:fB.$==2?fE(fB.$0,fB.$1,function(fG){return function(fH){return fG<fH;};},function(fG){return{$:2,$0:fG[0],$1:fG[1]};}):fB.$==3?fE(fB.$0,fB.$1,function(fG){return function(fH){return fG<=fH;};},function(fG){return{$:3,$0:fG[0],$1:fG[1]};}):fB.$==4?fE(fB.$0,fB.$1,function(fG){return function(fH){return fG===fH;};},function(fG){return{$:4,$0:fG[0],$1:fG[1]};}):fB.$==5?fE(fB.$0,fB.$1,function(fG){return function(fH){return fG>=fH;};},function(fG){return{$:5,$0:fG[0],$1:fG[1]};}):fB.$==6?fE(fB.$0,fB.$1,function(fG){return function(fH){return fG>fH;};},function(fG){return{$:6,$0:fG[0],$1:fG[1]};}):fB.$==7?(fC=R.simplifyBool(fB.$0),fC.$==0?cp.BFalse:fC.$==1?cp.BTrue:{$:7,$0:fC}):fB.$==8?fF(fB.$0,fB.$1,function(fG){return function(fH){return fG&&fH;};},function(fG){return{$:8,$0:fG[0],$1:fG[1]};}):fB.$==9?fF(fB.$0,fB.$1,function(fG){return function(fH){return fG||fH;};},function(fG){return{$:9,$0:fG[0],$1:fG[1]};}):cp.BTrue;};R.parse=function(fB){function fC(fD){return{$:0,$0:fD};}return R.exp(function(fD){return R.op_BarGreaterGreater(fB,fC,fD[0],fD[1]);});};R.to_mathML=function(fB,fC){return fC.$==1?{$:3,$0:{$:1,$0:fC.$0},$1:null}:fC.$==2?{$:2,$0:dW.Times,$1:A.map(function(fD){return R.to_mathML(fB,fD);},fC.$0)}:fC.$==3?{$:1,$0:dX.Divide,$1:R.to_mathML(fB,fC.$0.div1),$2:R.to_mathML(fB,fC.$0.div2)}:fC.$==4?{$:1,$0:dX.Power,$1:R.to_mathML(fB,fC.$0.base_),$2:R.to_mathML(fB,fC.$0.exponent)}:fC.$==5?{$:2,$0:dW.Plus,$1:A.map(function(fD){return R.to_mathML(fB,fD);},fC.$0)}:fC.$==6?{$:1,$0:dX.Subtract,$1:R.to_mathML(fB,fC.$0.sub1),$2:R.to_mathML(fB,fC.$0.sub2)}:fC.$==7?{$:0,$0:eE.Abs,$1:R.to_mathML(fB,fC.$0)}:fC.$==8?{$:0,$0:{$:31,$0:null},$1:R.to_mathML(fB,fC.$0)}:fC.$==9?{$:1,$0:dX.Mod,$1:R.to_mathML(fB,fC.$0.div),$2:R.to_mathML(fB,fC.$0.modulo)}:fC.$==10?{$:0,$0:eE.Ceiling,$1:R.to_mathML(fB,fC.$0)}:fC.$==11?{$:0,$0:eE.Floor,$1:R.to_mathML(fB,fC.$0)}:fC.$==12?F.FailWith("Conversion of rounding expression to MathML not supported."):fC.$==13?F.FailWith("Conversion of conditional expressions to MathML not supported."):{$:4,$0:fB(fC.$0)};};R.substitute=function(fB,fC){var fD,fE;function fF(fG){return R.substitute(fB,fG);}return fC.$==1?{$:1,$0:fC.$0}:fC.$==2?{$:2,$0:A.map(fF,fC.$0)}:fC.$==3?{$:3,$0:ct.New(fF(fC.$0.div1),fF(fC.$0.div2))}:fC.$==4?{$:4,$0:cs.New(fF(fC.$0.base_),fF(fC.$0.exponent))}:fC.$==5?{$:5,$0:A.map(fF,fC.$0)}:fC.$==6?{$:6,$0:cr.New(fF(fC.$0.sub1),fF(fC.$0.sub2))}:fC.$==7?{$:7,$0:fF(fC.$0)}:fC.$==8?{$:8,$0:fF(fC.$0)}:fC.$==9?{$:9,$0:cq.New(fF(fC.$0.div),fF(fC.$0.modulo))}:fC.$==10?{$:10,$0:fF(fC.$0)}:fC.$==11?{$:11,$0:fF(fC.$0)}:fC.$==12?{$:12,$0:fF(fC.$0)}:fC.$==13?{$:13,$0:R.substituteBool(fB,fC.$0),$1:fF(fC.$1),$2:fF(fC.$2)}:(fD=fC.$0,(fE=K.TryFind(fD,fB),fE!=null&&fE.$==1?fE.$0:{$:0,$0:fD}));};R.to_lambda_bool=function(fB){var fC,fD,fE,fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO,fP,fQ;return fB.$==1?function(){return false;}:fB.$==2?(fC=R.to_lambda_inner(fB.$0),(fD=R.to_lambda_inner(fB.$1),function(fR){return fC(fR)<fD(fR);})):fB.$==3?(fE=R.to_lambda_inner(fB.$0),(fF=R.to_lambda_inner(fB.$1),function(fR){return fE(fR)<=fF(fR);})):fB.$==4?(fG=R.to_lambda_inner(fB.$0),(fH=R.to_lambda_inner(fB.$1),function(fR){return fG(fR)===fH(fR);})):fB.$==5?(fI=R.to_lambda_inner(fB.$0),(fJ=R.to_lambda_inner(fB.$1),function(fR){return fI(fR)>=fJ(fR);})):fB.$==6?(fK=R.to_lambda_inner(fB.$0),(fL=R.to_lambda_inner(fB.$1),function(fR){return fK(fR)>fL(fR);})):fB.$==7?(fM=R.to_lambda_bool(fB.$0),function(fR){return!fM(fR);}):fB.$==8?(fN=R.to_lambda_bool(fB.$0),(fO=R.to_lambda_bool(fB.$1),function(fR){return fN(fR)&&fO(fR);})):fB.$==9?(fP=R.to_lambda_bool(fB.$0),(fQ=R.to_lambda_bool(fB.$1),function(fR){return fP(fR)||fQ(fR);})):function(){return true;};};R.isFactor=function(fB){return fB.$==0||fB.$==2&&(fB.$0.$==1&&(fB.$0.$0.$==1?fB.$0.$1.$==1&&(fB.$0.$1.$0.$==0&&fB.$0.$1.$1.$==0):fB.$0.$0.$==0&&(fB.$0.$1.$==1&&(fB.$0.$1.$0.$==1&&fB.$0.$1.$1.$==0))));};R.splitFactor=function(fB){var fC;switch(fB.$==0?(fC=fB.$0,0):fB.$==2?fB.$0.$==1?fB.$0.$0.$==1?fB.$0.$1.$==1?fB.$0.$1.$0.$==0?fB.$0.$1.$1.$==0?(fC=[fB.$0.$1.$0.$0,fB.$0.$0.$0],1):2:2:2:fB.$0.$0.$==0?fB.$0.$1.$==1?fB.$0.$1.$0.$==1?fB.$0.$1.$1.$==0?(fC=[fB.$0.$0.$0,fB.$0.$1.$0.$0],1):2:2:2:2:2:2){case 0:return[1,fC];case 1:return[fC[1],fC[0]];case 2:return F.FailWith("unexpected factor");}};R.addFactors=function(fB,fC){var fD;fD=R.splitFactor(fB);return{$:2,$0:A.ofArray([{$:1,$0:fD[0]+(R.splitFactor(fC))[0]},{$:0,$0:fD[1]}])};};R.exp=function(fB){var fC,fD,fE,fF,fG,fH,fI;function fJ(fL,fM){return{$:6,$0:cr.New(fL,fM)};}function fK(fL,fM){return{$:5,$0:A.ofArray([fL,fM])};}fC=(fD=D.choice([(fE=D.skw("-"),function(fL){return R.op_GreaterGreaterPercent(fE,function(fM){return function(fN){return fJ(fM,fN);};},fL[0],fL[1]);}),(fF=D.skw("+"),function(fL){return R.op_GreaterGreaterPercent(fF,function(fM){return function(fN){return fK(fM,fN);};},fL[0],fL[1]);})]),function(fL){return fD([fL[0],fL[1]]);});return D.chainl1Try((fG=D.choice([D.pTry(R.op_GreaterGreaterEquals((fH=D.kw("-"),(fI=R.term(fB),function(fL){return R.op_GreaterGreaterDot(fH,fI,fL[0],fL[1]);})),function(fL){return D.preturn({$:6,$0:cr.New({$:1,$0:0},fL)});})),D.pTry(R.term(fB))]),function(fL){return fG([fL[0],fL[1]]);}),fC);};R.op_BarGreaterGreater=function(fB,fC,fD,fE){return(D.op_BarGreaterGreater(fB,fC))([fD,fE]);};R.substituteBool=function(fB,fC){function fD(fF){return R.substituteBool(fB,fF);}function fE(fF){return R.substitute(fB,fF);}return fC.$==1?cp.BFalse:fC.$==2?{$:2,$0:fE(fC.$0),$1:fE(fC.$1)}:fC.$==3?{$:3,$0:fE(fC.$0),$1:fE(fC.$1)}:fC.$==4?{$:4,$0:fE(fC.$0),$1:fE(fC.$1)}:fC.$==5?{$:5,$0:fE(fC.$0),$1:fE(fC.$1)}:fC.$==6?{$:6,$0:fE(fC.$0),$1:fE(fC.$1)}:fC.$==7?{$:7,$0:fD(fC.$0)}:fC.$==8?{$:8,$0:fD(fC.$0),$1:fD(fC.$1)}:fC.$==9?{$:9,$0:fD(fC.$0),$1:fD(fC.$1)}:cp.BTrue;};R.op_GreaterGreaterEquals=function(fB,fC){return D.op_GreaterGreaterEquals(fB,fC);};R.op_GreaterGreaterDot=function(fB,fC,fD,fE){return(D.op_GreaterGreaterDot(fB,fC))([fD,fE]);};R.term=function(fB){var fC,fD,fE,fF;function fG(fI,fJ){return{$:2,$0:A.ofArray([fI,fJ])};}function fH(fI,fJ){return{$:9,$0:cq.New(fI,fJ)};}fC=(fD=D.choice([(fE=D.skw("*"),function(fI){return R.op_GreaterGreaterPercent(fE,function(fJ){return function(fK){return fG(fJ,fK);};},fI[0],fI[1]);}),(fF=D.skw("%"),function(fI){return R.op_GreaterGreaterPercent(fF,function(fJ){return function(fK){return fH(fJ,fK);};},fI[0],fI[1]);})]),function(fI){return fD([fI[0],fI[1]]);});return D.chainl1Try(R.factor(fB),fC);};R.op_GreaterGreaterPercent=function(fB,fC,fD,fE){return(D.op_GreaterGreaterPercent(fB,fC))([fD,fE]);};R.one=function(){fm.$cctor();return fm.one;};R.zero=function(){fm.$cctor();return fm.zero;};R.factor=function(fB){var fC,fD,fE,fF;function fG(fJ,fK){return{$:3,$0:ct.New(fJ,fK)};}function fH(fJ,fK){return{$:4,$0:cs.New(fJ,fK)};}function fI(fJ,fK){return{$:4,$0:cs.New(fJ,fK)};}return D.chainl1Try(R.irr(fB),(fC=D.choice([(fD=D.skw("/"),function(fJ){return R.op_GreaterGreaterPercent(fD,function(fK){return function(fL){return fG(fK,fL);};},fJ[0],fJ[1]);}),(fE=D.skw("^"),function(fJ){return R.op_GreaterGreaterPercent(fE,function(fK){return function(fL){return fH(fK,fL);};},fJ[0],fJ[1]);}),(fF=D.skw("**"),function(fJ){return R.op_GreaterGreaterPercent(fF,function(fK){return function(fL){return fI(fK,fL);};},fJ[0],fJ[1]);})]),function(fJ){return fC([fJ[0],fJ[1]]);}));};R.irr=function(fB){return D.pTry(function(fC){var fD,fE,fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO,fP,fQ,fR,fS,fT,fU,fV,fW,fX,fY;function fZ(ge,gf){return R.op_DotGreaterGreater(D.pfloat(),D.spaces(),ge,gf);}function f0(ge){return{$:1,$0:ge};}function f1(ge,gf){return R.op_DotGreaterGreater(D.pint32(),D.spaces(),ge,gf);}function f2(ge){return{$:1,$0:ge};}function f3(ge,gf){return R.es(fB,ge,gf);}function f4(ge){return{$:5,$0:ge};}function f5(ge,gf){return R.es(fB,ge,gf);}function f6(ge){return{$:2,$0:ge};}function f7(ge,gf){return R.e(fB,ge,gf);}function f8(ge){return{$:8,$0:ge};}function f9(ge,gf){return R.e(fB,ge,gf);}function f_(ge){return{$:10,$0:ge};}function f$(ge,gf){return R.e(fB,ge,gf);}function ga(ge){return{$:11,$0:ge};}function gb(ge,gf){return R.e(fB,ge,gf);}function gc(ge){return{$:12,$0:ge};}function gd(ge,gf){return R.bexp$1(fB,ge,gf);}return(D.choice([function(ge){return R.op_BarGreaterGreater(function(gf){return fZ(gf[0],gf[1]);},f0,ge[0],ge[1]);},(fD=function(ge){return f2(a.id(ge));},function(ge){return R.op_BarGreaterGreater(function(gf){return f1(gf[0],gf[1]);},fD,ge[0],ge[1]);}),(fE=(fF=D.kw("sum"),function(ge){return R.op_GreaterGreaterDot(fF,function(gf){return f3(gf[0],gf[1]);},ge[0],ge[1]);}),function(ge){return R.op_BarGreaterGreater(fE,f4,ge[0],ge[1]);}),(fG=(fH=D.kw("prod"),function(ge){return R.op_GreaterGreaterDot(fH,function(gf){return f5(gf[0],gf[1]);},ge[0],ge[1]);}),function(ge){return R.op_BarGreaterGreater(fG,f6,ge[0],ge[1]);}),(fI=(fJ=D.kw("log"),function(ge){return R.op_GreaterGreaterDot(fJ,function(gf){return f7(gf[0],gf[1]);},ge[0],ge[1]);}),function(ge){return R.op_BarGreaterGreater(fI,f8,ge[0],ge[1]);}),(fK=(fL=D.kw("ceiling"),function(ge){return R.op_GreaterGreaterDot(fL,function(gf){return f9(gf[0],gf[1]);},ge[0],ge[1]);}),function(ge){return R.op_BarGreaterGreater(fK,f_,ge[0],ge[1]);}),(fM=(fN=D.kw("floor"),function(ge){return R.op_GreaterGreaterDot(fN,function(gf){return f$(gf[0],gf[1]);},ge[0],ge[1]);}),function(ge){return R.op_BarGreaterGreater(fM,ga,ge[0],ge[1]);}),(fO=(fP=D.kw("round"),function(ge){return R.op_GreaterGreaterDot(fP,function(gf){return gb(gf[0],gf[1]);},ge[0],ge[1]);}),function(ge){return R.op_BarGreaterGreater(fO,gc,ge[0],ge[1]);}),R.op_GreaterGreaterEquals((fQ=(fR=(fS=(fT=(fU=D.kw("if"),function(ge){return R.op_GreaterGreaterDot(fU,function(gf){return gd(gf[0],gf[1]);},ge[0],ge[1]);}),(fV=D.kw("then"),function(ge){return R.op_DotGreaterGreater(fT,fV,ge[0],ge[1]);})),(fW=R.exp(fB),function(ge){return R.op_DotGreaterGreaterDot(fS,fW,ge[0],ge[1]);})),(fX=D.kw("else"),function(ge){return R.op_DotGreaterGreater(fR,fX,ge[0],ge[1]);})),(fY=R.exp(fB),function(ge){return R.op_DotGreaterGreaterDot(fQ,fY,ge[0],ge[1]);})),function(ge){var gf;gf=ge[0];return D.preturn({$:13,$0:gf[0],$1:gf[1],$2:ge[1]});}),fB,function(ge){return R.e(fB,ge[0],ge[1]);}]))([fC[0],fC[1]]);});};R.op_DotGreaterGreater=function(fB,fC,fD,fE){return(D.op_DotGreaterGreater(fB,fC))([fD,fE]);};R.es=function(fB,fC,fD){return(D.paren(D.sepBy(R.exp(fB),D.kw(";"))))([fC,fD]);};R.e=function(fB,fC,fD){return(D.paren(R.exp(fB)))([fC,fD]);};R.op_DotGreaterGreaterDot=function(fB,fC,fD,fE){return(D.op_DotGreaterGreaterDot(fB,fC))([fD,fE]);};R.bexp$1=function(fB,fC,fD){var fE;function fF(fH,fI){return R.bexp$1(fB,fH,fI);}function fG(fH){return{$:7,$0:fH};}return(D.choice([R.op_GreaterGreaterEquals((fE=D.kw("not"),function(fH){return R.op_GreaterGreaterDot(fE,function(fI){return fF(fI[0],fI[1]);},fH[0],fH[1]);}),function(fH){return D.preturn(fG(fH));}),R.op_GreaterGreaterEquals(function(fH){return R.bterm(fB,fH[0],fH[1]);},function(fH){var fI,fJ,fK;function fL(fN,fO){return R.bexp$1(fB,fN,fO);}function fM(fN,fO){return R.bexp$1(fB,fN,fO);}fI=D.choice([R.op_GreaterGreaterEquals((fJ=D.kw("&&"),function(fN){return R.op_GreaterGreaterDot(fJ,function(fO){return fL(fO[0],fO[1]);},fN[0],fN[1]);}),function(fN){return D.preturn({$:8,$0:fH,$1:fN});}),R.op_GreaterGreaterEquals((fK=D.kw("||"),function(fN){return R.op_GreaterGreaterDot(fK,function(fO){return fM(fO[0],fO[1]);},fN[0],fN[1]);}),function(fN){return D.preturn({$:9,$0:fH,$1:fN});}),D.preturn(fH)]);return function(fN){return fI([fN[0],fN[1]]);};}),D.paren(function(fH){return R.bexp$1(fB,fH[0],fH[1]);})]))([fC,fD]);};R.bterm=function(fB,fC,fD){var fE,fF,fG,fH;return(D.choice([(fE=D.kw("true"),(fF=D.preturn(cp.BTrue),function(fI){return R.op_GreaterGreaterDot(fE,fF,fI[0],fI[1]);})),(fG=D.kw("false"),(fH=D.preturn(cp.BFalse),function(fI){return R.op_GreaterGreaterDot(fG,fH,fI[0],fI[1]);})),R.op_GreaterGreaterEquals(R.exp(fB),function(fI){var fJ,fK,fL,fM,fN,fO,fP,fQ,fR,fS,fT;fJ=D.choice([R.op_GreaterGreaterEquals((fK=D.kw("<="),(fL=R.exp(fB),function(fU){return R.op_GreaterGreaterDot(fK,fL,fU[0],fU[1]);})),function(fU){return D.preturn({$:3,$0:fI,$1:fU});}),R.op_GreaterGreaterEquals((fM=D.kw("<"),(fN=R.exp(fB),function(fU){return R.op_GreaterGreaterDot(fM,fN,fU[0],fU[1]);})),function(fU){return D.preturn({$:2,$0:fI,$1:fU});}),R.op_GreaterGreaterEquals((fO=D.kw("="),(fP=R.exp(fB),function(fU){return R.op_GreaterGreaterDot(fO,fP,fU[0],fU[1]);})),function(fU){return D.preturn({$:4,$0:fI,$1:fU});}),R.op_GreaterGreaterEquals((fQ=D.kw(">="),(fR=R.exp(fB),function(fU){return R.op_GreaterGreaterDot(fQ,fR,fU[0],fU[1]);})),function(fU){return D.preturn({$:5,$0:fI,$1:fU});}),R.op_GreaterGreaterEquals((fS=D.kw(">"),(fT=R.exp(fB),function(fU){return R.op_GreaterGreaterDot(fS,fT,fU[0],fU[1]);})),function(fU){return D.preturn({$:6,$0:fI,$1:fU});})]);return function(fU){return fJ([fU[0],fU[1]]);};})]))([fC,fD]);};S.to_string=function(fB,fC){return S.to_string_normalise(true,fB,fC);};S.to_string_normalise=function(fB,fC,fD){return"<svg xmlns=\\"http://www.w3.org/2000/svg\\" height=\\""+S.display_float(fD.box_dim.y)+"\\" width=\\""+S.display_float(fD.box_dim.x)+"\\">\\r\\n  <style>"+fC+"</style>\\r\\n  "+S.group_to_string(fB,fD.box_group)+"\\r\\n</svg>";};S.stackhc=function(fB,fC,fD){var fE,fF;function fG(fH,fI){return function(fJ){var fK;return[new B({$:1,$0:(fK=fJ.box_group,cF.New(fK.name,fK.content,fK.anchors,fK.debug_anchors,fK.sub_groups,{$:1,$0:cD.New(fI.x,fI.y+(fE-fJ.box_dim.y)/2)})),$1:fH}),cD.New(fI.x+fJ.box_dim.x+fC,fI.y)];};}fE=A.max(A.map(function(fH){return fH.box_dim.y;},fD));fF=bc.fold(function(fH,fI){return(function(fJ){return fG(fJ[0],fJ[1]);}(fH))(fI);},[B.Empty,fB],fD);return cE.New(cF.New("",{$:0,$0:B.Empty},B.Empty,false,fF[0],null),cD.New(fF[1].x-fC+fB.x,fE+2*fB.y));};S.stackv=function(fB,fC,fD){var fE;function fF(fG,fH){return function(fI){var fJ;return[new B({$:1,$0:(fJ=fI.box_group,cF.New(fJ.name,fJ.content,fJ.anchors,fJ.debug_anchors,fJ.sub_groups,{$:1,$0:fH})),$1:fG}),cD.New(fH.x,fH.y+fI.box_dim.y+fC)];};}fE=bc.fold(function(fG,fH){return(function(fI){return fF(fI[0],fI[1]);}(fG))(fH);},[B.Empty,fB],fD);return cE.New(cF.New("",{$:0,$0:B.Empty},B.Empty,false,fE[0],null),cD.New((fD.$==0?0:A.max(A.map(function(fG){return fG.box_dim.x;},fD)))+2*fB.x,fE[1].y-fC+fB.y));};S.display_float=function(fB){return a.String(fv.floor(fB*1000)/1000);};S.group_to_string=function(fB,fC){return"<g"+(S.translate_to_string())(fC.offset)+">\\r\\n  "+S.content_to_string(fB,fC.content)+(fC.debug_anchors?dk.concat(" ",A.map(S.debug_anchor,fC.anchors)):"")+S.string_of_list(function(fD){return S.group_to_string(fB,fD);},"\\r\\n  ",fC.sub_groups)+"\\r\\n</g>";};S.label_box=function(fB,fC,fD){var fE;fE=fC*dk.length(fD);return cE.New(cF.New("",{$:0,$0:A.ofArray([el.New(fB,B.Empty,{$:1,$0:em.New(fD,cD.New(0,S.text_height()),fB,fC,cD.New(fE,S.text_height()))})])},B.Empty,false,B.Empty,null),cD.New(fE,S.text_height()));};S.default_letter_width=function(){en.$cctor();return en.default_letter_width;};S.translate_to_string=function(){en.$cctor();return en.translate_to_string;};S.content_to_string=function(fB,fC){return fC.$==1?fC.$0:S.string_of_list(function(fD){return S.path_to_string(fB,fD);},"\\r\\n  ",fC.$0);};S.debug_anchor=function(fB){return(((fu.Curried3(function(fC,fD,fE){return fC("<circle cx=\\""+fD.toFixed(6)+"\\" cy=\\""+fE.toFixed(6)+"\\" r=\\"5\\" stroke=\\"#DDDDFF\\" stroke-width=\\"0.5\\"/>");}))(a.id))(fB.anchor_point.x))(fB.anchor_point.y);};S.string_of_list=function(fB,fC,fD){return fD.$==0?"":A.reduce(function(fE,fF){return fE+fC+fF;},A.map(fB,fD));};S.text_height=function(){en.$cctor();return en.text_height;};S.content_group=function(fB){return cF.New("",fB,B.Empty,false,B.Empty,null);};S.path_to_string=function(fB,fC){var fD,fE,fF,fG;fD=(fE=fC.commands,fE.$==0?"":"<path "+(fF=fC.path_class,fF!=null&&fF.$==1?"class=\\""+fF.$0+"\\" ":"")+"d=\\""+S.string_of_list(S.path_command_to_string,"\\r\\n         ",fE)+"\\" />");fG=fC.path_label;return fG!=null&&fG.$==1?fD+"\\r\\n"+S.label_to_string(fB,fG.$0):fD;};S.fontsize=function(){en.$cctor();return en.fontsize;};S.translate_point_by=function(fB,fC){return cD.New(fB.x+fC.x,fB.y+fC.y);};S.transform_anchor_by=function(fB,fC){return dB.New(fC.anchor_id,fB(fC.anchor_point));};S.transform_path_command_by=function(fB,fC){return fC.$==1?{$:1,$0:fB(fC.$0)}:fC.$==2?{$:2,$0:fB(fC.$0),$1:fC.$1}:fC.$==3?e2.ClosePath:{$:0,$0:fB(fC.$0)};};S.transform_label_by=function(fB,fC){return em.New(fC.label_text,fB(fC.label_anchor),fC.label_class,fC.letter_width,fB(fC.label_dir));};S.transform_path_by=function(fB,fC){var fD;return el.New(fC.path_class,A.map(function(fE){return S.transform_path_command_by(fB,fE);},fC.commands),(fD=fC.path_label,fD!=null&&fD.$==1?{$:1,$0:S.transform_label_by(fB,fD.$0)}:null));};S.on_option=function(fB,fC,fD){return fD!=null&&fD.$==1?fB(fD.$0):fC;};S.point_to_string=function(fB){return S.display_float(fB.x)+","+S.display_float(fB.y);};S.transform_group_by=function(fB,fC){return cF.New(fC.name,S.transform_content_by(fB,fC.content),A.map(function(fD){return S.transform_anchor_by(fB,fD);},fC.anchors),fC.debug_anchors,A.map(function(fD){return S.transform_group_by(fB,fD);},fC.sub_groups),fC.offset);};S.path_command_to_string=function(fB){return fB.$==1?"L "+S.point_to_string(fB.$0):fB.$==2?"A "+S.arc_to_string(fB.$1)+" "+S.point_to_string(fB.$0):fB.$==3?"z":"M "+S.point_to_string(fB.$0);};S.label_to_string=function(fB,fC){var fD,fE;fD=fB?S.normalise_label(fC):fC;return"<text "+(fE=fD.label_class,fE!=null&&fE.$==1?"class=\\""+fE.$0+"\\" ":"")+" x=\\""+S.display_float(fD.label_anchor.x)+"\\" y=\\""+S.display_float(fD.label_anchor.y)+"\\" transform=\\"rotate("+S.display_float(S.label_angle(fD))+" "+S.point_to_string(fD.label_anchor)+")\\">"+fD.label_text+"</text>";};S.transform_content_by=function(fB,fC){return fC.$==1?{$:1,$0:fC.$0}:{$:0,$0:A.map(function(fD){return S.transform_path_by(fB,fD);},fC.$0)};};S.arc_to_string=function(fB){return S.display_float(fB.rx)+","+S.display_float(fB.ry)+" "+S.display_float(fB.angle)+" "+S.flag_to_string(fB.large_flag)+","+S.flag_to_string(fB.sweep_flag);};S.normalise_label=function(fB){var fC,fD,fE,fF,fG,fH,fI;fC=S.sub(fB.label_dir,fB.label_anchor);fD=S.ang(fC)%360;fE=fD<270&&fD>90?(fF=(fG=S.rotate_point_around(S.origo(),-90,fC),S.scale_to(S.half_text_height(),fG)),(fH=S.rotate_point_around(S.origo(),-180,fC),(fI=S.translate_point_by(fF,fB.label_anchor),[fI,S.translate_point_by(fH,fI)]))):[fB.label_anchor,fB.label_dir];return em.New(fB.label_text,fE[0],fB.label_class,fB.letter_width,fE[1]);};S.label_angle=function(fB){return S.ang(S.sub(fB.label_dir,fB.label_anchor));};S.flag_to_string=function(fB){return fB?"1":"0";};S.sub=function(fB,fC){return cD.New(fB.x-fC.x,fB.y-fC.y);};S.ang=function(fB){return S.rad_to_deg(S.dir(fB));};S.rotate_point_around=function(fB,fC,fD){var fE,fF,fG;fE=S.sub(fD,fB);fF=S.norm(fE);fG=S.dir(fE)+S.pi()*fC/180;return S.translate_point_by(fB,cD.New(fF*fv.cos(fG),fF*fv.sin(fG)));};S.origo=function(){en.$cctor();return en.origo;};S.scale_to=function(fB,fC){return S.scale_by(fB/S.norm(fC),fC);};S.half_text_height=function(){en.$cctor();return en.half_text_height;};S.dir=function(fB){var fC,fD;fC=fB.x;fD=fB.y;return fC===0?fD===0?0:fD>0?S.pi()/2:3*S.pi()/2:fD===0?fC>0?0:S.pi():fC>0?fv.atan(fD/fC):fv.atan(fD/fC)+S.pi();};S.rad_to_deg=function(fB){return 180*fB/S.pi();};S.norm=function(fB){return fv.sqrt(fB.x*fB.x+fB.y*fB.y);};S.pi=function(){en.$cctor();return en.pi;};S.scale_by=function(fB,fC){return cD.New(fB*fC.x,fB*fC.y);};T=d.Populations=fu.Class({set_population:function(fB,fC){var fD;U.set(this.index_to_species,fB,(fD=U.get(this.index_to_species,fB),W.New(fD.constant,fC,fD.species,fD.initial,fD.input,fD.spatial_initial,fD.max)));},get_population:function(fB){return U.get(this.index_to_species,fB).value;},get_get_pop_info_list:function(){return A.ofArray(this.index_to_species);},find_index:function(fB){return cS.find(this.species_to_index,fB);},get_get_pop_array:function(){return U.map(function(fB){return fB.value;},this.index_to_species);},get_get_count:function(){return this.index_to_species.length;},is_constant:function(fB){return U.get(this.index_to_species,fB).constant;},tryFind_index:function(fB){return cS.tryFind(this.species_to_index,fB);},get_clone:function(){return T.New(this.index_to_species.slice(),cS.copy(this.species_to_index));},map_population:function(fB){return T.New(U.map(function(fC){return W.create$1(fC.constant,fB(fC.value),fC.species,fC.initial,fC.input,fC.max);},this.index_to_species),cS.copy(this.species_to_index));},add_pop_info:function(fB){var fC,fD,fE,fF;return(fC=cS.tryFind(this.species_to_index,fB.species),fC!=null&&fC.$==1)?F.FailWith("Adding pop_info for species twice"):(fD=this.index_to_species.length,(fE=this.index_to_species.concat([fB]),(fF=cS.copy(this.species_to_index),(cS.add(fF,fB.species,fD),T.New(fE,fF)))));}},null,T);T.test_integer_or_constant=function(fB){return U.fold(function(fC,fD){var fE;fE=fD.value;return(fv.round(fE)-fE===0||fD.constant)&&fC;},true,fB.index_to_species);};T.scale=function(fB,fC){return fB.map_population(function(fD){return fC*fD;});};T.merge=function(fB,fC,fD){return U.fold(function(fE,fF){var fG,fH,fI;fG=cS.tryFind(fE.species_to_index,fF.species);return fG!=null&&fG.$==1?(fH=fG.$0,(fI=U.get(fE.index_to_species,fH),(U.set(fE.index_to_species,fH,W.New(fI.constant,fB(fI.value,fF.value),fI.species,fI.initial,fI.input,fI.spatial_initial,fI.max)),fE))):fE.add_pop_info(fF);},fC,fD.index_to_species);};T.create=function(fB){var fC,fD;fC=U.ofList(fB);fD=cS.empty();A.iteri(function(fE,fF){U.set(fC,fE,fF);return cS.add(fD,fF.species,fE);},fB);return T.New(fC,fD);};T.empty=function(){return T.New([],cS.empty());};T.New=function(fB,fC){return new T({index_to_species:fB,species_to_index:fC});};U.map=function(fB,fC){var fD,fE,fF;fD=new a.Array(fC.length);for(fE=0,fF=fC.length-1;fE<=fF;fE++)fD[fE]=fB(fC[fE]);return fD;};U.ofSeq=function(fB){var fC,fD;if(fB instanceof a.Array)return fB.slice();else if(fB instanceof B)return U.ofList(fB);else{fC=[];fD=da.Get(fB);try{while(fD.MoveNext())fC.push(fD.Current());return fC;}finally{if(typeof fD=="object"&&"Dispose"in fD)fD.Dispose();}}};U.mapi2=function(fB,fC,fD){var fE,fF,fG;U.checkLength(fC,fD);fE=new a.Array(fC.length);for(fF=0,fG=fC.length-1;fF<=fG;fF++)fE[fF]=fB(fF,fC[fF],fD[fF]);return fE;};U.mapi=function(fB,fC){var fD,fE,fF;fD=new a.Array(fC.length);for(fE=0,fF=fC.length-1;fE<=fF;fE++)fD[fE]=fB(fE,fC[fE]);return fD;};U.iter=function(fB,fC){var fD,fE;for(fD=0,fE=fC.length-1;fD<=fE;fD++)fB(fC[fD]);};U.ofList=function(fB){var fC,fD;fD=[];fC=fB;while(!(fC.$==0)){fD.push(A.head(fC));fC=A.tail(fC);}return fD;};U.iteri=function(fB,fC){var fD,fE;for(fD=0,fE=fC.length-1;fD<=fE;fD++)fB(fD,fC[fD]);};U.fold=function(fB,fC,fD){var fE,fF,fG;fE=fC;for(fF=0,fG=fD.length-1;fF<=fG;fF++)fE=fB(fE,fD[fF]);return fE;};U.exists=function(fB,fC){var fD,fE,fF,fG;fD=false;fE=0;fG=U.length(fC);while(!fD&&fE<fG)if(fB(fC[fE]))fD=true;else fE=fE+1;return fD;};U.create=function(fB,fC){var fD,fE,fF;fD=new a.Array(fB);for(fE=0,fF=fB-1;fE<=fF;fE++)fD[fE]=fC;return fD;};U.init=function(fB,fC){var fD,fE,fF;fB<0?F.FailWith("Negative size given."):null;fD=new a.Array(fB);for(fE=0,fF=fB-1;fE<=fF;fE++)fD[fE]=fC(fE);return fD;};U.tryFindIndex=function(fB,fC){var fD,fE;fD=null;fE=0;while(fE<fC.length&&fD==null){fB(fC[fE])?fD={$:1,$0:fE}:void 0;fE=fE+1;}return fD;};U.collect=function(fB,fC){return a.Array.prototype.concat.apply([],U.map(fB,fC));};U.concat=function(fB){return a.Array.prototype.concat.apply([],U.ofSeq(fB));};U.checkLength=function(fB,fC){if(fB.length!==fC.length)F.FailWith("The arrays have different lengths.");};U.min=function(fB){var fC,fD,fE,fF;U.nonEmpty(fB);fC=fB[0];for(fD=1,fE=fB.length-1;fD<=fE;fD++){fF=fB[fD];bk.Compare(fF,fC)===-1?fC=fF:void 0;}return fC;};U.max=function(fB){var fC,fD,fE,fF;U.nonEmpty(fB);fC=fB[0];for(fD=1,fE=fB.length-1;fD<=fE;fD++){fF=fB[fD];bk.Compare(fF,fC)===1?fC=fF:void 0;}return fC;};U.last=function(fB){U.nonEmpty(fB);return fB[fB.length-1];};U.sortInPlace=function(fB){U.mapInPlace(function(fC){return fC[0];},U.mapiInPlace(function(fC,fD){return[fD,fC];},fB).sort(bk.Compare));};U.map2=function(fB,fC,fD){var fE,fF,fG;U.checkLength(fC,fD);fE=new a.Array(fD.length);for(fF=0,fG=fD.length-1;fF<=fG;fF++)fE[fF]=fB(fC[fF],fD[fF]);return fE;};U.nonEmpty=function(fB){if(fB.length===0)F.FailWith("The input array was empty.");};U.average=function(fB){return a.Number(U.sum(fB))/fB.length;};U.sum=function(fB){var fC,fD;fC=0;fD=0;for(;fD<fB.length;fD++)fC+=fB[fD];return fC;};U.unzip=function(fB){var fC,fD,fE,fF,fG;fC=[];fD=[];for(fE=0,fF=fB.length-1;fE<=fF;fE++){fG=fB[fE];fC.push(fG[0]);fD.push(fG[1]);}return[fC,fD];};U.fold2=function(fB,fC,fD,fE){var fF,fG,fH;U.checkLength(fD,fE);fF=fC;for(fG=0,fH=fD.length-1;fG<=fH;fG++)fF=fB(fF,fD[fG],fE[fG]);return fF;};U.head=function(fB){U.nonEmpty(fB);return fB[0];};U.findIndex=function(fB,fC){var fD;fD=U.tryFindIndex(fB,fC);return fD==null?F.FailWith("KeyNotFoundException"):fD.$0;};U.sortInPlaceBy=function(fB,fC){U.mapInPlace(function(fD){return fD[0];},U.mapiInPlace(function(fD,fE){return[fE,[fB(fE),fD]];},fC).sort(function(fD,fE){return bk.Compare(fD[1],fE[1]);}));};U.partition=function(fB,fC){var fD,fE,fF,fG;fD=[];fE=[];for(fF=0,fG=fC.length-1;fF<=fG;fF++)if(fB(fC[fF]))fD.push(fC[fF]);else fE.push(fC[fF]);return[fD,fE];};U.reduce=function(fB,fC){var fD,fE,fF;U.nonEmpty(fC);fD=fC[0];for(fE=1,fF=fC.length-1;fE<=fF;fE++)fD=fB(fD,fC[fE]);return fD;};U.foldBack=function(fB,fC,fD){var fE,fF,fG,fH,fI;fE=fD;fG=fC.length;for(fH=1,fI=fG;fH<=fI;fH++)fE=fB(fC[fG-fH],fE);return fE;};U.unzip3=function(fB){var fC,fD,fE,fF,fG,fH;fC=[];fD=[];fE=[];for(fF=0,fG=fB.length-1;fF<=fG;fF++){fH=fB[fF];fC.push(fH[0]);fD.push(fH[1]);fE.push(fH[2]);}return[fC,fD,fE];};U.pick=function(fB,fC){var fD;fD=U.tryPick(fB,fC);return fD==null?F.FailWith("KeyNotFoundException"):fD.$0;};U.filter=function(fB,fC){var fD,fE,fF;fD=[];for(fE=0,fF=fC.length-1;fE<=fF;fE++)if(fB(fC[fE]))fD.push(fC[fE]);return fD;};U.sumBy=function(fB,fC){var fD,fE;fD=0;fE=0;for(;fE<fC.length;fE++)fD+=fB(fC[fE]);return fD;};U.tryPick=function(fB,fC){var fD,fE,fF;fD=null;fE=0;while(fE<fC.length&&fD==null){fF=fB(fC[fE]);fF!=null&&fF.$==1?fD=fF:void 0;fE=fE+1;}return fD;};U.choose=function(fB,fC){var fD,fE,fF,fG;fD=[];for(fE=0,fF=fC.length-1;fE<=fF;fE++){fG=fB(fC[fE]);fG==null?void 0:fD.push(fG.$0);}return fD;};U.forall=function(fB,fC){var fD,fE,fF,fG;fD=true;fE=0;fG=U.length(fC);while(fD&&fE<fG)if(fB(fC[fE]))fE=fE+1;else fD=false;return fD;};U.exists2=function(fB,fC,fD){var fE,fF,fG,fH;U.checkLength(fC,fD);fE=false;fF=0;fH=U.length(fC);while(!fE&&fF<fH)if(fB(fC[fF],fD[fF]))fE=true;else fF=fF+1;return fE;};U.zip=function(fB,fC){var fD,fE,fF;U.checkLength(fB,fC);fD=U.create(fB.length,null);for(fE=0,fF=fB.length-1;fE<=fF;fE++)fD[fE]=[fB[fE],fC[fE]];return fD;};V=d.Initial=fu.Class({scale:function(fB){return V.New(this.constant,fB(this.value),this.species,this.time,this.spatial);}},null,V);V.create$1=function(fB,fC,fD){return V.create$4(false,fB,fC,fD,null);};V.create$4=function(fB,fC,fD,fE,fF){return V.New(fB,fC,fD,fE,fF);};V.to_initialpops_events=function(fB,fC,fD){function fE(fF){return fF.value;}return V.to_initialpops_events_poly(fB,fC,fD,function(fF){return bc.sumBy(fE,fF);});};V.to_initialpops_events_poly=function(fB,fC,fD,fE){var fF,fG,fH;function fI(fN){return di.find(fB,fN);}function fJ(fN,fO){function fP(fQ,fR){var fS;fS=W.create(bc.exists(function(fT){return fT.constant;},fR),fE(fR),fQ);return W.New(fS.constant,fS.value,fS.species,false,fS.input,fS.spatial_initial,fS.max);}return cT.create(T.create(A.ofSeq(bc.map(function(fQ){return fP(fQ[0],fQ[1]);},bc.groupBy(function(fQ){return fQ.species;},fO)))),fN);}function fK(fN,fO,fP){return W.create(fP,fO,fN);}function fL(fN){var fO;fO=bc.length(bc.filter(function(fP){return fP.constant;},fN));return fO===0?false:fO===1?bc.length(fN)===1||F.FailWith("Constancy overload"):F.FailWith("Constancy overload");}function fM(fN,fO){return[fN,fE(bc.filter(function(fP){var fQ;fQ=fP.time;return fQ==null||fQ.$0===fC;},fO)),fL(fO)];}fF=A.map((fG=function(fN){return R["eval"](fI,fN);},function(fN){return V["eval"](fG,fN);}),fD);fH=A.ofSeq(bc.map(function(fN){return fJ(fN[0],fN[1]);},bc.groupBy(function(fN){return fN.time.$0;},A.filter(function(fN){var fO;fO=fN.time;return fO==null?false:fO.$0!==fC;},fF))));return[T.create(A.ofSeq(bc.map(function(fN){return fK(fN[0],fN[1],fN[2]);},bc.map(function(fN){return fM(fN[0],fN[1]);},bc.groupBy(function(fN){return fN.species;},fF))))),fH];};V.from_gui=function(fB,fC,fD){var fE;return V.create$4(fD.constant,fC(fD.value),fB(fD.species),(fE=fD.time,fE==null?null:{$:1,$0:fC(fE.$0)}),fD.spatial);};V.create$3=function(fB,fC,fD,fE){return V.create$4(fB,fC,fD,fE,null);};V.to_gui=function(fB,fC,fD){var fE;return V.create$4(fD.constant,fC(fD.value),fB(fD.species),(fE=fD.time,fE==null?null:{$:1,$0:fC(fE.$0)}),fD.spatial);};V.mapValues=function(fB,fC){var fD;return V.create$4(fC.constant,fB(fC.value),fC.species,(fD=fC.time,fD==null?null:{$:1,$0:fB(fD.$0)}),fC.spatial);};V["eval"]=function(fB,fC){var fD;return V.create$4(fC.constant,fB(fC.value),fC.species,(fD=fC.time,fD==null?null:{$:1,$0:fB(fD.$0)}),fC.spatial);};V.to_string=function(fB,fC,fD,fE){var fF,fG,fH;return(fE.constant?"constant ":"")+fC(fE.value)+" "+fB(fE.species)+(fF=fE.spatial,fF!=null&&fF.$==1?(fG=fF.$0,!bk.Equals(fG,cd.defaults())?"{ spatial = "+cd.to_string(fG)+"}":""):(fH=fE.time,fH==null?"":" @ "+fC(fH.$0)));};V.parse=function(fB,fC,fD){var fE,fF,fG,fH,fI,fJ,fK;function fL(fN,fO){return D.preturn(V.create$4(fN[0][0][0],fN[0][1],fN[0][0][1],fN[1],fO));}function fM(fN){return D.op_LessQmarkGreater(D.record(V.create$4(false,fD,fN,null,null),A.ofArray([["spatial",D.op_BarGreaterGreater(cd.parser(),function(fO){return function(fP){return V.New(fP.constant,fP.value,fP.species,fP.time,{$:1,$0:fO});};})],["time",D.op_BarGreaterGreater(fC,function(fO){return function(fP){return V.New(fP.constant,fP.value,fP.species,{$:1,$0:fO},fP.spatial);};})],["value",D.op_BarGreaterGreater(fC,function(fO){return function(fP){return V.New(fP.constant,fO,fP.species,fP.time,fP.spatial);};})],["constant",D.op_BarGreaterGreater(D.op_DotGreaterGreater(D.pbool(),D.spaces()),function(fO){return function(fP){return V.New(fO,fP.value,fP.species,fP.time,fP.spatial);};})]])),"{InitialFields}");}fE=D.kw("constant");fF=D.kw("init");fG=D.kw("spatial");fH=D.opt(D.op_GreaterGreaterPlus(D.kw("@"),fC));fI=D.op_BarGreaterGreater(D.opt(fE),function(fN){return fN!=null;});fJ=D.braces(D.op_GreaterGreaterDot(D.op_GreaterGreaterDot(fG,D.kw("=")),cd.parser()));fK=D.choice([D.op_GreaterGreaterEquals(D.op_DotGreaterGreater(D.op_GreaterGreaterDot(fF,D.op_PlusGreaterGreaterPlus(fI,fB)),D.spaces()),function(fN){var fO;fO=D.choice([D.op_BarGreaterGreater(fM(fN[1]),function(fP){return V.create$4(fN[0],fP.value,fP.species,fP.time,fP.spatial);}),D.op_GreaterGreaterEquals(D.op_PlusGreaterGreaterPlus(fC,fH),function(fP){return fL([[fN,fP[0]],fP[1]],null);})]);return function(fP){return fO([fP[0],fP[1]]);};}),D.op_LessQmarkGreater(D.pTry(D.op_GreaterGreaterEquals(D.op_PlusGreaterGreater(fB,D.kw("=")),fM)),"<species> = <record>"),D.op_GreaterGreaterEquals(D.op_DotGreaterGreaterDot(D.op_LessQmarkGreater(D.pTry(D.op_PlusGreaterGreaterPlus(D.op_PlusGreaterGreaterPlus(D.op_DotGreaterGreaterDot(fI,fC),fB),fH)),"<value> <species>"),D.opt(fJ)),function(fN){var fO;fO=fN[0];return fL([[[fO[0][0][0],fO[0][1]],fO[0][0][1]],fO[1]],fN[1]);})]);return function(fN){return fK([fN[0],fN[1]]);};};V.New=function(fB,fC,fD,fE,fF){return new V({constant:fB,value:fC,species:fD,time:fE,spatial:fF});};W=d.Population=fu.Class({},null,W);W.create=function(fB,fC,fD){return W.create$1(fB,fC,fD,true,true,null);};W.create$1=function(fB,fC,fD,fE,fF,fG){return W.New(fB,fC,fD,fE,fF,null,fG);};W.New=function(fB,fC,fD,fE,fF,fG,fH){return new W({constant:fB,value:fC,species:fD,initial:fE,input:fF,spatial_initial:fG,max:fH});};X=d.OdeOslo=fu.Class({simulate_callback:function(fB,fC,fD){var fE,fF,fG,fH,fI,fJ;function fK(fO,fP){return fv.pow(fO,fP);}function fL(fO,fP){return fO[fP];}function fM(fO,fP){var fR,fS,fT;function fQ(fU){return fU.$==1?fO:fL(fP,fU.$0);}for(fR=0,fS=fH.length-1;fR<=fS;fR++){fI.set_Item(fR,(fT=U.get(fH,fR),fT.$==1?(fT.$0.get_key())(fQ):bc.fold(function(fU,fV){return fU*fK(fP[fV[0]],fV[1]);},fT.$0,U.get(fG,fR))));}return cO.matrMultVec(fF,cL.ofArray(fI.ToArray()));}function fN(fO,fP){function fQ(fR){return fR.$==1?fO:fL(fP,fR.$0);}return U.map(function(fR){return R["eval"](fQ,fR);},fE.plots);}fE=this;fF=this.stoich;fG=this.powers;fH=this.rateDs;fI=cH.create(fH.length,1);fJ=cI.simulate_callback(fB,fC,cI.create(this.name,this.simulator,function(fO){return function(fP){return fN(fO,fP);};},fu.Curried(cv.interpolate_float,5),this.settings,this.concs,function(fO){return function(fP){return fM(fO,fP);};}));U.iteri(function(fO,fP){return fJ.simulator.populations.set_population(fO,fP);},cL.toArray(fJ.concs));fD(fJ.simulator.populations);return X.New(this.name,fJ.simulator,this.plots,this.settings,this.stoich,this.powers,this.rateDs,this.concs);},simulate:function(){return(this.simulate_state())[1];},simulate_state:function(){var fB;fB=[B.Empty];return[this.simulate_callback([false],function(fC){fB[0]=new B({$:1,$0:fC,$1:fB[0]});},a.ignore),this.process_simulation(fB[0])];},process_simulation:function(fB){var fC,fD;fC=this.simulator.settings.times;fD=A.map(Q.to_string_plot,this.simulator.settings.plots);return fC.$==0?Z.from_rows_reverse(fD,fB):Z.from_rows_reverse(fD,cv.interpolate_reverse(function(fE,fF,fG){return fu.Curried(cv.interpolate_float,2,[fE,fF,fG]);},A.rev(fB),fC));}},null,X);X.New=function(fB,fC,fD,fE,fF,fG,fH,fI){return new X({name:fB,simulator:fC,plots:fD,settings:fE,stoich:fF,powers:fG,rateDs:fH,concs:fI});};Y=d.Ssa=fu.Class({simulate_callback:function(fB,fC,fD,fE){var fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO,fP,fQ;function fR(fT,fU){function fV(fW){return fW.$==0?fU.get_population(fW.$0):fT;}return U.map(function(fW){return R["eval"](fV,fW);},fF.plots);}function fS(fT,fU){var fV;fV=fT/fU.total_propensity;return function(fW){var fX,fY,fZ,f0,f1,f2;return fW.$==1?(fX=fW.$0,(fY=fW.$1,fX.time<fU.simulator.currenttime+fV?(fZ=fR(fU.simulator.currenttime,fU.simulator.populations),(f0=0.99999999,(fC(cv.New(fU.simulator.currenttime,fZ)),fC(cv.New(f0*fX.time+(1-f0)*fU.simulator.currenttime,fZ)),f1=fX.target,f1=="OutputPoint"?void 0:A.iter(function(f3){Y.incPop(fU.simulator.populations,ca.New(fU.simulator.populations.find_index(f3.species),F.toInt(f3.value*fU.settings.scale)));},f1.$0.get_get_pop_info_list()),U.iteri(function(f3,f4){return U.set(fM,f3,cU.New(f4.reaction,Y.calculate_reaction_prop(fN,fU.simulator.populations,f4.reaction),f4.dependencies));},fM),(fS(fT-(fX.time-fU.simulator.currenttime)*fU.total_propensity,Y.New((f2=fU.simulator,bf.New(f2.settings,f2.populations,f2.events,fX.time,f2.nextprinttime,f2.stepsdone)),fU.plots,fU.settings,fU.reactions,U.fold(function(f3,f4){return f3+f4.propensity;},0,fM))))(fY)))):[fV,new B({$:1,$0:fX,$1:fY}),fU])):[fV,B.Empty,fU];};}fF=this;fG=this.settings;fH=(fI=this.simulator.settings.seed,fI!=null&&fI.$==1?new cR.New$1(fI.$0):new cR.New());bk.Equals(T.test_integer_or_constant(this.simulator.populations),false)?F.FailWith("Can\'t use non-integer initial conditions without specifying the species as constant"):void 0;fJ=(fK=fG.steps,fK!=null&&fK.$==1?{$:1,$0:this.simulator.stepsdone+fK.$0}:null);fL=this.reactions;fM=U.create(cS.count(fL),null);cS.iter(function(fT,fU){return U.set(fM,fT,fU);},fL);fN=fG.scale;fO=this.simulator.settings["final"];fP=this.simulator.settings.get_print_interval();fQ=function(fT,fU,fV,fW){var fX,fY,fZ,f0,f1,f2,f3,f4,f5,f6,f7,f8,f9,f_;while(true){f0=fH.NextDouble();f1=f0>0?fv.log(1/f0):0;f2=(fS(f1,fU))(fV);f3=f2[2];f4=f2[1];f5=f2[0];f6=f3.simulator.currenttime+f5;if(f4.$==0)return f3;else{if(fE!=null)((fE.$0(f3.simulator.currenttime))(f5))(f3.simulator.populations);f7=_1.shouldPrint(fO,f6,f3.simulator.nextprinttime,fJ,fT,f3.simulator.currenttime)?(fW(cv.New(f3.simulator.currenttime,fR(f3.simulator.currenttime,f3.simulator.populations))),Y.New((fX=f3.simulator,bf.New(fX.settings,fX.populations,fX.events,fX.currenttime,f6+fP,fX.stepsdone)),f3.plots,f3.settings,f3.reactions,f3.total_propensity)):f3;if(_1.shouldStop(fO,f7.simulator.currenttime,f7.simulator.stepsdone,fB,fJ))return f7;else{f8=Y.New((fY=f7.simulator,bf.New(fY.settings,fY.populations,fY.events,f6,fY.nextprinttime,fY.stepsdone)),f7.plots,f7.settings,f7.reactions,f7.total_propensity);f9=Y.pickReactionRandom(f8.total_propensity,fM,fH);Y.executeReaction(f8.simulator.populations,f9[0]);f_=Y.update_props_direct(fN,f8.total_propensity,fM,f9[1],f8.simulator.populations);fT=false;fU=Y.New((fZ=f8.simulator,bf.New(fZ.settings,fZ.populations,fZ.events,fZ.currenttime,fZ.nextprinttime,f8.simulator.stepsdone+1)),f8.plots,f8.settings,f8.reactions,f_);fV=f4;}}}}(true,this,this.simulator.events,fC);fD(fQ.simulator.populations);return fQ;},simulate_trajectories_callback:function(fB,fC){var fD,fE,fF,fG,fH,fI,fJ;fD=this;fE=(fF=this.simulator.settings.seed,fF!=null&&fF.$==1?new cR.New$1(fF.$0):new cR.New());fG=(this.simulator.settings["final"]-this.simulator.settings.initial)/this.simulator.settings.points;fH=A.init(this.simulator.settings.points,function(fK){return fD.simulator.settings.initial+fG*fK;});fI=this.simulator.populations;fJ=A.map(Q.to_string_plot,this.simulator.settings.plots);(function(fK,fL){var fM,fN,fO,fP,fQ,fR,fS,fT,fU,fV,fW,fX,fY;while(true){if(fK>=fD.settings.trajectories||fB[0])return null;else{fQ=(fM=fD.simulator.settings.seed,fM!=null&&fM.$==1?fM.$0+fK:fE.Next$1());fR=[B.Empty];fS=function(fZ){return function(f0){fZ[0]=new B({$:1,$0:f0,$1:fZ[0]});};}(fR);fT=Y.New((fN=fD.simulator,bf.New((fO=fD.simulator.settings,P.New(fO.name,fO.initial,fO["final"],fO.points,fO.plots,fO.plotcolours,{$:1,$0:fQ},fO.kinetics,fO.times,fO.prune,fO.multicore,fO.data,fO.sweeps)),fI.get_clone(),fN.events,fN.currenttime,fN.nextprinttime,fN.stepsdone)),fD.plots,fD.settings,fD.reactions,fD.total_propensity);fT.simulate_callback([false],fS,a.ignore,null);fU=cv.interpolate_reverse(function(fZ,f0,f1){return fu.Curried(cv.zero_order_hold,2,[fZ,f0,f1]);},A.rev(fR[0]),fH);fV=A.map(Q.to_string_plot,fD.simulator.settings.plots);fW=Z.from_rows_reverse(fV,fU);fX=(fP=fL.columns,(((fu.Curried3(function(fZ,f0,f1){return A.map2(function(f2,f3){return(fZ(f2))(f3);},f0,f1);}))((fu.Curried3(function(fZ,f0,f1){function f2(f3,f4){var f5;f5=c_.online_meanvar(f3.mean,f3.stdev*f3.stdev,f4,fZ+1);return cw.New(f5[0],fv.sqrt(f5[1]));}return bE.New(f1.name,(((fu.Curried3(A.map2))(f2))(f0.values))(f1.values));}))(fK)))(fP))(fW.columns));fY=Z.New(fL.times,fX);fC(fY);fK=fK+1;fL=fY;}}}(0,Z.from_array_columns(fH,U.create(fJ.get_Length(),U.create(this.simulator.settings.points,cw.New(0,0))),fJ)));}},null,Y);Y.incPop=function(fB,fC){if(!fB.is_constant(fC.element))fB.set_population(fC.element,fB.get_population(fC.element)+fC.multiplicity);};Y.calculate_reaction_prop=function(fB,fC,fD){var fE,fG,fH,fI,fJ,fK;function fF(fL){return fC.get_population(fL);}fG=fD.rate;if(fG.$==1)return(fG.$0.get_key())(function(fL){return fL.$==1?F.FailWith("Time dependent rates not supported in SSA."):fF(fL.$0)/fB;})*fB;else{fH=fG.$0;fI=b$.to_mlist(fD.reactants);switch(fI.$==1?fI.$0.multiplicity===1?fI.$1.$==1?fI.$1.$0.multiplicity===1?fI.$1.$1.$==0?(fE=[fI.$0.element,fI.$1.$0.element],4):(fE=fI,5):(fE=fI,5):(fE=fI.$0.element,1):fI.$0.multiplicity===2?fI.$1.$==0?(fE=fI.$0.element,2):(fE=fI,5):fI.$0.multiplicity===3?fI.$1.$==0?(fE=fI.$0.element,3):(fE=fI,5):(fE=fI,5):0){case 0:return fH;case 1:return fH*fF(fE);case 2:fJ=fF(fE);return fH*fJ*(fJ-1)*0.5;case 3:fK=fF(fE);return fH*fK*(fK-1)*(fK-2)/6;case 4:return fH*fF(fE[0])*fF(fE[1]);case 5:return db.fold_left(function(fL,fM){return fL*db.binom(F.toInt(fF(fM.element)),fM.multiplicity);},fH,fE);}}};Y.pickReactionRandom=function(fB,fC,fD){var fE,fF;fE=fD.NextDouble()*fB;fF=U.length(fC);return function(fG,fH){var fI,fJ;while(true){fI=U.get(fC,fH);fJ=fG+fI.propensity;if(fJ>fE)return[fI.reaction,fI.dependencies];else if(fH+1>=fF)return fJ!==fB?F.FailWith("Incorrect total propensity used!"):F.FailWith("Index outside range");else{fG=fJ;fH=fH+1;}}}(0,0);};Y.executeReaction=function(fB,fC){function fD(fE,fF){return!fE.is_constant(fF.element)?fE.set_population(fF.element,fE.get_population(fF.element)-fF.multiplicity):null;}b$.iterm(function(fE){return fD(fB,fE);},fC.reactants);b$.iterm(function(fE){Y.incPop(fB,fE);},fC.products);};Y.update_props_direct=function(fB,fC,fD,fE,fF){var fG;fG=fC+db.fold_left(function(fH,fI){var fJ,fK;fJ=U.get(fD,fI);fK=Y.calculate_reaction_prop(fB,fF,fJ.reaction);U.set(fD,fI,cU.New(fJ.reaction,fK,fJ.dependencies));return fH+(fK-fJ.propensity);},0,fE);return fG<0?0:fG;};Y.make_sim_reactions_pops=function(fB,fC,fD,fE,fF){var fG,fH,fI,fJ,fK;function fL(fO,fP,fQ){return[fO,Y.calculate_reaction_prop(fD,fF,fO),fQ];}function fM(fO,fP,fQ){return[fO,fQ];}function fN(fO,fP,fQ){return[fO,fP,Y.calculate_reaction_deps(fO,fI)];}fG=A.map(function(fO){return fL(fO[0],fO[1],fO[2]);},cc.get_sim_reactions_products(fD,fF,fB,fC,fE));fH=(fI=A.map(function(fO){return fM(fO[0],fO[1],fO[2]);},fG),A.map(function(fO){return fN(fO[0],fO[1],fO[2]);},fG));fJ=cS.empty();fK=db.fold_left(function(fO,fP){return(function(fQ){var fR,fS;fR=fQ[0];fS=fQ[1];return function(fT){var fU;fU=fT[1];cS.add(fJ,fR,cU.New(fT[0],fU,fT[2]));return[fR+1,fS+fU];};}(fO))(fP);},[0,0],fH);return[fJ,fK[0],fK[1]];};Y.create=function(fB,fC,fD,fE,fF,fG){var fH,fI,fJ,fK,fL,fM,fN,fO;fH=K.Map(function(fP,fQ){return(function(){var fR,fS,fT;fR=(fS=(fT=fB.populations,function(fU){return fT.find_index(fU);}),function(fU){return cY.map(fS,fU);});return function(fU){return R.map(fR,fU);};}(fP))(fQ);},fG);Y.empty();return Y.New(fB,U.ofList(A.map((fI=(fJ=(fK=(fL=(fM=fB.populations,function(fP){return fM.find_index(fP);}),function(fP){return co.map(fL,fP);}),(fN=(fO=bF.to_env(fF),function(fP){return co.inline_keys(fO,fH,fP);}),function(fP){return fN(fK(fP));})),function(fP){return R.expand(fJ,fP);}),function(fP){return R.simplify(fI(fP));}),fB.settings.plots)),fC,fD,fE);};Y.calculate_reaction_deps=function(fB,fC){var fD;function fE(fG,fH){function fI(fJ){return fJ.$==1?B.Empty:A.ofArray([fJ.$0]);}return db.disjoint(function(fJ,fK){return fJ===fK;},db.union(function(fJ,fK){return fJ===fK;},b$.nonzero_elements(fG.reactants),fH.$==0?B.Empty:A.collect(fI,R.mentions(fH.$0))),fD);}function fF(fG,fH){return function(fI){return fE(fI[0],fI[1])?[fG,fH+1]:[new B({$:1,$0:fH,$1:fG}),fH+1];};}fD=b$.nonzero_elements(b$.difference(function(fG,fH){return fG===fH;},fB.products,fB.reactants));return A.rev((db.fold_left(function(fG,fH){return(function(fI){return fF(fI[0],fI[1]);}(fG))(fH);},[B.Empty,0],fC))[0]);};Y.empty=function(){return Y.New(bf.empty(),[],_7.get_defaults(),cS.empty(),0);};Y.New=function(fB,fC,fD,fE,fF){return new Y({simulator:fB,plots:fC,settings:fD,reactions:fE,total_propensity:fF});};Z.to_rows=function(fB){return A.rev(Z.to_rows_reverse(fB));};Z.to_rows_reverse=function(fB){function fC(fD,fE){return function(fF){return[new B({$:1,$0:cv.create(fF,A.map(A.head,fE)),$1:fD}),A.map(A.tail,fE)];};}return(bc.fold(function(fD,fE){return(function(fF){return fC(fF[0],fF[1]);}(fD))(fE);},[B.Empty,Z.get_column_values(fB)],fB.times))[0];};Z.from_array_columns=function(fB,fC,fD){return Z.New(fB,A.ofSeq(bc.map2(function(fE,fF){return bE.create(A.ofArray(fF),fE);},fD,fC)));};Z.from_rows_reverse=function(fB,fC){var fD;function fE(fF,fG){return bE.New(fG.name,new B({$:1,$0:fF,$1:fG.values}));}return bc.fold(function(fF,fG){return Z.New(new B({$:1,$0:fG.time,$1:fF.times}),A.map2(fE,A.ofArray(fG.values),fF.columns));},Z.New(B.Empty,A.map((fD=B.Empty,function(fF){return bE.create(fD,fF);}),fB)),fC);};Z.get_column_values=function(fB){return A.map(function(fC){return fC.values;},fB.columns);};Z.from_rows=function(fB,fC){return Z.reverse(Z.from_rows_reverse(fB,fC));};Z.qsummary=function(fB){var fC;fC=A.head(fB).times;return Z.New(fC,A.concat(A.init(A.head(fB).columns.get_Length(),function(fD){var fE,fF,fG,fH,fI;fE=A.map(function(fJ){return fJ.columns.get_Item(fD).values;},fB);fF=A.head(fB).columns.get_Item(fD).name;fG=A.unzip(A.init(fC.get_Length(),function(fJ){var fK;fK=A.map(function(fL){return bc.nth(fJ,fL);},fE);return[d3.summary(fK),d3.qsummary(fK)];}));fH=fG[0];fI=fG[1];return A.ofArray([bE.create(A.map(function(fJ){return fJ.mean;},fH),fF+" Mean"),bE.create(A.map(function(fJ){return fv.sqrt(fJ.variance);},fH),fF+" Std"),bE.create(A.map(function(fJ){return fJ.lb95;},fI),fF+" L95"),bE.create(A.map(function(fJ){return fJ.ub95;},fI),fF+" U95")]);})));};Z.reverse=function(fB){return Z.New(A.rev(fB.times),A.map(bE.reverse,fB.columns));};Z.filter_by_tmax=function(fB,fC){var fD,fE;fD=bc.tryFindIndex(function(fF){return fF>fB;},fC.times);return fD==null?fC:(fE=fD.$0,Z.New(fC.times.GetSlice({$:1,$0:0},{$:1,$0:fE-1}),A.map(function(fF){return bE.New(fF.name,fF.values.GetSlice({$:1,$0:0},{$:1,$0:fE-1}));},fC.columns)));};Z.likelihood=function(fB,fC,fD){return bc.sum(A.map3(function(fE,fF,fG){return bc.sum(A.map2(function(fH,fI){return(fE(fH))(fI);},fF.values,fG.values));},fB,fC.columns,fD.columns));};Z.New=function(fB,fC){return{times:fB,columns:fC};};_0=d.OdeSundials=fu.Class({simulate:function(){var fB,fC,fD,fE,fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO,fP,fQ,fR,fS,fT,fU,fV,fW,fX,fY,fZ,f0,f1;function f2(f6){var f7;return f6.time>=fC.currenttime&&(f7=f6.target,f7.$==0?U.exists(function(f8){return f8!==0;},f7.$0.get_get_pop_array()):true);}function f3(f6,f7){return F.toInt(f7.getStoich(fF.is_constant(f6),f6));}function f4(f6,f7){var f8,f9,f_;f8=U.create(fX,1);for(f9=0,f_=fX-1;f9<=f_;f9++)U.set(f8,f9,(U.get(fZ,f9).get_key())(function(f$){return f$.$==1?f6:U.get(f7,f$.$0);}));return f8;}function f5(f6,f7,f8){return function(f9){var f_,f$,ga,gb,gc,gd,ge,gf,gg,gh,gi,gj,gk,gl,gm,gn,go,gp,gq;gc=f9.time;gd=U.tryFindIndex(function(gr){return gr>=f6;},fN);if(gd!=null&&gd.$==1){ge=gd.$0;gf=(f_=U.tryFindIndex(function(gr){return gr>gc;},fN),f_!=null&&f_.$==1?f_.$0:fN.length)-ge;gg=U.sub(fN,ge,gf);gh=gf===0?[[f6],1,true]:U.get(gg,0)>f6?[[f6].concat(gg),gf+1,true]:[gg,gf,false];gi=gh[0];gj=gh[1];gk=gh[2];gl=U.get(gi,gj-1)<gc?[gi.concat([gc]),gj+1,true]:[gi,gj,false];gm=gl[1];gn=gl[2];go={sN:fO,rNM:fS,stoichM:fU,powersM:fV,ratesM:fR,rNF:fX,stoichF:fY,functionalRates:f4,concs:f7,t:gl[0],tN:gm,sundialsOutput:function(gr,gs){function gt(gu){return gu.$==1?gr:U.get(gs,gu.$0);}(!gk||gr!==f6)&&(gr===fG&&!gn||gr!==gc)?U.iteri(function(gu,gv){U.get(f0,gu).push((gv.get_key())(gt));},f1):void 0;return null;},stiff:fB.settings.stiff,abstol:fB.settings.abstolerance,reltol:fB.settings.reltolerance};f$=[fw.fnSundialsSolver(go),go.conc];gp=f$[0];gq=f$[1];if(gp!==0)throw new cX.New((function(gr){return function(gs){return gr("Sundials solver failed with code: "+a.String(gs));};}(a.id))(gp));return[gc,(ga=f9.target,ga.$==0?(gb=K.OfArray(U.ofSeq(A.map(function(gr){var gs;return[(gs=fF.tryFind_index(gr.species),gs==null?F.FailWith("Unknown species in event"):gs.$0),gr.value];},ga.$0.get_get_pop_info_list()))),U.mapi(function(gr,gs){var gt;gt=K.TryFind(gr,gb);return gt==null?gs:gs+gt.$0;},gq)):gq),f8+gm];}else return[f6,f7,f8];};}fB=this;fC=this.simulator;fD=this.reactions;fE=fC.settings;fF=fC.populations;fG=fE["final"];fH=fE.times.$!==0?[fE.times,A.map(function(f6){return f6.target=="OutputPoint"?cT.New(A.max(fE.times)+1,f6.target):f6;},A.filter(f2,fC.events))]:(fI=fE.initial,(fJ=fE.get_print_interval(),(fK=A.init(fE.points+1,function(f6){return fI+f6*fJ;}),(fL=A.filter(f2,fC.events),[A.sort(A.append(fK,A.collect(function(f6){return f6.target=="OutputPoint"?B.Empty:A.ofArray([f6.time-1E-08,f6.time]);},fL))),fL]))));fM=fH[0];fN=U.ofList(fM);fO=fF.get_get_count();fP=U.length(this.plots);fQ=A.filter(function(f6){return f6.rate.$==0;},fD);fR=U.ofList(A.map(function(f6){var f7;f7=f6.rate;return f7.$==0?f7.$0:F.FailWith("Unexpected reaction type");},fQ));fS=A.length(fQ);fT=F.range(0,fO-1);fU=U.ofSeq(bc.collect(function(f6){return bc.map(function(f7){return f3(f7,f6);},fT);},fQ));fV=U.create(fO*fS,0);A.iteri(function(f6,f7){return b$.iterm(function(f8){U.set(fV,fO*f6+f8.element,f8.multiplicity);},f7.reactants);},fQ);fW=A.filter(function(f6){return f6.rate.$==1;},fD);fX=A.length(fW);fY=U.ofSeq(bc.collect(function(f6){return bc.map(function(f7){return f3(f7,f6);},fT);},fW));fZ=U.create(fX,null);A.iteri(function(f6,f7){var f8;f8=f7.rate;return f8.$==1?U.set(fZ,f6,f8.$0):F.FailWith("Unexpected reaction type");},fW);f0=U.init(fP,function(){return[];});f1=U.map(R.to_lambda,this.plots);bc.fold(function(f6,f7){return(function(f8){return f5(f8[0],f8[1],f8[2]);}(f6))(f7);},[fE.initial,this.concs,0],fH[1]);return Z.from_array_columns(fM,U.ofSeq(bc.map(U.ofSeq,f0)),A.map(Q.to_string_plot,fE.plots));}},null,_0);_0.New=function(fB,fC,fD,fE,fF){return new _0({simulator:fB,plots:fC,reactions:fD,settings:fE,concs:fF});};_1.get_to_string=function(fB){return fB=="Sundials"?"sundials":fB=="SSA"?"stochastic":fB=="CME"?"cme":fB=="CMESundials"?"cmesundials":fB=="LNA"?"lna":fB=="PDE"?"pde":fB=="MC"?"mc":"deterministic";};_1.shouldPrint=function(fB,fC,fD,fE,fF,fG){return fF||(fC>=fD||fC>=fB||fE!=null);};_1.shouldStop=function(fB,fC,fD,fE,fF){return fC>=fB||fE[0]||fF!=null&&fF.$==1&&fD>=fF.$0;};_1.plot_label=function(fB,fC,fD){var fE,fF,fG,fH,fI;fF="Concentration ("+fD.concentration.get_to_string()+")";fG="Individuals";fH="Distance ("+fD.space.get_to_string()+")";fI="Time ("+fD.time.get_to_string()+")";switch(fB=="Sundials"?1:fB=="SSA"?2:fB=="CME"?3:fB=="CMESundials"?3:fB=="LNA"?4:fB=="PDE"?5:fB=="MC"?6:0){case 0:return[fI,fF];case 1:return[fI,fF];case 2:return[fI,fG];case 3:return[fI,fG];case 4:return[fI,fG];case 5:return fC===1?[fH,fI]:[fH,fH];case 6:return[fI,fG];}};_1.get_defaults=function(){return"SSA";};_1.get_parse=function(){var fB,fC,fD,fE,fF,fG,fH,fI,fJ;fB=D.choice([(fC=D.kw("deterministic"),function(fK){return dz.op_GreaterGreaterPercent(fC,"Oslo",fK[0],fK[1]);}),(fD=D.kw("stochastic"),function(fK){return dz.op_GreaterGreaterPercent(fD,"SSA",fK[0],fK[1]);}),(fE=D.kw("lna"),function(fK){return dz.op_GreaterGreaterPercent(fE,"LNA",fK[0],fK[1]);}),(fF=D.kw("cme"),function(fK){return dz.op_GreaterGreaterPercent(fF,"CME",fK[0],fK[1]);}),(fG=D.kw("cmesundials"),function(fK){return dz.op_GreaterGreaterPercent(fG,"CMESundials",fK[0],fK[1]);}),(fH=D.kw("sundials"),function(fK){return dz.op_GreaterGreaterPercent(fH,"Sundials",fK[0],fK[1]);}),(fI=D.kw("pde"),function(fK){return dz.op_GreaterGreaterPercent(fI,"PDE",fK[0],fK[1]);}),(fJ=D.kw("mc"),function(fK){return dz.op_GreaterGreaterPercent(fJ,"MC",fK[0],fK[1]);})]);return function(fK){return fB([fK[0],fK[1]]);};};_2.toSafe=function(fB){return fB==null?"":fB;};_2.prettyPrint=function(fB){var fC,fD;function fE(fF,fG){return fF+" = "+_2.prettyPrint(fG);}return fB===null?"null":(fC=typeof fB,fC=="string"?"\\""+fB+"\\"":fC=="object"?fB instanceof a.Array?"[|"+dk.concat("; ",U.map(_2.prettyPrint,fB))+"|]":(fD=a.String(fB),fD==="[object Object]"?"{"+dk.concat("; ",U.map(function(fF){return fE(fF[0],fF[1]);},dj.GetFields(fB)))+"}":fD):a.String(fB));};_2.printArray=function(fB,fC){return fC===null?"null":"[|"+dk.concat("; ",U.map(fB,fC))+"|]";};_3=d.Calculus=fu.Class({to_ctmc:function(fB,fC,fD,fE,fF){var fG,fH,fI,fJ;function fK(fP){return fF.index.from_species.get_Item(fP);}function fL(fP,fQ){return[fD,[fP,fQ],fE];}function fM(fP,fQ){var fR,fS;fR=b$.to_map(fP.reactants);fS=b$.to_map(fP.products);return K.Fold(function(fT,fU,fV){var fW;fW=K.TryFind(fU,fT);return fW==null?fT.Add(fU,fV):fT.Add(fU,fW.$0+fV);},K.Fold(function(fT,fU,fV){var fW;fW=fT.get_Item(fU)-fV;return fW===0?fT.Remove(fU):fT.Add(fU,fW);},fQ,fR),fS);}function fN(fP,fQ){var fR;fR=K.TryFind(fQ,fP);return fR!=null&&fR.$==1?fR.$0>0:true;}function fO(fP,fQ,fR){var fS;fS=_9.containsKey(fH,fQ);_9.add(fG,fP,new B({$:1,$0:ba.New(fS?_9.find(fH,fQ):(_9.add(fG,fQ,B.Empty),_9.add(fH,fQ,fQ),fQ),fR),$1:_9.find(fG,fP)}));return fS;}fG=_9.empty();fH=_9.empty();_9.add(fG,fD,B.Empty);_9.add(fH,fD,fD);fI=cS.map((fJ=function(fP){return co.map(fK,fP);},function(fP){return R.map(fJ,fP);}),fB);(function(fP){var fQ,fR,fS,fU,fV,fW,fX,fY,fZ,f0,f1,f2,f3,f4,f5,f6;function fT(f7,f8){return function(f9){var f_;f_=(fF.react_st(f8))(f9);return[A.append(f7,f_),A.ofSeq(bc.distinct(A.append(new B({$:1,$0:f9,$1:f8}),_.get_all_product_species(f_))))];};}while(true){if(fP.$==1){fU=fP.$1;fV=fP.$0[0];fW=fP.$0[1][0];fX=fP.$0[1][1];fY=fP.$0[2];fZ=fM(fW,fV);f0=fO(fV,fZ,fX);if(f0)fP=fU;else{f1=A.ofSeq(bc.distinct((fQ=_.get_product_species(fW),(function(f7){return function(f8){return A.filter(f7,f8);};}(function(f7){return fN(fV,f7);}))(fQ))));f2=A.ofSeq((fR=K.ToSeq(fV),(function(f7){return function(f8){return bc.map(f7,f8);};}(function(f7){return f7[0];}))(fR)));f3=(function(f7,f8){return function(f9){return bc.fold(function(f_,f$){return(f7(f_))(f$);},f8,f9);};}(function(f7){return fT(f7[0],f7[1]);},[B.Empty,f2]))(f1);f4=A.ofSeq(bc.distinct(A.append(f3[0],fY)));f5=(fS=(function(f7){return function(f8){return A.map(f7,f8);};}(function(f7){return function(f8){return[f8,_.calculate_reaction_prop(fC,f7,f8,fI)];};}(fZ)))(f4),(function(f7){return function(f8){return A.filter(f7,f8);};}(function(f7){return _.nonzero_prop(f7[0],f7[1]);}))(fS));f6=(function(f7){return function(f8){return A.map(f7,f8);};}(function(f7,f8){return function(f9){return[f7,[f9[0],f9[1]],f8];};}(fZ,f4)))(f5);fP=A.append(fU,f6);}}else return null;}}(A.map(function(fP){return fL(fP[0],fP[1]);},A.filter(function(fP){return _.nonzero_prop(fP[0],fP[1]);},A.map(function(fP){return[fP,_.calculate_reaction_prop(fC,fD,fP,fI)];},fE)))));return{ctmc:_.New(fG,fD),to_species:fF.index.to_species};},initialise_ctmc:function(fB){var fC,fD,fE;function fF(fI){return fI[1];}function fG(fI){return 0<fI;}function fH(fI,fJ){return function(fK){var fL;fL=(fD.react_st(fJ))(fK);return[A.distinct(A.append(fI,fL)),A.distinct(A.append(new B({$:1,$0:fK,$1:fJ}),_.get_all_product_species(fL)))];};}fC=A.map(function(fI){return fI[1];},fB);fD=this.get_adapt();fE=fD.init(A.map(function(fI){return fI[0];},fB));return[K.OfArray(U.ofSeq(A.filter(function(fI){return fG(fF(fI));},A.zip(fE,fC)))),(bc.fold(function(fI,fJ){return(function(fK){return fH(fK[0],fK[1]);}(fI))(fJ);},[B.Empty,B.Empty],fE))[0],fD];},get_adapt:function(){var fB,fC;function fD(fF,fG){var fH,fI,fJ,fK;function fL(fN){return eh.index(fC,fN);}function fM(fN){return co.map(fL,fN);}fH=A.map(function(fN){return U.get(fC.to_species,fN);},fF);fI=U.get(fC.to_species,fG);fJ=(fB.react(fH))(fI);A.map(function(fN){return eh.index(fC,fN);},_.get_all_product_species(fJ));return A.map((fK=function(fN){return R.map(fM,fN);},function(fN){return cc.map(fL,a.id,fK,fN);}),fJ);}function fE(fF){return eh.add(fC,fF);}fB=this;fC=eh.empty();return ei.New(function(fF){return A.map(fE,fF);},function(fF){return function(fG){return fD(fF,fG);};},fC);}},null,_3);_3.New=function(fB){return new _3({react:fB});};_4=d.Lna=fu.Class({simulate_callback:function(fB,fC){var fD,fE,fF,fG,fH,fI;function fJ(fM){return[c2.array(fM,{$:1,$0:0},{$:1,$0:fG-1}),c2.array(fM,{$:1,$0:fG},{$:1,$0:2*fG-1}),U.init(fG,function(fN){return c2.array(fM,{$:1,$0:(2+fN)*fG},{$:1,$0:(3+fN)*fG-1});})];}function fK(fM,fN){var fO,fP,fQ,fR,fS,fT,fU,fV;fO=fJ(cL.toArray(fN));fP=cL.ofArray(fO[0]);fQ=cL.ofArray(fO[1]);fR=cO.ofArray(fO[2]);fS=(fD.props(fM))(fP);fT=fD.drift(fS);fU=fD.jacobian(fP);fV=cO.add(cO.add(cO.matrMultMatr(fU,fR),cO.matrMultMatr(fR,_4.OsloTranspose(fU))),fT);return cL.ofArray(U.concat(A.ofArray([cL.toArray(cO.matrMultVec(cO.ofArray(fD.stoich),fS)),cL.toArray(cO.matrMultVec(fU,fQ)),U.collect(function(fW){return cL.toArray(fV.get_Item(fW));},U.ofSeq(F.range(0,fG-1)))])));}function fL(fM,fN){function fO(fQ){return fN[fQ];}function fP(fQ){var fR;fR=fN[2*fG+fQ*(fG+1)];return fR<0?0:fv.sqrt(fR);}return U.map(function(fQ){function fR(fS,fT){return fT.$==0?fS(fT.$0):fM;}return fD.outputconcentrations?cw.create(R["eval"](function(fS){return fR(fO,fS);},fQ),R["eval"](function(fS){return fR(fP,fS);},fQ)/fF):cw.create(fE*R["eval"](function(fS){return fR(fO,fS);},fQ),R["eval"](function(fS){return fR(fP,fS);},fQ)*fF);},fD.ode.plots);}fD=this;fE=this.scale;fF=fv.sqrt(fE);A.exists(function(fM){return fM.target!="OutputPoint";},this.ode.simulator.events)?F.FailWith("Events not supported for LNA integration"):void 0;fG=U.length(this.initials);fH=cL.ofArray(this.initials.concat(U.create(fG+fG*fG,0)));return _4.New((fI=this.ode,X.New(fI.name,cI.simulate_callback(fB,fC,cI.create(this.ode.name,this.ode.simulator,function(fM){return function(fN){return fL(fM,fN);};},fu.Curried(cw.interpolate,5),this.ode.settings,fH,function(fM){return function(fN){return fK(fM,fN);};})).simulator,fI.plots,fI.settings,fI.stoich,fI.powers,fI.rateDs,fI.concs)),this.outputconcentrations,this.initials,this.stoich,this.covariance,this.times,this.nextprinttime,this.jacobian,this.drift,this.props,this.stepsdone,this.scale);}},null,_4);_4.OsloTranspose=function(fB){var fC,fD,fE,fF,fG,fH,fI;fC=cO.numCols(fB);fD=cO.numRows(fB);fE=cO.zeros(fC,fD);for(fF=0,fG=fD-1;fF<=fG;fF++){for(fH=0,fI=fC-1;fH<=fI;fH++)(fE.get_Item(fH))[fF]=(fB.get_Item(fF))[fH];}return fE;};_4.initialise=function(fB,fC,fD,fE){var fF,fG;function fH(fK){return fK.$==1?F.FailWith("Functional rates not yet implemented"):fK.$0;}function fI(fK){return U.mapi(function(fL,fM){return U.map(function(fN){var fO;function fP(fQ,fR){return fQ===fN;}return A.exists(function(fQ){return fP(fQ[0],fQ[1]);},U.get(fB.powers,fL))?(fO=U.get(fB.powers,fL),bc.fold(function(fQ,fR){var fS,fT;fS=fR[0];fT=fR[1];return fS===fN?fQ*fT*fv.pow(fK[fS],fT-1):fQ*fv.pow(fK[fS],fT);},fH(fM),fO)):0;},U.ofSeq(F.range(0,fF-1)));},fB.rateDs);}function fJ(fK,fL){var fM,fN,fO,fP;fM=new a.Float64Array(fG);for(fN=0,fO=fG-1;fN<=fO;fN++){fM[fN]=(fP=U.get(fB.rateDs,fN),fP.$==1?fP.$0.$0(function(fQ){return fQ.$==1?fK:fL[fQ.$0];}):bc.fold(function(fQ,fR){return fQ*fv.pow(fL[fR[0]],fR[1]);},fP.$0,U.get(fB.powers,fN)));}return fM;}fF=fC.length;fG=U.get(fC,0).length;return _4.New(fB,true,fD,fC,cO.zeros(0,0),B.Empty,0,function(fK){var fL;fL=fI(fK);return cO.matrMultMatr(cO.ofArray(fC),cO.ofArray(fL));},function(fK){return U.reduce(cO.add,U.mapi(function(fL){var fM;fM=cO.copyCol(fB.stoich,fL);return cO.matrMultScal(_4.CrossProduct(fM,fM),fK[fL]);},U.ofSeq(F.range(0,fG-1))));},function(fK){return function(fL){return fJ(fK,fL);};},0,fE);};_4.CrossProduct=function(fB,fC){var fD,fE,fF,fG,fH,fI,fJ,fK;fD=fB.length;fE=fC.length;fF=cO.zeros(fD,fE);for(fG=0,fH=fD-1;fG<=fH;fG++){for(fI=0,fJ=fE-1;fI<=fJ;fI++){fK=fB[fG]*fC[fI];(U.get(fF.MatrixData,fG))[fI]=fK;}}return fF;};_4.New=function(fB,fC,fD,fE,fF,fG,fH,fI,fJ,fK,fL,fM){return new _4({ode:fB,outputconcentrations:fC,initials:fD,stoich:fE,covariance:fF,times:fG,nextprinttime:fH,jacobian:fI,drift:fJ,props:fK,stepsdone:fL,scale:fM});};_5.simulate_1d_callback=function(fB,fC,fD){var fE,fF,fG,fH;function fI(fK,fL){function fM(fN,fO){return fO.$==1?fK:U.get(U.get(fL,fN),fO.$0);}return U.map(function(fN){return U.init(fF.nx,function(fO){return R["eval"](function(fP){return fM(fO,fP);},fN);});},fG);}function fJ(fK){return cv.New(fK.t,fI(fK.t,fK.u));}fE=_5.inline_parameters(fD);fF=fE[1];fG=fE[2];fH=fE[0];bc.iter(function(fK){return fC(fJ(fK));},fD.settings.boundary=="ZeroFlux"?c4.neumann_solve(fD.sim_settings.initial,_5.generate_initialconditions1d(fD.rng,fD.settings,fD.populations.index_to_species),function(fK,fL){return(fH(fK))(fL);},fF,1):c4.periodic_solve(fD.sim_settings.initial,_5.generate_initialconditions1d(fD.rng,fD.settings,fD.populations.index_to_species),function(fK,fL){return(fH(fK))(fL);},fF));};_5.simulate_2d_callback=function(fB,fC,fD){var fE,fF,fG,fH;function fI(fJ,fK){return U.map(function(fL){return U.init(fF.nx,function(fM){return U.init(fF.nx,function(fN){var fO;function fP(fQ){return fQ.$==1?fJ:U.get(fO,fQ.$0);}fO=U.get(U.get(fK,fM),fN);return R["eval"](fP,fL);});});},fG);}fE=_5.inline_parameters(fD);fF=fE[1];fG=fE[2];fH=fE[0];bc.iter(fC,bc.map(function(fJ){return cv.New(fJ.t,fI(fJ.t,fJ.u));},fD.settings.boundary=="ZeroFlux"?c8.neumann_solve(fD.sim_settings.initial,_5.generate_initialconditions2d(fD.rng,fD.settings,fD.populations.index_to_species),function(fJ,fK){return(fH(fJ))(fK);},fF):c8.periodic_solve(fD.sim_settings.initial,_5.generate_initialconditions2d(fD.rng,fD.settings,fD.populations.index_to_species),function(fJ,fK){return(fH(fJ))(fK);},fF)));};_5.accumulator_1d=function(fB,fC,fD){var fE,fF,fG,fH,fI,fJ,fK;function fL(fM,fN){return(_5.perturb(fB,fI.random))(fN);}fE=A.partition(function(fM){return fM.spatial!=null;},A.ofSeq(fD));fF=fE[0];fG=bc.sumBy(function(fM){return fM.value;},fE[1]);fH=U.init(fC,function(fM){return[fM/(fC-1),fG];});return fF.$==1?fF.$1.$==0?(fI=fF.$0.spatial.$0,U.map(function(fM){return fL(fM[0],fM[1]);},A.foldBack(function(fM,fN){return U.map(function(fO){return fM.apply1d(fO[0],fO[1]);},fN);},fI.rectangles,A.foldBack(function(fM,fN){return U.map(function(fO){return fM.apply1d(fO[0],fO[1]);},fN);},fI.points,(fJ=fI.core,fJ==null?fH:(fK=fJ.$0,U.map(function(fM){return fK.apply1d(fM[0],fM[1]);},fH))))))):F.FailWith("Received more than one spatial initial condition for species _"):U.map(function(fM){return fM[1];},fH);};_5.inline_parameters=function(fB){var fC,fD,fE,fF,fG,fH,fI,fJ,fK,fL;function fM(fT){var fU;function fV(fW){var fX;fX=fB.populations.tryFind_index(fW);return fX==null?(function(fY){return function(fZ){return fY("Could not locate species "+_2.toSafe(fZ));};}(F.FailWith))(fW.name):fX.$0;}fU=function(fW){return cY.map(fV,fW);};return function(fW){return R.map(fU,fW);};}function fN(fT){return co.eval_massaction(fC,fT);}function fO(fT){return co.eval_function(fC,fD,fT);}function fP(fT){return fT.map(a.id,function(fU){return fU.get_key();});}function fQ(fT){return fT.$==2?{$:1,$0:fT.$0}:fT.$==1?F.FailWith("Not implemented yet"):null;}function fR(fT){return bc.findIndex(function(fU){return bk.Equals(fU,fT);},fG);}function fS(fT){return co.inline_keys(fC,fD,fT);}fC=bF.to_env(fB.settings.parameters);fD=K.Map(function(fT,fU){return(fM(fT))(fU);},co.inline_rates_env(fC,fB.rateExpressions));fE=_5.reaction_term(fB.stoich,fB.powers,U.map((fF=function(fT){return cb.map2(fN,fO,fT);},function(fT){return fP(fF(fT));}),fB.rates));fG=A.distinct(A.collect((fH=function(fT){return A.choose(fQ,fT);},function(fT){return fH(R.mentions(fT));}),fB.sim_settings.plots));fI=U.ofList(A.map((fJ=(fK=(fL=function(fT){return co.map(fR,fT);},function(fT){return fS(fL(fT));}),function(fT){return R.expand(fK,fT);}),function(fT){return R.simplify(fJ(fT));}),fB.sim_settings.plots));return[fE,_5.map_settings(fC,A.map(fB.species_index,fG),fB),fI];};_5.generate_initialconditions1d=function(fB,fC,fD){var fE,fF,fG;fE=(fF=fC.random,fF>0?function(fH){return fH*(1+fF*(fB.NextDouble()-0.5));}:a.id);fG=U.map(function(fH){return U.map(fE,fH.value);},fD);return U.init(fC.nx,function(fH){return U.init(U.length(fD),function(fI){return U.get(U.get(fG,fI),fH);});});};_5.accumulator_2d=function(fB,fC,fD){var fE,fF,fG,fH,fI,fJ,fK,fL,fM,fN;function fO(fR,fS){return fL.apply2d(fR,fS);}function fP(fR){return fR[1];}function fQ(fR){return fR[1];}fE=A.partition(function(fR){return fR.spatial!=null;},A.ofSeq(fD));fF=fE[0];fG=bc.sumBy(function(fR){return fR.value;},fE[1]);fH=U.init(fC,function(fR){return U.init(fC,function(fS){return[[fR/(fC-1),fS/(fC-1)],fG];});});return fF.$==1?fF.$1.$==0?(fI=fF.$0.spatial.$0,(fJ=A.foldBack(function(fR,fS){function fT(fU,fV){return fR.apply2d(fU,fV);}return U.map(function(fU){return U.map(function(fV){return fT(fV[0],fV[1]);},fU);},fS);},fI.rectangles,A.foldBack(function(fR,fS){function fT(fU,fV){return fR.apply2d(fU,fV);}return U.map(function(fU){return U.map(function(fV){return fT(fV[0],fV[1]);},fU);},fS);},fI.points,(fK=fI.core,fK==null?fH:(fL=fK.$0,U.map(function(fR){return U.map(function(fS){return fO(fS[0],fS[1]);},fR);},fH))))),U.map((fM=(fN=_5.perturb(fB,fI.random),function(fR){return fN(fP(fR));}),function(fR){return U.map(fM,fR);}),fJ))):F.FailWith("Received more than one spatial initial condition for species _"):U.map(function(fR){return U.map(fQ,fR);},fH);};_5.generate_initialconditions2d=function(fB,fC,fD){var fE,fF,fG;fE=(fF=fC.random,fF>0?function(fH){return fH*(1+fF*(fB.NextDouble()-0.5));}:a.id);fG=U.map(function(fH){return U.map(function(fI){return U.map(fE,fI);},fH.value);},fD);return U.init(fC.nx,function(fH){return U.init(fC.nx,function(fI){return U.init(U.length(fD),function(fJ){return U.get(U.get(U.get(fG,fJ),fH),fI);});});});};_5.perturb=function(fB,fC){return fC>0?function(fD){return fD*(1+fC*(fB.NextDouble()-0.5));}:a.id;};_5.create=function(fB,fC,fD,fE,fF,fG,fH,fI,fJ){return _5.New(fB,function(fK){return fC.find_index(fK);},fC,fD,fE,cO.ofArray(fF),fG,fH,fI,fJ);};_5.map_settings=function(fB,fC,fD){var fE,fF,fG,fH,fI;fE=fD.settings;fF=fD.populations.get_get_count();fG=U.map(function(fJ){var fK;fK=K.TryFind({$:0,$0:{$:2,$0:fJ.species}},K.OfArray(U.ofSeq(fE.diffusibles)));return fK==null?fE.default_diffusion:R["eval"](function(fL){return di.find(fB,fL);},fK.$0);},fD.populations.index_to_species);fH=fE.xmax/(fE.nx-1);fI=fE.dt>0?fE.dt:0.2*fH*fH/U.max(fG);return c7.New(fF,F.toInt(fv.ceil((fD.sim_settings["final"]-fD.sim_settings.initial)/fI/fD.sim_settings.points)),fE.nx,0,fE.xmax,0,fE.xmax,fD.sim_settings["final"],fI,fG,U.ofList(fC));};_5.reaction_term=function(fB,fC,fD){var fE,fF,fG,fH,fI;function fJ(fL,fM){return fM===1?fL:fM===2?fL*fL:fv.pow(fL,fM);}function fK(fL,fM){var fO,fP,fQ;function fN(fR){return fR.$==1?fL:U.get(fM,fR.$0);}for(fO=0,fP=fD.length-1;fO<=fP;fO++){fE[fO]=(fQ=U.get(fD,fO),fQ.$==1?fQ.$0(fN):U.fold2(function(fR,fS,fT){return fR*fJ(U.get(fM,fS),fT);},fQ.$0,U.get(fH,fO),U.get(fI,fO)));}cO.matrMultVecStore(fB,fE,fF);return fF;}fE=cL.ofArray(new a.Float64Array(fD.length));fF=new a.Float64Array(cO.numRows(fB));fG=U.map(U.ofList,fC);fH=U.map(function(fL){return U.map(function(fM){return fM[0];},fL);},fG);fI=U.map(function(fL){return U.map(function(fM){return fM[1];},fL);},fG);return function(fL){return function(fM){return fK(fL,fM);};};};_5.New=function(fB,fC,fD,fE,fF,fG,fH,fI,fJ,fK){return{name:fB,species_index:fC,populations:fD,sim_settings:fE,settings:fF,stoich:fG,powers:fH,rates:fI,rateExpressions:fJ,rng:fK};};_6.map=function(fB,fC){function fD(fE,fF){return[fB(fE),fF];}return _6.New(fC.parameters,A.map(function(fE){return fD(fE[0],fE[1]);},fC.diffusibles),fC.dimensions,fC.boundary,fC.xmax,fC.nx,fC.dt,fC.default_diffusion,fC.random);};_6.to_string=function(fB,fC){var fD,fE;fD=_6.get_defaults();fE=dk.concat("; ",A.choose(a.id,A.ofArray([fC.dimensions===fD.dimensions?null:{$:1,$0:(function(fF){return function(fG){return fF("dimensions = "+a.String(fG));};}(a.id))(fC.dimensions)},bk.Equals(fC.boundary,fD.boundary)?null:{$:1,$0:(function(fF){return function(fG){return fF("boundary = "+_2.toSafe(fG));};}(a.id))(a.String(fC.boundary))},fC.diffusibles.$==0?null:{$:1,$0:(function(fF){return function(fG){return fF("diffusibles = ["+_2.toSafe(fG)+"]");};}(a.id))(_6.diffusibles_to_string(fB,fC.diffusibles))},fC.default_diffusion===fD.default_diffusion?null:{$:1,$0:(function(fF){return function(fG){return fF("default_diffusion = "+_2.toSafe(fG));};}(a.id))(a.String(fC.default_diffusion))},fC.xmax===fD.xmax?null:{$:1,$0:(function(fF){return function(fG){return fF("xmax = "+_2.toSafe(fG));};}(a.id))(a.String(fC.xmax))},fC.nx===fD.nx?null:{$:1,$0:(function(fF){return function(fG){return fF("nx = "+a.String(fG));};}(a.id))(fC.nx)},fC.dt===fD.dt?null:{$:1,$0:(function(fF){return function(fG){return fF("dt = "+_2.toSafe(fG));};}(a.id))(a.String(fC.dt))},fC.random===fD.random?null:{$:1,$0:(function(fF){return function(fG){return fF("random = "+_2.toSafe(fG));};}(a.id))(a.String(fC.random))}])));return(function(fF){return function(fG){return fF("{ "+_2.toSafe(fG)+" }");};}(a.id))(fE);};_6.get_defaults=function(){return _6.New(B.Empty,B.Empty,1,"Periodic",1,20,0,0,0);};_6.diffusibles_to_string=function(fB,fC){function fD(fE,fF){return(((fu.Curried3(function(fG,fH,fI){return fG(_2.toSafe(fH)+"="+_2.toSafe(fI));}))(a.id))(fB(fE)))(R.to_string(a.id,fF));}return dk.concat("; ",A.map(function(fE){return fD(fE[0],fE[1]);},fC));};_6.get_parse=function(){var fB;fB=_6.get_defaults();return function(fC){return _6.parse_defaults(fB,fC);};};_6.parse_defaults=function(fB,fC){var fD,fE,fF,fG,fH,fI,fJ;function fK(fV,fW){return dz.op_DotGreaterGreater(D.pint32(),D.spaces(),fV,fW);}function fL(fV,fW){return dz.op_DotGreaterGreater(D.pfloat(),D.spaces(),fV,fW);}function fM(fV,fW){return _6.New(fW.parameters,fV,fW.dimensions,fW.boundary,fW.xmax,fW.nx,fW.dt,fW.default_diffusion,fW.random);}function fN(fV,fW){return _6.New(fW.parameters,fW.diffusibles,fW.dimensions,fW.boundary,fW.xmax,fW.nx,fW.dt,fV,fW.random);}function fO(fV,fW){return _6.New(fW.parameters,fW.diffusibles,fV,fW.boundary,fW.xmax,fW.nx,fW.dt,fW.default_diffusion,fW.random);}function fP(fV,fW){return _6.New(fW.parameters,fW.diffusibles,fW.dimensions,fW.boundary,fW.xmax,fW.nx,fW.dt,fW.default_diffusion,fV);}function fQ(fV,fW){return _6.New(fW.parameters,fW.diffusibles,fW.dimensions,fW.boundary,fV,fW.nx,fW.dt,fW.default_diffusion,fW.random);}function fR(fV,fW){return _6.New(fW.parameters,fW.diffusibles,fW.dimensions,fW.boundary,fW.xmax,fV,fW.dt,fW.default_diffusion,fW.random);}function fS(fV,fW){return _6.New(fW.parameters,fW.diffusibles,fW.dimensions,fW.boundary,fW.xmax,fW.nx,fV,fW.default_diffusion,fW.random);}function fT(fV,fW){return _6.New(fW.parameters,fW.diffusibles,fW.dimensions,"Periodic",fW.xmax,fW.nx,fW.dt,fW.default_diffusion,fW.random);}function fU(fV,fW){return _6.New(fW.parameters,fW.diffusibles,fW.dimensions,"ZeroFlux",fW.xmax,fW.nx,fW.dt,fW.default_diffusion,fW.random);}return D.record(fB,A.ofArray([["diffusibles",(fD=D.list_of((fE=(fF=D.skw("="),(fG=R.parse(D.name()),function(fV){return dz.op_GreaterGreaterDot(fF,fG,fV[0],fV[1]);})),function(fV){return dz.op_DotGreaterGreaterDot(fC,fE,fV[0],fV[1]);})),function(fV){return dz.op_BarGreaterGreater(fD,function(fW){return function(fX){return fM(fW,fX);};},fV[0],fV[1]);})],["default_diffusion",function(fV){return dz.op_BarGreaterGreater(function(fW){return fL(fW[0],fW[1]);},function(fW){return function(fX){return fN(fW,fX);};},fV[0],fV[1]);}],["dimensions",function(fV){return dz.op_BarGreaterGreater(function(fW){return fK(fW[0],fW[1]);},function(fW){return function(fX){return fO(fW,fX);};},fV[0],fV[1]);}],["random",function(fV){return dz.op_BarGreaterGreater(function(fW){return fL(fW[0],fW[1]);},function(fW){return function(fX){return fP(fW,fX);};},fV[0],fV[1]);}],["xmax",function(fV){return dz.op_BarGreaterGreater(function(fW){return fL(fW[0],fW[1]);},function(fW){return function(fX){return fQ(fW,fX);};},fV[0],fV[1]);}],["nx",function(fV){return dz.op_BarGreaterGreater(function(fW){return fK(fW[0],fW[1]);},function(fW){return function(fX){return fR(fW,fX);};},fV[0],fV[1]);}],["dt",function(fV){return dz.op_BarGreaterGreater(function(fW){return fL(fW[0],fW[1]);},function(fW){return function(fX){return fS(fW,fX);};},fV[0],fV[1]);}],["boundary",(fH=D.choice([(fI=D.kw("Periodic"),function(fV){return dz.op_BarGreaterGreater(fI,function(fW){return function(fX){return fT(fW,fX);};},fV[0],fV[1]);}),(fJ=D.kw("ZeroFlux"),function(fV){return dz.op_BarGreaterGreater(fJ,function(fW){return function(fX){return fU(fW,fX);};},fV[0],fV[1]);})]),function(fV){return fH([fV[0],fV[1]]);})]]));};_6.New=function(fB,fC,fD,fE,fF,fG,fH,fI,fJ){return{parameters:fB,diffusibles:fC,dimensions:fD,boundary:fE,xmax:fF,nx:fG,dt:fH,default_diffusion:fI,random:fJ};};_7.get_defaults=function(){return _7.New(1,null,1,null);};_7.to_string=function(fB){return _7.to_string_defaults(_7.get_defaults(),fB);};_7.to_string_defaults=function(fB,fC){function fD(fF,fG){return fG!=null&&fG.$==1?(function(fH){return function(fI){return fH("name = "+a.String(fI)+"; ");};}(a.id))(fG.$0):"";}function fE(fF,fG){return fG!=null&&fG.$==1?(function(fH){return function(fI){return fH("name = "+fI.toFixed(6));};}(a.id))(fG.$0):"";}return db.emit_record(fB,A.ofArray([["scale",function(fF){return a.String(fF.scale);}],["steps",function(fF){return fD("steps",fF.steps);}],["trajectories",function(fF){return a.String(fF.trajectories);}],["stationary_skiptime",function(fF){return fE("stationary_skiptime",fF.stationary_skiptime);}]]),fC);};_7.get_parse=function(){return _7.parse_defaults(_7.get_defaults());};_7.parse_defaults=function(fB){function fC(fG,fH){return _7.New(fG,fH.steps,fH.trajectories,fH.stationary_skiptime);}function fD(fG,fH){return _7.New(fH.scale,{$:1,$0:fG},fH.trajectories,fH.stationary_skiptime);}function fE(fG,fH){return _7.New(fH.scale,fH.steps,fG,fH.stationary_skiptime);}function fF(fG,fH){return _7.New(fH.scale,fH.steps,fH.trajectories,{$:1,$0:fG});}return D.record(fB,A.ofArray([["scale",function(fG){return dz.op_BarGreaterGreater(D.pfloat(),function(fH){return function(fI){return fC(fH,fI);};},fG[0],fG[1]);}],["steps",function(fG){return dz.op_BarGreaterGreater(D.pint32(),function(fH){return function(fI){return fD(fH,fI);};},fG[0],fG[1]);}],["trajectories",function(fG){return dz.op_BarGreaterGreater(D.pint32(),function(fH){return function(fI){return fE(fH,fI);};},fG[0],fG[1]);}],["stationary_skiptime",function(fG){return dz.op_BarGreaterGreater(D.pfloat(),function(fH){return function(fI){return fF(fH,fI);};},fG[0],fG[1]);}]]));};_7.New=function(fB,fC,fD,fE){return{scale:fB,steps:fC,trajectories:fD,stationary_skiptime:fE};};_8.New=function(fB,fC,fD){return{name:fB,structure:fC,svg:fD};};_9.empty=function(){return c$.New(new y.New([]));};_9.toSeq=function(fB){return K.ToSeq(fB.map);};_9.find=function(fB,fC){return fB.map.get_Item(fC);};_9.add=function(fB,fC,fD){fB.map=fB.map.Add(fC,fD);};_9.containsKey=function(fB,fC){return fB.map.ContainsKey(fC);};_9.count=function(fB){return fB.map.get_Count();};_9.keys=function(fB){return bc.map(function(fC){return a.id(fC[0],fC[1]);},K.ToSeq(fB.map));};_=d.Ctmc=fu.Class({statespace_for_CME_integration:function(fB,fC){var fD,fE,fF,fG,fH;function fI(fJ,fK){var fL;fL=K.TryFind(fK,fJ);return fL==null?0:fL.$0;}fD=_9.count(this.graph);fE=cO.zeros(fD,fC);fF=new a.Float64Array(fD);fG=K.OfArray(U.ofSeq(bc.mapi(function(fJ,fK){return[fK,fJ];},_9.keys(this.graph))));fF[fG.get_Item(this.initial_state)]=1;fH=new df.New(fD,fD);bc.iteri(function(fJ,fK){var fM,fN,fO,fP,fQ,fR,fS,fT,fU;function fL(fV,fW){var fX;fX=U.findIndex(function(fY){return fV===fY;},fN);U.set(fP,fX,U.get(fP,fX)+fW);}fM=bc.sortBy(function(fV){return fV[0];},bc.map(function(fV){return[fG.get_Item(fV.target),R["eval"](function(fW){return di.find(fB,fW);},fV.propensity)];},fK[1]));fN=U.ofSeq(bc.distinct(bc.map(function(fV){return fV[0];},fM)));fO=U.length(fN);fP=U.init(fO,function(){return 0;});bc.iter(function(fV){return fL(fV[0],fV[1]);},fM);fQ=U.sum(fP);fR=fQ===0?new es.New$1(fP,fN,fO):new es.New$1([-fQ].concat(fP),[fJ].concat(fN),1+fO);fH.set_Item(fJ,fR);for(fS=0,fT=fC-1;fS<=fT;fS++){fU=+fI(fK[0],fS);(U.get(fE.MatrixData,fJ))[fS]=fU;}},_9.toSeq(this.graph));return[fH,fE,fF];},statespace_for_CME_sundials:function(fB,fC){var fD,fE,fF,fG,fH,fI,fJ,fK;function fL(fM,fN){var fO;fO=K.TryFind(fN,fM);return fO==null?0:fO.$0;}fD=_9.count(this.graph);fE=cO.zeros(fD,fC);fF=K.OfArray(U.ofSeq(bc.mapi(function(fM,fN){return[fN,fM];},_9.keys(this.graph))));fG=fF.get_Item(this.initial_state);fH=U.init(fD,function(fM){return fM===fG?1:0;});fI=U.unzip3(U.ofSeq(bc.mapi(function(fM,fN){var fO,fP,fQ,fR,fS,fT,fU;fO=U.ofSeq(bc.sortBy(function(fV){return fV[0];},bc.map(function(fV){return[fF.get_Item(fV.target),R["eval"](function(fW){return di.find(fB,fW);},fV.propensity)];},fN[1])));fP=U.unzip(fO);fQ=fP[0];fR=U.create(fQ.length,fM);for(fS=0,fT=fC-1;fS<=fT;fS++){fU=+fL(fN[0],fS);(U.get(fE.MatrixData,fM))[fS]=fU;}return[fQ,fR,fP[1]];},_9.toSeq(this.graph))));fJ=fI[2];fK=U.map(U.sum,fJ);return[[U.concat(fJ),U.concat(fI[0]),U.concat(fI[1]),fK],fE,fH];}},null,_);_.calculate_reaction_prop=function(fB,fC,fD,fE){var fF,fI,fJ,fK,fL,fM;function fG(fN){var fO;fO=K.TryFind(fN,fC);return fO!=null&&fO.$==1?fO.$0:0;}function fH(fN){return fN.$==2?{$:1,$0:fG(fN.$0)}:fN.$==3?F.FailWith("Unexpected [time] in CTMC rate"):fN.$==1?R.expand(fH,fE.get_Item(fN.$0)):{$:0,$0:fN.$0};}fI=fD.rate;if(fI.$==1)return R.expand(fH,fI.$0);else{fJ=fI.$0;fK=b$.to_mlist(fD.reactants);switch(fK.$==1?fK.$0.multiplicity===1?fK.$1.$==1?fK.$1.$0.multiplicity===1?fK.$1.$1.$==0?(fF=[fK.$0.element,fK.$1.$0.element],4):(fF=fK,5):(fF=fK,5):(fF=fK.$0.element,1):fK.$0.multiplicity===2?fK.$1.$==0?(fF=fK.$0.element,2):(fF=fK,5):fK.$0.multiplicity===3?fK.$1.$==0?(fF=fK.$0.element,3):(fF=fK,5):(fF=fK,5):0){case 0:return fJ;case 1:return{$:2,$0:A.ofArray([fJ,{$:1,$0:fG(fF)}])};case 2:fL={$:1,$0:fG(fF)};return{$:2,$0:A.ofArray([fJ,fL,{$:6,$0:cr.New(fL,{$:1,$0:1})},{$:1,$0:0.5}])};case 3:fM={$:1,$0:fG(fF)};return{$:3,$0:ct.New({$:2,$0:A.ofArray([fJ,fM,{$:6,$0:cr.New(fM,{$:1,$0:1})},{$:6,$0:cr.New(fM,{$:1,$0:2})}])},{$:1,$0:6})};case 4:return{$:2,$0:A.ofArray([fJ,{$:1,$0:fG(fF[0])},{$:1,$0:fG(fF[1])}])};case 5:return db.fold_left(function(fN,fO){return{$:2,$0:A.ofArray([fN,{$:1,$0:db.binom(F.toInt(fG(fO.element)),fO.multiplicity)}])};},fJ,fF);}}};_.nonzero_prop=function(fB,fC){return!bk.Equals(R.simplify(fC),{$:1,$0:0});};_.get_all_product_species=function(fB){return A.collect(_.get_product_species,fB);};_.get_product_species=function(fB){return b$.elements(fB.products);};_.New=function(fB,fC){return new _({graph:fB,initial_state:fC});};$=x.List=fu.Class({GetEnumerator:function(){return da.Get(this);},GetEnumerator0:function(){return da.Get0(this);}},null,$);ba.New=function(fB,fC){return{target:fB,propensity:fC};};bb.of_list=function(fB){return db.fold_right(function(fC,fD){return(function(fE){var fF,fG;fF=fE[0];fG=fE[1];return function(fH){return bb.add(fF,fG,fH);};}(fC))(fD);},fB,bb.empty());};bb.find=function(fB,fC){return fC.get_Item(fB);};bb.add=function(fB,fC,fD){return fD.Add(fB,fC);};bb.empty=function(){dN.$cctor();return dN.empty;};bb.tryFind=function(fB,fC){return K.TryFind(fB,fC);};bb.fold=function(fB,fC,fD){return K.Fold(fB,fC,fD);};bc.map=function(fB,fC){return{GetEnumerator:function(){var fD;fD=da.Get(fC);return new dc.New(null,null,function(fE){return fD.MoveNext()&&(fE.c=fB(fD.Current()),true);},function(){fD.Dispose();});}};};bc.iter=function(fB,fC){var fD;fD=da.Get(fC);try{while(fD.MoveNext())fB(fD.Current());}finally{if(typeof fD=="object"&&"Dispose"in fD)fD.Dispose();}};bc.choose=function(fB,fC){return bc.collect(function(fD){var fE;fE=fB(fD);return fE==null?B.Empty:A.ofArray([fE.$0]);},fC);};bc.head=function(fB){var fC;fC=da.Get(fB);try{return fC.MoveNext()?fC.Current():bc.insufficient();}finally{if(typeof fC=="object"&&"Dispose"in fC)fC.Dispose();}};bc.tryFind=function(fB,fC){var fD,fE,fF;fD=da.Get(fC);try{fE=null;while(fE==null&&fD.MoveNext()){fF=fD.Current();fB(fF)?fE={$:1,$0:fF}:void 0;}return fE;}finally{if(typeof fD=="object"&&"Dispose"in fD)fD.Dispose();}};bc.collect=function(fB,fC){return bc.concat(bc.map(fB,fC));};bc.length=function(fB){var fC,fD;fC=0;fD=da.Get(fB);try{while(fD.MoveNext())fC=fC+1;return fC;}finally{if(typeof fD=="object"&&"Dispose"in fD)fD.Dispose();}};bc.groupBy=function(fB,fC){return bc.delay(function(){return U.groupBy(fB,U.ofSeq(fC));});};bc.filter=function(fB,fC){return{GetEnumerator:function(){var fD;fD=da.Get(fC);return new dc.New(null,null,function(fE){var fF,fG,fH;fF=fD.MoveNext();fG=fD.Current();fH=false;while(fF)if(fB(fG)){fE.c=fG;fH=true;fF=false;}else if(fD.MoveNext())fG=fD.Current();else fF=false;return fH;},function(){fD.Dispose();});}};};bc.isEmpty=function(fB){var fC;fC=da.Get(fB);try{return!fC.MoveNext();}finally{if(typeof fC=="object"&&"Dispose"in fC)fC.Dispose();}};bc.fold=function(fB,fC,fD){var fE,fF;fE=fC;fF=da.Get(fD);try{while(fF.MoveNext())fE=fB(fE,fF.Current());return fE;}finally{if(typeof fF=="object"&&"Dispose"in fF)fF.Dispose();}};bc.scan=function(fB,fC,fD){return{GetEnumerator:function(){var fE;fE=da.Get(fD);return new dc.New(false,null,function(fF){return fF.s?fE.MoveNext()&&(fF.c=fB(fF.c,fE.Current()),true):(fF.c=fC,fF.s=true,true);},function(){fE.Dispose();});}};};bc.distinct=function(fB){return bc.distinctBy(a.id,fB);};bc.concat=function(fB){return{GetEnumerator:function(){var fC;fC=da.Get(fB);return new dc.New(null,null,function(fD){var fE;while(true){fE=fD.s;if(bk.Equals(fE,null)){if(fC.MoveNext()){fD.s=da.Get(fC.Current());fD=fD;}else{fC.Dispose();return false;}}else if(fE.MoveNext()){fD.c=fE.Current();return true;}else{fD.Dispose();fD.s=null;fD=fD;}}},function(fD){var fE;fE=fD.s;!bk.Equals(fE,null)?fE.Dispose():void 0;!bk.Equals(fC,null)?fC.Dispose():void 0;});}};};bc.sumBy=function(fB,fC){return bc.fold(function(fD,fE){return fD+fB(fE);},0,fC);};bc.init=function(fB,fC){return bc.take(fB,bc.initInfinite(fC));};bc.map2=function(fB,fC,fD){return{GetEnumerator:function(){var fE,fF;fE=da.Get(fC);fF=da.Get(fD);return new dc.New(null,null,function(fG){return fE.MoveNext()&&fF.MoveNext()&&(fG.c=fB(fE.Current(),fF.Current()),true);},function(){fE.Dispose();fF.Dispose();});}};};bc.exists=function(fB,fC){var fD,fE;fD=da.Get(fC);try{fE=false;while(!fE&&fD.MoveNext())fE=fB(fD.Current());return fE;}finally{if(typeof fD=="object"&&"Dispose"in fD)fD.Dispose();}};bc.delay=function(fB){return{GetEnumerator:function(){return da.Get(fB());}};};bc.append=function(fB,fC){return{GetEnumerator:function(){var fD,fE;fD=da.Get(fB);fE=[true];return new dc.New(fD,null,function(fF){var fG;return fF.s.MoveNext()?(fF.c=fF.s.Current(),true):(fG=fF.s,!bk.Equals(fG,null)?fG.Dispose():void 0,fF.s=null,fE[0]&&(fE[0]=false,fF.s=da.Get(fC),fF.s.MoveNext()?(fF.c=fF.s.Current(),true):(fF.s.Dispose(),fF.s=null,false)));},function(fF){var fG;fG=fF.s;!bk.Equals(fG,null)?fG.Dispose():void 0;});}};};bc.find=function(fB,fC){var fD;fD=bc.tryFind(fB,fC);return fD==null?F.FailWith("KeyNotFoundException"):fD.$0;};bc.sum=function(fB){return bc.fold(function(fC,fD){return fC+fD;},0,fB);};bc.skip=function(fB,fC){return{GetEnumerator:function(){var fD;fD=da.Get(fC);return new dc.New(true,null,function(fE){var fF,fG;if(fE.s){for(fF=1,fG=fB;fF<=fG;fF++)if(!fD.MoveNext())bc.insufficient();fE.s=false;}else null;return fD.MoveNext()&&(fE.c=fD.Current(),true);},function(){fD.Dispose();});}};};bc.unfold=function(fB,fC){return{GetEnumerator:function(){return new dc.New(fC,null,function(fD){var fE;fE=fB(fD.s);return fE==null?false:(fD.c=fE.$0[0],fD.s=fE.$0[1],true);},void 0);}};};bc.distinctBy=function(fB,fC){return{GetEnumerator:function(){var fD,fE;fD=da.Get(fC);fE=new e1.New$3();return new dc.New(null,null,function(fF){var fG,fH;if(fD.MoveNext()){fG=fD.Current();fH=fE.Add(fB(fG));while(!fH&&fD.MoveNext()){fG=fD.Current();fH=fE.Add(fB(fG));}return fH&&(fF.c=fG,true);}else return false;},function(){fD.Dispose();});}};};bc.take=function(fB,fC){fB<0?bc.nonNegative():void 0;return{GetEnumerator:function(){var fD;fD=[da.Get(fC)];return new dc.New(0,null,function(fE){var fF;fE.s=fE.s+1;return fE.s>fB?false:(fF=fD[0],bk.Equals(fF,null)?bc.insufficient():fF.MoveNext()?(fE.c=fF.Current(),fE.s===fB?(fF.Dispose(),fD[0]=null):void 0,true):(fF.Dispose(),fD[0]=null,bc.insufficient()));},function(){var fE;fE=fD[0];!bk.Equals(fE,null)?fE.Dispose():void 0;});}};};bc.initInfinite=function(fB){return{GetEnumerator:function(){return new dc.New(0,null,function(fC){fC.c=fB(fC.s);fC.s=fC.s+1;return true;},void 0);}};};bc.mapi=function(fB,fC){return bc.map2(fB,bc.initInfinite(a.id),fC);};bc.iteri=function(fB,fC){var fD,fE;fD=0;fE=da.Get(fC);try{while(fE.MoveNext()){fB(fD,fE.Current());fD=fD+1;}}finally{if(typeof fE=="object"&&"Dispose"in fE)fE.Dispose();}};bc.sortBy=function(fB,fC){return bc.delay(function(){var fD;fD=U.ofSeq(fC);U.sortInPlaceBy(fB,fD);return fD;});};bc.findIndex=function(fB,fC){var fD;fD=bc.tryFindIndex(fB,fC);return fD==null?F.FailWith("KeyNotFoundException"):fD.$0;};bc.rev=function(fB){return bc.delay(function(){return U.ofSeq(fB).slice().reverse();});};bc.forall2=function(fB,fC,fD){return!bc.exists2(function(fE,fF){return!fB(fE,fF);},fC,fD);};bc.tryFindIndex=function(fB,fC){var fD,fE,fF;fD=da.Get(fC);try{fE=true;fF=0;while(fE&&fD.MoveNext())if(fB(fD.Current()))fE=false;else fF=fF+1;return fE?null:{$:1,$0:fF};}finally{if(typeof fD=="object"&&"Dispose"in fD)fD.Dispose();}};bc.takeWhile=function(fB,fC){return bc.delay(function(){return bc.enumUsing(da.Get(fC),function(fD){return bc.enumWhile(function(){return fD.MoveNext()&&fB(fD.Current());},bc.delay(function(){return[fD.Current()];}));});});};bc.exists2=function(fB,fC,fD){var fE,fF,fG,fH;fE=da.Get(fC);try{fG=da.Get(fD);try{fH=false;while(!fH&&fE.MoveNext()&&fG.MoveNext())fH=fB(fE.Current(),fG.Current());fF=fH;}finally{if(typeof fG=="object"&&"Dispose"in fG)fG.Dispose();}return fF;}finally{if(typeof fE=="object"&&"Dispose"in fE)fE.Dispose();}};bc.compareWith=function(fB,fC,fD){var fE,fF,fG,fH,fI;fE=da.Get(fC);try{fG=da.Get(fD);try{fH=0;fI=true;while(fI&&fH===0)if(fE.MoveNext())fH=fG.MoveNext()?fB(fE.Current(),fG.Current()):1;else if(fG.MoveNext())fH=-1;else fI=false;fF=fH;}finally{if(typeof fG=="object"&&"Dispose"in fG)fG.Dispose();}return fF;}finally{if(typeof fE=="object"&&"Dispose"in fE)fE.Dispose();}};bc.nth=function(fB,fC){var fD,fE;if(fB<0)F.FailWith("negative index requested");fD=-1;fE=da.Get(fC);try{while(fD<fB){!fE.MoveNext()?bc.insufficient():void 0;fD=fD+1;}return fE.Current();}finally{if(typeof fE=="object"&&"Dispose"in fE)fE.Dispose();}};bc.min=function(fB){var fC,fD,fE;fC=da.Get(fB);try{if(!fC.MoveNext())bc.seqEmpty();fD=fC.Current();while(fC.MoveNext()){fE=fC.Current();bk.Compare(fE,fD)===-1?fD=fE:void 0;}return fD;}finally{if(typeof fC=="object"&&"Dispose"in fC)fC.Dispose();}};bc.max=function(fB){var fC,fD,fE;fC=da.Get(fB);try{if(!fC.MoveNext())bc.seqEmpty();fD=fC.Current();while(fC.MoveNext()){fE=fC.Current();bk.Compare(fE,fD)===1?fD=fE:void 0;}return fD;}finally{if(typeof fC=="object"&&"Dispose"in fC)fC.Dispose();}};bc.seqEmpty=function(){return F.FailWith("The input sequence was empty.");};bd=x.Dictionary=fu.Class({Add:function(fB,fC){this.add(fB,fC);},add:function(fB,fC){var fD,fE,fF;fD=this;fE=this.hash(fB);fF=this.data[fE];fF==null?(this.count=this.count+1,this.data[fE]=new a.Array({K:fB,V:fC})):(U.exists(function(fG){return fD.equals.apply(null,[(F.KeyValue(fG))[0],fB]);},fF)?dd.alreadyAdded():void 0,this.count=this.count+1,fF.push({K:fB,V:fC}));},get_Item:function(fB){return this.get(fB);},ContainsKey:function(fB){var fC,fD;fC=this;fD=this.data[this.hash(fB)];return fD==null?false:U.exists(function(fE){return fC.equals.apply(null,[(F.KeyValue(fE))[0],fB]);},fD);},get_Values:function(){return new dP.New(this);},set:function(fB,fC){var fD,fE,fF,fG;fD=this;fE=this.hash(fB);fF=this.data[fE];fF==null?(this.count=this.count+1,this.data[fE]=new a.Array({K:fB,V:fC})):(fG=U.tryFindIndex(function(fH){return fD.equals.apply(null,[(F.KeyValue(fH))[0],fB]);},fF),fG==null?(this.count=this.count+1,fF.push({K:fB,V:fC})):fF[fG.$0]={K:fB,V:fC});},get:function(fB){var fC,fD;fC=this;fD=this.data[this.hash(fB)];return fD==null?dd.notPresent():U.pick(function(fE){var fF;fF=F.KeyValue(fE);return fC.equals.apply(null,[fF[0],fB])?{$:1,$0:fF[1]}:null;},fD);},set_Item:function(fB,fC){this.set(fB,fC);},GetEnumerator:function(){return da.Get0(this);},GetEnumerator0:function(){return da.Get0(U.concat(dj.GetFieldValues(this.data)));}},w,bd);bd.New$5=fu.Ctor(function(){bd.New$6.call(this,[],bk.Equals,bk.Hash);},bd);bd.New$6=fu.Ctor(function(fB,fC,fD){var fE,fF;w.New.call(this);this.equals=fC;this.hash=fD;this.count=0;this.data=[];fE=da.Get(fB);try{while(fE.MoveNext()){fF=fE.Current();this.set(fF.K,fF.V);}}finally{if(typeof fE=="object"&&"Dispose"in fE)fE.Dispose();}},bd);be.to_string=function(fB){return fB.name;};be.get_from_string=function(){var fB;fB=be.get_parse();return function(fC){return D.from_string(fB,fC);};};be.get_parse=function(){return D.op_BarGreaterGreater(D.name_kw(ej.kwList()),be.create);};be.create=function(fB){return be.New(fB);};be.New=function(fB){return{name:fB};};bf.create=function(fB,fC,fD,fE){var fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO;function fP(fR,fS){return fR+fS;}function fQ(fR,fS){return fR+fS;}fF=fE!==1?[T.scale(fB,fE),A.map(function(fR){var fS;fS=fR.target;return fS.$==0?cT.New(fR.time,{$:0,$0:T.scale(fS.$0,fE)}):fR;},fC)]:[fB,fC];fG=fF[0];fH=new B({$:1,$0:cT.New(fD["final"],"OutputPoint"),$1:A.filter(function(fR){var fS;fS=fR.target;return fS.$==0?U.exists(function(fT){return fT!==0;},fS.$0.get_get_pop_array()):true;},fF[1])});fI=A.choose(function(fR){return fR.target.$==0?{$:1,$0:fR.time}:null;},fH);fJ=fI.$==0?[fG,A.sortBy(function(fR){return fR.time;},fH)]:(fK=A.min(fI),fK<fD.initial?(fL=A.partition(function(fR){return fR.target.$==0&&fR.time<fD.initial;},fH),[T.merge(function(fR,fS){return fR+fS;},fG,(fM=(fu.Curried3(T.merge))(fP),A.reduce(function(fR,fS){return(fM(fR))(fS);},A.choose(function(fR){var fS;fS=fR.target;return fS.$==0?{$:1,$0:fS.$0}:null;},fL[0])))),A.sortBy(function(fR){return fR.time;},fL[1])]):fK===fD.initial?(fN=A.partition(function(fR){return fR.target.$==0&&fR.time===fK;},fH),[T.merge(function(fR,fS){return fR+fS;},fG,(fO=(fu.Curried3(T.merge))(fQ),A.reduce(function(fR,fS){return(fO(fR))(fS);},A.choose(function(fR){var fS;fS=fR.target;return fS.$==0?{$:1,$0:fS.$0}:null;},fN[0])))),A.sortBy(function(fR){return fR.time;},fN[1])]):[fG,A.sortBy(function(fR){return fR.time;},fH)]);return bf.New(fD,fJ[0],fJ[1],fD.initial,fD.initial,0);};bf.empty=function(){return bf.New(P.get_defaults(),T.empty(),B.Empty,0,0,0);};bf.New=function(fB,fC,fD,fE,fF,fG){return{settings:fB,populations:fC,events:fD,currenttime:fE,nextprinttime:fF,stepsdone:fG};};bg=d.Cme=fu.Class({simulate_sundials:function(fB,fC){return this.simulate_sundials_callback([false],fB,fC,a.ignore);},simulate_sundials_callback:function(fB,fC,fD,fE){var fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO,fP,fQ,fR,fS,fV,fW,fX,fY,fZ,f0,f1,f2,f3,f4,f5,f6,f7;function fT(f8){return co.inline_keys(fC,fD,f8);}function fU(f8){return R.expand(fL,f8);}fV=this.simulator;fW=fV.settings;fX=fW.times.$!==0?fW.times:(fF=fW.initial,fG=fW.get_print_interval(),A.init(fW.points+1,function(f8){return fF+f8*fG;}));if(A.exists(function(f8){return f8.target!="OutputPoint";},fV.events))F.FailWith("Events not supported for CME integration");fY=this.statespace[0].statespace_for_CME_sundials(fC,fV.populations.index_to_species.length);fZ=fY[1];f0=fY[0][0];f1=fY[2];f2=cO.ofRows(U.init(cO.numRows(fZ),function(f8){return cL.ofArray(U.init(cO.numCols(fZ),function(f9){return fv.pow((U.get(fZ.MatrixData,f8))[f9],2);}));}));f3=U.ofList(fX);f4=f1.length;f5=fX.get_Length();f6=[];f7={stateN:f4,transN:f0.length,propensities:f0,sources:fY[0][2],targets:fY[0][1],diagonals:fY[0][3],prob_mass:f1,timesToReturnParam:f3,numTimesToReturnParam:f5,sundialsOutput:function(f8,f9){f6.push(cL.ofArray(f9));return null;},stiff:this.settings.stiff,abstol:this.settings.abstolerance,reltol:this.settings.reltolerance};fJ=[fw.fnSundialsCMESolver(f7),f7.prob_mass];fI=fJ[0];fI!==0?(function(f8){return function(f9){return f8("Sundials solver failed with code: "+a.String(f9));};}(F.FailWith))(fI):void 0;fK=A.ofSeq(f6);fL=(fM=(fN=(fO=(fP=fV.populations,function(f8){return fP.find_index(f8);}),function(f8){return cY.map(fO,f8);}),function(f8){return R.map(fN,f8);}),function(f8){return fM(fT(f8));});fQ=U.map(function(f8){return R.simplify(fU(f8));},U.ofList(fV.settings.plots));fR=bh.New(fX,A.map(cL.toArray,fK),cO.toArray(fZ),cS.map_key(function(f8){return f8.name;},fV.populations.species_to_index));fS=A.map2(function(f8,f9){function f_(ga){return cL.dot(f9,cO.copyCol(fZ,ga));}function f$(ga,gb){var gc;gc=cL.dot(f9,cO.copyCol(f2,gb))-ga*ga;return gc<0?0:fv.sqrt(gc);}return cv.New(f8,U.map(function(ga){var gb,gc;return ga.$==0&&(ga.$0.$==0&&(gb=ga.$0.$0,true))?(gc=f_(gb),cw.New(gc,f$(gc,gb))):F.FailWith("Species functions are not supported in plots (use single species only).");},fQ));},fX,fK);A.iter(fE,fS);return[bg.New(this.name,this.simulator,this.settings,this.statespace,fR),this.process_simulation(fS)];},process_simulation:function(fB){var fC,fD;fC=this.simulator.settings.times;fD=A.map(Q.to_string_plot,this.simulator.settings.plots);return fC.$===0?Z.from_rows(fD,fB):Z.from_rows(fD,cv.interpolate_reverse(function(fE,fF,fG){return fu.Curried(cw.interpolate,2,[fE,fF,fG]);},fB,fC));}},null,bg);bg.get_times=function(fB){return fB.times;};bg.simulate_callback=function(fB,fC,fD,fE,fF,fG){var fH,fI,fJ,fK,fL,fM,fN,fO,fP,fQ,fR,fS,fT;function fU(fX){return co.inline_keys(fB,fC,fX);}function fV(fX){return R.expand(fI,fX);}function fW(fX,fY){function fZ(f1){return cL.dot(fY,cO.copyCol(fQ,f1));}function f0(f1,f2){var f3;f3=cL.dot(fY,cO.copyCol(fR,f2))-f1*f1;return f3<0?0:fv.sqrt(f3);}fS[0]=new B({$:1,$0:fX,$1:fS[0]});fT[0]=new B({$:1,$0:fY,$1:fT[0]});return U.map(function(f1){var f2,f3;return f1.$==0&&(f1.$0.$==0&&(f2=f1.$0.$0,true))?(f3=fZ(f2),cw.New(f3,f0(f3,f2))):F.FailWith("Species functions are not supported in plots (use single species only).");},fN);}fH=fG.simulator;fI=(fJ=(fK=(fL=(fM=fH.populations,function(fX){return fM.find_index(fX);}),function(fX){return cY.map(fL,fX);}),function(fX){return R.map(fK,fX);}),function(fX){return fJ(fU(fX));});fN=U.map(function(fX){return R.simplify(fV(fX));},U.ofList(fH.settings.plots));A.exists(function(fX){return fX.target!="OutputPoint";},fH.events)?F.FailWith("Events not supported for CME integration"):void 0;fF?bg.consoleWrite("Converting state-space to sparse matrix for CME integration"):void 0;fO=fG.statespace[0].statespace_for_CME_integration(fB,fH.populations.index_to_species.length);fP=fO[0];fQ=fO[1];fR=cO.ofRows(U.init(cO.numRows(fQ),function(fX){return cL.ofArray(U.init(cO.numCols(fQ),function(fY){return fv.pow((U.get(fQ.MatrixData,fX))[fY],2);}));}));fF?bg.consoleWrite("Integrating CME for probabilities"):void 0;fS=[B.Empty];fT=[B.Empty];return bg.New(fG.name,cI.simulate_callback(fD,fE,cI.create(fG.name,fG.simulator,function(fX){return function(fY){return fW(fX,fY);};},fu.Curried(cw.interpolate,5),fG.settings,fO[2],function(){var fX;function fY(fZ){return fP.timesRight(fZ);}fX=function(fZ){return fY(cL.toArray(fZ));};return function(fZ){return cL.ofArray(fX(fZ));};})).simulator,fG.settings,fG.statespace,bh.New(A.rev(fS[0]),db.rev_map(cL.toArray,fT[0]),cO.toArray(fQ),cS.map_key(function(fX){return fX.name;},fH.populations.species_to_index)));};bg.create=function(fB,fC,fD,fE,fF){var fG;fG=bg.get_empty();return bg.New(fG.name,bf.create(fB,fC,fE,fF),fD,fG.statespace,fG.probabilities);};bg.consoleWrite=function(fB){fx.log(fB);};bg.get_empty=function(){return bg.New("None",bf.empty(),bO.get_defaults(),[_.New(_9.empty(),new y.New([]))],bh.get_empty());};bg.New=function(fB,fC,fD,fE,fF){return new bg({name:fB,simulator:fC,settings:fD,statespace:fE,probabilities:fF});};bh.get_bounds=function(fB,fC){var fD,fE;fD=cS.find(fB.species,fC);fE=U.init(U.length(fB.stoichiometry),function(fF){return U.get(U.get(fB.stoichiometry,fF),fD);});return[fE,F.toInt(U.max(fE)),F.toInt(U.min(fE))];};bh.probability_map=function(fB,fC,fD){var fE,fF,fG,fH,fI,fJ,fK,fL,fM,fN;function fO(fR,fS){return[fR,bc.map(function(fT){return fT[0];},fS)];}function fP(fR){return fL.times$2(fR);}function fQ(fR){return fR<fN?0:fR;}fE=bh.get_bounds(fC,fD);fF=fE[2];fG=fE[1];fH=fE[0];fI=K.OfArray(U.ofSeq(bc.map(function(fR){return fO(fR[0],fR[1]);},bc.groupBy(function(fR){return fR[1];},U.mapi(function(fR,fS){return[fR,F.toInt(fS)];},fH)))));fJ=U.length(fH);fK=U.map(function(fR){var fS,fT,fU;fS=K.TryFind(fR,fI);return fS!=null&&fS.$==1?(fT=fS.$0,(fU=bc.length(fT),[U.create(fU,1),U.ofSeq(fT),fU])):[[],[],0];},U.ofSeq(F.range(fF,fG)));fL=new df.New$1(fG-fF+1,fJ,U.map(function(fR){return db.fst3(fR[0],fR[1],fR[2]);},fK),U.map(function(fR){return db.snd3(fR[0],fR[1],fR[2]);},fK),U.map(function(fR){return db.trd3(fR[0],fR[1],fR[2]);},fK));return A.map((fM=fB==null?a.id:(fN=fB.$0,function(fR){return U.map(fQ,fR);}),function(fR){return fM(fP(fR));}),fC.stateprobabilities);};bh.get_empty=function(){return bh.New(B.Empty,B.Empty,[],cS.empty());};bh.New=function(fB,fC,fD,fE){return{times:fB,stateprobabilities:fC,stoichiometry:fD,species:fE};};bi.simulate_callback=function(fB,fC,fD,fE,fF){var fG,fH;function fI(fJ){return di.find(fG,fJ);}bi.init(fE);fG=bF.to_env(fE.parameters);fH=function(fJ){return R["eval"](fI,fJ);};(function(fJ){var fK,fM,fN,fO,fP,fQ,fR,fS;function fL(fT,fU){var fV;fV=fE.spDict.get_Item(fT);return fV.isExplored?null:{$:1,$0:fV};}while(true){fM=bi.timeToNextReaction(fE);fN=bi.enactEvents(fM,fC,fE);fO=fE.now+fN;if(bi.isPrintTime(fE,fO,fJ)){fK=bi.createRow(fE.now,bi.evaluatePlots(fE));fC(fK);fE.dataPoints=new B({$:1,$0:fK,$1:fE.dataPoints});fE.nextPrintTime=fO+fE.simulation.get_print_interval();}if(bi.isStopTime(fE,fB)||fE.totalProp===0)return fE;else{fE.now=fO;fP=bi.pickNextReaction(fE);if(fP!=null&&fP.$==1){fQ=fP.$0;bi.executeReaction(fE,fQ);fR=(function(fT){return function(fU){return A.choose(fT,fU);};}(function(fT){return fL(fT[0],fT[1]);}))(fQ.prods);if(fE.mustPlotAll)A.iter(fD,(function(fT){return function(fU){return A.map(fT,fU);};}(function(fT){return fE.printSpecies(fT.payload);}))(fR));else if(!(fR.$==0))bi.extendPlotPatterns(fE,(function(fT){return function(fU){return A.map(fT,fU);};}(function(fT){return fT.payload;}))(fR));fS=da.Get(fR);try{while(fS.MoveNext())((function(fT){return function(){var fU,fV,fW,fX,fZ,f0,f1,f2,f3,f4,f5,f6,f7,f8,f9,f_,f$,ga;fU=fT.Current();fV=A.ofSeq(bc.map(function(gb){return gb.K;},bc.filter(function(gb){return fE.spDict.get_Item(gb.V).isExplored;},fE.sidDict)));fU.isExplored=true;fW=(fF.react(fV))(fU.payload);fX=da.Get(fW);function fY(gb){return[fE.sidDict.get_Item(gb.element),gb.multiplicity];}try{while(fX.MoveNext()){fZ=fX.Current();f0=da.Get(fZ.products);try{while(f0.MoveNext()){f1=f0.Current();!fE.sidDict.ContainsKey(f1.element)?(f2=cZ.New(bi.newSID(fE),f1.element,0,false,false,new dh.New$1(null)),fE.sidDict.Add(f1.element,f2.id),fE.spDict.Add(f2.id,f2)):void 0;}}finally{if(typeof f0=="object"&&"Dispose"in f0)f0.Dispose();}f3=A.map(fY,fZ.reactants);f4=A.map(fY,fZ.products);f5=cc.map(a.id,fH,function(gb){var gc;return R.simplify(R.expand((gc=fE.rates,function(gd){return co.inline_keys(fG,gc,gd);}),gb));},fZ);f6=bi.scaleReaction(fE,f5);f7=c0.New(bi.newRID(fE),f6,f3,f4,0);f8=bi.calculate_reaction_prop(fE,f7);f9=c0.New(f7.id,f7.payload,f7.reacts,f7.prods,f8);fE.totalProp=fE.totalProp+f8;fE.rxDict.Add(f9.id,f9);f_=A.map(function(gb){return gb[0];},A.append(f3,f4));f$=da.Get(f_);try{while(f$.MoveNext()){ga=fE.spDict.get_Item(f$.Current());ga.deps=ga.deps.Add(f9.id);}}finally{if(typeof f$=="object"&&"Dispose"in f$)f$.Dispose();}}return;}finally{if(typeof fX=="object"&&"Dispose"in fX)fX.Dispose();}};}(fS))());}finally{if(typeof fS=="object"&&"Dispose"in fS)fS.Dispose();}fE.stepsDone=fE.stepsDone+1;fJ=false;}else return fE;}}}(true));};bi.to_crn=function(fB,fC){var fD,fE,fF,fG,fH;function fI(fK){var fL,fM,fN;fL=fB.printSpecies(fK);return _8.New(fL.name,(fM=fL.structural,fM==null?"":fM.$0),(fN=fL.svg,fN==null?"":fN.$0));}function fJ(fK){return be.New(fK.name);}fD=(fE=fB.printSpecies,function(fK){return fJ(fE(fK));});fF=A.append(A.ofSeq(bc.map(function(fK){return V.create$3(fK.isConstant,{$:1,$0:fK.population},fD(fK.payload),null);},fB.spDict.get_Values())),A.collect(function(fK){var fL,fM;return fB.now>=fK.time?B.Empty:(fL=fK.time-fB.now,(fM=fK.target,fM=="OutputPoint"?B.Empty:A.map(function(fN){return V.create$3(fN.constant,{$:1,$0:fN.value},fD(fN.species),{$:1,$0:{$:1,$0:fL}});},A.ofArray(fM.$0.index_to_species))));},fB.events));return M.create(fC.name,(fG=fC.settings,O.New(fG.simulation,fG.simulations,(fH=fC.settings.stochastic,_7.New(1,fH.steps,fH.trajectories,fH.stationary_skiptime)),fG.deterministic,fG.spatial,fG.inference,fG.moment_closure,fG.synthesis,fG.data,fG.units,fG.simulator,fG.parameters,fG.sweeps,fG.rates,fG.plot,fG.quiet)),A.ofSeq(bc.map(function(fK){function fL(fM){return fM.$==0?{$:2,$0:fD(fM.$0)}:co.Time;}return cc.map(fD,function(fM){return{$:1,$0:fM};},function(fM){return R.map(fL,fM);},fK.payload);},fB.rxDict.get_Values())),fF,bb.of_list(A.map(function(fK){var fL;fL=fI(fK.payload);return[fL.name,fL];},A.ofSeq(fB.spDict.get_Values()))),true);};bi.to_ctmc=function(fB,fC){var fD,fE,fF;function fG(fH,fI){return[fH,R.map(function(fJ){return fJ.$==1?co.Time:{$:2,$0:fJ.$0};},fI)];}bF.to_env(fB.parameters);fD=A.ofSeq(bc.map(function(fH){return[fH.payload,F.toInt(fH.population)];},fB.spDict.get_Values()));fE=K.OfArray(U.ofSeq(A.map(function(fH){return fG(fH[0],fH[1]);},A.ofSeq(K.ToSeq(fB.rates)))));fF=fC.initialise_ctmc(fD);return[fC.to_ctmc(cS.ofMap(fE),fB.stochastic.scale,fF[0],fF[1],fF[2]),function(fH){var fI,fJ,fK;fI=fB.printSpecies(fH);return _8.New(fI.name,(fJ=fI.structural,fJ==null?"":fJ.$0),(fK=fI.svg,fK==null?"":fK.$0));}];};bi.init=function(fB){!bc.fold(function(fC,fD){var fE;fE=fD.population;return(fv.round(fE)-fE===0||fD.isConstant)&&fC;},true,A.ofSeq(fB.spDict.get_Values()))?F.FailWith("Can\'t use non-integer initial conditions without specifying the species as constant"):void 0;fB.events=A.sortBy(function(fC){return fC.time;},fB.events);};bi.isPrintTime=function(fB,fC,fD){return _1.shouldPrint(fB.simulation["final"],fC,fB.nextPrintTime,bi.getFinalStep(fB),fD,fB.now);};bi.createRow=function(fB,fC){return cv.New(fB,fC);};bi.evaluatePlots=function(fB){function fC(fE){return bc.fold(function(fF,fG){return fF+fB.spDict.get_Item(fG).population;},0,fB.plotDict.get_Item(fE));}function fD(fE){return fE.$==0?fC(fE.$0):fB.now;}return fB.mustPlotAll?U.ofSeq(bc.map(function(fE){return fE.population;},bc.filter(function(fE){return fE.isExplored;},fB.spDict.get_Values()))):U.ofList(A.map(function(fE){return R["eval"](fD,fE);},fB.simulation.plots));};bi.isStopTime=function(fB,fC){return _1.shouldStop(fB.simulation["final"],fB.now,fB.stepsDone,fC,bi.getFinalStep(fB));};bi.pickNextReaction=function(fB){var fC,fD,fE;fC=fB.totalProp;fD=fB.random.NextDouble()*fC;fE=fB.rxDict;return function(fF,fG){var fH,fI;while(true){fH=fE.get_Item(fG);fI=fF+fH.prop;if(fI>fD)return{$:1,$0:fH};else if(fG+1>=fE.count)return fI===0?null:fI!==fC?F.FailWith("Incorrect total propensity used."):F.FailWith("Index outside range");else{fF=fI;fG=fG+1;}}}(0,0);};bi.executeReaction=function(fB,fC){fB.totalProp=bi.update_props_direct(fB,A.ofSeq(new dh.New$1(cx.OfSeq(bc.concat(A.append(A.choose(function(fD){var fE;fE=fB.spDict.get_Item(fD[0]);return fE.isConstant?null:(fE.population=fE.population-fD[1],{$:1,$0:fE.deps});},fC.reacts),A.choose(function(fD){var fE;fE=fB.spDict.get_Item(fD[0]);return fE.isConstant?null:(fE.population=fE.population+fD[1],{$:1,$0:fE.deps});},fC.prods)))))));};bi.extendPlotPatterns=function(fB,fC){A.iter(function(fD){A.iter(function(fE){var fF;if(fE.$==1);else{fF=fE.$0;bc.iter(function(fG){if((fB.matchesSpecies(fF))(fG))fB.plotDict.set_Item(fF,A.append(fB.plotDict.get_Item(fF),A.ofArray([fB.sidDict.get_Item(fG)])));},fC);}},R.mentions(fD));},fB.simulation.plots);};bi.newSID=function(fB){var fC;fC=fB.nextSID;fB.nextSID=fC+1;return fC;};bi.newRID=function(fB){var fC;fC=fB.nextRID;fB.nextRID=fC+1;return fC;};bi.calculate_reaction_prop=function(fB,fC){var fD,fE,fH,fI,fJ,fK,fL;function fF(fM){return fB.spDict.get_Item(fM).population;}function fG(fM){return fF(fM)/fD;}fH=fC.payload.rate;if(fH.$==1){fD=fB.stochastic.scale;return R["eval"](function(fM){return fM.$==1?fB.now:fG(fB.sidDict.get_Item(fM.$0));},fH.$0)*fD;}else{fI=fH.$0;fJ=fC.reacts;switch(fJ.$==1?fJ.$0[1]===1?fJ.$1.$==1?fJ.$1.$0[1]===1?fJ.$1.$1.$==0?(fE=[fJ.$0[0],fJ.$1.$0[0]],4):(fE=fJ,5):(fE=fJ,5):(fE=fJ.$0[0],1):fJ.$0[1]===2?fJ.$1.$==0?(fE=fJ.$0[0],2):(fE=fJ,5):fJ.$0[1]===3?fJ.$1.$==0?(fE=fJ.$0[0],3):(fE=fJ,5):(fE=fJ,5):0){case 0:return fI;case 1:return fI*fF(fE);case 2:fK=fF(fE);return fI*fK*(fK-1)*0.5;case 3:fL=fF(fE);return fI*fL*(fL-1)*(fL-2)/6;case 4:return fI*fF(fE[0])*fF(fE[1]);case 5:return db.fold_left(function(fM,fN){return fM*db.binom(F.toInt(fF(fN[0])),fN[1]);},fI,fE);}}};bi.scaleReaction=function(fB,fC){function fD(fE,fF,fG){return fG*fv.pow(fE,1-fF);}return fC.scale(function(fE,fF){return function(fG){return fD(fE,fF,fG);};},fB.stochastic.scale,a.id);};bi.enactEvents=function(fB,fC,fD){var fE,fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO,fP,fQ,fR,fS,fT,fU,fV;fF=fB/fD.totalProp;fG=fD.events;if(fG.$==1){fH=fG.$0;if(fH.time>=fD.now+fF)return fF;else{fD.events=fG.$1;fI=bi.evaluatePlots(fD);fJ=0.99999999;fK=fJ*fH.time+(1-fJ)*fD.now;fL=bi.createRow(fD.now,fI);fM=bi.createRow(fK,fI);fC(fL);fC(fM);fD.dataPoints=new B({$:1,$0:fM,$1:new B({$:1,$0:fL,$1:fD.dataPoints})});fN=fH.time-fD.now;fO=fD.totalProp;fP=fH.target;if(fP=="OutputPoint");else{fQ=fP.$0.index_to_species;for(fR=0,fS=fQ.length-1;fR<=fS;fR++){fT=U.get(fQ,fR);fU=fD.sidDict.get_Item(fT.species);fV=fD.spDict.get_Item(fU);fD.spDict.set_Item(fU,cZ.New(fV.id,fV.payload,fV.population+fT.value,fV.isExplored,fV.isConstant,fV.deps));}}return bi.enactEvents(fB-fN*fO,fC,fD);}}else return fF;};bi.timeToNextReaction=function(fB){var fC;fC=fB.random.NextDouble();return fC>0?fv.log(1/fC):0;};bi.getFinalStep=function(fB){var fC;fC=fB.stochastic.steps;return fC!=null&&fC.$==1?{$:1,$0:fB.stepsDone+fC.$0}:null;};bi.update_props_direct=function(fB,fC){var fD,fE;fD=0;A.iter(function(fF){var fG,fH;fG=fB.rxDict.get_Item(fF);fH=bi.calculate_reaction_prop(fB,fG);fD=fD+(fH-fG.prop);fG.prop=fH;},fC);fE=fB.totalProp+fD;return fE<0?0:fE;};bj=d.GuiModel=fu.Class({to_model:function(){return L.New(this.top.to_crn(),A.map(function(fB){return fB.to_crn();},this.systems));}},null,bj);bj.from_model=function(fB){return bj.New(z.from_crn(fB.top),A.map(z.from_crn,fB.systems));};bj.New=function(fB,fC){return new bj({top:fB,systems:fC});};bk.Equals=function(fB,fC){var fD,fE,fF,fG;if(fB===fC)return true;else{fD=typeof fB;if(fD=="object"){if(fB===null||fB===void 0||fC===null||fC===void 0)return false;else if("Equals"in fB)return fB.Equals(fC);else if(fB instanceof a.Array&&fC instanceof a.Array)return bk.arrayEquals(fB,fC);else if(fB instanceof a.Date&&fC instanceof a.Date)return bk.dateEquals(fB,fC);else{fE=[true];for(var fH in fB)if(function(fI){fE[0]=!fB.hasOwnProperty(fI)||fC.hasOwnProperty(fI)&&bk.Equals(fB[fI],fC[fI]);return!fE[0];}(fH))break;if(fE[0]){for(var fI in fC)if(function(fJ){fE[0]=!fC.hasOwnProperty(fJ)||fB.hasOwnProperty(fJ);return!fE[0];}(fI))break;}return fE[0];}}else return fD=="function"&&("$Func"in fB?fB.$Func===fC.$Func&&fB.$Target===fC.$Target:"$Invokes"in fB&&"$Invokes"in fC&&bk.arrayEquals(fB.$Invokes,fC.$Invokes));}};bk.arrayEquals=function(fB,fC){var fD,fE;if(U.length(fB)===U.length(fC)){fD=true;fE=0;while(fD&&fE<U.length(fB)){!bk.Equals(U.get(fB,fE),U.get(fC,fE))?fD=false:void 0;fE=fE+1;}return fD;}else return false;};bk.dateEquals=function(fB,fC){return fB.getTime()===fC.getTime();};bk.Compare=function(fB,fC){var fD,fE,fF,fG,fH,fI;if(fB===fC)return 0;else{fE=typeof fB;switch(fE=="function"?1:fE=="boolean"?2:fE=="number"?2:fE=="string"?2:fE=="object"?3:0){case 0:return typeof fC=="undefined"?0:-1;case 1:return F.FailWith("Cannot compare function values.");case 2:return fB<fC?-1:1;case 3:if(fB===null)fF=-1;else if(fC===null)fF=1;else if("CompareTo"in fB)fF=fB.CompareTo(fC);else if("CompareTo0"in fB)fF=fB.CompareTo0(fC);else if(fB instanceof a.Array&&fC instanceof a.Array)fF=bk.compareArrays(fB,fC);else if(fB instanceof a.Date&&fC instanceof a.Date)fF=bk.compareDates(fB,fC);else{fG=[0];for(var fJ in fB)if(function(fK){return!fB.hasOwnProperty(fK)?false:!fC.hasOwnProperty(fK)?(fG[0]=1,true):(fG[0]=bk.Compare(fB[fK],fC[fK]),fG[0]!==0);}(fJ))break;if(fG[0]===0){for(var fK in fC)if(function(fL){return!fC.hasOwnProperty(fL)?false:!fB.hasOwnProperty(fL)&&(fG[0]=-1,true);}(fK))break;}fF=fG[0];}return fF;}}};bk.Hash=function(fB){var fC;fC=typeof fB;return fC=="function"?0:fC=="boolean"?fB?1:0:fC=="number"?fB:fC=="string"?bk.hashString(fB):fC=="object"?fB==null?0:fB instanceof a.Array?bk.hashArray(fB):bk.hashObject(fB):0;};bk.compareArrays=function(fB,fC){var fD,fE;if(U.length(fB)<U.length(fC))return -1;else if(U.length(fB)>U.length(fC))return 1;else{fD=0;fE=0;while(fD===0&&fE<U.length(fB)){fD=bk.Compare(U.get(fB,fE),U.get(fC,fE));fE=fE+1;}return fD;}};bk.compareDates=function(fB,fC){return bk.Compare(fB.getTime(),fC.getTime());};bk.hashString=function(fB){var fC,fD,fE;if(fB===null)return 0;else{fC=5381;for(fD=0,fE=fB.length-1;fD<=fE;fD++)fC=bk.hashMix(fC,fB[fD].charCodeAt());return fC;}};bk.hashArray=function(fB){var fC,fD,fE;fC=-34948909;for(fD=0,fE=U.length(fB)-1;fD<=fE;fD++)fC=bk.hashMix(fC,bk.Hash(U.get(fB,fD)));return fC;};bk.hashObject=function(fB){var fC,fD;if("GetHashCode"in fB)return fB.GetHashCode();else{fC=[0];for(var fE in fB)if(function(fF){fC[0]=bk.hashMix(bk.hashMix(fC[0],bk.hashString(fF)),bk.Hash(fB[fF]));return false;}(fE))break;return fC[0];}};bk.hashMix=function(fB,fC){return(fB<<5)+fB+fC;};bl.to_xml=function(fB){var fC;fC=dl.init(bl.preamble());bl.xml_of_model(fC,1,fB);dl.append(fC,bl.postamble());return dl.value(fC);};bl.preamble=function(){dT.$cctor();return dT.preamble;};bl.xml_of_model=function(fB,fC,fD){var fE,fF,fG,fH,fI,fJ;dl.append(fB,bl.tagopen(fC,"model",A.ofArray([["id",bl.oMap(bl.string_of_SId,fD.id)],["name",bl.oMap(bl.string_of_SBMLString,fD.name)]])));dl.append(fB,bl.newline());bl.xml_of_elmtlist(fB,fC+1,(fE=fC+2,function(fK){bl.xml_of_unitDefinition(fB,fE,fK);}),"listOfUnitDefinitions",fD.listOfUnitDefinitions);bl.xml_of_elmtlist(fB,fC+1,(fF=fC+2,function(fK){bl.xml_of_compartment(fB,fF,fK);}),"listOfCompartments",fD.listOfCompartments);bl.xml_of_elmtlist(fB,fC+1,(fG=fC+2,function(fK){bl.xml_of_species(fB,fG,fK);}),"listOfSpecies",fD.listOfSpecies);bl.xml_of_elmtlist(fB,fC+1,(fH=fC+2,function(fK){bl.xml_of_parameter(fB,fH,fK);}),"listOfParameters",fD.listOfParameters);bl.xml_of_elmtlist(fB,fC+1,(fI=fC+2,function(fK){bl.xml_of_initialAssignment(fB,fI,fK);}),"listOfInitialAssignments",fD.listOfInitialAssignments);bl.xml_of_elmtlist(fB,fC+1,(fJ=fC+2,function(fK){bl.xml_of_reaction(fB,fJ,fK);}),"listOfReactions",fD.listOfReactions);dl.append(fB,bl.tagclose(fC,"model"));dl.append(fB,bl.newline());};bl.postamble=function(){dT.$cctor();return dT.postamble;};bl.tagopen=function(fB,fC,fD){return bl.indent(fB,"<"+fC+bl.string_of_params(fD)+">");};bl.oMap=function(fB,fC){return fC!=null&&fC.$==1?{$:1,$0:fB(fC.$0)}:null;};bl.string_of_SId=function(fB){return fB.$0;};bl.string_of_SBMLString=function(fB){return fB.$0;};bl.newline=function(){dT.$cctor();return dT.newline;};bl.xml_of_elmtlist=function(fB,fC,fD,fE,fF){if(fF.$==0);else{dl.append(fB,bl.tagopen(fC,fE,B.Empty));dl.append(fB,bl.newline());A.iter(function(fG){fD(fG);dl.append(fB,bl.newline());},fF);dl.append(fB,bl.tagclose(fC,fE));dl.append(fB,bl.newline());}};bl.xml_of_unitDefinition=function(fB,fC,fD){var fE;dl.append(fB,bl.tagopen(fC,"unitDefinition",A.ofArray([["id",{$:1,$0:bl.string_of_UnitSId(fD.id)}],["name",bl.oMap(bl.string_of_SBMLString,fD.name)]])));dl.append(fB,bl.newline());bl.xml_of_elmtlist(fB,fC+1,(fE=fC+2,function(fF){bl.xml_of_sbmlUnit(fB,fE,fF);}),"listOfUnits",fD.listOfUnits);dl.append(fB,bl.tagclose(fC,"unitDefinition"));};bl.xml_of_compartment=function(fB,fC,fD){dl.append(fB,bl.tagsingle(fC,"compartment",A.ofArray([["id",{$:1,$0:bl.string_of_SId(fD.id)}],["name",bl.oMap(bl.string_of_SBMLString,fD.name)],["compartmentType",bl.oMap(bl.string_of_SId,fD.compartmentType)],["spatialDimensions",bl.oMap(a.String,fD.spatialDimensions)],["size",bl.oMap(a.String,fD.size)],["units",bl.oMap(bl.string_of_UnitSId,fD.units)],["outside",bl.oMap(bl.string_of_SId,fD.outside)],["constant",bl.oMap(bl.string_of_bool,fD.constant)]])));};bl.xml_of_species=function(fB,fC,fD){dl.append(fB,bl.tagsingle(fC,"species",A.ofArray([["id",{$:1,$0:bl.string_of_SId(fD.id)}],["name",bl.oMap(bl.string_of_SBMLString,fD.name)],["speciesType",bl.oMap(bl.string_of_SId,fD.speciesType)],["compartment",{$:1,$0:bl.string_of_SId(fD.compartment)}],["initialAmount",bl.oMap(a.String,fD.initialAmount)],["initialConcentration",bl.oMap(a.String,fD.initialConcentration)],["substanceUnits",bl.oMap(bl.string_of_UnitSId,fD.substanceUnits)],["hasOnlySubstanceUnits",bl.oMap(bl.string_of_bool,fD.hasOnlySubstanceUnits)],["boundaryCondition",bl.oMap(bl.string_of_bool,fD.boundaryCondition)],["charge",bl.oMap(a.String,fD.charge)],["constant",bl.oMap(bl.string_of_bool,fD.constant)]])));};bl.xml_of_parameter=function(fB,fC,fD){dl.append(fB,bl.tagsingle(fC,"parameter",A.ofArray([["id",{$:1,$0:bl.string_of_SId(fD.id)}],["name",bl.oMap(bl.string_of_SBMLString,fD.name)],["value",bl.oMap(a.String,fD.value)],["units",bl.oMap(bl.string_of_UnitSId,fD.units)],["constant",bl.oMap(bl.string_of_bool,fD.constant)]])));};bl.xml_of_initialAssignment=function(fB,fC,fD){dl.append(fB,bl.tagopen(fC,"initialAssignment",A.ofArray([["symbol",{$:1,$0:bl.string_of_SId(fD.symbol)}]])));dl.append(fB,bl.newline());bl.xml_of_MathML(fB,fC+1,fD.math);dl.append(fB,bl.newline());dl.append(fB,bl.tagclose(fC,"initialAssignment"));};bl.xml_of_reaction=function(fB,fC,fD){var fE,fF,fG;dl.append(fB,bl.tagopen(fC,"reaction",A.ofArray([["id",{$:1,$0:bl.string_of_SId(fD.id)}],["name",bl.oMap(bl.string_of_SBMLString,fD.name)],["reversible",bl.oMap(bl.string_of_bool,fD.reversible)],["fast",bl.oMap(bl.string_of_bool,fD.fast)]])));dl.append(fB,bl.newline());bl.xml_of_elmtlist(fB,fC+1,(fE=fC+2,function(fH){bl.xml_of_speciesReference(fB,fE,fH);}),"listOfReactants",fD.listOfReactants);bl.xml_of_elmtlist(fB,fC+1,(fF=fC+2,function(fH){bl.xml_of_speciesReference(fB,fF,fH);}),"listOfProducts",fD.listOfProducts);fG=fD.kineticLaw;fG!=null&&fG.$==1?(bl.xml_of_kineticLaw(fB,fC+1,fG.$0),dl.append(fB,bl.newline())):void 0;dl.append(fB,bl.tagclose(fC,"reaction"));};bl.tagclose=function(fB,fC){return bl.indent(fB,"</"+fC+">");};bl.mkSId=function(fB){bl.testId(fB);return{$:0,$0:fB};};bl.mkString=function(fB){return{$:0,$0:bl.stringMap(function(fC){return fC==="<"?bl.openAngle():fC===">"?bl.closeAngle():fC;},fB)};};bl.mkUnitSId=function(fB){bl.testId(fB);return{$:0,$0:fB};};bl.create_sbmlUnit=function(fB){return eB.New(fB,null,null,null,null);};bl.u_set_scale=function(fB,fC){return eB.New(fC.kind,fC.exponent,{$:1,$0:fB},fC.multiplier,fC.offset);};bl.create_parameter=function(fB){return ey.New(fB,null,null,null,null);};bl.p_set_value=function(fB,fC){return ey.New(fC.id,fC.name,{$:1,$0:fB},fC.units,fC.constant);};bl.p_set_units=function(fB,fC){return ey.New(fC.id,fC.name,fC.value,{$:1,$0:fB},fC.constant);};bl.create_speciesReference=function(fB){return eC.New(null,null,fB,null);};bl.sr_set_stoichiometry=function(fB,fC){return eC.New(fC.id,fC.name,fC.species,{$:1,$0:fB});};bl.empty_model=function(){dT.$cctor();return dT.empty_model;};bl.model_add_compartment=function(fB,fC){return dU.New(fC.id,fC.name,fC.listOfUnitDefinitions,A.append(fC.listOfCompartments,A.ofArray([fB])),fC.listOfSpecies,fC.listOfParameters,fC.listOfInitialAssignments,fC.listOfReactions);};bl.model_set_species=function(fB,fC){return dU.New(fC.id,fC.name,fC.listOfUnitDefinitions,fC.listOfCompartments,fB,fC.listOfParameters,fC.listOfInitialAssignments,fC.listOfReactions);};bl.model_set_reactions=function(fB,fC){return dU.New(fC.id,fC.name,fC.listOfUnitDefinitions,fC.listOfCompartments,fC.listOfSpecies,fC.listOfParameters,fC.listOfInitialAssignments,fB);};bl.create_reaction=function(fB){return eA.New(fB,null,null,null,B.Empty,B.Empty,null);};bl.r_set_reactants=function(fB,fC){return eA.New(fC.id,fC.name,fC.reversible,fC.fast,fB,fC.listOfProducts,fC.kineticLaw);};bl.r_set_products=function(fB,fC){return eA.New(fC.id,fC.name,fC.reversible,fC.fast,fC.listOfReactants,fB,fC.kineticLaw);};bl.r_set_reversible=function(fB,fC){return eA.New(fC.id,fC.name,{$:1,$0:fB},fC.fast,fC.listOfReactants,fC.listOfProducts,fC.kineticLaw);};bl.r_set_kineticLaw=function(fB,fC){return eA.New(fC.id,fC.name,fC.reversible,fC.fast,fC.listOfReactants,fC.listOfProducts,{$:1,$0:fB});};bl.create_kineticLaw=function(fB){return eD.New(fB,B.Empty);};bl.kl_add_parameter=function(fB,fC){return eD.New(fC.math,A.append(fC.listOfParameters,A.ofArray([fB])));};bl.create_species=function(fB,fC){return ex.New(fB,null,null,fC,null,null,null,null,null,null,null);};bl.sp_set_name=function(fB,fC){return ex.New(fC.id,{$:1,$0:fB},fC.speciesType,fC.compartment,fC.initialAmount,fC.initialConcentration,fC.substanceUnits,fC.hasOnlySubstanceUnits,fC.boundaryCondition,fC.charge,fC.constant);};bl.sp_set_initialConcentration=function(fB,fC){return ex.New(fC.id,fC.name,fC.speciesType,fC.compartment,fC.initialAmount,{$:1,$0:fB},fC.substanceUnits,fC.hasOnlySubstanceUnits,fC.boundaryCondition,fC.charge,fC.constant);};bl.sp_set_constant=function(fB,fC){return ex.New(fC.id,fC.name,fC.speciesType,fC.compartment,fC.initialAmount,fC.initialConcentration,fC.substanceUnits,fC.hasOnlySubstanceUnits,fC.boundaryCondition,fC.charge,{$:1,$0:fB});};bl.sp_set_boundaryCondition=function(fB,fC){return ex.New(fC.id,fC.name,fC.speciesType,fC.compartment,fC.initialAmount,fC.initialConcentration,fC.substanceUnits,fC.hasOnlySubstanceUnits,{$:1,$0:fB},fC.charge,fC.constant);};bl.model_add_initialAssignment=function(fB,fC){return dU.New(fC.id,fC.name,fC.listOfUnitDefinitions,fC.listOfCompartments,fC.listOfSpecies,fC.listOfParameters,A.append(fC.listOfInitialAssignments,A.ofArray([fB])),fC.listOfReactions);};bl.create_initialAssignment=function(fB,fC){return ez.New(fB,fC);};bl.model_add_parameter=function(fB,fC){return dU.New(fC.id,fC.name,fC.listOfUnitDefinitions,fC.listOfCompartments,fC.listOfSpecies,A.append(fC.listOfParameters,A.ofArray([fB])),fC.listOfInitialAssignments,fC.listOfReactions);};bl.create_compartment=function(fB){return ew.New(fB,null,null,null,null,null,null,null);};bl.cmt_set_size=function(fB,fC){return ew.New(fC.id,fC.name,fC.compartmentType,fC.spatialDimensions,{$:1,$0:fB},fC.units,fC.outside,fC.constant);};bl.model_add_unitDefinition=function(fB,fC){return dU.New(fC.id,fC.name,A.append(fC.listOfUnitDefinitions,A.ofArray([fB])),fC.listOfCompartments,fC.listOfSpecies,fC.listOfParameters,fC.listOfInitialAssignments,fC.listOfReactions);};bl.create_unitDefinition=function(fB,fC){return ev.New(fB,null,fC);};bl.u_set_exponent=function(fB,fC){return eB.New(fC.kind,{$:1,$0:fB},fC.scale,fC.multiplier,fC.offset);};bl.u_set_multiplier=function(fB,fC){return eB.New(fC.kind,fC.exponent,fC.scale,{$:1,$0:fB},fC.offset);};bl.space=function(){dT.$cctor();return dT.space;};bl.xmltag=function(fB){return"<?xml"+bl.string_of_params(fB)+"?>";};bl.indent=function(fB,fC){function fD(fE){return fE===0?fC:bl.indent_string()+fD(fE-1);}return fB<0?F.FailWith("Sbml.indent: negative indentation"):fD(fB);};bl.string_of_params=function(fB){function fC(fD,fE){return fE!=null&&fE.$==1?bl.space()+fD+bl.equals()+bl.quote(fE.$0):bl.empty();}return fB.$==0?bl.empty():A.reduce(function(fD,fE){return fD+bl.empty()+fE;},A.map(function(fD){return fC(fD[0],fD[1]);},fB));};bl.string_of_UnitSId=function(fB){return fB.$0;};bl.xml_of_sbmlUnit=function(fB,fC,fD){dl.append(fB,bl.tagsingle(fC,"unit",A.ofArray([["kind",{$:1,$0:bl.string_of_unitKind(fD.kind)}],["exponent",bl.oMap(a.String,fD.exponent)],["scale",bl.oMap(a.String,fD.scale)],["multiplier",bl.oMap(a.String,fD.multiplier)],["offset",bl.oMap(a.String,fD.offset)]])));};bl.tagsingle=function(fB,fC,fD){return bl.indent(fB,"<"+fC+bl.string_of_params(fD)+"/>");};bl.string_of_bool=function(fB){return fB?"true":"false";};bl.xml_of_MathML=function(fB,fC,fD){dl.append(fB,bl.tagopen(fC,"math",A.ofArray([["xmlns",{$:1,$0:"http://www.w3.org/1998/Math/MathML"}]])));dl.append(fB,bl.newline());bl.xml_of_mathExpr(fB,fC+1,fD);dl.append(fB,bl.newline());dl.append(fB,bl.tagclose(fC,"math"));};bl.xml_of_speciesReference=function(fB,fC,fD){dl.append(fB,bl.tagsingle(fC,"speciesReference",A.ofArray([["id",bl.oMap(bl.string_of_SId,fD.id)],["name",bl.oMap(bl.string_of_SBMLString,fD.name)],["species",{$:1,$0:bl.string_of_SId(fD.species)}],["stoichiometry",bl.oMap(a.String,fD.stoichiometry)]])));};bl.xml_of_kineticLaw=function(fB,fC,fD){var fE;dl.append(fB,bl.tagopen(fC,"kineticLaw",B.Empty));dl.append(fB,bl.newline());bl.xml_of_MathML(fB,fC+1,fD.math);dl.append(fB,bl.newline());bl.xml_of_elmtlist(fB,fC+1,(fE=fC+2,function(fF){bl.xml_of_parameter(fB,fE,fF);}),"listOfParameters",fD.listOfParameters);dl.append(fB,bl.tagclose(fC,"kineticLaw"));};bl.testId=function(fB){bl.stringIteri(function(fC,fD){if(fC===0){if(!(bl.isLetter(fD)||bl.isUnderscore(fD)))throw e4.New(fB);else return null;}else if(!(bl.isLetter(fD)||bl.isUnderscore(fD)||bl.isDigit(fD)))throw e4.New(fB);else return null;},fB);};bl.stringMap=function(fB,fC){var fD;fD=[""];dk.iter(function(fE){fD[0]=fD[0]+fB(fE);},fC);return fD[0];};bl.openAngle=function(){dT.$cctor();return dT.openAngle;};bl.closeAngle=function(){dT.$cctor();return dT.closeAngle;};bl.indent_string=function(){dT.$cctor();return dT.indent_string;};bl.empty=function(){dT.$cctor();return dT.empty;};bl.equals=function(){dT.$cctor();return dT.equals;};bl.quote=function(fB){return bl.quotemark()+fB+bl.quotemark();};bl.string_of_unitKind=function(fB){return fB.$==1?"becqerel":fB.$==2?"candela":fB.$==3?"coulomb":fB.$==4?"dimensionless":fB.$==5?"farad":fB.$==6?"gram":fB.$==7?"gray":fB.$==8?"henry":fB.$==9?"hertz":fB.$==10?"item":fB.$==11?"joule":fB.$==12?"katal":fB.$==13?"kelvin":fB.$==14?"kilogram":fB.$==15?"litre":fB.$==16?"lumen":fB.$==17?"lux":fB.$==18?"metre":fB.$==19?"mole":fB.$==20?"newton":fB.$==21?"ohm":fB.$==22?"pascal":fB.$==23?"radian":fB.$==24?"second":fB.$==25?"siemens":fB.$==26?"sievert":fB.$==27?"steradians":fB.$==28?"tesla":fB.$==29?"volt":fB.$==30?"watt":fB.$==31?"weber":"ampere";};bl.xml_of_mathExpr=function(fB,fC,fD){var fE,fF,fG,fH;if(fD.$==1){dl.append(fB,bl.tagopen(fC,"apply",B.Empty));dl.append(fB,bl.newline());dl.append(fB,bl.tagsimple(fC+1,bl.string_of_bOp(fD.$0)));dl.append(fB,bl.newline());bl.xml_of_mathExpr(fB,fC+1,fD.$1);dl.append(fB,bl.newline());bl.xml_of_mathExpr(fB,fC+1,fD.$2);dl.append(fB,bl.newline());dl.append(fB,bl.tagclose(fC,"apply"));}else if(fD.$==2){dl.append(fB,bl.tagopen(fC,"apply",B.Empty));dl.append(fB,bl.newline());dl.append(fB,bl.tagsimple(fC+1,bl.string_of_nOp(fD.$0)));dl.append(fB,bl.newline());A.iter(function(fI){bl.xml_of_mathExpr(fB,fC+1,fI);dl.append(fB,bl.newline());},fD.$1);dl.append(fB,bl.tagclose(fC,"apply"));}else if(fD.$==3){fE=fD.$1;fF=fD.$0;fG=fE!=null&&fE.$==1?A.ofArray([["units",{$:1,$0:bl.string_of_UnitSId(fE.$0)}]]):B.Empty;fF.$==1?(dl.append(fB,bl.tagopen(fC,"cn",new B({$:1,$0:["type",{$:1,$0:"real"}],$1:fG}))),dl.append(fB,a.String(fF.$0)),dl.append(fB,bl.tagclose(0,"cn"))):fF.$==2?dl.append(fB,bl.tagsimple(fC,bl.string_of_bool(fF.$0))):fF.$==3?dl.append(fB,bl.tagsimple(fC,"notanumber")):fF.$==4?dl.append(fB,bl.tagsimple(fC,"pi")):fF.$==5?dl.append(fB,bl.tagsimple(fC,"infinity")):fF.$==6?dl.append(fB,bl.tagsimple(fC,"exponentiale")):(dl.append(fB,bl.tagopen(fC,"cn",new B({$:1,$0:["type",{$:1,$0:"integer"}],$1:fG}))),dl.append(fB,a.String(fF.$0)),dl.append(fB,bl.tagclose(0,"cn")));}else if(fD.$==4){dl.append(fB,bl.tagopen(fC,"ci",B.Empty));dl.append(fB,bl.string_of_SId(fD.$0));dl.append(fB,bl.tagclose(0,"ci"));}else{fH=fD.$0;(function(fI){var fJ,fK,fL,fM;while(true){if(fI.$==30){if(fJ=fI.$0,fJ!=null&&fJ.$==1){fK=fI.$0.$0;dl.append(fB,bl.tagopen(fC,bl.string_of_uOp(fH),B.Empty));dl.append(fB,bl.newline());return bl.xml_of_qualifier(fB,fC+1,{$:0,$0:fK});}else fI={$:30,$0:{$:1,$0:{$:3,$0:{$:0,$0:2},$1:null}}};}else if(fI.$==31){if(fL=fI.$0,fL!=null&&fL.$==1){fM=fI.$0.$0;dl.append(fB,bl.tagopen(fC,bl.string_of_uOp(fH),B.Empty));dl.append(fB,bl.newline());return bl.xml_of_qualifier(fB,fC+1,{$:1,$0:fM});}else fI={$:31,$0:{$:1,$0:{$:3,$0:{$:0,$0:10},$1:null}}};}else return dl.append(fB,bl.tagopen(fC,bl.string_of_uOp(fI),B.Empty));}}(fH));dl.append(fB,bl.newline());bl.xml_of_mathExpr(fB,fC+1,fD.$1);dl.append(fB,bl.tagclose(fC,bl.string_of_uOp(fH)));dl.append(fB,bl.newline());}};bl.stringIteri=function(fB,fC){var fD,fE;for(fD=0,fE=dk.length(fC)-1;fD<=fE;fD++)fB(fD,fC[fD]);};bl.isLetter=function(fB){return"a"<=fB&&fB<="z"||"A"<=fB&&fB<="Z";};bl.isUnderscore=function(fB){return fB==="_";};bl.isDigit=function(fB){return"0"<=fB&&fB<="9";};bl.quotemark=function(){dT.$cctor();return dT.quotemark;};bl.tagsimple=function(fB,fC){return bl.tagsingle(fB,fC,B.Empty);};bl.string_of_bOp=function(fB){return fB.$==1?"divide":fB.$==2?"power":fB.$==3?"minus":fB.$==4?"max":fB.$==5?"mod":"neq";};bl.string_of_nOp=function(fB){return fB.$==1?"or":fB.$==2?"xor":fB.$==3?"plus":fB.$==4?"times":fB.$==5?"eq":fB.$==6?"leq":fB.$==7?"lt":fB.$==8?"geq":fB.$==9?"gt":"and";};bl.string_of_uOp=function(fB){return fB.$==1?"minus":fB.$==2?"abs":fB.$==3?"exp":fB.$==4?"ln":fB.$==5?"floor":fB.$==32?"ceiling":fB.$==33?"factorial":fB.$==30?"root":fB.$==31?"log":fB.$==6?"sin":fB.$==7?"cos":fB.$==8?"tan":fB.$==9?"sec":fB.$==10?"csc":fB.$==11?"cot":fB.$==12?"arcsin":fB.$==13?"arccos":fB.$==14?"arctan":fB.$==15?"arcsec":fB.$==16?"arccsc":fB.$==17?"arccot":fB.$==18?"sinh":fB.$==19?"cosh":fB.$==20?"tanh":fB.$==21?"sech":fB.$==22?"csch":fB.$==23?"coth":fB.$==24?"arcsinh":fB.$==25?"arccosh":fB.$==26?"arctanh":fB.$==27?"arcsech":fB.$==28?"arccsch":fB.$==29?"arccoth":"not";};bl.xml_of_qualifier=function(fB,fC,fD){var fE,fF;if(fD.$==1){fE="logbase";dl.append(fB,bl.tagopen(fC,fE,B.Empty));dl.append(fB,bl.newline());bl.xml_of_mathExpr(fB,fC+1,fD.$0);dl.append(fB,bl.newline());dl.append(fB,bl.tagclose(fC,fE));}else{fF="degree";dl.append(fB,bl.tagopen(fC,fF,B.Empty));dl.append(fB,bl.newline());bl.xml_of_mathExpr(fB,fC+1,fD.$0);dl.append(fB,bl.newline());dl.append(fB,bl.tagclose(fC,fF));}};bo.New=function(fB,fC,fD,fE){return{values:fB,logLikelihood:fC,logPrior:fD,iteration:fE};};bq=bp.AssociativeArray=fu.Class({Item:function(fB){return U.get(this.objects,this.map.Item(fB));},get_Names:function(){return this.map.get_Keys();},ToArray:function(){return U.ofSeq(this.objects);},get__dataArray:function(){return this.objects;},Item$1:function(fB){return U.get(this.objects,fB);},get__namesMap:function(){return this.map;},ToMap:function(){return K.OfArray(U.zip(this.get_Names(),this.ToArray()));},CopyWithNewValues:function(fB){return new bq.New(this.map,fB);}},w,bq);bq.ofSeq=function(fB){return bq.ofArray(U.ofSeq(fB));};bq.ofArray=function(fB){var fC,fD;fC=U.length(fB);fD=U.init(fC,function(fE){return U.get(fB,fE).get_Data();});return new bq.New(new dm.New(U.init(fC,function(fE){return U.get(fB,fE).get_Name();})),fD);};bq.New=fu.Ctor(function(fB,fC){w.New.call(this);this.map=fB;this.objects=fC;},bq);br.New=function(fB,fC,fD){return{pType:fB,lb:fC,ub:fD};};bs.New=function(fB,fC){return{accepted:fB,altered:fC};};bt.group_sweeps=function(fB){return A.map(function(fC){return A.length(fC)>1?A.map(bt.append_sweepstr_columns,fC):fC;},function(fC,fD){var fE,fF,fG;while(true)if(fD.$==1){fE=fD.$1;fF=fD.$0;fG=A.partition(function(fH){return function(fI){return bt.same_sweep(fH,fI);};}(fF),fE);fC=new B({$:1,$0:new B({$:1,$0:fF,$1:fG[0]}),$1:fC});fD=fG[1];}else return A.rev(fC);}(B.Empty,fB));};bt.append_sweepstr_columns=function(fB){var fC;fC=di.to_string(fB.instance.environment);return bt.New(fB.instance,Z.New(fB.table.times,A.map(function(fD){return bE.New((((fu.Curried3(function(fE,fF,fG){return fE(_2.toSafe(fF)+" ("+_2.toSafe(fG)+")");}))(a.id))(fD.name))(fC),fD.values);},fB.table.columns)));};bt.same_sweep=function(fB,fC){return C.same_sweep(fB.instance,fC.instance);};bt.to_table=function(fB){return fB.table;};bt.create=function(fB,fC){return bt.New(fB,fC);};bt.New=function(fB,fC){return{instance:fB,table:fC};};bv.New=function(fB,fC,fD,fE){return{iteration:fB,state:fC,mlesims:fD,summary:fE};};bx.New=function(fB,fC,fD,fE,fF,fG,fH,fI,fJ,fK,fL){return{space:fB,state:fC,thinningSkippedCount:fD,chain:fE,burnin:fF,randGen:fG,innovationGens:fH,mle:fI,priors:fJ,indexes:fK,accepted:fL};};by.New=function(fB,fC,fD,fE,fF,fG,fH,fI,fJ,fK){return{space:fB,state:fC,thinningSkippedCount:fD,chain:fE,stats:fF,randGen:fG,innovationGens:fH,mle:fI,priors:fJ,indexes:fK};};bz.structured_tabbed=function(fB,fC,fD){return bz.arbitrary_tabbed(fB,bz.to_tab_items(fC,fD));};bz.structured_tabbed_embedded=function(fB,fC){return bz.make_embedded(bz.arbitrary_tabbed_content(fB,bz.to_tab_items(fB,fC)));};bz.arbitrary_tabbed=function(fB,fC){return bz.make_page(fB,bz.arbitrary_tabbed_content("top_tabs",fC));};bz.arbitrary_tabbed_content=function(fB,fC){var fD,fE;function fF(fG,fH){return(((((fu.Curried(function(fI,fJ,fK,fL,fM){return fI("<div id=\\""+_2.toSafe(fJ)+_2.toSafe(fK)+"\\" class=\\"tabcontent cliplot "+_2.toSafe(fL)+"\\">\\n\\u0009"+_2.toSafe(fM)+"\\n</div>");},5))(a.id))(fB))(bz.to_identifier(fG)))(fB))(fH);}fD="<ul class=\\"tab cliplot\\">"+dk.concat("\\n",A.mapi(function(fG,fH){var fI;fI=fH[0];return((((((fu.Curried(function(fJ,fK,fL,fM,fN,fO){return fJ("\\u0009<li class=\\"cliplot\\"><a href=\\"javascript:void(0)\\" class=\\"tablinks cliplot "+_2.toSafe(fK)+"\\" onclick=\\"openTab(event, \'"+_2.toSafe(fL)+"\', \'"+_2.toSafe(fM)+"\')\\""+_2.toSafe(fN)+">"+_2.toSafe(fO)+"</a></li>");},6))(a.id))(fB))(fB))(bz.to_identifier(fI)))(fG===0?" id=\\"cliplot_defaultOpen\\"":""))(fI);},fC))+"\\n</ul>";fE=dk.concat("\\n",A.map(function(fG){return fF(fG[0],fG[1]);},fC));return(((fu.Curried3(function(fG,fH,fI){return fG(_2.toSafe(fH)+" "+_2.toSafe(fI));}))(a.id))(fD))(fE);};bz.make_embedded=function(fB){return((((fu.Curried(function(fC,fD,fE,fF){return fC("<div class=\\"cliplot\\">"+_2.toSafe(fD)+" "+_2.toSafe(fE)+" "+_2.toSafe(fF)+"</div>");},4))(a.id))(bz.local_styles()))(fB))(bz.unified_scripts());};bz.to_tab_items=function(fB,fC){var fD,fE,fF;fD="<ul class=\\"tab tab2 cliplot\\">\\n\\u0009"+dk.concat("\\n",A.init(fC.comparisons.get_Length(),function(fG){return(((((fu.Curried(function(fH,fI,fJ,fK,fL){return fH("\\u0009\\u0009<li><a href=\\"javascript:void(0)\\" class=\\"complinks cliplot "+_2.toSafe(fI)+"\\" onclick=\\"openComparison(event, \'"+_2.toSafe(fJ)+"\', \'cliplot_comparison_"+a.String(fK)+"\')\\">Comparison "+a.String(fL)+"</a></li>");},5))(a.id))(fB))(fB))(fG+1))(fG+1);}))+"\\n\\u0009</ul>";fE=((fu.Curried(function(fG,fH,fI,fJ,fK){return fG("\\u0009<div id=\\""+_2.toSafe(fH)+"cliplot_comparison_"+a.String(fI)+"\\" class=\\"compcontent cliplot "+_2.toSafe(fJ)+"\\">\\n\\u0009\\u0009"+_2.toSafe(fK)+"\\n</div>");},5))(a.id))(fB);fF=dk.concat("\\n",A.mapi(function(fG,fH){return((fE(fG+1))(fB))(fH[1]);},fC.comparisons));return A.append(A.ofArray([["Model",fC.model],["Comparisons",(((fu.Curried3(function(fG,fH,fI){return fG(_2.toSafe(fH)+"\\n"+_2.toSafe(fI));}))(a.id))(fD))(fF)],["Posterior marginals",fC.posterior],["Correlation",fC.correlation],["MCMC traces",fC.traces],["Parameter summary",fC.psummary]]),fC.variations);};bz.make_page=function(fB,fC){return(((((fu.Curried(function(fD,fE,fF,fG,fH){return fD("<!DOCTYPE html><html>"+_2.toSafe(fE)+" "+_2.toSafe(fF)+"<body><h2 class=\\"cliplot\\">"+_2.toSafe(fG)+"</h2>"+_2.toSafe(fH)+"</body></html>");},5))(a.id))(bz.page_header_scripts()))(bz.local_styles()))(fB))(fC);};bz.to_identifier=function(fB){return(function(fC){return function(fD){return fC("cliplot_"+_2.toSafe(fD));};}(a.id))(dk.map(function(fC){return dZ.IsLetterOrDigit(fC)?fC:"_";},fB));};bz.local_styles=function(){d0.$cctor();return d0.local_styles;};bz.unified_scripts=function(){d0.$cctor();return d0.unified_scripts;};bz.plot_comparisons=function(fB,fC,fD,fE,fF){function fG(fH,fI){var fJ,fK;fJ=A.mapi(function(fL){return fH.instance.settings.plotcolours.get_Length()>fL?bz.colour_of_string(0.6,fH.instance.settings.plotcolours.get_Item(fL)):[d9.Grey(),d9.Black()];},fH.table.columns);return d8.setVisibleRegion({$:0,$0:0},d8.setTitle(U.head(dk.SplitChars(A.head(fI.columns).name,["("],0)),d8.setYlabel(fF,d8.setXlabel(fE,(fK=A.zip3(fH.table.columns,fI.columns,fJ),bc.fold(function(fL,fM){var fN,fO;fN=fM[2];fO=bz.plot_comparison(fH.table.times,fM[0],fI.times,fM[1],fN[0],fN[1],fD);return d8.addMarkers(fO[0],d8.addPolyline(fO[1],fL));},d8.Empty(),fK))))));}return(((fu.Curried3(A.map2))(fG))(fB))(fC);};bz.plot_correlation=function(fB,fC){var fD,fE,fF,fG,fH,fI,fJ,fK;fD=A.length(fC);fE=U.mapi(function(fL,fM){return U.mapi(function(fN,fO){return fL<=fN?a.NaN:fO;},fM);},fB);fF=ec.init(fD,fD,function(fL,fM){return U.get(U.get(fE,fD-fM-1),fL);});fG=A.ofArray([[-1,"#0000AA"],[-0.8,"#2222AA"],[-0.6,"#4444AA"],[-0.4,"#6666AA"],[-0.2,"#8888AA"],[0,"#AAAAAA"],[0.2,"#AA8888"],[0.4,"#AA6666"],[0.6,"#AA4444"],[0.8,"#AA2222"],[1,"#AA0000"]]);fH={$:0,$0:dk.Join(",",U.ofSeq(A.mapi(function(fL,fM){var fN,fO;fN=fM[0];fO=fM[1];return fL===0?(((fu.Curried3(function(fP,fQ,fR){return fP(fQ.toFixed(6)+"="+_2.toSafe(fR));}))(a.id))(fN))(fO):fL===A.length(fG)-1?(((fu.Curried3(function(fP,fQ,fR){return fP(_2.toSafe(fQ)+"="+fR.toFixed(6));}))(a.id))(fO))(fN):((((fu.Curried(function(fP,fQ,fR,fS){return fP(_2.toSafe(fQ)+"="+fR.toFixed(6)+"="+_2.toSafe(fS));},4))(a.id))(fO))(fN))(fO);},fG)))};fI=U.init(fD+1,a.id);fJ=U.init(fD+1,a.id);fK=d8.createLabelledAxis(fJ,A.rev(fC));return d8.addHeatmap(eb.setName(null,eb.setPalette(fH,eb.createHeatmap(fI,fI,fF))),d_.New(fD*25+50+30+60,fD*25+30+50,"Correlation in the joint posterior samples",d8.Empty().Xlabel,d8.createTiltedLabelledAxis(fJ,fC,90),d8.Empty().Ylabel,fK,d8.Empty().GridLines,d8.Empty().Plots,d$.Visible,d8.Empty().IsNavigationEnabled,false,{$:0,$0:0},d8.Empty().TooltipDelay));};bz.plot_variation=function(fB,fC,fD){var fE,fF,fG;function fH(fJ,fK){return fK.get_Length();}function fI(fJ,fK){return function(fL){var fM,fN,fO,fP,fQ,fR;fM=fL[1];fN=fM.get_Length();fO=A.unzip(A.sortBy(function(fS){return fS[0];},A.map2(function(fS,fT){return[fS,U.average(fB.get_Item(fT))];},fM,fD.GetSlice({$:1,$0:fJ},{$:1,$0:fJ+fN-1}))));fP=fO[1];fQ=U.init(fP.get_Length(),function(fS){return fS+1;});return[fJ+fN,new B({$:1,$0:d8.setVisibleRegion({$:0,$0:0},d8.setYlabel("Parameter value",d8.setTitle(fL[0],(fR=d8.addMarkers(ed.setShape(ee.Circle,ed.createMarkers(fQ,fP)),d8.Empty()),d8.setXaxis(d8.setLabelsVisibility(true,d8.createTiltedLabelledAxis(fQ,fO[0],90)),fR))))),$1:fK})];};}fE=(fF=120+25*A.max(A.map(function(fJ){return fH(fJ[0],fJ[1]);},fC)),(fG=400,bk.Compare(fF,fG)===1?fF:fG));return[(bc.fold(function(fJ,fK){return(function(fL){return fI(fL[0],fL[1]);}(fJ))(fK);},[0,B.Empty],fC))[1],fE];};bz.plot_trace=function(fB,fC,fD){return d8.setVisibleRegion({$:0,$0:1},d8.setTitle(fD,d8.setYlabel("Parameter values",d8.setXlabel("Sample",d8.addPolyline(ef.setThickness(2,ef.createPolyline(U.ofSeq(fB),U.ofSeq(fC))),d8.Empty())))));};bz.plot_marginal=function(fB,fC,fD){return d8.setVisibleRegion({$:0,$0:0},d8.setTitle(fC,d8.setYlabel("Frequency",d8.setXlabel(fD?"Log10(value)":"value",d8.addHistogram(eg.setBinCount(30,eg.createHistogram(fD?U.map(function(fE){return fv.log(fE)/fv.log(10);},fB):fB)),d8.Empty())))));};bz.page_header_scripts=function(){d0.$cctor();return d0.page_header_scripts;};bz.plot_comparison=function(fB,fC,fD,fE,fF,fG,fH){var fI,fJ;function fK(fM,fN){return fM<fJ;}function fL(fM,fN){return fM<fJ;}fI=fH==null?[[fD,fE.values],[fB,fC.values]]:(fJ=fH.$0,[A.unzip(A.filter(function(fM){return fK(fM[0],fM[1]);},A.zip(fD,fE.values))),A.unzip(A.filter(function(fM){return fL(fM[0],fM[1]);},A.zip(fB,fC.values)))]);return[ed.setSize(3,ed.setFillColour(fG,ed.createMarkers(U.ofList(fI[0][0]),U.ofList(fI[0][1])))),ef.setThickness(2,ef.setStrokeColour(fF,ef.createPolyline(U.ofList(fI[1][0]),U.ofList(fI[1][1]))))];};bz.colour_of_string=function(fB,fC){var fD,fE;fD=d9.parse(fC);return fD==null?[d9.Gray(),d9.Black()]:(fE=fD.$0,[fE,bz.darken_colour(fB,fE)]);};bz.activate_idd_script=function(){d0.$cctor();return d0.activate_idd_script;};bz.cdn_scripts=function(){d0.$cctor();return d0.cdn_scripts;};bz.prepare_idd_script=function(){d0.$cctor();return d0.prepare_idd_script;};bz.footer_scripts_idd=function(){d0.$cctor();return d0.footer_scripts_idd;};bz.darken_colour=function(fB,fC){function fD(fE){return F.toInt(fE*fB)%256;}return fC.$==0?fC:{$:1,$0:e9.New(fD(fC.$0.R),fD(fC.$0.G),fD(fC.$0.B))};};bA=bu.mcmc_result=fu.Class({to_summary:function(){return dy.New(this.summary,bc.fold(function(fB,fC){return fB.Add(fC.name,fC);},K.Map(function(fB,fC){var fD;fD=dr.get_defaults();return dr.New(fB,fC,fC,fD.variance,fD.median,fD.lb,fD.ub,fD.l68,fD.u68,fD.l95,fD.u95,fD.ptype);},this.pfixed),this.parameters));}},null,bA);bA.New=function(fB,fC,fD,fE,fF,fG,fH,fI){return new bA({parameters:fB,posterior:fC,burnin:fD,pfixed:fE,mle:fF,mlesims:fG,postsims:fH,summary:fI});};bB.mcmc_to_results=function(fB,fC,fD){var fE,fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO,fP;function fQ(fT,fU){var fV;fV=bc.find(function(fW){return fW.name===A.head(fT).instance.model;},fG).settings;return du.New(fT,fU.data,fU.file,fV.plot.x_label,fV.plot.y_label);}function fR(fT){return fT[1];}function fS(fT,fU){return fU.get_Length()===fO;}fE=K.Map(function(fT){return U.ofList(A.map(function(fU){return fU.get_Item(fT);},fD.posterior));},A.head(fD.posterior));fF=c_.correlation_pearson(U.ofList(A.map(function(fT){return fE.get_Item(fT);},A.map(function(fT){return fT.name;},fD.parameters))));fG=new B({$:1,$0:fC.top,$1:fC.systems});fH=A.collect(function(fT){return fT.settings.data;},fG);fI=A.collect(function(fT){return A.collect(function(fU){return fU.data;},fT.settings.simulations);},fG);fJ=fI.$===0?fH:A.map(function(fT){return bc.find(function(fU){return fU.file===fT;},fH);},fI);fK=bt.group_sweeps(fD.mlesims);fL=fK.get_Length()===fJ.get_Length()?(((fu.Curried3(A.map2))(fQ))(fK))(fJ):F.FailWith("HTML report internal error: incompatible specification of simulations and data files");fM=A.map(function(fT){return[fT.file,A.map(function(fU){return U.get(dk.SplitChars(A.head(fU.columns).name,["("],0),0);},fT.data)];},fJ);fN=A.map(function(fT){return fT.name;},A.filter(function(fT){var fU;fU=fT.prior;return fU==null?false:bk.Equals(fU.$0.variation,"Multiple");},fB.parameters));fO=bc.sum(A.map(function(fT){return A.length(fR(fT));},fM));fP=A.distinct(A.append(fN,A.map(function(fT){return fT[0];},A.filter(function(fT){return fS(fT[0],fT[1]);},A.groupBy(a.id,A.map(function(fT){var fU;fU=dk.SplitChars(U.last(dk.SplitChars(fT.name,["."],0)),["_"],0);return dk.concat("_",U.sub(fU,0,U.length(fU)-1));},A.filter(function(fT){return fT.name.indexOf("_")!=-1&&bX.variable(fT);},A.collect(function(fT){return fT.settings.parameters;},new B({$:1,$0:fC.top,$1:fC.systems})))))))));return dt.New(bB.codify(fC.string()),fL,fF,fM,fD.parameters,fE,fP);};bB.results_to_html_content=function(fB){var fC,fD,fE,fF,fG,fH,fI,fJ,fK;function fL(fM,fN){return bz.plot_marginal(fB.marginals.get_Item(fM),fM,fN);}fC=new B({$:1,$0:["logLikelihood",false],$1:A.map(function(fM){return[fM.name,bk.Equals(fM.ptype,"Log")];},fB.parameters)});fD=A.map(function(fM){return fL(fM[0],fM[1]);},fC);fE=A.map(function(fM){var fN;fN=fM[0];return bz.plot_trace(fB.marginals.get_Item("Iteration"),fB.marginals.get_Item(fN),fN);},fC);fF=A.map(function(fM){return fM.name;},fB.parameters);fG=A.choose(function(fM){var fN,fO;fN=A.filter(function(fP){return fP.indexOf(fM+"_")!=-1;},fF);return fN.$==0?null:(fO=bz.plot_variation(fB.marginals,fB.keys,fN),{$:1,$0:["Parameter variation: "+fM,bB.gridplot(fO[1],500,1,fO[0])]});},fB.multiple_paras);fH=bz.plot_correlation(fB.correlations,fF);fI=A.mapi(function(fM,fN){var fO;fO=bz.plot_comparisons(fN.sim,fN.dat,null,fN.xlabel,fN.ylabel);return[fB.comparisons.get_Length()>1?(function(fP){return function(fQ){return fP("Comparison "+a.String(fQ));};}(a.id))(fM+1):"Comparison",bB.gridplot_with_title(fN.name,200,150,6,fO)];},fB.comparisons);fJ=A.ofArray(["Parameter name","Type","Lower bound","Upper bound","MLE","Posterior mean","Posterior stdev","Posterior l95","Posterior l68","Posterior median","Posterior u68","Posterior u95"]);fK=A.map(function(fM){return new B({$:1,$0:fM.name,$1:new B({$:1,$0:bP.to_string(fM.ptype),$1:A.map(function(fN){return function(fO){return fN(dk.PadLeft(fO.toFixed(3),1));};}(a.id),A.ofArray([fM.lb,fM.ub,fM.mle,fM.mean,fv.sqrt(fM.variance),fM.l95,fM.l68,fM.median,fM.u68,fM.u95]))})});},fB.parameters);return dv.New(fB.model,fI,bB.gridplot(200,150,6,fD),dx.ofChart(fH),bB.gridplot(300,150,4,fE),bB.table(fJ,fK),fG);};bB.codify=function(fB){var fC;fC=A.ofArray(["directive","simulation","deterministic","inference","simulator","parameters","system","sweeps","data"]);return bc.fold(function(fD,fE){return dk.Replace(fD,fE,"<font color=\\"blue\\">"+fE+"</font>");},dk.Replace("<font face=\\"courier\\">"+fB+"<font>","\\n","<br> \\n"),fC);};bB.gridplot=function(fB,fC,fD,fE){return dx.ofSubplots(bB.subplots(fB,fC,fD,fE));};bB.table=function(fB,fC){var fD,fE,fF;fD=(fE=dk.concat("\\n",A.map(function(fG){return function(fH){return fG("\\u0009\\u0009<th>"+_2.toSafe(fH)+"</th>");};}(a.id),fB)),(function(fG){return function(fH){return fG("\\u0009<tr>\\n"+_2.toSafe(fH)+"\\n\\u0009</tr>");};}(a.id))(fE));fF=dk.concat("\\n",A.map(function(fG){var fH;fH=dk.concat("\\n",A.map(function(fI){return function(fJ){return fI("\\u0009\\u0009<td>"+_2.toSafe(fJ)+"</td>");};}(a.id),fG));return(function(fI){return function(fJ){return fI("\\u0009<tr>\\n"+_2.toSafe(fJ)+"\\n\\u0009</tr>");};}(a.id))(fH);},fC));return(((fu.Curried3(function(fG,fH,fI){return fG("<table id=\\"pTable\\">\\n"+_2.toSafe(fH)+"\\n"+_2.toSafe(fI)+"\\n</table>");}))(a.id))(fD))(fF);};bB.gridplot_with_title=function(fB,fC,fD,fE,fF){return dx.ofSubplots(d7.setTitle(fB,bB.subplots(fC,fD,fE,fF)));};bB.subplots=function(fB,fC,fD,fE){return d7.setSubplotSize(fB,fC,d7.createSubplots(1+(fE.get_Length()/fD>>0),fD,function(fF,fG){return fE.get_Length()>fF*fD+fG?{$:1,$0:fE.get_Item(fF*fD+fG)}:null;}));};bC=bn.Parameter=fu.Class({isFixed:function(){return this.range.pType.$===2;},isReal:function(){return this.range.pType.$===0;}},null,bC);bC.New=function(fB,fC,fD,fE,fF){return new bC({name:fB,range:fC,initValue:fD,prior:fE,summary:fF});};bD.to_string_monomial=function(fB){function fC(fD,fE){return fE===1?fD.name:(((fu.Curried3(function(fF,fG,fH){return fF(_2.toSafe(fG)+"^"+a.String(fH));}))(a.id))(fD.name))(fE);}return R.to_string(function(fD){var fE;function fF(fH){return fH[1];}function fG(fH){return 0!==fH;}fE=dk.concat("*",A.map(function(fH){return fC(fH[0],fH[1]);},A.filter(function(fH){return fG(fF(fH));},fD)));return(function(fH){return function(fI){return fH("<"+_2.toSafe(fI)+">");};}(a.id))(fE);},fB);};bD.saturate_plots=function(fB,fC){var fD;function fE(fG){return A.zip(fB,fG);}function fF(fG){return{$:0,$0:fG};}return fC.plots.$==0?b1.New(fC.order,fC.initial_minimum,fC.log_evaluation,A.map((fD=function(fG){return fE(A.ofArray(fG));},function(fG){return fF(fD(fG));}),bD.initAllOrders(fB.get_Length(),fC.order))):fC;};bD.defaults=function(){fc.$cctor();return fc.defaults;};bD.initAllOrders=function(fB,fC){function fD(fE,fF){var fG,fH;return fE.$==1?(fG=fE.$1,(fH=fE.$0,bc.fold(function(fI,fJ){return A.append(A.map(function(fK){var fL;fL=fK.slice();U.set(fL,fH,fJ);return fL;},fD(fG,fF-fJ)),fI);},B.Empty,A.ofSeq(F.range(0,fF))))):A.ofArray([U.create(fB,0)]);}return A.filter(function(fE){return!U.forall(function(fF){return fF===0;},fE);},fD(A.ofSeq(F.range(0,fB-1)),fC));};bD.parse=function(){fc.$cctor();return fc.parse;};bD.op_BarGreaterGreater=function(fB,fC){return D.op_BarGreaterGreater(fB,fC);};bD.op_GreaterGreaterDot=function(fB,fC){return D.op_GreaterGreaterDot(fB,fC);};bD.op_DotGreaterGreaterDot=function(fB,fC){return D.op_DotGreaterGreaterDot(fB,fC);};bD.op_DotGreaterGreater=function(fB,fC){return D.op_DotGreaterGreater(fB,fC);};bD.canonicalMonomial=function(fB){return A.ofSeq(K.ToSeq(bc.fold(function(fC,fD){var fE,fF,fG;fE=fD[0];fF=fD[1];fG=K.TryFind(fE,fC);return fG!=null&&fG.$==1?fC.Add(fE,fG.$0+fF):fC.Add(fE,fF);},new y.New([]),fB)));};bD.pmonomial=function(){fc.$cctor();return fc.pmonomial;};bD.parse_defaults=function(fB){return D.record(fB,A.ofArray([["order",bD.op_BarGreaterGreater(D.pint32(),function(fC){return function(fD){return b1.New(fC,fD.initial_minimum,fD.log_evaluation,fD.plots);};})],["initial_minimum",bD.op_BarGreaterGreater(D.pfloat(),function(fC){return function(fD){return b1.New(fD.order,fC,fD.log_evaluation,fD.plots);};})],["log_evaluation",bD.op_BarGreaterGreater(D.pbool(),function(fC){return function(fD){return b1.New(fD.order,fD.initial_minimum,fC,fD.plots);};})],["plots",bD.op_BarGreaterGreater(D.list_of(bD.pplot()),function(fC){return function(fD){return b1.New(fD.order,fD.initial_minimum,fD.log_evaluation,fC);};})]]));};bD.pplot=function(){fc.$cctor();return fc.pplot;};bE.create=function(fB,fC){return bE.New(fC,fB);};bE.reverse=function(fB){return bE.New(fB.name,A.rev(fB.values));};bE.New=function(fB,fC){return{name:fB,values:fC};};bF.to_env=function(fB){return K.OfArray(U.ofSeq(A.map(function(fC){return[fC.name,fC.value];},fB)));};bF.substitute=function(fB,fC){return A.map(function(fD){return bX.substitute(fB,fD);},fC);};bF.expand_multiples=function(fB,fC){var fD,fE,fF,fG,fH,fI,fJ,fK,fL;fD=A.partition(bX.is_multiple,fC);fE=fD[1];fF=fD[0];fG=A.map(bX.getname,fF);fH=[0];fI=A.unzip(A.map(function(fM){return ek.add_multiples(fH,fG,fM);},fB));fJ=A.concat(bF.create_multiples(A.concat(fI[0]),fF));fK=bc.fold(function(fM,fN){return fM.Add(fN.name,A.ofArray([fN.name]));},bc.fold(function(fM,fN){return bc.fold(function(fO,fP){var fQ,fR;fQ=fP[0];fR=fP[1];return fO.ContainsKey(fQ.name)?fO.Add(fQ.name,A.append(fO.get_Item(fQ.name),A.ofArray([fR.name]))):fO.Add(fQ.name,A.ofArray([fR.name]));},fM,A.zip(fF,fN));},new y.New([]),fJ),fE);fL=A.concat(fJ);return[fI[1],A.concat([fE,A.map(function(fM){return bX.create$1(fM.name,fM.value,null);},fF),fL]),fK];};bF.create_multiples=function(fB,fC){function fD(fE){return A.map2(function(fF,fG){var fH;return bX.create$1(fG,fF.value,(fH=fF.prior,fH==null?null:{$:1,$0:bW.vary(fH.$0)}));},fC,fE);}return A.map(function(fE){return A.map(fD,fE);},fB);};bF.to_string=function(fB){return(function(fC){return function(fD){return fC("[\\n  "+_2.toSafe(fD)+";\\n]");};}(a.id))(dk.concat(";\\n  ",A.map(bX.to_string,fB)));};bF.to_string_inline=function(fB){return dk.concat("; ",A.map(function(fC){return(((fu.Curried3(function(fD,fE,fF){return fD(_2.toSafe(fE)+" = "+_2.toSafe(fF));}))(a.id))(fC.name))(a.String(fC.value));},fB));};bF.remove=function(fB,fC){return bc.fold(function(fD,fE){return A.filter(function(fF){return fF.name!==fE;},fD);},fC,fB);};bG=d.Task=fu.Class({to_string:function(){var fB;fB=this;return(function(fC){return function(fD){return fC("directive task {"+_2.toSafe(fD)+"}");};}(a.id))(dk.Join(";",U.ofSeq(bc.delay(function(){var fC;return bc.append((fC=fB.task_type,fC!=null&&fC.$==1?[(function(fD){return function(fE){return fD("task="+_2.toSafe(fE));};}(a.id))(a.String(fC.$0).toLowerCase())]:[]),bc.delay(function(){return bc.append(fB.copies!==1?[(function(fD){return function(fE){return fD("copies="+a.String(fE));};}(a.id))(fB.copies)]:[],bc.delay(function(){return bc.append(fB.copy_id!==1?[(function(fD){return function(fE){return fD("copy_id="+a.String(fE));};}(a.id))(fB.copy_id)]:[],bc.delay(function(){return fB.nodes!==1?[(function(fD){return function(fE){return fD("nodes="+a.String(fE));};}(a.id))(fB.nodes)]:[];}));}));}));}))));}},null,bG);bG.New=function(fB,fC,fD,fE){return new bG({task_type:fB,copies:fC,copy_id:fD,nodes:fE});};bH=E.Location=fu.Class({get_to_string:function(){return this.$==1?this.$0[0]+"."+this.$0[1]:this.$0;}},null,bH);bI.get_to_string=function(fB){return fB=="Normal"?"Normal":fB=="LogNormal"?"LogNormal":fB=="TruncatedNormal"?"TruncatedNormal":"Fixed";};bJ.New=function(fB,fC,fD){return{source:fB,target:fC,prior:fD};};bK.New=function(fB,fC){return{location:fB,parameters:fC};};bL.j$60=function(){return bL._v$60?bL._v$60:bL._v$60=(cj.DecodeRecord(N,[["task",bL.j$61,1],["nodes",cj.DecodeStringMap(bL.j$17),0],["edges",cj.DecodeStringMap(cj.DecodeList(bL.j$63)),0],["expanded",cj.Id(),0]]))();};bM.j$13=function(){return bM._v$13?bM._v$13:bM._v$13=(cj.EncodeRecord(N,[["task",bM.j$14,1],["nodes",cj.EncodeStringMap(bM.j$16),0],["edges",cj.EncodeStringMap(cj.EncodeList(bM.j$73)),0],["expanded",cj.Id(),0]]))();};bL.j$17=function(){return bL._v$17?bL._v$17:bL._v$17=(cj.DecodeRecord(bj,[["top",bL.j$18,0],["systems",cj.DecodeList(bL.j$18),0]]))();};bM.j$16=function(){return bM._v$16?bM._v$16:bM._v$16=(cj.EncodeRecord(bj,[["top",bM.j$17,0],["systems",cj.EncodeList(bM.j$17),0]]))();};bM.j=function(){return bM._v?bM._v:bM._v=(cj.EncodeRecord(void 0,[["content_type",cj.Id(),0],["id",cj.Id(),0],["display_name",cj.Id(),0],["node_id",cj.Id(),1],["instance",cj.Id(),1],["content",cj.EncodeArray(cj.Id()),1],["save_content",cj.Id(),1]]))();};bM.j$82=function(){return bM._v$82?bM._v$82:bM._v$82=(cj.EncodeRecord(void 0,[["nodeId",cj.Id(),0],["iteration",cj.Id(),0],["lkincreased",cj.Id(),0],["state",bM.j$83,0],["mlesims",cj.EncodeList(bM.j$95),1],["summary",cj.Id(),0]]))();};bM.j$105=function(){return bM._v$105?bM._v$105:bM._v$105=(cj.EncodeRecord(void 0,[["nodeId",cj.Id(),0],["parameters",cj.EncodeList(bM.j$106),0]]))();};bM.j$8=function(){return bM._v$8?bM._v$8:bM._v$8=(cj.EncodeRecord(void 0,[["states",cj.EncodeArray(bM.j$9),0],["start_index",cj.Id(),0],["attributes",cj.EncodeArray(cj.Id()),0]]))();};bM.j$79=function(){return bM._v$79?bM._v$79:bM._v$79=(cj.EncodeRecord(void 0,[["value_type",bM.j$80,0],["instances",cj.EncodeList(bM.j$81),0]]))();};bM.j$78=function(){return bM._v$78?bM._v$78:bM._v$78=(cj.EncodeRecord(void 0,[["time",cj.Id(),0],["values",cj.EncodeArray(cj.Id()),0]]))();};bL.j$13=function(){return bL._v$13?bL._v$13:bL._v$13=(cj.DecodeRecord(C,[["model",cj.Id(),0],["sweep",cj.Id(),0],["assignment",cj.Id(),0],["environment",cj.DecodeStringMap(cj.Id()),0],["settings",bL.j$14,0],["name",cj.Id(),0]]))();};bM.j$77=function(){return bM._v$77?bM._v$77:bM._v$77=(cj.EncodeRecord(void 0,[["name",cj.Id(),0],["structural",cj.Id(),1],["svg",cj.Id(),1]]))();};bM.j$12=function(){return bM._v$12?bM._v$12:bM._v$12=(cj.EncodeRecord(void 0,[["time",cj.Id(),0],["values",cj.EncodeArray(cj.Id()),0]]))();};bM.j$7=function(){return bM._v$7?bM._v$7:bM._v$7=(cj.EncodeRecord(void 0,[["times",cj.EncodeList(cj.Id()),0],["stateprobabilities",cj.EncodeList(cj.EncodeArray(cj.Id())),0],["stoichiometry",cj.EncodeArray(cj.EncodeArray(cj.Id())),0],["species",cj.EncodeStringDictionary(cj.Id()),0]]))();};bM.j$6=function(){return bM._v$6?bM._v$6:bM._v$6=(cj.EncodeRecord(void 0,[["times",cj.EncodeList(cj.Id()),0],["values",cj.EncodeList(cj.Id()),0],["probabilities",cj.EncodeList(cj.EncodeArray(cj.Id())),0]]))();};bL.j$16=function(){return bL._v$16?bL._v$16:bL._v$16=(cj.DecodeRecord(void 0,[["times",cj.DecodeList(cj.Id()),0],["stateprobabilities",cj.DecodeList(cj.DecodeArray(cj.Id())),0],["stoichiometry",cj.DecodeArray(cj.DecodeArray(cj.Id())),0],["species",cj.DecodeStringDictionary(cj.Id()),0]]))();};bM.j$5=function(){return bM._v$5?bM._v$5:bM._v$5=(cj.EncodeRecord(void 0,[["time",cj.Id(),0],["values",cj.EncodeArray(cj.EncodeArray(cj.Id())),0]]))();};bM.j$4=function(){return bM._v$4?bM._v$4:bM._v$4=(cj.EncodeRecord(void 0,[["time",cj.Id(),0],["values",cj.EncodeArray(cj.EncodeArray(cj.EncodeArray(cj.Id()))),0]]))();};bM.j$1=function(){return bM._v$1?bM._v$1:bM._v$1=(cj.EncodeRecord(void 0,[["times",cj.EncodeList(cj.Id()),0],["columns",cj.EncodeList(bM.j$3),0]]))();};bL.j$7=function(){return bL._v$7?bL._v$7:bL._v$7=(cj.DecodeUnion(void 0,{Item1:13,Round:12,Floor:11,Ceiling:10,Modulo:9,Log:8,Absolute:7,Minus:6,Plus:5,Power:4,Divide:3,Times:2,Float:1,Key:0},[["Key",[["$0","Key",cj.Id(),0]]],["Float",[["$0","Float",cj.Id(),0]]],["Times",[["$0","Times",cj.DecodeList(bL.j$7),0]]],["Divide",[["$0","Divide",bL.j$12,0]]],["Power",[["$0","Power",bL.j$11,0]]],["Plus",[["$0","Plus",cj.DecodeList(bL.j$7),0]]],["Minus",[["$0","Minus",bL.j$10,0]]],["Absolute",[["$0","Absolute",bL.j$7,0]]],["Log",[["$0","Log",bL.j$7,0]]],["Modulo",[["$0","Modulo",bL.j$9,0]]],["Ceiling",[["$0","Ceiling",bL.j$7,0]]],["Floor",[["$0","Floor",bL.j$7,0]]],["Round",[["$0","Round",bL.j$7,0]]],["If",[["$0","Item1",bL.j$8,0],["$1","Item2",bL.j$7,0],["$2","Item3",bL.j$7,0]]]]))();};bL.j=function(){return bL._v?bL._v:bL._v=(cj.DecodeUnion(void 0,{Item1:13,Round:12,Floor:11,Ceiling:10,Modulo:9,Log:8,Absolute:7,Minus:6,Plus:5,Power:4,Divide:3,Times:2,Float:1,Key:0},[["Key",[["$0","Key",cj.DecodeList(cj.DecodeTuple([cj.Id(),cj.Id()])),0]]],["Float",[["$0","Float",cj.Id(),0]]],["Times",[["$0","Times",cj.DecodeList(bL.j),0]]],["Divide",[["$0","Divide",bL.j$6,0]]],["Power",[["$0","Power",bL.j$5,0]]],["Plus",[["$0","Plus",cj.DecodeList(bL.j),0]]],["Minus",[["$0","Minus",bL.j$4,0]]],["Absolute",[["$0","Absolute",bL.j,0]]],["Log",[["$0","Log",bL.j,0]]],["Modulo",[["$0","Modulo",bL.j$3,0]]],["Ceiling",[["$0","Ceiling",bL.j,0]]],["Floor",[["$0","Floor",bL.j,0]]],["Round",[["$0","Round",bL.j,0]]],["If",[["$0","Item1",bL.j$2,0],["$1","Item2",bL.j,0],["$2","Item3",bL.j,0]]]]))();};bL.j$61=function(){return bL._v$61?bL._v$61:bL._v$61=(cj.DecodeRecord(bG,[["task_type",bL.j$62,1],["copies",cj.Id(),0],["copy_id",cj.Id(),0],["nodes",cj.Id(),0]]))();};bL.j$63=function(){return bL._v$63?bL._v$63:bL._v$63=(cj.DecodeRecord(void 0,[["location",bL.j$64,0],["parameters",cj.DecodeList(bL.j$65),0]]))();};bM.j$14=function(){return bM._v$14?bM._v$14:bM._v$14=(cj.EncodeRecord(bG,[["task_type",bM.j$15,1],["copies",cj.Id(),0],["copy_id",cj.Id(),0],["nodes",cj.Id(),0]]))();};bM.j$73=function(){return bM._v$73?bM._v$73:bM._v$73=(cj.EncodeRecord(void 0,[["location",bM.j$74,0],["parameters",cj.EncodeList(bM.j$75),0]]))();};bL.j$18=function(){return bL._v$18?bL._v$18:bL._v$18=(cj.DecodeRecord(z,[["name",cj.Id(),0],["settings",bL.j$19,0],["reactions",cj.DecodeList(bL.j$51),0],["initials",cj.DecodeList(bL.j$54),0],["attributes",cj.DecodeStringMap(cj.Id()),0]]))();};bM.j$17=function(){return bM._v$17?bM._v$17:bM._v$17=(cj.EncodeRecord(z,[["name",cj.Id(),0],["settings",bM.j$18,0],["reactions",cj.EncodeList(bM.j$65),0],["initials",cj.EncodeList(bM.j$68),0],["attributes",cj.EncodeStringMap(cj.Id()),0]]))();};bM.j$83=function(){return bM._v$83?bM._v$83:bM._v$83=(cj.EncodeUnion(void 0,{SamplingPhase:1,BurninPhase:0},[["BurninPhase",[["$0","BurninPhase",bM.j$93,0]]],["SamplingPhase",[["$0","SamplingPhase",bM.j$84,0]]]]))();};bM.j$95=function(){return bM._v$95?bM._v$95:bM._v$95=(cj.EncodeRecord(void 0,[["instance",bM.j$96,0],["table",bM.j$55,0]]))();};bM.j$106=function(){return bM._v$106?bM._v$106:bM._v$106=(cj.EncodeRecord(void 0,[["name",cj.Id(),0],["range",bM.j$107,0],["initValue",cj.Id(),1]]))();};bM.j$9=function(){return bM._v$9?bM._v$9:bM._v$9=(cj.EncodeRecord(void 0,[["species",cj.EncodeStringMap(cj.Id()),0],["transitions",cj.EncodeArray(cj.Id()),0]]))();};bM.j$80=function(){return bM._v$80?bM._v$80:bM._v$80=(cj.EncodeUnion(void 0,"$",[null,null,null,null,null,null]))();};bM.j$81=function(){return bM._v$81?bM._v$81:bM._v$81=(cj.EncodeRecord(C,[["model",cj.Id(),0],["sweep",cj.Id(),0],["assignment",cj.Id(),0],["environment",cj.EncodeStringMap(cj.Id()),0],["settings",bM.j$19,0],["name",cj.Id(),0]]))();};bL.j$14=function(){return bL._v$14?bL._v$14:bL._v$14=(cj.DecodeRecord(P,[["name",cj.Id(),0],["initial",cj.Id(),0],["final",cj.Id(),0],["points",cj.Id(),0],["plots",cj.DecodeList(cj.Id()),0],["plotcolours",cj.DecodeList(cj.Id()),0],["seed",cj.Id(),1],["kinetics",bL.j$15,0],["times",cj.DecodeList(cj.Id()),0],["prune",cj.Id(),0],["multicore",cj.Id(),0],["data",cj.DecodeList(cj.Id()),0],["sweeps",cj.DecodeList(cj.Id()),0]]))();};bM.j$3=function(){return bM._v$3?bM._v$3:bM._v$3=(cj.EncodeRecord(void 0,[["name",cj.Id(),0],["values",cj.EncodeList(cj.Id()),0]]))();};bL.j$12=function(){return bL._v$12?bL._v$12:bL._v$12=(cj.DecodeRecord(void 0,[["div1",bL.j$7,0],["div2",bL.j$7,0]]))();};bL.j$11=function(){return bL._v$11?bL._v$11:bL._v$11=(cj.DecodeRecord(void 0,[["base_",bL.j$7,0],["exponent",bL.j$7,0]]))();};bL.j$10=function(){return bL._v$10?bL._v$10:bL._v$10=(cj.DecodeRecord(void 0,[["sub1",bL.j$7,0],["sub2",bL.j$7,0]]))();};bL.j$9=function(){return bL._v$9?bL._v$9:bL._v$9=(cj.DecodeRecord(void 0,[["div",bL.j$7,0],["modulo",bL.j$7,0]]))();};bL.j$8=function(){return bL._v$8?bL._v$8:bL._v$8=(cj.DecodeUnion(void 0,"$",[[0,[]],[1,[]],[2,[["$0","Item1",bL.j$7,0],["$1","Item2",bL.j$7,0]]],[3,[["$0","Item1",bL.j$7,0],["$1","Item2",bL.j$7,0]]],[4,[["$0","Item1",bL.j$7,0],["$1","Item2",bL.j$7,0]]],[5,[["$0","Item1",bL.j$7,0],["$1","Item2",bL.j$7,0]]],[6,[["$0","Item1",bL.j$7,0],["$1","Item2",bL.j$7,0]]],[7,[["$0","Item",bL.j$8,0]]],[8,[["$0","Item1",bL.j$8,0],["$1","Item2",bL.j$8,0]]],[9,[["$0","Item1",bL.j$8,0],["$1","Item2",bL.j$8,0]]]]))();};bL.j$6=function(){return bL._v$6?bL._v$6:bL._v$6=(cj.DecodeRecord(void 0,[["div1",bL.j,0],["div2",bL.j,0]]))();};bL.j$5=function(){return bL._v$5?bL._v$5:bL._v$5=(cj.DecodeRecord(void 0,[["base_",bL.j,0],["exponent",bL.j,0]]))();};bL.j$4=function(){return bL._v$4?bL._v$4:bL._v$4=(cj.DecodeRecord(void 0,[["sub1",bL.j,0],["sub2",bL.j,0]]))();};bL.j$3=function(){return bL._v$3?bL._v$3:bL._v$3=(cj.DecodeRecord(void 0,[["div",bL.j,0],["modulo",bL.j,0]]))();};bL.j$2=function(){return bL._v$2?bL._v$2:bL._v$2=(cj.DecodeUnion(void 0,"$",[[0,[]],[1,[]],[2,[["$0","Item1",bL.j,0],["$1","Item2",bL.j,0]]],[3,[["$0","Item1",bL.j,0],["$1","Item2",bL.j,0]]],[4,[["$0","Item1",bL.j,0],["$1","Item2",bL.j,0]]],[5,[["$0","Item1",bL.j,0],["$1","Item2",bL.j,0]]],[6,[["$0","Item1",bL.j,0],["$1","Item2",bL.j,0]]],[7,[["$0","Item",bL.j$2,0]]],[8,[["$0","Item1",bL.j$2,0],["$1","Item2",bL.j$2,0]]],[9,[["$0","Item1",bL.j$2,0],["$1","Item2",bL.j$2,0]]]]))();};bN.p=function(fB){return fB=="MC"?"MC":fB=="PDE"?"PDE":fB=="LNA"?"LNA":fB=="CMESundials"?"CMESundials":fB=="CME"?"CME":fB=="SSA"?"SSA":fB=="Sundials"?"Sundials":"Oslo";};bL.j$62=function(){return bL._v$62?bL._v$62:bL._v$62=(cj.DecodeUnion(void 0,"$",[null,null,null]))();};bL.j$64=function(){return bL._v$64?bL._v$64:bL._v$64=(cj.DecodeUnion(bH,{SystemLoc:1,NodeLoc:0},[["NodeLoc",[["$0","NodeLoc",cj.Id(),0]]],["SystemLoc",[["$0","SystemLoc",cj.DecodeTuple([cj.Id(),cj.Id()]),0]]]]))();};bL.j$65=function(){return bL._v$65?bL._v$65:bL._v$65=(cj.DecodeRecord(void 0,[["source",cj.Id(),0],["target",cj.Id(),0],["prior",bL.j$66,0]]))();};bM.j$15=function(){return bM._v$15?bM._v$15:bM._v$15=(cj.EncodeUnion(void 0,"$",[null,null,null]))();};bM.j$74=function(){return bM._v$74?bM._v$74:bM._v$74=(cj.EncodeUnion(bH,{SystemLoc:1,NodeLoc:0},[["NodeLoc",[["$0","NodeLoc",cj.Id(),0]]],["SystemLoc",[["$0","SystemLoc",cj.EncodeTuple([cj.Id(),cj.Id()]),0]]]]))();};bM.j$75=function(){return bM._v$75?bM._v$75:bM._v$75=(cj.EncodeRecord(void 0,[["source",cj.Id(),0],["target",cj.Id(),0],["prior",bM.j$76,0]]))();};bL.j$19=function(){return bL._v$19?bL._v$19:bL._v$19=(cj.DecodeRecord(O,[["simulation",bL.j$14,0],["simulations",cj.DecodeList(bL.j$14),0],["stochastic",bL.j$20,0],["deterministic",cj.Id(),0],["spatial",bL.j$22,0],["inference",bL.j$33,0],["moment_closure",bL.j$36,0],["synthesis",bL.j$37,0],["data",cj.DecodeList(bL.j$40),0],["units",bL.j$43,0],["simulator",bL.j$47,0],["parameters",cj.DecodeList(bL.j$23),0],["sweeps",cj.DecodeList(bL.j$48),0],["rates",cj.DecodeStringMap(cj.Id()),0],["plot",bL.j$50,0],["quiet",cj.Id(),0]]))();};bL.j$51=function(){return bL._v$51?bL._v$51:bL._v$51=(cj.DecodeRecord(cc,[["catalysts",cj.DecodeList(cj.Id()),0],["reactants",cj.DecodeList(cj.Id()),0],["reverse",bL.j$53,1],["rate",bL.j$53,0],["products",cj.DecodeList(cj.Id()),0]]))();};bL.j$54=function(){return bL._v$54?bL._v$54:bL._v$54=(cj.DecodeRecord(V,[["constant",cj.Id(),0],["value",cj.Id(),0],["species",cj.Id(),0],["time",cj.Id(),1],["spatial",bL.j$55,1]]))();};bM.j$18=function(){return bM._v$18?bM._v$18:bM._v$18=(cj.EncodeRecord(O,[["simulation",bM.j$19,0],["simulations",cj.EncodeList(bM.j$19),0],["stochastic",bM.j$21,0],["deterministic",cj.Id(),0],["spatial",bM.j$23,0],["inference",bM.j$40,0],["moment_closure",bM.j$43,0],["synthesis",bM.j$51,0],["data",cj.EncodeList(bM.j$54),0],["units",bM.j$57,0],["simulator",bM.j$61,0],["parameters",cj.EncodeList(bM.j$24),0],["sweeps",cj.EncodeList(bM.j$62),0],["rates",cj.EncodeStringMap(cj.Id()),0],["plot",bM.j$64,0],["quiet",cj.Id(),0]]))();};bM.j$65=function(){return bM._v$65?bM._v$65:bM._v$65=(cj.EncodeRecord(cc,[["catalysts",cj.EncodeList(cj.Id()),0],["reactants",cj.EncodeList(cj.Id()),0],["reverse",bM.j$67,1],["rate",bM.j$67,0],["products",cj.EncodeList(cj.Id()),0]]))();};bM.j$68=function(){return bM._v$68?bM._v$68:bM._v$68=(cj.EncodeRecord(V,[["constant",cj.Id(),0],["value",cj.Id(),0],["species",cj.Id(),0],["time",cj.Id(),1],["spatial",bM.j$69,1]]))();};bM.j$93=function(){return bM._v$93?bM._v$93:bM._v$93=(cj.EncodeRecord(void 0,[["space",cj.EncodeStringDictionary(bM.j$85),0],["state",bM.j$87,0],["stats",cj.EncodeArray(cj.Id()),0],["mle",bM.j$87,0],["priors",cj.EncodeArray(bM.j$88),0],["indexes",cj.EncodeArray(cj.Id()),0]]))();};bM.j$84=function(){return bM._v$84?bM._v$84:bM._v$84=(cj.EncodeRecord(void 0,[["space",cj.EncodeStringDictionary(bM.j$85),0],["state",bM.j$87,0],["thinningSkippedCount",cj.Id(),0],["chain",cj.EncodeList(bM.j$87),0],["mle",bM.j$87,0],["priors",cj.EncodeArray(bM.j$88),0],["indexes",cj.EncodeArray(cj.Id()),0]]))();};bM.j$96=function(){return bM._v$96?bM._v$96:bM._v$96=(cj.EncodeRecord(C,[["model",cj.Id(),0],["sweep",cj.Id(),0],["assignment",cj.Id(),0],["environment",cj.EncodeStringMap(cj.Id()),0],["settings",bM.j$104,0],["name",cj.Id(),0]]))();};bM.j$55=function(){return bM._v$55?bM._v$55:bM._v$55=(cj.EncodeRecord(void 0,[["times",cj.EncodeList(cj.Id()),0],["columns",cj.EncodeList(bM.j$56),0]]))();};bM.j$107=function(){return bM._v$107?bM._v$107:bM._v$107=(cj.EncodeRecord(void 0,[["pType",bM.j$108,0],["lb",cj.Id(),0],["ub",cj.Id(),0]]))();};bM.j$19=function(){return bM._v$19?bM._v$19:bM._v$19=(cj.EncodeRecord(P,[["name",cj.Id(),0],["initial",cj.Id(),0],["final",cj.Id(),0],["points",cj.Id(),0],["plots",cj.EncodeList(cj.Id()),0],["plotcolours",cj.EncodeList(cj.Id()),0],["seed",cj.Id(),1],["kinetics",bM.j$20,0],["times",cj.EncodeList(cj.Id()),0],["prune",cj.Id(),0],["multicore",cj.Id(),0],["data",cj.EncodeList(cj.Id()),0],["sweeps",cj.EncodeList(cj.Id()),0]]))();};bL.j$15=function(){return bL._v$15?bL._v$15:bL._v$15=(cj.DecodeUnion(void 0,"$",[null,null,null]))();};bL.j$66=function(){return bL._v$66?bL._v$66:bL._v$66=(cj.DecodeUnion(void 0,"$",[null,null,null,null]))();};bM.j$76=function(){return bM._v$76?bM._v$76:bM._v$76=(cj.EncodeUnion(void 0,"$",[null,null,null,null]))();};bL.j$20=function(){return bL._v$20?bL._v$20:bL._v$20=(cj.DecodeRecord(void 0,[["scale",cj.Id(),0],["steps",cj.Id(),1],["trajectories",cj.Id(),0],["stationary_skiptime",cj.Id(),1]]))();};bL.j$22=function(){return bL._v$22?bL._v$22:bL._v$22=(cj.DecodeRecord(void 0,[["parameters",cj.DecodeList(bL.j$23),0],["diffusibles",cj.DecodeList(cj.DecodeTuple([cj.Id(),bL.j$7])),0],["dimensions",cj.Id(),0],["boundary",bL.j$32,0],["xmax",cj.Id(),0],["nx",cj.Id(),0],["dt",cj.Id(),0],["default_diffusion",cj.Id(),0],["random",cj.Id(),0]]))();};bL.j$33=function(){return bL._v$33?bL._v$33:bL._v$33=(cj.DecodeRecord(void 0,[["name",cj.Id(),0],["burnin",cj.Id(),0],["samples",cj.Id(),0],["thin",cj.Id(),0],["noise_model",bL.j$34,0],["noise_parameter",bL.j$35,0],["prune",cj.Id(),0],["seed",cj.Id(),0],["seeds",cj.DecodeList(cj.Id()),0],["lowerbound",cj.Id(),1],["timer",cj.Id(),0],["partial_evaluation",cj.Id(),0],["print_console",cj.Id(),0],["print_summary",cj.Id(),0]]))();};bL.j$36=function(){return bL._v$36?bL._v$36:bL._v$36=(cj.DecodeRecord(void 0,[["order",cj.Id(),0],["initial_minimum",cj.Id(),0],["log_evaluation",cj.Id(),0],["plots",cj.DecodeList(bL.j),0]]))();};bL.j$37=function(){return bL._v$37?bL._v$37:bL._v$37=(cj.DecodeRecord(void 0,[["mode",bL.j$38,0],["solver",bL.j$39,0],["timeout",cj.Id(),1],["seed",cj.Id(),1]]))();};bL.j$40=function(){return bL._v$40?bL._v$40:bL._v$40=(cj.DecodeRecord(void 0,[["file",cj.Id(),0],["data",cj.DecodeList(bL.j$41),0]]))();};bL.j$43=function(){return bL._v$43?bL._v$43:bL._v$43=(cj.DecodeRecord(b7,[["concentration",bL.j$44,0],["time",bL.j$45,0],["space",bL.j$46,0]]))();};bL.j$47=function(){return bL._v$47?bL._v$47:bL._v$47=(cj.DecodeUnion(void 0,"$",[null,null,null,null,null,null,null,null]))();};bL.j$23=function(){return bL._v$23?bL._v$23:bL._v$23=(cj.DecodeRecord(bX,[["name",cj.Id(),0],["value",cj.Id(),0],["prior",bL.j$24,1]]))();};bL.j$48=function(){return bL._v$48?bL._v$48:bL._v$48=(cj.DecodeRecord(b9,[["name",cj.Id(),0],["assignments",cj.DecodeList(bL.j$49),0]]))();};bL.j$50=function(){return bL._v$50?bL._v$50:bL._v$50=(cj.DecodeRecord(b_,[["x_label",cj.Id(),0],["y_label",cj.Id(),0],["title",cj.Id(),0],["label_font_size",cj.Id(),0],["tick_font_size",cj.Id(),0],["x_ticks",cj.DecodeList(cj.Id()),0],["y_ticks",cj.DecodeList(cj.Id()),0],["x_min",cj.Id(),1],["x_max",cj.Id(),1],["y_min",cj.Id(),1],["y_max",cj.Id(),1],["v_boundaries",cj.DecodeList(cj.Id()),0],["h_boundaries",cj.DecodeList(cj.Id()),0]]))();};bL.j$53=function(){return bL._v$53?bL._v$53:bL._v$53=(cj.DecodeUnion(cb,{Function:1,MassAction:0},[["MassAction",[["$0","MassAction",cj.Id(),0]]],["Function",[["$0","Function",cj.Id(),0]]]]))();};bL.j$55=function(){return bL._v$55?bL._v$55:bL._v$55=(cj.DecodeRecord(void 0,[["random",cj.Id(),0],["core",bL.j$56,1],["points",cj.DecodeList(bL.j$57),0],["rectangles",cj.DecodeList(bL.j$58),0]]))();};bM.j$21=function(){return bM._v$21?bM._v$21:bM._v$21=(cj.EncodeRecord(void 0,[["scale",cj.Id(),0],["steps",cj.Id(),1],["trajectories",cj.Id(),0],["stationary_skiptime",cj.Id(),1]]))();};bM.j$23=function(){return bM._v$23?bM._v$23:bM._v$23=(cj.EncodeRecord(void 0,[["parameters",cj.EncodeList(bM.j$24),0],["diffusibles",cj.EncodeList(cj.EncodeTuple([cj.Id(),bM.j$33])),0],["dimensions",cj.Id(),0],["boundary",bM.j$39,0],["xmax",cj.Id(),0],["nx",cj.Id(),0],["dt",cj.Id(),0],["default_diffusion",cj.Id(),0],["random",cj.Id(),0]]))();};bM.j$40=function(){return bM._v$40?bM._v$40:bM._v$40=(cj.EncodeRecord(void 0,[["name",cj.Id(),0],["burnin",cj.Id(),0],["samples",cj.Id(),0],["thin",cj.Id(),0],["noise_model",bM.j$41,0],["noise_parameter",bM.j$42,0],["prune",cj.Id(),0],["seed",cj.Id(),0],["seeds",cj.EncodeList(cj.Id()),0],["lowerbound",cj.Id(),1],["timer",cj.Id(),0],["partial_evaluation",cj.Id(),0],["print_console",cj.Id(),0],["print_summary",cj.Id(),0]]))();};bM.j$43=function(){return bM._v$43?bM._v$43:bM._v$43=(cj.EncodeRecord(void 0,[["order",cj.Id(),0],["initial_minimum",cj.Id(),0],["log_evaluation",cj.Id(),0],["plots",cj.EncodeList(bM.j$44),0]]))();};bM.j$51=function(){return bM._v$51?bM._v$51:bM._v$51=(cj.EncodeRecord(void 0,[["mode",bM.j$52,0],["solver",bM.j$53,0],["timeout",cj.Id(),1],["seed",cj.Id(),1]]))();};bM.j$54=function(){return bM._v$54?bM._v$54:bM._v$54=(cj.EncodeRecord(void 0,[["file",cj.Id(),0],["data",cj.EncodeList(bM.j$55),0]]))();};bM.j$57=function(){return bM._v$57?bM._v$57:bM._v$57=(cj.EncodeRecord(b7,[["concentration",bM.j$58,0],["time",bM.j$59,0],["space",bM.j$60,0]]))();};bM.j$61=function(){return bM._v$61?bM._v$61:bM._v$61=(cj.EncodeUnion(void 0,"$",[null,null,null,null,null,null,null,null]))();};bM.j$24=function(){return bM._v$24?bM._v$24:bM._v$24=(cj.EncodeRecord(bX,[["name",cj.Id(),0],["value",cj.Id(),0],["prior",bM.j$25,1]]))();};bM.j$62=function(){return bM._v$62?bM._v$62:bM._v$62=(cj.EncodeRecord(b9,[["name",cj.Id(),0],["assignments",cj.EncodeList(bM.j$63),0]]))();};bM.j$64=function(){return bM._v$64?bM._v$64:bM._v$64=(cj.EncodeRecord(b_,[["x_label",cj.Id(),0],["y_label",cj.Id(),0],["title",cj.Id(),0],["label_font_size",cj.Id(),0],["tick_font_size",cj.Id(),0],["x_ticks",cj.EncodeList(cj.Id()),0],["y_ticks",cj.EncodeList(cj.Id()),0],["x_min",cj.Id(),1],["x_max",cj.Id(),1],["y_min",cj.Id(),1],["y_max",cj.Id(),1],["v_boundaries",cj.EncodeList(cj.Id()),0],["h_boundaries",cj.EncodeList(cj.Id()),0]]))();};bM.j$67=function(){return bM._v$67?bM._v$67:bM._v$67=(cj.EncodeUnion(cb,{Function:1,MassAction:0},[["MassAction",[["$0","MassAction",cj.Id(),0]]],["Function",[["$0","Function",cj.Id(),0]]]]))();};bM.j$69=function(){return bM._v$69?bM._v$69:bM._v$69=(cj.EncodeRecord(void 0,[["random",cj.Id(),0],["core",bM.j$70,1],["points",cj.EncodeList(bM.j$71),0],["rectangles",cj.EncodeList(bM.j$72),0]]))();};bM.j$85=function(){return bM._v$85?bM._v$85:bM._v$85=(cj.EncodeRecord(void 0,[["pType",bM.j$86,0],["lb",cj.Id(),0],["ub",cj.Id(),0]]))();};bM.j$87=function(){return bM._v$87?bM._v$87:bM._v$87=(cj.EncodeRecord(void 0,[["values",cj.EncodeStringDictionary(cj.Id()),0],["lglk",cj.Id(),0]]))();};bM.j$88=function(){return bM._v$88?bM._v$88:bM._v$88=(cj.EncodeUnion(void 0,"$",[null,[1,[["$0","Value",bM.j$89,0]]]]))();};bM.j$104=function(){return bM._v$104?bM._v$104:bM._v$104=(cj.EncodeRecord(P,[["name",cj.Id(),0],["initial",cj.Id(),0],["final",cj.Id(),0],["points",cj.Id(),0],["plots",cj.EncodeList(bM.j$97),0],["plotcolours",cj.EncodeList(cj.Id()),0],["seed",cj.Id(),1],["kinetics",bM.j$20,0],["times",cj.EncodeList(cj.Id()),0],["prune",cj.Id(),0],["multicore",cj.Id(),0],["data",cj.EncodeList(cj.Id()),0],["sweeps",cj.EncodeList(cj.Id()),0]]))();};bM.j$56=function(){return bM._v$56?bM._v$56:bM._v$56=(cj.EncodeRecord(void 0,[["name",cj.Id(),0],["values",cj.EncodeList(cj.Id()),0]]))();};bM.j$108=function(){return bM._v$108?bM._v$108:bM._v$108=(cj.EncodeUnion(void 0,"$",[null,null,null]))();};bM.j$20=function(){return bM._v$20?bM._v$20:bM._v$20=(cj.EncodeUnion(void 0,"$",[null,null,null]))();};bL.j$32=function(){return bL._v$32?bL._v$32:bL._v$32=(cj.DecodeUnion(void 0,"$",[null,null]))();};bL.j$34=function(){return bL._v$34?bL._v$34:bL._v$34=(cj.DecodeUnion(void 0,"$",[null,null]))();};bL.j$35=function(){return bL._v$35?bL._v$35:bL._v$35=(cj.DecodeUnion(void 0,"$",[[0,[["$0","Fixed",cj.Id(),0]]],null,null]))();};bL.j$38=function(){return bL._v$38?bL._v$38:bL._v$38=(cj.DecodeUnion(void 0,"$",[null,null]))();};bL.j$39=function(){return bL._v$39?bL._v$39:bL._v$39=(cj.DecodeUnion(void 0,"$",[null,null]))();};bL.j$41=function(){return bL._v$41?bL._v$41:bL._v$41=(cj.DecodeRecord(void 0,[["times",cj.DecodeList(cj.Id()),0],["columns",cj.DecodeList(bL.j$42),0]]))();};bL.j$44=function(){return bL._v$44?bL._v$44:bL._v$44=(cj.DecodeUnion(b4,{Molar:0},[["Molar",[["$0","Molar",cj.Id(),0]]]]))();};bL.j$45=function(){return bL._v$45?bL._v$45:bL._v$45=(cj.DecodeUnion(b5,{Seconds:0},[["Seconds",[["$0","Seconds",cj.Id(),0]]]]))();};bL.j$46=function(){return bL._v$46?bL._v$46:bL._v$46=(cj.DecodeUnion(b6,{Metres:0},[["Metres",[["$0","Metres",cj.Id(),0]]]]))();};bL.j$24=function(){return bL._v$24?bL._v$24:bL._v$24=(cj.DecodeRecord(void 0,[["interval",bL.j$25,0],["distribution",bL.j$26,0],["variation",bL.j$31,0]]))();};bL.j$49=function(){return bL._v$49?bL._v$49:bL._v$49=(cj.DecodeRecord(b8,[["variables",cj.DecodeList(cj.Id()),0],["values",cj.DecodeList(cj.DecodeList(bL.j$7)),0]]))();};bL.j$56=function(){return bL._v$56?bL._v$56:bL._v$56=(cj.DecodeRecord(ce,[["inner",cj.Id(),0],["outer",cj.Id(),0],["width",cj.Id(),0]]))();};bL.j$57=function(){return bL._v$57?bL._v$57:bL._v$57=(cj.DecodeRecord(cf,[["x",cj.Id(),0],["y",cj.Id(),0],["width",cj.Id(),0],["value",cj.Id(),0]]))();};bL.j$58=function(){return bL._v$58?bL._v$58:bL._v$58=(cj.DecodeRecord(cg,[["xmin",cj.Id(),0],["xmax",cj.Id(),0],["ymin",cj.Id(),0],["ymax",cj.Id(),0],["value",cj.Id(),0]]))();};bM.j$33=function(){return bM._v$33?bM._v$33:bM._v$33=(cj.EncodeUnion(void 0,{Item1:13,Round:12,Floor:11,Ceiling:10,Modulo:9,Log:8,Absolute:7,Minus:6,Plus:5,Power:4,Divide:3,Times:2,Float:1,Key:0},[["Key",[["$0","Key",cj.Id(),0]]],["Float",[["$0","Float",cj.Id(),0]]],["Times",[["$0","Times",cj.EncodeList(bM.j$33),0]]],["Divide",[["$0","Divide",bM.j$38,0]]],["Power",[["$0","Power",bM.j$37,0]]],["Plus",[["$0","Plus",cj.EncodeList(bM.j$33),0]]],["Minus",[["$0","Minus",bM.j$36,0]]],["Absolute",[["$0","Absolute",bM.j$33,0]]],["Log",[["$0","Log",bM.j$33,0]]],["Modulo",[["$0","Modulo",bM.j$35,0]]],["Ceiling",[["$0","Ceiling",bM.j$33,0]]],["Floor",[["$0","Floor",bM.j$33,0]]],["Round",[["$0","Round",bM.j$33,0]]],["If",[["$0","Item1",bM.j$34,0],["$1","Item2",bM.j$33,0],["$2","Item3",bM.j$33,0]]]]))();};bM.j$39=function(){return bM._v$39?bM._v$39:bM._v$39=(cj.EncodeUnion(void 0,"$",[null,null]))();};bM.j$41=function(){return bM._v$41?bM._v$41:bM._v$41=(cj.EncodeUnion(void 0,"$",[null,null]))();};bM.j$42=function(){return bM._v$42?bM._v$42:bM._v$42=(cj.EncodeUnion(void 0,"$",[[0,[["$0","Fixed",cj.Id(),0]]],null,null]))();};bM.j$44=function(){return bM._v$44?bM._v$44:bM._v$44=(cj.EncodeUnion(void 0,{Item1:13,Round:12,Floor:11,Ceiling:10,Modulo:9,Log:8,Absolute:7,Minus:6,Plus:5,Power:4,Divide:3,Times:2,Float:1,Key:0},[["Key",[["$0","Key",cj.EncodeList(cj.EncodeTuple([cj.Id(),cj.Id()])),0]]],["Float",[["$0","Float",cj.Id(),0]]],["Times",[["$0","Times",cj.EncodeList(bM.j$44),0]]],["Divide",[["$0","Divide",bM.j$50,0]]],["Power",[["$0","Power",bM.j$49,0]]],["Plus",[["$0","Plus",cj.EncodeList(bM.j$44),0]]],["Minus",[["$0","Minus",bM.j$48,0]]],["Absolute",[["$0","Absolute",bM.j$44,0]]],["Log",[["$0","Log",bM.j$44,0]]],["Modulo",[["$0","Modulo",bM.j$47,0]]],["Ceiling",[["$0","Ceiling",bM.j$44,0]]],["Floor",[["$0","Floor",bM.j$44,0]]],["Round",[["$0","Round",bM.j$44,0]]],["If",[["$0","Item1",bM.j$46,0],["$1","Item2",bM.j$44,0],["$2","Item3",bM.j$44,0]]]]))();};bM.j$52=function(){return bM._v$52?bM._v$52:bM._v$52=(cj.EncodeUnion(void 0,"$",[null,null]))();};bM.j$53=function(){return bM._v$53?bM._v$53:bM._v$53=(cj.EncodeUnion(void 0,"$",[null,null]))();};bM.j$58=function(){return bM._v$58?bM._v$58:bM._v$58=(cj.EncodeUnion(b4,{Molar:0},[["Molar",[["$0","Molar",cj.Id(),0]]]]))();};bM.j$59=function(){return bM._v$59?bM._v$59:bM._v$59=(cj.EncodeUnion(b5,{Seconds:0},[["Seconds",[["$0","Seconds",cj.Id(),0]]]]))();};bM.j$60=function(){return bM._v$60?bM._v$60:bM._v$60=(cj.EncodeUnion(b6,{Metres:0},[["Metres",[["$0","Metres",cj.Id(),0]]]]))();};bM.j$25=function(){return bM._v$25?bM._v$25:bM._v$25=(cj.EncodeRecord(void 0,[["interval",bM.j$26,0],["distribution",bM.j$27,0],["variation",bM.j$32,0]]))();};bM.j$63=function(){return bM._v$63?bM._v$63:bM._v$63=(cj.EncodeRecord(b8,[["variables",cj.EncodeList(cj.Id()),0],["values",cj.EncodeList(cj.EncodeList(bM.j$33)),0]]))();};bM.j$70=function(){return bM._v$70?bM._v$70:bM._v$70=(cj.EncodeRecord(ce,[["inner",cj.Id(),0],["outer",cj.Id(),0],["width",cj.Id(),0]]))();};bM.j$71=function(){return bM._v$71?bM._v$71:bM._v$71=(cj.EncodeRecord(cf,[["x",cj.Id(),0],["y",cj.Id(),0],["width",cj.Id(),0],["value",cj.Id(),0]]))();};bM.j$72=function(){return bM._v$72?bM._v$72:bM._v$72=(cj.EncodeRecord(cg,[["xmin",cj.Id(),0],["xmax",cj.Id(),0],["ymin",cj.Id(),0],["ymax",cj.Id(),0],["value",cj.Id(),0]]))();};bM.j$86=function(){return bM._v$86?bM._v$86:bM._v$86=(cj.EncodeUnion(void 0,"$",[[0,[]],[1,[]],[2,[]]]))();};bM.j$89=function(){return bM._v$89?bM._v$89:bM._v$89=(cj.EncodeUnion(void 0,"$",[[0,[[null,true,cj.Id()]]],[1,[[null,true,cj.Id()]]],[2,[[null,true,cj.Id()]]]]))();};bM.j$97=function(){return bM._v$97?bM._v$97:bM._v$97=(cj.EncodeUnion(void 0,{Item1:13,Round:12,Floor:11,Ceiling:10,Modulo:9,Log:8,Absolute:7,Minus:6,Plus:5,Power:4,Divide:3,Times:2,Float:1,Key:0},[["Key",[["$0","Key",bM.j$98,0]]],["Float",[["$0","Float",cj.Id(),0]]],["Times",[["$0","Times",cj.EncodeList(bM.j$97),0]]],["Divide",[["$0","Divide",bM.j$103,0]]],["Power",[["$0","Power",bM.j$102,0]]],["Plus",[["$0","Plus",cj.EncodeList(bM.j$97),0]]],["Minus",[["$0","Minus",bM.j$101,0]]],["Absolute",[["$0","Absolute",bM.j$97,0]]],["Log",[["$0","Log",bM.j$97,0]]],["Modulo",[["$0","Modulo",bM.j$100,0]]],["Ceiling",[["$0","Ceiling",bM.j$97,0]]],["Floor",[["$0","Floor",bM.j$97,0]]],["Round",[["$0","Round",bM.j$97,0]]],["If",[["$0","Item1",bM.j$99,0],["$1","Item2",bM.j$97,0],["$2","Item3",bM.j$97,0]]]]))();};bL.j$42=function(){return bL._v$42?bL._v$42:bL._v$42=(cj.DecodeRecord(void 0,[["name",cj.Id(),0],["values",cj.DecodeList(cj.Id()),0]]))();};bL.j$25=function(){return bL._v$25?bL._v$25:bL._v$25=(cj.DecodeUnion(void 0,"$",[null,null]))();};bL.j$26=function(){return bL._v$26?bL._v$26:bL._v$26=(cj.DecodeUnion(bU,{TruncatedNormal:3,LogNormal:2,Normal:1,Uniform:0},[["Uniform",[["$0","Uniform",bL.j$30,0]]],["Normal",[["$0","Normal",bL.j$29,0]]],["LogNormal",[["$0","LogNormal",bL.j$28,0]]],["TruncatedNormal",[["$0","TruncatedNormal",bL.j$27,0]]]]))();};bL.j$31=function(){return bL._v$31?bL._v$31:bL._v$31=(cj.DecodeUnion(void 0,"$",[null,null,null,null]))();};bM.j$38=function(){return bM._v$38?bM._v$38:bM._v$38=(cj.EncodeRecord(void 0,[["div1",bM.j$33,0],["div2",bM.j$33,0]]))();};bM.j$37=function(){return bM._v$37?bM._v$37:bM._v$37=(cj.EncodeRecord(void 0,[["base_",bM.j$33,0],["exponent",bM.j$33,0]]))();};bM.j$36=function(){return bM._v$36?bM._v$36:bM._v$36=(cj.EncodeRecord(void 0,[["sub1",bM.j$33,0],["sub2",bM.j$33,0]]))();};bM.j$35=function(){return bM._v$35?bM._v$35:bM._v$35=(cj.EncodeRecord(void 0,[["div",bM.j$33,0],["modulo",bM.j$33,0]]))();};bM.j$34=function(){return bM._v$34?bM._v$34:bM._v$34=(cj.EncodeUnion(void 0,"$",[[0,[]],[1,[]],[2,[["$0","Item1",bM.j$33,0],["$1","Item2",bM.j$33,0]]],[3,[["$0","Item1",bM.j$33,0],["$1","Item2",bM.j$33,0]]],[4,[["$0","Item1",bM.j$33,0],["$1","Item2",bM.j$33,0]]],[5,[["$0","Item1",bM.j$33,0],["$1","Item2",bM.j$33,0]]],[6,[["$0","Item1",bM.j$33,0],["$1","Item2",bM.j$33,0]]],[7,[["$0","Item",bM.j$34,0]]],[8,[["$0","Item1",bM.j$34,0],["$1","Item2",bM.j$34,0]]],[9,[["$0","Item1",bM.j$34,0],["$1","Item2",bM.j$34,0]]]]))();};bM.j$50=function(){return bM._v$50?bM._v$50:bM._v$50=(cj.EncodeRecord(void 0,[["div1",bM.j$44,0],["div2",bM.j$44,0]]))();};bM.j$49=function(){return bM._v$49?bM._v$49:bM._v$49=(cj.EncodeRecord(void 0,[["base_",bM.j$44,0],["exponent",bM.j$44,0]]))();};bM.j$48=function(){return bM._v$48?bM._v$48:bM._v$48=(cj.EncodeRecord(void 0,[["sub1",bM.j$44,0],["sub2",bM.j$44,0]]))();};bM.j$47=function(){return bM._v$47?bM._v$47:bM._v$47=(cj.EncodeRecord(void 0,[["div",bM.j$44,0],["modulo",bM.j$44,0]]))();};bM.j$46=function(){return bM._v$46?bM._v$46:bM._v$46=(cj.EncodeUnion(void 0,"$",[[0,[]],[1,[]],[2,[["$0","Item1",bM.j$44,0],["$1","Item2",bM.j$44,0]]],[3,[["$0","Item1",bM.j$44,0],["$1","Item2",bM.j$44,0]]],[4,[["$0","Item1",bM.j$44,0],["$1","Item2",bM.j$44,0]]],[5,[["$0","Item1",bM.j$44,0],["$1","Item2",bM.j$44,0]]],[6,[["$0","Item1",bM.j$44,0],["$1","Item2",bM.j$44,0]]],[7,[["$0","Item",bM.j$46,0]]],[8,[["$0","Item1",bM.j$46,0],["$1","Item2",bM.j$46,0]]],[9,[["$0","Item1",bM.j$46,0],["$1","Item2",bM.j$46,0]]]]))();};bM.j$26=function(){return bM._v$26?bM._v$26:bM._v$26=(cj.EncodeUnion(void 0,"$",[null,null]))();};bM.j$27=function(){return bM._v$27?bM._v$27:bM._v$27=(cj.EncodeUnion(bU,{TruncatedNormal:3,LogNormal:2,Normal:1,Uniform:0},[["Uniform",[["$0","Uniform",bM.j$31,0]]],["Normal",[["$0","Normal",bM.j$30,0]]],["LogNormal",[["$0","LogNormal",bM.j$29,0]]],["TruncatedNormal",[["$0","TruncatedNormal",bM.j$28,0]]]]))();};bM.j$32=function(){return bM._v$32?bM._v$32:bM._v$32=(cj.EncodeUnion(void 0,"$",[null,null,null,null]))();};bM.j$98=function(){return bM._v$98?bM._v$98:bM._v$98=(cj.EncodeUnion(void 0,"$",[[0,[["$0","Item",cj.Id(),0]]],[1,[["$0","Item",cj.Id(),0]]],[2,[[null,true,cj.Id()]]],[3,[]]]))();};bM.j$103=function(){return bM._v$103?bM._v$103:bM._v$103=(cj.EncodeRecord(void 0,[["div1",bM.j$97,0],["div2",bM.j$97,0]]))();};bM.j$102=function(){return bM._v$102?bM._v$102:bM._v$102=(cj.EncodeRecord(void 0,[["base_",bM.j$97,0],["exponent",bM.j$97,0]]))();};bM.j$101=function(){return bM._v$101?bM._v$101:bM._v$101=(cj.EncodeRecord(void 0,[["sub1",bM.j$97,0],["sub2",bM.j$97,0]]))();};bM.j$100=function(){return bM._v$100?bM._v$100:bM._v$100=(cj.EncodeRecord(void 0,[["div",bM.j$97,0],["modulo",bM.j$97,0]]))();};bM.j$99=function(){return bM._v$99?bM._v$99:bM._v$99=(cj.EncodeUnion(void 0,"$",[[0,[]],[1,[]],[2,[["$0","Item1",bM.j$97,0],["$1","Item2",bM.j$97,0]]],[3,[["$0","Item1",bM.j$97,0],["$1","Item2",bM.j$97,0]]],[4,[["$0","Item1",bM.j$97,0],["$1","Item2",bM.j$97,0]]],[5,[["$0","Item1",bM.j$97,0],["$1","Item2",bM.j$97,0]]],[6,[["$0","Item1",bM.j$97,0],["$1","Item2",bM.j$97,0]]],[7,[["$0","Item",bM.j$99,0]]],[8,[["$0","Item1",bM.j$99,0],["$1","Item2",bM.j$99,0]]],[9,[["$0","Item1",bM.j$99,0],["$1","Item2",bM.j$99,0]]]]))();};bL.j$30=function(){return bL._v$30?bL._v$30:bL._v$30=(cj.DecodeRecord(bT,[["min",cj.Id(),0],["max",cj.Id(),0]]))();};bL.j$29=function(){return bL._v$29?bL._v$29:bL._v$29=(cj.DecodeRecord(bS,[["mean",cj.Id(),0],["stdev",cj.Id(),0]]))();};bL.j$28=function(){return bL._v$28?bL._v$28:bL._v$28=(cj.DecodeRecord(bR,[["mu",cj.Id(),0],["sigma",cj.Id(),0]]))();};bL.j$27=function(){return bL._v$27?bL._v$27:bL._v$27=(cj.DecodeRecord(bQ,[["mean",cj.Id(),0],["stdev",cj.Id(),0],["min",cj.Id(),0],["max",cj.Id(),0]]))();};bM.j$31=function(){return bM._v$31?bM._v$31:bM._v$31=(cj.EncodeRecord(bT,[["min",cj.Id(),0],["max",cj.Id(),0]]))();};bM.j$30=function(){return bM._v$30?bM._v$30:bM._v$30=(cj.EncodeRecord(bS,[["mean",cj.Id(),0],["stdev",cj.Id(),0]]))();};bM.j$29=function(){return bM._v$29?bM._v$29:bM._v$29=(cj.EncodeRecord(bR,[["mu",cj.Id(),0],["sigma",cj.Id(),0]]))();};bM.j$28=function(){return bM._v$28?bM._v$28:bM._v$28=(cj.EncodeRecord(bQ,[["mean",cj.Id(),0],["stdev",cj.Id(),0],["min",cj.Id(),0],["max",cj.Id(),0]]))();};bO.to_string=function(fB){return bO.to_string_defaults(bO.get_defaults(),fB);};bO.get_defaults=function(){return bO.New(false,1E-06,1E-05);};bO.to_string_defaults=function(fB,fC){return db.emit_record(fB,A.ofArray([["stiff",function(fD){return(function(fE){return function(fF){return fE(a.String(fF));};}(a.id))(fD.stiff);}],["reltolerance",function(fD){return a.String(fD.reltolerance);}],["abstolerance",function(fD){return a.String(fD.abstolerance);}]]),fC);};bO.get_parse=function(){return bO.parse_defaults(bO.get_defaults());};bO.parse_defaults=function(fB){var fC;function fD(fJ,fK){return dz.op_DotGreaterGreater(D.pbool(),fC,fJ,fK);}function fE(fJ,fK){return bO.New(fJ,fK.abstolerance,fK.reltolerance);}function fF(fJ,fK){return dz.op_DotGreaterGreater(D.pfloat(),fC,fJ,fK);}function fG(fJ,fK){return bO.New(fK.stiff,fJ,fK.reltolerance);}function fH(fJ,fK){return dz.op_DotGreaterGreater(D.pfloat(),fC,fJ,fK);}function fI(fJ,fK){return bO.New(fK.stiff,fK.abstolerance,fJ);}fC=D.spaces();return D.record(fB,A.ofArray([["stiff",function(fJ){return dz.op_BarGreaterGreater(function(fK){return fD(fK[0],fK[1]);},function(fK){return function(fL){return fE(fK,fL);};},fJ[0],fJ[1]);}],["abstolerance",function(fJ){return dz.op_BarGreaterGreater(function(fK){return fF(fK[0],fK[1]);},function(fK){return function(fL){return fG(fK,fL);};},fJ[0],fJ[1]);}],["reltolerance",function(fJ){return dz.op_BarGreaterGreater(function(fK){return fH(fK[0],fK[1]);},function(fK){return function(fL){return fI(fK,fL);};},fJ[0],fJ[1]);}]]));};bO.New=function(fB,fC,fD){return{stiff:fB,abstolerance:fC,reltolerance:fD};};bP.to_string=function(fB){return fB=="Log"?"Log":"Real";};bP.get_parse=function(){var fB,fC,fD;function fE(fG){return"Real";}function fF(fG){return"Log";}fB=D.choice([(fC=D.kw("Real"),function(fG){return dz.op_BarGreaterGreater(fC,fE,fG[0],fG[1]);}),(fD=D.kw("Log"),function(fG){return dz.op_BarGreaterGreater(fD,fF,fG[0],fG[1]);})]);return function(fG){return fB([fG[0],fG[1]]);};};bQ=d.Truncated=fu.Class({},null,bQ);bQ.New=function(fB,fC,fD,fE){return new bQ({mean:fB,stdev:fC,min:fD,max:fE});};bR=d.LogNormal=fu.Class({mode:function(){return fv.exp(this.mu-this.sigma*this.sigma);},quantile:function(fB){return fv.exp(dn.erfinv(2*fB-1)*fv.sqrt(2)*this.sigma+this.mu);}},null,bR);bR.New=function(fB,fC){return new bR({mu:fB,sigma:fC});};bS=d.Normal=fu.Class({},null,bS);bS.New=function(fB,fC){return new bS({mean:fB,stdev:fC});};bT=d.Uniform=fu.Class({},null,bT);bT.New=function(fB,fC){return new bT({min:fB,max:fC});};bU=d.Distribution=fu.Class({},null,bU);bU.to_string=function(fB){return fB.$==1?(((fu.Curried3(function(fC,fD,fE){return fC("Normal("+_2.toSafe(fD)+","+_2.toSafe(fE)+")");}))(a.id))(a.String(fB.$0.mean)))(a.String(fB.$0.stdev)):fB.$==2?(((fu.Curried3(function(fC,fD,fE){return fC("LogNormal("+_2.toSafe(fD)+","+_2.toSafe(fE)+")");}))(a.id))(a.String(fB.$0.mu)))(a.String(fB.$0.sigma)):fB.$==3?(((((fu.Curried(function(fC,fD,fE,fF,fG){return fC("TruncatedNormal("+_2.toSafe(fD)+","+_2.toSafe(fE)+","+_2.toSafe(fF)+","+_2.toSafe(fG)+")");},5))(a.id))(a.String(fB.$0.mean)))(a.String(fB.$0.stdev)))(a.String(fB.$0.min)))(a.String(fB.$0.max)):(((fu.Curried3(function(fC,fD,fE){return fC("Uniform("+_2.toSafe(fD)+","+_2.toSafe(fE)+")");}))(a.id))(a.String(fB.$0.min)))(a.String(fB.$0.max));};bU.get_parse=function(){var fB,fC,fD,fE,fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO,fP,fQ,fR,fS,fT,fU,fV,fW,fX,fY,fZ,f0,f1,f2,f3,f4,f5;function f6(f_,f$){return new bU({$:0,$0:bT.New(f_,f$)});}function f7(f_,f$){return new bU({$:1,$0:bS.New(f_,f$)});}function f8(f_,f$){return new bU({$:2,$0:bR.New(f_,f$)});}function f9(f_,f$){return new bU({$:3,$0:bQ.New(f_[0],f_[1],f$[0],f$[1])});}fB=D.choice([(fC=(fD=D.kw("Uniform"),(fE=(fF=(fG=(fH=D.skw(","),function(f_){return dz.op_GreaterGreaterDot(fH,D.pfloat(),f_[0],f_[1]);}),function(f_){return dz.op_DotGreaterGreaterDot(D.pfloat(),fG,f_[0],f_[1]);}),(D.bracket("(",")"))(fF)),function(f_){return dz.op_GreaterGreaterDot(fD,fE,f_[0],f_[1]);})),function(f_){return dz.op_BarGreaterGreater(fC,function(f$){return f6(f$[0],f$[1]);},f_[0],f_[1]);}),(fI=(fJ=D.kw("Normal"),(fK=(fL=(fM=(fN=D.skw(","),function(f_){return dz.op_GreaterGreaterDot(fN,D.pfloat(),f_[0],f_[1]);}),function(f_){return dz.op_DotGreaterGreaterDot(D.pfloat(),fM,f_[0],f_[1]);}),(D.bracket("(",")"))(fL)),function(f_){return dz.op_GreaterGreaterDot(fJ,fK,f_[0],f_[1]);})),function(f_){return dz.op_BarGreaterGreater(fI,function(f$){return f7(f$[0],f$[1]);},f_[0],f_[1]);}),(fO=(fP=D.kw("LogNormal"),(fQ=(fR=(fS=(fT=D.skw(","),function(f_){return dz.op_GreaterGreaterDot(fT,D.pfloat(),f_[0],f_[1]);}),function(f_){return dz.op_DotGreaterGreaterDot(D.pfloat(),fS,f_[0],f_[1]);}),(D.bracket("(",")"))(fR)),function(f_){return dz.op_GreaterGreaterDot(fP,fQ,f_[0],f_[1]);})),function(f_){return dz.op_BarGreaterGreater(fO,function(f$){return f8(f$[0],f$[1]);},f_[0],f_[1]);}),(fU=(fV=D.kw("TruncatedNormal"),(fW=(fX=(fY=(fZ=(f0=(f1=D.skw(","),function(f_){return dz.op_GreaterGreaterDot(f1,D.pfloat(),f_[0],f_[1]);}),function(f_){return dz.op_DotGreaterGreaterDot(D.pfloat(),f0,f_[0],f_[1]);}),(f2=D.skw(","),function(f_){return dz.op_DotGreaterGreater(fZ,f2,f_[0],f_[1]);})),(f3=(f4=(f5=D.skw(","),function(f_){return dz.op_GreaterGreaterDot(f5,D.pfloat(),f_[0],f_[1]);}),function(f_){return dz.op_DotGreaterGreaterDot(D.pfloat(),f4,f_[0],f_[1]);}),function(f_){return dz.op_DotGreaterGreaterDot(fY,f3,f_[0],f_[1]);})),(D.bracket("(",")"))(fX)),function(f_){return dz.op_GreaterGreaterDot(fV,fW,f_[0],f_[1]);})),function(f_){return dz.op_BarGreaterGreater(fU,function(f$){return f9(f$[0],f$[1]);},f_[0],f_[1]);})]);return function(f_){return fB([f_[0],f_[1]]);};};bV.to_string=function(fB){return fB=="Fixed"?"Fixed":fB=="Initial"?"Initial":fB=="Multiple"?"Multiple":"Random";};bV.get_parse=function(){var fB,fC,fD,fE,fF;function fG(fK){return"Random";}function fH(fK){return"Fixed";}function fI(fK){return"Initial";}function fJ(fK){return"Multiple";}fB=D.choice([(fC=D.kw("Random"),function(fK){return dz.op_BarGreaterGreater(fC,fG,fK[0],fK[1]);}),(fD=D.kw("Fixed"),function(fK){return dz.op_BarGreaterGreater(fD,fH,fK[0],fK[1]);}),(fE=D.kw("Initial"),function(fK){return dz.op_BarGreaterGreater(fE,fI,fK[0],fK[1]);}),(fF=D.kw("Multiple"),function(fK){return dz.op_BarGreaterGreater(fF,fJ,fK[0],fK[1]);})]);return function(fK){return fB([fK[0],fK[1]]);};};bW.is_fixed=function(fB){return bk.Equals(fB.variation,"Fixed");};bW.is_multiple=function(fB){return bk.Equals(fB.variation,"Multiple");};bW.vary=function(fB){return bW.New(fB.interval,fB.distribution,"Random");};bW.to_string=function(fB){return((((fu.Curried(function(fC,fD,fE,fF){return fC("{interval="+_2.toSafe(fD)+"; distribution="+_2.toSafe(fE)+"; variation="+_2.toSafe(fF)+"}");},4))(a.id))(bP.to_string(fB.interval)))(bU.to_string(fB.distribution)))(bV.to_string(fB.variation));};bW.get_parse=function(){var fB,fC,fD;function fE(fH,fI){return bW.New(fH,fI.distribution,fI.variation);}function fF(fH,fI){return bW.New(fI.interval,fH,fI.variation);}function fG(fH,fI){return bW.New(fI.interval,fI.distribution,fH);}return D.record(bW.get_empty(),A.ofArray([["interval",(fB=bP.get_parse(),function(fH){return dz.op_BarGreaterGreater(fB,function(fI){return function(fJ){return fE(fI,fJ);};},fH[0],fH[1]);})],["distribution",(fC=bU.get_parse(),function(fH){return dz.op_BarGreaterGreater(fC,function(fI){return function(fJ){return fF(fI,fJ);};},fH[0],fH[1]);})],["variation",(fD=bV.get_parse(),function(fH){return dz.op_BarGreaterGreater(fD,function(fI){return function(fJ){return fG(fI,fJ);};},fH[0],fH[1]);})]]));};bW.get_empty=function(){return bW.New("Log",new bU({$:0,$0:bT.New(0,0)}),"Random");};bW.New=function(fB,fC,fD){return{interval:fB,distribution:fC,variation:fD};};bX=d.Parameter=fu.Class({},null,bX);bX.variable=function(fB){var fC;fC=fB.prior;return fC!=null&&fC.$==1&&!bW.is_fixed(fC.$0);};bX.substitute=function(fB,fC){var fD;fD=K.TryFind(fC.name,fB);return fD!=null&&fD.$==1?bX.create$1(fC.name,fD.$0,fC.prior):fC;};bX.is_multiple=function(fB){var fC;fC=fB.prior;return fC!=null&&fC.$==1&&bW.is_multiple(fC.$0);};bX.create$1=function(fB,fC,fD){return bX.New(fB,fC,fD);};bX.getname=function(fB){return fB.name;};bX.to_string=function(fB){var fC,fD;fC=(fD=fB.prior,fD==null?"":(function(fE){return function(fF){return fE(", "+_2.toSafe(fF));};}(a.id))(bW.to_string(fD.$0)));return((((fu.Curried(function(fE,fF,fG,fH){return fE(_2.toSafe(fF)+" = "+_2.toSafe(fG)+_2.toSafe(fH));},4))(a.id))(fB.name))(a.String(fB.value)))(fC);};bX.to_filzbach=function(fB){var fC,fD,fE,fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO,fP,fQ,fR,fS,fT;fC=fB.prior;return fC==null?bC.New(fB.name,br.New(ck.Fixed,fB.value,fB.value),{$:1,$0:fB.value},null,false):(fD=fC.$0,(fE=bk.Equals(fD.variation,"Fixed")?ck.Fixed:fD.interval=="Log"?ck.Log:ck.Real,(fF=(fG=fD.distribution,fG.$==1?(fH=fG.$0.stdev,(fI=fG.$0.mean,(fJ=20,(fK=fI-fJ*fH,(fL=fI+fJ*fH,fE.$==1?br.New(fE,(fM=0,bk.Compare(fK,fM)===1?fK:fM),fL):fE.$==2?br.New(fE,fI,fI):br.New(fE,fK,fL)))))):fG.$==2?(fN=fG.$0,br.New(fE,fN.quantile(1E-06),fN.quantile(1-1E-06))):fG.$==3?(fO=fG.$0,br.New(fE,fO.min,fO.max)):br.New(fE,fG.$0.min,fG.$0.max)),(fP=(fQ=fD.distribution,fQ.$==1?(fR=fQ.$0,[{$:1,$0:bn.createNormal(fR.mean,fR.stdev)},fR.mean]):fQ.$==2?(fS=fQ.$0,[{$:1,$0:bn.createLogNormal(fS.mu,fS.sigma)},fS.mode()]):fQ.$==3?(fT=fQ.$0,[{$:1,$0:bn.createTruncatedNormal(fT.mean,fT.stdev,fT.min,fT.max)},fT.mean]):[null,fB.value]),bC.New(fB.name,fF,{$:1,$0:fP[1]},fP[0],true)))));};bX.get_parse=function(){var fB,fC,fD;function fE(fF,fG){var fH,fI,fJ,fK,fL;function fM(fN){return D.preturn(bX.create$1(fF,fG,{$:1,$0:fN}));}fH=(fI=(fJ=D.skw(","),(fK=bW.get_parse(),function(fN){return dz.op_GreaterGreaterDot(fJ,fK,fN[0],fN[1]);})),function(fN){return dz.op_GreaterGreaterEquals(fI,fM,fN[0],fN[1]);});fL=D.preturn(bX.create$1(fF,fG,null));return function(fN){return dz.op_LessBarGreater(fH,fL,fN[0],fN[1]);};}fB=(fC=(fD=D.skw("="),function(fF){return dz.op_GreaterGreaterDot(fD,D.pfloat(),fF[0],fF[1]);}),function(fF){return dz.op_DotGreaterGreaterDot(D.name(),fC,fF[0],fF[1]);});return function(fF){return dz.op_GreaterGreaterEquals(fB,function(fG){return fE(fG[0],fG[1]);},fF[0],fF[1]);};};bX.New=function(fB,fC,fD){return new bX({name:fB,value:fC,prior:fD});};bY.to_string=function(fB){return fB=="Proportional"?"proportional":"constant";};bY.get_parse=function(){var fB;fB=D.choice([D.op_GreaterGreaterPercent(D.kw("constant"),"Constant"),D.op_GreaterGreaterPercent(D.kw("proportional"),"Proportional")]);return function(fC){return fB([fC[0],fC[1]]);};};bZ.to_string=function(fB){return fB=="Random"?"Random":fB=="Multiple"?"Multiple":(function(fC){return function(fD){return fC("Fixed("+fD.toFixed(6)+")");};}(a.id))(fB.$0);};bZ.get_parse=function(){var fB,fC;fB=D.choice([D.op_BarGreaterGreater(D.op_GreaterGreaterDot(D.kw("Fixed"),(fC=D.pfloat(),(D.bracket("(",")"))(fC))),function(fD){return{$:0,$0:fD};}),D.op_GreaterGreaterPercent(D.kw("Random"),"Random"),D.op_GreaterGreaterPercent(D.kw("Multiple"),"Multiple")]);return function(fD){return fB([fD[0],fD[1]]);};};b0.get_defaults=function(){return b0.New("default",100,100,10,"Constant","Random",false,0,B.Empty,null,false,false,true,true);};b0.get_to_string=function(){var fB,fC;fB=b0.get_defaults();fC=A.ofArray([["name",function(fD){return fD.name;}],["burnin",function(fD){return(function(fE){return function(fF){return fE(a.String(fF));};}(a.id))(fD.burnin);}],["samples",function(fD){return(function(fE){return function(fF){return fE(a.String(fF));};}(a.id))(fD.samples);}],["thin",function(fD){return(function(fE){return function(fF){return fE(a.String(fF));};}(a.id))(fD.thin);}],["seed",function(fD){return(function(fE){return function(fF){return fE(a.String(fF));};}(a.id))(fD.seed);}],["seeds",function(fD){var fE;fE=dk.concat("; ",A.map(function(fF){return function(fG){return fF(a.String(fG));};}(a.id),fD.seeds));return(function(fF){return function(fG){return fF("[ "+_2.toSafe(fG)+" ]");};}(a.id))(fE);}],["lowerbound",function(fD){var fE;fE=fD.lowerbound;return fE==null?"":a.String(fE.$0);}],["noise_model",function(fD){return bY.to_string(fD.noise_model);}],["noise_parameter",function(fD){return bZ.to_string(fD.noise_parameter);}],["prune",function(fD){return(function(fE){return function(fF){return fE(a.String(fF));};}(a.id))(fD.prune);}],["timer",function(fD){return(function(fE){return function(fF){return fE(a.String(fF));};}(a.id))(fD.timer);}],["print_console",function(fD){return(function(fE){return function(fF){return fE(a.String(fF));};}(a.id))(fD.print_console);}],["print_summary",function(fD){return(function(fE){return function(fF){return fE(a.String(fF));};}(a.id))(fD.print_summary);}],["partial",function(fD){return(function(fE){return function(fF){return fE(a.String(fF));};}(a.id))(fD.partial_evaluation);}]]);return function(fD){return db.emit_record(fB,fC,fD);};};b0.parse_defaults=function(fB){var fC,fD,fE,fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO,fP;function fQ(f5,f6,f7){return(D.op_BarGreaterGreater(f5,f6))(f7);}function fR(f5,f6){return b0.New(f5,f6.burnin,f6.samples,f6.thin,f6.noise_model,f6.noise_parameter,f6.prune,f6.seed,f6.seeds,f6.lowerbound,f6.timer,f6.partial_evaluation,f6.print_console,f6.print_summary);}function fS(f5,f6){return b0.New(f6.name,f5,f6.samples,f6.thin,f6.noise_model,f6.noise_parameter,f6.prune,f6.seed,f6.seeds,f6.lowerbound,f6.timer,f6.partial_evaluation,f6.print_console,f6.print_summary);}function fT(f5,f6){return b0.New(f6.name,f6.burnin,f5,f6.thin,f6.noise_model,f6.noise_parameter,f6.prune,f6.seed,f6.seeds,f6.lowerbound,f6.timer,f6.partial_evaluation,f6.print_console,f6.print_summary);}function fU(f5,f6){return b0.New(f6.name,f6.burnin,f6.samples,f5,f6.noise_model,f6.noise_parameter,f6.prune,f6.seed,f6.seeds,f6.lowerbound,f6.timer,f6.partial_evaluation,f6.print_console,f6.print_summary);}function fV(f5,f6){return b0.New(f6.name,f6.burnin,f6.samples,f6.thin,f5,f6.noise_parameter,f6.prune,f6.seed,f6.seeds,f6.lowerbound,f6.timer,f6.partial_evaluation,f6.print_console,f6.print_summary);}function fW(f5,f6){return b0.New(f6.name,f6.burnin,f6.samples,f6.thin,f6.noise_model,f5,f6.prune,f6.seed,f6.seeds,f6.lowerbound,f6.timer,f6.partial_evaluation,f6.print_console,f6.print_summary);}function fX(f5,f6){return b0.New(f6.name,f6.burnin,f6.samples,f6.thin,f6.noise_model,f6.noise_parameter,f5,f6.seed,f6.seeds,f6.lowerbound,f6.timer,f6.partial_evaluation,f6.print_console,f6.print_summary);}function fY(f5,f6){return b0.New(f6.name,f6.burnin,f6.samples,f6.thin,f6.noise_model,f6.noise_parameter,f6.prune,f5,f6.seeds,f6.lowerbound,f6.timer,f6.partial_evaluation,f6.print_console,f6.print_summary);}function fZ(f5,f6){return b0.New(f6.name,f6.burnin,f6.samples,f6.thin,f6.noise_model,f6.noise_parameter,f6.prune,f6.seed,A.map(a.id,f5),f6.lowerbound,f6.timer,f6.partial_evaluation,f6.print_console,f6.print_summary);}function f0(f5,f6){return b0.New(f6.name,f6.burnin,f6.samples,f6.thin,f6.noise_model,f6.noise_parameter,f6.prune,f6.seed,f6.seeds,{$:1,$0:f5},f6.timer,f6.partial_evaluation,f6.print_console,f6.print_summary);}function f1(f5,f6){return b0.New(f6.name,f6.burnin,f6.samples,f6.thin,f6.noise_model,f6.noise_parameter,f6.prune,f6.seed,f6.seeds,f6.lowerbound,f5,f6.partial_evaluation,f6.print_console,f6.print_summary);}function f2(f5,f6){return b0.New(f6.name,f6.burnin,f6.samples,f6.thin,f6.noise_model,f6.noise_parameter,f6.prune,f6.seed,f6.seeds,f6.lowerbound,f6.timer,f6.partial_evaluation,f5,f6.print_summary);}function f3(f5,f6){return b0.New(f6.name,f6.burnin,f6.samples,f6.thin,f6.noise_model,f6.noise_parameter,f6.prune,f6.seed,f6.seeds,f6.lowerbound,f6.timer,f6.partial_evaluation,f6.print_console,f5);}function f4(f5,f6){return b0.New(f6.name,f6.burnin,f6.samples,f6.thin,f6.noise_model,f6.noise_parameter,f6.prune,f6.seed,f6.seeds,f6.lowerbound,f6.timer,f5,f6.print_console,f6.print_summary);}return D.record(fB,A.ofArray([["name",(fC=D.name(),function(f5){return fQ(fC,function(f6){return function(f7){return fR(f6,f7);};},f5);})],["burnin",(fD=D.pint32(),function(f5){return fQ(fD,function(f6){return function(f7){return fS(f6,f7);};},f5);})],["samples",(fE=D.pint32(),function(f5){return fQ(fE,function(f6){return function(f7){return fT(f6,f7);};},f5);})],["thin",(fF=D.pint32(),function(f5){return fQ(fF,function(f6){return function(f7){return fU(f6,f7);};},f5);})],["noise_model",(fG=bY.get_parse(),function(f5){return fQ(fG,function(f6){return function(f7){return fV(f6,f7);};},f5);})],["noise_parameter",(fH=bZ.get_parse(),function(f5){return fQ(fH,function(f6){return function(f7){return fW(f6,f7);};},f5);})],["prune",(fI=D.pbool(),function(f5){return fQ(fI,function(f6){return function(f7){return fX(f6,f7);};},f5);})],["seed",(fJ=D.pint32(),function(f5){return fQ(fJ,function(f6){return function(f7){return fY(f6,f7);};},f5);})],["seeds",(fK=D.list_of(D.pint32()),function(f5){return fQ(fK,function(f6){return function(f7){return fZ(f6,f7);};},f5);})],["lowerbound",(fL=D.pfloat(),function(f5){return fQ(fL,function(f6){return function(f7){return f0(f6,f7);};},f5);})],["timer",(fM=D.pbool(),function(f5){return fQ(fM,function(f6){return function(f7){return f1(f6,f7);};},f5);})],["print_console",(fN=D.pbool(),function(f5){return fQ(fN,function(f6){return function(f7){return f2(f6,f7);};},f5);})],["print_summary",(fO=D.pbool(),function(f5){return fQ(fO,function(f6){return function(f7){return f3(f6,f7);};},f5);})],["partial",(fP=D.pbool(),function(f5){return fQ(fP,function(f6){return function(f7){return f4(f6,f7);};},f5);})]]));};b0.get_parse=function(){return b0.parse_defaults(b0.get_defaults());};b0.New=function(fB,fC,fD,fE,fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO){return{name:fB,burnin:fC,samples:fD,thin:fE,noise_model:fF,noise_parameter:fG,prune:fH,seed:fI,seeds:fJ,lowerbound:fK,timer:fL,partial_evaluation:fM,print_console:fN,print_summary:fO};};b1.New=function(fB,fC,fD,fE){return{order:fB,initial_minimum:fC,log_evaluation:fD,plots:fE};};b2.get_defaults=function(){return b2.New("Multistability","Portfolio",null,null);};b2.get_parse=function(){return b2.parse_defaults(b2.get_defaults());};b2.parse_defaults=function(fB){var fC,fD,fE,fF,fG,fH;function fI(fO,fP){return b2.New("Multistability",fP.solver,fP.timeout,fP.seed);}function fJ(fO,fP){return b2.New("Turing",fP.solver,fP.timeout,fP.seed);}function fK(fO,fP){return b2.New(fP.mode,"NLSat",fP.timeout,fP.seed);}function fL(fO,fP){return b2.New(fP.mode,"Portfolio",fP.timeout,fP.seed);}function fM(fO,fP){return b2.New(fP.mode,fP.solver,{$:1,$0:fO},fP.seed);}function fN(fO,fP){return b2.New(fP.mode,fP.solver,fP.timeout,{$:1,$0:fO});}return D.record(fB,A.ofArray([["mode",(fC=D.choice([(fD=D.kw("multistability"),function(fO){return dz.op_BarGreaterGreater(fD,function(fP){return function(fQ){return fI(fP,fQ);};},fO[0],fO[1]);}),(fE=D.kw("turing"),function(fO){return dz.op_BarGreaterGreater(fE,function(fP){return function(fQ){return fJ(fP,fQ);};},fO[0],fO[1]);})]),function(fO){return fC([fO[0],fO[1]]);})],["solver",(fF=D.choice([(fG=D.kw("nlsat"),function(fO){return dz.op_BarGreaterGreater(fG,function(fP){return function(fQ){return fK(fP,fQ);};},fO[0],fO[1]);}),(fH=D.kw("portfolio"),function(fO){return dz.op_BarGreaterGreater(fH,function(fP){return function(fQ){return fL(fP,fQ);};},fO[0],fO[1]);})]),function(fO){return fF([fO[0],fO[1]]);})],["timeout",function(fO){return dz.op_BarGreaterGreater(D.pfloat(),function(fP){return function(fQ){return fM(fP,fQ);};},fO[0],fO[1]);}],["seed",function(fO){return dz.op_BarGreaterGreater(D.pint32(),function(fP){return function(fQ){return fN(fP,fQ);};},fO[0],fO[1]);}]]));};b2.New=function(fB,fC,fD,fE){return{mode:fB,solver:fC,timeout:fD,seed:fE};};b3.empty=function(fB){return b3.New(fB,B.Empty);};b3.New=function(fB,fC){return{file:fB,data:fC};};b4=d.Concentration=fu.Class({get_to_string:function(){return this.$0===-24?"yM":this.$0===-21?"zM":this.$0===-18?"aM":this.$0===-15?"fM":this.$0===-12?"pM":this.$0===-9?"nM":this.$0===-6?"uM":this.$0===-3?"mM":this.$0===0?"M":"M*10\\\\^"+a.String(this.$0);}},null,b4);b5=d.Time=fu.Class({get_to_string:function(){return this.$0===1E-09?"ns":this.$0===1E-06?"us":this.$0===0.001?"ms":this.$0===1?"s":this.$0===60?"min":this.$0===3600?"h":(function(fB){return function(fC){return fB(fC.toFixed(6)+"s");};}(a.id))(this.$0);}},null,b5);b6=d.Space=fu.Class({get_to_string:function(){return this.$0===-15?"fm":this.$0===-12?"pm":this.$0===-9?"nm":this.$0===-6?"um":this.$0===-3?"mm":this.$0===0?"m":"m*10\\\\^"+a.String(this.$0);}},null,b6);b7=d.Units=fu.Class({get_to_string:function(){return db.emit_record(b7.get_defaults(),A.ofArray([["concentration",function(fB){return fB.concentration.get_to_string();}],["time",function(fB){return fB.time.get_to_string();}],["space",function(fB){return fB.space.get_to_string();}]]),this);}},null,b7);b7.get_defaults=function(){return b7.New(new b4({$:0,$0:-9}),new b5({$:0,$0:1}),new b6({$:0,$0:-3}));};b7.get_parse=function(){var fB,fC,fD,fE,fF,fG;fB=(fC=D.choice([D.op_GreaterGreaterDot(D.kw("M"),D.preturn(new b4({$:0,$0:0}))),D.op_GreaterGreaterDot(D.kw("mM"),D.preturn(new b4({$:0,$0:-3}))),D.op_GreaterGreaterDot(D.kw("uM"),D.preturn(new b4({$:0,$0:-6}))),D.op_GreaterGreaterDot(D.kw("nM"),D.preturn(new b4({$:0,$0:-9}))),D.op_GreaterGreaterDot(D.kw("pM"),D.preturn(new b4({$:0,$0:-12}))),D.op_GreaterGreaterDot(D.kw("fM"),D.preturn(new b4({$:0,$0:-15}))),D.op_GreaterGreaterDot(D.kw("aM"),D.preturn(new b4({$:0,$0:-18}))),D.op_GreaterGreaterDot(D.kw("zM"),D.preturn(new b4({$:0,$0:-21}))),D.op_GreaterGreaterDot(D.kw("yM"),D.preturn(new b4({$:0,$0:-24})))]),function(fH){return fC([fH[0],fH[1]]);});fD=(fE=D.choice([D.op_GreaterGreaterDot(D.kw("ns"),D.preturn(new b5({$:0,$0:1E-09}))),D.op_GreaterGreaterDot(D.kw("us"),D.preturn(new b5({$:0,$0:1E-06}))),D.op_GreaterGreaterDot(D.kw("ms"),D.preturn(new b5({$:0,$0:0.001}))),D.op_GreaterGreaterDot(D.kw("s"),D.preturn(new b5({$:0,$0:1}))),D.op_GreaterGreaterDot(D.kw("min"),D.preturn(new b5({$:0,$0:60}))),D.op_GreaterGreaterDot(D.kw("h"),D.preturn(new b5({$:0,$0:3600})))]),function(fH){return fE([fH[0],fH[1]]);});fF=(fG=D.choice([D.op_GreaterGreaterDot(D.kw("m"),D.preturn(new b6({$:0,$0:0}))),D.op_GreaterGreaterDot(D.kw("mm"),D.preturn(new b6({$:0,$0:-3}))),D.op_GreaterGreaterDot(D.kw("um"),D.preturn(new b6({$:0,$0:-6}))),D.op_GreaterGreaterDot(D.kw("nm"),D.preturn(new b6({$:0,$0:-9}))),D.op_GreaterGreaterDot(D.kw("pm"),D.preturn(new b6({$:0,$0:-12}))),D.op_GreaterGreaterDot(D.kw("fm"),D.preturn(new b6({$:0,$0:-15})))]),function(fH){return fG([fH[0],fH[1]]);});return D.record(b7.get_defaults(),A.ofArray([["concentration",D.op_BarGreaterGreater(D.op_DotGreaterGreater(fB,D.spaces()),function(fH){return function(fI){return b7.New(fH,fI.time,fI.space);};})],["time",D.op_BarGreaterGreater(D.op_DotGreaterGreater(fD,D.spaces()),function(fH){return function(fI){return b7.New(fI.concentration,fH,fI.space);};})],["space",D.op_BarGreaterGreater(D.op_DotGreaterGreater(fF,D.spaces()),function(fH){return function(fI){return b7.New(fI.concentration,fI.time,fH);};})]]));};b7.New=function(fB,fC,fD){return new b7({concentration:fB,time:fC,space:fD});};b8=d.Assignment=fu.Class({partial_inline:function(fB){var fC;function fD(fE){return R.substitute(fC,fE);}fC=K.Map(function(fE,fF){return{$:1,$0:fF};},fB);return b8.New(this.variables,A.map(function(fE){return A.map(fD,fE);},this.values));},add_multiples:function(fB,fC){var fD;fD=A.unzip(A.map(function(fE){var fF;fB[0]=fB[0]+1;fF=A.map(function(fG){return fG+"_"+a.String(fB[0]);},fC);return[fF,A.append(fE,A.map(function(fG){return{$:0,$0:fG};},fF))];},this.values));return[fD[0],b8.create$5(A.append(this.variables,fC),fD[1])];},eval_label:function(fB){return A.zip(A.map(function(fC){return function(fD){return fC("["+_2.toSafe(fD)+"]");};}(a.id),this.get_to_string_separated()),this["eval"](fB));},get_string:function(){var fB,fC,fD,fE;fB=db.tuple_to_string(this.variables);fC=dk.concat("; ",A.map((fD=(fE=function(fF){return R.to_string(a.id,fF);},function(fF){return A.map(fE,fF);}),function(fF){return db.tuple_to_string(fD(fF));}),this.values));return(((fu.Curried3(function(fF,fG,fH){return fF(_2.toSafe(fG)+" = ["+_2.toSafe(fH)+"]");}))(a.id))(fB))(fC);},"eval":function(fB){var fC;fC=this;return A.map(function(fD){function fE(fF){return di.find(fB,fF);}return K.OfArray(U.ofSeq(A.zip(fC.variables,A.map(function(fF){return R["eval"](fE,fF);},fD))));},this.values);},get_to_string_separated:function(){var fB,fC;fB=this;return A.map(function(fD){return dk.concat("; ",A.map2(function(fE,fF){return(((fu.Curried3(function(fG,fH,fI){return fG(_2.toSafe(fH)+" = "+_2.toSafe(fI));}))(a.id))(fE))(fF);},fB.variables,fD));},A.map((fC=function(fD){return R.to_string(a.id,fD);},function(fD){return A.map(fC,fD);}),this.values));},get_mentions:function(){return A.append(this.variables,A.collect(R.mentions,A.concat(this.values)));}},null,b8);b8.create$4=function(){return b8.New(B.Empty,A.ofArray([B.Empty]));};b8.create$5=function(fB,fC){return b8.New(fB,fC);};b8.get_parse=function(){var fB,fC,fD,fE,fF;fB=D.tuple_of(D.name());fC=D.list_of(D.tuple_of(R.parse(D.name())));fD=(fE=(fF=D.skw("="),function(fG){return dz.op_DotGreaterGreater(fB,fF,fG[0],fG[1]);}),function(fG){return dz.op_DotGreaterGreaterDot(fE,fC,fG[0],fG[1]);});return function(fG){return dz.op_BarGreaterGreater(fD,function(fH){return b8.create$5(fH[0],fH[1]);},fG[0],fG[1]);};};b8.New=function(fB,fC){return new b8({variables:fB,values:fC});};b9=d.Sweep=fu.Class({inline_env:function(fB){return b9.New(this.name,A.map(function(fC){return fC.partial_inline(fB);},this.assignments));},get_merge:function(){return bc.fold(function(fB,fC){var fD;function fE(fF,fG){return A.map(function(fH){var fI;fI=K.OfArray(U.ofSeq(A.zip(fB.variables,fH)));return A.append(fH,A.map(function(fJ){return R.substitute(fI,fJ);},fG));},fF);}return b8.create$5(A.append(fB.variables,fC.variables),A.concat(A.map((fD=fB.values,function(fF){return fE(fD,fF);}),fC.values)));},b8.create$4(),this.assignments);},add_multiples:function(fB,fC){var fD;fD=this.get_merge().add_multiples(fB,fC);return[fD[0],b9.create$6(this.name,A.ofArray([fD[1]]))];},eval_label:function(fB){return this.get_merge().eval_label(fB);},simplify_assignments:function(){return b9.New(this.name,A.filter(function(fB){return fB.values.get_Length()>1;},this.assignments));},get_string:function(){return this.name+" = ["+dk.concat("; ",A.map(function(fB){return fB.get_string();},this.assignments))+"]";},get_variables:function(){return db.remove_duplicates(function(fB,fC){return fB===fC;},A.collect(function(fB){return fB.variables;},this.assignments));},"eval":function(fB){return(this.get_merge())["eval"](fB);},get_mentions:function(){return A.collect(function(fB){return A.distinct(fB.get_mentions());},this.assignments);}},null,b9);b9.list_to_string=function(fB){return(function(fC){return function(fD){return fC("[\\n  "+_2.toSafe(fD)+";\\n]");};}(a.id))(dk.concat(";\\n  ",A.map(function(fC){return fC.get_string();},fB)));};b9.create$7=function(){return b9.New("",B.Empty);};b9.create$6=function(fB,fC){return b9.New(fB,fC);};b9.get_parse=function(){var fB,fC,fD,fE;fB=(fC=(fD=D.skw("="),function(fF){return dz.op_DotGreaterGreater(D.name(),fD,fF[0],fF[1]);}),(fE=D.list_of(b8.get_parse()),function(fF){return dz.op_DotGreaterGreaterDot(fC,fE,fF[0],fF[1]);}));return function(fF){return dz.op_BarGreaterGreater(fB,function(fG){return b9.create$6(fG[0],fG[1]);},fF[0],fF[1]);};};b9.New=function(fB,fC){return new b9({name:fB,assignments:fC});};b_=d.Plot_settings=fu.Class({map:function(fB){return b_.New(this.x_label,this.y_label,this.title,this.label_font_size,this.tick_font_size,this.x_ticks,this.y_ticks,this.x_min,this.x_max,this.y_min,this.y_max,A.map(fB,this.v_boundaries),A.map(fB,this.h_boundaries));},update_empty_labels:function(fB,fC){var fD;fD=this.x_label===""?b_.New(fB,this.y_label,this.title,this.label_font_size,this.tick_font_size,this.x_ticks,this.y_ticks,this.x_min,this.x_max,this.y_min,this.y_max,this.v_boundaries,this.h_boundaries):this;return fD.y_label===""?b_.New(fD.x_label,fC,fD.title,fD.label_font_size,fD.tick_font_size,fD.x_ticks,fD.y_ticks,fD.x_min,fD.x_max,fD.y_min,fD.y_max,fD.v_boundaries,fD.h_boundaries):fD;}},null,b_);b_.get_defaults=function(){return b_.New("","","",16,16,B.Empty,B.Empty,null,null,null,null,B.Empty,B.Empty);};b_.parse=function(fB){return b_.parse_defaults(b_.get_defaults(),fB);};b_.parse_defaults=function(fB,fC){var fD,fE,fF,fG,fH,fI,fJ,fK;function fL(fY,fZ){return b_.New(fY,fZ.y_label,fZ.title,fZ.label_font_size,fZ.tick_font_size,fZ.x_ticks,fZ.y_ticks,fZ.x_min,fZ.x_max,fZ.y_min,fZ.y_max,fZ.v_boundaries,fZ.h_boundaries);}function fM(fY,fZ){return b_.New(fZ.x_label,fY,fZ.title,fZ.label_font_size,fZ.tick_font_size,fZ.x_ticks,fZ.y_ticks,fZ.x_min,fZ.x_max,fZ.y_min,fZ.y_max,fZ.v_boundaries,fZ.h_boundaries);}function fN(fY,fZ){return b_.New(fZ.x_label,fZ.y_label,fY,fZ.label_font_size,fZ.tick_font_size,fZ.x_ticks,fZ.y_ticks,fZ.x_min,fZ.x_max,fZ.y_min,fZ.y_max,fZ.v_boundaries,fZ.h_boundaries);}function fO(fY,fZ){return b_.New(fZ.x_label,fZ.y_label,fZ.title,fY,fZ.tick_font_size,fZ.x_ticks,fZ.y_ticks,fZ.x_min,fZ.x_max,fZ.y_min,fZ.y_max,fZ.v_boundaries,fZ.h_boundaries);}function fP(fY,fZ){return b_.New(fZ.x_label,fZ.y_label,fZ.title,fZ.label_font_size,fY,fZ.x_ticks,fZ.y_ticks,fZ.x_min,fZ.x_max,fZ.y_min,fZ.y_max,fZ.v_boundaries,fZ.h_boundaries);}function fQ(fY,fZ){return b_.New(fZ.x_label,fZ.y_label,fZ.title,fZ.label_font_size,fZ.tick_font_size,fY,fZ.y_ticks,fZ.x_min,fZ.x_max,fZ.y_min,fZ.y_max,fZ.v_boundaries,fZ.h_boundaries);}function fR(fY,fZ){return b_.New(fZ.x_label,fZ.y_label,fZ.title,fZ.label_font_size,fZ.tick_font_size,fZ.x_ticks,fY,fZ.x_min,fZ.x_max,fZ.y_min,fZ.y_max,fZ.v_boundaries,fZ.h_boundaries);}function fS(fY,fZ){return b_.New(fZ.x_label,fZ.y_label,fZ.title,fZ.label_font_size,fZ.tick_font_size,fZ.x_ticks,fZ.y_ticks,{$:1,$0:fY},fZ.x_max,fZ.y_min,fZ.y_max,fZ.v_boundaries,fZ.h_boundaries);}function fT(fY,fZ){return b_.New(fZ.x_label,fZ.y_label,fZ.title,fZ.label_font_size,fZ.tick_font_size,fZ.x_ticks,fZ.y_ticks,fZ.x_min,{$:1,$0:fY},fZ.y_min,fZ.y_max,fZ.v_boundaries,fZ.h_boundaries);}function fU(fY,fZ){return b_.New(fZ.x_label,fZ.y_label,fZ.title,fZ.label_font_size,fZ.tick_font_size,fZ.x_ticks,fZ.y_ticks,fZ.x_min,fZ.x_max,{$:1,$0:fY},fZ.y_max,fZ.v_boundaries,fZ.h_boundaries);}function fV(fY,fZ){return b_.New(fZ.x_label,fZ.y_label,fZ.title,fZ.label_font_size,fZ.tick_font_size,fZ.x_ticks,fZ.y_ticks,fZ.x_min,fZ.x_max,fZ.y_min,{$:1,$0:fY},fZ.v_boundaries,fZ.h_boundaries);}function fW(fY,fZ){return b_.New(fZ.x_label,fZ.y_label,fZ.title,fZ.label_font_size,fZ.tick_font_size,fZ.x_ticks,fZ.y_ticks,fZ.x_min,fZ.x_max,fZ.y_min,fZ.y_max,fY,fZ.h_boundaries);}function fX(fY,fZ){return b_.New(fZ.x_label,fZ.y_label,fZ.title,fZ.label_font_size,fZ.tick_font_size,fZ.x_ticks,fZ.y_ticks,fZ.x_min,fZ.x_max,fZ.y_min,fZ.y_max,fZ.v_boundaries,fY);}fD=D.satisfy(function(fY){return fY!=="\\"";});return D.record(fB,A.ofArray([["x_label",(fE=D.between(D.pchar("\\""),D.pchar("\\""),D.manyChars(fD)),function(fY){return dz.op_BarGreaterGreater(fE,function(fZ){return function(f0){return fL(fZ,f0);};},fY[0],fY[1]);})],["y_label",(fF=D.between(D.pchar("\\""),D.pchar("\\""),D.manyChars(fD)),function(fY){return dz.op_BarGreaterGreater(fF,function(fZ){return function(f0){return fM(fZ,f0);};},fY[0],fY[1]);})],["title",(fG=D.between(D.pchar("\\""),D.pchar("\\""),D.manyChars(fD)),function(fY){return dz.op_BarGreaterGreater(fG,function(fZ){return function(f0){return fN(fZ,f0);};},fY[0],fY[1]);})],["label_font_size",function(fY){return dz.op_BarGreaterGreater(D.pint32(),function(fZ){return function(f0){return fO(fZ,f0);};},fY[0],fY[1]);}],["tick_font_size",function(fY){return dz.op_BarGreaterGreater(D.pint32(),function(fZ){return function(f0){return fP(fZ,f0);};},fY[0],fY[1]);}],["x_ticks",(fH=D.list_of(D.pfloat()),function(fY){return dz.op_BarGreaterGreater(fH,function(fZ){return function(f0){return fQ(fZ,f0);};},fY[0],fY[1]);})],["y_ticks",(fI=D.list_of(D.pfloat()),function(fY){return dz.op_BarGreaterGreater(fI,function(fZ){return function(f0){return fR(fZ,f0);};},fY[0],fY[1]);})],["x_min",function(fY){return dz.op_BarGreaterGreater(D.pfloat(),function(fZ){return function(f0){return fS(fZ,f0);};},fY[0],fY[1]);}],["x_max",function(fY){return dz.op_BarGreaterGreater(D.pfloat(),function(fZ){return function(f0){return fT(fZ,f0);};},fY[0],fY[1]);}],["y_min",function(fY){return dz.op_BarGreaterGreater(D.pfloat(),function(fZ){return function(f0){return fU(fZ,f0);};},fY[0],fY[1]);}],["y_max",function(fY){return dz.op_BarGreaterGreater(D.pfloat(),function(fZ){return function(f0){return fV(fZ,f0);};},fY[0],fY[1]);}],["v_boundaries",(fJ=D.list_of(fC),function(fY){return dz.op_BarGreaterGreater(fJ,function(fZ){return function(f0){return fW(fZ,f0);};},fY[0],fY[1]);})],["h_boundaries",(fK=D.list_of(fC),function(fY){return dz.op_BarGreaterGreater(fK,function(fZ){return function(f0){return fX(fZ,f0);};},fY[0],fY[1]);})]]));};b_.New=function(fB,fC,fD,fE,fF,fG,fH,fI,fJ,fK,fL,fM,fN){return new b_({x_label:fB,y_label:fC,title:fD,label_font_size:fE,tick_font_size:fF,x_ticks:fG,y_ticks:fH,x_min:fI,x_max:fJ,y_min:fK,y_max:fL,v_boundaries:fM,h_boundaries:fN});};ca.New=function(fB,fC){return{element:fB,multiplicity:fC};};cb=d.Rate=fu.Class({map:function(fB,fC){return this.$==1?new cb({$:1,$0:fC(this.$0)}):new cb({$:0,$0:fB(this.$0)});},to_string_bare:function(fB,fC){return this.fold(fB,fC);},fold:function(fB,fC){return this.$==1?fC(this.$0):fB(this.$0);},to_string:function(fB,fC){return this.fold(function(fD){return"{"+fB(fD)+"}";},function(fD){return"["+fC(fD)+"]";});}},null,cb);cb.map2=function(fB,fC,fD){return fD.map(fB,fC);};cb.parse=function(fB,fC){var fD,fE,fF,fG;function fH(fJ){return new cb({$:0,$0:fJ});}function fI(fJ){return new cb({$:1,$0:fJ});}fD=(fE=(D.bracket("{","}"))(fB),function(fJ){return dz.op_BarGreaterGreater(fE,fH,fJ[0],fJ[1]);});fF=(fG=(D.bracket("[","]"))(fC),function(fJ){return dz.op_BarGreaterGreater(fG,fI,fJ[0],fJ[1]);});return function(fJ){return dz.op_LessBarGreater(fD,fF,fJ[0],fJ[1]);};};cc=d.Reaction=fu.Class({stochastic_to_deterministic:function(fB){return R.mul(fB,{$:1,$0:this.get_conversion_factor()});},getStoich:function(fB,fC){return fB?0:this.numInProducts(fC)-this.numInReactants(fC);},scale:function(fB,fC,fD){var fE,fF,fG;function fH(fI,fJ){return fJ.map(fB(fC,fI),fD);}return fC===1?this:(fE=b$.size(this.reactants)+b$.size(this.catalysts),(fF=b$.size(this.products)+b$.size(this.catalysts),(fG=fH(fE,this.rate),cc.create$4(this.catalysts,this.reactants,db.option_map2(function(fI){return fH(fF,fI);},this.reverse),fG,this.products))));},get_conversion_factor:function(){return b$.fold_left_m(function(fB,fC){return fB*db.fac(fC.multiplicity);},1,this.reactants);},numInProducts:function(fB){return b$.get_mult(bk.Equals,this.products,fB);},numInReactants:function(fB){return b$.get_mult(bk.Equals,this.reactants,fB);},normalise:function(){var fB,fC;fB=cc.create$4(b$.empty(),b$.union(bk.Equals,this.reactants,this.catalysts),null,this.rate,b$.union(bk.Equals,this.products,this.catalysts));return[fB,(fC=this.reverse,fC!=null&&fC.$==1?{$:1,$0:cc.create$4(b$.empty(),fB.products,null,fC.$0,fB.reactants)}:null)];},deterministic_to_stochastic:function(fB){return R.div(fB,{$:1,$0:this.get_conversion_factor()});},string:function(fB,fC,fD){var fE;function fF(fH){var fI;fI=fH.to_string(fC,fD);return fI==="{1.0}"?"":fI;}function fG(fH){return b$.to_string(fB," + ",fH);}return db.string_of_list(a.id," ",A.filter(function(fH){return fH!=="";},A.ofArray([b$.is_empty(this.catalysts)?"":fG(this.catalysts)+" ~",fG(this.reactants),(fE=this.reverse,fE!=null&&fE.$==1?"<->"+fF(this.rate)+fF(fE.$0):"->"+fF(this.rate)),fG(this.products)])));},get_allSpecies:function(){return b$.elements(b$.union(bk.Equals,b$.union(bk.Equals,this.reactants,this.products),this.catalysts));}},null,cc);cc.map=function(fB,fC,fD,fE){return cc.create$4(b$.map(fB,fE.catalysts),b$.map(fB,fE.reactants),db.option_map2(function(fF){return cb.map2(fC,fD,fF);},fE.reverse),cb.map2(fC,fD,fE.rate),b$.map(fB,fE.products));};cc.normalise_list=function(fB){return A.rev(bc.fold(function(fC,fD){var fE,fF,fG;fE=fD.normalise();fF=fE[0];fG=fE[1];return fG!=null&&fG.$==1?new B({$:1,$0:fG.$0,$1:new B({$:1,$0:fF,$1:fC})}):new B({$:1,$0:fF,$1:fC});},B.Empty,fB));};cc.get_sim_reactions_products=function(fB,fC,fD,fE,fF){function fG(fH){return cc.map(a.id,a.id,R.to_lambda,fH);}return A.rev(db.fold_left(function(fH,fI){var fJ,fK,fL,fM,fN,fO;fJ=cc.convert_simplify(fB,fC,fD,fE,fI);fK=fJ[0];fL=fJ[1];fM=b$.union(function(fP,fQ){return fP===fQ;},fK.products,fK.catalysts);return fL!=null&&fL.$==1?(fN=fL.$0,(fO=b$.union(function(fP,fQ){return fP===fQ;},fN.reactants,fN.catalysts),new B({$:1,$0:[fG(fN),fO,fN.rate],$1:new B({$:1,$0:[fG(fK),fM,fK.rate],$1:fH})}))):new B({$:1,$0:[fG(fK),fM,fK.rate],$1:fH});},B.Empty,fF));};cc.create$4=function(fB,fC,fD,fE,fF){return cc.New(fB,fC,fD,fE,fF);};cc.to_string=function(fB,fC,fD,fE){return fE.string(fB,fC,fD);};cc.convert_simplify=function(fB,fC,fD,fE,fF){var fG;function fH(fK,fL,fM){return fM*fv.pow(fK,1-fL);}function fI(fK){var fL;fL=fC.tryFind_index(fK);return fL==null?F.FailWith("Species "+fK.name+" not found in a rate expression"):fL.$0;}function fJ(fK){function fL(fM){return cY.map(fI,fM);}return function(fM){return R.map(fL,fM);};}fG=K.Map(function(fK,fL){return(fJ(fK))(fL);},fE);return cc.map(fI,function(fK){return R["eval"](function(fL){return di.find(fD,fL);},fK);},function(fK){function fL(fN){return co.map(fI,fN);}function fM(fN){return co.inline_keys(fD,fG,fN);}return R.simplify(R.expand(function(fN){return fM(fL(fN));},fK));},fF).scale(function(fK,fL){return function(fM){return fH(fK,fL,fM);};},fB,a.id).normalise();};cc.parse=function(fB,fC,fD,fE){var fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO,fP;function fQ(fS){return{$:1,$0:fS};}function fR(fS,fT){var fU,fV,fW,fX;function fY(fZ,f0){return D.preturn(fT!=null&&fT.$==1?cc.create$4(fS,fT.$0,fZ[1],fZ[0],f0):cc.create$3(fS,fZ[1],fZ[0],f0));}fU=(fV=(fW=D.choice([cc.parse_reversible(fC,fD,fE),cc.parse_irreversible(fC,fD,fE)]),function(fZ){return fW([fZ[0],fZ[1]]);}),(fX=b$.parse(fB),function(fZ){return dz.op_PlusGreaterGreaterPlus(fV,fX,fZ[0],fZ[1]);}));return function(fZ){return dz.op_GreaterGreaterEquals(fU,function(f0){return fY(f0[0],f0[1]);},fZ[0],fZ[1]);};}fF=D.pTry((fG=(fH=b$.parse(fB),(fI=(fJ=D.choice([(fK=(fL=D.kw("~"),(fM=b$.parse(fB),function(fS){return dz.op_GreaterGreaterDot(fL,fM,fS[0],fS[1]);})),function(fS){return dz.op_BarGreaterGreater(fK,fQ,fS[0],fS[1]);}),D.preturn(null)]),function(fS){return fJ([fS[0],fS[1]]);}),function(fS){return dz.op_PlusGreaterGreaterPlus(fH,fI,fS[0],fS[1]);})),(fN=(fO=D.lookAhead("<->"),(fP=D.lookAhead("->"),function(fS){return dz.op_LessBarGreater(fO,fP,fS[0],fS[1]);})),function(fS){return dz.op_PlusGreaterGreater(fG,fN,fS[0],fS[1]);})));return function(fS){return dz.op_GreaterGreaterEquals(fF,function(fT){return fR(fT[0],fT[1]);},fS[0],fS[1]);};};cc.create$3=function(fB,fC,fD,fE){return cc.create$4(b$.empty(),fB,fC,fD,fE);};cc.parse_reversible=function(fB,fC,fD){var fE,fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO,fP;function fQ(fS,fT){return[new cb({$:0,$0:fS}),new cb({$:0,$0:fT})];}function fR(fS,fT){return[fS,{$:1,$0:fT}];}fE=(fF=D.kw("<->"),(fG=(fH=D.pTry((fI=cb.parse(fB,fC),(fJ=cb.parse(fB,fC),function(fS){return dz.op_PlusGreaterGreaterPlus(fI,fJ,fS[0],fS[1]);}))),(fK=(fL=(fM=D.braces((fN=(fO=D.kw(","),function(fS){return dz.op_PlusGreaterGreater(fB,fO,fS[0],fS[1]);}),function(fS){return dz.op_PlusGreaterGreaterPlus(fN,fB,fS[0],fS[1]);})),(fP=D.preturn([fD,fD]),function(fS){return dz.op_LessBarGreater(fM,fP,fS[0],fS[1]);})),function(fS){return dz.op_BarGreaterGreater(fL,function(fT){return fQ(fT[0],fT[1]);},fS[0],fS[1]);}),function(fS){return dz.op_LessBarGreater(fH,fK,fS[0],fS[1]);})),function(fS){return dz.op_GreaterGreaterDot(fF,fG,fS[0],fS[1]);}));return function(fS){return dz.op_BarGreaterGreater(fE,function(fT){return fR(fT[0],fT[1]);},fS[0],fS[1]);};};cc.parse_irreversible=function(fB,fC,fD){var fE,fF,fG,fH,fI;function fJ(fK){return[fK,null];}fE=D.kw("->");fF=(fG=(fH=cb.parse(fB,fC),function(fK){return dz.op_BarGreaterGreater(fH,fJ,fK[0],fK[1]);}),(fI=D.preturn([new cb({$:0,$0:fD}),null]),function(fK){return dz.op_LessBarGreater(fG,fI,fK[0],fK[1]);}));return function(fK){return dz.op_GreaterGreaterDot(fE,fF,fK[0],fK[1]);};};cc.New=function(fB,fC,fD,fE,fF){return new cc({catalysts:fB,reactants:fC,reverse:fD,rate:fE,products:fF});};ce=cd.core=fu.Class({apply1d:function(fB,fC){return fv.abs(fB-0.5)<=this.width/2?[fB,fC+this.inner]:[fB,fC+this.outer];},apply2d:function(fB,fC){return cd.distance_from_xy(0.5,0.5,fB[0],fB[1])<=this.width/2?[fB,this.inner+fC]:[fB,this.outer+fC];},to_string:function(){return((((fu.Curried(function(fB,fC,fD,fE){return fB("centralcore = {inner="+dk.PadLeft(fC.toFixed(3),1)+"; outer="+dk.PadLeft(fD.toFixed(3),1)+"; width="+dk.PadLeft(fE.toFixed(3),1)+"}");},4))(a.id))(this.inner))(this.outer))(this.width);}},null,ce);ce.New=function(fB,fC,fD){return new ce({inner:fB,outer:fC,width:fD});};cf=cd.point=fu.Class({apply1d:function(fB,fC){return fv.abs(this.x-fB)<=this.width/2?[fB,fC+this.value]:[fB,fC];},apply2d:function(fB,fC){return cd.distance_from_xy(this.x,this.y,fB[0],fB[1])<=this.width/2?[fB,this.value+fC]:[fB,fC];},to_string:function(){return(((((fu.Curried(function(fB,fC,fD,fE,fF){return fB("{x="+dk.PadLeft(fC.toFixed(3),1)+"; y="+dk.PadLeft(fD.toFixed(3),1)+"; width="+dk.PadLeft(fE.toFixed(3),1)+"; value="+dk.PadLeft(fF.toFixed(3),1)+"}");},5))(a.id))(this.x))(this.y))(this.width))(this.value);}},null,cf);cf.New=function(fB,fC,fD,fE){return new cf({x:fB,y:fC,width:fD,value:fE});};cg=cd.rectangle=fu.Class({apply1d:function(fB,fC){return fB>=this.xmin&&fB<=this.xmax?[fB,fC+this.value]:[fB,fC];},apply2d:function(fB,fC){var fD,fE;fD=fB[1];fE=fB[0];return fE>=this.xmin&&fE<=this.xmax&&fD>=this.ymin&&fD<=this.ymax?[[fE,fD],this.value+fC]:[[fE,fD],fC];},to_string:function(){return((((((fu.Curried(function(fB,fC,fD,fE,fF,fG){return fB("{xmin="+dk.PadLeft(fC.toFixed(3),1)+"; xmax="+dk.PadLeft(fD.toFixed(3),1)+"; ymin = "+dk.PadLeft(fE.toFixed(3),1)+"; ymax = "+dk.PadLeft(fF.toFixed(3),1)+"; value="+dk.PadLeft(fG.toFixed(3),1)+"}");},6))(a.id))(this.xmin))(this.xmax))(this.ymin))(this.ymax))(this.value);}},null,cg);cg.New=function(fB,fC,fD,fE,fF){return new cg({xmin:fB,xmax:fC,ymin:fD,ymax:fE,value:fF});};ch.New=function(fB,fC,fD,fE){return{random:fB,core:fC,points:fD,rectangles:fE};};cj.EncodeArray=fu.Curried3(function(fB,fC,fD){return U.map(fB(),fD);});cj.DecodeRecord=function(fB,fC){return function(){return function(fD){var fE;function fF(fG,fH,fI){if(fI===0){if(fD.hasOwnProperty(fG))fE[fG]=(fH(null))(fD[fG]);else F.FailWith("Missing mandatory field: "+fG);}else if(fI===1)fE[fG]=fD.hasOwnProperty(fG)?{$:1,$0:(fH(null))(fD[fG])}:null;else if(fI===2){if(fD.hasOwnProperty(fG))fE[fG]=(fH(null))(fD[fG]);}else if(fI===3){if(fD[fG]===void 0)fE[fG]=(fH(null))(fD[fG]);}else F.FailWith("Invalid field option kind");}fE=fB===void 0?{}:new fB();U.iter(function(fG){return fF(fG[0],fG[1],fG[2]);},fC);return fE;};};};cj.DecodeStringMap=fu.Curried3(function(fB,fC,fD){var fE,fF,fG;fE=[new y.New([])];fF=fB();for(var fH in fD)if(function(fI){var fJ;fE[0]=(fJ=fF(fD[fI]),fE[0].Add(fI,fJ));return false;}(fH))break;return fE[0];});cj.DecodeList=fu.Curried3(function(fB,fC,fD){var fE;fE=fB();return A.init(U.length(fD),function(fF){return fE(U.get(fD,fF));});});cj.Id=fu.Curried3(function(fB,fC,fD){return fD;});cj.EncodeRecord=function(fB,fC){return function(){return function(fD){var fE;function fF(fG,fH,fI){var fJ;if(fI===0)fE[fG]=(fH(null))(fD[fG]);else if(fI===1){fJ=fD[fG];fJ==null?void 0:fE[fG]=(fH(null))(fJ.$0);}else if(fI===2){if(fD.hasOwnProperty(fG))fE[fG]=(fH(null))(fD[fG]);}else if(fI===3){if(fD[fG]===void 0)fE[fG]=(fH(null))(fD[fG]);}else F.FailWith("Invalid field option kind");}fE={};U.iter(function(fG){return fF(fG[0],fG[1],fG[2]);},fC);return fE;};};};cj.EncodeStringMap=fu.Curried3(function(fB,fC,fD){var fE,fF;fE={};fF=fB();K.Iterate(function(fG,fH){fE[fG]=fF(fH);},fD);return fE;});cj.EncodeList=fu.Curried3(function(fB,fC,fD){var fE,fF;fE=[];fF=fB();A.iter(function(fG){fE.push(fF(fG));},fD);return fE;});cj.EncodeStringDictionary=fu.Curried3(function(fB,fC,fD){var fE,fF,fG,fH;fE={};fF=fB();fG=da.Get(fD);try{while(fG.MoveNext()){fH=F.KeyValue(fG.Current());fE[fH[0]]=fF(fH[1]);}}finally{if(typeof fG=="object"&&"Dispose"in fG)fG.Dispose();}return fE;});cj.DecodeArray=function(fB){return cj.EncodeArray(fB);};cj.DecodeStringDictionary=fu.Curried3(function(fB,fC,fD){var fE,fF,fG;fE=new bd.New$5();fF=fB();for(var fH in fD)if(function(fI){fE.Add(fI,fF(fD[fI]));return false;}(fH))break;return fE;});cj.DecodeUnion=function(fB,fC,fD){return function(){return function(fE){var fF,fG,fJ,fK,fL;function fH(fM,fN){return fM===fG;}function fI(fM,fN,fO,fP){var fQ;if(fM===null){fQ=(fO(null))(fE);fN?delete fQ[fC]:void 0;fJ.$0=fQ;}else if(fP===0)fJ[fM]=(fO(null))(fE[fN]);else if(fP===1)fJ[fM]=fE.hasOwnProperty(fN)?{$:1,$0:(fO(null))(fE[fN])}:null;else F.FailWith("Invalid field option kind");}if(typeof fE==="object"&&fE!=null){fJ=fB===void 0?{}:new fB();if(bk.Equals(typeof fC,"string"))fF=(fG=fE[fC],U.findIndex(function(fM){return fH(fM[0],fM[1]);},fD));else{fK=[void 0];for(var fM in fC)if(function(fN){return fE.hasOwnProperty(fN)&&(fK[0]=fC[fN],true);}(fM))break;fF=fK[0];}fJ.$=fF;U.iter(function(fN){return fI(fN[0],fN[1],fN[2],fN[3]);},(U.get(fD,fF))[1]);return fJ;}else return fE;};};};cj.DecodeTuple=function(fB){return cj.EncodeTuple(fB);};cj.EncodeUnion=function(fB,fC,fD){return function(){return function(fE){var fF,fG;function fH(fI,fJ,fK,fL){var fM,fN,fO;if(fI===null){fM=(fK(null))(fE.$0);for(var fP in fM)if(function(fQ){fF[fQ]=fM[fQ];return false;}(fP))break;}else if(fL===0)fF[fJ]=(fK(null))(fE[fI]);else if(fL===1){fO=fE[fI];fO==null?void 0:fF[fJ]=(fK(null))(fO.$0);}else F.FailWith("Invalid field option kind");}return typeof fE==="object"&&fE!=null?(fF={},(fG=U.get(fD,fE.$),(bk.Equals(typeof fC,"string")?fF[fC]=fG[0]:void 0,U.iter(function(fI){return fH(fI[0],fI[1],fI[2],fI[3]);},fG[1]),fF))):fE;};};};cj.EncodeTuple=fu.Curried3(function(fB,fC,fD){return U.map2(function(fE,fF){return(fE(null))(fF);},fB,fD);});ck.Fixed={$:2};ck.Log={$:1};ck.Real={$:0};cl.New=function(fB,fC,fD,fE,fF){return{mean:fB,stdev:fC,lb:fD,ub:fE,denominator:fF};};cm.New=function(fB,fC){return{mu:fB,sigma:fC};};cn.New=function(fB,fC){return{mean:fB,stdev:fC};};co.Time={$:3};co.inline_rates_env=function(fB,fC){function fD(fE){var fF,fG;return fE.$==2?{$:0,$0:{$:0,$0:fE.$0}}:fE.$==3?{$:0,$0:cY.Time}:fE.$==1?(fF=fE.$0,(fG=K.TryFind(fF,fC),fG!=null&&fG.$==1?R.expand(fD,fG.$0):F.FailWith("Rate "+fF+" is undefined."))):{$:1,$0:di.find(fB,fE.$0)};}return K.Map(function(fE,fF){return(function(){function fG(fH){return R.expand(fD,fH);}return function(fH){return R.simplify(fG(fH));};}(fE))(fF);},fC);};co.inline_keys=function(fB,fC,fD){var fE,fF;return fD.$==2?{$:0,$0:{$:0,$0:fD.$0}}:fD.$==3?{$:0,$0:cY.Time}:fD.$==1?(fE=fD.$0,(fF=K.TryFind(fE,fC),fF!=null&&fF.$==1?fF.$0:F.FailWith("Rate "+fE+" is undefined."))):{$:1,$0:di.find(fB,fD.$0)};};co.to_string=function(fB,fC){return fC.$==1?"["+fC.$0+"]":fC.$==2?"["+fB(fC.$0)+"]":fC.$==3?"[time]":fC.$0;};co.scale=function(fB,fC){return fC.$==2?{$:3,$0:ct.New({$:0,$0:{$:2,$0:fC.$0}},{$:1,$0:fB})}:{$:0,$0:fC};};co.map=function(fB,fC){return fC.$==1?{$:1,$0:fC.$0}:fC.$==0?{$:0,$0:fC.$0}:fC.$==3?co.Time:{$:2,$0:fB(fC.$0)};};co.eval_function=function(fB,fC,fD){return R.to_lambda(R.simplify(R.expand(function(fE){return co.inline_keys(fB,fC,fE);},fD)));};co.eval_massaction=function(fB,fC){return R["eval"](function(fD){return di.find(fB,fD);},fC);};co.to_matlab=function(fB,fC,fD){return fD.$==1?fD.$0:fD.$==2?fB(fD.$0):fD.$==3?fC:fD.$0;};co.parse=function(fB){var fC,fD,fE,fF,fG;function fH(fK){return{$:2,$0:fK};}function fI(fK,fL){return dz.op_DotGreaterGreater(D.name(),D.spaces(),fK,fL);}function fJ(fK){return{$:0,$0:fK};}fC=D.choice([(fD=D.kw("[time]"),(fE=D.preturn(co.Time),function(fK){return dz.op_GreaterGreaterDot(fD,fE,fK[0],fK[1]);})),(fF=(fG=D.sqBrackets(fB),function(fK){return dz.op_DotGreaterGreater(fG,D.spaces(),fK[0],fK[1]);}),function(fK){return dz.op_BarGreaterGreater(fF,fH,fK[0],fK[1]);}),function(fK){return dz.op_BarGreaterGreater(function(fL){return fI(fL[0],fL[1]);},fJ,fK[0],fK[1]);}]);return function(fK){return fC([fK[0],fK[1]]);};};cp.BFalse={$:1};cp.BTrue={$:0};cq.New=function(fB,fC){return{div:fB,modulo:fC};};cr.New=function(fB,fC){return{sub1:fB,sub2:fC};};cs.New=function(fB,fC){return{base_:fB,exponent:fC};};ct.New=function(fB,fC){return{div1:fB,div2:fC};};cu.get_to_string=function(fB){return fB=="Stochastic"?"Stochastic":fB=="Deterministic"?"Deterministic":"Contextual";};cu.get_parse=function(){var fB,fC,fD,fE;function fF(fI){return"Contextual";}function fG(fI){return"Stochastic";}function fH(fI){return"Deterministic";}fB=D.choice([(fC=D.kw("Contextual"),function(fI){return dz.op_BarGreaterGreater(fC,fF,fI[0],fI[1]);}),(fD=D.kw("Stochastic"),function(fI){return dz.op_BarGreaterGreater(fD,fG,fI[0],fI[1]);}),(fE=D.kw("Deterministic"),function(fI){return dz.op_BarGreaterGreater(fE,fH,fI[0],fI[1]);})]);return function(fI){return fB([fI[0],fI[1]]);};};cv.interpolate_float=function(fB,fC,fD,fE,fF){return fE+(fF-fE)*(fB-fC)/(fD-fC);};cv.interpolate_reverse=function(fB,fC,fD){var fE;function fF(fG,fH,fI){return U.map2(function(fJ,fK){return((fB(fG,fH.time,fI.time))(fJ))(fK);},fH.values,fI.values);}return fC.$==1?(fE=fC.$0,function(fG,fH,fI,fJ){var fK,fL,fM,fN,fO,fP,fQ,fR;while(true)if(fJ.$==1){fK=fJ.$1;fL=fJ.$0;if(fL>fH.time){if(fI.$==1){fM=fI.$0;fN=fI.$1;if(fM.time<=fL){fO=new B({$:1,$0:fL,$1:fK});fH=fM;fI=fN;fJ=fO;}else{fP=fF(fL,fH,fM);fQ=new B({$:1,$0:cv.New(fL,fP),$1:fG});fG=fQ;fJ=fK;}}else return fG;}else{fR=new B({$:1,$0:fH,$1:fG});fG=fR;fJ=fK;}}else return fG;}(B.Empty,fE,fC.$1,function(fG,fH){var fI,fJ;while(true)if(fH.$==1){fI=fH.$0;fJ=fH.$1;if(fG.time<=fI)return fH;else fH=fJ;}else return B.Empty;}(fE,fD))):B.Empty;};cv.zero_order_hold=function(fB,fC,fD,fE,fF){return fE;};cv.create=function(fB,fC){return cv.New(fB,U.ofList(fC));};cv.New=function(fB,fC){return{time:fB,values:fC};};cw.interpolate=function(fB,fC,fD,fE,fF){return cw.New(fE.mean+(fF.mean-fE.mean)*(fB-fC)/(fD-fC),fE.stdev+(fF.stdev-fE.stdev)*(fB-fC)/(fD-fC));};cw.create=function(fB,fC){return cw.New(fB,fC);};cw.New=function(fB,fC){return{mean:fB,stdev:fC};};cy.New=function(fB,fC,fD,fE,fF){return{Node:fB,Left:fC,Right:fD,Height:fE,Count:fF};};cz=x.Pair=fu.Class({Equals:function(fB){return bk.Equals(this.Key,fB.Key);},GetHashCode:function(){return bk.Hash(this.Key);},CompareTo0:function(fB){return bk.Compare(this.Key,fB.Key);}},null,cz);cz.New=function(fB,fC){return new cz({Key:fB,Value:fC});};U.get=function(fB,fC){U.checkBounds(fB,fC);return fB[fC];};U.set=function(fB,fC,fD){U.checkBounds(fB,fC);fB[fC]=fD;};U.checkBounds=function(fB,fC){if(fC<0||fC>=fB.length)F.FailWith("Index was outside the bounds of the array.");};U.length=function(fB){return fB.dims===2?fB.length*fB.length:fB.length;};U.sub=function(fB,fC,fD){U.checkRange(fB,fC,fD);return fB.slice(fC,fC+fD);};U.checkRange=function(fB,fC,fD){if(fD<0||fC<0||fB.length<fC+fD)F.FailWith("Index was outside the bounds of the array.");};U.set2D=function(fB,fC,fD,fE){U.checkBounds2D(fB,fC,fD);fB[fC][fD]=fE;};U.zeroCreate2D=function(fB,fC){var fD;fD=U.init(fB,function(){return U.create(fC,null);});fD.dims=2;return fD;};U.checkBounds2D=function(fB,fC,fD){if(fC<0||fD<0||fC>=fB.length||fD>=(fB.length?fB[0].length:0))throw new fl.New();};U.get2D=function(fB,fC,fD){U.checkBounds2D(fB,fC,fD);return fB[fC][fD];};cA.$cctor=function(){var fB,fC;cA.$cctor=a.ignore;cA.defaultIGraph=J.New(null,new y.New([]),new y.New([]),false);cA.pid=D.op_DotGreaterGreater(D.name(),D.spaces());cA.plocation=D.op_GreaterGreaterEquals(E.pid(),function(fD){var fE;fE=D.choice([D.op_GreaterGreaterEquals(D.op_GreaterGreaterDot(D.pchar("."),E.pid()),function(fF){return D.preturn(new bH({$:1,$0:[fD,fF]}));}),D.preturn(new bH({$:0,$0:fD}))]);return function(fF){return fE([fF[0],fF[1]]);};});cA.pparameter=D.op_GreaterGreaterEquals(E.pid(),function(fD){var fE,fF;fE=D.choice([D.op_GreaterGreaterDot(D.kw("="),(fF=D.choice([D.op_GreaterGreaterDot(D.kw("Fixed"),D.preturn([fD,fD,"Fixed2"])),D.op_GreaterGreaterDot(D.kw("Normal"),D.preturn([fD,fD,"Normal"])),D.op_GreaterGreaterDot(D.kw("LogNormal"),D.preturn([fD,fD,"LogNormal"])),D.op_GreaterGreaterDot(D.kw("TruncatedNormal"),D.preturn([fD,fD,"TruncatedNormal"]))]),function(fG){return fF([fG[0],fG[1]]);})),D.preturn([fD,fD,"TruncatedNormal"])]);return function(fG){return fE([fG[0],fG[1]]);};});cA.parseTask=(fB=D.op_GreaterGreaterDot(D.pTry(D.op_GreaterGreaterDot(D.kw("directive"),D.kw("task"))),D.record(bG.New(null,1,1,1),A.ofArray([["task",D.op_BarGreaterGreater((fC=D.choice([D.op_GreaterGreaterDot(D.kw("infer"),D.preturn("Infer")),D.op_GreaterGreaterDot(D.kw("simulate"),D.preturn("Simulate")),D.op_GreaterGreaterDot(D.kw("parse"),D.preturn("Parse"))]),function(fD){return fC([fD[0],fD[1]]);}),function(fD){return function(fE){return bG.New({$:1,$0:fD},fE.copies,fE.copy_id,fE.nodes);};})],["copies",D.op_BarGreaterGreater(D.pint32(),function(fD){return function(fE){return bG.New(fE.task_type,fD,fE.copy_id,fE.nodes);};})],["copy_id",D.op_BarGreaterGreater(D.pint32(),function(fD){return function(fE){return bG.New(fE.task_type,fE.copies,fD,fE.nodes);};})],["nodes",D.op_BarGreaterGreater(D.pint32(),function(fD){return function(fE){return bG.New(fE.task_type,fE.copies,fE.copy_id,fD);};})]]))),D.op_GreaterGreaterDot(D.spaces(),D.opt(fB)));cA.parse=D.op_GreaterGreaterEquals(D.op_DotGreaterGreaterDot(E.parseTask(),L.get_parse()),function(fD){var fE,fF,fG;fE=fD[0];fF=fD[1];fG=D.choice([E.pinferenceGraph(fE,fF,K.OfArray(U.ofSeq(A.map(function(fH){return[fH.name,fH];},fF.systems)))),D.preturn(J.New(fE,K.OfArray(U.ofSeq(A.ofArray([[fF.top.name,fF]]))),new y.New([]),false))]);return function(fH){return fG([fH[0],fH[1]]);};});cA.from_string=function(fD){return D.from_string(E.parse(),fD);};};cx.OfSeq=function(fB){var fC;fC=U.ofSeq(bc.distinct(fB));U.sortInPlace(fC);return cx.Build(fC,0,fC.length-1);};cx.Enumerate=function(fB,fC){function fD(fE,fF){var fG;while(true)if(fE==null)return fF.$==1?{$:1,$0:[fF.$0[0],[fF.$0[1],fF.$1]]}:null;else if(fB){fG=fE;fE=fG.Right;fF=new B({$:1,$0:[fG.Node,fG.Left],$1:fF});}else{fG=fE;fE=fG.Left;fF=new B({$:1,$0:[fG.Node,fG.Right],$1:fF});}}return bc.unfold(function(fE){return fD(fE[0],fE[1]);},[fC,B.Empty]);};cx.TryFind=function(fB,fC){var fD;fD=(cx.Lookup(fB,fC))[0];return fD==null?null:{$:1,$0:fD.Node};};cx.Contains=function(fB,fC){return!((cx.Lookup(fB,fC))[0]==null);};cx.Add=function(fB,fC){return cx.Put(function(fD,fE){return fE;},fB,fC);};cx.Build=function(fB,fC,fD){var fE,fF,fG;return fD-fC+1<=0?null:(fE=(fC+fD)/2>>0,(fF=cx.Build(fB,fC,fE-1),(fG=cx.Build(fB,fE+1,fD),cx.Branch(U.get(fB,fE),fF,fG))));};cx.Lookup=function(fB,fC){var fD,fE,fF,fG;fD=[];fE=fC;fF=true;while(fF)if(fE==null)fF=false;else{fG=bk.Compare(fB,fE.Node);fG===0?fF=false:fG===1?(fD.unshift([true,fE.Node,fE.Left]),fE=fE.Right):(fD.unshift([false,fE.Node,fE.Right]),fE=fE.Left);}return[fE,fD];};cx.Put=function(fB,fC,fD){var fE,fF;fE=cx.Lookup(fC,fD);fF=fE[0];return fF==null?cx.Rebuild(fE[1],cx.Branch(fC,null,null)):cx.Rebuild(fE[1],cx.Branch(fB(fF.Node,fC),fF.Left,fF.Right));};cx.Branch=function(fB,fC,fD){var fE,fF;return cy.New(fB,fC,fD,1+(fE=fC==null?0:fC.Height,(fF=fD==null?0:fD.Height,bk.Compare(fE,fF)===1?fE:fF)),1+(fC==null?0:fC.Count)+(fD==null?0:fD.Count));};cx.Rebuild=function(fB,fC){var fD,fF,fG,fH,fI,fJ,fK,fL,fM,fN;function fE(fO){return fO==null?0:fO.Height;}fD=fC;for(fF=0,fG=U.length(fB)-1;fF<=fG;fF++){fD=(fH=U.get(fB,fF),fH[0]?(fI=fH[1],(fJ=fH[2],fE(fD)>fE(fJ)+1?fE(fD.Left)===fE(fD.Right)+1?(fK=fD.Left,cx.Branch(fK.Node,cx.Branch(fI,fJ,fK.Left),cx.Branch(fD.Node,fK.Right,fD.Right))):cx.Branch(fD.Node,cx.Branch(fI,fJ,fD.Left),fD.Right):cx.Branch(fI,fJ,fD))):(fL=fH[1],(fM=fH[2],fE(fD)>fE(fM)+1?fE(fD.Right)===fE(fD.Left)+1?(fN=fD.Right,cx.Branch(fN.Node,cx.Branch(fD.Node,fD.Left,fN.Left),cx.Branch(fL,fN.Right,fM))):cx.Branch(fD.Node,fD.Left,cx.Branch(fL,fD.Right,fM)):cx.Branch(fL,fD,fM))));}return fD;};cx.Remove=function(fB,fC){var fD,fE,fF,fG;fD=cx.Lookup(fB,fC);fE=fD[0];fF=fD[1];return fE==null?fC:fE.Right==null?cx.Rebuild(fF,fE.Left):fE.Left==null?cx.Rebuild(fF,fE.Right):cx.Rebuild(fF,(fG=U.ofSeq(bc.append(cx.Enumerate(false,fE.Left),cx.Enumerate(false,fE.Right))),cx.Build(fG,0,fG.length-1)));};cC.NewFromSeq=function(fB){var fC,fD,fE;fC={};fD=da.Get(fB);try{while(fD.MoveNext()){fE=fD.Current();fC[fE[0]]=fE[1];}}finally{if(typeof fD=="object"&&"Dispose"in fD)fD.Dispose();}return fC;};cD.New=function(fB,fC){return{x:fB,y:fC};};cE.New=function(fB,fC){return{box_group:fB,box_dim:fC};};cF.New=function(fB,fC,fD,fE,fF,fG){return{name:fB,content:fC,anchors:fD,debug_anchors:fE,sub_groups:fF,offset:fG};};cH.create=function(fB,fC){return new cM.New(U.create(fB,fC));};cH.toArray=function(fB){return U.init(fB.get_Length(),function(fC){return cH.get(fB,fC);});};cH.get=function(fB,fC){return fB.get_Item(fC);};cI.simulate_callback=function(fB,fC,fD){var fE,fF,fG,fH,fI,fJ,fK;function fL(fM,fN,fO,fP){return function(fQ){var fR,fS,fT,fU,fV;fR=fQ.time;fS=cI.EuclideanNorm(cL.toArray((fJ(fM))(fO)))<=0?(fC(cv.New(fM,(fD.grab_data(fM))(fO))),fC(cv.New(fR,(fD.grab_data(fR))(fO))),[fR,fO,fF.stepsdone+1]):fE.stiff?cI.runSolver(dC.New(dD.init(fM,fO,fJ,(fT=dD.defaults(),dF.New(fT.InitialStepSize,fE.abstolerance,fE.reltolerance,fT.MaxStep,fT.MinStep,fT.MaxScale,fT.MinScale,fT.NumberOfIterations,fT.Jacobian))),a.id,dD.advance,null,function(fW){return fW.t;},function(fW){return fW.x;}),fM,fN,fR,fO,fF.stepsdone,function(fW,fX){return(fD.grab_data(fW))(fX);},fH,fB,fC):cI.runSolver(dC.New(dG.init(fM,fO,fJ,(fU=dG.defaults(),dI.New(fU.InitialStepSize,fE.abstolerance,fE.reltolerance,fU.MaxStep,0.0001))),a.id,dG.advance,{$:1,$0:function(fW){return function(fX){return dG.add_interpolate(fW,fX);};}},function(fW){return fW.t;},function(fW){return fW.x;}),fM,fN,fR,fO,fF.stepsdone,function(fW,fX){return(fD.grab_data(fW))(fX);},fH,fB,fC);fV=fS[0];return[fV,fV+fH,cI.applyPertubation(fQ.target,fS[1],fG),fP];};}fE=fD.settings;fF=fD.simulator;fG=fF.populations;fH=fF.settings.get_print_interval();fI=A.filter(function(fM){var fN;return fM.time>=fF.currenttime&&(fN=fM.target,fN.$==0?U.exists(function(fO){return fO!==0;},fN.$0.get_get_pop_array()):true);},fF.events);fJ=fD.f;fK=bc.fold(function(fM,fN){return(function(fO){return fL(fO[0],fO[1],fO[2],fO[3]);}(fM))(fN);},[fF.currenttime,fF.nextprinttime,fD.concs,fF.stepsdone],fI);return cJ.New(fD.name,bf.New(fF.settings,fF.populations,fF.events,fK[0],fK[1],fK[3]),fD.grab_data,fD.interpolator,fD.settings,fD.f,fK[2]);};cI.create=function(fB,fC,fD,fE,fF,fG,fH){return cJ.New(fB,fC,fD,fE,fF,fH,fG);};cI.EuclideanNorm=function(fB){return fv.sqrt(bc.sumBy(function(fC){return fC*fC;},fB));};cI.runSolver=function(fB,fC,fD,fE,fF,fG,fH,fI,fJ,fK){var fL,fM,fN,fO,fP,fQ,fR,fS,fT;fL=true;fM=fC;fN=fD;fT=[fF];fP=fG;fQ=fB.init;fR=fB.init;fS=true;while(fS)(function(){var fU;fQ=fR;fR=fB.advance(fQ);return bc.fold(function(fV,fW){var fX,fY,fZ,f0,f1,f2,f3;return!fS?null:(fX=fB.get_x(fW),fY=fB.get_time(fW),a.isNaN(fX[0])?cV.ode_solver_error("Solver produced bad solution. Try altering tolerances."):void 0,fZ=_1.shouldStop(fE,fY,fP,fJ,null)?[fE,cI.Lerp(fE,fM,fT[0],fY,fX)]:[fY,fX],f0=fZ[0],fM===fE?(f1=0.99999999,fK(cv.New(f1*fE+(1-f1)*(fM-fI),fH(fM,fT[0])))):void 0,f2=_1.shouldPrint(fE,f0,fN,null,fL,fM)?(fK(cv.New(fM,fH(fM,fT[0]))),f3=f0+fI,bk.Compare(f3,fE)===-1?f3:fE):fN,fJ[0]||fM===fE?(fS=false,void(fM=f0)):(fL=false,fM=f0,fN=f2,fT[0]=fZ[1],void(fP=fP+1)));},null,(fU=fB.refine,fU==null?A.ofArray([fR]):A.append((fU.$0(fQ))(fR),A.ofArray([fR]))));}());return[fM,fT[0],fP];};cI.applyPertubation=function(fB,fC,fD){var fE;return fB=="OutputPoint"?fC:(fE=K.OfArray(U.ofSeq(A.map(function(fF){var fG;return[(fG=fD.tryFind_index(fF.species),fG==null?F.FailWith("Unknown species in event"):fG.$0),fF.value];},fB.$0.get_get_pop_info_list()))),cL.ofArray(U.mapi(function(fF,fG){var fH;fH=K.TryFind(fF,fE);return fH==null?fG:fG+fH.$0;},cL.toArray(fC))));};cI.Lerp=function(fB,fC,fD,fE,fF){return cL.scale(1/(fE-fC),cL.add(cL.scale(fE-fB,fD),cL.scale(fB-fC,fF)));};cJ.New=function(fB,fC,fD,fE,fF,fG,fH){return{name:fB,simulator:fC,grab_data:fD,interpolator:fE,settings:fF,f:fG,concs:fH};};cL.toArray=function(fB){return a.Array.prototype.slice.call(fB);};cL.ofArray=function(fB){return new a.Float64Array(fB);};cL.add=function(fB,fC){var fD,fE,fF,fG;cL.checkSize(fB,fC);fD=fB.length;fE=new a.Float64Array(fD);for(fF=0,fG=fD-1;fF<=fG;fF++)fE[fF]=fB[fF]+fC[fF];return fE;};cL.dot=function(fB,fC){var fD,fE,fF;cL.checkSize(fB,fC);fD=0;for(fE=0,fF=fB.length-1;fE<=fF;fE++)fD=fD+fB[fE]*fC[fE];return fD;};cL.map=function(fB,fC){var fD;fD=cL.copy(fC);cL.update(fB,fD);return fD;};cL.sum=function(fB){var fC,fD,fE;fC=0;for(fD=0,fE=fB.length-1;fD<=fE;fD++)fC=fC+fB[fD];return fC;};cL.map2=function(fB,fC,fD){var fE,fF,fG,fH,fI,fJ;cL.checkSize(fC,fD);fE=fC.length;fF=new a.Float64Array(fE);for(fG=0,fH=fE-1;fG<=fH;fG++){fF[fG]=(fI=fC[fG],(fJ=fD[fG],(fB(fI))(fJ)));}return fF;};cL.max=function(fB){var fC,fD,fE,fF;fC=0;for(fD=0,fE=fB.length-1;fD<=fE;fD++){fC=(fF=fB[fD],bk.Compare(fC,fF)===1?fC:fF);}return fC;};cL.scale=function(fB,fC){var fD,fE,fF;fD=cL.copy(fC);for(fE=0,fF=fD.length-1;fE<=fF;fE++)fD[fE]=fB*fD[fE];return fD;};cL.subtract=function(fB,fC){var fD,fE,fF,fG;cL.checkSize(fB,fC);fD=fB.length;fE=new a.Float64Array(fD);for(fF=0,fG=fD-1;fF<=fG;fF++)fE[fF]=fB[fF]-fC[fF];return fE;};cL.copy=function(fB){var fC;fC=new a.Float64Array(fB.length);fC.set(fB);return fC;};cL.mapi2=function(fB,fC,fD){var fE,fF,fG,fH,fI,fJ;cL.checkSize(fC,fD);fE=fC.length;fF=new a.Float64Array(fE);for(fG=0,fH=fE-1;fG<=fH;fG++){fF[fG]=(fI=fC[fG],(fJ=fD[fG],((fB(fG))(fI))(fJ)));}return fF;};cL.checkSize=function(fB,fC){if(fB.length!==fC.length)F.FailWith("Vector dimensions do not match");};cL.update=function(fB,fC){var fD,fE;for(fD=0,fE=fC.length-1;fD<=fE;fD++)fC[fD]=fB(fC[fD]);};cL.setScaled=function(fB,fC){var fD,fE,fF;fD=fC.length;for(fE=0,fF=fD-1;fE<=fF;fE++)fC[fE]=fB*fC[fE];};cL.setAddedScaled=function(fB,fC,fD){var fE,fF,fG;cL.checkSize(fB,fC);fE=fB.length;for(fF=0,fG=fE-1;fF<=fG;fF++)fB[fF]=fB[fF]+fD*fC[fF];};cM=d.VectorFS=fu.Class({set_Item:function(fB,fC){U.set(this.values,fB,fC);},ToArray:function(){return cH.toArray(this);},get_Length:function(){return U.length(this.values);},get_Item:function(fB){return U.get(this.values,fB);}},w,cM);cM.New=fu.Ctor(function(fB){w.New.call(this);this.values=fB;},cM);cN=d.Lambda=fu.Class({get_key:function(){return this.$0;},Equals:function(fB){return fB instanceof cN&&this===fB;},GetHashCode:function(){return bk.Hash(this);}},null,cN);cO.matrMultVec=function(fB,fC){var fD;fD=new a.Float64Array(cO.numRows(fB));cO.matrMultVecStore(fB,fC,fD);return cL.ofArray(fD);};cO.ofArray=function(fB){return c1.New(U.map(cL.ofArray,fB));};cO.matrMultMatr=function(fB,fC){var fD,fE,fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO,fP;fD=cO.numRows(fB);fE=cO.numCols(fB);fF=cO.numCols(fC);fE!==cO.numRows(fC)?F.FailWith("Matrix dimensions do not match"):null;fG=cO.zeros(fD,fF);for(fH=0,fI=fD-1;fH<=fI;fH++){fJ=fB.get_Item(fH);fK=fG.get_Item(fH);for(fL=0,fM=fF-1;fL<=fM;fL++){fN=0;for(fO=0,fP=fE-1;fO<=fP;fO++)fN=fN+fJ[fO]*(U.get(fC.MatrixData,fO))[fL];fK[fL]=fN;}}return fG;};cO.add=function(fB,fC){cO.sameSizeCheck(fB,fC);return c1.New(U.map2(cL.add,fB.MatrixData,fC.MatrixData));};cO.numRows=function(fB){return U.length(fB.MatrixData);};cO.matrMultVecStore=function(fB,fC,fD){var fE,fF,fG,fH,fI,fJ,fK;for(fE=0,fF=cO.numRows(fB)-1;fE<=fF;fE++){fG=0;fI=fB.get_Item(fE);for(fJ=0,fK=cO.numCols(fB)-1;fJ<=fK;fJ++)fG=fG+fI[fJ]*fC[fJ];U.set(fD,fE,fG);}};cO.numCols=function(fB){return U.get(fB.MatrixData,0).length;};cO.zeros=function(fB,fC){return c1.New(U.init(fB,function(){return new a.Float64Array(fC);}));};cO.sameSizeCheck=function(fB,fC){var fD,fE;fD=cO.numRows(fB);fE=cO.numCols(fB);fD!==cO.numRows(fC)||fE!==cO.numCols(fC)?F.FailWith("Matrix dimensions do not match"):void 0;};cO.toArray=function(fB){return U.init(cO.numRows(fB),function(fC){return cL.toArray(cO.copyRow(fB,fC));});};cO.copyCol=function(fB,fC){var fD,fE,fF,fG;fD=cO.numRows(fB);fE=new a.Float64Array(fD);for(fF=0,fG=fD-1;fF<=fG;fF++)fE[fF]=(U.get(fB.MatrixData,fF))[fC];return fE;};cO.ofRows=function(fB){return c1.New(U.map(cL.copy,fB));};cO.matrMultScal=function(fB,fC){return cO.scalMultMatr(fC,fB);};cO.copyRow=function(fB,fC){return cL.copy(fB.get_Item(fC));};cO.copy=function(fB){return c1.New(U.map(cL.copy,fB.MatrixData));};cO.scalMultMatr=function(fB,fC){return c1.New(U.map(function(fD){return cL.scale(fB,fD);},fC.MatrixData));};cO.subtract=function(fB,fC){cO.sameSizeCheck(fB,fC);return c1.New(U.map2(cL.subtract,fB.MatrixData,fC.MatrixData));};cO.identity=function(fB,fC){var fD,fE,fF,fG,fH;fD=cO.zeros(fB,fC);for(fE=0,fF=(fG=fB-1,(fH=fC-1,bk.Compare(fG,fH)===-1?fG:fH));fE<=fF;fE++)(U.get(fD.MatrixData,fE))[fE]=1;return fD;};cO.vectorProduct=function(fB,fC){var fD,fE,fF,fG,fH,fI,fJ,fK;fD=fB.length;fE=fC.length;fF=cO.zeros(fD,fE);for(fG=0,fH=fD-1;fG<=fH;fG++){for(fI=0,fJ=fE-1;fI<=fJ;fI++){fK=fB[fG]*fC[fI];(U.get(fF.MatrixData,fG))[fI]=fK;}}return fF;};cP=d.Ode=fu.Class({to_oslo:function(){return this.to_oslo_abstract().evaluate();},to_sundials:function(){return this.to_sundials_abstract().evaluate();},to_lna:function(fB){var fC,fD,fE,fF,fG;fC=cP.get_matrices(this.initials,this.reactions);fD=fC[0];fE=dJ.create(this.name,this.settings,fC[1],fC[2],cP.get_rates(fD,this.reactions,!bk.Equals(this.settings.simulation.kinetics,"Deterministic")),fD,this.initials);fF=bF.to_env(this.settings.parameters);fG=U.map(function(fH){return R["eval"](function(fI){return di.find(fF,fI);},fH.value);},U.ofList(this.initials));return _4.initialise(fE.evaluate(),fE.matrix,fG,fB);},to_oslo_abstract:function(){var fB,fC;fB=cP.get_matrices(this.initials,this.reactions);fC=fB[0];return dJ.create(this.name,this.settings,fB[1],fB[2],cP.get_rates(fC,this.reactions,bk.Equals(this.settings.simulation.kinetics,"Stochastic")),fC,this.initials);},to_sundials_abstract:function(){return dL.create(K.OfArray(U.mapi(function(fB,fC){return[fC.species,fB];},U.ofSeq(bc.distinctBy(function(fB){return fB.species;},this.initials)))),this.reactions,this.initials,this.settings);},prune:function(fB){var fC,fD,fE,fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO,fP;function fQ(fW){var fX;fX=R.simplify(R.substitute(fB,fW));return fX.$==1?fX.$0!==0:true;}function fR(fW,fX){return A.forAll(function(fY){return A.contains(fY,fW);},b$.elements(fX.reactants));}function fS(fW,fX){return function(fY){var fZ,f0,f1;fZ=A.partition(function(f2){return fR(fY,f2);},fX);f0=fZ[0];return f0.$==0?[fW,fY]:(f1=A.filter(function(f2){return!A.contains(f2,fY);},A.collect(function(f2){return b$.elements(f2.products);},f0)),(function(f2){return fS(f2[0],f2[1]);}([A.append(f0,fW),fZ[1]]))(A.distinct(A.append(f1,fY))));};}function fT(fW){return fW.$==1?{$:1,$0:fW.$0}:null;}function fU(fW){return fW[1];}function fV(fW){return Q.all_species(fH,fW);}fC=A.filter(function(fW){return fQ(fW.value);},this.initials);fD=A.map(function(fW){return fW.species;},fC);fE=(function(fW){return fS(fW[0],fW[1]);}([B.Empty,A.collect(function(fW){var fX;fX=fW.normalise();return fX[1]==null?A.ofArray([fX[0]]):A.ofArray([fX[0],fX[1].$0]);},this.reactions)]))(fD);fF=fE[1];fG=fE[0];fH=this.settings.all_used_rates((fI=function(fW){return A.choose(fT,fW);},function(fW){return fI(R.mentions(fW));}),fG);fJ=K.OfArray(U.ofSeq(A.map(function(fW){return[{$:2,$0:fW},{$:1,$0:0}];},A.ofSeq(dh.op_Subtraction(new dh.New$1(cx.OfSeq(A.collect(function(fW){return fV(fU(fW));},A.ofSeq(K.ToSeq(fH))))),new dh.New$1(cx.OfSeq(fF)))))));fK=K.Map(function(fW,fX){return R.substitute(fJ,fX);},fH);fL=K.OfArray(U.ofSeq(A.map(function(fW){return[{$:2,$0:fW},{$:1,$0:0}];},A.ofSeq(dh.op_Subtraction(new dh.New$1(cx.OfSeq(A.collect(function(fW){return Q.all_species(fH,fW);},this.settings.simulation.plots))),new dh.New$1(cx.OfSeq(fF)))))));fM=(fN=this.settings,O.New((fO=this.settings.simulation,P.New(fO.name,fO.initial,fO["final"],fO.points,A.map(function(fW){return R.substitute(fL,fW);},this.settings.simulation.plots),fO.plotcolours,fO.seed,fO.kinetics,fO.times,fO.prune,fO.multicore,fO.data,fO.sweeps)),fN.simulations,fN.stochastic,fN.deterministic,fN.spatial,fN.inference,fN.moment_closure,fN.synthesis,fN.data,fN.units,fN.simulator,fN.parameters,fN.sweeps,fK,fN.plot,fN.quiet));fP=A.map(function(fW){return fW.species;},fC);return cP.New(this.name,fM,fG,A.rev(db.fold_left(function(fW,fX){return A.exists(function(fY){return bk.Equals(fX,fY);},fP)?fW:new B({$:1,$0:V.create$4(false,{$:1,$0:0},fX,null,null),$1:fW});},A.rev(fC),fF)));},substitute:function(fB){return cP.New(this.name,this.settings.substitute(fB),this.reactions,this.initials);},simulate_instance:function(fB,fC){try{return bt.create(fC,fB(this.substitute(fC.environment)));}catch(fD){return F.FailWith(a.String(fD));}}},null,cP);cP.list_to_inference=function(fB,fC){var fD;function fE(fF,fG){var fH,fI;fH=fF?fG:cP.update_times(B.Empty,fG);fI=fB.simulator;return fI=="Oslo"?fH.to_oslo().simulate():fI=="Sundials"?cP.simulate_sundials(fH):(function(fJ){return function(fK){return fJ("Invalid simulator type for inference: "+bN.p(fK));};}(F.FailWith))(fB.simulator);}fD=cP.list_to_inference_method(fB,fC);return fB.inference.partial_evaluation?cP.list_inference_dependencies(fB,fD[0],fD[1],function(fF){return function(fG){return fE(fF,fG);};},fD[3],fD[4],fD[2],fD[5]):cP.list_inference_full(fB,fD[0],fD[1],function(fF){return function(fG){return fE(fF,fG);};},fD[3],fD[4],fD[2],fD[5]);};cP.create=function(fB,fC,fD,fE){return cP.New(fB,fE,fC,fD);};cP.get_matrices=function(fB,fC){var fD,fE,fF,fG,fH,fI,fJ;fD=U.ofList(A.distinctBy(function(fK){return fK.species;},fB));fE=K.OfArray(U.mapi(function(fK,fL){return[fL.species,fK];},fD));fF=A.length(fC);fG=fD.length;fH=U.init(fG,function(){return U.create(fF,0);});for(fI=0,fJ=fG-1;fI<=fJ;fI++)(function(fK){return A.iteri(function(fL,fM){return U.set(U.get(fH,fK),fL,fM.getStoich(U.get(fD,fK).constant,U.get(fD,fK).species));},fC);}(fI));return[fE,fH,U.ofList(A.map(function(fK){return b$.collectm(function(fL){return[fE.get_Item(fL.element),fL.multiplicity];},fK.reactants);},fC))];};cP.get_rates=function(fB,fC,fD){var fE,fF;function fG(fH){var fI;fI=K.TryFind(fH,fB);return fI==null?(function(fJ){return function(fK){return fJ("Missing species: "+_2.prettyPrint(fK)+" in rate");};}(F.FailWith))(fH.name):fI.$0;}fE=(fF=function(fH){return co.map(fG,fH);},function(fH){return R.map(fF,fH);});return U.ofList(A.map(function(fH){return fH.rate.map(fD?function(fI){return fH.deterministic_to_stochastic(fI);}:a.id,fE);},fC));};cP.to_matlab=function(fB){var fC,fD,fE,fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO,fP,fQ,fR,fS,fT,fU;function fV(f1){dl.append(fQ,f1);}function fW(f1){return R["eval"](fD,f1);}function fX(f1){return"sol.(\'"+be.to_string(f1)+"\')";}function fY(f1){var f2,f3;f2=A.map(function(f4){return[f4,be.to_string(f4)];},A.rev(b$.elements(f1.reactants)));f3=f1.rate;return f3.$==1?R.to_string(function(f4){return co.to_matlab(be.to_string,fF,f4);},f3.$0):R.to_string(a.id,bc.fold(function(f4,f5){var f6;f6={$:1,$0:f1.numInReactants(f5[0])};return R.mul(f4,R.power$1(R.from_string(D.name(),f5[1]),f6));},f3.$0,f2));}function fZ(f1){return"d"+f1;}function f0(f1,f2,f3){var f4;f4=(db.fold_left(function(f5,f6){return(function(f7){var f8,f9;f8=f7[0];f9=f7[1];return function(f_){var f$,ga;f$=bc.nth(f1,f2);ga=f_[1].getStoich(f$.constant,f$.species);return ga===0?[f8,f9]:[f8+(ga>0?f9?" ":" + ":f9?" -":" - ")+(fv.abs(ga)===1?"":a.String(fv.abs(ga))+"*")+"r_"+a.String(f_[0]),false];};}(f5))(f6);},["",true],f3))[0];return f4===""?"0.0":f4;}fC=db.newline();fD=(fE=bF.to_env(fB.settings.parameters),function(f1){return di.find(fE,f1);});fF="t";fG="dxdt";fH="x__";fI="odes";fJ="tstart";fK="species";fL="sol";fM="i";fN="n";fO="tfinal";fP="plots";fQ=dl.empty();fR=!(fB.settings.simulation.plots.$==0);fV("function "+fL+" = "+"crn_export"+"()"+fC+fC);fV(fJ+" = "+a.String(fB.settings.simulation.initial)+"; % Initial time"+fC);fV(fO+" = "+a.String(fB.settings.simulation["final"])+"; % Final time"+fC);fV(fK+" = {"+db.string_of_list(function(f1){return"\'"+f1.species.name+"\'";},",",fB.initials)+"}; % The list of all species"+fC);fR?fV(fP+" = {"+db.string_of_list(function(f1){return"\'"+R.to_string(function(f2){return co.to_matlab(be.to_string,"time",f2);},f1)+"\'";},",",fB.settings.simulation.plots)+"};"+fC):void 0;fV(fN+" = length("+fK+");"+fC+fC);fV("% Write out the parameters");A.iter(function(f1){fV(fC+"p."+f1.name+" = "+a.String(f1.value)+";");},fB.settings.parameters);fV(fC+fC);fS=A.map(function(f1){return V["eval"](fW,f1);},fB.initials);fV("% Assign initial conditions"+fC);fV("x0 = zeros("+fN+",1);");A.iteri(function(f1,f2){return f2.value!==0?fV(fC+"x0("+a.String(f1+1)+") = "+a.String(f2.value)+";"+"\\u0009\\u0009"+"% "+f2.species.name):null;},fS);fV(fC+fC);fT=fB.settings.parameters.$==0?"":",p";fV("% Solve the ODEs"+fC);fV("["+fF+","+fH+"] = "+"ode15s"+"(@"+fI+",["+fJ+" "+fO+"],x0,[]"+fT+");"+fC+fC);fV("% Write out a solution structure to be returned by the function"+fC);fV("for "+fM+" = 1:"+fN+fC);fV("  "+fL+".("+fK+"{"+fM+"}) = "+fH+"(:,"+fM+");"+fC);fV("end"+fC+fC);fR?(fV("% Apply plot expressions"+fC),fV("plotsValues = zeros(length("+fH+"),"+a.String(A.length(fB.settings.simulation.plots))+");"),A.iteri(function(f1,f2){return fV(fC+"plotsValues(:,"+a.String(f1+1)+") = "+dk.Replace(dk.Replace(dk.Replace(R.to_string(function(f3){return co.to_matlab(fX,"time",f3);},f2),"*",".*"),"/","./"),"^",".^")+";");},fB.settings.simulation.plots),fV(fC+fC)):void 0;fV("% Produce a plot"+fC);fV("figure;"+fC);fU=fR?["plotsValues",fP]:[fH,fK];fV("plot("+fF+", "+fU[0]+")"+fC);fV("xlabel(\'Time\')"+fC);fV("ylabel(\'Concentration\')"+fC);fV("box off"+fC);fV("legend("+fU[1]+",\'box\',\'off\')");fV(fC+fC+"return"+fC+fC+"%%%"+fC+fC);fV("function "+fG+" = "+fI+"("+fF+","+fH+fT+")"+fC+fC);!(fB.settings.parameters.$==0)?(fV("% Write out the parameters"),A.iter(function(f1){fV(fC+f1.name+" = p."+f1.name+";");},fB.settings.parameters),fV(fC+fC)):void 0;fV("% Assign states");A.iteri(function(f1,f2){return fV(fC+f2.species.name+" = "+fH+"("+a.String(f1+1)+")"+";");},fS);fV(fC+fC);!fB.settings.rates.get_IsEmpty()?(fV("% Define rate expressions"),K.Iterate(function(f1,f2){return fV(fC+f1+" = "+R.to_string(function(f3){return co.to_matlab(be.to_string,fF,f3);},f2)+";");},fB.settings.rates),fV(fC+fC)):void 0;fV("% Define reaction propensities");A.iteri(function(f1,f2){return fV(fC+"r_"+a.String(f1)+" = "+fY(f2)+";");},fB.reactions);fV(fC+fC);fV("% Assign derivatives");A.iteri(function(f1,f2){return fV(fC+fZ(f2.species.name)+" = "+f0(f1,fS,A.indexed(fB.reactions))+";");},fB.initials);fV(fC+fC);fV(fG+" = ["+db.string_of_list(function(f1){return fZ(f1.species.name);},";",fB.initials)+"];"+fC+fC);fV("return");return a.String(fQ);};cP.update_times=function(fB,fC){return cP.New(fC.name,fC.settings.update_times(fB),fC.reactions,fC.initials);};cP.simulate_sundials=function(fB){var fC,fD;try{return fB.to_sundials().simulate();}catch(fE){if(fE instanceof cX){throw cV.ode_solver_error((fD=bF.to_string_inline(fB.settings.parameters),(((fu.Curried3(function(fF,fG,fH){return fF(_2.toSafe(fG)+"\\n\\nParameters: "+_2.toSafe(fH));}))(a.id))(fE.message))(fD)));}else throw fE;return fC;}};cP.list_to_inference_method=function(fB,fC){var fD,fE,fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO,fP,fQ,fR,fS,fT,fU;function fV(fX,fY){return A.map(function(fZ){return cP.New(fX.name,fX.settings.update_simulation(fZ.settings),fX.reactions,fX.initials);},fY);}function fW(fX,fY){return fX.prune(db.update_map(fU,fY));}fD=fB.to_inference_runs(A.map(function(fX){return fX.settings;},fC));fE=fD[2];fF=fD[3];fG=fD[0];fH=bF.to_env((A.partition(bX.variable,fG))[1]);fI=A.map(function(fX){return A.map(function(fY){return fY.inline_env(fH);},fX);},fE);fJ=bF.remove(A.collect(ek.get_variables,fI),fG);fK=A.zip(fI,fF);fL=A.collect(function(fX){return A.map(function(fY){return fY.plots;},fX);},fF);fM=A.map(function(fX){var fY;return cP.New(fX.name,(fY=fX.settings,O.New(fY.simulation,fY.simulations,fY.stochastic,fY.deterministic,fY.spatial,fY.inference,fY.moment_closure,fY.synthesis,fY.data,fY.units,fY.simulator,fG,fY.sweeps,fY.rates,fY.plot,fY.quiet)),fX.reactions,fX.initials);},fC);fN=bF.to_env(fJ);fO=A.map2(function(fX,fY){return cP.generate_instances(fN,fX.name,fY[0],fY[1]);},fM,fK);fP=A.concat((((fu.Curried3(A.map2))(fV))(fM))(fO));fQ=A.concat(fO);fR=A.concat(fE);fS=fB.simulation.prune?(fT=A.collect(function(fX){return A.map(function(fY){return K.OfArray(U.ofSeq(A.zip(fX.get_merge().variables,fY)));},fX.get_merge().values);},fR),(fU=K.Map(function(fX,fY){return{$:1,$0:fY};},fH),(((fu.Curried3(A.map2))(fW))(fP))(fT))):fP;return[fL,A.concat(fD[1]),fJ,fS,fQ,fR];};cP.list_inference_dependencies=function(fB,fC,fD,fE,fF,fG,fH,fI){var fJ;fJ=A.indexed(ek.get_variable_dependencies(fI));return bu.create_with_dependencies(fB.inference,function(fK,fL,fM){var fN,fO,fP,fQ,fR;function fS(fT,fU){return A.contains(fT,fR);}fN=A.map2(function(fT,fU){return fT.update_environment(fU);},fG,A.map(function(fT){return fT[1];},ek["eval"](fL,fI)));fO=A.map(function(fT){return fT.substitute(fL);},fF);fP=A.indexed(A.zip(fN,fO));fQ=fM.$==0?[fN,fO]:(fR=fM.$0,A.unzip(A.map(function(fT){return fT[1];},A.filter(function(fT){return fS(fT[0],fT[1]);},fP))));return cP.list_simulate_instances(fB.simulation.multicore,fE(fK),fQ[0],fQ[1]);},fC,fD,fH,A.map(function(fK){var fL;function fM(fN,fO){return A.contains(fK.name,fO);}fL=A.filter(function(fN){return fM(fN[0],fN[1]);},fJ);return fL.$==0?d2.All:{$:1,$0:A.sort(A.map(function(fN){return fN[0];},fL))};},fH));};cP.list_inference_full=function(fB,fC,fD,fE,fF,fG,fH,fI){return bu.create(fB.inference,function(fJ,fK){var fL,fM;fL=A.map2(function(fN,fO){return fN.update_environment(fO);},fG,A.map(function(fN){return fN[1];},ek["eval"](fK,fI)));fM=A.map(function(fN){return fN.substitute(fK);},fF);return cP.list_simulate_instances(fB.simulation.multicore,fE(fJ),fL,fM);},fC,fD,fH);};cP.generate_instances=function(fB,fC,fD,fE){var fG,fH,fI,fJ;function fF(fK,fL,fM,fN){return function(fO){return C.create$5(fC,fK,fL,fM,fO,fN);};}fG=ek.eval_label(fB,fD);fH=A.length(fE);fI=A.length(fG);if(fH!==fI){fJ=A.head(fG);throw new cW.New(((((fu.Curried(function(fK,fL,fM,fN){return fK("Number of sweep items in "+_2.toSafe(fL)+" ("+a.String(fM)+") not compatible with number of data columns ("+a.String(fN)+")");},4))(a.id))(fJ[0]))(fI))(fH));}else return A.map2(function(fK,fL){return(function(fM){return fF(fM[0],fM[1],fM[2],fM[3]);}(fK))(fL);},fG,fE);};cP.list_simulate_instances=function(fB,fC,fD,fE){return fB?F.FailWith("Can\'t use Async in JavaScript (directive simulation {multicore=True})"):A.map2(function(fF,fG){return fG.simulate_instance(fC,fF);},fD,fE);};cP.New=function(fB,fC,fD,fE){return new cP({name:fB,settings:fC,reactions:fD,initials:fE});};cR=cQ.Random=fu.Class({NextDouble:function(){var fB;fB=this.rng[0].Microsoft_Research_Filzbach_Lib_IRng$NextDouble();this.rng[0]=fB[1];return fB[0];},Next$1:function(){var fB;fB=this.rng[0].Microsoft_Research_Filzbach_Lib_IRng$NextInt32();this.rng[0]=fB[1];return F.toInt(fB[0]);}},w,cR);cR.New$1=fu.Ctor(function(fB){w.New.call(this);this.rng=[new dK.New(fB)];},cR);cR.New=fu.Ctor(function(){var fB;cR.New$1.call(this,fv.abs(F.toInt((fB=fy.now(),fB*10000))));},cR);cS.count=function(fB){return fB.count;};cS.iter=function(fB,fC){var fD,fE;fD=da.Get(fC);try{while(fD.MoveNext()){fE=fD.Current();fB(fE.K,fE.V);}}finally{if(typeof fD=="object"&&"Dispose"in fD)fD.Dispose();}};cS.find=function(fB,fC){return fB.get_Item(fC);};cS.ofMap=function(fB){var fC;fC=cS.empty();K.Iterate(function(fD,fE){return cS.add(fC,fD,fE);},fB);return fC;};cS.empty=function(){return new bd.New$5();};cS.add=function(fB,fC,fD){fB.set_Item(fC,fD);};cS.tryFind=function(fB,fC){return fB.ContainsKey(fC)?{$:1,$0:fB.get_Item(fC)}:null;};cS.map_key=function(fB,fC){var fD;fD=cS.empty();cS.iter(function(fE,fF){return cS.add(fD,fB(fE),fF);},fC);return fD;};cS.copy=function(fB){var fC;fC=cS.empty();cS.iter(function(fD,fE){return cS.add(fC,fD,fE);},fB);return fC;};cS.fold=function(fB,fC,fD){var fE,fF,fG;fE=fD;fF=da.Get(fC);try{while(fF.MoveNext()){fG=fF.Current();fE=fB(fG.K,fG.V,fE);}}finally{if(typeof fF=="object"&&"Dispose"in fF)fF.Dispose();}return fE;};cS.map=function(fB,fC){var fD;fD=cS.empty();cS.iter(function(fE,fF){return cS.add(fD,fE,fB(fF));},fC);return fD;};cT=d.Event=fu.Class({},null,cT);cT.create=function(fB,fC){return cT.New(fC,{$:0,$0:fB});};cT.New=function(fB,fC){return new cT({time:fB,target:fC});};cU.New=function(fB,fC,fD){return{reaction:fB,propensity:fC,dependencies:fD};};b$.iterm=function(fB,fC){A.iter(fB,fC);};b$.elements=function(fB){return A.map(function(fC){return fC.element;},fB);};b$.union_all=function(fB,fC){return db.fold_left(function(fD,fE){return b$.union(fB,fD,fE);},b$.empty(),fC);};b$.to_mlist=a.id;b$.map=function(fB,fC){return A.map(function(fD){return ca.New(fB(fD.element),fD.multiplicity);},fC);};b$.is_empty=function(fB){return fB.$==0;};b$.union=function(fB,fC,fD){return db.fold_left(function(fE,fF){return b$.add(fB,fE,fF);},fC,fD);};b$.empty=function(){eu.$cctor();return eu.empty;};b$.collectm=function(fB,fC){return A.map(fB,fC);};b$.size=function(fB){return b$.fold_left_m(function(fC,fD){return fC+fD.multiplicity;},0,fB);};b$.to_map=function(fB){return K.OfArray(U.ofSeq(A.map(function(fC){return[fC.element,fC.multiplicity];},fB)));};b$.nonzero_elements=function(fB){return A.choose(function(fC){return fC.multiplicity===0?null:{$:1,$0:fC.element};},fB);};b$.difference=function(fB,fC,fD){return A.append(b$.mapm(function(fE){return ca.New(fE.element,fE.multiplicity-b$.get_mult(fB,fD,fE.element));},fC),b$.mapm(function(fE){return ca.New(fE.element,-fE.multiplicity);},b$.filter(function(fE){return b$.get_mult(fB,fC,fE)===0;},fD)));};b$.fold_left_m=function(fB,fC,fD){return db.fold_left(fB,fC,fD);};b$.get_mult=function(fB,fC,fD){var fE;fE=bc.tryFind(function(fF){return fB(fD,fF.element);},fC);return fE!=null&&fE.$==1?fE.$0.multiplicity:0;};b$.add=function(fB,fC,fD){function fE(fF,fG){var fH,fI;return fG.$==1?(fH=fG.$1,(fI=fG.$0,fB(fI.element,fF.element)?new B({$:1,$0:ca.New(fI.element,fI.multiplicity+fF.multiplicity),$1:fH}):new B({$:1,$0:fI,$1:fE(fF,fH)}))):A.ofArray([fF]);}return fE(fD,fC);};b$.mapm=function(fB,fC){return A.map(fB,fC);};b$.filter=function(fB,fC){return A.filter(function(fD){return b$.on_e(fB,fD);},fC);};b$.to_string=function(fB,fC,fD){return db.string_of_list(function(fE){return fE.multiplicity===0?"":fE.multiplicity===1?fB(fE.element):a.String(fE.multiplicity)+fB(fE.element);},fC,fD);};b$.on_e=function(fB,fC){return fB(fC.element);};b$.parse=function(fB){var fC,fD;fC=D.sepBy((fD=b$.counted(fB),function(fE){return b$.op_DotGreaterGreater(fD,D.spaces(),fE[0],fE[1]);}),D.skw("+"));return function(fE){return b$.op_BarGreaterGreater(fC,b$.from_mlist,fE[0],fE[1]);};};b$.op_BarGreaterGreater=function(fB,fC,fD,fE){return(D.op_BarGreaterGreater(fB,fC))([fD,fE]);};b$.from_mlist=function(fB){return db.fold_left(function(fC,fD){return b$.add(bk.Equals,fC,fD);},b$.empty(),fB);};b$.op_DotGreaterGreater=function(fB,fC,fD,fE){return(D.op_DotGreaterGreater(fB,fC))([fD,fE]);};b$.counted=function(fB){var fC,fD;function fE(fH){return ca.New(fH,1);}function fF(fH,fI){return b$.op_PlusGreaterGreaterPlus(D.pint32(),fB,fH,fI);}function fG(fH,fI){return ca.New(fI,fH);}fC=function(fH){return b$.op_BarGreaterGreater(fB,fE,fH[0],fH[1]);};fD=function(fH){return b$.op_BarGreaterGreater(function(fI){return fF(fI[0],fI[1]);},function(fI){return fG(fI[0],fI[1]);},fH[0],fH[1]);};return function(fH){return b$.op_LessBarGreater(fC,fD,fH[0],fH[1]);};};b$.op_LessBarGreater=function(fB,fC,fD,fE){return(D.op_LessBarGreater(fB,fC))([fD,fE]);};b$.op_PlusGreaterGreaterPlus=function(fB,fC,fD,fE){return(D.op_PlusGreaterGreaterPlus(fB,fC))([fD,fE]);};cW=cV.EngineException=fu.Class({},G,cW);cW.New=fu.Ctor(function(fB){this.message=fB;cG.setPrototypeOf(this,cW.prototype);},cW);cX=cV.SimulatorErrorException=fu.Class({},cW,cX);cX.New=fu.Ctor(function(fB){cW.New.call(this,"Simulator error: "+fB);},cX);cY.Time={$:1};cY.map=function(fB,fC){return fC.$==1?cY.Time:{$:0,$0:fB(fC.$0)};};cZ.New=function(fB,fC,fD,fE,fF,fG){return{id:fB,payload:fC,population:fD,isExplored:fE,isConstant:fF,deps:fG};};c0.New=function(fB,fC,fD,fE,fF){return{id:fB,payload:fC,reacts:fD,prods:fE,prop:fF};};c1=cK.Matrix=fu.Class({get_Item:function(fB){return U.get(this.MatrixData,fB);}},null,c1);c1.New=function(fB){return new c1({MatrixData:fB});};c2.array=function(fB,fC,fD){return fC==null?fD!=null&&fD.$==1?fB.slice(0,fD.$0+1):[]:fD==null?fB.slice(fC.$0):fB.slice(fC.$0,fD.$0+1);};c4.neumann_solve=function(fB,fC,fD,fE,fF){var fG,fH,fI,fJ,fK,fL,fM,fN,fO,fP;fG=fE.numspecies;fH=fE.nx;fI=fE.dt;fJ=(fE.xmax-fE.xmin)/(fE.nx-1);fK=U.map(function(fQ){return fQ*fI/(fJ*fJ);},fE.D);fL=U.init(fG,function(fQ){return U.concat([[0],U.create(fH-1,U.get(fK,fQ))]);});fM=U.init(fG,function(fQ){return U.concat([[2-U.get(fK,fQ)],U.create(fH-2,2-2*U.get(fK,fQ)),[2-U.get(fK,fQ)]]);});fN=U.init(fG,function(fQ){return U.concat([U.create(fH-1,U.get(fK,fQ)),[0]]);});fO=U.init(fG,function(fQ){var fR,fS,fT,fU,fV,fW,fX,fY;fR=U.get(fK,fQ);fS=-fR;fT=2+2*fR;fU=-fR;fV=fF===1?[U.create(fH,fS),U.concat([[2+fR],U.create(fH-2,fT),[2+fR]]),U.create(fH,fU)]:fF===2?[U.concat([[-fR*2/3],U.create(fH-1,fS)]),U.concat([[2+fR*2/3],U.create(fH-2,fT),[2+fR*2/3]]),U.concat([U.create(fH-1,fU),[-fR*2/3]])]:(function(fZ){return function(f0){return fZ("No order "+a.String(f0)+" approximation defined for zero-flux 1d solver");};}(F.FailWith))(fF);fW=fV[2];fX=fV[1];fY=fV[0];return function(fZ){return dM.TridiagonalAlgorithm(fY,fX,fW,fZ);};});fP=U.length(fE.plotlocs);return c4.solver(fB,fC,fD,fH,fG,fK,fO,fL,fM,fN,function(fQ){return U.init(fH,function(fR){return U.init(fP,function(fS){return U.get(U.get(fQ,U.get(fE.plotlocs,fS)),fR);});});},fE);};c4.periodic_solve=function(fB,fC,fD,fE){var fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO;fF=fE.numspecies;fG=fE.nx-1;fH=fE.dt;fI=(fE.xmax-fE.xmin)/(fE.nx-1);fJ=U.map(function(fP){return fP*fH/(fI*fI);},fE.D);fK=U.init(fF,function(fP){var fQ,fR,fS,fT,fU,fV,fW,fX,fY,fZ,f0;fQ=U.get(fJ,fP);fR=-fQ;fS=2*(1+fQ);fT=-fQ;fU=U.create(fG,fR);fV=U.concat([[2*fS],U.create(fG-2,fS),[fS+fR*fT/fS]]);fW=U.create(fG,fT);fX=-fS;fY=U.concat([[fX],U.create(fG-2,0),[fT]]);fZ=U.concat([[1],U.create(fG-2,0),[fR/fX]]);f0=dM.TridiagonalAlgorithm(fU,fV,fW,fY);return function(f1){return dM.ApplySMInvertMatrix(fU,fV,fW,f1,fZ,f0);};});fL=U.init(fF,function(fP){return U.create(fG,U.get(fJ,fP));});fM=U.init(fF,function(fP){return U.create(fG,2*(1-U.get(fJ,fP)));});fN=U.init(fF,function(fP){return U.create(fG,U.get(fJ,fP));});fO=U.length(fE.plotlocs);return c4.solver(fB,fC,fD,fG,fF,fJ,fK,fL,fM,fN,function(fP){return U.init(fE.nx,function(fQ){return U.init(fO,function(fR){return fQ<fG?U.get(U.get(fP,U.get(fE.plotlocs,fR)),fQ):U.get(U.get(fP,U.get(fE.plotlocs,fR)),0);});});},fE);};c4.solver=function(fB,fC,fD,fE,fF,fG,fH,fI,fJ,fK,fL,fM){var fN,fO,fP,fQ,fR,fS,fT,fU,fV,fW;fN=fB;fO=U.init(fF,function(){return U.create(fE,0);});fP=U.init(fF,function(){return U.create(fE,0);});fQ=U.create(fF,0);fR=U.create(fE,0);fS=fM.dt;for(fT=0,fU=fF-1;fT<=fU;fT++){for(fV=0,fW=fE-1;fV<=fW;fV++)U.set(U.get(fO,fT),fV,U.get(U.get(fC,fV),fT));}return bc.delay(function(){return bc.append([c5.New(fN,fL(fO))],bc.delay(function(){return bc.append(bc.enumWhile(function(){return fN<fM.tmax;},bc.delay(function(){return bc.append(bc.collect(function(){fN=fN+fS;return bc.append(bc.collect(function(fX){return bc.append(bc.collect(function(fY){U.set(fQ,fY,U.get(U.get(fO,fY),fX));return[];},F.range(0,fF-1)),bc.delay(function(){var fY;fY=fD(fN,fQ);return bc.collect(function(fZ){U.set(U.get(fP,fZ),fX,U.get(fY,fZ)*fS);return[];},F.range(0,fF-1));}));},F.range(0,fE-1)),bc.delay(function(){return bc.collect(function(fX){return U.get(fG,fX)>0?bc.append(bc.collect(function(fY){var fZ,f0;fZ=U.get(U.get(fO,fX),(fY-1+fE)%fE);f0=U.get(U.get(fO,fX),(fY+1)%fE);U.set(fR,fY,U.get(U.get(fI,fX),fY)*fZ+U.get(U.get(fJ,fX),fY)*U.get(U.get(fO,fX),fY)+U.get(U.get(fK,fX),fY)*f0+2*U.get(U.get(fP,fX),fY));return[];},F.range(0,fE-1)),bc.delay(function(){U.set(fO,fX,(U.get(fH,fX))(fR));return[];})):(U.set(fO,fX,U.map2(function(fY,fZ){return fY+fZ;},U.get(fO,fX),U.get(fP,fX))),[]);},F.range(0,fF-1));}));},F.range(0,fM.thin-1)),bc.delay(function(){return[c5.New(fN,fL(fO))];}));})),bc.delay(function(){return[];}));}));});};c5.New=function(fB,fC){return{t:fB,u:fC};};c7.New=function(fB,fC,fD,fE,fF,fG,fH,fI,fJ,fK,fL){return{numspecies:fB,thin:fC,nx:fD,xmin:fE,xmax:fF,ymin:fG,ymax:fH,tmax:fI,dt:fJ,D:fK,plotlocs:fL};};c8.neumann_solve=function(fB,fC,fD,fE){var fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO;fF=fE.numspecies;fG=fE.nx;fH=fE.dt*0.5;fI=(fE.xmax-fE.xmin)/(fE.nx-1);fJ=U.map(function(fP){return fP*fH/(fI*fI);},fE.D);fK=U.init(fF,function(fP){return U.concat([[0],U.create(fG-1,U.get(fJ,fP))]);});fL=U.init(fF,function(fP){return U.concat([[1-U.get(fJ,fP)],U.create(fG-2,1-2*U.get(fJ,fP)),[1-U.get(fJ,fP)]]);});fM=U.init(fF,function(fP){return U.concat([U.create(fG-1,U.get(fJ,fP)),[0]]);});fN=U.init(fF,function(fP){var fQ,fR,fS,fT;fQ=U.get(fJ,fP);fR=U.create(fG,-fQ);fS=U.concat([[1+fQ],U.create(fG-2,1+2*fQ),[1+fQ]]);fT=U.create(fG,-fQ);return function(fU){return dM.TridiagonalAlgorithm(fR,fS,fT,fU);};});fO=U.length(fE.plotlocs);return c8.solver(fB,fC,fD,fG,fF,fJ,fN,fK,fL,fM,function(fP){return U.init(fG,function(fQ){return U.init(fG,function(fR){return U.init(fO,function(fS){return U.get(U.get(U.get(fP,U.get(fE.plotlocs,fS)),fQ),fR);});});});},fE);};c8.periodic_solve=function(fB,fC,fD,fE){var fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO;fF=fE.numspecies;fG=fE.nx;fH=fE.dt*0.5;fI=(fE.xmax-fE.xmin)/(fE.nx-1);fJ=U.map(function(fP){return fP*fH/(fI*fI);},fE.D);fK=U.init(fF,function(fP){return U.create(fG-1,U.get(fJ,fP));});fL=U.init(fF,function(fP){return U.create(fG-1,1-2*U.get(fJ,fP));});fM=U.init(fF,function(fP){return U.create(fG-1,U.get(fJ,fP));});fN=U.init(fF,function(fP){var fQ,fR,fS,fT,fU,fV,fW,fX,fY,fZ,f0;fQ=U.get(fJ,fP);fR=-fQ;fS=1+2*fQ;fT=-fQ;fU=U.create(fG-1,fR);fV=U.concat([[2*fS],U.create(fG-3,fS),[fS+fR*fT/fS]]);fW=U.create(fG-1,fT);fX=-fS;fY=U.concat([[fX],U.create(fG-3,0),[fT]]);fZ=U.concat([[1],U.create(fG-3,0),[fR/fX]]);f0=dM.TridiagonalAlgorithm(fU,fV,fW,fY);return function(f1){return dM.ApplySMInvertMatrix(fU,fV,fW,f1,fZ,f0);};});fO=U.length(fE.plotlocs);return c8.solver(fB,fC,fD,fG-1,fF,fJ,fN,fK,fL,fM,function(fP){return U.init(fG,function(fQ){var fR;fR=fQ<fG-1?fQ:0;return U.init(fG,function(fS){var fT;fT=fS<fG-1?fS:0;return U.init(fO,function(fU){return U.get(U.get(U.get(fP,U.get(fE.plotlocs,fU)),fR),fT);});});});},fE);};c8.solver=function(fB,fC,fD,fE,fF,fG,fH,fI,fJ,fK,fL,fM){var fN,fO,fP,fQ,fR,fS,fT,fU,fV,fW,fX,fY,fZ,f0;fQ=fM.dt*0.5;fN=fB;fR=U.init(fF,function(){return U.init(fE,function(){return U.create(fE,0);});});fS=U.create(fF,0);fT=U.create(fF,null);for(fU=0,fV=fF-1;fU<=fV;fU++){fW=U.init(fE,function(){return U.create(fE,0);});for(fX=0,fY=fE-1;fX<=fY;fX++){for(fZ=0,f0=fE-1;fZ<=f0;fZ++)U.set(U.get(fW,fX),fZ,U.get(U.get(U.get(fC,fX),fZ),fU));}U.set(fT,fU,fW);}fP=U.init(fF,function(){return U.create(fE,0);});return bc.delay(function(){return bc.append([c9.New(fN,fL(fT))],bc.delay(function(){return bc.enumWhile(function(){return fN<fM.tmax;},bc.delay(function(){return bc.append(bc.collect(function(){fN=fN+fM.dt;return bc.append(bc.collect(function(f1){return bc.append(bc.collect(function(f2){return bc.append(bc.collect(function(f3){U.set(fS,f3,U.get(U.get(U.get(fT,f3),f2),f1));return[];},F.range(0,fF-1)),bc.delay(function(){var f3;f3=fD(fN,fS);return bc.collect(function(f4){var f5,f6;return U.get(fG,f4)>0?(f5=U.get(U.get(U.get(fT,f4),f2),(f1-1+fE)%fE),f6=U.get(U.get(U.get(fT,f4),f2),(f1+1)%fE),U.set(U.get(fP,f4),f2,U.get(U.get(fI,f4),f1)*f5+U.get(U.get(fJ,f4),f1)*U.get(fS,f4)+U.get(U.get(fK,f4),f1)*f6+fQ*U.get(f3,f4)),[]):(U.set(U.get(U.get(fR,f4),f2),f1,U.get(fS,f4)+fQ*U.get(f3,f4)),[]);},F.range(0,fF-1));}));},F.range(0,fE-1)),bc.delay(function(){return bc.collect(function(f2){var f3;return U.get(fG,f2)>0?(f3=(U.get(fH,f2))(U.get(fP,f2)),bc.collect(function(f4){U.set(U.get(U.get(fR,f2),f4),f1,U.get(f3,f4));return[];},F.range(0,fE-1))):[];},F.range(0,fF-1));}));},F.range(0,fE-1)),bc.delay(function(){return bc.collect(function(f1){return bc.append(bc.collect(function(f2){return bc.append(bc.collect(function(f3){U.set(fS,f3,U.get(U.get(U.get(fR,f3),f1),f2));return[];},F.range(0,fF-1)),bc.delay(function(){var f3;f3=fD(fN,fS);return bc.collect(function(f4){var f5,f6;return U.get(fG,f4)>0?(f5=U.get(U.get(U.get(fR,f4),(f1-1+fE)%fE),f2),f6=U.get(U.get(U.get(fR,f4),(f1+1)%fE),f2),U.set(U.get(fP,f4),f2,U.get(U.get(fI,f4),f1)*f5+U.get(U.get(fJ,f4),f1)*U.get(fS,f4)+U.get(U.get(fK,f4),f1)*f6+fQ*U.get(f3,f4)),[]):(U.set(U.get(U.get(fT,f4),f1),f2,U.get(fS,f4)+fQ*U.get(f3,f4)),[]);},F.range(0,fF-1));}));},F.range(0,fE-1)),bc.delay(function(){return bc.collect(function(f2){return U.get(fG,f2)>0?(U.set(U.get(fT,f2),f1,(U.get(fH,f2))(U.get(fP,f2))),[]):[];},F.range(0,fF-1));}));},F.range(0,fE-1));}));},F.range(0,fM.thin-1)),bc.delay(function(){return[c9.New(fN,fL(fT))];}));}));}));});};c9.New=function(fB,fC){return{t:fB,u:fC};};c_.online_meanvar=function(fB,fC,fD,fE){var fF;fF=fB+(fD-fB)/fE;return[fF,fC+((fD-fB)*(fD-fF)-fC)/fE];};c_.correlation_pearson=function(fB){var fC,fD,fE,fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO;fD=fB.length;fE=U.get(fB,0).length;fF=U.unzip(U.map(function(fP){var fQ;fQ=U.average(fP);return[fQ,fv.sqrt(U.sum(U.map(function(fR){return(fR-fQ)*(fR-fQ);},fP)))];},fB));fG=fF[0];fH=fF[1];fC=U.init(fD,function(){return U.create(fD,0);});for(fI=0,fJ=fD-1;fI<=fJ;fI++){U.set(U.get(fC,fI),fI,1);for(fK=fI+1,fL=fD-1;fK<=fL;fK++){fM=U.fold2(function(fP,fQ,fR){return fP+fQ*fR;},0,U.get(fB,fI),U.get(fB,fK));U.set(U.get(fC,fI),fK,(fM-fE*U.get(fG,fI)*U.get(fG,fK))/U.get(fH,fI)/U.get(fH,fK));}for(fN=0,fO=fI-1;fN<=fO;fN++)U.set(U.get(fC,fI),fN,U.get(U.get(fC,fN),fI));}return fC;};c_.log_of_normal_density=function(fB,fC,fD){var fE,fF;fE=fv.sqrt(2*3.14159265358979);fF=(fB-fC)/fD;return -0.5*fF*fF-fv.log(fD*fE);};c$.New=function(fB){return{map:fB};};da.Get=function(fB){return fB instanceof a.Array?da.ArrayEnumerator(fB):bk.Equals(typeof fB,"string")?da.StringEnumerator(fB):fB.GetEnumerator();};da.ArrayEnumerator=function(fB){return new dc.New(0,null,function(fC){var fD;fD=fC.s;return fD<U.length(fB)&&(fC.c=U.get(fB,fD),fC.s=fD+1,true);},void 0);};da.StringEnumerator=function(fB){return new dc.New(0,null,function(fC){var fD;fD=fC.s;return fD<fB.length&&(fC.c=fB[fD],fC.s=fD+1,true);},void 0);};da.Get0=function(fB){return fB instanceof a.Array?da.ArrayEnumerator(fB):bk.Equals(typeof fB,"string")?da.StringEnumerator(fB):"GetEnumerator0"in fB?fB.GetEnumerator0():fB.GetEnumerator();};db.fold_right=function(fB,fC,fD){return A.foldBack(fB,fC,fD);};db.trd3=function(fB,fC,fD){return fD;};db.snd3=function(fB,fC,fD){return fC;};db.fst3=a.id;db.fold_left=function(fB,fC,fD){return bc.fold(fB,fC,fD);};db.string_of_list=function(fB,fC,fD){var fE,fF,fG,fH;fE="";fF=fD;while(true)if(fF.$==1){if(fF.$1.$==0)return fE+fB(fF.$0);else{fG=fF.$0;fH=fF.$1;fE=fE+fB(fG)+fC;fF=fH;}}else return fE;};db.binom=function(fB,fC){return F.toInt(bc.fold(function(fD,fE){return fv.trunc(fD*(fB-fE+1)/fE);},1,A.ofSeq(F.range(1,fC))));};db.rev_map=function(fB,fC){var fD,fE,fF,fG;fD=B.Empty;fE=fC;while(true)if(fE.$==1){fF=fE.$1;fG=fE.$0;fD=new B({$:1,$0:fB(fG),$1:fD});fE=fF;}else return fD;};db.option_map2=function(fB,fC){return db.option_map(function(fD){return{$:1,$0:fB(fD)};},null,fC);};db.fac=function(fB){return db.fold_left(function(fC,fD){return fC*fD;},1,A.ofSeq(F.range(2,fB)));};db.disjoint=function(fB,fC,fD){return db.forall(function(fE){return!A.exists(function(fF){return fB(fE,fF);},fD);},fC);};db.union=function(fB,fC,fD){var fE,fF,fG,fH;fE=A.rev(fC);fF=db.remove_duplicates(fB,fD);while(true)if(fE.$==1){fG=fE.$1;fH=fE.$0;fE=fG;fF=db.maybecons(fB,fH,fF);}else return fF;};db.option_map=function(fB,fC,fD){return fD!=null&&fD.$==1?fB(fD.$0):fC;};db.emit_record=function(fB,fC,fD){var fE;function fF(fG,fH){return fH(fD)===fH(fB)?null:{$:1,$0:(((fu.Curried3(function(fI,fJ,fK){return fI(_2.toSafe(fJ)+"="+_2.toSafe(fK));}))(a.id))(fG))(fH(fD))};}fE=dk.concat("; ",A.choose(function(fG){return fF(fG[0],fG[1]);},fC));return(function(fG){return function(fH){return fG("{"+_2.toSafe(fH)+"}");};}(a.id))(fE);};db.newline=function(){e5.$cctor();return e5.newline;};db.update_map=function(fB,fC){return K.Fold(function(fD,fE,fF){return fD.Add(fE,fF);},K.Fold(function(fD,fE,fF){return fD.Add(fE,fF);},new y.New(B.Empty),fB),fC);};db.forall=function(fB,fC){return A.forAll(fB,fC);};db.remove_duplicates=function(fB,fC){return A.rev(function(fD,fE){var fF,fG;while(true)if(fD.$==1){fF=fD.$1;fG=fD.$0;if(A.exists(function(fH){return function(fI){return fB(fH,fI);};}(fG),fE))fD=fF;else{fD=fF;fE=new B({$:1,$0:fG,$1:fE});}}else return fE;}(fC,B.Empty));};db.maybecons=function(fB,fC,fD){return A.exists(function(fE){return fB(fC,fE);},fD)?fD:new B({$:1,$0:fC,$1:fD});};db.default_leak_rate_l=function(){e5.$cctor();return e5.default_leak_rate_l;};db.default_toehold_unbind_rate=function(){e5.$cctor();return e5.default_toehold_unbind_rate;};db.tuple_to_string=function(fB){return fB.$==1?fB.$1.$==0?fB.$0:"("+dk.concat(",",fB)+")":"";};dc=da.T=fu.Class({MoveNext:function(){return this.n(this);},Current:function(){return this.c;},Dispose:function(){if(this.d)this.d(this);}},w,dc);dc.New=fu.Ctor(function(fB,fC,fD,fE){w.New.call(this);this.s=fB;this.c=fC;this.n=fD;this.d=fE;},dc);dd.alreadyAdded=function(){return F.FailWith("An item with the same key has already been added.");};dd.notPresent=function(){return F.FailWith("The given key was not present in the dictionary.");};df=de.SparseMatrix=fu.Class({times$2:function(fB){var fC,fD,fE,fF,fG,fH;fC=U.create(this.rows,0);for(fD=0,fE=this.rows-1;fD<=fE;fD++)if(bk.Equals(U.get(this.indices,fD).length==0,false)){fF=0;for(fG=0,fH=U.get(this.count,fD)-1;fG<=fH;fG++)fF=fF+U.get(U.get(this.items,fD),fG)*U.get(fB,U.get(U.get(this.indices,fD),fG));U.set(fC,fD,fF);}return fC;},timesRight:function(fB){var fC,fD,fE,fF,fG,fH,fI,fJ,fK;fC=U.create(this.cols,0);for(fD=0,fE=this.rows-1;fD<=fE;fD++){fF=U.get(this.indices,fD);fG=U.get(fB,fD);fH=U.get(this.items,fD);for(fI=0,fJ=U.length(fF)-1;fI<=fJ;fI++){fK=U.get(fF,fI);U.set(fC,fK,U.get(fC,fK)+fG*U.get(fH,fI));}}return fC;},set_Item:function(fB,fC){U.set(this.indices,fB,fC.get_Indices());U.set(this.items,fB,fC.get_Items());U.set(this.count,fB,fC.get_Length());},minus:function(fB){var fC,fD,fE,fF;fC=new df.New(this.rows,this.cols);for(fD=0,fE=this.rows-1;fD<=fE;fD++){fF=this.get_Item(fD).minus(fB.get_Item(fD));fC.set_Items$1(fD,fF.get_Items());fC.set_Indices$1(fD,fF.get_Indices());fC.set_CountElem(fD,fF.get_Count());}return fC;},times$1:function(fB){var fC,fD,fE,fF,fG;fC=new df.New(this.rows,this.cols);for(fD=0,fE=this.rows-1;fD<=fE;fD++)if(bk.Equals(U.get(this.indices,fD).length==0,false)){fC.set_Indices$1(fD,U.create(U.get(this.count,fD),0));fC.set_Items$1(fD,U.create(U.get(this.count,fD),0));for(fF=0,fG=U.get(this.count,fD)-1;fF<=fG;fF++){fC.set_Indices(fD,fF,U.get(U.get(this.indices,fD),fF));fC.set_Items(fD,fF,fB*U.get(U.get(this.items,fD),fF));}fC.set_CountElem(fD,U.get(this.count,fD));}return fC;},get_Item:function(fB){return new es.New$1(U.get(this.items,fB),U.get(this.indices,fB),this.cols);},set_Items$1:function(fB,fC){U.set(this.items,fB,fC);},set_Indices$1:function(fB,fC){U.set(this.indices,fB,fC);},set_CountElem:function(fB,fC){U.set(this.count,fB,fC);},set_Indices:function(fB,fC,fD){U.set(U.get(this.indices,fB),fC,fD);},set_Items:function(fB,fC,fD){U.set(U.get(this.items,fB),fC,fD);},get_RowDimension:function(){return this.rows;},get_Items:function(fB,fC){return U.get(U.get(this.items,fB),fC);},ScaleRow:function(fB,fC,fD,fE){var fF,fG;for(fF=0,fG=U.get(this.count,fB)-1;fF<=fG;fF++)if(U.get(U.get(this.indices,fB),fF)>=fC&&U.get(U.get(this.indices,fB),fF)<=fD)U.set(U.get(this.items,fB),fF,U.get(U.get(this.items,fB),fF)*fE);},SwitchRows:function(fB,fC){var fD,fE,fF;fD=U.get(this.items,fB);fE=U.get(this.indices,fB);fF=U.get(this.count,fB);U.set(this.items,fB,U.get(this.items,fC));U.set(this.indices,fB,U.get(this.indices,fC));U.set(this.count,fB,U.get(this.count,fC));U.set(this.items,fC,fD);U.set(this.indices,fC,fE);U.set(this.count,fC,fF);},get_Item$1:function(fB,fC){var fD,fE,fF;return fB<0||fC<0||fB>=this.rows||fC>=this.cols?F.FailWith("Element index is out of range"):bk.Equals(U.get(this.indices,fB),null)?0:(fD=(fE=U.tryFindIndex(function(fG){return fG===fC;},c2.array(U.get(this.indices,fB),{$:1,$0:0},{$:1,$0:U.get(this.count,fB)-1})),fE==null?U.forall(function(fG){return fG<fC;},c2.array(U.get(this.indices,fB),{$:1,$0:0},{$:1,$0:U.get(this.count,fB)-1}))?~U.get(this.count,fB):(fF=U.tryFindIndex(function(fG){return fG>fC;},c2.array(U.get(this.indices,fB),{$:1,$0:0},{$:1,$0:U.get(this.count,fB)-1})),fF==null?-1:~fF.$0):fE.$0),fD<0?0:U.get(U.get(this.items,fB),fD));},set_Item$1:function(fB,fC,fD){var fE,fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO,fP,fQ,fR,fS;if(fB<0||fC<0||fB>=this.rows||fC>=this.cols)F.FailWith("Element index is out of range");else if(U.get(this.indices,fB).length==0||U.get(this.indices,fB).length<1){U.set(this.indices,fB,U.create(1,0));U.set(this.items,fB,U.create(1,0));U.set(U.get(this.indices,fB),0,fC);U.set(U.get(this.items,fB),0,fD);U.set(this.count,fB,1);}else{fG=(fE=U.tryFindIndex(function(fT){return fT===fC;},c2.array(U.get(this.indices,fB),{$:1,$0:0},{$:1,$0:U.get(this.count,fB)-1})),fE==null?U.forall(function(fT){return fT<fC;},c2.array(U.get(this.indices,fB),{$:1,$0:0},{$:1,$0:U.get(this.count,fB)-1}))?~U.get(this.count,fB):(fF=U.tryFindIndex(function(fT){return fT>fC;},c2.array(U.get(this.indices,fB),{$:1,$0:0},{$:1,$0:U.get(this.count,fB)-1})),fF==null?-1:~fF.$0):fE.$0);if(fG>=0)U.set(U.get(this.items,fB),fG,fD);else{fH=~fG;if(U.get(this.count,fB)>=U.length(U.get(this.items,fB))){fI=fv.min(16,this.cols-U.length(this.items));fJ=U.create(this.indices.length+fI,0);fK=U.create(this.items.length+fI,0);for(fL=0,fM=fH-1;fL<=fM;fL++)U.set(fJ,fL,U.get(U.get(this.indices,fB),fL));for(fN=0,fO=fH-1;fN<=fO;fN++)U.set(fK,fN,U.get(U.get(this.items,fB),fN));for(fP=0,fQ=U.get(this.count,fB)-fH-1;fP<=fQ;fP++){U.set(fJ,U.get(this.count,fB)-fP,U.get(U.get(this.indices,fB),U.get(this.count,fB)-fP-1));U.set(fK,U.get(this.count,fB)-fP,U.get(U.get(this.items,fB),U.get(this.count,fB)-fP-1));}U.set(this.items,fB,fK);U.set(this.indices,fB,fJ);}else{for(fR=0,fS=U.get(this.count,fB)-fH-1;fR<=fS;fR++){U.set(U.get(this.indices,fB),U.get(this.count,fB)-fR,U.get(U.get(this.indices,fB),U.get(this.count,fB)-fR-1));U.set(U.get(this.items,fB),U.get(this.count,fB)-fR,U.get(U.get(this.items,fB),U.get(this.count,fB)-fR-1));}}U.set(this.count,fB,U.get(this.count,fB)+1);U.set(U.get(this.indices,fB),fH,fC);U.set(U.get(this.items,fB),fH,fD);}}}},w,df);df.New$1=fu.Ctor(function(fB,fC,fD,fE,fF){w.New.call(this);this.rows=fB;this.cols=fC;this.items=fD;this.indices=fE;this.count=fF;},df);df.New=fu.Ctor(function(fB,fC){df.New$1.call(this,fB,fC,U.init(fB,function(){return[];}),U.init(fB,function(){return[];}),U.create(fB,0));},df);dg.Filter=function(fB,fC){var fD;return new dh.New$1((fD=U.ofSeq(bc.filter(fB,fC)),cx.Build(fD,0,fD.length-1)));};dh=x.FSharpSet=fu.Class({Add:function(fB){return new dh.New$1(cx.Add(fB,this.tree));},Equals:function(fB){return this.get_Count()===fB.get_Count()&&bc.forall2(bk.Equals,this,fB);},get_IsEmpty:function(){return this.tree==null;},GetEnumerator$1:function(){return da.Get(cx.Enumerate(false,this.tree));},get_Count:function(){var fB;fB=this.tree;return fB==null?0:fB.Count;},Contains:function(fB){return cx.Contains(fB,this.tree);},GetHashCode:function(){return -1741749453+bk.Hash(U.ofSeq(this));},GetEnumerator:function(){return this.GetEnumerator$1();},GetEnumerator0:function(){return this.GetEnumerator$1();},CompareTo0:function(fB){return bc.compareWith(bk.Compare,this,fB);}},w,dh);dh.op_Subtraction=function(fB,fC){return dg.Filter(function(fD){return!fC.Contains(fD);},fB);};dh.New$1=fu.Ctor(function(fB){w.New.call(this);this.tree=fB;},dh);di.find=function(fB,fC){var fD;fD=K.TryFind(fC,fB);return fD!=null&&fD.$==1?fD.$0:(function(fE){return function(fF){return fE("The environment does not contain: "+_2.toSafe(fF));};}(F.FailWith))(fC);};di.to_string=function(fB){return"["+db.string_of_list(function(fC){var fD;return fC[0]+" = "+(fD=fC[1],a.String(fD));},"; ",A.ofSeq(K.ToSeq(fB)))+"]";};di.empty=function(){fd.$cctor();return fd.empty;};dj.GetFieldValues=function(fB){var fC,fD;fC=[];for(var fE in fB)fC.push(fB[fE]);return fC;};dj.GetFields=function(fB){var fC,fD;fC=[];for(var fE in fB)fC.push([fE,fB[fE]]);return fC;};dk.concat=function(fB,fC){return U.ofSeq(fC).join(fB);};dk.PadLeft=function(fB,fC){return dk.PadLeftWith(fB,fC," ");};dk.SplitStrings=function(fB,fC,fD){return dk.Split(fB,new a.RegExp(dk.concat("|",U.map(dk.RegexEscape,fC))),fD);};dk.SplitChars=function(fB,fC,fD){return dk.Split(fB,new a.RegExp("["+dk.RegexEscape(fC.join(""))+"]"),fD);};dk.map=function(fB,fC){return dk.collect(fB,dk.protect(fC));};dk.PadLeftWith=function(fB,fC,fD){return fC>fB.length?a.Array(fC-fB.length+1).join(fD)+fB:fB;};dk.ToCharArray=function(fB){return U.init(fB.length,function(fC){return fB[fC];});};dk.Substring=function(fB,fC,fD){return fB.substr(fC,fD);};dk.Split=function(fB,fC,fD){return fD===1?U.filter(function(fE){return fE!=="";},dk.SplitWith(fB,fC)):dk.SplitWith(fB,fC);};dk.RegexEscape=function(fB){return fB.replace(new a.RegExp("[-\\\\/\\\\\\\\^$*+?.()|[\\\\]{}]","g"),"\\\\$&");};dk.length=function(fB){return dk.protect(fB).length;};dk.StartsWith=function(fB,fC){return fB.substring(0,fC.length)==fC;};dk.Remove=function(fB,fC,fD){return fB.substring(0,fC)+fB.substring(fC+fD);};dk.Join=function(fB,fC){return fC.join(fB);};dk.collect=function(fB,fC){return U.init(fC.length,function(fD){return fB(fC[fD]);}).join("");};dk.protect=function(fB){return fB===null?"":fB;};dk.Replace=function(fB,fC,fD){function fE(fF){var fG,fH,fI;fG=fF.indexOf(fC);return fG!==-1?(fH=dk.ReplaceOnce(fF,fC,fD),(fI=fG+fD.length,dk.Substring(fH,0,fG+fD.length)+fE(fH.substring(fI)))):fF;}return fE(fB);};dk.SplitWith=function(fB,fC){return fB.split(fC);};dk.iter=function(fB,fC){bc.iter(fB,dk.protect(fC));};dk.ReplaceOnce=function(fB,fC,fD){return fB.replace(fC,fD);};dk.IsNullOrEmpty=function(fB){return fB==null||fB=="";};dl.init=function(fB){return new dS.New$1(fB);};dl.append=function(fB,fC){fB.Append(fC);};dl.value=function(fB){return a.String(fB);};dl.empty=function(){return new dS.New();};dm=bp.NamesMap=fu.Class({Item:function(fB){var fC,fD;fC=this;fD=U.length(this.names);return function(fE){while(true)if(U.get(fC.names,fE)===fB)return fE;else if(fE===fD-1)return -1;else fE=fE+1;}(0);},get_Keys:function(){return this.names;}},w,dm);dm.New=fu.Ctor(function(fB){w.New.call(this);this.names=fB;},dm);_do=dn.NormalGenerator=fu.Class({get_Sigma:function(){return this.stdev;},get_Mean:function(){return this.mean;},nextDouble:function(fB){var fC,fD,fE,fF,fG;fC=this.state.rnorm_phase?[this.state.rnorm_2*this.state.rnorm_f,(fD=this.state,dY.New(false,fD.rnorm_2,fD.rnorm_f)),fB]:(fE=function(fH,fI){var fJ,fK,fL,fM,fN,fO;while(true){fJ=fI.Microsoft_Research_Filzbach_Lib_IRng$NextDouble();fK=fJ[1].Microsoft_Research_Filzbach_Lib_IRng$NextDouble();fL=fK[1];fM=fJ[0]*2-1;fN=fK[0]*2-1;fO=fM*fM+fN*fN;if(fO<1)return[fO,fM,dY.New(fH.rnorm_phase,fN,fH.rnorm_f),fL];else{fH=dY.New(fH.rnorm_phase,fN,fH.rnorm_f);fI=fL;}}}(this.state,fB),(fF=fE[0],(fG=fv.sqrt(-2*fv.log(fF)/fF),[fE[1]*fG,dY.New(true,fE[2].rnorm_2,fG),fE[3]])));return[fC[0]*this.stdev+this.mean,new _do.New$1(fC[1],this.mean,this.stdev),fC[2]];}},w,_do);_do.New=fu.Ctor(function(fB,fC){_do.New$1.call(this,dY.New(false,0,0),fB,fC);},_do);_do.New$1=fu.Ctor(function(fB,fC,fD){w.New.call(this);this.state=fB;this.mean=fC;this.stdev=fD;},_do);bu.run_mcmc_seq=function(fB,fC){var fD,fE,fF,fG,fH,fI,fJ,fK,fL,fM,fN;fD=-1.79769313486232E+308;fE=B.Empty;fF=null;fG=fB.$==1?(fH=fB.$0,[d1.run_seq(fH.likefn,fH.parameters,fH.dependencies,fH.options),fH.parameters,fH.options,fH.numData,function(fO){return(fH.simfn(fO))(d2.All);}]):(fI=fB.$0,[bw.run_seq(fI.likefn,fI.parameters,fI.options),fI.parameters,fI.options,fI.numData,fI.simfn]);fJ=fG[0];fK=fG[4];fL=fG[1];fM=fG[2];fN=fG[3];return bc.delay(function(){var fO;fO=0;return bc.append(bc.collect(function(fP){var fQ,fR,fS,fT,fU,fV;fS=d3.stringOfSummary(fP,fM,fN);fF={$:1,$0:fP};fT=fP.$==1?fP.$0.mle:fP.$0.mle;try{fR=(fU=fT.logLikelihood>fD?(fK(false))(fT.values):fE,fD=fT.logLikelihood,fE=fU,fU);}catch(fW){if(fW instanceof cX)fV=fE;else throw fW;fR=fV;}fO=fO+1;return[bv.New(fO,fP,fR,fS)];},fJ),bc.delay(function(){var fP;return fF!=null&&fF.$==1&&(fF.$0.$==1&&(fP=fF.$0.$0,true))?(fC(bu.convert_sampling(fK(true),fE,fL,fM,fN,fP)),[]):(F.FailWith("inference did not return a sampling"),[]);}));});};bu.convert_sampling=function(fB,fC,fD,fE,fF,fG){var fH,fI,fJ,fK;fH=bu.getSummary(fE,fF,fG);fI=K.OfArray(U.ofSeq(A.choose(function(fL){return fL.isFixed()?{$:1,$0:[fL.name,fL.initValue.$0]}:null;},fD)));fJ=bu.analyse_chain(fG);fK=A.choose(function(fL){try{return{$:1,$0:fB(fL.values)};}catch(fM){return null;}},A.rev(fG.chain));return bA.New(fJ[2],fJ[0],fJ[3],fI,fJ[1],fC,fK.$===0?B.Empty:A.mapi(function(fL,fM){return bt.New(fM.instance,Z.qsummary(A.map(function(fN){return fN.get_Item(fL).table;},fK)));},A.head(fK)),fH);};bu.create_with_dependencies=function(fB,fC,fD,fE,fF,fG){var fH,fI,fJ,fK,fL,fM;function fN(fQ){return bc.findIndex(function(fR){return bk.Equals(fQ,fR);},fH);}function fO(fQ,fR,fS){return fC(fQ,bu.env_of_aa(fS,new y.New([])),fR);}function fP(fQ,fR){var fS,fT;fS=bu.penalties(fH.get_Length(),fB,fR);try{return fQ.$==0?A.mapi2(function(fU,fV,fW){return Z.likelihood(A.map(function(fX){return fS.get_Item(fX);},fI.get_Item(fU)),fV,fW);},A.map(bt.to_table,fO(true,fQ,fR)),fE):A.map2(function(fU,fV){return Z.likelihood(A.map(function(fW){return fS.get_Item(fW);},fI.get_Item(fV)),fU,fE.get_Item(fV));},A.map(bt.to_table,fO(true,fQ,fR)),fQ.$0);}catch(fU){if(fU instanceof cX)fT=(fM=fM+1,A.init(fE.get_Length(),function(){return -1.79769313486232E+308;}));else if(fU instanceof cW)fT=F.FailWith(fU.message);else throw fU;return fT;}}fH=A.distinct(A.concat(fD));fI=A.map(function(fQ){return A.map(fN,fQ);},fD);fJ=bu.generate_sigmas(fB.noise_parameter,fH);fK=(fL=fB.noise_parameter,fL=="Random"?A.ofArray([d2.All]):fL=="Multiple"?A.replicate(fJ.get_Length(),d2.All):B.Empty);fM=0;return{$:1,$0:dp.New(function(fQ){return function(fR){return fP(fQ,fR);};},fu.Curried3(fO),A.append(fJ,bu.fb_parameters(fF)),A.append(fK,fG),bu.options(fB),bu.num_datapoints(fE))};};bu.create=function(fB,fC,fD,fE,fF){var fG,fH,fI,fJ;function fK(fM){return bc.findIndex(function(fN){return bk.Equals(fM,fN);},fG);}function fL(fM,fN){return fC(fM,bu.env_of_aa(fN,new y.New([])));}fG=A.distinct(A.concat(fD));fH=A.map(function(fM){return A.map(fK,fM);},fD);fI=bu.generate_sigmas(fB.noise_parameter,fG);fJ=0;return{$:0,$0:dq.New(function(fM){var fN,fO;fN=bu.penalties(fG.get_Length(),fB,fM);try{return bc.sum(A.mapi2(function(fP,fQ,fR){return Z.likelihood(A.map(function(fS){return fN.get_Item(fS);},fH.get_Item(fP)),fQ,fR);},A.map(bt.to_table,fL(true,fM)),fE));}catch(fP){if(fP instanceof cX)fO=(fJ=fJ+1,-1.79769313486232E+308);else if(fP instanceof cW)fO=F.FailWith(fP.message);else throw fP;return fO;}},function(fM){return function(fN){return fL(fM,fN);};},A.append(fI,bu.fb_parameters(fF)),bu.options(fB),bu.num_datapoints(fE))};};bu.analyse_chain=function(fB){var fC,fD,fE;fC=A.map(dr.fromFilzbach,A.ofArray(d3.getSummary(fB)));fD=A.map(bu.evToMap,A.rev(fB.chain));fE=A.map(bu.evToMap,A.rev(fB.burnin));return[fD,bu.evToMap(fB.mle),fC,fE];};bu.getSummary=function(fB,fC,fD){var fE;fE=d3.informationCriteria(fD,fC);return ds.New(fB.seed,fB.burninLen,fB.sampleLen,fB.thinning,fD.mle.logLikelihood,fE.AIC,fE.BIC,fE.DIC,fC);};bu.generate_sigmas=function(fB,fC){var fD;return fB=="Random"?A.ofArray([bu.variable_sigma("sigma")]):fB=="Multiple"?A.init(fC.get_Length(),function(fE){return bu.variable_sigma((function(fF){return function(fG){return fF("sigma_"+a.String(fG));};}(a.id))(fE));}):(fD=fB.$0,A.ofArray([bC.New("sigma",br.New(ck.Fixed,fD,fD),{$:1,$0:fD},null,false)]));};bu.env_of_aa=function(fB,fC){return U.fold(function(fD,fE){return fD.Add(fE,fB.Item(fE));},fC,fB.get_Names());};bu.fb_parameters=function(fB){return A.map(bX.to_filzbach,fB);};bu.options=function(fB){return d4.New(fB.burnin,fB.samples,fB.thin,fB.seed,fB.print_console,fB.print_summary);};bu.num_datapoints=function(fB){return bc.sumBy(function(fC){return bc.sumBy(function(fD){return fD.values.get_Length();},fC.columns);},fB);};bu.penalties=function(fB,fC,fD){var fE,fF;return fC.noise_parameter=="Multiple"?A.init(fB,function(fG){var fH,fI;fH=fC.noise_model;fI=fD.Item((function(fJ){return function(fK){return fJ("sigma_"+a.String(fK));};}(a.id))(fG));return fu.Curried(bu.penalty,2,[fH,fI]);}):A.replicate(fB,(fE=fC.noise_model,(fF=fD.Item("sigma"),fu.Curried(bu.penalty,2,[fE,fF]))));};bu.evToMap=function(fB){return K.FoldBack(function(fC,fD,fE){return fE.Add(fC,fD);},K.OfArray([["Iteration",fB.iteration],["logLikelihood",fB.logLikelihood],["logPrior",fB.logPrior]]),fB.values.ToMap());};bu.variable_sigma=function(fB){return bC.New(fB,br.New(ck.Log,1E-06,1000000),null,null,true);};bu.penalty=function(fB,fC,fD,fE){if(a.isNaN(fE))return 0;else if(fB=="Proportional"){if(fD<=0){(function(fF){return fF("Cannot evaluate a proportional-error noise model for non-positive simulation values.");}(function(fF){fx.log(fF);}));throw cV.negative_simulation();}else return c_.log_of_normal_density(fE,fD,fv.sqrt(fD)*fC);}else return c_.log_of_normal_density(fE,fD,fC);};dp.New=function(fB,fC,fD,fE,fF,fG){return{likefn:fB,simfn:fC,parameters:fD,dependencies:fE,options:fF,numData:fG};};dq.New=function(fB,fC,fD,fE,fF){return{likefn:fB,simfn:fC,parameters:fD,options:fE,numData:fF};};dr=d.ParameterSummary=fu.Class({toNormalDist:function(){return new bU({$:1,$0:bS.New(this.mean,fv.sqrt(this.variance))});},toLogNormalDist:function(){var fB;fB=1+this.variance/this.mean/this.mean;return new bU({$:2,$0:bR.New(fv.log(this.mean/fv.sqrt(fB)),fv.log(fB))});},toTruncatedNormalDist:function(){return new bU({$:3,$0:bQ.New(this.mean,fv.sqrt(this.variance),this.lb,this.ub)});}},null,dr);dr.get_defaults=function(){return dr.New("",0,0,0,0,0,0,0,0,0,0,"Real");};dr.fromFilzbach=function(fB){return dr.New(fB.name,fB.mle,fB.summary.mean,fB.summary.variance,fB.qsummary.median,fB.range.lb,fB.range.ub,fB.qsummary.lb68,fB.qsummary.ub68,fB.qsummary.lb95,fB.qsummary.ub95,fB.range.pType.$==1?"Log":"Real");};dr.New=function(fB,fC,fD,fE,fF,fG,fH,fI,fJ,fK,fL,fM){return new dr({name:fB,mle:fC,mean:fD,variance:fE,median:fF,lb:fG,ub:fH,l68:fI,u68:fJ,l95:fK,u95:fL,ptype:fM});};ds=bu.McmcSummary=fu.Class({},null,ds);ds.New=function(fB,fC,fD,fE,fF,fG,fH,fI,fJ){return new ds({seed:fB,burnin:fC,samples:fD,thin:fE,mle:fF,aic:fG,bic:fH,dic:fI,numData:fJ});};dt.New=function(fB,fC,fD,fE,fF,fG,fH){return{model:fB,comparisons:fC,correlations:fD,keys:fE,parameters:fF,marginals:fG,multiple_paras:fH};};du.New=function(fB,fC,fD,fE,fF){return{sim:fB,dat:fC,name:fD,xlabel:fE,ylabel:fF};};dv.New=function(fB,fC,fD,fE,fF,fG,fH){return{model:fB,comparisons:fC,posterior:fD,correlation:fE,traces:fF,psummary:fG,variations:fH};};dx.ofChart=function(fB){return d5.toString(d6.toHtmlStructure(fB));};dx.ofSubplots=function(fB){return d5.toString(d7.subplotsToHtmlStructure(fB));};dy=bu.Summary=fu.Class({},null,dy);dy.New=function(fB,fC){return new dy({mcmc:fB,parameters:fC});};bc.insufficient=function(){return F.FailWith("The input sequence has an insufficient number of elements.");};U.groupBy=function(fB,fC){var fD,fE,fF,fG,fH,fI;fD=new bd.New$5();fE=[];for(fF=0,fG=U.length(fC)-1;fF<=fG;fF++){fH=fC[fF];fI=fB(fH);fD.ContainsKey(fI)?fD.get_Item(fI).push(fH):(fE.push(fI),fD.Add(fI,[fH]));}U.mapInPlace(function(fJ){return[fJ,fD.get_Item(fJ)];},fE);return fE;};U.mapInPlace=function(fB,fC){var fD,fE;for(fD=0,fE=fC.length-1;fD<=fE;fD++)fC[fD]=fB(fC[fD]);};U.mapiInPlace=function(fB,fC){var fD,fE;for(fD=0,fE=fC.length-1;fD<=fE;fD++)fC[fD]=fB(fD,fC[fD]);return fC;};A.skip=function(fB,fC){var fD,fE,fF;fD=fC;for(fE=1,fF=fB;fE<=fF;fE++)if(fD.$==0)F.FailWith("Input list too short.");else fD=fD.$1;return fD;};bc.nonNegative=function(){return F.FailWith("The input must be non-negative.");};U.contains=function(fB,fC){var fD,fE,fF,fG;fD=true;fE=0;fG=U.length(fC);while(fD&&fE<fG)if(bk.Equals(fC[fE],fB))fD=false;else fE=fE+1;return!fD;};bc.tryHead=function(fB){var fC;fC=da.Get(fB);try{return fC.MoveNext()?{$:1,$0:fC.Current()}:null;}finally{if(typeof fC=="object"&&"Dispose"in fC)fC.Dispose();}};dz.op_BarGreaterGreater=function(fB,fC,fD,fE){return(D.op_BarGreaterGreater(fB,fC))([fD,fE]);};dz.op_GreaterGreaterEquals=function(fB,fC,fD,fE){return(D.op_GreaterGreaterEquals(fB,fC))([fD,fE]);};dz.op_DotGreaterGreater=function(fB,fC,fD,fE){return(D.op_DotGreaterGreater(fB,fC))([fD,fE]);};dz.op_GreaterGreaterDot=function(fB,fC,fD,fE){return(D.op_GreaterGreaterDot(fB,fC))([fD,fE]);};dz.op_LessBarGreater=function(fB,fC,fD,fE){return(D.op_LessBarGreater(fB,fC))([fD,fE]);};dz.op_DotGreaterGreaterDot=function(fB,fC,fD,fE){return(D.op_DotGreaterGreaterDot(fB,fC))([fD,fE]);};dz.op_PlusGreaterGreaterPlus=function(fB,fC,fD,fE){return(D.op_PlusGreaterGreaterPlus(fB,fC))([fD,fE]);};dz.op_PlusGreaterGreater=function(fB,fC,fD,fE){return(D.op_PlusGreaterGreater(fB,fC))([fD,fE]);};dz.op_GreaterGreaterPercent=function(fB,fC,fD,fE){return(D.op_GreaterGreaterPercent(fB,fC))([fD,fE]);};dA.$cctor=function(){var fB;dA.$cctor=a.ignore;function fC(fD){return fD.$==0?fD.$0.$==0?{$:0,$0:{$:2,$0:(be.get_from_string())(fD.$0.$0)}}:fD:fD;}dA.parse=R.parse(co.parse(be.get_parse()));dA.parse_plot=(fB=R.parse(co.parse(be.get_parse())),function(fD){return dz.op_BarGreaterGreater(fB,fC,fD[0],fD[1]);});};dB=S.anchor=fu.Class({toString:function(){return((((fu.Curried(function(fB,fC,fD,fE){return fB(_2.toSafe(fC)+":{"+fD.toFixed(6)+","+fE.toFixed(6)+"}");},4))(a.id))(this.anchor_id))(this.anchor_point.x))(this.anchor_point.y);}},null,dB);dB.New=function(fB,fC){return new dB({anchor_id:fB,anchor_point:fC});};dC.New=function(fB,fC,fD,fE,fF,fG){return{init:fB,current:fC,advance:fD,refine:fE,get_time:fF,get_x:fG};};dD.init=function(fB,fC,fD,fE){var fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO,fP;fH=fC.length;fI=(fD(fB))(fC);fJ=fE.InitialStepSize===0?(fF=cL.map(function(fQ){return 1/fE.RelativeTolerance*(fE.AbsoluteTolerance+fE.RelativeTolerance*fv.abs(fQ));},fC),(fG=cL.sum(cL.map2(function(fQ){return function(fR){return fQ*fQ/fR/fR;};},fI,fF)),fv.min(fv.sqrt(fE.RelativeTolerance/(1/(fF[0]*fF[0])+1/fH*fG)),fE.MaxStep))):fv.min(fE.InitialStepSize,fE.MaxStep);fK=5;fL=cO.zeros(fH,fK+1);for(fM=0,fN=fH-1;fM<=fN;fM++){fO=fC[fM];(U.get(fL.MatrixData,fM))[0]=fO;fP=fJ*fI[fM];(U.get(fL.MatrixData,fM))[1]=fP;}return dE.New(fB,fC,fD,fJ,fL,2,0,0,1,fK,0,new a.Float64Array(fH),false,fE);};dD.advance=function(fB){return dD.PredictorCorrector(dE.New(fB.t,fB.x,fB.f,fB.dt,fB.z,fB.q,fB.Dq,fB.delta,fB.r,fB.qmax,fB.nsuccess,new a.Float64Array(fB.x.length),false,fB.opts));};dD.defaults=function(){return dF.New(0,1E-06,0.001,1.79769313486232E+308,0,1.1,0.9,5,eo.Absent);};dD.PredictorCorrector=function(fB){var fC,fD,fE,fF,fG,fH,fI,fJ,fK,fL;fC=cO.copy(fB.z);fD=cO.copyCol(fC,0).length;fE=dD.NordsieckMatrix_init(fB.z);fF=dE.New(fB.t,cO.copyCol(fE,0),fB.f,fB.dt,fE,fB.q,fB.Dq,fB.delta,fB.r,fB.qmax,fB.nsuccess,new a.Float64Array(fD),false,fB.opts);fG=fB.opts.MinStep;fH=fB.opts.MaxScale;fI=fB.opts.MinScale;fJ=dD.Corrector(fF);return fJ.isIterationFailed?(fK=fJ.dt/2,fK<1E-12?F.FailWith("Cannot generate numerical solution"):dD.PredictorCorrector(dE.New(fJ.t,fJ.x,fJ.f,fK,dD.NordsieckMatrix_rescale(fC,0.5),fJ.q,fJ.Dq,fJ.delta,fJ.r,fJ.qmax,0,fJ.e,false,fJ.opts))):(fL=fv.min(1.1,fv.max(0.2,fJ.r)),fJ.delta>=1?(fJ.opts.MaxStep<1.79769313486232E+308?fL=fv.min(fL,fJ.opts.MaxStep/fJ.dt):void 0,fG>0?fL=fv.max(fL,fG/fJ.dt):void 0,fL=fv.min(fL,fH),fL=fv.max(fL,fI),dD.PredictorCorrector(dE.New(fJ.t,fJ.x,fJ.f,fJ.dt*fL,dD.NordsieckMatrix_rescale(fJ.z,fL),fJ.q,fJ.Dq,fJ.delta,fJ.r,fJ.qmax,fJ.nsuccess,fJ.e,false,fJ.opts))):(fJ.opts.MaxStep<1.79769313486232E+308?fL=fv.min(fL,fJ.opts.MaxStep/fJ.dt):void 0,fG>0?fL=fv.max(fL,fG/fJ.dt):void 0,fL=fv.min(fL,fH),fL=fv.max(fL,fI),dE.New(fJ.t+fJ.dt,fJ.x,fJ.f,fJ.dt*fL,dD.NordsieckMatrix_rescale(fJ.z,fL),fJ.q,fJ.Dq,fJ.delta,fJ.r,fJ.qmax,fJ.nsuccess,fJ.e,fJ.isIterationFailed,fJ.opts)));};dD.NordsieckMatrix_init=function(fB){var fC,fD,fE,fF,fG,fH,fI,fJ,fK,fL,fM;fC=cO.numCols(fB);fD=cO.numRows(fB);fE=cO.copy(fB);for(fF=0,fG=fC-2;fF<=fG;fF++){for(fH=fF+1,fI=fC-1;fH<=fI;fH++){fJ=fC+fF-fH;for(fK=0,fL=fD-1;fK<=fL;fK++){fM=(U.get(fE.MatrixData,fK))[fJ]+(U.get(fE.MatrixData,fK))[fJ-1];(U.get(fE.MatrixData,fK))[fJ-1]=fM;}}}return fE;};dD.Corrector=function(fB){var fC,fD,fE,fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO,fP,fQ,fR,fS,fV,fW,fX,fY,fZ,f0,f1,f2,f3,f4,f5,f6,f7,f8,f9,f_,f$,ga,gb,gc,gd,ge,gf,gg,gh,gi,gj,gk,gl,gm,gn;function fT(go){return cO.subtract(cO.identity(fY,fY),cO.matrMultScal(go,f3*fX[f1-1]));}function fU(go){var gp,gq,gr,gs,gt,gu,gv,gw,gx,gy,gz,gA,gB,gC,gD,gE,gF,gG,gH,gI,gJ,gK,gL,gM,gN,gO,gP,gQ;gu=new a.Float64Array(fY);gv=(fZ(f4+f3))(go.x);for(gw=0,gx=fY-1;gw<=gx;gw++)gu[gw]=f3*gv[gw]-(f5.get_Item(gw))[1]-go.e[gw];gy=f7.$==1?ff.SolveCore(f7.$0,gu):f7.$==2?ff.SparseSolveCore(f7.$0,gu):F.FailWith("Failed to evaluate predictor matrix P");gz=new a.Float64Array(fY);for(gA=0,gB=fY-1;gA<=gB;gA++)gz[gA]=go.e[gA]+gy[gA];gC=new a.Float64Array(fY);for(gD=0,gE=fY-1;gD<=gE;gD++)gC[gD]=f0[gD]+fX[f1-1]*gz[gD];gF=cO.vectorProduct(gz,U.get(fW,f1-1));gG=cO.zeros(fY,f2+1);for(gH=0,gI=fY-1;gH<=gI;gH++){for(gJ=0,gK=f2;gJ<=gK;gJ++)if(gH<cO.numRows(gF)&&gJ<U.get(fW,f1-1).length){gL=(U.get(gF.MatrixData,gH))[gJ];(U.get(gG.MatrixData,gH))[gJ]=gL;}else(U.get(gG.MatrixData,gH))[gJ]=0;}gM=cO.add(f5,gG);gN=dD.ToleranceNorm(gz,f8,f9,go.x);gO=new a.Float64Array(fY);for(gP=0,gQ=fY-1;gP<=gQ;gP++)gO[gP]=(gz[gP]-fB.e[gP])*(1/(f1+2)*(U.get(fW,f1-1))[f1-1]);gq=dD.ToleranceNorm(gO,f8,f9,gC);gr=dD.ToleranceNorm(cO.copyCol(gM,f1-1),f8,f9,gC);gs=gN/(f6/(2*(f1+2)));gt=fe.New(gz,gN,gq,gr,gs,gC,gM,go.count+1);return gs>1&&gt.count<fV?fU(gt):gt;}fV=fB.opts.NumberOfIterations;fW=U.map(cL.ofArray,[[1,1],[2/3,1,1/3],[6/11,1,6/11,1/11],[24/50,1,35/50,10/50,1/50],[120/274,1,225/274,85/274,15/274,1/274],[720/1764,1,1624/1764,735/1764,175/1764,1/1764]]);fX=cL.ofArray([1,2/3,6/11,24/50,120/274,720/1764]);fY=fB.x.length;fZ=fB.f;f0=fB.x;f1=fB.q;f2=fB.qmax;f3=fB.dt;f4=fB.t;f5=cO.copy(fB.z);f6=1/(1/(f1+1)*dD.Factorial(f1)*(U.get(fW,f1-1))[f1]);fC=0;fD=0;fE=0;f7=(fG=fB.opts.Jacobian,fG.$==1?{$:1,$0:fT(fG.$0)}:fG.$==2?{$:2,$0:de.Identity(fY,fY).minus(fG.$0.times$1(f3*fX[f1-1]))}:{$:1,$0:fT(dD.NordsieckMatrix_Jacobian(f4+f3,f0,function(go,gp){return(fZ(go))(gp);}))});f8=fB.opts.AbsoluteTolerance;f9=fB.opts.RelativeTolerance;f_=fU(fe.New(fB.e,0,0,0,0,f0,f5,0));fI=f_.count<fV?fB.nsuccess+1:0;fJ=f_.delta;fK=false;fL=0;fM=f_.z;fN=f_.e;fO=f_.x;fP=f_.Dq;fQ=fB.q;fR=1;f$=fv.abs(f_.Dq);ga=fv.abs(f_.DqUp);gb=fv.abs(f_.DqDown);if(f_.count<fV){fK=false;fM=f_.z;for(gc=0,gd=fY-1;gc<=gd;gc++)fO[gc]=(f_.z.get_Item(gc))[0];fN=f_.e;}else{fK=true;fM=fB.z;for(ge=0,gf=fY-1;ge<=gf;ge++)fO[ge]=(fB.z.get_Item(ge))[0];fN=fB.e;}fD=0;if(fB.q<fB.qmax)fD=1/1.4/(fv.pow(ga,1/(f1+2))+1E-06);fC=1/1.2/(fv.pow(f$,1/(f1+1))+1E-06);fE=0;if(fB.q>1)fE=1/1.3/(fv.pow(gb,1/f1)+1E-06);fL=fI>=fB.q?0:fI;if(fC>=fD){if(fC<=fE&&fI>=fB.q&&fB.q>1){fQ=fB.q-1;fP=gb;for(gg=0,gh=fY-1;gg<=gh;gg++){for(gi=fQ+1,gj=f2;gi<=gj;gi++)(fM.get_Item(gg))[gi]=0;}fI=0;fR=fE;}else{fQ=fB.q;fP=f$;fR=fC;}}else if(fD>=fE){if(fD>=fC&&fI>=fB.q&&fB.q<fB.qmax){fQ=fB.q+1;fP=ga;fR=fD;fI=0;}else{fQ=fB.q;fP=f$;fR=fC;}}else if(fI>=fB.q&&fB.q>1){fQ=fB.q-1;fP=gb;for(gk=0,gl=fY-1;gk<=gl;gk++){for(gm=fQ+1,gn=f2;gm<=gn;gm++)(fM.get_Item(gk))[gm]=0;}fI=0;fR=fE;}else{fQ=fB.q;fP=f$;fR=fC;}fS=dE.New(fB.t,fO,fB.f,fB.dt,fM,fQ,fP,fJ,fR,fB.qmax,fL,fN,fK,fB.opts);return fS;};dD.NordsieckMatrix_rescale=function(fB,fC){var fD,fE,fF,fG,fH,fI,fJ,fK,fL,fM;fD=1;fG=cO.numCols(fB);fH=cO.numRows(fB);fF=cO.copy(fB);for(fI=1,fJ=fG-1;fI<=fJ;fI++){fD=fD*fC;for(fK=0,fL=fH-1;fK<=fL;fK++){fM=(U.get(fF.MatrixData,fK))[fI]*fD;(U.get(fF.MatrixData,fK))[fI]=fM;}}return fF;};dD.NordsieckMatrix_Jacobian=function(fB,fC,fD){var fE,fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO,fP,fQ,fR,fS,fT,fU,fV,fW,fX,fY,fZ;fE=fC.length;fF=cO.zeros(fE,fE);fG=U.create(fE,0);fH=new a.Float64Array(fE);for(fI=0,fJ=fE-1;fI<=fJ;fI++){U.set(fG,fI,fv.sqrt(1E-06*(fK=1E-05,(fL=fv.abs(fC[fI]),bk.Compare(fK,fL)===1?fK:fL))));fH[fI]=fC[fI];}fM=fD(fB,fC);fN=cO.zeros(fE,fE);for(fO=0,fP=fE-1;fO<=fP;fO++){fH[fO]=fH[fO]+U.get(fG,fO);fR=fD(fB,fH);for(fS=0,fT=fE-1;fS<=fT;fS++){fU=fR[fS];(U.get(fN.MatrixData,fO))[fS]=fU;}fH[fO]=fH[fO]-U.get(fG,fO);}for(fV=0,fW=fE-1;fV<=fW;fV++){fX=fF.get_Item(fV);for(fY=0,fZ=fE-1;fY<=fZ;fY++)fX[fY]=((U.get(fN.MatrixData,fY))[fV]-fM[fV])/U.get(fG,fY);}return fF;};dD.ToleranceNorm=function(fB,fC,fD,fE){var fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO;fH=fB.length;fI=fE.length;fF=0;fG=0;for(fJ=0,fK=fH-1;fJ<=fK;fJ++){fL=fv.abs(fB[fJ]);fF=fF>fL?fF:fL;}for(fM=0,fN=fI-1;fM<=fN;fM++){fO=fv.abs(fE[fM]);fG=fG>fO?fG:fO;}return fF/(fC+fD*fG);};dD.Factorial=function(fB){return fB<0?-1:fB===0?1:fB*dD.Factorial(fB-1);};dE.New=function(fB,fC,fD,fE,fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO){return{t:fB,x:fC,f:fD,dt:fE,z:fF,q:fG,Dq:fH,delta:fI,r:fJ,qmax:fK,nsuccess:fL,e:fM,isIterationFailed:fN,opts:fO};};dF.New=function(fB,fC,fD,fE,fF,fG,fH,fI,fJ){return{InitialStepSize:fB,AbsoluteTolerance:fC,RelativeTolerance:fD,MaxStep:fE,MinStep:fF,MaxScale:fG,MinScale:fH,NumberOfIterations:fI,Jacobian:fJ};};dG.init=function(fB,fC,fD,fE){var fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO;fF=7;fG=fC.length;fH=dH.New(fB,fC,fD,0,cO.zeros(fF,fG),1,0,fC,fE);return dH.New(fB,fC,fD,fE.InitialStepSize===0?(fI=cL.map(function(fP){return fE.AbsoluteTolerance+fE.RelativeTolerance*fv.abs(fP);},fC),(fJ=(fH.f(fB))(fC),(fK=cL.max(cL.map2(function(fP){return function(fQ){return fv.abs(fP/fQ);};},fC,fI)),(fL=cL.max(cL.map2(function(fP){return function(fQ){return fv.abs(fP/fQ);};},fJ,fI)),(fM=fv.min(fK,fL)<1E-05?1E-06:0.01*(fK/fL),(fN=cL.max(cL.map2(function(fP){return function(fQ){return fv.abs(fP/fQ);};},cL.subtract(fJ,(fH.f(fB+fM))(cL.add(fC,cL.scale(fM,fJ)))),cL.scale(fM,fI))),(fO=fv.max(fL,fN)<=1E-15?fv.max(1E-06,fM*0.001):fv.pow(0.01/fv.max(fL,fN),1/5),fO>100*fM?100*fM:fO))))))):fE.InitialStepSize,cO.zeros(fF,fG),1,0,fC,fE);};dG.advance=function(fB){var fC,fD,fE,fF,fG,fH,fI,fJ,fK;function fL(fM){var fN,fO,fP,fQ,fR,fS,fT,fU,fV,fW,fX,fY,fZ,f0,f1,f2,f3,f4,f5,f6,f7,f8,f9,f_,f$,ga,gb,gc,gd,ge,gf,gg,gh,gi,gj,gk,gl,gm,gn,go,gp,gq,gr,gs,gt,gu,gv,gw,gx,gy,gz,gA,gB,gC,gD,gE,gF,gG,gH,gI,gJ,gK;gx=fM.dt;gy=dG.scaleTo(gx,(fN=cL.copy(fD),(fB.f(fC+gx*U.get(fH,0)))(fN)));gz=(fO=U.get(fE,0),dG.scaleTo(gx,(fP=(fQ=cL.copy(fD),dG.addTo(gy,U.get(fO,0),fQ)),(fB.f(fC+gx*U.get(fH,1)))(fP))));gA=(fR=U.get(fE,1),dG.scaleTo(gx,(fS=(fT=(fU=cL.copy(fD),dG.addTo(gy,U.get(fR,0),fU)),dG.addTo(gz,U.get(fR,1),fT)),(fB.f(fC+gx*U.get(fH,2)))(fS))));gB=(fV=U.get(fE,2),dG.scaleTo(gx,(fW=(fX=(fY=(fZ=cL.copy(fD),dG.addTo(gy,U.get(fV,0),fZ)),dG.addTo(gz,U.get(fV,1),fY)),dG.addTo(gA,U.get(fV,2),fX)),(fB.f(fC+gx*U.get(fH,3)))(fW))));gC=(f0=U.get(fE,3),dG.scaleTo(gx,(f1=(f2=(f3=(f4=(f5=cL.copy(fD),dG.addTo(gy,U.get(f0,0),f5)),dG.addTo(gz,U.get(f0,1),f4)),dG.addTo(gA,U.get(f0,2),f3)),dG.addTo(gB,U.get(f0,3),f2)),(fB.f(fC+gx*U.get(fH,4)))(f1))));gD=(f6=U.get(fE,4),dG.scaleTo(gx,(f7=(f8=(f9=(f_=(f$=(ga=cL.copy(fD),dG.addTo(gy,U.get(f6,0),ga)),dG.addTo(gz,U.get(f6,1),f$)),dG.addTo(gA,U.get(f6,2),f_)),dG.addTo(gB,U.get(f6,3),f9)),dG.addTo(gC,U.get(f6,4),f8)),(fB.f(fC+gx*U.get(fH,5)))(f7))));gE=(gb=U.get(fE,5),dG.scaleTo(gx,(gc=(gd=(ge=(gf=(gg=(gh=(gi=cL.copy(fD),dG.addTo(gy,U.get(gb,0),gi)),dG.addTo(gz,U.get(gb,1),gh)),dG.addTo(gA,U.get(gb,2),gg)),dG.addTo(gB,U.get(gb,3),gf)),dG.addTo(gC,U.get(gb,4),ge)),dG.addTo(gD,U.get(gb,5),gd)),(fB.f(fC+gx*U.get(fH,6)))(gc))));gF=cO.ofRows([gy,gz,gA,gB,gC,gD,gE]);gG=(gj=(gk=(gl=(gm=(gn=(go=(gp=cL.copy(fI),dG.addTo(gy,U.get(fG,0),gp)),dG.addTo(gz,U.get(fG,1),go)),dG.addTo(gA,U.get(fG,2),gn)),dG.addTo(gB,U.get(fG,3),gm)),dG.addTo(gC,U.get(fG,4),gl)),dG.addTo(gD,U.get(fG,5),gk)),dG.addTo(gE,U.get(fG,6),gj));gH=(gq=(gr=(gs=(gt=(gu=(gv=(gw=cL.copy(fI),dG.addTo(gy,U.get(fF,0),gw)),dG.addTo(gz,U.get(fF,1),gv)),dG.addTo(gA,U.get(fF,2),gu)),dG.addTo(gB,U.get(fF,3),gt)),dG.addTo(gC,U.get(fF,4),gs)),dG.addTo(gD,U.get(fF,5),gr)),dG.addTo(gE,U.get(fF,6),gq));gI=cL.max(cL.mapi2(fu.Curried3(function(gL,gM,gN){return fv.abs(1*(gM-gN))/fv.max(fB.opts.AbsoluteTolerance,fB.opts.RelativeTolerance*fv.max(fv.abs(fI[gL]),fv.abs(gN)));}),gG,gH));gJ=gI===0?gx:gx*fv.min(5,fv.max(0.2,0.8*fv.pow(1/gI,1/5)*fv.pow(fJ,0.08)));gK=fB.opts.MaxStep<1.79769313486232E+308?fv.min(gJ,fB.opts.MaxStep):gJ;if(a.isNaN(gK))throw new eq.New$2("Derivatives function returned NaN");else if(gK<1E-12)throw new eq.New$2("Cannot generate numerical solution");else return gI<=1?ep.New(gH,gK,fM.dt,gI,gF):fL(ep.New(gH,gK,fM.dt,gI,gF));}fC=fB.t;fD=fB.x;fE=[[1/5],[3/40,9/40],[44/45,-56/15,32/9],[19372/6561,-25360/2187,64448/6561,-212/729],[9017/3168,-355/33,46732/5247,49/176,-5103/18656],[35/384,0,500/1113,125/192,-2187/6784,11/84]];fF=[5179/57600,0,7571/16695,393/640,-92097/339200,187/2100,1/40];fG=[35/384,0,500/1113,125/192,-2187/6784,11/84,0];fH=[0,1/5,3/10,4/5,8/9,1,1];fI=fB.x;fJ=fB.prevErr;fK=fL(ep.New(fB.x,fB.dt,fB.dt,0,fB.k));return dH.New(fB.t+fK.prevDt,fK.x,fB.f,fK.dt,fK.k,fK.e,fB.t,fB.x,fB.opts);};dG.add_interpolate=function(fB,fC){var fD,fE,fG,fH,fI,fJ,fK,fL,fM;function fF(fN){var fO,fP,fQ;return fN>=fG-1?B.Empty:new B({$:1,$0:(fO=U.get(fK,fN),(fP=fE.get_Item(fN),(fQ=fN===0?fB.x:fE.get_Item(fN-1),dH.New(fO,fP,fB.f,fB.dt,fB.k,fB.prevErr,fN===0?fB.t:U.get(fK,fN-1),fQ,fB.opts)))),$1:fF(fN+1)});}fG=4;fH=new a.Float64Array(fG-1);for(fI=0,fJ=fG-2;fI<=fJ;fI++)fH[fI]=(fI+1)/fG;fK=U.create(fG,0);for(fL=0,fM=fG-2;fL<=fM;fL++)U.set(fK,fL,fB.t+(fC.t-fB.t)*fH[fL]);fE=dG.interp(fH,fB.x,fC.k);return fF(0);};dG.defaults=function(){return dI.New(0,1E-06,0.001,1.79769313486232E+308,1E-12);};dG.scaleTo=function(fB,fC){cL.setScaled(fB,fC);return fC;};dG.addTo=function(fB,fC,fD){cL.setAddedScaled(fD,fB,fC);return fD;};dG.interp=function(fB,fC,fD){var fE,fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO,fP,fQ,fR,fS,fT,fU,fV,fW,fX,fY,fZ;bk.Equals(fD,null)?F.FailWith("interpolation array k is empty."):null;fG=fC.length;fH=cO.numRows(fD);fI=fB.length;fJ=cO.zeros(fI,fG);for(fK=0,fL=fI-1;fK<=fL;fK++)fJ.get_Item(fK).set(fC);fM=cO.zeros(4,fI);for(fN=0,fO=fI-1;fN<=fO;fN++){(fM.get_Item(0))[fN]=fB[fN];for(fP=1,fQ=3;fP<=fQ;fP++)(fM.get_Item(fP))[fN]=fB[fN]*(fM.get_Item(fP-1))[fN];}fR=cO.ofArray([[1,-183/64,37/12,-145/128],[0,0,0,0],[0,1500/371,-1000/159,1000/371],[0,-125/32,125/12,-375/64],[0,9477/3392,-729/106,25515/6784],[0,-11/7,11/3,-55/28],[0,3/2,-4,5/2]]);fE=cO.zeros(fG,4);fF=cO.zeros(fG,fI);for(fS=0,fT=fI-1;fS<=fT;fS++){for(fU=0,fV=fG-1;fU<=fV;fU++){(fF.get_Item(fU))[fS]=0;for(fW=0,fX=3;fW<=fX;fW++){(fE.get_Item(fU))[fW]=0;for(fY=0,fZ=fH-1;fY<=fZ;fY++)(fE.get_Item(fU))[fW]=(fE.get_Item(fU))[fW]+(fD.get_Item(fY))[fU]*(fR.get_Item(fY))[fW];(fF.get_Item(fU))[fS]=(fF.get_Item(fU))[fS]+(fE.get_Item(fU))[fW]*(fM.get_Item(fW))[fS];}(fJ.get_Item(fS))[fU]=(fJ.get_Item(fS))[fU]+(fF.get_Item(fU))[fS];}}return fJ;};dH.New=function(fB,fC,fD,fE,fF,fG,fH,fI,fJ){return{t:fB,x:fC,f:fD,dt:fE,k:fF,prevErr:fG,prevT:fH,prevX:fI,opts:fJ};};dI.New=function(fB,fC,fD,fE,fF){return{InitialStepSize:fB,AbsoluteTolerance:fC,RelativeTolerance:fD,MaxStep:fE,MinStep:fF};};dJ=d.OsloAbstract=fu.Class({evaluate:function(){var fB,fC,fD,fE,fF,fG,fH,fI,fJ;function fK(fQ){var fR;fR=fD.tryFind_index(fQ);return fR==null?(function(fS){return function(fT){return fS("Attempting to look up non-existent species "+_2.toSafe(fT));};}(F.FailWith))(fQ.name):fR.$0;}function fL(fQ){function fR(fS){return co.map(fK,fS);}return function(fS){return R.map(fR,fS);};}function fM(fQ){return co.eval_massaction(fB,fQ);}function fN(fQ){return co.eval_function(fB,fG,fQ);}function fO(fQ){return co.map(fK,fQ);}function fP(fQ){return co.inline_keys(fB,fG,fQ);}fB=bF.to_env(this.settings.parameters);fC=V.to_initialpops_events(fB,this.settings.simulation.initial,this.initials);fD=fC[0];fE=fD.get_get_pop_array();fF=bf.create(fD,fC[1],this.settings.simulation,1);fG=co.inline_rates_env(fB,K.Map(function(fQ,fR){return(fL(fQ))(fR);},this.settings.rates));fH=U.map(function(fQ){return cb.map2(fM,fN,fQ);},this.rates);return X.New(this.name,fF,U.ofList(A.map((fI=(fJ=function(fQ){return fP(fO(fQ));},function(fQ){return R.expand(fJ,fQ);}),function(fQ){return R.simplify(fI(fQ));}),fF.settings.plots)),this.settings.deterministic,cO.ofArray(this.matrix),this.powers,fH,cL.ofArray(fE));}},null,dJ);dJ.create=function(fB,fC,fD,fE,fF,fG,fH){return dJ.New(fB,fC,fD,fE,fF,fG,fH);};dJ.New=function(fB,fC,fD,fE,fF,fG,fH){return new dJ({name:fB,settings:fC,matrix:fD,powers:fE,rates:fF,species:fG,initials:fH});};dK=dn.LCGRng=fu.Class({Microsoft_Research_Filzbach_Lib_IRng$NextDouble:function(){var fB;fB=this.Microsoft_Research_Filzbach_Lib_IRng$NextInt32();return[fB[0]*dn["lcg.d"](),fB[1]];},Microsoft_Research_Filzbach_Lib_IRng$NextInt32:function(){var fB;fB=(dn["lcg.a"]()*this.seed%dn["lcd.m"]()+dn["lcg.c"]())%dn["lcd.m"]();return[fB,new dK.New(fB)];}},w,dK);dK.New=fu.Ctor(function(fB){w.New.call(this);this.seed=fB;},dK);dn.fst3=a.id;dn["lcg.d"]=function(){fn.$cctor();return fn["lcg.d"];};dn["lcg.a"]=function(){fn.$cctor();return fn["lcg.a"];};dn["lcd.m"]=function(){fn.$cctor();return fn["lcd.m"];};dn["lcg.c"]=function(){fn.$cctor();return fn["lcg.c"];};dn.logOfNormPDF=function(fB,fC,fD){var fE,fF;fE=fv.sqrt(6.28318530717959);fF=(fB-fD)/fC;return -0.5*fF*fF-fv.log(fE*fC);};dn.improbable=function(){fn.$cctor();return fn.improbable;};dn.normCDF=function(fB,fC,fD){return 0.5*(1+dn.erf((fD-fB)/fC/fv.sqrt(2)));};dn.erfinv=function(fB){var fC,fD,fE,fF;fC=-fv.log((1-fB)*(1+fB));fD=fC<5?[A.ofArray([2.81022636E-08,3.43273939E-07,-3.5233877E-06,-4.39150654E-06,0.00021858087,-0.00125372503,-0.00417768164,0.246640727,1.50140941]),fC-2.5]:(fE=fv.sqrt(fC)-3,[A.ofArray([-0.000200214257,0.000100950558,0.00134934322,-0.00367342844,0.00573950773,-0.0076224613,0.00943887047,1.00167406,2.83297682]),fE]);fF=fD[1];return A.reduce(function(fG,fH){return fG*fF+fH;},fD[0])*fB;};dn.erf=function(fB){var fC;function fD(fE,fF){return function(fG){return[fE+fG*fF,fF*fC];};}fC=1/(1+0.5*fv.abs(fB));return fB<0?fC*fv.exp((U.fold(function(fE,fF){return(function(fG){return fD(fG[0],fG[1]);}(fE))(fF);},[-fB*fB,1],[-1.26551223,1.00002368,0.37409196,0.09678418,-0.18628806,0.27886807,-1.13520398,1.48851587,-0.82215223,0.17087277]))[0])-1:1-fC*fv.exp((U.fold(function(fE,fF){return(function(fG){return fD(fG[0],fG[1]);}(fE))(fF);},[-fB*fB,1],[-1.26551223,1.00002368,0.37409196,0.09678418,-0.18628806,0.27886807,-1.13520398,1.48851587,-0.82215223,0.17087277]))[0]);};dL=d.SundialsAbstract=fu.Class({evaluate:function(){var fB,fC,fD,fE,fF,fG,fH,fI,fJ,fK;function fL(fO){var fP;fP=fE.tryFind_index(fO);return fP==null?(function(fQ){return function(fR){return fQ("Species "+_2.toSafe(fR)+" not found in model");};}(F.FailWith))(fO.name):fP.$0;}function fM(fO){return co.inline_keys(fB,fC,fO);}function fN(fO){return R.map(fI,fO);}fB=bF.to_env(this.settings.parameters);fC=co.inline_rates_env(fB,this.settings.rates);fD=V.to_initialpops_events(fB,this.settings.simulation.initial,this.initials);fE=fD[0];fF=bf.create(fE,fD[1],this.settings.simulation,1);fG=fE.get_get_pop_array();fH=A.map(function(fO){return db.fst3(fO[0],fO[1],fO[2]);},cc.get_sim_reactions_products(1,fE,fB,fC,this.reactions));fI=function(fO){return cY.map(fL,fO);};return _0.New(fF,U.ofList(A.map((fJ=(fK=function(fO){return R.expand(fM,fO);},function(fO){return R.simplify(fK(fO));}),function(fO){return fN(fJ(fO));}),fF.settings.plots)),fH,this.settings.deterministic,fG);}},null,dL);dL.create=function(fB,fC,fD,fE){return dL.New(fB,fE,fC,fD);};dL.New=function(fB,fC,fD,fE){return new dL({species:fB,settings:fC,reactions:fD,initials:fE});};dM.TridiagonalAlgorithm=function(fB,fC,fD,fE){var fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO;fF=U.length(fE);fG=U.create(fF,0);fH=fE.slice();fI=U.create(fF,0);U.set(fG,0,U.get(fD,0)/U.get(fC,0));U.set(fH,0,U.get(fH,0)/U.get(fC,0));for(fJ=1,fK=fF-2;fJ<=fK;fJ++){fL=U.get(fC,fJ)-U.get(fB,fJ)*U.get(fG,fJ-1);U.set(fG,fJ,U.get(fD,fJ)/fL);U.set(fH,fJ,(U.get(fH,fJ)-U.get(fB,fJ)*U.get(fH,fJ-1))/fL);}U.set(fH,fF-1,(U.get(fH,fF-1)-U.get(fB,fF-1)*U.get(fH,fF-2))/(U.get(fC,fF-1)-U.get(fB,fF-1)*U.get(fG,fF-2)));U.set(fI,fF-1,U.get(fH,fF-1));fM=F.step(fF-2,-1,0);fN=da.Get(fM);try{while(fN.MoveNext()){fO=fN.Current();U.set(fI,fO,U.get(fH,fO)-U.get(fG,fO)*U.get(fI,fO+1));}}finally{if(typeof fN=="object"&&"Dispose"in fN)fN.Dispose();}return fI;};dM.ApplySMInvertMatrix=function(fB,fC,fD,fE,fF,fG){var fH,fI;fH=dM.TridiagonalAlgorithm(fB,fC,fD,fE);fI=dM.DotProduct(fF,fH)/(1+dM.DotProduct(fF,fG));return U.map2(function(fJ,fK){return fJ-fI*fK;},fH,fG);};dM.DotProduct=function(fB,fC){return U.fold2(function(fD,fE,fF){return fD+fE*fF;},0,fB,fC);};dN.$cctor=function(){dN.$cctor=a.ignore;dN.empty=new y.New([]);dN.filter=function(fB){return function(fC){return K.Filter(function(fD,fE){return(fB(fD))(fE);},fC);};};};dO.$cctor=function(){var fB,fC,fD,fE,fF;dO.$cctor=a.ignore;function fG(fH){return true;}dO.start_pos=[0,0];dO.add_row=function(fH){return D.add_rows(1,fH);};dO.lineSeparators=["\\r\\n","\\n"];dO.CommentSingle="//";dO.CommentStart="(*";dO.CommentEnd="*)";dO.newline=function(fH){var fI,fJ,fK;fI=fH[0];fJ=fH[1];fK=fJ[0];return dk.StartsWith(fI,"\\n")?{$:1,$0:"\\n",$1:[fI.substring(1),[fK+1,0]]}:dk.StartsWith(fI,"\\r\\n")?{$:1,$0:"\\n",$1:[fI.substring(2),[fK+1,0]]}:dk.StartsWith(fI,"\\r")?{$:1,$0:"\\n",$1:[fI.substring(1),[fK+1,0]]}:D.mk_failEmpty([fK,fJ[1]],"linebreak");};dO.eof=function(fH){return fH[0]===""?{$:0,$0:null,$1:["",fH[1]]}:D.mk_failEmpty(fH[1],"end of input");};dO.digits=D.op_LessQmarkGreater(D.manySatisfy(D.isDigit),"an integer");dO.digits1=D.op_LessQmarkGreater(D.many1Satisfy(D.isDigit),"an integer");dO.skipNewline=D.op_BarGreaterGreater(D.newline(),a.ignore);dO.keyword=D.skipString;dO.linebreak=D.op_BarGreaterGreater(D.newline(),a.ignore);dO.sign=D.op_BarGreaterGreater(D.opt(D.pstring("-")),function(fH){return fH==null?"":"-";});dO.forced_sign=D.op_LessBarGreater(D.pstring("-"),D.pstring("+"));dO.opt_sign=D.op_BarGreaterGreater(D.opt(D.op_LessBarGreater(D.pstring("-"),D.pstring("+"))),function(fH){return fH==null?"":fH.$0;});dO.pint32=D.guarded(function(fH){return F.toInt(a.Number(fH));},D.pTry(D.op_DotGreaterGreaterDot(D.sign(),D.digits1())));dO.pfloat=D.op_LessQmarkGreater(D.guarded(a.Number,D.pTry(D.op_DotGreaterGreaterDot(D.op_DotGreaterGreaterDot(D.op_DotGreaterGreaterDot(D.sign(),D.digits1()),D.opt(D.op_GreaterGreaterDot(D.pstring("."),D.digits1()))),D.opt(D.op_DotGreaterGreaterDot(D.op_GreaterGreaterDot(D.op_LessBarGreater(D.pstring("e"),D.pstring("E")),D.opt_sign()),D.digits1()))))),"a float");dO.anyChar=function(fH){var fI,fJ,fK,fL;fI=fH[0];fJ=fH[1];fK=fJ[0];fL=[fK,fJ[1]];return fI.length>0&&D.isLetter(fI[0])?dk.StartsWith(fI,"\\n")?{$:1,$0:"\\n",$1:[fI.substring(1),[fK+1,0]]}:dk.StartsWith(fI,"\\r\\n")?{$:1,$0:"\\n",$1:[fI.substring(2),[fK+1,0]]}:dk.StartsWith(fI,"\\r")?{$:1,$0:"\\n",$1:[fI.substring(1),[fK+1,0]]}:{$:1,$0:fI[0],$1:[fI.substring(1),D.add_cols(1,fL)]}:D.mk_failEmpty(fL,"a letter");};dO.whiteSpace=D.op_LessQmarkGreater(D.op_LessBarGreater(D.linebreak(),function(fH){return D.skipChar(D.isWhiteSpace,fH[0],fH[1]);}),"a white space");dO.anyChar_INTERNAL=D.op_LessQmarkGreater(function(fH){return D.skipChar(fG,fH[0],fH[1]);},"any char");dO.eol=D.op_LessBarGreater((fB=D.choice(U.map(D.keyword(),D.lineSeparators())),function(fH){return fB([fH[0],fH[1]]);}),D.eof());dO.commentLine=D.op_BarGreaterGreater(D.op_GreaterGreaterGreaterGreater((D.keyword())(D.CommentSingle()),(fC=D.op_LessBarGreater(D.linebreak(),D.eof()),function(fH){return D.manyUntil(D.anyChar_INTERNAL(),fC,fH[0],fH[1]);})),a.ignore);dO.spaces=function(fH){var fI;fI=(D.many(D.op_LessBarGreater(D.op_LessBarGreater(D.commentLine(),D.commentMultiline()),D.whiteSpace())))(fH);return fI.$==1?{$:0,$0:"",$1:fI.$1}:fI.$==2?{$:0,$0:"",$1:fH}:fI.$==3?{$:3,$0:fI.$0,$1:fI.$1}:{$:0,$0:"",$1:fI.$1};};dO.spaces1=function(fH){var fI;fI=(D.many1(D.op_LessBarGreater(D.op_LessBarGreater(D.commentLine(),D.commentMultiline()),D.whiteSpace())))(fH);return fI.$==1?{$:0,$0:"",$1:fI.$1}:fI.$==2?{$:0,$0:"",$1:fH}:fI.$==3?{$:3,$0:fI.$0,$1:fI.$1}:{$:0,$0:"",$1:fI.$1};};dO.name=D.op_LessQmarkGreater(D.op_BarGreaterGreater(D.op_DotGreaterGreaterDot(D.many1Satisfy(D.isLetter),D.manySatisfy(function(fH){return D.isLetter(fH)||D.isDigit(fH)||fH==="_"||fH==="\'";})),function(fH){return fH[0]+fH[1];}),"an identifier");dO.pcolour=(fD=D.manySatisfy(function(fH){return D.isLetter(fH)||D.isDigit(fH);}),D.op_DotGreaterGreater(D.op_GreaterGreaterDot(D.pstring("\\""),(fE=D.choice([D.op_GreaterGreaterEquals(D.op_GreaterGreaterDot(D.kw("#"),D.many1Satisfy(function(fH){return"a"<=fH&&fH<="f"||"A"<=fH&&fH<="F"||D.isDigit(fH);})),function(fH){return D.preturn("#"+fH);}),fD]),function(fH){return fE([fH[0],fH[1]]);})),D.kw("\\"")));dO.pbool=(fF=D.choice([D.op_GreaterGreaterPercent(D.kw("true"),true),D.op_GreaterGreaterPercent(D.kw("True"),true),D.op_GreaterGreaterPercent(D.kw("false"),false),D.op_GreaterGreaterPercent(D.kw("False"),false)]),function(fH){return fF([fH[0],fH[1]]);});dO.parse=new et.New();};dP=x.ValueCollection=fu.Class({GetEnumerator$1:function(){return da.Get(bc.map(function(fB){return fB.V;},this.d));},GetEnumerator:function(){return this.GetEnumerator$1();},GetEnumerator0:function(){return this.GetEnumerator$1();}},w,dP);dP.New=fu.Ctor(function(fB){w.New.call(this);this.d=fB;},dP);dQ.fromSeq=function(fB){var fC;fC=U.ofSeq(bc.delay(function(){return bc.collect(function(fD){return[cz.New(fD[0],fD[1])];},bc.distinctBy(function(fD){return fD[0];},fB));}));U.sortInPlace(fC);return cx.Build(fC,0,fC.length-1);};dS=dR.StringBuilder=fu.Class({Append:function(fB){this._str=this._str+fB;return this;}},w,dS);dS.New$1=fu.Ctor(function(fB){w.New.call(this);this._str="";this._str=fB;},dS);dS.New=fu.Ctor(function(){dS.New$1.call(this,"");},dS);dT.$cctor=function(){dT.$cctor=a.ignore;dT.newline="\\r\\n";dT.tab="\\u0009";dT.quotemark="\\"";dT.space=" ";dT.empty="";dT.equals="=";dT.indent_string=bl.space()+bl.space();dT.preamble=bl.xmltag(A.ofArray([["version",{$:1,$0:"1.0"}],["encoding",{$:1,$0:"UTF-8"}]]))+bl.newline()+bl.tagopen(0,"sbml",A.ofArray([["xmlns",{$:1,$0:"http://www.sbml.org/sbml/level2/version4"}],["level",{$:1,$0:"2"}],["version",{$:1,$0:"4"}]]))+bl.newline();dT.postamble=bl.tagclose(0,"sbml");dT.openAngle="&lt;";dT.closeAngle=">";dT.empty_model=dU.New(null,null,B.Empty,B.Empty,B.Empty,B.Empty,B.Empty,B.Empty);};dU.New=function(fB,fC,fD,fE,fF,fG,fH,fI){return{id:fB,name:fC,listOfUnitDefinitions:fD,listOfCompartments:fE,listOfSpecies:fF,listOfParameters:fG,listOfInitialAssignments:fH,listOfReactions:fI};};dV.Mole={$:19};dV.Litre={$:15};dV.Dimensionless={$:4};dV.Second={$:24};dW.Times={$:4};dW.Plus={$:3};dX.Divide={$:1};dX.Power={$:2};dX.Subtract={$:3};dX.Mod={$:5};dY.New=function(fB,fC,fD){return{rnorm_phase:fB,rnorm_2:fC,rnorm_f:fD};};dZ.IsLetterOrDigit=function(fB){return dZ.IsLetter(fB)||dZ.IsDigit(fB);};dZ.IsLetter=function(fB){return fB>="A"&&fB<="Z"||fB>="a"&&fB<="z";};dZ.IsDigit=function(fB){return fB>="0"&&fB<="9";};dZ.IsWhiteSpace=function(fB){return fB.match(new a.RegExp("\\\\s"))!==null;};d0.$cctor=function(){d0.$cctor=a.ignore;d0.activate_idd_script="\\r\\nvar objects = document.getElementsByClassName(\\"cliplot div.fsharp-idd\\");\\r\\nfor(var i = 0; i < objects.length; i++)\\r\\n  InteractiveDataDisplay.asPlot(objects.item(i));\\r\\nobjects = document.getElementsByClassName(\\"cliplot div.idd-subplots\\");\\r\\nfor(var i = 0; i < objects.length; i++)\\r\\n  InteractiveDataDisplay.asSubPlots(objects.item(i));\\r\\n";d0.prepare_idd_script=(function(fB){return function(fC){return fB("\\r\\n<script type=\\"text/javascript\\">\\r\\n    window.addEventListener(\\"load\\", function(){"+_2.toSafe(fC)+"});\\r\\n<\/script>");};}(a.id))(bz.activate_idd_script());d0.cdn_scripts="\\r\\n<link rel=\\"stylesheet\\" type=\\"text/css\\" href=\\"https://cdn.jsdelivr.net/npm/interactive-data-display@1.5.30/dist/idd.css\\" integrity=\\"sha384-c0Bubh+0uCjFanb6BoVtGLQAYmnD27PrMKjIlFp3QZ/ZjpWHo+q86s7zmX1bKAmU\\" crossorigin=\\"anonymous\\"/>\\r\\n<script src=\\"https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js\\" integrity=\\"sha384-bPV3mA2eo3edoq56VzcPBmG1N1QVUfjYMxVIJPPzyFJyFZ8GFfN7Npt06Zr23qts\\" crossorigin=\\"anonymous\\"><\/script>\\r\\n<script src=\\"https://code.jquery.com/jquery-2.1.4.min.js\\" integrity=\\"sha384-R4/ztc4ZlRqWjqIuvf6RX5yb/v90qNGx6fS48N0tRxiGkqveZETq72KgDVJCp2TC\\" crossorigin=\\"anonymous\\"><\/script>\\r\\n<script src=\\"https://cdnjs.cloudflare.com/ajax/libs/rxjs/3.1.2/rx.lite.min.js\\" integrity=\\"sha384-YYQgxpPVmcgxIB80jXrurb3n9UJCb8MOA+2Om6wfF3Fji0Khse2mz3Pz87kt2wba\\" crossorigin=\\"anonymous\\"><\/script>\\r\\n<script src=\\"https://cdnjs.cloudflare.com/ajax/libs/jquery-mousewheel/3.1.13/jquery.mousewheel.min.js\\" integrity=\\"sha384-jx+EoRqSnwNqHsZoMJl/OMDriDdzqdPXunQMsJOq6eUISEJxQkBgcR88EFkA2iHw\\" crossorigin=\\"anonymous\\"><\/script>\\r\\n<script src=\\"https://cdn.jsdelivr.net/npm/interactive-data-display@1.5.30/dist/idd.js\\" integrity=\\"sha384-Ys962FVdDdKVR+cU47Lb85HIpxUsV8oK/s7lb43z8kD7481L26ecJ4Q3yqUdgRBJ\\" crossorigin=\\"anonymous\\"><\/script>\\r\\n";d0.footer_scripts_idd="\\r\\n<script>\\r\\nfunction openTab(evt, group, tabName) {\\r\\n    var i, tabcontent, tablinks;\\r\\n    tabcontent = document.getElementsByClassName(\\"tabcontent cliplot \\"+group);\\r\\n    for (i = 0; i < tabcontent.length; i++) {\\r\\n        tabcontent[i].style.display = \\"none\\";\\r\\n    }\\r\\n    tablinks = document.getElementsByClassName(\\"tablinks cliplot \\"+group);\\r\\n    for (i = 0; i < tablinks.length; i++) {\\r\\n        tablinks[i].className = tablinks[i].className.replace(\\" active\\", \\"\\");\\r\\n    }\\r\\n    document.getElementById(group+tabName).style.display = \\"block\\";\\r\\n    evt.currentTarget.className += \\" active\\";\\r\\n    var objects = document.querySelectorAll(\\"#\\"+group+tabName+\\" div.fsharp-idd\\");\\r\\n    for(var i = 0; i < objects.length; i++)\\r\\n        InteractiveDataDisplay.asPlot(objects.item(i)).requestUpdateLayout();\\r\\n    objects = document.querySelectorAll(\\"#\\"+group+tabName+\\" div.idd-subplots\\");\\r\\n    for(var i = 0; i < objects.length; i++)\\r\\n        InteractiveDataDisplay.asSubPlots(objects.item(i));\\r\\n}\\r\\nfunction openComparison(evt, group, compName) {\\r\\n    var i, compcontent, complinks;\\r\\n    compcontent = document.getElementsByClassName(\\"compcontent cliplot \\"+group);\\r\\n    for (i = 0; i < compcontent.length; i++) {\\r\\n        compcontent[i].style.display = \\"none\\";\\r\\n    }\\r\\n    complinks = document.getElementsByClassName(\\"complinks cliplot \\"+group);\\r\\n    for (i = 0; i < complinks.length; i++) {\\r\\n        complinks[i].className = complinks[i].className.replace(\\" active\\", \\"\\");\\r\\n    }\\r\\n    document.getElementById(group+compName).style.display = \\"block\\";\\r\\n    evt.currentTarget.className += \\"active\\";\\r\\n    var objects = document.querySelectorAll(\\"#\\"+group+compName+\\" div.fsharp-idd\\");\\r\\n    for(var i = 0; i < objects.length; i++)\\r\\n        InteractiveDataDisplay.asPlot(objects.item(i)).requestUpdateLayout();\\r\\n    objects = document.querySelectorAll(\\"#\\"+group+compName+\\" div.idd-subplots\\");\\r\\n    for(var i = 0; i < objects.length; i++)\\r\\n        InteractiveDataDisplay.asSubPlots(objects.item(i));\\r\\n}\\r\\nwindow.addEventListener(\\"load\\", function() { document.getElementById(\\"cliplot_defaultOpen\\").click(); });\\r\\n<\/script>";d0.page_header_scripts=((((fu.Curried(function(fB,fC,fD,fE){return fB(_2.toSafe(fC)+" "+_2.toSafe(fD)+" "+_2.toSafe(fE));},4))(a.id))(bz.cdn_scripts()))(bz.prepare_idd_script()))(bz.footer_scripts_idd());d0.unified_scripts=(((fu.Curried3(function(fB,fC,fD){return fB("<script>"+_2.toSafe(fC)+"<\/script> "+_2.toSafe(fD));}))(a.id))(bz.activate_idd_script()))(bz.footer_scripts_idd());d0.local_styles="<style>\\r\\n    .cliplot {font-family: \\"Lato\\", sans-serif;}\\r\\n    \\r\\n    ul.tab.cliplot {\\r\\n\\u0009\\u0009list-style-type: none;\\r\\n\\u0009\\u0009margin: 0;\\r\\n\\u0009\\u0009padding: 0;\\r\\n\\u0009\\u0009overflow: hidden;\\r\\n\\u0009\\u0009border: 2px solid #ccc;\\r\\n\\u0009\\u0009background-color: #f1f1f1;\\r\\n\\u0009}\\r\\n\\r\\n\\u0009/* Float the list items side by side */\\r\\n\\u0009ul.tab.cliplot li {float: left;}\\r\\n\\r\\n\\u0009/* Style the links inside the list items */\\r\\n\\u0009ul.tab.cliplot li a {\\r\\n\\u0009\\u0009display: inline-block;\\r\\n\\u0009\\u0009color: black;\\r\\n\\u0009\\u0009text-align: center;\\r\\n\\u0009\\u0009padding: 14px 16px;\\r\\n\\u0009\\u0009text-decoration: none;\\r\\n\\u0009\\u0009transition: 0.3s;\\r\\n\\u0009\\u0009font-size: 17px;\\r\\n\\u0009}\\r\\n\\r\\n\\u0009/* Change background color of links on hover */\\r\\n\\u0009ul.tab.cliplot li a:hover {\\r\\n\\u0009\\u0009background-color: #ddd;\\r\\n\\u0009}\\r\\n\\r\\n\\u0009/* Create an active/current tablink class */\\r\\n\\u0009ul.tab.cliplot li a:focus, .active.cliplot {\\r\\n\\u0009\\u0009background-color: #ccc;\\r\\n\\u0009}\\r\\n\\r\\n\\u0009/* Style the tab content */\\r\\n\\u0009.tabcontent.cliplot {\\r\\n\\u0009\\u0009display: none;\\r\\n\\u0009\\u0009padding: 12px 12px;\\r\\n\\u0009\\u0009border: 2px solid #ccc;\\r\\n\\u0009\\u0009border-top: none;\\r\\n\\u0009}\\r\\n\\r\\n\\u0009/* Style the table cells*/\\r\\n\\u0009th.cliplot, td.cliplot { \\r\\n\\u0009\\u0009padding: 3px;\\r\\n\\u0009\\u0009min-width: 50px;\\r\\n\\u0009}\\u0009\\r\\n\\u0009th.cliplot {\\r\\n\\u0009\\u0009border-top: 2px solid #000;\\r\\n\\u0009\\u0009border-bottom: 1px solid #000;\\r\\n\\u0009}\\r\\n\\u0009table.cliplot#pTable {\\r\\n\\u0009\\u0009border-collapse: collapse;\\r\\n\\u0009\\u0009border-bottom: 2px solid #000;\\r\\n\\u0009}</style>";};d1.run_seq=function(fB,fC,fD,fE){var fF,fG,fH,fI,fJ,fK,fL;function fM(fN,fO,fP){var fQ,fR,fS;fQ=fN.$==1?(fR=d1.sampleStep(fB,fG,fE,fO,fP,fN.$0),[{$:1,$0:fR[0]},fR[1]]):fO>=fE.burninLen?[{$:1,$0:bw.samplingInit(fN.$0)},fP]:(fS=d1.burninStep(fB,fG,fE,fO,fP,fN.$0),[{$:0,$0:fS[0]},fS[1]]);return[fQ[0],fO+1,fQ[1]];}fF=d1.paramsInit(fD,bw.paramsCheck(fC));fG=fF[1];fH=fF[0];fI=fB(d2.All);fJ=bw.paramsInit(fH,new dK.New(fE.seed));fK=fJ[0];fL=fI(fK);return bc.map(function(fN){return dn.fst3(fN[0],fN[1],fN[2]);},bw.step_to_seq(function(fN){return fM(fN[0],fN[1],fN[2]);},[{$:0,$0:bw.burninInit(function(fN){return bc.sum(fI(fN));},fH,fK,fF[2],fJ[1])},1,fL],fE.burninLen+fE.sampleLen));};d1.paramsInit=function(fB,fC){var fD,fE,fF,fG;function fH(fJ,fK){return fJ.isFixed();}function fI(fJ,fK){return new e6.New(fJ.name,fJ.range);}fD=A.partition(function(fJ){return fH(fJ[0],fJ[1]);},A.zip(fC,fB));fE=fD[1];fF=bq.ofSeq(A.map(function(fJ){return fI(fJ[0],fJ[1]);},fE));fG=A.map(function(fJ){return fJ[1];},fE);return[A.map(function(fJ){return fJ[0];},A.append(fE,fD[0])),fG,fF];};d1.sampleStep=function(fB,fC,fD,fE,fF,fG){var fH,fI,fJ,fK,fL,fM,fN;fH=d1.evaluateAcceptance(fB,fC,fE,fF,fG.space,fG.priors,fG.state,fG.innovationGens,fG.indexes,fG.randGen);fI=fH[0];fJ=fI.$==0?(fK=fI.$0,[fK,fK.logLikelihood>fG.mle.logLikelihood?fK:fG.mle,fH[2],fG.accepted+1]):[(fL=fG.state,bo.New(fL.values,fL.logLikelihood,fL.logPrior,fE)),fG.mle,fF,fG.accepted];fM=fJ[0];fN=bx.New(fG.space,fM,fG.thinningSkippedCount,fG.chain,fG.burnin,fH[1],fH[3],fJ[1],fG.priors,fG.indexes,fJ[3]);return[fN.thinningSkippedCount===fD.thinning-1?bx.New(fN.space,fN.state,0,new B({$:1,$0:fM,$1:fN.chain}),fN.burnin,fN.randGen,fN.innovationGens,fN.mle,fN.priors,fN.indexes,fN.accepted):bx.New(fN.space,fN.state,fN.thinningSkippedCount+1,fN.chain,fN.burnin,fN.randGen,fN.innovationGens,fN.mle,fN.priors,fN.indexes,fN.accepted),fJ[2],fH[5]];};d1.burninStep=function(fB,fC,fD,fE,fF,fG){var fH,fI,fJ,fK,fL,fM,fN,fO,fP,fQ,fR;function fS(fU,fV){return fV?bs.New(fU.accepted+1,fU.altered+1):fU;}function fT(fU,fV){return fV?bs.New(fU.accepted,fU.altered+1):fU;}fH=d1.evaluateAcceptance(fB,fC,fE,fF,fG.space,fG.priors,fG.state,fG.innovationGens,fG.indexes,fG.randGen);fI=fH[4];fJ=fH[0];fK=fJ.$==0?(fL=fJ.$0,[fL,fL.logLikelihood>fG.mle.logLikelihood?fL:fG.mle,fH[2],(((fu.Curried3(U.map2))(fS))(fG.stats))(fI)]):[(fM=fG.state,bo.New(fM.values,fM.logLikelihood,fM.logPrior,fE)),fG.mle,fF,(((fu.Curried3(U.map2))(fT))(fG.stats))(fI)];fN=fK[0];fO=fK[3];fP=U.choose(a.id,U.mapi(function(fU,fV){return fV.altered===20?{$:1,$0:fU}:null;},fO));fQ=bw.correctInnovationGens(fP,fG.space,fG.stats,fG.innovationGens);fR=by.New(fG.space,fN,fG.thinningSkippedCount,fG.chain,U.mapi(function(fU,fV){return U.contains(fU,fP)?bs.New(0,0):fV;},fO),fH[1],fQ,fK[1],fG.priors,fG.indexes);return[fR.thinningSkippedCount===fD.thinning-1?by.New(fR.space,fR.state,0,new B({$:1,$0:fN,$1:fR.chain}),fR.stats,fR.randGen,fR.innovationGens,fR.mle,fR.priors,fR.indexes):by.New(fR.space,fR.state,fR.thinningSkippedCount+1,fR.chain,fR.stats,fR.randGen,fR.innovationGens,fR.mle,fR.priors,fR.indexes),fK[2],fH[5]];};d1.evaluateAcceptance=function(fB,fC,fD,fE,fF,fG,fH,fI,fJ,fK){var fL,fM,fN,fO,fP,fQ,fR,fS;fL=bw.proposeValues(fF,fH,fK,fI);fM=fL[3];fN=fL[0];fO=fL[2];fP=fL[1];fQ=bw.isStateOutOfRange(fP,fN,fF,fJ);return fQ?[fg.Rejected,fM,fE,fO,fP,fQ]:(fR=d1.partial_logLikelihoods(fP,fC,fB,fE,fN),(fS=bw.acceptProposedValues(fD,bc.sum(fR),bw.lglkPriors(fN,fG),fN,fH,fM),[fS[0],fS[1],fR,fO,fP,fQ]));};d1.partial_logLikelihoods=function(fB,fC,fD,fE,fF){var fG,fH,fI;fG=A.map(function(fJ){return fJ[1];},A.filter(function(fJ){return fJ[0];},A.zip(A.ofArray(fB),fC)));return A.contains(d2.All,fG)?(fD(d2.All))(fF):(fH=A.sort(A.distinct(bc.fold(function(fJ,fK){return fK.$==0?F.FailWith("Can\'t be possible"):A.append(fK.$0,fJ);},B.Empty,fG))),(fI=(fD({$:1,$0:fH}))(fF),A.mapi(function(fJ,fK){var fL;fL=bc.tryFindIndex(function(fM){return fM===fJ;},fH);return fL==null?fK:fI.get_Item(fL.$0);},fE)));};d2.All={$:0};bw.run_seq=function(fB,fC,fD){var fE,fF,fG;function fH(fI,fJ){var fK,fL,fM;return[fI.$==1?{$:1,$0:(fK=bw.sampleStep(fB,fD,fJ,fI.$0),dn.fst3(fK[0],fK[1],fK[2]))}:fJ>=fD.burninLen?{$:1,$0:(fL=bw.sampleStep(fB,fD,fJ,bw.samplingInit(fI.$0)),dn.fst3(fL[0],fL[1],fL[2]))}:{$:0,$0:(fM=bw.burninStep(fB,fD,fJ,fI.$0),dn.fst3(fM[0],fM[1],fM[2]))},fJ+1];}fE=bw.paramsSetup(bw.paramsCheck(fC));fF=fE[0];fG=bw.paramsInit(fF,new dK.New(fD.seed));return bc.map(function(fI){return fI[0];},bw.step_to_seq(function(fI){return fH(fI[0],fI[1]);},[{$:0,$0:bw.burninInit(fB,fF,fG[0],fE[1],fG[1])},0],fD.burninLen+fD.sampleLen));};bw.paramsCheck=function(fB){A.iter(function(fC){var fD,fE;fD=fC.initValue;fD==null?void 0:(fE=fD.$0,fE>fC.range.ub||fE<fC.range.lb?((((fu.Curried(function(fF,fG,fH,fI){return fF("The initial value of parameter "+_2.toSafe(fG)+" is outside the specified bounds ("+fH.toFixed(6)+","+fI.toFixed(6)+")");},4))(F.FailWith))(fC.name))(fC.range.lb))(fC.range.ub):void 0);},fB);A.exists(function(fC){return fC.isFixed()&&fC.initValue==null;},fB)?F.FailWith("All fixed parameters must have initial value"):void 0;A.exists(function(fC){return fC.range.lb>fC.range.ub;},fB)?F.FailWith("One of the parameter definitions contains upper bound lower than lower bound"):void 0;A.exists(function(fC){return!fC.isReal()&&fC.range.lb<0;},fB)?F.FailWith("One of the log-scale parameter definitions contains negative lower bound"):void 0;return A.map(function(fC){var fD;return fC.range.pType.$===1&&fC.range.lb===0?bC.New(fC.name,(fD=fC.range,br.New(fD.pType,4.94065645841247E-324,fD.ub)),fC.initValue,fC.prior,fC.summary):fC;},fB);};bw.paramsInit=function(fB,fC){var fD,fE;function fF(fG,fH,fI){var fJ;return fG==null?(fJ=fI.Microsoft_Research_Filzbach_Lib_IRng$NextDouble(),[fH.lb+fJ[0]*(fH.ub-fH.lb),fJ[1]]):[fG.$0,fI];}fD=U.ofList(A.skip(1,A.scan(function(fG,fH){var fI;fI=fF(fH.initValue,fH.range,fG[1]);return[new e6.New(fH.name,fI[0]),fI[1]];},[new e6.New("dummy",0),fC],fB)));fE=U.map(function(fG){return fG[0];},fD);U.length(fD)!==fB.get_Length()?F.FailWith("unexpected scan behaviour"):void 0;return[bq.ofArray(fE),(U.get(fD,U.length(fD)-1))[1]];};bw.step_to_seq=function(fB,fC,fD){function fE(fF,fG){var fH;return fG<=0?null:(fH=fB(fF),{$:1,$0:[fH,[fH,fG-1]]});}return bc.unfold(function(fF){return fE(fF[0],fF[1]);},[fC,fD]);};bw.burninInit=function(fB,fC,fD,fE,fF){var fG,fH,fI;function fJ(fK){var fL;fL=fK.pType;return fL.$==1?0.5*(fv.log(fK.ub)-fv.log(fK.lb)):fL.$==2?F.FailWith("Must not be called. Innovation generator is not needed for fixed parameter"):0.5*(fK.ub-fK.lb);}fG=K.OfArray(U.ofSeq(U.mapi(function(fK,fL){return[fK,new _do.New(0,fJ(fL))];},fE.get__dataArray())));fH=U.ofList(A.map(function(fK){return fK.prior;},fC));fI=bo.New(fD,fB(fD),bw.lglkPriors(fD,fH),0);return by.New(fE,fI,0,B.Empty,U.map(function(){return bs.New(0,0);},fE.get__dataArray()),fF,fG,fI,fH,U.init(fG.get_Count(),a.id));};bw.samplingInit=function(fB){return bx.New(fB.space,fB.state,0,B.Empty,fB.chain,fB.randGen,fB.innovationGens,fB.mle,fB.priors,fB.indexes,0);};bw.paramsSetup=function(fB){var fC,fD,fE;fC=A.partition(function(fF){return fF.isFixed();},fB);fD=fC[1];fE=bq.ofSeq(A.map(function(fF){return new e6.New(fF.name,fF.range);},fD));return[A.append(fD,fC[0]),fE];};bw.sampleStep=function(fB,fC,fD,fE){var fF,fG,fH,fI,fJ,fK,fL,fM,fN;fF=bw.evaluateAcceptance(fB,fD,fE.space,fE.priors,fE.state,fE.innovationGens,fE.indexes,fE.randGen);fG=fF[4];fH=fF[0];fI=fH.$==0?(fJ=fH.$0,[fJ,fJ.logLikelihood>fE.mle.logLikelihood?fJ:fE.mle,fE.accepted+1]):[(fK=fE.state,bo.New(fK.values,fK.logLikelihood,fK.logPrior,fD)),fE.mle,fE.accepted];fL=fI[0];fM=fI[1];fN=bx.New(fE.space,fL,fE.thinningSkippedCount,fE.chain,fE.burnin,fF[1],fF[2],fM,fE.priors,fE.indexes,fI[2]);return fN.thinningSkippedCount===fC.thinning-1?[bx.New(fN.space,fN.state,0,new B({$:1,$0:fL,$1:fN.chain}),fN.burnin,fN.randGen,fN.innovationGens,fN.mle,fN.priors,fN.indexes,fN.accepted),fM.logLikelihood,fG]:[bx.New(fN.space,fN.state,fN.thinningSkippedCount+1,fN.chain,fN.burnin,fN.randGen,fN.innovationGens,fN.mle,fN.priors,fN.indexes,fN.accepted),fM.logLikelihood,fG];};bw.burninStep=function(fB,fC,fD,fE){var fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO,fP,fQ,fR;function fS(fU,fV){return fV?bs.New(fU.accepted+1,fU.altered+1):fU;}function fT(fU,fV){return fV?bs.New(fU.accepted,fU.altered+1):fU;}fF=bw.evaluateAcceptance(fB,fD,fE.space,fE.priors,fE.state,fE.innovationGens,fE.indexes,fE.randGen);fG=fF[4];fH=fF[3];fI=fF[0];fJ=fI.$==0?(fK=fI.$0,[fK,fK.logLikelihood>fE.mle.logLikelihood?fK:fE.mle,(((fu.Curried3(U.map2))(fS))(fE.stats))(fH)]):[(fL=fE.state,bo.New(fL.values,fL.logLikelihood,fL.logPrior,fD)),fE.mle,(((fu.Curried3(U.map2))(fT))(fE.stats))(fH)];fM=fJ[0];fN=fJ[1];fO=fJ[2];fP=U.choose(a.id,U.mapi(function(fU,fV){return fV.altered===20?{$:1,$0:fU}:null;},fO));fQ=bw.correctInnovationGens(fP,fE.space,fE.stats,fE.innovationGens);fR=by.New(fE.space,fM,fE.thinningSkippedCount,fE.chain,U.mapi(function(fU,fV){return U.exists(function(fW){return fU===fW;},fP)?bs.New(0,0):fV;},fO),fF[1],fQ,fN,fE.priors,fE.indexes);return fR.thinningSkippedCount===fC.thinning-1?[by.New(fR.space,fR.state,0,new B({$:1,$0:fM,$1:fR.chain}),fR.stats,fR.randGen,fR.innovationGens,fR.mle,fR.priors,fR.indexes),fN.logLikelihood,fG]:[by.New(fR.space,fR.state,fR.thinningSkippedCount+1,fR.chain,fR.stats,fR.randGen,fR.innovationGens,fR.mle,fR.priors,fR.indexes),fN.logLikelihood,fG];};bw.lglkPriors=function(fB,fC){var fD;function fE(fF,fG){var fH,fI,fJ;return fF==null?0:fF.$0.$==1?(fH=fF.$0.$0,dn.logOfNormPDF(fH.mu,fH.sigma,fv.log(fG))-fv.log(fG)):fF.$0.$==2?(fI=fF.$0.$0,dn.logOfNormPDF(fI.mean,fI.stdev,fG)-fv.log(fI.denominator)):(fJ=fF.$0.$0,dn.logOfNormPDF(fJ.mean,fJ.stdev,fG));}return U.sum((fD=fB.ToArray(),(((fu.Curried3(U.map2))(fE))(fC))(fD)));};bw.correctInnovationGens=function(fB,fC,fD,fE){function fF(fG,fH,fI){var fJ,fK,fL,fM,fN,fO,fP,fQ,fR,fS;fJ=(fK=fI<5?fG.get_Sigma()*0.8:fI>5?fG.get_Sigma()*1.2:fG.get_Sigma(),(fL=fH.pType,fL.$==1?(fM=(fN=10,bk.Compare(fK,fN)===-1?fK:fN),(fO=0.01,bk.Compare(fM,fO)===1?fM:fO)):fL.$==2?F.FailWith("Update of fixed value"):(fP=fH.ub-fH.lb,(fQ=0.001*fP,(fR=(fS=0.5*fP,bk.Compare(fK,fS)===-1?fK:fS),bk.Compare(fR,fQ)===1?fR:fQ)))));return new _do.New(fG.get_Mean(),fJ);}return K.Map(function(fG,fH){return U.exists(function(fI){return fG===fI;},fB)?fF(fH,fC.Item$1(fG),U.get(fD,fG).accepted):fH;},fE);};bw.evaluateAcceptance=function(fB,fC,fD,fE,fF,fG,fH,fI){var fJ,fK,fL,fM,fN,fO,fP;fJ=bw.proposeValues(fD,fF,fI,fG);fK=fJ[3];fL=fJ[0];fM=fJ[2];fN=fJ[1];fO=bw.isStateOutOfRange(fN,fL,fD,fH);return fO?[fg.Rejected,fK,fM,fN,fO]:(fP=bw.acceptProposedValues(fC,fB(fL),bw.lglkPriors(fL,fE),fL,fF,fK),[fP[0],fP[1],fM,fN,fO]);};bw.proposeValues=function(fB,fC,fD,fE){var fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO,fP,fQ,fR,fS,fT,fU,fV,fW,fX,fY;function fZ(f1,f2,f3,f4){var f5,f6;f5=f3.nextDouble(f4);f6=f5[0];return[f1.$==1?f2*fv.exp(f6):f1.$==2?F.FailWith("Proposing to update fixed value"):f2+f6,f5[1],f5[2]];}function f0(f1){var f2,f3,f4;f2=function(f5,f6,f7){var f8,f9,f_;while(true){f8=f6.Microsoft_Research_Filzbach_Lib_IRng$NextDouble();f9=f8[1];f_=f8[0];if(f7===1)return[new B({$:1,$0:f_,$1:f5}),f9];else{f5=new B({$:1,$0:f_,$1:f5});f6=f9;f7=f7-1;}}}(B.Empty,f1,fH);f3=f2[1];f4=U.ofList(f2[0]);return U.exists(function(f5){return f5<fT;},f4)?[U.map(function(f5){return f5<fT;},f4),f3]:f0(f3);}fF=fC.values;fG=fC.values.get__dataArray();fH=U.length(fB.get__dataArray());return fH===0?[fF,[],fE,fD]:(fI=U.sub(fG,fH,U.length(fG)-fH),(fJ=(fK=fD.Microsoft_Research_Filzbach_Lib_IRng$NextDouble(),(fL=fK[1].Microsoft_Research_Filzbach_Lib_IRng$NextDouble(),(fM=fL[1],(fN=fL[0],fK[0]<0.67?(fO=U.create(fH,null),(fP=fM.Microsoft_Research_Filzbach_Lib_IRng$NextDouble(),(fQ=fP[1].Microsoft_Research_Filzbach_Lib_IRng$NextDouble(),(fR=F.toInt(fv.floor(fN*fH)),(fR>0&&fP[0]<0.5?U.set(fO,fR-1,true):void 0,U.set(fO,fR,true),fR<fH-1&&fQ[0]<0.5?U.set(fO,fR+1,true):void 0,[fO,fQ[1]]))))):(fS=3/fH,(fT=(fU=fS*fv.exp(4*(fN-0.5)),fU<0.1*fS?0.1*fS:fU>0.99?0.99:fU),f0(fM))))))),(fV=fJ[0],(fW=U.ofSeq(bc.skip(1,bc.scan(function(f1,f2){var f3,f4,f5,f6;f3=f1[1];f4=f1[3];f5=f1[2];f6=f2?fZ(fB.Item$1(f4).pType,fF.Item$1(f4),f5.get_Item(f4),f3):[U.get(fG,f4),f5.get_Item(f4),f3];return[f6[0],f6[2],f5.Add(f4,f6[1]),f4+1];},[0,fJ[1],fE,0],fV))),(fX=U.map(a.fst,fW).concat(fI),(fY=U.get(fW,U.length(fW)-1),[fF.CopyWithNewValues(fX),fV,fY[2],fY[1]]))))));};bw.isStateOutOfRange=function(fB,fC,fD,fE){function fF(fG){var fH,fI;fH=fC.Item$1(fG);fI=fD.Item$1(fG);return fH<fI.lb||fH>fI.ub;}return U.exists2(function(fG,fH){return fG&&fF(fH);},fB,fE);};bw.acceptProposedValues=function(fB,fC,fD,fE,fF,fG){var fH,fI,fJ,fK,fL;fH=(fI=fD+fC,(fJ=fF.logLikelihood+fF.logPrior,(fK=fG.Microsoft_Research_Filzbach_Lib_IRng$NextDouble(),(fL=fK[1],fI>fJ?[true,fL]:[fI-fJ>fv.log(fK[0]),fL]))));return[fH[0]?{$:0,$0:bo.New(fE,fC,fD,fB)}:fg.Rejected,fH[1]];};d3.stringOfSummary=function(fB,fC,fD){var fE,fF,fG,fH,fI,fJ,fK;fE="\\u0009";fF="\\r\\n";return fB.$==1?(fG=fB.$0,(fH=d3.getSummary(fG),(fI=fG.mle.values,(fJ=d3.informationCriteria(fG,fD),dk.concat(fF,U.concat([["Params"+fE+a.String(fH.length),"Free_params"+fE+a.String(U.filter(function(fL){return fL.range.pType.$!==2;},fH).length),"Burnin"+fE+a.String(fC.burninLen),"Samples"+fE+a.String(fC.sampleLen),"Max loglikelihood"+fE+a.String(fG.mle.logLikelihood),"AIC"+fE+a.String(fJ.AIC),"BIC"+fE+a.String(fJ.BIC),"DIC"+fE+a.String(fJ.DIC)],[" ",dk.concat(fE,["Name","Type","Lower Bound","Upper Bound","MLE","Posterior mean","Posterior variance","Posterior l95","Posterior l68","Posterior median","Posterior u68","Posterior u95"])],U.map(function(fL){return dk.concat(fE,new B({$:1,$0:fL.name,$1:new B({$:1,$0:d3.stringOfRange(fL.range.pType),$1:A.map(a.String,A.ofArray([fL.range.lb,fL.range.ub,fI.Item(fL.name),fL.summary.mean,fL.summary.variance,fL.qsummary.lb95,fL.qsummary.lb68,fL.qsummary.median,fL.qsummary.ub68,fL.qsummary.ub95]))})}));},fH)])))))):(fK=fB.$0,dk.concat(fF,U.concat([["Phase: Burn-In"],["Params"+fE+a.String(fK.space.get_Names().length),"Free_params"+fE+a.String(U.filter(function(fL){return fL.pType.$!==2;},fK.space.ToArray()).length),"Burnin"+fE+a.String(fC.burninLen),"Samples"+fE+a.String(fC.sampleLen),"Max loglikelihood"+fE+a.String(fK.mle.logLikelihood)]])));};d3.getSummary=function(fB){var fC;fC=d3.extractBayesTable(fB);return U.length(fC.get_ColumnNames())<=1?[]:U.ofSeq(bc.delay(function(){return bc.map(function(fD){return d3.getParameterSummary(fC,fB,fD);},bc.skip(1,fC.get_ColumnNames()));}));};d3.informationCriteria=function(fB,fC){var fD,fE,fF;fD=fB.mle.logLikelihood;fE=U.length(fB.space.get__dataArray());return eI.New(-2*fD+2*fE,-2*fD+fv.log(fC)*fE,(fF=d3.extractBayesTable(fB),fF.get_ColumnCount()===0?a.NaN:-1*(-2*fD)+2*U.average(U.map(function(fG){return -2*fG;},fF.GetColumn("logLikelihood")))));};d3.stringOfRange=function(fB){return fB.$==1?"log":fB.$==2?"fixed":"real";};d3.extractBayesTable=function(fB){var fC,fD;fC=U.ofSeq(bc.map(function(fE){return[fE.logLikelihood].concat(fE.values.get__dataArray());},fB.chain));return U.length(fC)===0?new e7.New([],new dm.New([])):(fD=new dm.New(U.ofSeq(bc.delay(function(){return bc.append(["logLikelihood"],bc.delay(function(){return fB.space.get__namesMap().get_Keys();}));}))),new e7.New(U.init(U.length(fB.space.get__namesMap().get_Keys())+1,function(fE){return U.init(U.length(fC),function(fF){return U.get(U.get(fC,fF),fE);});}),fD));};d3.getParameterSummary=function(fB,fC,fD){var fE,fF;fE=fB.GetColumn(fD);fF=fC.space.get__namesMap().Item(fD);return eF.New(fD,fC.mle.values.Item(fD),d3.summary(fE),d3.qsummary(fE),fC.space.Item$1(fF));};d3.qsummary=function(fB){var fC,fD;function fE(fF){var fG,fH;fG=fF*(fD+1/3)-2/3;return fG<=0?U.get(fC,0):fG>=fD-1?U.get(fC,fD-1):(fH=fv.floor(fG),U.get(fC,F.toInt(fH))*(1-fG+fH)+U.get(fC,F.toInt(fH)+1)*(fG-fH));}fC=U.ofSeq(bc.filter(function(fF){return!(a.isNaN(fF)||fv.abs(fF)===a.Infinity);},fB));U.sortInPlace(fC);fD=U.length(fC);return fD<1?eH.New(a.NaN,a.NaN,a.NaN,a.NaN,a.NaN,a.NaN,a.NaN):eH.New(U.get(fC,0),fE(0.025),fE(0.16),fE(0.5),fE(0.84),fE(0.975),U.get(fC,fD-1));};d3.summary=function(fB){var fC;fC=bc.fold(function(fD,fE){var fF,fG,fH,fI,fJ;return a.isNaN(fE)||fv.abs(fE)===a.Infinity?fD:(fF=fE-fD.mean,(fG=fD.count+1,(fH=fD.mean+fF/fG,eG.New(fG,(fI=fD.min,bk.Compare(fE,fI)===-1?fE:fI),(fJ=fD.max,bk.Compare(fE,fJ)===1?fE:fJ),fH,fD.variance+fF*(fE-fH)))));},eG.New(0,Infinity,-Infinity,0,0),fB);return fC.count<2?fC:eG.New(fC.count,fC.min,fC.max,fC.mean,fC.variance/(fC.count-1));};d4.New=function(fB,fC,fD,fE,fF,fG){return{burninLen:fB,sampleLen:fC,thinning:fD,seed:fE,print_console:fF,print_summary:fG};};d5.toString=function(fB){var fC,fD,fE;return fB.$==1?(fC=fB.$0,(fD=A.length(fC.Attributes)===0?"":" "+dk.Join(" ",U.ofSeq(bc.map(function(fF){return(((fu.Curried3(function(fG,fH,fI){return fG(_2.toSafe(fH)+"=\\""+_2.toSafe(fI)+"\\"");}))(a.id))(fF.Key.$0))(fF.Value.$0);},fC.Attributes))),(fE=dk.Join("\\n",U.ofSeq(bc.map(d5.toString,bc.rev(fC.Children)))),(((fu.Curried3(function(fF,fG,fH){return fF("<div"+_2.toSafe(fG)+">"+_2.toSafe(fH)+"</div>");}))(a.id))(fD))(fE)))):fB.$==2?(function(fF){return function(fG){return fF("<table class=\'idd-subplots-table\'>"+_2.toSafe(fG)+"</table>");};}(a.id))(dk.Join("\\n",U.ofSeq(bc.map(function(fF){return(function(fG){return function(fH){return fG("<tr>"+_2.toSafe(fH)+"</tr>");};}(a.id))(dk.Join("",U.ofSeq(bc.map(function(fG){return(function(fH){return function(fI){return fH("<td>"+_2.toSafe(fI)+"</td>");};}(a.id))(d5.toString(fG.$0));},bc.rev(fF.$0)))));},bc.rev(fB.$0.$0))))):fB.$==3?"":fB.$0.$0;};d5.createDiv=function(){return eJ.New(B.Empty,B.Empty);};d5.addDiv=function(fB,fC){return eJ.New(fC.Attributes,new B({$:1,$0:{$:1,$0:fB},$1:fC.Children}));};d5.addText=function(fB,fC){return eJ.New(fC.Attributes,new B({$:1,$0:{$:0,$0:d5.guardText(fB)},$1:fC.Children}));};d5.addAttribute=function(fB,fC,fD){return eJ.New(new B({$:1,$0:eK.New(d5.guardAttrName(fB),d5.guardAttrValue(fC)),$1:fD.Attributes}),fD.Children);};d5.addTable=function(fB,fC){return eJ.New(fC.Attributes,new B({$:1,$0:{$:2,$0:fB},$1:fC.Children}));};d5.guardText=function(fB){return{$:0,$0:dk.Replace(dk.Replace(fB,">","&gt;"),"<","&lt;")};};d5.guardAttrName=function(fB){var fC;fC=["-"];if(U.exists(function(fD){return!(dZ.IsLetterOrDigit(fD)||U.contains(fD,fC));},dk.ToCharArray(fB)))throw new eq.New$2((((fu.Curried3(function(fD,fE,fF){return fD("the string must contain only letters, digits or "+_2.printArray(_2.prettyPrint,fE)+", but "+_2.toSafe(fF)+" was passed");}))(a.id))(fC))(fB));else null;return{$:0,$0:fB};};d5.guardAttrValue=function(fB){return{$:0,$0:dk.Replace(dk.Replace(fB,"\\\\","\\\\\\\\"),"\\"","\\\\\\"")};};d6.toHtmlStructure=function(fB){var fC,fD,fE,fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO,fP,fQ,fR,fS,fT;fC=d5.createDiv();fD=d6.addVisibleRegionInfo(fB.VisibleRegion,K.OfArray(U.ofSeq(A.ofArray([["class","fsharp-idd"],["data-idd-plot","figure"],["style",(((fu.Curried3(function(fU,fV,fW){return fU("width: "+a.String(fV)+"px; height: "+a.String(fW)+"px;");}))(a.id))(fB.Width))(fB.Height)]]))),new y.New([]));fE=d6.axisToHtmlStructure(fB.Yaxis,eL.Left);fF=fE==null?[fC,null]:[d5.addDiv(fE.$0[0],fC),{$:1,$0:fE.$0[1]}];fG=fF[0];fH=fB.Ylabel!==null?d5.addDiv(d6.vertAxisLabelToHtmlStructue(fB.Ylabel,eL.Left),fG):fG;fI=d6.axisToHtmlStructure(fB.Xaxis,eL.Bottom);fJ=fI==null?[fH,null]:[d5.addDiv(fI.$0[0],fH),{$:1,$0:fI.$0[1]}];fK=fJ[0];fL=fB.Xlabel!==null?d5.addDiv(d6.horAxisLabelToHtmlStructure(fB.Xlabel,eL.Bottom),fK):fK;fM=!fB.IsTooltipPlotCoordsEnabled?fD[1].Add("isLegendVisible",d6.getEffectiveLegendvisibility(fB.IsLegendEnabled,fB.Plots)?"true":"false").Add("suppress-tooltip-coords","true"):fD[1].Add("isLegendVisible",d6.getEffectiveLegendvisibility(fB.IsLegendEnabled,fB.Plots)?"true":"false");fN=fD[0].Add("data-idd-navigation-enabled",fB.IsNavigationEnabled?"true":"false");fO=d6.gridLinesToHtmlStructure(fB.GridLines,fJ[1],fF[1],fB.Title!==null?(fP=d5.addText(fB.Title,d5.createDiv()),d5.addDiv(d6.addAttributes((new y.New([])).Add("class","idd-title").Add("data-idd-placement","top"),fP),fL)):fL);fQ=(fR=fB.TooltipDelay,fR==null?fM:fM.Add("tooltipDelay",(function(fU){return function(fV){return fU(fV.toFixed(6));};}(a.id))(fR.$0)));fS=bc.fold(function(fU,fV){return d5.addDiv(fV,fU);},fO,bc.map(d6.plotToDiv,fB.Plots));fT=d6.createStyleAttributes(fQ);return{$:1,$0:d6.addAttributes(fN.Add(fT[0],fT[1]),fS)};};d6.addVisibleRegionInfo=function(fB,fC,fD){return fB.$==1?[fC.Add("data-idd-visible-region",(((((fu.Curried(function(fE,fF,fG,fH,fI){return fE(fF.toFixed(6)+" "+fG.toFixed(6)+" "+fH.toFixed(6)+" "+fI.toFixed(6));},5))(a.id))(fB.$0))(fB.$2))(fB.$1))(fB.$3)),fD]:[fC,fD.Add("padding",(function(fE){return function(fF){return fE(a.String(fF));};}(a.id))(fB.$0))];};d6.axisToHtmlStructure=function(fB,fC){var fD,fE,fF,fG,fH,fI,fJ,fK,fL;return fB.$==1?(fD=fv.floor((new fy()).valueOf()*fv.random()).toString(),{$:1,$0:[fB.$0?d5.addAttribute("data-idd-scientific-notation","true",d5.addAttribute("style","position: relative;",(fE=d5.addAttribute("data-idd-axis","numeric",d5.addAttribute("id",fD,d5.createDiv())),d5.addAttribute("data-idd-placement",d6.placementToStr(fC),fE)))):d5.addAttribute("style","position: relative;",(fE=d5.addAttribute("data-idd-axis","numeric",d5.addAttribute("id",fD,d5.createDiv())),d5.addAttribute("data-idd-placement",d6.placementToStr(fC),fE))),fD]}):fB.$==2?(fF=fB.$0,(fG=fv.floor((new fy()).valueOf()*fv.random()).toString(),(fH=(fI=d5.addAttribute("data-idd-datasource","InteractiveDataDisplay.readBase64",d5.addAttribute("data-idd-style",fF.Angle===0?"":"rotate: true; rotateAngle: "+(function(fM){return function(fN){return fM(fN.toFixed(6)+";");};}(a.id))(fF.Angle),d5.addAttribute("style","position: relative;",(fJ=d5.addAttribute("data-idd-axis","labels",d5.addAttribute("id",fG,d5.createDiv())),d5.addAttribute("data-idd-placement",d6.placementToStr(fC),fJ))))),d5.addText((fK=U.ofSeq(fF.Ticks),(fL=U.ofSeq(fF.Labels).map(a.btoa).join(","),(((fu.Curried3(function(fM,fN,fO){return fM("ticks float64.1D "+_2.toSafe(fN)+"\\nlabels string.1D "+_2.toSafe(fO));}))(a.id))(a.btoa((new a.Uint8Array(fz.from(fK).buffer)).reduce(function(fM,fN){return fM+fA.fromCharCode(fN);},""))))(fL))),fI)),{$:1,$0:[fF.ForceLabelsVisibility?d5.addAttribute("data-idd-force-labels-visibility","true",fF.Angle===0?fH:d5.addAttribute("data-idd-style","rotate: true; rotateAngle: "+(function(fM){return function(fN){return fM(fN.toFixed(6)+";");};}(a.id))(fF.Angle),fH)):fF.Angle===0?fH:d5.addAttribute("data-idd-style","rotate: true; rotateAngle: "+(function(fM){return function(fN){return fM(fN.toFixed(6)+";");};}(a.id))(fF.Angle),fH),fG]}))):null;};d6.vertAxisLabelToHtmlStructue=function(fB,fC){var fD,fE;fD=fC.$==3||(fC.$==0?false:fC.$!=1)?d6.placementToStr(fC):F.FailWith("wrong placement");return d5.addDiv(d5.addText(fB,d5.addAttribute("class","idd-verticalTitle-inner",d5.createDiv())),d5.addAttribute("data-idd-placement",fD,d5.addAttribute("class","idd-verticalTitle",d5.createDiv())));};d6.horAxisLabelToHtmlStructure=function(fB,fC){var fD;return d5.addText(fB,d5.addAttribute("data-idd-placement",fC.$==3||(fC.$==0?false:fC.$!=1)?F.FailWith("wrong placement"):d6.placementToStr(fC),d5.addAttribute("class","idd-horizontalTitle",d5.createDiv())));};d6.createStyleAttributes=function(fB){return["data-idd-style",K.Fold(function(fC,fD,fE){return fC+fD+": "+fE+"; ";},"",fB)];};d6.addAttributes=function(fB,fC){return K.Fold(function(fD,fE,fF){return d5.addAttribute(fE,fF,fD);},fC,fB);};d6.plotToDiv=function(fB){return fB.$==1?d6.markersToDiv(fB.$0):fB.$==2?d6.barchartToDiv(fB.$0):fB.$==3?d6.histogramToDiv(fB.$0):fB.$==4?d6.heatmapToDiv(fB.$0):d6.polylineToDiv(fB.$0);};d6.gridLinesToHtmlStructure=function(fB,fC,fD,fE){var fF,fG,fH;return fB.$==0?fE:(fF=fB.$0,d5.addDiv(fD==null?fC==null?(fG=A.ofArray([(function(fI){return function(fJ){return fI("thickness: "+fJ.toFixed(1)+"px");};}(a.id))(fB.$1)]),d5.addAttribute("data-idd-style",dk.Join("; ",U.ofSeq(fF.$==0?fG:(fH=fF.$0,new B({$:1,$0:((((fu.Curried(function(fI,fJ,fK,fL){return fI("stroke: rgb("+fA(fJ)+","+fA(fK)+","+fA(fL)+")");},4))(a.id))(fH.R))(fH.G))(fH.B),$1:fG})))),d5.addAttribute("data-idd-placement","center",d5.addAttribute("data-idd-plot","grid",d5.createDiv())))):d5.addAttribute("data-idd-xaxis",fC.$0,(fG=A.ofArray([(function(fI){return function(fJ){return fI("thickness: "+fJ.toFixed(1)+"px");};}(a.id))(fB.$1)]),d5.addAttribute("data-idd-style",dk.Join("; ",U.ofSeq(fF.$==0?fG:(fH=fF.$0,new B({$:1,$0:((((fu.Curried(function(fI,fJ,fK,fL){return fI("stroke: rgb("+fA(fJ)+","+fA(fK)+","+fA(fL)+")");},4))(a.id))(fH.R))(fH.G))(fH.B),$1:fG})))),d5.addAttribute("data-idd-placement","center",d5.addAttribute("data-idd-plot","grid",d5.createDiv()))))):d5.addAttribute("data-idd-yaxis",fD.$0,fC==null?(fG=A.ofArray([(function(fI){return function(fJ){return fI("thickness: "+fJ.toFixed(1)+"px");};}(a.id))(fB.$1)]),d5.addAttribute("data-idd-style",dk.Join("; ",U.ofSeq(fF.$==0?fG:(fH=fF.$0,new B({$:1,$0:((((fu.Curried(function(fI,fJ,fK,fL){return fI("stroke: rgb("+fA(fJ)+","+fA(fK)+","+fA(fL)+")");},4))(a.id))(fH.R))(fH.G))(fH.B),$1:fG})))),d5.addAttribute("data-idd-placement","center",d5.addAttribute("data-idd-plot","grid",d5.createDiv())))):d5.addAttribute("data-idd-xaxis",fC.$0,(fG=A.ofArray([(function(fI){return function(fJ){return fI("thickness: "+fJ.toFixed(1)+"px");};}(a.id))(fB.$1)]),d5.addAttribute("data-idd-style",dk.Join("; ",U.ofSeq(fF.$==0?fG:(fH=fF.$0,new B({$:1,$0:((((fu.Curried(function(fI,fJ,fK,fL){return fI("stroke: rgb("+fA(fJ)+","+fA(fK)+","+fA(fL)+")");},4))(a.id))(fH.R))(fH.G))(fH.B),$1:fG})))),d5.addAttribute("data-idd-placement","center",d5.addAttribute("data-idd-plot","grid",d5.createDiv())))))),fE));};d6.getEffectiveLegendvisibility=function(fB,fC){return fB.$==2?false:fB.$==1?A.exists(function(fD){return fD.$==1?fD.$0.Name!==null:fD.$==2?fD.$0.Name!==null:fD.$==3?fD.$0.Name!==null:fD.$==4?fD.$0.Name!==null:fD.$0.Name!==null;},fC):true;};d6.placementToStr=function(fB){return fB.$==0?"bottom":fB.$==2?"left":fB.$==3?"right":"top";};d6.markersToDiv=function(fB){var fC,fD,fE,fF,fG,fH,fI,fJ,fK;fC=A.ofArray([(function(fL){return function(fM){return fL("size: "+fM.toFixed(1));};}(a.id))(fB.Size)]);fD=(fE=fB.FillColour,fE.$==0?fC:(fF=fE.$0,new B({$:1,$0:((((fu.Curried(function(fL,fM,fN,fO){return fL("color: rgb("+fA(fM)+","+fA(fN)+","+fA(fO)+")");},4))(a.id))(fF.R))(fF.G))(fF.B),$1:fC})));fG=(fH=fB.BorderColour,fH.$==0?fD:(fI=fH.$0,new B({$:1,$0:((((fu.Curried(function(fL,fM,fN,fO){return fL("border: rgb("+fA(fM)+","+fA(fN)+","+fA(fO)+")");},4))(a.id))(fI.R))(fI.G))(fI.B),$1:fD})));return dk.IsNullOrEmpty(fB.Name)?(fJ=d5.addAttribute("data-idd-datasource","InteractiveDataDisplay.readBase64",d5.addAttribute("data-idd-style",dk.Join("; ",U.ofSeq(new B({$:1,$0:(function(fL){return function(fM){return fL("shape: "+_2.toSafe(fM));};}(a.id))((fK=fB.Shape,fK.$==1?"circle":fK.$==3?"cross":fK.$==2?"diamond":fK.$==4?"triangle":"box")),$1:fG}))),d5.addAttribute("data-idd-plot","markers",d5.createDiv()))),d5.addText(d6.getXYDataDom(fB.X,fB.Y),fJ)):d5.addAttribute("data-idd-name",fB.Name,(fJ=d5.addAttribute("data-idd-datasource","InteractiveDataDisplay.readBase64",d5.addAttribute("data-idd-style",dk.Join("; ",U.ofSeq(new B({$:1,$0:(function(fL){return function(fM){return fL("shape: "+_2.toSafe(fM));};}(a.id))((fK=fB.Shape,fK.$==1?"circle":fK.$==3?"cross":fK.$==2?"diamond":fK.$==4?"triangle":"box")),$1:fG}))),d5.addAttribute("data-idd-plot","markers",d5.createDiv()))),d5.addText(d6.getXYDataDom(fB.X,fB.Y),fJ)));};d6.barchartToDiv=function(fB){var fC,fD,fE,fF,fG,fH,fI,fJ,fK,fL,fM,fN;fC=A.ofArray([(function(fO){return function(fP){return fO("barWidth: "+fP.toFixed(6));};}(a.id))(fB.BarWidth)]);fD=(fE=fB.FillColour,fE.$==0?fC:(fF=fE.$0,new B({$:1,$0:((((fu.Curried(function(fO,fP,fQ,fR){return fO("color: rgb("+fA(fP)+","+fA(fQ)+","+fA(fR)+")");},4))(a.id))(fF.R))(fF.G))(fF.B),$1:fC})));fG=(fH=fB.BorderColour,fH.$==0?fD:(fI=fH.$0,new B({$:1,$0:((((fu.Curried(function(fO,fP,fQ,fR){return fO("border: rgb("+fA(fP)+","+fA(fQ)+","+fA(fR)+")");},4))(a.id))(fI.R))(fI.G))(fI.B),$1:fD})));fJ=(fK=fB.Shadow,fK.$==0?fG:(fL=fK.$0,fL.$==0?new B({$:1,$0:"shadow: grey",$1:fG}):(fM=fL.$0,new B({$:1,$0:((((fu.Curried(function(fO,fP,fQ,fR){return fO("shadow: rgb("+fA(fP)+","+fA(fQ)+","+fA(fR)+")");},4))(a.id))(fM.R))(fM.G))(fM.B),$1:fG}))));return dk.IsNullOrEmpty(fB.Name)?(fN=d5.addAttribute("data-idd-datasource","InteractiveDataDisplay.readBase64",d5.addAttribute("data-idd-style",dk.Join("; ",U.ofSeq(new B({$:1,$0:function(fO){return fO("shape: bars");}(a.id),$1:fJ}))),d5.addAttribute("data-idd-plot","markers",d5.createDiv()))),d5.addText(d6.getXYDataDom(fB.BarCenters,fB.BarHeights),fN)):d5.addAttribute("data-idd-name",fB.Name,(fN=d5.addAttribute("data-idd-datasource","InteractiveDataDisplay.readBase64",d5.addAttribute("data-idd-style",dk.Join("; ",U.ofSeq(new B({$:1,$0:function(fO){return fO("shape: bars");}(a.id),$1:fJ}))),d5.addAttribute("data-idd-plot","markers",d5.createDiv()))),d5.addText(d6.getXYDataDom(fB.BarCenters,fB.BarHeights),fN)));};d6.histogramToDiv=function(fB){var fC;return d6.barchartToDiv((fC=fi.buildHistogram(fB.Samples,fB.BinCount),e$.New(fB.Name,U.ofList(fC.BinCentres),U.ofSeq(bc.map(a.id,fC.BinCounters)),fC.BinWidth,fB.Colour,fB.Colour,fk.WithoutShadow)));};d6.heatmapToDiv=function(fB){var fC,fD,fE,fF,fG,fH,fI;fC=A.ofArray([(function(fJ){return function(fK){return fJ("opacity: "+fK.toFixed(6));};}(a.id))(fB.Opacity)]);return dk.IsNullOrEmpty(fB.Name)?(fD=d5.addAttribute("data-idd-datasource","InteractiveDataDisplay.readBase64",d5.addAttribute("data-idd-style",dk.Join("; ",U.ofSeq((fE=fB.Palette,fE.$==1?fC:new B({$:1,$0:(function(fJ){return function(fK){return fJ("colorPalette: "+_2.toSafe(fK));};}(a.id))(fE.$0),$1:fC})))),d5.addAttribute("data-idd-plot","heatmap",d5.createDiv()))),d5.addText((fF=fB.Data,(fG=fF.length,(fH=fF.length?fF[0].length:0,(fI=U.ofSeq(bc.delay(function(){return bc.collect(function(fJ){return bc.map(function(fK){return U.get2D(fF,fJ,fK);},F.range(0,fH-1));},F.range(0,fG-1));})),(((((fu.Curried(function(fJ,fK,fL,fM,fN){return fJ("x float64.1D "+_2.toSafe(fK)+"\\ny float64.1D "+_2.toSafe(fL)+"\\nvalues float64.2D "+fA(fM)+" "+_2.toSafe(fN));},5))(a.id))(a.btoa((new a.Uint8Array(fz.from(U.ofSeq(fB.X)).buffer)).reduce(function(fJ,fK){return fJ+fA.fromCharCode(fK);},""))))(a.btoa((new a.Uint8Array(fz.from(U.ofSeq(fB.Y)).buffer)).reduce(function(fJ,fK){return fJ+fA.fromCharCode(fK);},""))))(fH))(a.btoa((new a.Uint8Array(fz.from(U.ofSeq(fI)).buffer)).reduce(function(fJ,fK){return fJ+fA.fromCharCode(fK);},""))))))),fD)):d5.addAttribute("data-idd-name",fB.Name,(fD=d5.addAttribute("data-idd-datasource","InteractiveDataDisplay.readBase64",d5.addAttribute("data-idd-style",dk.Join("; ",U.ofSeq((fE=fB.Palette,fE.$==1?fC:new B({$:1,$0:(function(fJ){return function(fK){return fJ("colorPalette: "+_2.toSafe(fK));};}(a.id))(fE.$0),$1:fC})))),d5.addAttribute("data-idd-plot","heatmap",d5.createDiv()))),d5.addText((fF=fB.Data,(fG=fF.length,(fH=fF.length?fF[0].length:0,(fI=U.ofSeq(bc.delay(function(){return bc.collect(function(fJ){return bc.map(function(fK){return U.get2D(fF,fJ,fK);},F.range(0,fH-1));},F.range(0,fG-1));})),(((((fu.Curried(function(fJ,fK,fL,fM,fN){return fJ("x float64.1D "+_2.toSafe(fK)+"\\ny float64.1D "+_2.toSafe(fL)+"\\nvalues float64.2D "+fA(fM)+" "+_2.toSafe(fN));},5))(a.id))(a.btoa((new a.Uint8Array(fz.from(U.ofSeq(fB.X)).buffer)).reduce(function(fJ,fK){return fJ+fA.fromCharCode(fK);},""))))(a.btoa((new a.Uint8Array(fz.from(U.ofSeq(fB.Y)).buffer)).reduce(function(fJ,fK){return fJ+fA.fromCharCode(fK);},""))))(fH))(a.btoa((new a.Uint8Array(fz.from(U.ofSeq(fI)).buffer)).reduce(function(fJ,fK){return fJ+fA.fromCharCode(fK);},""))))))),fD)));};d6.polylineToDiv=function(fB){var fC,fD,fE,fF,fG,fH,fI,fJ;fC=A.ofArray([(function(fK){return function(fL){return fK("thickness: "+fL.toFixed(1));};}(a.id))(fB.Thickness)]);fD=(fE=fB.Colour,fE.$==0?fC:(fF=fE.$0,new B({$:1,$0:((((fu.Curried(function(fK,fL,fM,fN){return fK("stroke: rgb("+fA(fL)+","+fA(fM)+","+fA(fN)+")");},4))(a.id))(fF.R))(fF.G))(fF.B),$1:fC})));fG=new B({$:1,$0:(function(fK){return function(fL){return fK("lineJoin: "+_2.toSafe(fL));};}(a.id))((fH=fB.LineJoin,fH.$==0?"bevel":fH.$==1?"round":"miter")),$1:fD});return dk.IsNullOrEmpty(fB.Name)?(fI=d5.addAttribute("data-idd-datasource","InteractiveDataDisplay.readBase64",d5.addAttribute("data-idd-style",dk.Join("; ",U.ofSeq(new B({$:1,$0:(function(fK){return function(fL){return fK("lineCap: "+_2.toSafe(fL));};}(a.id))((fJ=fB.LineCap,fJ.$==1?"round":fJ.$==2?"square":"butt")),$1:fG}))),d5.addAttribute("data-idd-plot","polyline",d5.createDiv()))),d5.addText(d6.getXYDataDom(fB.X,fB.Y),fI)):d5.addAttribute("data-idd-name",fB.Name,(fI=d5.addAttribute("data-idd-datasource","InteractiveDataDisplay.readBase64",d5.addAttribute("data-idd-style",dk.Join("; ",U.ofSeq(new B({$:1,$0:(function(fK){return function(fL){return fK("lineCap: "+_2.toSafe(fL));};}(a.id))((fJ=fB.LineCap,fJ.$==1?"round":fJ.$==2?"square":"butt")),$1:fG}))),d5.addAttribute("data-idd-plot","polyline",d5.createDiv()))),d5.addText(d6.getXYDataDom(fB.X,fB.Y),fI)));};d6.getXYDataDom=function(fB,fC){return(((fu.Curried3(function(fD,fE,fF){return fD("x float64.1D "+_2.toSafe(fE)+"\\ny float64.1D "+_2.toSafe(fF));}))(a.id))(a.btoa((new a.Uint8Array(fz.from(U.ofSeq(fB)).buffer)).reduce(function(fD,fE){return fD+fA.fromCharCode(fE);},""))))(a.btoa((new a.Uint8Array(fz.from(U.ofSeq(fC)).buffer)).reduce(function(fD,fE){return fD+fA.fromCharCode(fE);},"")));};d7.setTitle=function(fB,fC){return eM.New(fB===null?null:{$:1,$0:fB},fC.Charts,fC.PlotWidth,fC.PlotHeight,fC.RowsCount,fC.ColumnsCount,fC.ExternalLegendSource,fC.Margin,fC.CommonVisibility,fC.SyncHorizontalAxes,fC.SyncVerticalAxes);};d7.createSubplots=function(fB,fC,fD){var fE,fF;fE=F.range(0,fC-1);fF=bc.concat(bc.map(function(fG){return bc.map(function(fH){return[fG,fH];},fE);},F.range(0,fB-1)));return eM.New(null,bc.fold(function(fG,fH){return fG.Add(fH,fD(fH[0],fH[1]));},new y.New([]),fF),300,200,fB,fC,null,{$:1,$0:20},true,null,null);};d7.setSubplotSize=function(fB,fC,fD){return eM.New(fD.Title,fD.Charts,fB,fC,fD.RowsCount,fD.ColumnsCount,fD.ExternalLegendSource,fD.Margin,fD.CommonVisibility,fD.SyncHorizontalAxes,fD.SyncVerticalAxes);};d7.subplotsToHtmlStructure=function(fB){var fC,fD,fE,fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO;fC=d7.slotGridToHtmlStructure(fB.PlotWidth,fB.PlotHeight,d7.subplotsToSlotGrid(fB));fD=d5.addAttribute("class","idd-subplots",d5.createDiv());fE=(fF=fB.Title,fF==null?fD:d5.addDiv(d5.addAttribute("class","idd-subplots-title",d5.addText(fF.$0,d5.createDiv())),fD));fG=d5.addAttribute("class","idd-subplots-legendholder",d5.createDiv());fH=(fI=d5.addTable(fC,(fJ=fB.ExternalLegendSource,fJ==null?fG:d5.addAttribute("data-idd-ext-legend",((((fu.Curried(function(fP,fQ,fR,fS){return fP(_2.toSafe(fQ)+" "+fA(fR)+" "+fA(fS));},4))(a.id))(d6.placementToStr(fJ.$0[2])))(fJ.$0[0]))(fJ.$0[1]),fG))),d5.addAttribute("data-idd-common-visibility",(function(fP){return function(fQ){return fP(fA(fQ));};}(a.id))(fB.CommonVisibility),fI));fK=(fL=fB.Margin,fL==null?fH:d5.addAttribute("data-idd-style",(function(fP){return function(fQ){return fP("subplots-margin: "+fA(fQ)+"px; ");};}(a.id))(fL.$0),fH));fM=(fN=fB.SyncHorizontalAxes,fN==null?fK:d5.addAttribute("data-idd-horizontal-binding",(function(fP){return function(fQ){return fP(fA(fQ));};}(a.id))(fN.$0),fK));return{$:1,$0:d5.addDiv((fO=fB.SyncVerticalAxes,fO==null?fM:d5.addAttribute("data-idd-vertical-binding",(function(fP){return function(fQ){return fP(fA(fQ));};}(a.id))(fO.$0),fM)),fE)};};d7.slotGridToHtmlStructure=function(fB,fC,fD){var fE,fF;fE=fD.length;fF=fD.length?fD[0].length:0;return{$:0,$0:A.ofSeq(bc.rev(bc.map(function(fG){return{$:0,$0:A.ofSeq(bc.rev(bc.map(function(fH){return{$:0,$0:d7.slotToHtmlStructure(fB,fC,U.get2D(fD,fG,fH))};},F.range(0,fF-1))))};},F.range(0,fE-1))))};};d7.subplotsToSlotGrid=function(fB){var fC,fD,fE,fF,fG,fH;fC=fB.RowsCount;fD=fB.ColumnsCount;fE=(fF=fD*3,(fG=fh.Empty,(fH=U.init(fC*3,function(){return U.create(fF,fG);}),(fH.dims=2,fH))));bc.iter(function(fI){bc.iter(function(fJ){var fK,fL;fK=fB.Charts.get_Item([fI,fJ]);fK==null?void 0:(fL=fK.$0,U.set2D(fE,fI*3+1,fJ*3+1,{$:0,$0:d7.chartToBareChart(fL)}),fL.Title!==null?U.set2D(fE,fI*3,fJ*3+1,{$:2,$0:fL.Title}):void 0,U.set2D(fE,fI*3+1,fJ*3,{$:1,$0:fL.Yaxis,$1:eL.Left,$2:fL.Ylabel}),U.set2D(fE,fI*3+2,fJ*3+1,{$:1,$0:fL.Xaxis,$1:eL.Bottom,$2:fL.Xlabel}));},F.range(0,fD-1));},F.range(0,fC-1));return fE;};d7.slotToHtmlStructure=function(fB,fC,fD){var fE,fF,fG,fH,fI,fJ,fK,fL,fM,fN;function fO(fQ){var fR,fS,fT;return fE!==null?d5.addDiv(fF.$==3||(fF.$==1?false:fF.$!=0)?(fS=d6.vertAxisLabelToHtmlStructue(fE,fF),d5.addAttribute("style",(function(fU){return function(fV){return fU("height: "+fA(fV)+"px; position: relative;");};}(a.id))(fC),fS)):(fT=d6.horAxisLabelToHtmlStructure(fE,fF),d5.addAttribute("style",(function(fU){return function(fV){return fU("width: "+fA(fV)+"px;");};}(a.id))(fB),fT)),fQ):fQ;}function fP(fQ){var fR,fS,fT;fR=d6.axisToHtmlStructure(fG,fF);return fR==null?fQ:(fS=fR.$0[0],d5.addDiv(fF.$==3?d5.addAttribute("class","idd-subplots-slot-right",fF.$==3||(fF.$==1?false:fF.$!=0)?d5.addAttribute("style",(function(fU){return function(fV){return fU("height: "+fA(fV)+"px;");};}(a.id))(fC),fS):d5.addAttribute("style",(function(fU){return function(fV){return fU("width: "+fA(fV)+"px;");};}(a.id))(fB),fS)):fF.$==1?d5.addAttribute("class","idd-subplots-slot-top",fF.$==3||(fF.$==1?false:fF.$!=0)?d5.addAttribute("style",(function(fU){return function(fV){return fU("height: "+fA(fV)+"px;");};}(a.id))(fC),fS):d5.addAttribute("style",(function(fU){return function(fV){return fU("width: "+fA(fV)+"px;");};}(a.id))(fB),fS)):fF.$==0?d5.addAttribute("class","idd-subplots-slot-bottom",fF.$==3||(fF.$==1?false:fF.$!=0)?d5.addAttribute("style",(function(fU){return function(fV){return fU("height: "+fA(fV)+"px;");};}(a.id))(fC),fS):d5.addAttribute("style",(function(fU){return function(fV){return fU("width: "+fA(fV)+"px;");};}(a.id))(fB),fS)):d5.addAttribute("class","idd-subplots-slot-left",fF.$==3||(fF.$==1?false:fF.$!=0)?d5.addAttribute("style",(function(fU){return function(fV){return fU("height: "+fA(fV)+"px;");};}(a.id))(fC),fS):d5.addAttribute("style",(function(fU){return function(fV){return fU("width: "+fA(fV)+"px;");};}(a.id))(fB),fS)),fQ));}return fD.$==1?(fE=fD.$2,(fF=fD.$1,(fG=fD.$0,(fH=d5.createDiv(),{$:1,$0:fF.$==2?d5.addAttribute("class","idd-subplots-margin-left",fP(fO(d5.addAttribute("style",(function(fQ){return function(fR){return fQ("height: "+fA(fR)+"px; display: flex; justify-content: flex-end;");};}(a.id))(fC),fH)))):fF.$==0?d5.addAttribute("class","idd-subplots-margin-bottom",fO(fP(d5.addAttribute("style",(function(fQ){return function(fR){return fQ("width: "+fA(fR)+"px; display: flex; flex-direction: column; justify-content: flex-start; margin-left: auto; margin-right: auto;");};}(a.id))(fB),fH)))):F.FailWith("Not supported exception")})))):fD.$==0?(fI=fD.$0,(fJ=d6.addVisibleRegionInfo(fI.VisibleRegion,(new y.New([])).Add("data-idd-plot","plot").Add("class","idd-subplot").Add("style",(((fu.Curried3(function(fQ,fR,fS){return fQ("height: "+fA(fR)+"px; width: "+fA(fS)+"px;");}))(a.id))(fC))(fB)),new y.New([])),(fK=bc.fold(function(fQ,fR){return d5.addDiv(d6.plotToDiv(fR),fQ);},d6.gridLinesToHtmlStructure(fI.GridLines,null,null,d5.addDiv(d5.addAttribute("data-idd-plot","subplots-trap",d5.createDiv()),d5.createDiv())),fI.Plots),(fL=fJ[1].Add("isLegendVisible",d6.getEffectiveLegendvisibility(fI.IsLegendEnabled,fI.Plots)?"true":"false"),(fM=fJ[0].Add("data-idd-navigation-enabled",fI.IsNavigationEnabled?"true":"false"),(fN=d6.createStyleAttributes(fL),{$:1,$0:d6.addAttributes(fM.Add(fN[0],fN[1]),fK)})))))):fD.$==2?{$:1,$0:d5.addAttribute("class","idd-subplot-title",d5.addText(fD.$0,d5.createDiv()))}:e8.Empty;};d7.chartToBareChart=function(fB){return fp.New(fB.GridLines,fB.Plots,fB.IsLegendEnabled,fB.IsNavigationEnabled,fB.IsTooltipPlotCoordsEnabled,fB.VisibleRegion);};d8.Empty=function(){eN.$cctor();return eN.Empty;};d8.addPolyline=function(fB,fC){return d_.New(fC.Width,fC.Height,fC.Title,fC.Xlabel,fC.Xaxis,fC.Ylabel,fC.Yaxis,fC.GridLines,new B({$:1,$0:{$:0,$0:fB},$1:fC.Plots}),fC.IsLegendEnabled,fC.IsNavigationEnabled,fC.IsTooltipPlotCoordsEnabled,fC.VisibleRegion,fC.TooltipDelay);};d8.addMarkers=function(fB,fC){return d_.New(fC.Width,fC.Height,fC.Title,fC.Xlabel,fC.Xaxis,fC.Ylabel,fC.Yaxis,fC.GridLines,new B({$:1,$0:{$:1,$0:fB},$1:fC.Plots}),fC.IsLegendEnabled,fC.IsNavigationEnabled,fC.IsTooltipPlotCoordsEnabled,fC.VisibleRegion,fC.TooltipDelay);};d8.setXlabel=function(fB,fC){return d_.New(fC.Width,fC.Height,fC.Title,fB,fC.Xaxis,fC.Ylabel,fC.Yaxis,fC.GridLines,fC.Plots,fC.IsLegendEnabled,fC.IsNavigationEnabled,fC.IsTooltipPlotCoordsEnabled,fC.VisibleRegion,fC.TooltipDelay);};d8.setYlabel=function(fB,fC){return d_.New(fC.Width,fC.Height,fC.Title,fC.Xlabel,fC.Xaxis,fB,fC.Yaxis,fC.GridLines,fC.Plots,fC.IsLegendEnabled,fC.IsNavigationEnabled,fC.IsTooltipPlotCoordsEnabled,fC.VisibleRegion,fC.TooltipDelay);};d8.setTitle=function(fB,fC){return d_.New(fC.Width,fC.Height,fB,fC.Xlabel,fC.Xaxis,fC.Ylabel,fC.Yaxis,fC.GridLines,fC.Plots,fC.IsLegendEnabled,fC.IsNavigationEnabled,fC.IsTooltipPlotCoordsEnabled,fC.VisibleRegion,fC.TooltipDelay);};d8.setVisibleRegion=function(fB,fC){return d_.New(fC.Width,fC.Height,fC.Title,fC.Xlabel,fC.Xaxis,fC.Ylabel,fC.Yaxis,fC.GridLines,fC.Plots,fC.IsLegendEnabled,fC.IsNavigationEnabled,fC.IsTooltipPlotCoordsEnabled,fB,fC.TooltipDelay);};d8.addHeatmap=function(fB,fC){return d_.New(fC.Width,fC.Height,fC.Title,fC.Xlabel,fC.Xaxis,fC.Ylabel,fC.Yaxis,fC.GridLines,new B({$:1,$0:{$:4,$0:fB},$1:fC.Plots}),fC.IsLegendEnabled,fC.IsNavigationEnabled,fC.IsTooltipPlotCoordsEnabled,fC.VisibleRegion,fC.TooltipDelay);};d8.createLabelledAxis=function(fB,fC){return{$:2,$0:eP.New(fB,fC,0,false)};};d8.createTiltedLabelledAxis=function(fB,fC,fD){return{$:2,$0:eP.New(fB,fC,fD,false)};};d8.setXaxis=function(fB,fC){return d_.New(fC.Width,fC.Height,fC.Title,fC.Xlabel,fB,fC.Ylabel,fC.Yaxis,fC.GridLines,fC.Plots,fC.IsLegendEnabled,fC.IsNavigationEnabled,fC.IsTooltipPlotCoordsEnabled,fC.VisibleRegion,fC.TooltipDelay);};d8.setLabelsVisibility=function(fB,fC){var fD;return fC.$==2?(fD=fC.$0,{$:2,$0:eP.New(fD.Ticks,fD.Labels,fD.Angle,fB)}):F.FailWith("Force labels visibility can be set only on a labelled axis");};d8.addHistogram=function(fB,fC){return d_.New(fC.Width,fC.Height,fC.Title,fC.Xlabel,fC.Xaxis,fC.Ylabel,fC.Yaxis,fC.GridLines,new B({$:1,$0:{$:3,$0:fB},$1:fC.Plots}),fC.IsLegendEnabled,fC.IsNavigationEnabled,fC.IsTooltipPlotCoordsEnabled,fC.VisibleRegion,fC.TooltipDelay);};d8.DefaultGridLines=function(){eN.$cctor();return eN.DefaultGridLines;};d9.Grey=function(){eO.$cctor();return eO.Grey;};d9.Black=function(){eO.$cctor();return eO.Black;};d9.parse=function(fB){var fC,fD,fE,fF,fG,fH,fI;function fJ(fK){var fL,fM;try{return{$:1,$0:a.parseInt(fK,16)&255};}catch(fN){if(fN instanceof eq||(fN instanceof fa||fN instanceof fb))fL=null;else throw fN;return fL;}}return(fD=fB.length===7&&fB[0]==="#"?(fE=fJ(dk.Substring(fB,1,2)),(fF=fJ(dk.Substring(fB,3,2)),(fG=fJ(dk.Substring(fB,5,2)),fE!=null&&fE.$==1&&(fF!=null&&fF.$==1&&(fG!=null&&fG.$==1&&(fH=[fG.$0,fF.$0,fE.$0],true)))?{$:1,$0:{$:1,$0:e9.New(fH[2],fH[1],fH[0])}}:null))):null,fD!=null&&fD.$==1?(fC=fD.$0,true):(fI=K.TryFind(fB,d9.namesToColours()),fI!=null&&fI.$==1&&(fC=fI.$0,true)))?{$:1,$0:fC}:null;};d9.Gray=function(){eO.$cctor();return eO.Gray;};d9.DarkGrey=function(){eO.$cctor();return eO.DarkGrey;};d9.namesToColours=function(){eO.$cctor();return eO.namesToColours;};d9.createColour=function(fB,fC,fD){return{$:1,$0:e9.New(fB,fC,fD)};};d_.New=function(fB,fC,fD,fE,fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO){return{Width:fB,Height:fC,Title:fD,Xlabel:fE,Xaxis:fF,Ylabel:fG,Yaxis:fH,GridLines:fI,Plots:fJ,IsLegendEnabled:fK,IsNavigationEnabled:fL,IsTooltipPlotCoordsEnabled:fM,VisibleRegion:fN,TooltipDelay:fO};};d$.Visible={$:0};d$.Automatic={$:1};eb.createHeatmap=function(fB,fC,fD){return eQ.New(null,fB,fC,fD,eR.Default,1);};eb.setPalette=function(fB,fC){return eQ.New(fC.Name,fC.X,fC.Y,fC.Data,fB,fC.Opacity);};eb.setName=function(fB,fC){return eQ.New(fB,fC.X,fC.Y,fC.Data,fC.Palette,fC.Opacity);};ec.init=function(fB,fC,fD){var fE,fF,fG,fH,fI;fE=U.zeroCreate2D(fB,fC);for(fF=0,fG=fB-1;fF<=fG;fF++){for(fH=0,fI=fC-1;fH<=fI;fH++)U.set2D(fE,fF,fH,fD(fF,fH));}return fE;};ed.createMarkers=function(fB,fC){return eS.New(null,fB,fC,10,eT.Default,eT.Default,ee.Box);};ed.setShape=function(fB,fC){return eS.New(fC.Name,fC.X,fC.Y,fC.Size,fC.FillColour,fC.BorderColour,fB);};ed.setFillColour=function(fB,fC){return eS.New(fC.Name,fC.X,fC.Y,fC.Size,fB,fC.BorderColour,fC.Shape);};ed.setSize=function(fB,fC){return eS.New(fC.Name,fC.X,fC.Y,fB,fC.FillColour,fC.BorderColour,fC.Shape);};ee.Circle={$:1};ee.Box={$:0};ef.createPolyline=function(fB,fC){return eU.New(null,fB,fC,eT.Default,1,eV.Butt,eW.Miter);};ef.setThickness=function(fB,fC){return eU.New(fC.Name,fC.X,fC.Y,fC.Colour,fB,fC.LineCap,fC.LineJoin);};ef.setStrokeColour=function(fB,fC){return eU.New(fC.Name,fC.X,fC.Y,fB,fC.Thickness,fC.LineCap,fC.LineJoin);};eg.createHistogram=function(fB){return eX.New(null,fB,eT.Default,30);};eg.setBinCount=function(fB,fC){return eX.New(fC.Name,fC.Samples,fC.Colour,fB);};eh.empty=function(){return eh.New([],new bd.New$5());};eh.add=function(fB,fC){var fD;fD=U.length(fB.to_species);fB.to_species.push(fC);fB.from_species.Add(fC,fD);return fD;};eh.index=function(fB,fC){return fB.from_species.ContainsKey(fC)?fB.from_species.get_Item(fC):eh.add(fB,fC);};eh.New=function(fB,fC){return{to_species:fB,from_species:fC};};ei.New=function(fB,fC,fD){return{init:fB,react_st:fC,index:fD};};ej.kwList=function(){eZ.$cctor();return eZ.kwList;};ek.add_multiples=function(fB,fC,fD){return A.unzip(A.map(function(fE){return fE.add_multiples(fB,fC);},fD));};ek.eval_label=function(fB,fC){return fC.$===0?A.ofArray([["","",di.empty(),""]]):A.collect(function(fD){var fE;fE=fD.simplify_assignments().eval_label(fB);return A.map2(function(fF,fG){return(function(fH){var fI,fJ;fI=fH[0];fJ=fH[1];return function(fK){return[fD.name,fI,fJ,fK[0]];};}(fF))(fG);},fD.eval_label(fB),fE);},fC);};ek.get_variables=function(fB){return db.remove_duplicates(function(fC,fD){return fC===fD;},A.collect(function(fC){return fC.get_variables();},fB));};ek.get_variable_dependencies=function(fB){return A.collect(function(fC){return A.map(function(fD){return A.choose(function(fE){return fE.$==0?{$:1,$0:fE.$0}:null;},fD);},fC.values);},A.map(function(fC){return fC.get_merge();},fB));};ek["eval"]=function(fB,fC){return fC.$===0?A.ofArray([["",di.empty()]]):A.collect(function(fD){return A.map(function(fE){return[fD.name,fE];},fD["eval"](fB));},fC);};el.New=function(fB,fC,fD){return{path_class:fB,commands:fC,path_label:fD};};em.New=function(fB,fC,fD,fE,fF){return{label_text:fB,label_anchor:fC,label_class:fD,letter_width:fE,label_dir:fF};};en.$cctor=function(){var fB;en.$cctor=a.ignore;function fC(fD){return" transform=\\"translate("+fD+")\\"";}en.pi=3.14159265359;en.origo=cD.New(0,0);en.pointradius=1.25;en.default_letter_width=8;en.fontsize=15;en.text_height=S.fontsize()+2;en.half_text_height=S.text_height()/2;en.translate_anchor_by=function(fD){function fE(fF){return S.translate_point_by(fD,fF);}return function(fF){return S.transform_anchor_by(fE,fF);};};en.translate_path_command_by=function(fD){function fE(fF){return S.translate_point_by(fD,fF);}return function(fF){return S.transform_path_command_by(fE,fF);};};en.translate_label_by=function(fD){function fE(fF){return S.translate_point_by(fD,fF);}return function(fF){return S.transform_label_by(fE,fF);};};en.translate_path_by=function(fD){function fE(fF){return S.translate_point_by(fD,fF);}return function(fF){return S.transform_path_by(fE,fF);};};en.translate_to_string=(fB=function(fD){return fC(S.point_to_string(fD));},function(fD){return S.on_option(fB,"",fD);});en.translate_group_by=function(fD){function fE(fF){return S.translate_point_by(fD,fF);}return function(fF){return S.transform_group_by(fE,fF);};};};cV.ode_solver_error=function(fB){throw new cX.New("ODE error: "+fB);};cV.negative_simulation=function(){throw new cX.New("Cannot evaluate a proportional-error noise model for non-positive simulation values.");};eo.Absent={$:0};ep.New=function(fB,fC,fD,fE,fF){return{x:fB,dt:fC,prevDt:fD,e:fE,k:fF};};eq=v.ArgumentException=fu.Class({},G,eq);eq.New$2=fu.Ctor(function(fB){this.message=fB;cG.setPrototypeOf(this,eq.prototype);},eq);es=er.SparseVector=fu.Class({get_Indices:function(){return this.indices;},get_Items:function(){return this.items;},get_Length:function(){return this.n;},minus:function(fB){function fC(fD,fE){return fD-fE;}return this.binary(function(fD){return function(fE){return fC(fD,fE);};},fB);},get_Count:function(){return this.count;},set_Item:function(fB,fC){var fD,fE,fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO,fP;if(fB<0||fB>=this.n)F.FailWith("index is out of range");else{fF=(fD=U.tryFindIndex(function(fQ){return fQ===fB;},c2.array(this.indices,{$:1,$0:0},{$:1,$0:this.count-1})),fD==null?U.forall(function(fQ){return fQ<fB;},c2.array(this.indices,{$:1,$0:0},{$:1,$0:this.count-1}))?~this.count:(fE=U.tryFindIndex(function(fQ){return fQ>fB;},c2.array(this.indices,{$:1,$0:0},{$:1,$0:this.count-1})),fE==null?-1:~fE.$0):fD.$0);if(fF>=0)U.set(this.items,fF,fC);else{fG=~fF;if(this.count>=U.length(this.items)){fH=fv.min(16,this.n-U.length(this.items));fI=U.create(this.indices.length+fH,0);fJ=U.create(this.items.length+fH,0);for(fK=0,fL=this.indices.length-1;fK<=fL;fK++)U.set(fI,fK,U.get(this.indices,fK));for(fM=0,fN=this.items.length-1;fM<=fN;fM++)U.set(fJ,fM,U.get(this.items,fM));this.items=fJ;this.indices=fI;for(fO=0,fP=this.count-fG-1;fO<=fP;fO++){U.set(this.indices,this.count-fO,U.get(this.indices,this.count-fO-1));U.set(this.items,this.count-fO,U.get(this.items,this.count-fO-1));}this.count=this.count+1;U.set(this.indices,fG,fB);U.set(this.items,fG,fC);}else void 0;}}},binary:function(fB,fC){var fD,fE,fF;function fG(fH,fI,fJ){var fK;fK=U.unzip(U.ofList(A.rev(fJ)));return new es.New$1(fK[1].concat(c2.array(fH.get_Items(),{$:1,$0:fI},{$:1,$0:fH.get_Count()-1})),fK[0].concat(c2.array(fH.get_Indices(),{$:1,$0:fI},{$:1,$0:fH.get_Count()-1})),fH.get_Length());}fD=this;!(this.get_Length()===fC.get_Length())?F.FailWith("Minus requires two vectors of the same length"):void 0;fE=this.get_Count();fF=fC.get_Count();return fE===0?new es.New$1(U.map(fB(0),fC.get_Items()),fC.get_Indices(),fC.get_Length()):fF===0?this:function(fH,fI,fJ){var fK,fL,fM,fN,fO,fP;while(true){fK=U.get(fD.get_Indices(),fH);fL=U.get(fC.get_Indices(),fI);fM=fK-fL;if(fM<0){fN=new B({$:1,$0:[fK,(fB(U.get(fD.get_Items(),fK)))(0)],$1:fJ});if(fH<fD.get_Count()-1){fH=fH+1;fJ=fN;}else return fG(fC,fI,fN);}else if(fM>0){fO=new B({$:1,$0:[fL,(fB(0))(U.get(fC.get_Items(),fL))],$1:fJ});if(fI<fC.get_Count()-1){fI=fI+1;fJ=fO;}else return fG(fD,fH,fO);}else if(fM===0){fP=new B({$:1,$0:[fK,(fB(U.get(fD.get_Items(),fH)))(U.get(fC.get_Items(),fI))],$1:fJ});if(fH<fD.get_Count()-1&&fI<fC.get_Count()-1){fH=fH+1;fI=fI+1;fJ=fP;}else return fH<fD.get_Count()-1?fG(fD,fH+1,fP):fG(fC,fI+1,fP);}else throw new fr.New("..\\\\Oslo.FSharp\\\\SparseVector.fs",97,16);}}(0,0,B.Empty);}},w,es);es.New$1=fu.Ctor(function(fB,fC,fD){w.New.call(this);this.n=fD;this.items=bk.Equals(fB,null)?F.FailWith("argument is null"):fB;this.indices=bk.Equals(fC,null)?F.FailWith("argument is null"):fC;this.count=U.sumBy(function(fE){return fE*fE;},this.items)===0?0:this.items.length;},es);bc.enumWhile=function(fB,fC){return{GetEnumerator:function(){return new dc.New(null,null,function(fD){var fE;while(true){fE=fD.s;if(bk.Equals(fE,null)){if(fB()){fD.s=da.Get(fC);fD=fD;}else return false;}else if(fE.MoveNext()){fD.c=fE.Current();return true;}else{fE.Dispose();fD.s=null;fD=fD;}}},function(fD){var fE;fE=fD.s;!bk.Equals(fE,null)?fE.Dispose():void 0;});}};};bc.enumUsing=function(fB,fC){return{GetEnumerator:function(){var fD,fE;try{fD=da.Get(fC(fB));}catch(fF){fE=fB;fE.Dispose();throw fF;}return new dc.New(null,null,function(fG){return fD.MoveNext()&&(fG.c=fD.Current(),true);},function(){var fG;fD.Dispose();fG=fB;fG.Dispose();});}};};cd.distance_from_xy=function(fB,fC,fD,fE){return fv.sqrt(fv.pow(fD-fB,2)+fv.pow(fE-fC,2));};cd.defaults=function(){e3.$cctor();return e3.defaults;};cd.to_string=function(fB){var fC;return"{ "+dk.concat("; ",A.filter(function(fD){return fD!=="";},A.ofArray([fB.random!==cd.defaults().random?(function(fD){return function(fE){return fD("random = "+dk.PadLeft(fE.toFixed(3),1));};}(a.id))(fB.random):"",(fC=fB.core,fC!=null&&fC.$==1?fC.$0.to_string():""),!bk.Equals(fB.points,cd.defaults().points)?"points = ["+dk.concat("; ",A.map(function(fD){return fD.to_string();},fB.points))+"]":"",!bk.Equals(fB.rectangles,cd.defaults().rectangles)?"rectangles = ["+dk.concat("; ",A.map(function(fD){return fD.to_string();},fB.rectangles))+"]":""])))+" }";};cd.default_rectangle=function(){e3.$cctor();return e3.default_rectangle;};cd.default_point=function(){e3.$cctor();return e3.default_point;};cd.default_core=function(){e3.$cctor();return e3.default_core;};cd.parser=function(){e3.$cctor();return e3.parser;};et=D.ParserBuilder=fu.Class({},w,et);et.New=fu.Ctor(function(){w.New.call(this);},et);eu.$cctor=function(){eu.$cctor=a.ignore;eu.empty=B.Empty;};ev.New=function(fB,fC,fD){return{id:fB,name:fC,listOfUnits:fD};};ew.New=function(fB,fC,fD,fE,fF,fG,fH,fI){return{id:fB,name:fC,compartmentType:fD,spatialDimensions:fE,size:fF,units:fG,outside:fH,constant:fI};};ex.New=function(fB,fC,fD,fE,fF,fG,fH,fI,fJ,fK,fL){return{id:fB,name:fC,speciesType:fD,compartment:fE,initialAmount:fF,initialConcentration:fG,substanceUnits:fH,hasOnlySubstanceUnits:fI,boundaryCondition:fJ,charge:fK,constant:fL};};ey.New=function(fB,fC,fD,fE,fF){return{id:fB,name:fC,value:fD,units:fE,constant:fF};};ez.New=function(fB,fC){return{symbol:fB,math:fC};};eA.New=function(fB,fC,fD,fE,fF,fG,fH){return{id:fB,name:fC,reversible:fD,fast:fE,listOfReactants:fF,listOfProducts:fG,kineticLaw:fH};};eB.New=function(fB,fC,fD,fE,fF){return{kind:fB,exponent:fC,scale:fD,multiplier:fE,offset:fF};};eC.New=function(fB,fC,fD,fE){return{id:fB,name:fC,species:fD,stoichiometry:fE};};eD.New=function(fB,fC){return{math:fB,listOfParameters:fC};};eE.Abs={$:2};eE.Ceiling={$:32};eE.Floor={$:5};eF.New=function(fB,fC,fD,fE,fF){return{name:fB,mle:fC,summary:fD,qsummary:fE,range:fF};};eG.New=function(fB,fC,fD,fE,fF){return{count:fB,min:fC,max:fD,mean:fE,variance:fF};};eH.New=function(fB,fC,fD,fE,fF,fG,fH){return{min:fB,lb95:fC,lb68:fD,median:fE,ub68:fF,ub95:fG,max:fH};};eI.New=function(fB,fC,fD){return{AIC:fB,BIC:fC,DIC:fD};};eJ.New=function(fB,fC){return{Attributes:fB,Children:fC};};eK.New=function(fB,fC){return{Key:fB,Value:fC};};eL.Left={$:2};eL.Bottom={$:0};eM.New=function(fB,fC,fD,fE,fF,fG,fH,fI,fJ,fK,fL){return{Title:fB,Charts:fC,PlotWidth:fD,PlotHeight:fE,RowsCount:fF,ColumnsCount:fG,ExternalLegendSource:fH,Margin:fI,CommonVisibility:fJ,SyncHorizontalAxes:fK,SyncVerticalAxes:fL};};eN.$cctor=function(){eN.$cctor=a.ignore;eN.DefaultGridLines={$:1,$0:d9.DarkGrey(),$1:1};eN.Empty=d_.New(800,600,null,null,{$:1,$0:true},null,{$:1,$0:true},d8.DefaultGridLines(),B.Empty,d$.Automatic,true,true,{$:0,$0:20},null);};eO.$cctor=function(){eO.$cctor=a.ignore;eO.namesToColours=(new y.New([])).Add("AliceBlue",d9.createColour(240&255,248&255,255&255)).Add("AntiqueWhite",d9.createColour(250&255,235&255,215&255)).Add("Aqua",d9.createColour(0&255,255&255,255&255)).Add("Aquamarine",d9.createColour(127&255,255&255,212&255)).Add("Azure",d9.createColour(240&255,255&255,255&255)).Add("Beige",d9.createColour(245&255,245&255,220&255)).Add("Bisque",d9.createColour(255&255,228&255,196&255)).Add("Black",d9.createColour(0&255,0&255,0&255)).Add("BlanchedAlmond",d9.createColour(255&255,235&255,205&255)).Add("Blue",d9.createColour(0&255,0&255,255&255)).Add("BlueViolet",d9.createColour(138&255,43&255,226&255)).Add("Brown",d9.createColour(165&255,42&255,42&255)).Add("BurlyWood",d9.createColour(222&255,184&255,135&255)).Add("CadetBlue",d9.createColour(95&255,158&255,160&255)).Add("Chartreuse",d9.createColour(127&255,255&255,0&255)).Add("Chocolate",d9.createColour(210&255,105&255,30&255)).Add("Coral",d9.createColour(255&255,127&255,80&255)).Add("CornflowerBlue",d9.createColour(100&255,149&255,237&255)).Add("Cornsilk",d9.createColour(255&255,248&255,220&255)).Add("Crimson",d9.createColour(220&255,20&255,60&255)).Add("Cyan",d9.createColour(0&255,255&255,255&255)).Add("DarkBlue",d9.createColour(0&255,0&255,139&255)).Add("DarkCyan",d9.createColour(0&255,139&255,139&255)).Add("DarkGoldenRod",d9.createColour(184&255,134&255,11&255)).Add("DarkGray",d9.createColour(169&255,169&255,169&255)).Add("DarkGrey",d9.createColour(169&255,169&255,169&255)).Add("DarkGreen",d9.createColour(0&255,100&255,0&255)).Add("DarkKhaki",d9.createColour(189&255,183&255,107&255)).Add("DarkMagenta",d9.createColour(139&255,0&255,139&255)).Add("DarkOliveGreen",d9.createColour(85&255,107&255,47&255)).Add("DarkOrange",d9.createColour(255&255,140&255,0&255)).Add("DarkOrchid",d9.createColour(153&255,50&255,204&255)).Add("DarkRed",d9.createColour(139&255,0&255,0&255)).Add("DarkSalmon",d9.createColour(233&255,150&255,122&255)).Add("DarkSeaGreen",d9.createColour(143&255,188&255,143&255)).Add("DarkSlateBlue",d9.createColour(72&255,61&255,139&255)).Add("DarkSlateGray",d9.createColour(47&255,79&255,79&255)).Add("DarkSlateGrey",d9.createColour(47&255,79&255,79&255)).Add("DarkTurquoise",d9.createColour(0&255,206&255,209&255)).Add("DarkViolet",d9.createColour(148&255,0&255,211&255)).Add("DeepPink",d9.createColour(255&255,20&255,147&255)).Add("DeepSkyBlue",d9.createColour(0&255,191&255,255&255)).Add("DimGray",d9.createColour(105&255,105&255,105&255)).Add("DimGrey",d9.createColour(105&255,105&255,105&255)).Add("DodgerBlue",d9.createColour(30&255,144&255,255&255)).Add("FireBrick",d9.createColour(178&255,34&255,34&255)).Add("FloralWhite",d9.createColour(255&255,250&255,240&255)).Add("ForestGreen",d9.createColour(34&255,139&255,34&255)).Add("Fuchsia",d9.createColour(255&255,0&255,255&255)).Add("Gainsboro",d9.createColour(220&255,220&255,220&255)).Add("GhostWhite",d9.createColour(248&255,248&255,255&255)).Add("Gold",d9.createColour(255&255,215&255,0&255)).Add("GoldenRod",d9.createColour(218&255,165&255,32&255)).Add("Gray",d9.createColour(128&255,128&255,128&255)).Add("Grey",d9.createColour(128&255,128&255,128&255)).Add("Green",d9.createColour(0&255,128&255,0&255)).Add("GreenYellow",d9.createColour(173&255,255&255,47&255)).Add("HoneyDew",d9.createColour(240&255,255&255,240&255)).Add("HotPink",d9.createColour(255&255,105&255,180&255)).Add("IndianRed",d9.createColour(205&255,92&255,92&255)).Add("Indigo",d9.createColour(75&255,0&255,130&255)).Add("Ivory",d9.createColour(255&255,255&255,240&255)).Add("Khaki",d9.createColour(240&255,230&255,140&255)).Add("Lavender",d9.createColour(230&255,230&255,250&255)).Add("LavenderBlush",d9.createColour(255&255,240&255,245&255)).Add("LawnGreen",d9.createColour(124&255,252&255,0&255)).Add("LemonChiffon",d9.createColour(255&255,250&255,205&255)).Add("LightBlue",d9.createColour(173&255,216&255,230&255)).Add("LightCoral",d9.createColour(240&255,128&255,128&255)).Add("LightCyan",d9.createColour(224&255,255&255,255&255)).Add("LightGoldenRodYellow",d9.createColour(250&255,250&255,210&255)).Add("LightGray",d9.createColour(211&255,211&255,211&255)).Add("LightGrey",d9.createColour(211&255,211&255,211&255)).Add("LightGreen",d9.createColour(144&255,238&255,144&255)).Add("LightPink",d9.createColour(255&255,182&255,193&255)).Add("LightSalmon",d9.createColour(255&255,160&255,122&255)).Add("LightSeaGreen",d9.createColour(32&255,178&255,170&255)).Add("LightSkyBlue",d9.createColour(135&255,206&255,250&255)).Add("LightSlateGray",d9.createColour(119&255,136&255,153&255)).Add("LightSlateGrey",d9.createColour(119&255,136&255,153&255)).Add("LightSteelBlue",d9.createColour(176&255,196&255,222&255)).Add("LightYellow",d9.createColour(255&255,255&255,224&255)).Add("Lime",d9.createColour(0&255,255&255,0&255)).Add("LimeGreen",d9.createColour(50&255,205&255,50&255)).Add("Linen",d9.createColour(250&255,240&255,230&255)).Add("Magenta",d9.createColour(255&255,0&255,255&255)).Add("Maroon",d9.createColour(128&255,0&255,0&255)).Add("MediumAquaMarine",d9.createColour(102&255,205&255,170&255)).Add("MediumBlue",d9.createColour(0&255,0&255,205&255)).Add("MediumOrchid",d9.createColour(186&255,85&255,211&255)).Add("MediumPurple",d9.createColour(147&255,112&255,219&255)).Add("MediumSeaGreen",d9.createColour(60&255,179&255,113&255)).Add("MediumSlateBlue",d9.createColour(123&255,104&255,238&255)).Add("MediumSpringGreen",d9.createColour(0&255,250&255,154&255)).Add("MediumTurquoise",d9.createColour(72&255,209&255,204&255)).Add("MediumVioletRed",d9.createColour(199&255,21&255,133&255)).Add("MidnightBlue",d9.createColour(25&255,25&255,112&255)).Add("MintCream",d9.createColour(245&255,255&255,250&255)).Add("MistyRose",d9.createColour(255&255,228&255,225&255)).Add("Moccasin",d9.createColour(255&255,228&255,181&255)).Add("NavajoWhite",d9.createColour(255&255,222&255,173&255)).Add("Navy",d9.createColour(0&255,0&255,128&255)).Add("OldLace",d9.createColour(253&255,245&255,230&255)).Add("Olive",d9.createColour(128&255,128&255,0&255)).Add("OliveDrab",d9.createColour(107&255,142&255,35&255)).Add("Orange",d9.createColour(255&255,165&255,0&255)).Add("OrangeRed",d9.createColour(255&255,69&255,0&255)).Add("Orchid",d9.createColour(218&255,112&255,214&255)).Add("PaleGoldenRod",d9.createColour(238&255,232&255,170&255)).Add("PaleGreen",d9.createColour(152&255,251&255,152&255)).Add("PaleTurquoise",d9.createColour(175&255,238&255,238&255)).Add("PaleVioletRed",d9.createColour(219&255,112&255,147&255)).Add("PapayaWhip",d9.createColour(255&255,239&255,213&255)).Add("PeachPuff",d9.createColour(255&255,218&255,185&255)).Add("Peru",d9.createColour(205&255,133&255,63&255)).Add("Pink",d9.createColour(255&255,192&255,203&255)).Add("Plum",d9.createColour(221&255,160&255,221&255)).Add("PowderBlue",d9.createColour(176&255,224&255,230&255)).Add("Purple",d9.createColour(128&255,0&255,128&255)).Add("RebeccaPurple",d9.createColour(102&255,51&255,153&255)).Add("Red",d9.createColour(255&255,0&255,0&255)).Add("RosyBrown",d9.createColour(188&255,143&255,143&255)).Add("RoyalBlue",d9.createColour(65&255,105&255,225&255)).Add("SaddleBrown",d9.createColour(139&255,69&255,19&255)).Add("Salmon",d9.createColour(250&255,128&255,114&255)).Add("SandyBrown",d9.createColour(244&255,164&255,96&255)).Add("SeaGreen",d9.createColour(46&255,139&255,87&255)).Add("SeaShell",d9.createColour(255&255,245&255,238&255)).Add("Sienna",d9.createColour(160&255,82&255,45&255)).Add("Silver",d9.createColour(192&255,192&255,192&255)).Add("SkyBlue",d9.createColour(135&255,206&255,235&255)).Add("SlateBlue",d9.createColour(106&255,90&255,205&255)).Add("SlateGray",d9.createColour(112&255,128&255,144&255)).Add("SlateGrey",d9.createColour(112&255,128&255,144&255)).Add("Snow",d9.createColour(255&255,250&255,250&255)).Add("SpringGreen",d9.createColour(0&255,255&255,127&255)).Add("SteelBlue",d9.createColour(70&255,130&255,180&255)).Add("Tan",d9.createColour(210&255,180&255,140&255)).Add("Teal",d9.createColour(0&255,128&255,128&255)).Add("Thistle",d9.createColour(216&255,191&255,216&255)).Add("Tomato",d9.createColour(255&255,99&255,71&255)).Add("Turquoise",d9.createColour(64&255,224&255,208&255)).Add("Violet",d9.createColour(238&255,130&255,238&255)).Add("Wheat",d9.createColour(245&255,222&255,179&255)).Add("White",d9.createColour(255&255,255&255,255&255)).Add("WhiteSmoke",d9.createColour(245&255,245&255,245&255)).Add("Yellow",d9.createColour(255&255,255&255,0&255)).Add("YellowGreen",d9.createColour(154&255,205&255,50&255));eO.AliceBlue=d9.namesToColours().get_Item("AliceBlue");eO.AntiqueWhite=d9.namesToColours().get_Item("AntiqueWhite");eO.Aqua=d9.namesToColours().get_Item("Aqua");eO.Aquamarine=d9.namesToColours().get_Item("Aquamarine");eO.Azure=d9.namesToColours().get_Item("Azure");eO.Beige=d9.namesToColours().get_Item("Beige");eO.Bisque=d9.namesToColours().get_Item("Bisque");eO.Black=d9.namesToColours().get_Item("Black");eO.BlanchedAlmond=d9.namesToColours().get_Item("BlanchedAlmond");eO.Blue=d9.namesToColours().get_Item("Blue");eO.BlueViolet=d9.namesToColours().get_Item("BlueViolet");eO.Brown=d9.namesToColours().get_Item("Brown");eO.BurlyWood=d9.namesToColours().get_Item("BurlyWood");eO.CadetBlue=d9.namesToColours().get_Item("CadetBlue");eO.Chartreuse=d9.namesToColours().get_Item("Chartreuse");eO.Chocolate=d9.namesToColours().get_Item("Chocolate");eO.Coral=d9.namesToColours().get_Item("Coral");eO.CornflowerBlue=d9.namesToColours().get_Item("CornflowerBlue");eO.Cornsilk=d9.namesToColours().get_Item("Cornsilk");eO.Crimson=d9.namesToColours().get_Item("Crimson");eO.Cyan=d9.namesToColours().get_Item("Cyan");eO.DarkBlue=d9.namesToColours().get_Item("DarkBlue");eO.DarkCyan=d9.namesToColours().get_Item("DarkCyan");eO.DarkGoldenRod=d9.namesToColours().get_Item("DarkGoldenRod");eO.DarkGray=d9.namesToColours().get_Item("DarkGray");eO.DarkGrey=d9.namesToColours().get_Item("DarkGrey");eO.DarkGreen=d9.namesToColours().get_Item("DarkGreen");eO.DarkKhaki=d9.namesToColours().get_Item("DarkKhaki");eO.DarkMagenta=d9.namesToColours().get_Item("DarkMagenta");eO.DarkOliveGreen=d9.namesToColours().get_Item("DarkOliveGreen");eO.DarkOrange=d9.namesToColours().get_Item("DarkOrange");eO.DarkOrchid=d9.namesToColours().get_Item("DarkOrchid");eO.DarkRed=d9.namesToColours().get_Item("DarkRed");eO.DarkSalmon=d9.namesToColours().get_Item("DarkSalmon");eO.DarkSeaGreen=d9.namesToColours().get_Item("DarkSeaGreen");eO.DarkSlateBlue=d9.namesToColours().get_Item("DarkSlateBlue");eO.DarkSlateGray=d9.namesToColours().get_Item("DarkSlateGray");eO.DarkSlateGrey=d9.namesToColours().get_Item("DarkSlateGrey");eO.DarkTurquoise=d9.namesToColours().get_Item("DarkTurquoise");eO.DarkViolet=d9.namesToColours().get_Item("DarkViolet");eO.DeepPink=d9.namesToColours().get_Item("DeepPink");eO.DeepSkyBlue=d9.namesToColours().get_Item("DeepSkyBlue");eO.DimGray=d9.namesToColours().get_Item("DimGray");eO.DimGrey=d9.namesToColours().get_Item("DimGrey");eO.DodgerBlue=d9.namesToColours().get_Item("DodgerBlue");eO.FireBrick=d9.namesToColours().get_Item("FireBrick");eO.FloralWhite=d9.namesToColours().get_Item("FloralWhite");eO.ForestGreen=d9.namesToColours().get_Item("ForestGreen");eO.Fuchsia=d9.namesToColours().get_Item("Fuchsia");eO.Gainsboro=d9.namesToColours().get_Item("Gainsboro");eO.GhostWhite=d9.namesToColours().get_Item("GhostWhite");eO.Gold=d9.namesToColours().get_Item("Gold");eO.GoldenRod=d9.namesToColours().get_Item("GoldenRod");eO.Gray=d9.namesToColours().get_Item("Gray");eO.Grey=d9.namesToColours().get_Item("Grey");eO.Green=d9.namesToColours().get_Item("Green");eO.GreenYellow=d9.namesToColours().get_Item("GreenYellow");eO.HoneyDew=d9.namesToColours().get_Item("HoneyDew");eO.HotPink=d9.namesToColours().get_Item("HotPink");eO.IndianRed=d9.namesToColours().get_Item("IndianRed");eO.Indigo=d9.namesToColours().get_Item("Indigo");eO.Ivory=d9.namesToColours().get_Item("Ivory");eO.Khaki=d9.namesToColours().get_Item("Khaki");eO.Lavender=d9.namesToColours().get_Item("Lavender");eO.LavenderBlush=d9.namesToColours().get_Item("LavenderBlush");eO.LawnGreen=d9.namesToColours().get_Item("LawnGreen");eO.LemonChiffon=d9.namesToColours().get_Item("LemonChiffon");eO.LightBlue=d9.namesToColours().get_Item("LightBlue");eO.LightCoral=d9.namesToColours().get_Item("LightCoral");eO.LightCyan=d9.namesToColours().get_Item("LightCyan");eO.LightGoldenRodYellow=d9.namesToColours().get_Item("LightGoldenRodYellow");eO.LightGray=d9.namesToColours().get_Item("LightGray");eO.LightGrey=d9.namesToColours().get_Item("LightGrey");eO.LightGreen=d9.namesToColours().get_Item("LightGreen");eO.LightPink=d9.namesToColours().get_Item("LightPink");eO.LightSalmon=d9.namesToColours().get_Item("LightSalmon");eO.LightSeaGreen=d9.namesToColours().get_Item("LightSeaGreen");eO.LightSkyBlue=d9.namesToColours().get_Item("LightSkyBlue");eO.LightSlateGray=d9.namesToColours().get_Item("LightSlateGray");eO.LightSlateGrey=d9.namesToColours().get_Item("LightSlateGrey");eO.LightSteelBlue=d9.namesToColours().get_Item("LightSteelBlue");eO.LightYellow=d9.namesToColours().get_Item("LightYellow");eO.Lime=d9.namesToColours().get_Item("Lime");eO.LimeGreen=d9.namesToColours().get_Item("LimeGreen");eO.Linen=d9.namesToColours().get_Item("Linen");eO.Magenta=d9.namesToColours().get_Item("Magenta");eO.Maroon=d9.namesToColours().get_Item("Maroon");eO.MediumAquaMarine=d9.namesToColours().get_Item("MediumAquaMarine");eO.MediumBlue=d9.namesToColours().get_Item("MediumBlue");eO.MediumOrchid=d9.namesToColours().get_Item("MediumOrchid");eO.MediumPurple=d9.namesToColours().get_Item("MediumPurple");eO.MediumSeaGreen=d9.namesToColours().get_Item("MediumSeaGreen");eO.MediumSlateBlue=d9.namesToColours().get_Item("MediumSlateBlue");eO.MediumSpringGreen=d9.namesToColours().get_Item("MediumSpringGreen");eO.MediumTurquoise=d9.namesToColours().get_Item("MediumTurquoise");eO.MediumVioletRed=d9.namesToColours().get_Item("MediumVioletRed");eO.MidnightBlue=d9.namesToColours().get_Item("MidnightBlue");eO.MintCream=d9.namesToColours().get_Item("MintCream");eO.MistyRose=d9.namesToColours().get_Item("MistyRose");eO.Moccasin=d9.namesToColours().get_Item("Moccasin");eO.NavajoWhite=d9.namesToColours().get_Item("NavajoWhite");eO.Navy=d9.namesToColours().get_Item("Navy");eO.OldLace=d9.namesToColours().get_Item("OldLace");eO.Olive=d9.namesToColours().get_Item("Olive");eO.OliveDrab=d9.namesToColours().get_Item("OliveDrab");eO.Orange=d9.namesToColours().get_Item("Orange");eO.OrangeRed=d9.namesToColours().get_Item("OrangeRed");eO.Orchid=d9.namesToColours().get_Item("Orchid");eO.PaleGoldenRod=d9.namesToColours().get_Item("PaleGoldenRod");eO.PaleGreen=d9.namesToColours().get_Item("PaleGreen");eO.PaleTurquoise=d9.namesToColours().get_Item("PaleTurquoise");eO.PaleVioletRed=d9.namesToColours().get_Item("PaleVioletRed");eO.PapayaWhip=d9.namesToColours().get_Item("PapayaWhip");eO.PeachPuff=d9.namesToColours().get_Item("PeachPuff");eO.Peru=d9.namesToColours().get_Item("Peru");eO.Pink=d9.namesToColours().get_Item("Pink");eO.Plum=d9.namesToColours().get_Item("Plum");eO.PowderBlue=d9.namesToColours().get_Item("PowderBlue");eO.Purple=d9.namesToColours().get_Item("Purple");eO.RebeccaPurple=d9.namesToColours().get_Item("RebeccaPurple");eO.Red=d9.namesToColours().get_Item("Red");eO.RosyBrown=d9.namesToColours().get_Item("RosyBrown");eO.RoyalBlue=d9.namesToColours().get_Item("RoyalBlue");eO.SaddleBrown=d9.namesToColours().get_Item("SaddleBrown");eO.Salmon=d9.namesToColours().get_Item("Salmon");eO.SandyBrown=d9.namesToColours().get_Item("SandyBrown");eO.SeaGreen=d9.namesToColours().get_Item("SeaGreen");eO.SeaShell=d9.namesToColours().get_Item("SeaShell");eO.Sienna=d9.namesToColours().get_Item("Sienna");eO.Silver=d9.namesToColours().get_Item("Silver");eO.SkyBlue=d9.namesToColours().get_Item("SkyBlue");eO.SlateBlue=d9.namesToColours().get_Item("SlateBlue");eO.SlateGray=d9.namesToColours().get_Item("SlateGray");eO.SlateGrey=d9.namesToColours().get_Item("SlateGrey");eO.Snow=d9.namesToColours().get_Item("Snow");eO.SpringGreen=d9.namesToColours().get_Item("SpringGreen");eO.SteelBlue=d9.namesToColours().get_Item("SteelBlue");eO.Tan=d9.namesToColours().get_Item("Tan");eO.Teal=d9.namesToColours().get_Item("Teal");eO.Thistle=d9.namesToColours().get_Item("Thistle");eO.Tomato=d9.namesToColours().get_Item("Tomato");eO.Turquoise=d9.namesToColours().get_Item("Turquoise");eO.Violet=d9.namesToColours().get_Item("Violet");eO.Wheat=d9.namesToColours().get_Item("Wheat");eO.White=d9.namesToColours().get_Item("White");eO.WhiteSmoke=d9.namesToColours().get_Item("WhiteSmoke");eO.Yellow=d9.namesToColours().get_Item("Yellow");eO.YellowGreen=d9.namesToColours().get_Item("YellowGreen");};eP.New=function(fB,fC,fD,fE){return{Ticks:fB,Labels:fC,Angle:fD,ForceLabelsVisibility:fE};};eQ.New=function(fB,fC,fD,fE,fF,fG){return{Name:fB,X:fC,Y:fD,Data:fE,Palette:fF,Opacity:fG};};eR.Default={$:1};eS.New=function(fB,fC,fD,fE,fF,fG,fH){return{Name:fB,X:fC,Y:fD,Size:fE,FillColour:fF,BorderColour:fG,Shape:fH};};eT.Default={$:0};eU.New=function(fB,fC,fD,fE,fF,fG,fH){return{Name:fB,X:fC,Y:fD,Colour:fE,Thickness:fF,LineCap:fG,LineJoin:fH};};eV.Butt={$:0};eW.Miter={$:2};eX.New=function(fB,fC,fD,fE){return{Name:fB,Samples:fC,Colour:fD,BinCount:fE};};eY.parse=function(fB,fC){var fD,fE,fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO,fP,fQ,fR,fS,fT,fU,fV,fW,fX,fY,fZ,f0,f1,f2,f3,f4,f5,f6,f7,f8,f9,f_;function f$(gd){return{$:1,$0:gd};}function ga(gd){return{$:0,$0:gd};}function gb(gd,ge){return{$:2,$0:gd,$1:ge};}function gc(gd,ge){return dz.op_LessBarGreater(fO,fM,gd,ge);}fD=R.zero();fE=R.one();fF=(fG=D.name_kw(ej.kwList()),function(gd){return dz.op_DotGreaterGreater(fG,D.spaces(),gd[0],gd[1]);});fH=R.parse(fF);fI=R.parse(co.parse(fB));fJ=D.kw(",");fK=(fL=V.parse(fB,fH,fD),function(gd){return dz.op_BarGreaterGreater(fL,f$,gd[0],gd[1]);});fM=(fN=cc.parse(fB,fH,fI,fE),function(gd){return dz.op_BarGreaterGreater(fN,ga,gd[0],gd[1]);});fO=(fP=(fQ=(fR=D.pTry((fS=D.kw("("),function(gd){return dz.op_DotGreaterGreater(fF,fS,gd[0],gd[1]);})),(fT=D.sepBy(fH,fJ),function(gd){return dz.op_DotGreaterGreaterDot(fR,fT,gd[0],gd[1]);})),(fU=D.kw(")"),function(gd){return dz.op_DotGreaterGreater(fQ,fU,gd[0],gd[1]);})),function(gd){return dz.op_BarGreaterGreater(fP,function(ge){return gb(ge[0],ge[1]);},gd[0],gd[1]);});fV=function(gd){return dz.op_LessBarGreater(function(ge){return gc(ge[0],ge[1]);},fK,gd[0],gd[1]);};fW=D.kw("|");fX=(fY=(fZ=D.many((f0=(f1=(f2=(f3=D.kw("module"),function(gd){return dz.op_GreaterGreaterDot(f3,D.name(),gd[0],gd[1]);}),(f4=D.paren(D.sepBy(D.name(),fJ)),function(gd){return dz.op_DotGreaterGreaterDot(f2,f4,gd[0],gd[1]);})),(f5=D.kw("="),function(gd){return dz.op_DotGreaterGreater(f1,f5,gd[0],gd[1]);})),(f6=D.braces((f7=D.opt(fW),(f8=D.sepBy(fV,fW),function(gd){return dz.op_GreaterGreaterDot(f7,f8,gd[0],gd[1]);}))),function(gd){return dz.op_DotGreaterGreaterDot(f0,f6,gd[0],gd[1]);}))),function(gd){return dz.op_GreaterGreaterDot(D.spaces(),fZ,gd[0],gd[1]);}),(f9=D.opt(fW),function(gd){return dz.op_DotGreaterGreater(fY,f9,gd[0],gd[1]);}));f_=D.sepBy(fV,fW);return function(gd){return dz.op_DotGreaterGreaterDot(fX,f_,gd[0],gd[1]);};};eY.convert_instructions=function(fB,fC){var fD;function fE(fF,fG){return function(fH){var fI,fJ,fK,fL,fM,fN,fO;function fP(fZ,f0){return fZ[0]===fI&&fJ.get_Length()===fZ[1].get_Length();}function fQ(fZ,f0){return fZ[0]===fI;}function fR(fZ){var f0;function f1(f3){return f3[0];}function f2(f3){return fZ===f3;}f0=bc.tryFind(function(f3){return f2(f1(f3));},fO);return f0==null?null:{$:1,$0:f0.$0[1]};}function fS(fZ,f0){var f1,f2;f1=fR(f0);return f1==null?f0:(f2=f1.$0,f2.$==0?f2.$0:F.FailWith(((((fu.Curried(function(f3,f4,f5,f6){return f3("Module invokation failed: cannot substitute expression \\""+_2.toSafe(f4)+"\\" for \\""+_2.toSafe(f5)+"\\" in module \\""+_2.toSafe(f6)+"\\"");},4))(a.id))(R.to_string(a.id,f2)))(f0))(fZ)));}function fT(fZ,f0){return be.New(fS(fZ,f0.name));}function fU(fZ){var f0;f0=fR(fZ);return f0!=null&&f0.$==1?f0.$0:{$:0,$0:fZ};}function fV(fZ,f0){function f1(f2){var f3,f4;return f2.$==0?(f3=f2.$0,(f4=fR(f3),f4!=null&&f4.$==1?R.map(function(f5){return{$:0,$0:f5};},f4.$0):{$:0,$0:{$:0,$0:f3}})):f2.$==1?{$:0,$0:{$:1,$0:fS(fZ,f2.$0)}}:f2.$==2?{$:0,$0:{$:2,$0:fT(fZ,f2.$0)}}:{$:0,$0:co.Time};}return f0.map(function(f2){return R.expand(fU,f2);},function(f2){return R.expand(f1,f2);});}function fW(fZ,f0){var f1;return cc.create$4(b$.map(function(f2){return fT(fZ,f2);},f0.catalysts),b$.map(function(f2){return fT(fZ,f2);},f0.reactants),(f1=f0.reverse,f1!=null&&f1.$==1?{$:1,$0:fV(fZ,f1.$0)}:null),fV(fZ,f0.rate),b$.map(function(f2){return fT(fZ,f2);},f0.products));}function fX(fZ,f0){var f1,f2;f1=fT(fZ,f0.species);return V.create$4(f0.constant,R.expand(fU,f0.value),f1,(f2=f0.time,f2==null?null:{$:1,$0:R.expand(fU,f2.$0)}),f0.spatial);}function fY(fZ,f0){var f1,f2;f1=f0[0];f2=f0[1];return function(f3){var f4;return f3.$==1?[f1,new B({$:1,$0:fX(fZ,f3.$0),$1:f2})]:f3.$==2?(f4=A.map(function(f5){return R.expand(fU,f5);},f3.$1),(function(f5){return fE(f5[0],f5[1]);}([f1,f2]))({$:2,$0:f3.$0,$1:f4})):[new B({$:1,$0:fW(fZ,f3.$0),$1:f1}),f2];};}return fH.$==1?[fF,new B({$:1,$0:fH.$0,$1:fG})]:fH.$==2?(fI=fH.$0,(fJ=fH.$1,(fK=(fL=bc.tryFind(function(fZ){return fP(fZ[0],fZ[1]);},fB),fL==null?(fM=(((fu.Curried3(function(fZ,f0,f1){return fZ(_2.toSafe(f0)+"("+_2.toSafe(f1)+")");}))(a.id))(fI))(dk.concat(", ",A.map(function(fZ){return R.to_string(a.id,fZ);},fJ))),F.FailWith((fN=bc.tryFind(function(fZ){return fQ(fZ[0],fZ[1]);},fB),fN!=null&&fN.$==1?(((fu.Curried3(function(fZ,f0,f1){return fZ("No module definition with "+fA(f0)+" arguments found for invokation \\""+_2.toSafe(f1)+"\\"");}))(a.id))(fJ.get_Length()))(fM):(function(fZ){return function(f0){return fZ("No module definition found for module invocation \\""+_2.toSafe(f0)+"\\"");};}(a.id))(fM)))):[fL.$0[0][1],fL.$0[1]]),(fO=A.zip(fK[0],fJ),bc.fold(function(fZ,f0){return(function(f1){return fY(fI,f1);}(fZ))(f0);},[fF,fG],fK[1]))))):[new B({$:1,$0:fH.$0,$1:fF}),fG];};}fD=bc.fold(function(fF,fG){return(function(fH){return fE(fH[0],fH[1]);}(fF))(fG);},[B.Empty,B.Empty],fC);return[A.rev(fD[0]),A.rev(fD[1])];};eZ.$cctor=function(){eZ.$cctor=a.ignore;eZ.kwList=A.ofArray(["module","system","inference","directive","with"]);};e0.parse_list=function(fB,fC){var fD,fE;return D.sepBy((fD=D.kw("directive"),(fE=e0.parse(fB,fC),function(fF){return dz.op_GreaterGreaterDot(fD,fE,fF[0],fF[1]);})),D.spaces());};e0.parse=function(fB,fC){var fD,fE,fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO,fP,fQ,fR,fS,fT,fU,fV,fW,fX,fY,fZ,f0,f1,f2,f3,f4,f5,f6,f7,f8,f9,f_,f$,ga,gb,gc,gd,ge,gf,gg,gh,gi,gj,gk,gl,gm,gn;function go(gE){return bc.fold(function(gF,gG){var gH;gH=gG[0];if(gF.ContainsKey(gH))throw new cW.New((function(gI){return function(gJ){return gI("Failed trying to parse duplicate rate expression "+_2.toSafe(gJ));};}(a.id))(gH));else return gF.Add(gH,gG[1]);},new y.New([]),gE);}function gp(gE){return{$:4,$0:gE};}function gq(gE){return{$:3,$0:gE};}function gr(gE){return{$:1,$0:gE};}function gs(gE){return{$:0,$0:gE};}function gt(gE){return{$:2,$0:gE};}function gu(gE){return{$:6,$0:gE};}function gv(gE){return{$:8,$0:gE};}function gw(gE){return{$:9,$0:gE};}function gx(gE){return{$:5,$0:gE};}function gy(gE){return{$:10,$0:gE};}function gz(gE){return{$:7,$0:gE};}function gA(gE){return{$:11,$0:gE};}function gB(gE){return{$:13,$0:gE};}function gC(gE){return{$:14,$0:gE};}function gD(gE){return{$:12,$0:gE};}fD=(fE=D.list_of((fF=(fG=D.skw("="),function(gE){return dz.op_GreaterGreaterDot(fG,fB,gE[0],gE[1]);}),function(gE){return dz.op_DotGreaterGreaterDot(D.name(),fF,gE[0],gE[1]);})),(fH=function(gE){return D.preturn(go(gE));},function(gE){return dz.op_GreaterGreaterEquals(fE,fH,gE[0],gE[1]);}));fI=D.choice([(fJ=(fK=D.kw("deterministic"),(fL=bO.get_parse(),function(gE){return dz.op_GreaterGreaterDot(fK,fL,gE[0],gE[1]);})),function(gE){return dz.op_BarGreaterGreater(fJ,gp,gE[0],gE[1]);}),(fM=(fN=D.kw("stochastic"),(fO=_7.get_parse(),function(gE){return dz.op_GreaterGreaterDot(fN,fO,gE[0],gE[1]);})),function(gE){return dz.op_BarGreaterGreater(fM,gq,gE[0],gE[1]);}),(fP=(fQ=D.kw("simulations"),(fR=D.list_of(P.parse_named(fC)),function(gE){return dz.op_GreaterGreaterDot(fQ,fR,gE[0],gE[1]);})),function(gE){return dz.op_BarGreaterGreater(fP,gr,gE[0],gE[1]);}),(fS=(fT=D.kw("simulation"),(fU=P.parse(fC),function(gE){return dz.op_GreaterGreaterDot(fT,fU,gE[0],gE[1]);})),function(gE){return dz.op_BarGreaterGreater(fS,gs,gE[0],gE[1]);}),(fV=(fW=D.kw("simulator"),(fX=_1.get_parse(),function(gE){return dz.op_GreaterGreaterDot(fW,fX,gE[0],gE[1]);})),function(gE){return dz.op_BarGreaterGreater(fV,gt,gE[0],gE[1]);}),(fY=(fZ=D.kw("parameters"),(f0=D.list_of(bX.get_parse()),function(gE){return dz.op_GreaterGreaterDot(fZ,f0,gE[0],gE[1]);})),function(gE){return dz.op_BarGreaterGreater(fY,gu,gE[0],gE[1]);}),(f1=(f2=D.kw("sweeps"),(f3=D.list_of(b9.get_parse()),function(gE){return dz.op_GreaterGreaterDot(f2,f3,gE[0],gE[1]);})),function(gE){return dz.op_BarGreaterGreater(f1,gv,gE[0],gE[1]);}),(f4=(f5=D.kw("data"),(f6=D.list_of(D.name()),function(gE){return dz.op_GreaterGreaterDot(f5,f6,gE[0],gE[1]);})),function(gE){return dz.op_BarGreaterGreater(f4,gw,gE[0],gE[1]);}),(f7=(f8=D.kw("inference"),(f9=b0.get_parse(),function(gE){return dz.op_GreaterGreaterDot(f8,f9,gE[0],gE[1]);})),function(gE){return dz.op_BarGreaterGreater(f7,gx,gE[0],gE[1]);}),(f_=(f$=D.kw("spatial"),(ga=(_6.get_parse())(fC),function(gE){return dz.op_GreaterGreaterDot(f$,ga,gE[0],gE[1]);})),function(gE){return dz.op_BarGreaterGreater(f_,gy,gE[0],gE[1]);}),(gb=(gc=D.kw("rates"),function(gE){return dz.op_GreaterGreaterDot(gc,fD,gE[0],gE[1]);}),function(gE){return dz.op_BarGreaterGreater(gb,gz,gE[0],gE[1]);}),(gd=(ge=D.kw("plot_settings"),(gf=b_.parse(fC),function(gE){return dz.op_GreaterGreaterDot(ge,gf,gE[0],gE[1]);})),function(gE){return dz.op_BarGreaterGreater(gd,gA,gE[0],gE[1]);}),(gg=(gh=D.kw("moments"),function(gE){return dz.op_GreaterGreaterDot(gh,bD.parse(),gE[0],gE[1]);}),function(gE){return dz.op_BarGreaterGreater(gg,gB,gE[0],gE[1]);}),(gi=(gj=D.kw("synthesis"),(gk=b2.get_parse(),function(gE){return dz.op_GreaterGreaterDot(gj,gk,gE[0],gE[1]);})),function(gE){return dz.op_BarGreaterGreater(gi,gC,gE[0],gE[1]);}),(gl=(gm=D.kw("units"),(gn=b7.get_parse(),function(gE){return dz.op_GreaterGreaterDot(gm,gn,gE[0],gE[1]);})),function(gE){return dz.op_BarGreaterGreater(gl,gD,gE[0],gE[1]);})]);return function(gE){return fI([gE[0],gE[1]]);};};e1=x.HashSet=fu.Class({Add:function(fB){return this.add(fB);},add:function(fB){var fC,fD;fC=this.hash(fB);fD=this.data[fC];return fD==null?(this.data[fC]=[fB],this.count=this.count+1,true):this.arrContains(fB,fD)?false:(fD.push(fB),this.count=this.count+1,true);},arrContains:function(fB,fC){var fD,fE,fF,fG;fD=true;fE=0;fG=fC.length;while(fD&&fE<fG)if(this.equals.apply(null,[fC[fE],fB]))fD=false;else fE=fE+1;return!fD;},GetEnumerator:function(){return da.Get(fq.concat(this.data));},GetEnumerator0:function(){return da.Get(fq.concat(this.data));}},w,e1);e1.New$3=fu.Ctor(function(){e1.New$4.call(this,[],bk.Equals,bk.Hash);},e1);e1.New$4=fu.Ctor(function(fB,fC,fD){var fE;w.New.call(this);this.equals=fC;this.hash=fD;this.data=[];this.count=0;fE=da.Get(fB);try{while(fE.MoveNext())this.add(fE.Current());}finally{if(typeof fE=="object"&&"Dispose"in fE)fE.Dispose();}},e1);e2.ClosePath={$:3};e3.$cctor=function(){var fB,fC,fD,fE,fF,fG,fH;e3.$cctor=a.ignore;function fI(ga,gb){return dz.op_DotGreaterGreater(D.pfloat(),D.spaces(),ga,gb);}function fJ(ga,gb){return ce.New(ga,gb.outer,gb.width);}function fK(ga,gb){return dz.op_DotGreaterGreater(D.pfloat(),D.spaces(),ga,gb);}function fL(ga,gb){return ce.New(gb.inner,ga,gb.width);}function fM(ga,gb){return dz.op_DotGreaterGreater(D.pfloat(),D.spaces(),ga,gb);}function fN(ga,gb){return ce.New(gb.inner,gb.outer,ga);}function fO(ga,gb){return dz.op_DotGreaterGreater(D.pfloat(),D.spaces(),ga,gb);}function fP(ga,gb){return cf.New(ga,gb.y,gb.width,gb.value);}function fQ(ga,gb){return dz.op_DotGreaterGreater(D.pfloat(),D.spaces(),ga,gb);}function fR(ga,gb){return cf.New(gb.x,ga,gb.width,gb.value);}function fS(ga,gb){return dz.op_DotGreaterGreater(D.pfloat(),D.spaces(),ga,gb);}function fT(ga,gb){return cf.New(gb.x,gb.y,ga,gb.value);}function fU(ga,gb){return dz.op_DotGreaterGreater(D.pfloat(),D.spaces(),ga,gb);}function fV(ga,gb){return cf.New(gb.x,gb.y,gb.width,ga);}function fW(ga,gb){return dz.op_DotGreaterGreater(D.pfloat(),D.spaces(),ga,gb);}function fX(ga,gb){return cg.New(ga,gb.xmax,gb.ymin,gb.ymax,gb.value);}function fY(ga,gb){return dz.op_DotGreaterGreater(D.pfloat(),D.spaces(),ga,gb);}function fZ(ga,gb){return cg.New(gb.xmin,ga,gb.ymin,gb.ymax,gb.value);}function f0(ga,gb){return dz.op_DotGreaterGreater(D.pfloat(),D.spaces(),ga,gb);}function f1(ga,gb){return cg.New(gb.xmin,gb.xmax,ga,gb.ymax,gb.value);}function f2(ga,gb){return dz.op_DotGreaterGreater(D.pfloat(),D.spaces(),ga,gb);}function f3(ga,gb){return cg.New(gb.xmin,gb.xmax,gb.ymin,ga,gb.value);}function f4(ga,gb){return dz.op_DotGreaterGreater(D.pfloat(),D.spaces(),ga,gb);}function f5(ga,gb){return cg.New(gb.xmin,gb.xmax,gb.ymin,gb.ymax,ga);}function f6(ga,gb){return dz.op_DotGreaterGreater(D.pfloat(),D.spaces(),ga,gb);}function f7(ga,gb){return ch.New(ga,gb.core,gb.points,gb.rectangles);}function f8(ga,gb){return dz.op_DotGreaterGreater(fB,D.spaces(),ga,gb);}function f9(ga,gb){return ch.New(gb.random,{$:1,$0:ga},gb.points,gb.rectangles);}function f_(ga,gb){return ch.New(gb.random,gb.core,ga,gb.rectangles);}function f$(ga,gb){return ch.New(gb.random,gb.core,gb.points,ga);}e3.default_core=ce.New(0,0,0);e3.default_point=cf.New(0,0,0,0);e3.default_rectangle=cg.New(0,1,0,1,0);e3.defaults=ch.New(0,null,B.Empty,B.Empty);e3.CONSTANT="constant";e3.INIT="init";e3.SPATIAL="spatial";e3.parser=(fB=D.record(cd.default_core(),A.ofArray([["inner",function(ga){return dz.op_BarGreaterGreater(function(gb){return fI(gb[0],gb[1]);},function(gb){return function(gc){return fJ(gb,gc);};},ga[0],ga[1]);}],["outer",function(ga){return dz.op_BarGreaterGreater(function(gb){return fK(gb[0],gb[1]);},function(gb){return function(gc){return fL(gb,gc);};},ga[0],ga[1]);}],["width",function(ga){return dz.op_BarGreaterGreater(function(gb){return fM(gb[0],gb[1]);},function(gb){return function(gc){return fN(gb,gc);};},ga[0],ga[1]);}]])),(fC=D.record(cd.default_point(),A.ofArray([["x",function(ga){return dz.op_BarGreaterGreater(function(gb){return fO(gb[0],gb[1]);},function(gb){return function(gc){return fP(gb,gc);};},ga[0],ga[1]);}],["y",function(ga){return dz.op_BarGreaterGreater(function(gb){return fQ(gb[0],gb[1]);},function(gb){return function(gc){return fR(gb,gc);};},ga[0],ga[1]);}],["width",function(ga){return dz.op_BarGreaterGreater(function(gb){return fS(gb[0],gb[1]);},function(gb){return function(gc){return fT(gb,gc);};},ga[0],ga[1]);}],["value",function(ga){return dz.op_BarGreaterGreater(function(gb){return fU(gb[0],gb[1]);},function(gb){return function(gc){return fV(gb,gc);};},ga[0],ga[1]);}]])),(fD=D.record(cd.default_rectangle(),A.ofArray([["xmin",function(ga){return dz.op_BarGreaterGreater(function(gb){return fW(gb[0],gb[1]);},function(gb){return function(gc){return fX(gb,gc);};},ga[0],ga[1]);}],["xmax",function(ga){return dz.op_BarGreaterGreater(function(gb){return fY(gb[0],gb[1]);},function(gb){return function(gc){return fZ(gb,gc);};},ga[0],ga[1]);}],["ymin",function(ga){return dz.op_BarGreaterGreater(function(gb){return f0(gb[0],gb[1]);},function(gb){return function(gc){return f1(gb,gc);};},ga[0],ga[1]);}],["ymax",function(ga){return dz.op_BarGreaterGreater(function(gb){return f2(gb[0],gb[1]);},function(gb){return function(gc){return f3(gb,gc);};},ga[0],ga[1]);}],["value",function(ga){return dz.op_BarGreaterGreater(function(gb){return f4(gb[0],gb[1]);},function(gb){return function(gc){return f5(gb,gc);};},ga[0],ga[1]);}]])),D.record(cd.defaults(),A.ofArray([["random",function(ga){return dz.op_BarGreaterGreater(function(gb){return f6(gb[0],gb[1]);},function(gb){return function(gc){return f7(gb,gc);};},ga[0],ga[1]);}],["centralcore",function(ga){return dz.op_BarGreaterGreater(function(gb){return f8(gb[0],gb[1]);},function(gb){return function(gc){return f9(gb,gc);};},ga[0],ga[1]);}],["points",(fE=(fF=D.list_of(fC),function(ga){return dz.op_DotGreaterGreater(fF,D.spaces(),ga[0],ga[1]);}),function(ga){return dz.op_BarGreaterGreater(fE,function(gb){return function(gc){return f_(gb,gc);};},ga[0],ga[1]);})],["rectangles",(fG=(fH=D.list_of(fD),function(ga){return dz.op_DotGreaterGreater(fH,D.spaces(),ga[0],ga[1]);}),function(ga){return dz.op_BarGreaterGreater(fG,function(gb){return function(gc){return f$(gb,gc);};},ga[0],ga[1]);})]])))));};e4=bl.NotId=fu.Class({},G,e4);e4.New=function(fB){return new e4({Data0:fB});};e5.$cctor=function(){e5.$cctor=a.ignore;e5.commit_number="0";e5.default_matching_degree=1;e5.default_toehold_bind_rate=0.0003;e5.default_toehold_unbind_rate=0.1126;e5.default_leak_rate_l=1E-09;e5.default_leak_rate_w=db.default_leak_rate_l()/100;e5.default_tau_rate=db.default_toehold_unbind_rate();e5.default_toehold_length=6;e5.default_specificity_length=20;e5.default_elementary_migration_rate=1/0.000125;e5.default_tolerance=1E-06;e5.array_of_list=U.ofList;e5.newline="\\r\\n";};e6=bp.NamedObject=fu.Class({get_Name:function(){return this.name;},get_Data:function(){return this.data;}},w,e6);e6.New=fu.Ctor(function(fB,fC){w.New.call(this);this.name=fB;this.data=fC;},e6);e7=bp.BayesTable=fu.Class({get_ColumnNames:function(){return this.columnNames.get_Keys();},get_ColumnCount:function(){return U.length(this.data);},GetColumn:function(fB){return U.get(this.data,this.columnNames.Item(fB));}},w,e7);e7.New=fu.Ctor(function(fB,fC){w.New.call(this);this.data=fB;this.columnNames=fC;},e7);e8.Empty={$:3};e9.New=function(fB,fC,fD){return{R:fB,G:fC,B:fD};};e$.New=function(fB,fC,fD,fE,fF,fG,fH){return{Name:fB,BarCenters:fC,BarHeights:fD,BarWidth:fE,FillColour:fF,BorderColour:fG,Shadow:fH};};fa=v.FormatException=fu.Class({},G,fa);fb=v.OverflowException=fu.Class({},G,fb);fc.$cctor=function(){var fB;fc.$cctor=a.ignore;fc.defaults=b1.New(3,1E-16,false,B.Empty);fc.pmonomial=bD.op_BarGreaterGreater(bD.op_GreaterGreaterDot(D.spaces(),D.angleBrackets(D.sepBy1(bD.op_DotGreaterGreaterDot(bD.op_BarGreaterGreater(bD.op_DotGreaterGreater(D.name(),D.spaces()),be.create),(fB=D.choice([bD.op_BarGreaterGreater(bD.op_DotGreaterGreater(bD.op_GreaterGreaterDot(D.kw("^"),D.pint32()),D.spaces()),F.toInt),D.preturn(1)]),function(fC){return fB([fC[0],fC[1]]);})),D.kw("*")))),bD.canonicalMonomial);fc.pplot=R.parse(bD.pmonomial());fc.parse=bD.parse_defaults(bD.defaults());};fd.$cctor=function(){fd.$cctor=a.ignore;fd.empty=new y.New([]);};de.Identity=function(fB,fC){var fD,fE,fF,fG;fD=fv.min(fB,fC);fE=new df.New(fB,fC);for(fF=0,fG=fD-1;fF<=fG;fF++)fE.get_Item(fF).set_Item(fF,1);return fE;};fe.New=function(fB,fC,fD,fE,fF,fG,fH,fI){return{e:fB,Dq:fC,DqUp:fD,DqDown:fE,delta:fF,x:fG,z:fH,count:fI};};ff.SolveCore=function(fB,fC){var fD,fE,fF,fG,fH,fI,fJ,fK,fL,fM,fN;fD=cO.numRows(fB);fE=cO.copy(fB);fF=cL.copy(fC);fo.solveCore(fE,fF);fG=new fz(fD);for(fH=0,fI=fD-1;fH<=fI;fH++){fJ=fF[fH];fL=fE.get_Item(fH);for(fM=fD-fH,fN=fD-1;fM<=fN;fM++)fJ=fJ-fG[fM]*fL[fM];fG[fD-fH-1]=fJ;}return fG;};ff.SparseSolveCore=function(fB,fC){var fD,fE,fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO,fP,fQ,fR,fS,fT,fU,fV,fW,fX,fY,fZ,f0;fG=fB.get_RowDimension();fD=U.ofSeq(bc.delay(function(){return bc.map(function(f1){return fC[f1];},F.range(0,fG-1));}));fE=U.ofSeq(bc.delay(function(){return bc.map(a.id,F.range(0,fG-1));}));fF=U.create(fG,0);for(fH=0,fI=fG-1;fH<=fI;fH++){fJ=0;fK=fB.get_Items(fJ,fH);fL=0;for(fO=0,fP=fG-fH-1;fO<=fP;fO++){fL=fB.get_Items(fO,fH);fv.abs(fL)>fv.abs(fK)?(fJ=fO,fK=fL):void 0;}fv.abs(fK)<1E-12?F.FailWith("Cannot apply Gauss method"):void 0;fB.ScaleRow(fJ,fH+1,fG-1,1/fK);U.set(fD,fJ,U.get(fD,fJ)/fK);fB.set_Items(fJ,fH,1);fJ!==fG-fH-1?(fB.SwitchRows(fJ,fG-fH-1),fM=U.get(fD,fG-fH-1),U.set(fD,fG-fH-1,U.get(fD,fJ)),U.set(fD,fJ,fM),fN=U.get(fE,fG-fH-1),U.set(fE,fG-fH-1,U.get(fE,fJ)),U.set(fE,fJ,fN)):void 0;for(fQ=0,fR=fG-fH-2;fQ<=fR;fQ++){fL=fB.get_Item$1(fQ,fH);if(fL!==0){for(fS=fH+1,fT=fG-1;fS<=fT;fS++)fB.set_Item$1(fQ,fS,fL-fB.get_Item$1(fG-fH-1,fS));U.set(fD,fQ,U.get(fD,fQ)-fL*U.get(fD,fG-fH-1));fB.set_Item$1(fQ,fH,0);}else void 0;}}for(fU=0,fV=fG-1;fU<=fV;fU++){fW=U.get(fD,fU);fY=fB.get_Item(fU);for(fZ=0,f0=fY.get_Count()-1;fZ<=f0;fZ++)if(U.get(fY.get_Indices(),fZ)>=fG-fU)fW=fW-U.get(fF,U.get(fY.get_Indices(),fZ))*U.get(fB.get_Item(fU).get_Items(),fZ);U.set(fF,fG-fU-1,fW);}return cL.ofArray(fF);};fg.Rejected={$:1};fh.Empty={$:3};fi.buildHistogram=function(fB,fC){var fD,fE,fF,fG,fH,fI;fD=1E-06;fE=bc.min(fB)-fD;fF=(bc.max(fB)+fD-fE)/fC;fG=A.init(fC,function(fJ){return fE+fF*0.5+fJ*fF;});fH=U.init(fC,function(fJ){return fE+fJ*fF;});fI=U.create(fC,0);bc.iter(function(fJ){U.set(fI,fJ,U.get(fI,fJ)+1);},bc.map(function(fJ){return fJ<0?~fJ-1:fJ;},bc.map(function(fJ){return U.binarySearch(fH,function(fK){return bk.Compare(fJ,fK);},0,U.length(fH));},fB)));return fj.New(fG,A.ofArray(fI),fF);};fj.New=function(fB,fC,fD){return{BinCentres:fB,BinCounters:fC,BinWidth:fD};};fk.WithoutShadow={$:0};fl=v.IndexOutOfRangeException=fu.Class({},G,fl);fl.New=fu.Ctor(function(){fl.New$1.call(this,"Index was outside the bounds of the array.");},fl);fl.New$1=fu.Ctor(function(fB){this.message=fB;cG.setPrototypeOf(this,fl.prototype);},fl);fm.$cctor=function(){fm.$cctor=a.ignore;fm.zero={$:1,$0:0};fm.one={$:1,$0:1};};fn.$cctor=function(){fn.$cctor=a.ignore;fn.improbable=4.94065645841247E-324;fn.log_improbable=fv.log(dn.improbable());fn["lcg.a"]=1664525;fn["lcg.c"]=1013904223;fn["lcd.m"]=fv.pow(2,32);fn["lcg.d"]=1/dn["lcd.m"]();};fo.solveCore=function(fB,fC){var fD,fE,fF,fG,fH,fI,fJ,fK;fD=0;for(fE=0,fF=cO.numRows(fB)-1;fE<=fF;fE++){fI=cO.numRows(fB)-fE-1;fD=0;for(fJ=0,fK=fI;fJ<=fK;fJ++)if(fv.abs((fB.get_Item(fJ))[fE])>fv.abs((fB.get_Item(fD))[fE]))fD=fJ;fv.abs((fB.get_Item(fD))[fE])<1E-12?F.FailWith("Cannot apply Gauss method"):void 0;fG=fB.get_Item(fD);fH=fG[fE];fo.divideFrom(fG,fH,fE+1);fC[fD]=fC[fD]/fH;fG[fE]=1;fD!==fI?(fo.flipRows(fB,fD,fI),fo.flipValues(fC,fD,fI)):void 0;fo.processOtherRows(fB,fC,fE);}};fo.divideFrom=function(fB,fC,fD){var fE,fF;for(fE=fD,fF=fB.length-1;fE<=fF;fE++)fB[fE]=fB[fE]/fC;};fo.flipRows=function(fB,fC,fD){var fE,fF,fG,fH,fI;fE=fB.get_Item(fC);fF=fB.get_Item(fD);for(fG=0,fH=fE.length-1;fG<=fH;fG++){fI=fE[fG];fE[fG]=fF[fG];fF[fG]=fI;}};fo.flipValues=function(fB,fC,fD){var fE;fE=fB[fC];fB[fC]=fB[fD];fB[fD]=fE;};fo.processOtherRows=function(fB,fC,fD){var fE,fF,fG,fH,fI,fJ,fK,fL;fE=fB.MatrixData;fF=fE.length-fD-1|0;fG=+fC[fF];fH=fE[fF];fI=0;for(;fI<fF;fI++){fJ=fE[fI];fK=+fJ[fD];if(fK!==0){fL=fD|0+1;for(;fL<fJ.length;fL++)fJ[fL]=+fJ[fL]-fK*+fH[fL];fC[fI]=+fC[fI]-fK*fG;fJ[fD]=0;}}};bn.createNormal=function(fB,fC){return fC>0?{$:0,$0:cn.New(fB,fC)}:F.FailWith("Cannot create Normal distribution with non-positive sigma. Value supplied: "+fA(fC));};bn.createLogNormal=function(fB,fC){return fC>0?{$:1,$0:cm.New(fB,fC)}:F.FailWith("Cannot create LogNormal distribution with non-positive sigma. Value supplied: "+fA(fC));};bn.createTruncatedNormal=function(fB,fC,fD,fE){return{$:2,$0:cl.New(fB,fC,fD,fE,dn.normCDF(fB,fC,fE)-dn.normCDF(fB,fC,fD))};};fp.New=function(fB,fC,fD,fE,fF,fG){return{GridLines:fB,Plots:fC,IsLegendEnabled:fD,IsNavigationEnabled:fE,IsTooltipPlotCoordsEnabled:fF,VisibleRegion:fG};};U.binarySearch=function(fB,fC,fD,fE){var fF,fG,fH,fI;fF=fD;fG=fE-1;if(fD<0)throw new fs.New("index","Non-negative number required.");else null;if(fE>U.length(fB))throw new eq.New$2("Offset and length were out of bounds for the array or count is greater than the number of elements from index to the end of the source collection.");else null;if(fE<fD)throw new fs.New("length","Non-negative number required.");else null;while(true)if(fF>fG)return~fF;else{fH=(fF+fG)/2>>0;fI=fC(U.get(fB,fH));if(fF===fG)return fI===0?fF:fI>0?~(fF+1):~fF;else if(fI<=0)fG=fH;else fF=fH+1;}};fq.concat=function(fB){var fC,fD;fC=[];for(var fE in fB)fC.push.apply(fC,fB[fE]);return fC;};fr=v.MatchFailureException=fu.Class({},G,fr);fr.New=fu.Ctor(function(fB,fC,fD){this.message=fB+" at "+fA(fC)+":"+fA(fD);cG.setPrototypeOf(this,fr.prototype);},fr);fs=v.ArgumentOutOfRangeException=fu.Class({},G,fs);fs.New=fu.Ctor(function(fB,fC){this.message=fC+"\\nParameter name: "+fB;cG.setPrototypeOf(this,fs.prototype);},fs);}());\r\n\r\n\r\nif (typeof IntelliFactory !==\'undefined\') {\r\n  IntelliFactory.Runtime.ScriptBasePath = \'/Content/\';\r\n  IntelliFactory.Runtime.Start();\r\n}\r\n'},function(e,t){e.exports='function ignore(){}function id(n){return n}function fst(n){return n[0]}function snd(n){return n[1]}function trd(n){return n[2]}IntelliFactory={Runtime:{Ctor:function(n,t){return n.prototype=t.prototype,n},Class:function(n,t,i){var u=n,f,r,e;if(t){u=new t;for(f in n)u[f]=n[f]}if(r=function(n){if(n)for(var t in n)this[t]=n[t]},r.prototype=u,i)for(e in i)r[e]=i[e];return r},Clone:function(n){var t={};for(var i in n)t[i]=n[i];return t},NewObject:function(n){for(var i={},t=0;t<n.length;t++)i[n[t][0]]=n[t][1];return i},DeleteEmptyFields:function(n,t){for(var r,i=0;i<t.length;i++)r=t[i],n[r]===void 0&&delete n[r];return n},GetOptional:function(n){return n===void 0?null:{$:1,$0:n}},SetOptional:function(n,t,i){i?n[t]=i.$0:delete n[t]},SetOrDelete:function(n,t,i){i===void 0?delete n[t]:n[t]=i},Apply:function(n,t,i){return n.apply(t,i)},Bind:function(n){return function(){return n.apply(this,arguments)}},CreateFuncWithArgs:function(n){return function(){return n(Array.prototype.slice.call(arguments))}},CreateFuncWithOnlyThis:function(n){return function(){return n(this)}},CreateFuncWithThis:function(n){return function(){return n(this).apply(null,arguments)}},CreateFuncWithThisArgs:function(n){return function(){return n(this)(Array.prototype.slice.call(arguments))}},CreateFuncWithRest:function(n,t){return function(){return t(Array.prototype.slice.call(arguments,0,n).concat([Array.prototype.slice.call(arguments,n)]))}},CreateFuncWithArgsRest:function(n,t){return function(){return t([Array.prototype.slice.call(arguments,0,n),Array.prototype.slice.call(arguments,n)])}},BindDelegate:function(n,t){var i=n.bind(t);return i.$Func=n,i.$Target=t,i},CreateDelegate:function(n){if(n.length==0)return null;if(n.length==1)return n[0];var t=function(){for(var i,t=0;t<n.length;t++)i=n[t].apply(null,arguments);return i};return t.$Invokes=n,t},CombineDelegates:function(n){for(var t,i=[],r=0;r<n.length;r++)t=n[r],t&&("$Invokes"in t?i=i.concat(t.$Invokes):i.push(t));return IntelliFactory.Runtime.CreateDelegate(i)},DelegateEqual:function(n,t){var f,e,i,r,u;if(n===t)return!0;if(n==null||t==null||(f=n.$Invokes||[n],e=t.$Invokes||[t],f.length!=e.length))return!1;for(i=0;i<f.length;i++)if(r=f[i],u=e[i],!(r===u||"$Func"in r&&"$Func"in u&&r.$Func===u.$Func&&r.$Target==u.$Target))return!1;return!0},ThisFunc:function(n){return function(){var t=Array.prototype.slice.call(arguments);return t.unshift(this),n.apply(null,t)}},ThisFuncOut:function(n){return function(){var t=Array.prototype.slice.call(arguments);return n.apply(t.shift(),t)}},ParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat([i.slice(n)]))}},ParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat(i[n]))}},ThisParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return i.unshift(this),t.apply(null,i.slice(0,n+1).concat([i.slice(n+1)]))}},ThisParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(i.shift(),i.slice(0,n).concat(i[n]))}},Curried:function(n,t,i){return i=i||[],function(r){var u=i.concat([r===void 0?null:r]);return t==1?n.apply(null,u):t==2?function(t){return n.apply(null,u.concat([t===void 0?null:t]))}:IntelliFactory.Runtime.Curried(n,t-1,u)}},Curried2:function(n){return function(t){return function(i){return n(t,i)}}},Curried3:function(n){return function(t){return function(i){return function(r){return n(t,i,r)}}}},UnionByType:function(n,t,i){for(var u,f=typeof t,r=0;r<n.length;r++)if(u=n[r],typeof u=="number"){if(Array.isArray(t)&&(u==0||t.length==u))return{$:r,$0:t}}else if(u==f)return{$:r,$0:t};if(!i)throw new Error("Type not expected for creating Choice value.");},ScriptBasePath:"./",ScriptPath:function(n,t){return this.ScriptBasePath+(this.ScriptSkipAssemblyDir?"":n+"/")+t},OnLoad:function(n){"load"in this||(this.load=[]);this.load.push(n)},Start:function(){function n(n){for(var t=0;t<n.length;t++)n[t]()}"load"in this&&(n(this.load),this.load=[])}}};IntelliFactory.Runtime.OnLoad(function(){self.WebSharper&&WebSharper.Activator&&WebSharper.Activator.Activate&&WebSharper.Activator.Activate()});Date.now||(Date.now=function(){return(new Date).getTime()});Math.trunc||(Math.trunc=function(n){return n<0?Math.ceil(n):Math.floor(n)});Object.setPrototypeOf||(Object.setPrototypeOf=function(n,t){return n.__proto__=t,n});console||(console={count:ignore,dir:ignore,error:ignore,group:ignore,groupEnd:ignore,info:ignore,log:ignore,profile:ignore,profileEnd:ignore,time:ignore,timeEnd:ignore,trace:ignore,warn:ignore});\r\n(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_,$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX,bY,bZ,b0,b1,b2,b3,b4,b5,b6,b7,b8,b9,b_,b$,ca,cb,cc,cd,ce,cf,cg,ch,ci,cj,ck,cl,cm,cn,co,cp,cq,cr,cs,ct,cu,cv,cw,cx,cy,cz,cA,cB,cC,cD,cE,cF,cG,cH,cI,cJ,cK,cL,cM,cN,cO,cP,cQ,cR,cS,cT,cU,cV,cW,cX,cY,cZ,c0,c1,c2,c3,c4,c5,c6,c7,c8,c9,c_,c$,da,db,dc,dd,de,df,dg,dh,di,dj,dk,dl,dm,dn,_do,dp,dq,dr,ds,dt,du,dv,dw,dx,dy,dz,dA,dB,dC,dD,dE,dF,dG,dH,dI,dJ,dK,dL,dM,dN,dO,dP,dQ,dR,dS,dT,dU,dV,dW,dX,dY,dZ,d0,d1,d2,d3,d4,d5,d6,d7,d8,d9,d_,d$,ea,eb,ec,ed,ee,ef,eg,eh,ei,ej,ek,el,em,en,eo,ep,eq,er,es,et,eu,ev,ew,ex,ey,ez,eA,eB,eC,eD,eE,eF,eG,eH,eI,eJ,eK,eL,eM,eN,eO,eP,eQ,eR,eS,eT,eU,eV,eW,eX,eY,eZ,e0,e1,e2,e3,e4,e5,e6,e7,e8,e9,e_,e$,fa,fb,fc,fd,fe,ff,fg,fh,fi,fj,fk,fl,fm,fn,fo,fp,fq,fr,fs,ft,fu,fv,fw,fx,fy,fz,fA,fB,fC,fD,fE,fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO,fP,fQ,fR,fS,fT,fU,fV,fW,fX,fY,fZ,f0,f1,f2,f3,f4,f5,f6,f7,f8,f9,f_,f$,ga,gb,gc,gd,ge,gf,gg,gh,gi,gj,gk,gl,gm,gn,go,gp,gq,gr,gs,gt,gu,gv,gw,gx,gy,gz,gA,gB,gC,gD,gE,gF,gG,gH,gI,gJ,gK,gL,gM,gN,gO,gP,gQ,gR,gS,gT,gU,gV,gW,gX,gY,gZ,g0,g1,g2,g3,g4,g5,g6,g7,g8,g9,g_,g$,ha,hb,hc,hd,he,hf,hg,hh,hi,hj,hk,hl,hm,hn,ho,hp,hq,hr,hs,ht,hu,hv,hw,hx,hy,hz,hA,hB,hC,hD,hE,hF,hG,hH;a=self;b=a.Microsoft=a.Microsoft||{};c=b.Research=b.Research||{};d=c.CRNEngine=c.CRNEngine||{};e=d.JSONAPI=d.JSONAPI||{};f=c.DNA=c.DNA||{};g=f.JSAPI=f.JSAPI||{};h=g.ParseObject=g.ParseObject||{};i=g.ParseResult=g.ParseResult||{};j=f.JSONAPI=f.JSONAPI||{};k=j.ParseResult=j.ParseResult||{};l=d.Task=d.Task||{};m=d.InferenceSiteGraph=d.InferenceSiteGraph||{};n=m.Location=m.Location||{};o=m.PriorKind=m.PriorKind||{};p=d.GuiIGTargetParameter=d.GuiIGTargetParameter||{};q=d.GuiIGEdge=d.GuiIGEdge||{};r=d.GuiIG=d.GuiIG||{};s=a.CRNEngineJS_JsonDecoder=a.CRNEngineJS_JsonDecoder||{};t=a.CRNEngineJS_JsonEncoder=a.CRNEngineJS_JsonEncoder||{};u=a.CRNEngineJS_GeneratedPrintf=a.CRNEngineJS_GeneratedPrintf||{};v=d.Stochastic_settings=d.Stochastic_settings||{};w=d.Deterministic_settings=d.Deterministic_settings||{};x=d.Interval=d.Interval||{};y=d.Truncated=d.Truncated||{};z=d.LogNormal=d.LogNormal||{};A=d.Normal=d.Normal||{};B=d.Uniform=d.Uniform||{};C=d.Distribution=d.Distribution||{};D=d.Variation=d.Variation||{};E=d.Prior=d.Prior||{};F=d.Parameter=d.Parameter||{};G=d.Spatial_settings=d.Spatial_settings||{};H=d.Noise_model=d.Noise_model||{};I=d.Noise_parameter=d.Noise_parameter||{};J=d.Inference_settings=d.Inference_settings||{};K=d.Moment_closure_settings=d.Moment_closure_settings||{};L=K.t=K.t||{};M=d.Synthesis_settings=d.Synthesis_settings||{};N=d.Column=d.Column||{};O=d.Table=d.Table||{};P=d.Dataset=d.Dataset||{};Q=d.Concentration=d.Concentration||{};R=d.Time=d.Time||{};S=d.Space=d.Space||{};T=d.Units=d.Units||{};U=d.Simulator=d.Simulator||{};V=d.Assignment=d.Assignment||{};W=d.Sweep=d.Sweep||{};X=d.Plot_settings=d.Plot_settings||{};Y=d.Crn_settings=d.Crn_settings||{};Z=d.Mset=d.Mset||{};_0=Z.entry=Z.entry||{};_1=d.Rate=d.Rate||{};_2=d.Reaction=d.Reaction||{};_3=d.Spatial_initial=d.Spatial_initial||{};_4=_3.core=_3.core||{};_5=_3.point=_3.point||{};_6=_3.rectangle=_3.rectangle||{};_7=_3.t=_3.t||{};_8=d.Initial=d.Initial||{};_9=d.Attributes=d.Attributes||{};_=d.Gui=d.Gui||{};$=d.GuiModel=d.GuiModel||{};ba=d.JSAPI=d.JSAPI||{};bb=a.WebSharper=a.WebSharper||{};bc=bb.ClientSideJson=bb.ClientSideJson||{};bd=bc.Provider=bc.Provider||{};be=bb.Operators=bb.Operators||{};bf=c.Filzbach=c.Filzbach||{};bg=bf.Parameters=bf.Parameters||{};bh=bg.ParameterType=bg.ParameterType||{};bi=bg.ParameterRange=bg.ParameterRange||{};bj=ba.inference_evaluated_values=ba.inference_evaluated_values||{};bk=bg.TruncatedNormal=bg.TruncatedNormal||{};bl=bg.LogNormal=bg.LogNormal||{};bm=bg.Normal=bg.Normal||{};bn=ba.inference_sampling=ba.inference_sampling||{};bo=bg.AcceptanceStatistics=bg.AcceptanceStatistics||{};bp=ba.inference_burnin=ba.inference_burnin||{};bq=d.Key=d.Key||{};br=d.Expression=d.Expression||{};bs=br.bexp=br.bexp||{};bt=br.modulo=br.modulo||{};bu=br.minus=br.minus||{};bv=br.power=br.power||{};bw=br.divide=br.divide||{};bx=d.Simulation_settings=d.Simulation_settings||{};by=d.Instance=d.Instance||{};bz=d.Result=d.Result||{};bA=ba.inference_result=ba.inference_result||{};bB=ba.InferenceParameterRange=ba.InferenceParameterRange||{};bC=ba.InferenceParameter=ba.InferenceParameter||{};bD=ba.InferenceParameters=ba.InferenceParameters||{};bE=ba.sim_run=ba.sim_run||{};bF=d.Kinetics=d.Kinetics||{};bG=d.Species=d.Species||{};bH=d.Jit=d.Jit||{};bI=bH.newplottable=bH.newplottable||{};bJ=d.Row=d.Row||{};bK=d.Probabilities=d.Probabilities||{};bL=ba.transition=ba.transition||{};bM=ba.state=ba.state||{};bN=ba.state_space=ba.state_space||{};bO=ba.probabilityMap=ba.probabilityMap||{};bP=ba.export_def=ba.export_def||{};bQ=d.Point=d.Point||{};bR=f.Options=f.Options||{};bS=bR.t=bR.t||{};bT=f.Dsd=f.Dsd||{};bU=a.StartupCode$ClassicDSDJS$jsapi=a.StartupCode$ClassicDSDJS$jsapi||{};bV=bb.Collections=bb.Collections||{};bW=bV.Map=bV.Map||{};bX=bb.List=bb.List||{};bY=bX.T=bX.T||{};bZ=f.SLConversion=f.SLConversion||{};b0=ba.jit=ba.jit||{};b1=bb.Obj=bb.Obj||{};b2=a.ClassicDSDJS_JsonEncoder=a.ClassicDSDJS_JsonEncoder||{};b3=a.ClassicDSDJS_JsonDecoder=a.ClassicDSDJS_JsonDecoder||{};b4=bR.rendering=bR.rendering||{};b5=f.LogicDSD=f.LogicDSD||{};b6=b5.Bond=b5.Bond||{};b7=a.RulesDSD=a.RulesDSD||{};b8=b7.Syntax=b7.Syntax||{};b9=b8.Location=b8.Location||{};b_=b8.Pattern=b8.Pattern||{};b$=b8.Process=b8.Process||{};ca=b8.Term=b8.Term||{};cb=b5.Tag=b5.Tag||{};cc=b5.Domain=b5.Domain||{};cd=b5.DomainT=b5.DomainT||{};ce=b5.Site=b5.Site||{};cf=b5.SiteT=b5.SiteT||{};cg=b8.Predicate=b8.Predicate||{};ch=b8.Literal=b8.Literal||{};ci=b8.Clause=b8.Clause||{};cj=bV.FSharpMap=bV.FSharpMap||{};ck=bb.Arrays=bb.Arrays||{};cl=bV.List=bV.List||{};cm=d.Model=d.Model||{};cn=d.Crn=d.Crn||{};co=bb.Seq=bb.Seq||{};cp=d.Inference=d.Inference||{};cq=cp.mcmc_result=cp.mcmc_result||{};cr=d.Html=d.Html||{};cs=bg.Parameter=bg.Parameter||{};ct=bV.Dictionary=bV.Dictionary||{};cu=d.Stringmap=d.Stringmap||{};cv=m.IGraph=m.IGraph||{};cw=bb.Unchecked=bb.Unchecked||{};cx=d.OdeOslo=d.OdeOslo||{};cy=d.Ssa=d.Ssa||{};cz=d.OdeSundials=d.OdeSundials||{};cA=bb.Utils=bb.Utils||{};cB=d.Svg=d.Svg||{};cC=d.Lna=d.Lna||{};cD=d.Population=d.Population||{};cE=d.Populations=d.Populations||{};cF=d.Simulation=d.Simulation||{};cG=d.Cme=d.Cme||{};cH=d.Pde=d.Pde||{};cI=bT.ClassicBundle=bT.ClassicBundle||{};cJ=bT.RulesBundle=bT.RulesBundle||{};cK=bV.FSharpSet=bV.FSharpSet||{};cL=d.Functional2=d.Functional2||{};cM=f.BranchesRenderer=f.BranchesRenderer||{};cN=f.Species=f.Species||{};cO=cN.t=cN.t||{};cP=d.Calculus=d.Calculus||{};cQ=bT.metadata=bT.metadata||{};cR=a.Parser=a.Parser||{};cS=bb.Strings=bb.Strings||{};cT=f.Value=f.Value||{};cU=f.Syntax=f.Syntax||{};cV=b7.Unification=b7.Unification||{};cW=cV.TermEquation=cV.TermEquation||{};cX=d.Parameters=d.Parameters||{};cY=d.Environment=d.Environment||{};cZ=f.Dsdreaction=f.Dsdreaction||{};c0=b7.Resolution=b7.Resolution||{};c1=b7.ProcessEquality=b7.ProcessEquality||{};c2=c1.ProcessEquality=c1.ProcessEquality||{};c3=b7.Substitution=b7.Substitution||{};c4=c3.Substitution=c3.Substitution||{};c5=bV.Set=bV.Set||{};c6=bV.BalancedTree=bV.BalancedTree||{};c7=c6.Tree=c6.Tree||{};c8=bV.Pair=bV.Pair||{};c9=bb.JavaScript=bb.JavaScript||{};c_=c9.Pervasives=c9.Pervasives||{};c$=c9.JS=c9.JS||{};da=a.Object;db=a.Error;dc=cR.Exception=cR.Exception||{};dd=cR.error=cR.error||{};de=d.Sbml=d.Sbml||{};df=bb.Enumerator=bb.Enumerator||{};dg=d.Plotting=d.Plotting||{};dh=d.Ode=d.Ode||{};di=cp.mcmc_intermediate_result=cp.mcmc_intermediate_result||{};dj=bg.EvaluatedValues=bg.EvaluatedValues||{};dk=bf.Filzbach=bf.Filzbach||{};dl=dk.Sampling=dk.Sampling||{};dm=dk.Burnin=dk.Burnin||{};dn=cp.partial=cp.partial||{};_do=cp.full=cp.full||{};dp=d.ParameterSummary=d.ParameterSummary||{};dq=cp.McmcSummary=cp.McmcSummary||{};dr=cr.Results=cr.Results||{};ds=cr.Comparison=cr.Comparison||{};dt=d.Statistics=d.Statistics||{};du=dg.html_content=dg.html_content||{};dv=a.FSharpIDD=a.FSharpIDD||{};dw=dv.HTML=dv.HTML||{};dx=cp.Summary=cp.Summary||{};dy=bf.DataStructures=bf.DataStructures||{};dz=dy.AssociativeArray=dy.AssociativeArray||{};dA=d.Dictionary=d.Dictionary||{};dB=d.Ctmc=d.Ctmc||{};dC=d.Transition=d.Transition||{};dD=d.Hashtable=d.Hashtable||{};dE=bH.t=bH.t||{};dF=bH.JitSpecies=bH.JitSpecies||{};dG=d.VectorFSModule=d.VectorFSModule||{};dH=d.Oslo_integrator=d.Oslo_integrator||{};dI=dH.t=dH.t||{};dJ=a.Oslo=a.Oslo||{};dK=dJ.VectorModule=dJ.VectorModule||{};dL=d.VectorFS=d.VectorFS||{};dM=d.Lambda=d.Lambda||{};dN=dJ.MatrixModule=dJ.MatrixModule||{};dO=d.Rng=d.Rng||{};dP=dO.Random=dO.Random||{};dQ=d.Event=d.Event||{};dR=d.reaction_info=d.reaction_info||{};dS=d.Errors=d.Errors||{};dT=dS.EngineException=dS.EngineException||{};dU=dS.SimulatorErrorException=dS.SimulatorErrorException||{};dV=bH.JitReaction=bH.JitReaction||{};dW=cB.point=cB.point||{};dX=cB.box=cB.box||{};dY=cB.group=cB.group||{};dZ=d.Lib=d.Lib||{};d0=dJ.Matrix=dJ.Matrix||{};d1=bb.Slice=bb.Slice||{};d2=bV.DictionaryUtil=bV.DictionaryUtil||{};d3=dJ.SparseMatrix=dJ.SparseMatrix||{};d4=d3.SparseMatrix=d3.SparseMatrix||{};d5=c.ReactionDiffusion=c.ReactionDiffusion||{};d6=d5.Solver1d=d5.Solver1d||{};d7=d6.point=d6.point||{};d8=d5.Lib=d5.Lib||{};d9=d8.settings=d8.settings||{};d_=d5.Solver2d=d5.Solver2d||{};d$=d_.point=d_.point||{};ea=f.DSDParser=f.DSDParser||{};eb=f.Process=f.Process||{};ec=f.Types=f.Types||{};ed=bV.MapUtil=bV.MapUtil||{};ee=f.CirclesRenderer=f.CirclesRenderer||{};ef=f.Sequence=f.Sequence||{};eg=f.Domain=f.Domain||{};eh=cM.DDomain=cM.DDomain||{};ei=f.Segment=f.Segment||{};ej=ei.t=ei.t||{};ek=bV.HashSet=bV.HashSet||{};el=ef.mapping=ef.mapping||{};em=f.Strand=f.Strand||{};en=f.Origami=f.Origami||{};eo=f.Gate=f.Gate||{};ep=f.Svg=f.Svg||{};eq=f.Pattern=f.Pattern||{};er=a.StartupCode$ClassicDSDJS$dsd=a.StartupCode$ClassicDSDJS$dsd||{};es=d.Inlined=d.Inlined||{};et=a.StartupCode$ClassicDSDJS$logicDSD=a.StartupCode$ClassicDSDJS$logicDSD||{};eu=c0.Goal=c0.Goal||{};ev=c0.Mode=c0.Mode||{};ew=b8.CLE=b8.CLE||{};ex=df.T=df.T||{};ey=a.StartupCode$CRNEngineJS$InferenceSiteGraph=a.StartupCode$CRNEngineJS$InferenceSiteGraph||{};ez=d.Stringbuilder=d.Stringbuilder||{};eA=bf.Lib=bf.Lib||{};eB=eA.NormalGenerator=eA.NormalGenerator||{};eC=bf.FilzbachMultiple=bf.FilzbachMultiple||{};eD=bg.Ids=bg.Ids||{};eE=bf.FilzbachAnalysis=bf.FilzbachAnalysis||{};eF=dk.RunOptions=dk.RunOptions||{};eG=dv.DOM=dv.DOM||{};eH=dv.HtmlConverters=dv.HtmlConverters||{};eI=dv.Subplots=dv.Subplots||{};eJ=dv.Chart=dv.Chart||{};eK=dv.Colour=dv.Colour||{};eL=eJ.Chart=eJ.Chart||{};eM=eJ.LegendVisibility=eJ.LegendVisibility||{};eN=dv.Plots=dv.Plots||{};eO=eN.Heatmap=eN.Heatmap||{};eP=bb.Arrays2D=bb.Arrays2D||{};eQ=eN.Markers=eN.Markers||{};eR=eQ.Shape=eQ.Shape||{};eS=eN.Polyline=eN.Polyline||{};eT=eN.Histogram=eN.Histogram||{};eU=dy.NamesMap=dy.NamesMap||{};eV=a.StartupCode$ParserCombinatorsJS$ParserCombinators=a.StartupCode$ParserCombinatorsJS$ParserCombinators||{};eW=dA.t=dA.t||{};eX=d.Index=d.Index||{};eY=d.Adapter=d.Adapter||{};eZ=bV.ValueCollection=bV.ValueCollection||{};e0=dH.Stepper=dH.Stepper||{};e1=dJ.GearBDF=dJ.GearBDF||{};e2=e1.state=e1.state||{};e3=e1.options=e1.options||{};e4=dJ.RK547M=dJ.RK547M||{};e5=e4.state=e4.state||{};e6=e4.options=e4.options||{};e7=d.OsloAbstract=d.OsloAbstract||{};e8=eA.LCGRng=eA.LCGRng||{};e9=d.SundialsAbstract=d.SundialsAbstract||{};e_=cB.anchor=cB.anchor||{};e$=d5.Solver=d5.Solver||{};fa=a.StartupCode$ClassicDSDJS$DSDParser=a.StartupCode$ClassicDSDJS$DSDParser||{};fb=cU.dom_assignment=cU.dom_assignment||{};fc=f.Errors=f.Errors||{};fd=cZ.mass_action_reaction=cZ.mass_action_reaction||{};fe=a.StartupCode$CRNEngineJS$stringmap=a.StartupCode$CRNEngineJS$stringmap||{};ff=a.StartupCode$ClassicDSDJS$sequence=a.StartupCode$ClassicDSDJS$sequence||{};fg=a.StartupCode$ClassicDSDJS$branchesrenderer=a.StartupCode$ClassicDSDJS$branchesrenderer||{};fh=ef.dnabase=ef.dnabase||{};fi=ei.side=ei.side||{};fj=a.StartupCode$ClassicDSDJS$SLConversion=a.StartupCode$ClassicDSDJS$SLConversion||{};fk=a.StartupCode$ClassicDSDJS$options=a.StartupCode$ClassicDSDJS$options||{};fl=eb.t=eb.t||{};fm=b8.Variable=b8.Variable||{};fn=bV.KeyCollection=bV.KeyCollection||{};fo=a.StartupCode$CRNEngineJS$mset=a.StartupCode$CRNEngineJS$mset||{};fp=a.proxies=a.proxies||{};fq=fp.StringBuilder=fp.StringBuilder||{};fr=a.StartupCode$CRNEngineJS$sbml=a.StartupCode$CRNEngineJS$sbml||{};fs=de.model=de.model||{};ft=de.unitKind=de.unitKind||{};fu=de.nOp=de.nOp||{};fv=de.bOp=de.bOp||{};fw=bb.Char=bb.Char||{};fx=a.StartupCode$CRNEngineJS$plotting=a.StartupCode$CRNEngineJS$plotting||{};fy=d.Sweeps=d.Sweeps||{};fz=eA.NormalGeneratorState=eA.NormalGeneratorState||{};fA=eE.ParameterSummary=eE.ParameterSummary||{};fB=eE.summaryType=eE.summaryType||{};fC=eE.qsummaryType=eE.qsummaryType||{};fD=eE.InformationCriteria=eE.InformationCriteria||{};fE=eG.Div=eG.Div||{};fF=eG.Attribute=eG.Attribute||{};fG=dv.Placement=dv.Placement||{};fH=eI.Subplots=eI.Subplots||{};fI=a.StartupCode$FSharpIDD_WS$Chart=a.StartupCode$FSharpIDD_WS$Chart||{};fJ=a.StartupCode$FSharpIDD_WS$Colour=a.StartupCode$FSharpIDD_WS$Colour||{};fK=eJ.LabelledAxisRecord=eJ.LabelledAxisRecord||{};fL=eO.Plot=eO.Plot||{};fM=eO.Palette=eO.Palette||{};fN=eQ.Plot=eQ.Plot||{};fO=eK.Colour=eK.Colour||{};fP=eS.Plot=eS.Plot||{};fQ=eS.LineCap=eS.LineCap||{};fR=eS.LineJoin=eS.LineJoin||{};fS=eT.Plot=eT.Plot||{};fT=a.StartupCode$CRNEngineJS$functional=a.StartupCode$CRNEngineJS$functional||{};fU=cR.ParserBuilder=cR.ParserBuilder||{};fV=d.Keywords=d.Keywords||{};fW=e1.jacobian=e1.jacobian||{};fX=e4.corrStruct=e4.corrStruct||{};fY=bb.ArgumentException=bb.ArgumentException||{};fZ=cB.path=cB.path||{};f0=cB.label=cB.label||{};f1=a.StartupCode$CRNEngineJS$svg=a.StartupCode$CRNEngineJS$svg||{};f2=dJ.SparseVector=dJ.SparseVector||{};f3=f2.SparseVector=f2.SparseVector||{};f4=b7.Parser=b7.Parser||{};f5=cU.plot_pat=cU.plot_pat||{};f6=d.Directive=d.Directive||{};f7=cT.op=cT.op||{};f8=fc.DSDException=fc.DSDException||{};f9=a.StartupCode$ClassicDSDJS$types=a.StartupCode$ClassicDSDJS$types||{};f_=ea.tether=ea.tether||{};f$=ea.domain=ea.domain||{};ga=ea.normal_site=ea.normal_site||{};gb=ee.svg_domain=ee.svg_domain||{};gc=ee.circle=ee.circle||{};gd=b5.DomainC=b5.DomainC||{};ge=ee.port=ee.port||{};gf=cM.DSegment=cM.DSegment||{};gg=cM.DGate=cM.DGate||{};gh=cM.DSegmentConnection=cM.DSegmentConnection||{};gi=cM.DBranch=cM.DBranch||{};gj=cM.LSite=cM.LSite||{};gk=cM.LEdge=cM.LEdge||{};gl=cM.DStrand=cM.DStrand||{};gm=cM.DStrandKind=cM.DStrandKind||{};gn=cM.LNode=cM.LNode||{};go=cB.arc=cB.arc||{};gp=cT.fn=cT.fn||{};gq=bZ.oldSimMode=bZ.oldSimMode||{};gr=bZ.SpBC=bZ.SpBC||{};gs=bZ.ParVar=bZ.ParVar||{};gt=bZ.ParSpace=bZ.ParSpace||{};gu=bZ.KMode=bZ.KMode||{};gv=a.StartupCode$CRNEngineJS$moment_closure_settings=a.StartupCode$CRNEngineJS$moment_closure_settings||{};gw=f.DefaultDatabase=f.DefaultDatabase||{};gx=bR.option_piece=bR.option_piece||{};gy=c0.TJVertex=c0.TJVertex||{};gz=d.Operators=d.Operators||{};gA=de.unitDefinition=de.unitDefinition||{};gB=de.compartment=de.compartment||{};gC=de.species=de.species||{};gD=de.parameter=de.parameter||{};gE=de.initialAssignment=de.initialAssignment||{};gF=de.reaction=de.reaction||{};gG=de.sbmlUnit=de.sbmlUnit||{};gH=de.speciesReference=de.speciesReference||{};gI=de.kineticLaw=de.kineticLaw||{};gJ=de.uOp=de.uOp||{};gK=dy.NamedObject=dy.NamedObject||{};gL=dy.BayesTable=dy.BayesTable||{};gM=eG.Node=eG.Node||{};gN=eK.RgbColour=eK.RgbColour||{};gO=eN.Bars=eN.Bars||{};gP=gO.Plot=gO.Plot||{};gQ=bb.FormatException=bb.FormatException||{};gR=bb.OverflowException=bb.OverflowException||{};gS=a.StartupCode$CRNEngineJS$Keywords=a.StartupCode$CRNEngineJS$Keywords||{};gT=cB.path_command=cB.path_command||{};gU=a.StartupCode$CRNEngineJS$spatial_initial=a.StartupCode$CRNEngineJS$spatial_initial||{};gV=a.StartupCode$ClassicDSDJS$value=a.StartupCode$ClassicDSDJS$value||{};gW=ec.t=ec.t||{};gX=ea.m=ea.m||{};gY=ea.hpr=ea.hpr||{};gZ=ea.hpl=ea.hpl||{};g0=b5.TagC=b5.TagC||{};g1=a.StartupCode$ClassicDSDJS$circlesrenderer=a.StartupCode$ClassicDSDJS$circlesrenderer||{};g2=ep.svg_halfseg=ep.svg_halfseg||{};g3=ep.svg_strand=ep.svg_strand||{};g4=a.StartupCode$ClassicDSDJS$svg=a.StartupCode$ClassicDSDJS$svg||{};g5=a.StartupCode$ClassicDSDJS$defaultDatabase=a.StartupCode$ClassicDSDJS$defaultDatabase||{};g6=f.SequenceCalc=f.SequenceCalc||{};g7=bV.HashSetUtil=bV.HashSetUtil||{};g8=de.NotId=de.NotId||{};g9=a.StartupCode$CRNEngineJS$lib=a.StartupCode$CRNEngineJS$lib||{};g_=a.StartupCode$CRNEngineJS$environment=a.StartupCode$CRNEngineJS$environment||{};g$=dk.AcceptanceResult=dk.AcceptanceResult||{};ha=eI.Slot=eI.Slot||{};hb=dv.HistogramBuilder=dv.HistogramBuilder||{};hc=hb.Histogram=hb.Histogram||{};hd=gO.Shadow=gO.Shadow||{};he=bb.IndexOutOfRangeException=bb.IndexOutOfRangeException||{};hf=e1.iteration=e1.iteration||{};hg=dJ.Gauss=dJ.Gauss||{};hh=a.StartupCode$RulesDSDJS$parser=a.StartupCode$RulesDSDJS$parser||{};hi=ep.labelMode=ep.labelMode||{};hj=g6.energyExpression=g6.energyExpression||{};hk=a.StartupCode$RulesDSDJS$syntax=a.StartupCode$RulesDSDJS$syntax||{};hl=a.StartupCode$Filzbach_FSharp_JS$Lib=a.StartupCode$Filzbach_FSharp_JS$Lib||{};hm=d.Instruction=d.Instruction||{};hn=eI.BareChart=eI.BareChart||{};ho=hg.SolveCoreUtility=hg.SolveCoreUtility||{};hp=f4.NextParser=f4.NextParser||{};hq=b8.Keywords=b8.Keywords||{};hr=b5.SiteC=b5.SiteC||{};hs=a.StartupCode$ClassicDSDJS$origami=a.StartupCode$ClassicDSDJS$origami||{};ht=g6.energy=g6.energy||{};hu=a.StartupCode$ClassicDSDJS$sequenceCalc=a.StartupCode$ClassicDSDJS$sequenceCalc||{};hv=a.StartupCode$ClassicDSDJS$segment=a.StartupCode$ClassicDSDJS$segment||{};hw=g6.gibbs=g6.gibbs||{};hx=a.StartupCode$CRNEngineJS$expression=a.StartupCode$CRNEngineJS$expression||{};hy=bb.ArgumentOutOfRangeException=bb.ArgumentOutOfRangeException||{};hz=bb.MatchFailureException=bb.MatchFailureException||{};hA=a.IntelliFactory;hB=hA&&hA.Runtime;hC=a.Math;hD=a.WS_EM_GLUE;hE=a.console;hF=a.Date;hG=a.Float64Array;hH=a.String;e.decodeIG=function(hI){return(s.j$60())(hI);};e.encodeIG=function(hI){return(t.j$13())(hI);};e.decodeModel=function(hI){return(s.j$17())(hI);};e.encodeModel=function(hI){return(t.j$16())(hI);};e.user_parse_code=function(hI){return(t.j$13())(ba.user_parse_code(hI));};e.user_get_exports=function(hI,hJ,hK){var hL;hL=ba.user_get_exports(hI,e.decodeIG(hJ),hK);return((bd.EncodeArray(t.j))())(hL);};e.user_get_export=function(hI,hJ,hK){return(t.j())(ba.user_get_export(e.decodeIG(hI),hJ,hK));};e.user_infer_gui=function(hI,hJ,hK,hL,hM){ba.user_infer_gui(e.decodeIG(hI),function(hN){hJ((t.j())(hN));},function(hN){hK((t.j$105())(hN));},function(hN){hL((t.j$82())(hN));},hM);};e.user_state_space=function(hI){return(t.j$8())(ba.user_state_space(e.decodeIG(hI)));};e.user_state_space_jit=function(hI){return(t.j$8())(ba.user_state_space_jit(hI));};e.user_get_sim_runs=function(hI,hJ){return(t.j$79())(ba.user_get_sim_runs(e.decodeIG(hI),hJ));};e.simulateFloat=function(hI,hJ,hK,hL,hM,hN){ba.simulateFloat(e.decodeIG(hI),hJ,(s.j$13())(hK),function(hO){hL((t.j$78())(hO));},function(hO){hM((t.j())(hO));},hN);};e.simulateFloatJIT=function(hI,hJ,hK,hL,hM,hN,hO){ba.simulateFloatJIT(e.decodeModel(hI),hJ,function(hP){hK((t.j$78())(hP));},function(hP){hL((t.j$77())(hP));},function(hP){hM((t.j())(hP));},function(hP){hN((t.j$13())(hP));},hO);};e.simulateMeanStdev=function(hI,hJ,hK,hL,hM,hN){ba.simulateMeanStdev(e.decodeIG(hI),hJ,(s.j$13())(hK),function(hO){hL((t.j$12())(hO));},function(hO){hM((t.j())(hO));},hN);};e.simulateMeanStdevProbabilities=function(hI,hJ,hK,hL,hM,hN,hO){return(t.j$7())(ba.simulateMeanStdevProbabilities(e.decodeIG(hI),hJ,(s.j$13())(hK),function(hP){hL((t.j$8())(hP));},function(hP){hM((t.j$12())(hP));},function(hP){hN((t.j())(hP));},hO));};e.getProbabilityMap=function(hI,hJ,hK){return(t.j$6())(ba.getProbabilityMap((s.j$16())(hI),hJ,hK));};e.simulateSpatial1D=function(hI,hJ,hK,hL,hM,hN){ba.simulateSpatial1D(e.decodeIG(hI),hJ,(s.j$13())(hK),function(hO){hL((t.j$5())(hO));},function(hO){hM((t.j())(hO));},hN);};e.simulateSpatial2D=function(hI,hJ,hK,hL,hM,hN){ba.simulateSpatial2D(e.decodeIG(hI),hJ,(s.j$13())(hK),function(hO){hL((t.j$4())(hO));},function(hO){hM((t.j())(hO));},hN);};e.simulateMeanStdevTable=function(hI,hJ,hK,hL,hM,hN){ba.simulateMeanStdevTable(e.decodeIG(hI),hJ,(s.j$13())(hK),function(hO){hL((t.j$1())(hO));},function(hO){hM((t.j())(hO));},hN);};e.expression_to_string=function(hI){return ba.expression_to_string((s.j$7())(hI));};e.mcplot_to_string=function(hI){return ba.mcplot_to_string((s.j())(hI));};g.set_options=function(hI,hJ){return i.New(bT.set_options(hI.bundle,hJ),hJ,hI.unexpanded);};g.parser=function(){bU.$cctor();return bU.parser;};g.user_parse=function(hI){var hJ,hK,hL;hJ=(((g.parser())(hI.toeholds))(hI.specificities))(hI.code);hK=hJ[0];hL=$.New(_.from_crn(bT.convert_unexpanded(hK)),bY.Empty);return i.New(hK,bR.set_rules_program(null,bT.get_options(hK)),r.New(hJ[1],(new cj.New([])).Add("",hL),new cj.New([]),false));};g.user_expand=function(hI){return $.New(_.from_crn(bR.get_is_jit(bT.get_options(hI))?bT.convert_unexpanded(hI):bT.convert_expand(hI)),bY.Empty);};g.user_compile=function(hI){var hJ;hJ=((((g.parser())(hI.toeholds))(hI.specificities))(hI.code))[0];return $.New(_.from_crn(bR.get_is_jit(bT.get_options(hJ))?bT.convert_unexpanded(hJ):bT.convert_expand(hJ)),bY.Empty);};g.user_parse_oldsyntax=function(hI){return g.user_parse(h.New(bZ.convertSL(hI.code),hI.toeholds,hI.specificities));};g.user_compile_oldsyntax=function(hI){return g.user_compile(h.New(bZ.convertSL(hI.code),hI.toeholds,hI.specificities));};g.get_jit_classic=function(hI){var hJ;return b0.New((hJ=bT.to_jit(hI),hJ.$==0?hJ.$0:be.FailWith("Internal error: expecting Classic DSD JIT.")),bT.makeDsdCalculus(hI));};g.get_jit_rules=function(hI){var hJ;return b0.New((hJ=bT.to_jit(hI),hJ.$==1?hJ.$0:be.FailWith("Internal error: expecting Rules DSD JIT.")),bT.to_rules_calculus(hI));};g.is_jit=function(hI){return bT.is_jit(hI);};g.is_classic=function(hI){return hI.$==0;};h.New=function(hI,hJ,hK){return{code:hI,toeholds:hJ,specificities:hK};};i.New=function(hI,hJ,hK){return{bundle:hI,settings:hJ,unexpanded:hK};};j.set_options=function(hI,hJ){var hK;hK=g.set_options(i.New(hI.bundle,(b3.j$1())(hI.settings),(b3.j$27())(hI.unexpanded)),(b3.j$1())(hJ));return k.New(hK.bundle,(b2.j$58())(hK.settings),(b2.j$78())(hK.unexpanded));};j.user_parse=function(hI){var hJ;hJ=g.user_parse(((bd.Id())())(hI));return k.New(hJ.bundle,(b2.j$58())(hJ.settings),(b2.j$78())(hJ.unexpanded));};j.user_expand=function(hI){return(b2.j())(g.user_expand(hI));};j.user_compile=function(hI){return(b2.j())(g.user_compile(((bd.Id())())(hI)));};j.user_parse_oldsyntax=function(hI){var hJ;hJ=g.user_parse_oldsyntax(((bd.Id())())(hI));return k.New(hJ.bundle,(b2.j$58())(hJ.settings),(b2.j$78())(hJ.unexpanded));};j.user_compile_oldsyntax=function(hI){return(b2.j())(g.user_compile_oldsyntax(((bd.Id())())(hI)));};j.is_jit=function(hI){return g.is_jit(hI);};k.New=function(hI,hJ,hK){return{bundle:hI,settings:hJ,unexpanded:hK};};l=d.Task=hB.Class({to_string:function(){var hI;hI=this;return(function(hJ){return function(hK){return hJ("directive task {"+cA.toSafe(hK)+"}");};}(a.id))(cS.Join(";",ck.ofSeq(co.delay(function(){var hJ;return co.append((hJ=hI.task_type,hJ!=null&&hJ.$==1?[(function(hK){return function(hL){return hK("task="+cA.toSafe(hL));};}(a.id))(a.String(hJ.$0).toLowerCase())]:[]),co.delay(function(){return co.append(hI.copies!==1?[(function(hK){return function(hL){return hK("copies="+a.String(hL));};}(a.id))(hI.copies)]:[],co.delay(function(){return co.append(hI.copy_id!==1?[(function(hK){return function(hL){return hK("copy_id="+a.String(hL));};}(a.id))(hI.copy_id)]:[],co.delay(function(){return hI.nodes!==1?[(function(hK){return function(hL){return hK("nodes="+a.String(hL));};}(a.id))(hI.nodes)]:[];}));}));}));}))));}},null,l);l.New=function(hI,hJ,hK,hL){return new l({task_type:hI,copies:hJ,copy_id:hK,nodes:hL});};n=m.Location=hB.Class({get_to_string:function(){return this.$==1?this.$0[0]+"."+this.$0[1]:this.$0;}},null,n);o.get_to_string=function(hI){return hI=="Normal"?"Normal":hI=="LogNormal"?"LogNormal":hI=="TruncatedNormal"?"TruncatedNormal":"Fixed";};p.New=function(hI,hJ,hK){return{source:hI,target:hJ,prior:hK};};q.New=function(hI,hJ){return{location:hI,parameters:hJ};};r=d.GuiIG=hB.Class({to_ig:function(){function hI(hM){return[hM.source,hM.target,hM.prior];}function hJ(hM){return[hM.location,bX.map(hI,hM.parameters)];}function hK(hM){var hN,hO;hN=cS.SplitChars(hM,["."],0);return!cw.Equals(hN,null)&&hN.length===1?new n({$:0,$0:ck.get(hN,0)}):!cw.Equals(hN,null)&&hN.length===2?(hO=ck.get(hN,1),new n({$:1,$0:[ck.get(hN,0),hO]})):(function(hP){return function(hQ){return hP("bad location encoding "+cA.toSafe(hQ));};}(be.FailWith))(hM);}function hL(hM,hN){return[hK(hM),bX.map(hJ,hN)];}return cv.New(this.task,bW.Map(function(hM,hN){return hN.to_model();},this.nodes),bW.OfArray(ck.ofSeq(co.map(function(hM){return hL(hM[0],hM[1]);},bW.ToSeq(this.edges)))),this.expanded);}},null,r);r.from_ig=function(hI){function hJ(hM,hN){return q.New(hM,bX.map(function(hO){return p.New(hO[0],hO[1],hO[2]);},hN));}function hK(hM){return hM.$==1?hM.$0[0]+"."+hM.$0[1]:hM.$0;}function hL(hM,hN){return[hK(hM),bX.map(function(hO){return hJ(hO[0],hO[1]);},hN)];}return r.New(hI.task,bW.Map(function(hM,hN){return $.from_model(hN);},hI.nodes),bW.OfArray(ck.ofSeq(co.map(function(hM){return hL(hM[0],hM[1]);},bW.ToSeq(hI.edges)))),hI.expanded);};r.New=function(hI,hJ,hK,hL){return new r({task:hI,nodes:hJ,edges:hK,expanded:hL});};s.j$60=function(){return s._v$60?s._v$60:s._v$60=(bd.DecodeRecord(r,[["task",s.j$61,1],["nodes",bd.DecodeStringMap(s.j$17),0],["edges",bd.DecodeStringMap(bd.DecodeList(s.j$63)),0],["expanded",bd.Id(),0]]))();};t.j$13=function(){return t._v$13?t._v$13:t._v$13=(bd.EncodeRecord(r,[["task",t.j$14,1],["nodes",bd.EncodeStringMap(t.j$16),0],["edges",bd.EncodeStringMap(bd.EncodeList(t.j$73)),0],["expanded",bd.Id(),0]]))();};s.j$17=function(){return s._v$17?s._v$17:s._v$17=(bd.DecodeRecord($,[["top",s.j$18,0],["systems",bd.DecodeList(s.j$18),0]]))();};t.j$16=function(){return t._v$16?t._v$16:t._v$16=(bd.EncodeRecord($,[["top",t.j$17,0],["systems",bd.EncodeList(t.j$17),0]]))();};t.j=function(){return t._v?t._v:t._v=(bd.EncodeRecord(void 0,[["content_type",bd.Id(),0],["id",bd.Id(),0],["display_name",bd.Id(),0],["node_id",bd.Id(),1],["instance",bd.Id(),1],["content",bd.EncodeArray(bd.Id()),1],["save_content",bd.Id(),1]]))();};t.j$82=function(){return t._v$82?t._v$82:t._v$82=(bd.EncodeRecord(void 0,[["nodeId",bd.Id(),0],["iteration",bd.Id(),0],["lkincreased",bd.Id(),0],["state",t.j$83,0],["mlesims",bd.EncodeList(t.j$95),1],["summary",bd.Id(),0]]))();};t.j$105=function(){return t._v$105?t._v$105:t._v$105=(bd.EncodeRecord(void 0,[["nodeId",bd.Id(),0],["parameters",bd.EncodeList(t.j$106),0]]))();};t.j$8=function(){return t._v$8?t._v$8:t._v$8=(bd.EncodeRecord(void 0,[["states",bd.EncodeArray(t.j$9),0],["start_index",bd.Id(),0],["attributes",bd.EncodeArray(bd.Id()),0]]))();};t.j$79=function(){return t._v$79?t._v$79:t._v$79=(bd.EncodeRecord(void 0,[["value_type",t.j$80,0],["instances",bd.EncodeList(t.j$81),0]]))();};t.j$78=function(){return t._v$78?t._v$78:t._v$78=(bd.EncodeRecord(void 0,[["time",bd.Id(),0],["values",bd.EncodeArray(bd.Id()),0]]))();};s.j$13=function(){return s._v$13?s._v$13:s._v$13=(bd.DecodeRecord(by,[["model",bd.Id(),0],["sweep",bd.Id(),0],["assignment",bd.Id(),0],["environment",bd.DecodeStringMap(bd.Id()),0],["settings",s.j$14,0],["name",bd.Id(),0]]))();};t.j$77=function(){return t._v$77?t._v$77:t._v$77=(bd.EncodeRecord(void 0,[["name",bd.Id(),0],["structural",bd.Id(),1],["svg",bd.Id(),1]]))();};t.j$12=function(){return t._v$12?t._v$12:t._v$12=(bd.EncodeRecord(void 0,[["time",bd.Id(),0],["values",bd.EncodeArray(bd.Id()),0]]))();};t.j$7=function(){return t._v$7?t._v$7:t._v$7=(bd.EncodeRecord(void 0,[["times",bd.EncodeList(bd.Id()),0],["stateprobabilities",bd.EncodeList(bd.EncodeArray(bd.Id())),0],["stoichiometry",bd.EncodeArray(bd.EncodeArray(bd.Id())),0],["species",bd.EncodeStringDictionary(bd.Id()),0]]))();};t.j$6=function(){return t._v$6?t._v$6:t._v$6=(bd.EncodeRecord(void 0,[["times",bd.EncodeList(bd.Id()),0],["values",bd.EncodeList(bd.Id()),0],["probabilities",bd.EncodeList(bd.EncodeArray(bd.Id())),0]]))();};s.j$16=function(){return s._v$16?s._v$16:s._v$16=(bd.DecodeRecord(void 0,[["times",bd.DecodeList(bd.Id()),0],["stateprobabilities",bd.DecodeList(bd.DecodeArray(bd.Id())),0],["stoichiometry",bd.DecodeArray(bd.DecodeArray(bd.Id())),0],["species",bd.DecodeStringDictionary(bd.Id()),0]]))();};t.j$5=function(){return t._v$5?t._v$5:t._v$5=(bd.EncodeRecord(void 0,[["time",bd.Id(),0],["values",bd.EncodeArray(bd.EncodeArray(bd.Id())),0]]))();};t.j$4=function(){return t._v$4?t._v$4:t._v$4=(bd.EncodeRecord(void 0,[["time",bd.Id(),0],["values",bd.EncodeArray(bd.EncodeArray(bd.EncodeArray(bd.Id()))),0]]))();};t.j$1=function(){return t._v$1?t._v$1:t._v$1=(bd.EncodeRecord(void 0,[["times",bd.EncodeList(bd.Id()),0],["columns",bd.EncodeList(t.j$3),0]]))();};s.j$7=function(){return s._v$7?s._v$7:s._v$7=(bd.DecodeUnion(void 0,{Item1:13,Round:12,Floor:11,Ceiling:10,Modulo:9,Log:8,Absolute:7,Minus:6,Plus:5,Power:4,Divide:3,Times:2,Float:1,Key:0},[["Key",[["$0","Key",bd.Id(),0]]],["Float",[["$0","Float",bd.Id(),0]]],["Times",[["$0","Times",bd.DecodeList(s.j$7),0]]],["Divide",[["$0","Divide",s.j$12,0]]],["Power",[["$0","Power",s.j$11,0]]],["Plus",[["$0","Plus",bd.DecodeList(s.j$7),0]]],["Minus",[["$0","Minus",s.j$10,0]]],["Absolute",[["$0","Absolute",s.j$7,0]]],["Log",[["$0","Log",s.j$7,0]]],["Modulo",[["$0","Modulo",s.j$9,0]]],["Ceiling",[["$0","Ceiling",s.j$7,0]]],["Floor",[["$0","Floor",s.j$7,0]]],["Round",[["$0","Round",s.j$7,0]]],["If",[["$0","Item1",s.j$8,0],["$1","Item2",s.j$7,0],["$2","Item3",s.j$7,0]]]]))();};s.j=function(){return s._v?s._v:s._v=(bd.DecodeUnion(void 0,{Item1:13,Round:12,Floor:11,Ceiling:10,Modulo:9,Log:8,Absolute:7,Minus:6,Plus:5,Power:4,Divide:3,Times:2,Float:1,Key:0},[["Key",[["$0","Key",bd.DecodeList(bd.DecodeTuple([bd.Id(),bd.Id()])),0]]],["Float",[["$0","Float",bd.Id(),0]]],["Times",[["$0","Times",bd.DecodeList(s.j),0]]],["Divide",[["$0","Divide",s.j$6,0]]],["Power",[["$0","Power",s.j$5,0]]],["Plus",[["$0","Plus",bd.DecodeList(s.j),0]]],["Minus",[["$0","Minus",s.j$4,0]]],["Absolute",[["$0","Absolute",s.j,0]]],["Log",[["$0","Log",s.j,0]]],["Modulo",[["$0","Modulo",s.j$3,0]]],["Ceiling",[["$0","Ceiling",s.j,0]]],["Floor",[["$0","Floor",s.j,0]]],["Round",[["$0","Round",s.j,0]]],["If",[["$0","Item1",s.j$2,0],["$1","Item2",s.j,0],["$2","Item3",s.j,0]]]]))();};s.j$61=function(){return s._v$61?s._v$61:s._v$61=(bd.DecodeRecord(l,[["task_type",s.j$62,1],["copies",bd.Id(),0],["copy_id",bd.Id(),0],["nodes",bd.Id(),0]]))();};s.j$63=function(){return s._v$63?s._v$63:s._v$63=(bd.DecodeRecord(void 0,[["location",s.j$64,0],["parameters",bd.DecodeList(s.j$65),0]]))();};t.j$14=function(){return t._v$14?t._v$14:t._v$14=(bd.EncodeRecord(l,[["task_type",t.j$15,1],["copies",bd.Id(),0],["copy_id",bd.Id(),0],["nodes",bd.Id(),0]]))();};t.j$73=function(){return t._v$73?t._v$73:t._v$73=(bd.EncodeRecord(void 0,[["location",t.j$74,0],["parameters",bd.EncodeList(t.j$75),0]]))();};s.j$18=function(){return s._v$18?s._v$18:s._v$18=(bd.DecodeRecord(_,[["name",bd.Id(),0],["settings",s.j$19,0],["reactions",bd.DecodeList(s.j$51),0],["initials",bd.DecodeList(s.j$54),0],["attributes",bd.DecodeStringMap(bd.Id()),0]]))();};t.j$17=function(){return t._v$17?t._v$17:t._v$17=(bd.EncodeRecord(_,[["name",bd.Id(),0],["settings",t.j$18,0],["reactions",bd.EncodeList(t.j$65),0],["initials",bd.EncodeList(t.j$68),0],["attributes",bd.EncodeStringMap(bd.Id()),0]]))();};t.j$83=function(){return t._v$83?t._v$83:t._v$83=(bd.EncodeUnion(void 0,{SamplingPhase:1,BurninPhase:0},[["BurninPhase",[["$0","BurninPhase",t.j$93,0]]],["SamplingPhase",[["$0","SamplingPhase",t.j$84,0]]]]))();};t.j$95=function(){return t._v$95?t._v$95:t._v$95=(bd.EncodeRecord(void 0,[["instance",t.j$96,0],["table",t.j$55,0]]))();};t.j$106=function(){return t._v$106?t._v$106:t._v$106=(bd.EncodeRecord(void 0,[["name",bd.Id(),0],["range",t.j$107,0],["initValue",bd.Id(),1]]))();};t.j$9=function(){return t._v$9?t._v$9:t._v$9=(bd.EncodeRecord(void 0,[["species",bd.EncodeStringMap(bd.Id()),0],["transitions",bd.EncodeArray(bd.Id()),0]]))();};t.j$80=function(){return t._v$80?t._v$80:t._v$80=(bd.EncodeUnion(void 0,"$",[null,null,null,null,null,null]))();};t.j$81=function(){return t._v$81?t._v$81:t._v$81=(bd.EncodeRecord(by,[["model",bd.Id(),0],["sweep",bd.Id(),0],["assignment",bd.Id(),0],["environment",bd.EncodeStringMap(bd.Id()),0],["settings",t.j$19,0],["name",bd.Id(),0]]))();};s.j$14=function(){return s._v$14?s._v$14:s._v$14=(bd.DecodeRecord(bx,[["name",bd.Id(),0],["initial",bd.Id(),0],["final",bd.Id(),0],["points",bd.Id(),0],["plots",bd.DecodeList(bd.Id()),0],["plotcolours",bd.DecodeList(bd.Id()),0],["seed",bd.Id(),1],["kinetics",s.j$15,0],["times",bd.DecodeList(bd.Id()),0],["prune",bd.Id(),0],["multicore",bd.Id(),0],["data",bd.DecodeList(bd.Id()),0],["sweeps",bd.DecodeList(bd.Id()),0]]))();};t.j$3=function(){return t._v$3?t._v$3:t._v$3=(bd.EncodeRecord(void 0,[["name",bd.Id(),0],["values",bd.EncodeList(bd.Id()),0]]))();};s.j$12=function(){return s._v$12?s._v$12:s._v$12=(bd.DecodeRecord(void 0,[["div1",s.j$7,0],["div2",s.j$7,0]]))();};s.j$11=function(){return s._v$11?s._v$11:s._v$11=(bd.DecodeRecord(void 0,[["base_",s.j$7,0],["exponent",s.j$7,0]]))();};s.j$10=function(){return s._v$10?s._v$10:s._v$10=(bd.DecodeRecord(void 0,[["sub1",s.j$7,0],["sub2",s.j$7,0]]))();};s.j$9=function(){return s._v$9?s._v$9:s._v$9=(bd.DecodeRecord(void 0,[["div",s.j$7,0],["modulo",s.j$7,0]]))();};s.j$8=function(){return s._v$8?s._v$8:s._v$8=(bd.DecodeUnion(void 0,"$",[[0,[]],[1,[]],[2,[["$0","Item1",s.j$7,0],["$1","Item2",s.j$7,0]]],[3,[["$0","Item1",s.j$7,0],["$1","Item2",s.j$7,0]]],[4,[["$0","Item1",s.j$7,0],["$1","Item2",s.j$7,0]]],[5,[["$0","Item1",s.j$7,0],["$1","Item2",s.j$7,0]]],[6,[["$0","Item1",s.j$7,0],["$1","Item2",s.j$7,0]]],[7,[["$0","Item",s.j$8,0]]],[8,[["$0","Item1",s.j$8,0],["$1","Item2",s.j$8,0]]],[9,[["$0","Item1",s.j$8,0],["$1","Item2",s.j$8,0]]]]))();};s.j$6=function(){return s._v$6?s._v$6:s._v$6=(bd.DecodeRecord(void 0,[["div1",s.j,0],["div2",s.j,0]]))();};s.j$5=function(){return s._v$5?s._v$5:s._v$5=(bd.DecodeRecord(void 0,[["base_",s.j,0],["exponent",s.j,0]]))();};s.j$4=function(){return s._v$4?s._v$4:s._v$4=(bd.DecodeRecord(void 0,[["sub1",s.j,0],["sub2",s.j,0]]))();};s.j$3=function(){return s._v$3?s._v$3:s._v$3=(bd.DecodeRecord(void 0,[["div",s.j,0],["modulo",s.j,0]]))();};s.j$2=function(){return s._v$2?s._v$2:s._v$2=(bd.DecodeUnion(void 0,"$",[[0,[]],[1,[]],[2,[["$0","Item1",s.j,0],["$1","Item2",s.j,0]]],[3,[["$0","Item1",s.j,0],["$1","Item2",s.j,0]]],[4,[["$0","Item1",s.j,0],["$1","Item2",s.j,0]]],[5,[["$0","Item1",s.j,0],["$1","Item2",s.j,0]]],[6,[["$0","Item1",s.j,0],["$1","Item2",s.j,0]]],[7,[["$0","Item",s.j$2,0]]],[8,[["$0","Item1",s.j$2,0],["$1","Item2",s.j$2,0]]],[9,[["$0","Item1",s.j$2,0],["$1","Item2",s.j$2,0]]]]))();};s.j$62=function(){return s._v$62?s._v$62:s._v$62=(bd.DecodeUnion(void 0,"$",[null,null,null]))();};s.j$64=function(){return s._v$64?s._v$64:s._v$64=(bd.DecodeUnion(n,{SystemLoc:1,NodeLoc:0},[["NodeLoc",[["$0","NodeLoc",bd.Id(),0]]],["SystemLoc",[["$0","SystemLoc",bd.DecodeTuple([bd.Id(),bd.Id()]),0]]]]))();};s.j$65=function(){return s._v$65?s._v$65:s._v$65=(bd.DecodeRecord(void 0,[["source",bd.Id(),0],["target",bd.Id(),0],["prior",s.j$66,0]]))();};t.j$15=function(){return t._v$15?t._v$15:t._v$15=(bd.EncodeUnion(void 0,"$",[null,null,null]))();};t.j$74=function(){return t._v$74?t._v$74:t._v$74=(bd.EncodeUnion(n,{SystemLoc:1,NodeLoc:0},[["NodeLoc",[["$0","NodeLoc",bd.Id(),0]]],["SystemLoc",[["$0","SystemLoc",bd.EncodeTuple([bd.Id(),bd.Id()]),0]]]]))();};t.j$75=function(){return t._v$75?t._v$75:t._v$75=(bd.EncodeRecord(void 0,[["source",bd.Id(),0],["target",bd.Id(),0],["prior",t.j$76,0]]))();};s.j$19=function(){return s._v$19?s._v$19:s._v$19=(bd.DecodeRecord(Y,[["simulation",s.j$14,0],["simulations",bd.DecodeList(s.j$14),0],["stochastic",s.j$20,0],["deterministic",bd.Id(),0],["spatial",s.j$22,0],["inference",s.j$33,0],["moment_closure",s.j$36,0],["synthesis",s.j$37,0],["data",bd.DecodeList(s.j$40),0],["units",s.j$43,0],["simulator",s.j$47,0],["parameters",bd.DecodeList(s.j$23),0],["sweeps",bd.DecodeList(s.j$48),0],["rates",bd.DecodeStringMap(bd.Id()),0],["plot",s.j$50,0],["quiet",bd.Id(),0]]))();};s.j$51=function(){return s._v$51?s._v$51:s._v$51=(bd.DecodeRecord(_2,[["catalysts",bd.DecodeList(bd.Id()),0],["reactants",bd.DecodeList(bd.Id()),0],["reverse",s.j$53,1],["rate",s.j$53,0],["products",bd.DecodeList(bd.Id()),0]]))();};s.j$54=function(){return s._v$54?s._v$54:s._v$54=(bd.DecodeRecord(_8,[["constant",bd.Id(),0],["value",bd.Id(),0],["species",bd.Id(),0],["time",bd.Id(),1],["spatial",s.j$55,1]]))();};t.j$18=function(){return t._v$18?t._v$18:t._v$18=(bd.EncodeRecord(Y,[["simulation",t.j$19,0],["simulations",bd.EncodeList(t.j$19),0],["stochastic",t.j$21,0],["deterministic",bd.Id(),0],["spatial",t.j$23,0],["inference",t.j$40,0],["moment_closure",t.j$43,0],["synthesis",t.j$51,0],["data",bd.EncodeList(t.j$54),0],["units",t.j$57,0],["simulator",t.j$61,0],["parameters",bd.EncodeList(t.j$24),0],["sweeps",bd.EncodeList(t.j$62),0],["rates",bd.EncodeStringMap(bd.Id()),0],["plot",t.j$64,0],["quiet",bd.Id(),0]]))();};t.j$65=function(){return t._v$65?t._v$65:t._v$65=(bd.EncodeRecord(_2,[["catalysts",bd.EncodeList(bd.Id()),0],["reactants",bd.EncodeList(bd.Id()),0],["reverse",t.j$67,1],["rate",t.j$67,0],["products",bd.EncodeList(bd.Id()),0]]))();};t.j$68=function(){return t._v$68?t._v$68:t._v$68=(bd.EncodeRecord(_8,[["constant",bd.Id(),0],["value",bd.Id(),0],["species",bd.Id(),0],["time",bd.Id(),1],["spatial",t.j$69,1]]))();};t.j$93=function(){return t._v$93?t._v$93:t._v$93=(bd.EncodeRecord(void 0,[["space",bd.EncodeStringDictionary(t.j$85),0],["state",t.j$87,0],["stats",bd.EncodeArray(bd.Id()),0],["mle",t.j$87,0],["priors",bd.EncodeArray(t.j$88),0],["indexes",bd.EncodeArray(bd.Id()),0]]))();};t.j$84=function(){return t._v$84?t._v$84:t._v$84=(bd.EncodeRecord(void 0,[["space",bd.EncodeStringDictionary(t.j$85),0],["state",t.j$87,0],["thinningSkippedCount",bd.Id(),0],["chain",bd.EncodeList(t.j$87),0],["mle",t.j$87,0],["priors",bd.EncodeArray(t.j$88),0],["indexes",bd.EncodeArray(bd.Id()),0]]))();};t.j$96=function(){return t._v$96?t._v$96:t._v$96=(bd.EncodeRecord(by,[["model",bd.Id(),0],["sweep",bd.Id(),0],["assignment",bd.Id(),0],["environment",bd.EncodeStringMap(bd.Id()),0],["settings",t.j$104,0],["name",bd.Id(),0]]))();};t.j$55=function(){return t._v$55?t._v$55:t._v$55=(bd.EncodeRecord(void 0,[["times",bd.EncodeList(bd.Id()),0],["columns",bd.EncodeList(t.j$56),0]]))();};t.j$107=function(){return t._v$107?t._v$107:t._v$107=(bd.EncodeRecord(void 0,[["pType",t.j$108,0],["lb",bd.Id(),0],["ub",bd.Id(),0]]))();};t.j$19=function(){return t._v$19?t._v$19:t._v$19=(bd.EncodeRecord(bx,[["name",bd.Id(),0],["initial",bd.Id(),0],["final",bd.Id(),0],["points",bd.Id(),0],["plots",bd.EncodeList(bd.Id()),0],["plotcolours",bd.EncodeList(bd.Id()),0],["seed",bd.Id(),1],["kinetics",t.j$20,0],["times",bd.EncodeList(bd.Id()),0],["prune",bd.Id(),0],["multicore",bd.Id(),0],["data",bd.EncodeList(bd.Id()),0],["sweeps",bd.EncodeList(bd.Id()),0]]))();};s.j$15=function(){return s._v$15?s._v$15:s._v$15=(bd.DecodeUnion(void 0,"$",[null,null,null]))();};s.j$66=function(){return s._v$66?s._v$66:s._v$66=(bd.DecodeUnion(void 0,"$",[null,null,null,null]))();};t.j$76=function(){return t._v$76?t._v$76:t._v$76=(bd.EncodeUnion(void 0,"$",[null,null,null,null]))();};s.j$20=function(){return s._v$20?s._v$20:s._v$20=(bd.DecodeRecord(void 0,[["scale",bd.Id(),0],["steps",bd.Id(),1],["trajectories",bd.Id(),0],["stationary_skiptime",bd.Id(),1]]))();};s.j$22=function(){return s._v$22?s._v$22:s._v$22=(bd.DecodeRecord(void 0,[["parameters",bd.DecodeList(s.j$23),0],["diffusibles",bd.DecodeList(bd.DecodeTuple([bd.Id(),s.j$7])),0],["dimensions",bd.Id(),0],["boundary",s.j$32,0],["xmax",bd.Id(),0],["nx",bd.Id(),0],["dt",bd.Id(),0],["default_diffusion",bd.Id(),0],["random",bd.Id(),0]]))();};s.j$33=function(){return s._v$33?s._v$33:s._v$33=(bd.DecodeRecord(void 0,[["name",bd.Id(),0],["burnin",bd.Id(),0],["samples",bd.Id(),0],["thin",bd.Id(),0],["noise_model",s.j$34,0],["noise_parameter",s.j$35,0],["prune",bd.Id(),0],["seed",bd.Id(),0],["seeds",bd.DecodeList(bd.Id()),0],["lowerbound",bd.Id(),1],["timer",bd.Id(),0],["partial_evaluation",bd.Id(),0],["print_console",bd.Id(),0],["print_summary",bd.Id(),0]]))();};s.j$36=function(){return s._v$36?s._v$36:s._v$36=(bd.DecodeRecord(void 0,[["order",bd.Id(),0],["initial_minimum",bd.Id(),0],["log_evaluation",bd.Id(),0],["plots",bd.DecodeList(s.j),0]]))();};s.j$37=function(){return s._v$37?s._v$37:s._v$37=(bd.DecodeRecord(void 0,[["mode",s.j$38,0],["solver",s.j$39,0],["timeout",bd.Id(),1],["seed",bd.Id(),1]]))();};s.j$40=function(){return s._v$40?s._v$40:s._v$40=(bd.DecodeRecord(void 0,[["file",bd.Id(),0],["data",bd.DecodeList(s.j$41),0]]))();};s.j$43=function(){return s._v$43?s._v$43:s._v$43=(bd.DecodeRecord(T,[["concentration",s.j$44,0],["time",s.j$45,0],["space",s.j$46,0]]))();};s.j$47=function(){return s._v$47?s._v$47:s._v$47=(bd.DecodeUnion(void 0,"$",[null,null,null,null,null,null,null,null]))();};s.j$23=function(){return s._v$23?s._v$23:s._v$23=(bd.DecodeRecord(F,[["name",bd.Id(),0],["value",bd.Id(),0],["prior",s.j$24,1]]))();};s.j$48=function(){return s._v$48?s._v$48:s._v$48=(bd.DecodeRecord(W,[["name",bd.Id(),0],["assignments",bd.DecodeList(s.j$49),0]]))();};s.j$50=function(){return s._v$50?s._v$50:s._v$50=(bd.DecodeRecord(X,[["x_label",bd.Id(),0],["y_label",bd.Id(),0],["title",bd.Id(),0],["label_font_size",bd.Id(),0],["tick_font_size",bd.Id(),0],["x_ticks",bd.DecodeList(bd.Id()),0],["y_ticks",bd.DecodeList(bd.Id()),0],["x_min",bd.Id(),1],["x_max",bd.Id(),1],["y_min",bd.Id(),1],["y_max",bd.Id(),1],["v_boundaries",bd.DecodeList(bd.Id()),0],["h_boundaries",bd.DecodeList(bd.Id()),0]]))();};s.j$53=function(){return s._v$53?s._v$53:s._v$53=(bd.DecodeUnion(_1,{Function:1,MassAction:0},[["MassAction",[["$0","MassAction",bd.Id(),0]]],["Function",[["$0","Function",bd.Id(),0]]]]))();};s.j$55=function(){return s._v$55?s._v$55:s._v$55=(bd.DecodeRecord(void 0,[["random",bd.Id(),0],["core",s.j$56,1],["points",bd.DecodeList(s.j$57),0],["rectangles",bd.DecodeList(s.j$58),0]]))();};t.j$21=function(){return t._v$21?t._v$21:t._v$21=(bd.EncodeRecord(void 0,[["scale",bd.Id(),0],["steps",bd.Id(),1],["trajectories",bd.Id(),0],["stationary_skiptime",bd.Id(),1]]))();};t.j$23=function(){return t._v$23?t._v$23:t._v$23=(bd.EncodeRecord(void 0,[["parameters",bd.EncodeList(t.j$24),0],["diffusibles",bd.EncodeList(bd.EncodeTuple([bd.Id(),t.j$33])),0],["dimensions",bd.Id(),0],["boundary",t.j$39,0],["xmax",bd.Id(),0],["nx",bd.Id(),0],["dt",bd.Id(),0],["default_diffusion",bd.Id(),0],["random",bd.Id(),0]]))();};t.j$40=function(){return t._v$40?t._v$40:t._v$40=(bd.EncodeRecord(void 0,[["name",bd.Id(),0],["burnin",bd.Id(),0],["samples",bd.Id(),0],["thin",bd.Id(),0],["noise_model",t.j$41,0],["noise_parameter",t.j$42,0],["prune",bd.Id(),0],["seed",bd.Id(),0],["seeds",bd.EncodeList(bd.Id()),0],["lowerbound",bd.Id(),1],["timer",bd.Id(),0],["partial_evaluation",bd.Id(),0],["print_console",bd.Id(),0],["print_summary",bd.Id(),0]]))();};t.j$43=function(){return t._v$43?t._v$43:t._v$43=(bd.EncodeRecord(void 0,[["order",bd.Id(),0],["initial_minimum",bd.Id(),0],["log_evaluation",bd.Id(),0],["plots",bd.EncodeList(t.j$44),0]]))();};t.j$51=function(){return t._v$51?t._v$51:t._v$51=(bd.EncodeRecord(void 0,[["mode",t.j$52,0],["solver",t.j$53,0],["timeout",bd.Id(),1],["seed",bd.Id(),1]]))();};t.j$54=function(){return t._v$54?t._v$54:t._v$54=(bd.EncodeRecord(void 0,[["file",bd.Id(),0],["data",bd.EncodeList(t.j$55),0]]))();};t.j$57=function(){return t._v$57?t._v$57:t._v$57=(bd.EncodeRecord(T,[["concentration",t.j$58,0],["time",t.j$59,0],["space",t.j$60,0]]))();};t.j$61=function(){return t._v$61?t._v$61:t._v$61=(bd.EncodeUnion(void 0,"$",[null,null,null,null,null,null,null,null]))();};t.j$24=function(){return t._v$24?t._v$24:t._v$24=(bd.EncodeRecord(F,[["name",bd.Id(),0],["value",bd.Id(),0],["prior",t.j$25,1]]))();};t.j$62=function(){return t._v$62?t._v$62:t._v$62=(bd.EncodeRecord(W,[["name",bd.Id(),0],["assignments",bd.EncodeList(t.j$63),0]]))();};t.j$64=function(){return t._v$64?t._v$64:t._v$64=(bd.EncodeRecord(X,[["x_label",bd.Id(),0],["y_label",bd.Id(),0],["title",bd.Id(),0],["label_font_size",bd.Id(),0],["tick_font_size",bd.Id(),0],["x_ticks",bd.EncodeList(bd.Id()),0],["y_ticks",bd.EncodeList(bd.Id()),0],["x_min",bd.Id(),1],["x_max",bd.Id(),1],["y_min",bd.Id(),1],["y_max",bd.Id(),1],["v_boundaries",bd.EncodeList(bd.Id()),0],["h_boundaries",bd.EncodeList(bd.Id()),0]]))();};t.j$67=function(){return t._v$67?t._v$67:t._v$67=(bd.EncodeUnion(_1,{Function:1,MassAction:0},[["MassAction",[["$0","MassAction",bd.Id(),0]]],["Function",[["$0","Function",bd.Id(),0]]]]))();};t.j$69=function(){return t._v$69?t._v$69:t._v$69=(bd.EncodeRecord(void 0,[["random",bd.Id(),0],["core",t.j$70,1],["points",bd.EncodeList(t.j$71),0],["rectangles",bd.EncodeList(t.j$72),0]]))();};u.p=function(hI){return hI=="MC"?"MC":hI=="PDE"?"PDE":hI=="LNA"?"LNA":hI=="CMESundials"?"CMESundials":hI=="CME"?"CME":hI=="SSA"?"SSA":hI=="Sundials"?"Sundials":"Oslo";};t.j$85=function(){return t._v$85?t._v$85:t._v$85=(bd.EncodeRecord(void 0,[["pType",t.j$86,0],["lb",bd.Id(),0],["ub",bd.Id(),0]]))();};t.j$87=function(){return t._v$87?t._v$87:t._v$87=(bd.EncodeRecord(void 0,[["values",bd.EncodeStringDictionary(bd.Id()),0],["lglk",bd.Id(),0]]))();};t.j$88=function(){return t._v$88?t._v$88:t._v$88=(bd.EncodeUnion(void 0,"$",[null,[1,[["$0","Value",t.j$89,0]]]]))();};t.j$104=function(){return t._v$104?t._v$104:t._v$104=(bd.EncodeRecord(bx,[["name",bd.Id(),0],["initial",bd.Id(),0],["final",bd.Id(),0],["points",bd.Id(),0],["plots",bd.EncodeList(t.j$97),0],["plotcolours",bd.EncodeList(bd.Id()),0],["seed",bd.Id(),1],["kinetics",t.j$20,0],["times",bd.EncodeList(bd.Id()),0],["prune",bd.Id(),0],["multicore",bd.Id(),0],["data",bd.EncodeList(bd.Id()),0],["sweeps",bd.EncodeList(bd.Id()),0]]))();};t.j$56=function(){return t._v$56?t._v$56:t._v$56=(bd.EncodeRecord(void 0,[["name",bd.Id(),0],["values",bd.EncodeList(bd.Id()),0]]))();};t.j$108=function(){return t._v$108?t._v$108:t._v$108=(bd.EncodeUnion(void 0,"$",[null,null,null]))();};t.j$20=function(){return t._v$20?t._v$20:t._v$20=(bd.EncodeUnion(void 0,"$",[null,null,null]))();};s.j$32=function(){return s._v$32?s._v$32:s._v$32=(bd.DecodeUnion(void 0,"$",[null,null]))();};s.j$34=function(){return s._v$34?s._v$34:s._v$34=(bd.DecodeUnion(void 0,"$",[null,null]))();};s.j$35=function(){return s._v$35?s._v$35:s._v$35=(bd.DecodeUnion(void 0,"$",[[0,[["$0","Fixed",bd.Id(),0]]],null,null]))();};s.j$38=function(){return s._v$38?s._v$38:s._v$38=(bd.DecodeUnion(void 0,"$",[null,null]))();};s.j$39=function(){return s._v$39?s._v$39:s._v$39=(bd.DecodeUnion(void 0,"$",[null,null]))();};s.j$41=function(){return s._v$41?s._v$41:s._v$41=(bd.DecodeRecord(void 0,[["times",bd.DecodeList(bd.Id()),0],["columns",bd.DecodeList(s.j$42),0]]))();};s.j$44=function(){return s._v$44?s._v$44:s._v$44=(bd.DecodeUnion(Q,{Molar:0},[["Molar",[["$0","Molar",bd.Id(),0]]]]))();};s.j$45=function(){return s._v$45?s._v$45:s._v$45=(bd.DecodeUnion(R,{Seconds:0},[["Seconds",[["$0","Seconds",bd.Id(),0]]]]))();};s.j$46=function(){return s._v$46?s._v$46:s._v$46=(bd.DecodeUnion(S,{Metres:0},[["Metres",[["$0","Metres",bd.Id(),0]]]]))();};s.j$24=function(){return s._v$24?s._v$24:s._v$24=(bd.DecodeRecord(void 0,[["interval",s.j$25,0],["distribution",s.j$26,0],["variation",s.j$31,0]]))();};s.j$49=function(){return s._v$49?s._v$49:s._v$49=(bd.DecodeRecord(V,[["variables",bd.DecodeList(bd.Id()),0],["values",bd.DecodeList(bd.DecodeList(s.j$7)),0]]))();};s.j$56=function(){return s._v$56?s._v$56:s._v$56=(bd.DecodeRecord(_4,[["inner",bd.Id(),0],["outer",bd.Id(),0],["width",bd.Id(),0]]))();};s.j$57=function(){return s._v$57?s._v$57:s._v$57=(bd.DecodeRecord(_5,[["x",bd.Id(),0],["y",bd.Id(),0],["width",bd.Id(),0],["value",bd.Id(),0]]))();};s.j$58=function(){return s._v$58?s._v$58:s._v$58=(bd.DecodeRecord(_6,[["xmin",bd.Id(),0],["xmax",bd.Id(),0],["ymin",bd.Id(),0],["ymax",bd.Id(),0],["value",bd.Id(),0]]))();};t.j$33=function(){return t._v$33?t._v$33:t._v$33=(bd.EncodeUnion(void 0,{Item1:13,Round:12,Floor:11,Ceiling:10,Modulo:9,Log:8,Absolute:7,Minus:6,Plus:5,Power:4,Divide:3,Times:2,Float:1,Key:0},[["Key",[["$0","Key",bd.Id(),0]]],["Float",[["$0","Float",bd.Id(),0]]],["Times",[["$0","Times",bd.EncodeList(t.j$33),0]]],["Divide",[["$0","Divide",t.j$38,0]]],["Power",[["$0","Power",t.j$37,0]]],["Plus",[["$0","Plus",bd.EncodeList(t.j$33),0]]],["Minus",[["$0","Minus",t.j$36,0]]],["Absolute",[["$0","Absolute",t.j$33,0]]],["Log",[["$0","Log",t.j$33,0]]],["Modulo",[["$0","Modulo",t.j$35,0]]],["Ceiling",[["$0","Ceiling",t.j$33,0]]],["Floor",[["$0","Floor",t.j$33,0]]],["Round",[["$0","Round",t.j$33,0]]],["If",[["$0","Item1",t.j$34,0],["$1","Item2",t.j$33,0],["$2","Item3",t.j$33,0]]]]))();};t.j$39=function(){return t._v$39?t._v$39:t._v$39=(bd.EncodeUnion(void 0,"$",[null,null]))();};t.j$41=function(){return t._v$41?t._v$41:t._v$41=(bd.EncodeUnion(void 0,"$",[null,null]))();};t.j$42=function(){return t._v$42?t._v$42:t._v$42=(bd.EncodeUnion(void 0,"$",[[0,[["$0","Fixed",bd.Id(),0]]],null,null]))();};t.j$44=function(){return t._v$44?t._v$44:t._v$44=(bd.EncodeUnion(void 0,{Item1:13,Round:12,Floor:11,Ceiling:10,Modulo:9,Log:8,Absolute:7,Minus:6,Plus:5,Power:4,Divide:3,Times:2,Float:1,Key:0},[["Key",[["$0","Key",bd.EncodeList(bd.EncodeTuple([bd.Id(),bd.Id()])),0]]],["Float",[["$0","Float",bd.Id(),0]]],["Times",[["$0","Times",bd.EncodeList(t.j$44),0]]],["Divide",[["$0","Divide",t.j$50,0]]],["Power",[["$0","Power",t.j$49,0]]],["Plus",[["$0","Plus",bd.EncodeList(t.j$44),0]]],["Minus",[["$0","Minus",t.j$48,0]]],["Absolute",[["$0","Absolute",t.j$44,0]]],["Log",[["$0","Log",t.j$44,0]]],["Modulo",[["$0","Modulo",t.j$47,0]]],["Ceiling",[["$0","Ceiling",t.j$44,0]]],["Floor",[["$0","Floor",t.j$44,0]]],["Round",[["$0","Round",t.j$44,0]]],["If",[["$0","Item1",t.j$46,0],["$1","Item2",t.j$44,0],["$2","Item3",t.j$44,0]]]]))();};t.j$52=function(){return t._v$52?t._v$52:t._v$52=(bd.EncodeUnion(void 0,"$",[null,null]))();};t.j$53=function(){return t._v$53?t._v$53:t._v$53=(bd.EncodeUnion(void 0,"$",[null,null]))();};t.j$58=function(){return t._v$58?t._v$58:t._v$58=(bd.EncodeUnion(Q,{Molar:0},[["Molar",[["$0","Molar",bd.Id(),0]]]]))();};t.j$59=function(){return t._v$59?t._v$59:t._v$59=(bd.EncodeUnion(R,{Seconds:0},[["Seconds",[["$0","Seconds",bd.Id(),0]]]]))();};t.j$60=function(){return t._v$60?t._v$60:t._v$60=(bd.EncodeUnion(S,{Metres:0},[["Metres",[["$0","Metres",bd.Id(),0]]]]))();};t.j$25=function(){return t._v$25?t._v$25:t._v$25=(bd.EncodeRecord(void 0,[["interval",t.j$26,0],["distribution",t.j$27,0],["variation",t.j$32,0]]))();};t.j$63=function(){return t._v$63?t._v$63:t._v$63=(bd.EncodeRecord(V,[["variables",bd.EncodeList(bd.Id()),0],["values",bd.EncodeList(bd.EncodeList(t.j$33)),0]]))();};t.j$70=function(){return t._v$70?t._v$70:t._v$70=(bd.EncodeRecord(_4,[["inner",bd.Id(),0],["outer",bd.Id(),0],["width",bd.Id(),0]]))();};t.j$71=function(){return t._v$71?t._v$71:t._v$71=(bd.EncodeRecord(_5,[["x",bd.Id(),0],["y",bd.Id(),0],["width",bd.Id(),0],["value",bd.Id(),0]]))();};t.j$72=function(){return t._v$72?t._v$72:t._v$72=(bd.EncodeRecord(_6,[["xmin",bd.Id(),0],["xmax",bd.Id(),0],["ymin",bd.Id(),0],["ymax",bd.Id(),0],["value",bd.Id(),0]]))();};t.j$86=function(){return t._v$86?t._v$86:t._v$86=(bd.EncodeUnion(void 0,"$",[[0,[]],[1,[]],[2,[]]]))();};t.j$89=function(){return t._v$89?t._v$89:t._v$89=(bd.EncodeUnion(void 0,"$",[[0,[[null,true,bd.Id()]]],[1,[[null,true,bd.Id()]]],[2,[[null,true,bd.Id()]]]]))();};t.j$97=function(){return t._v$97?t._v$97:t._v$97=(bd.EncodeUnion(void 0,{Item1:13,Round:12,Floor:11,Ceiling:10,Modulo:9,Log:8,Absolute:7,Minus:6,Plus:5,Power:4,Divide:3,Times:2,Float:1,Key:0},[["Key",[["$0","Key",t.j$98,0]]],["Float",[["$0","Float",bd.Id(),0]]],["Times",[["$0","Times",bd.EncodeList(t.j$97),0]]],["Divide",[["$0","Divide",t.j$103,0]]],["Power",[["$0","Power",t.j$102,0]]],["Plus",[["$0","Plus",bd.EncodeList(t.j$97),0]]],["Minus",[["$0","Minus",t.j$101,0]]],["Absolute",[["$0","Absolute",t.j$97,0]]],["Log",[["$0","Log",t.j$97,0]]],["Modulo",[["$0","Modulo",t.j$100,0]]],["Ceiling",[["$0","Ceiling",t.j$97,0]]],["Floor",[["$0","Floor",t.j$97,0]]],["Round",[["$0","Round",t.j$97,0]]],["If",[["$0","Item1",t.j$99,0],["$1","Item2",t.j$97,0],["$2","Item3",t.j$97,0]]]]))();};s.j$42=function(){return s._v$42?s._v$42:s._v$42=(bd.DecodeRecord(void 0,[["name",bd.Id(),0],["values",bd.DecodeList(bd.Id()),0]]))();};s.j$25=function(){return s._v$25?s._v$25:s._v$25=(bd.DecodeUnion(void 0,"$",[null,null]))();};s.j$26=function(){return s._v$26?s._v$26:s._v$26=(bd.DecodeUnion(C,{TruncatedNormal:3,LogNormal:2,Normal:1,Uniform:0},[["Uniform",[["$0","Uniform",s.j$30,0]]],["Normal",[["$0","Normal",s.j$29,0]]],["LogNormal",[["$0","LogNormal",s.j$28,0]]],["TruncatedNormal",[["$0","TruncatedNormal",s.j$27,0]]]]))();};s.j$31=function(){return s._v$31?s._v$31:s._v$31=(bd.DecodeUnion(void 0,"$",[null,null,null,null]))();};t.j$38=function(){return t._v$38?t._v$38:t._v$38=(bd.EncodeRecord(void 0,[["div1",t.j$33,0],["div2",t.j$33,0]]))();};t.j$37=function(){return t._v$37?t._v$37:t._v$37=(bd.EncodeRecord(void 0,[["base_",t.j$33,0],["exponent",t.j$33,0]]))();};t.j$36=function(){return t._v$36?t._v$36:t._v$36=(bd.EncodeRecord(void 0,[["sub1",t.j$33,0],["sub2",t.j$33,0]]))();};t.j$35=function(){return t._v$35?t._v$35:t._v$35=(bd.EncodeRecord(void 0,[["div",t.j$33,0],["modulo",t.j$33,0]]))();};t.j$34=function(){return t._v$34?t._v$34:t._v$34=(bd.EncodeUnion(void 0,"$",[[0,[]],[1,[]],[2,[["$0","Item1",t.j$33,0],["$1","Item2",t.j$33,0]]],[3,[["$0","Item1",t.j$33,0],["$1","Item2",t.j$33,0]]],[4,[["$0","Item1",t.j$33,0],["$1","Item2",t.j$33,0]]],[5,[["$0","Item1",t.j$33,0],["$1","Item2",t.j$33,0]]],[6,[["$0","Item1",t.j$33,0],["$1","Item2",t.j$33,0]]],[7,[["$0","Item",t.j$34,0]]],[8,[["$0","Item1",t.j$34,0],["$1","Item2",t.j$34,0]]],[9,[["$0","Item1",t.j$34,0],["$1","Item2",t.j$34,0]]]]))();};t.j$50=function(){return t._v$50?t._v$50:t._v$50=(bd.EncodeRecord(void 0,[["div1",t.j$44,0],["div2",t.j$44,0]]))();};t.j$49=function(){return t._v$49?t._v$49:t._v$49=(bd.EncodeRecord(void 0,[["base_",t.j$44,0],["exponent",t.j$44,0]]))();};t.j$48=function(){return t._v$48?t._v$48:t._v$48=(bd.EncodeRecord(void 0,[["sub1",t.j$44,0],["sub2",t.j$44,0]]))();};t.j$47=function(){return t._v$47?t._v$47:t._v$47=(bd.EncodeRecord(void 0,[["div",t.j$44,0],["modulo",t.j$44,0]]))();};t.j$46=function(){return t._v$46?t._v$46:t._v$46=(bd.EncodeUnion(void 0,"$",[[0,[]],[1,[]],[2,[["$0","Item1",t.j$44,0],["$1","Item2",t.j$44,0]]],[3,[["$0","Item1",t.j$44,0],["$1","Item2",t.j$44,0]]],[4,[["$0","Item1",t.j$44,0],["$1","Item2",t.j$44,0]]],[5,[["$0","Item1",t.j$44,0],["$1","Item2",t.j$44,0]]],[6,[["$0","Item1",t.j$44,0],["$1","Item2",t.j$44,0]]],[7,[["$0","Item",t.j$46,0]]],[8,[["$0","Item1",t.j$46,0],["$1","Item2",t.j$46,0]]],[9,[["$0","Item1",t.j$46,0],["$1","Item2",t.j$46,0]]]]))();};t.j$26=function(){return t._v$26?t._v$26:t._v$26=(bd.EncodeUnion(void 0,"$",[null,null]))();};t.j$27=function(){return t._v$27?t._v$27:t._v$27=(bd.EncodeUnion(C,{TruncatedNormal:3,LogNormal:2,Normal:1,Uniform:0},[["Uniform",[["$0","Uniform",t.j$31,0]]],["Normal",[["$0","Normal",t.j$30,0]]],["LogNormal",[["$0","LogNormal",t.j$29,0]]],["TruncatedNormal",[["$0","TruncatedNormal",t.j$28,0]]]]))();};t.j$32=function(){return t._v$32?t._v$32:t._v$32=(bd.EncodeUnion(void 0,"$",[null,null,null,null]))();};t.j$98=function(){return t._v$98?t._v$98:t._v$98=(bd.EncodeUnion(void 0,"$",[[0,[["$0","Item",bd.Id(),0]]],[1,[["$0","Item",bd.Id(),0]]],[2,[[null,true,bd.Id()]]],[3,[]]]))();};t.j$103=function(){return t._v$103?t._v$103:t._v$103=(bd.EncodeRecord(void 0,[["div1",t.j$97,0],["div2",t.j$97,0]]))();};t.j$102=function(){return t._v$102?t._v$102:t._v$102=(bd.EncodeRecord(void 0,[["base_",t.j$97,0],["exponent",t.j$97,0]]))();};t.j$101=function(){return t._v$101?t._v$101:t._v$101=(bd.EncodeRecord(void 0,[["sub1",t.j$97,0],["sub2",t.j$97,0]]))();};t.j$100=function(){return t._v$100?t._v$100:t._v$100=(bd.EncodeRecord(void 0,[["div",t.j$97,0],["modulo",t.j$97,0]]))();};t.j$99=function(){return t._v$99?t._v$99:t._v$99=(bd.EncodeUnion(void 0,"$",[[0,[]],[1,[]],[2,[["$0","Item1",t.j$97,0],["$1","Item2",t.j$97,0]]],[3,[["$0","Item1",t.j$97,0],["$1","Item2",t.j$97,0]]],[4,[["$0","Item1",t.j$97,0],["$1","Item2",t.j$97,0]]],[5,[["$0","Item1",t.j$97,0],["$1","Item2",t.j$97,0]]],[6,[["$0","Item1",t.j$97,0],["$1","Item2",t.j$97,0]]],[7,[["$0","Item",t.j$99,0]]],[8,[["$0","Item1",t.j$99,0],["$1","Item2",t.j$99,0]]],[9,[["$0","Item1",t.j$99,0],["$1","Item2",t.j$99,0]]]]))();};s.j$30=function(){return s._v$30?s._v$30:s._v$30=(bd.DecodeRecord(B,[["min",bd.Id(),0],["max",bd.Id(),0]]))();};s.j$29=function(){return s._v$29?s._v$29:s._v$29=(bd.DecodeRecord(A,[["mean",bd.Id(),0],["stdev",bd.Id(),0]]))();};s.j$28=function(){return s._v$28?s._v$28:s._v$28=(bd.DecodeRecord(z,[["mu",bd.Id(),0],["sigma",bd.Id(),0]]))();};s.j$27=function(){return s._v$27?s._v$27:s._v$27=(bd.DecodeRecord(y,[["mean",bd.Id(),0],["stdev",bd.Id(),0],["min",bd.Id(),0],["max",bd.Id(),0]]))();};t.j$31=function(){return t._v$31?t._v$31:t._v$31=(bd.EncodeRecord(B,[["min",bd.Id(),0],["max",bd.Id(),0]]))();};t.j$30=function(){return t._v$30?t._v$30:t._v$30=(bd.EncodeRecord(A,[["mean",bd.Id(),0],["stdev",bd.Id(),0]]))();};t.j$29=function(){return t._v$29?t._v$29:t._v$29=(bd.EncodeRecord(z,[["mu",bd.Id(),0],["sigma",bd.Id(),0]]))();};t.j$28=function(){return t._v$28?t._v$28:t._v$28=(bd.EncodeRecord(y,[["mean",bd.Id(),0],["stdev",bd.Id(),0],["min",bd.Id(),0],["max",bd.Id(),0]]))();};v.to_string=function(hI){return v.to_string_defaults(v.get_defaults(),hI);};v.get_defaults=function(){return v.New(1,null,1,null);};v.to_string_defaults=function(hI,hJ){function hK(hM,hN){return hN!=null&&hN.$==1?(function(hO){return function(hP){return hO("name = "+a.String(hP)+"; ");};}(a.id))(hN.$0):"";}function hL(hM,hN){return hN!=null&&hN.$==1?(function(hO){return function(hP){return hO("name = "+hP.toFixed(6));};}(a.id))(hN.$0):"";}return dZ.emit_record(hI,bX.ofArray([["scale",function(hM){return a.String(hM.scale);}],["steps",function(hM){return hK("steps",hM.steps);}],["trajectories",function(hM){return a.String(hM.trajectories);}],["stationary_skiptime",function(hM){return hL("stationary_skiptime",hM.stationary_skiptime);}]]),hJ);};v.get_parse=function(){return v.parse_defaults(v.get_defaults());};v.parse_defaults=function(hI){function hJ(hN,hO){return v.New(hN,hO.steps,hO.trajectories,hO.stationary_skiptime);}function hK(hN,hO){return v.New(hO.scale,{$:1,$0:hN},hO.trajectories,hO.stationary_skiptime);}function hL(hN,hO){return v.New(hO.scale,hO.steps,hN,hO.stationary_skiptime);}function hM(hN,hO){return v.New(hO.scale,hO.steps,hO.trajectories,{$:1,$0:hN});}return cR.record(hI,bX.ofArray([["scale",function(hN){return gz.op_BarGreaterGreater(cR.pfloat(),function(hO){return function(hP){return hJ(hO,hP);};},hN[0],hN[1]);}],["steps",function(hN){return gz.op_BarGreaterGreater(cR.pint32(),function(hO){return function(hP){return hK(hO,hP);};},hN[0],hN[1]);}],["trajectories",function(hN){return gz.op_BarGreaterGreater(cR.pint32(),function(hO){return function(hP){return hL(hO,hP);};},hN[0],hN[1]);}],["stationary_skiptime",function(hN){return gz.op_BarGreaterGreater(cR.pfloat(),function(hO){return function(hP){return hM(hO,hP);};},hN[0],hN[1]);}]]));};v.New=function(hI,hJ,hK,hL){return{scale:hI,steps:hJ,trajectories:hK,stationary_skiptime:hL};};w.to_string=function(hI){return w.to_string_defaults(w.get_defaults(),hI);};w.get_defaults=function(){return w.New(false,1E-06,1E-05);};w.to_string_defaults=function(hI,hJ){return dZ.emit_record(hI,bX.ofArray([["stiff",function(hK){return(function(hL){return function(hM){return hL(a.String(hM));};}(a.id))(hK.stiff);}],["reltolerance",function(hK){return a.String(hK.reltolerance);}],["abstolerance",function(hK){return a.String(hK.abstolerance);}]]),hJ);};w.get_parse=function(){return w.parse_defaults(w.get_defaults());};w.parse_defaults=function(hI){var hJ;function hK(hQ,hR){return gz.op_DotGreaterGreater(cR.pbool(),hJ,hQ,hR);}function hL(hQ,hR){return w.New(hQ,hR.abstolerance,hR.reltolerance);}function hM(hQ,hR){return gz.op_DotGreaterGreater(cR.pfloat(),hJ,hQ,hR);}function hN(hQ,hR){return w.New(hR.stiff,hQ,hR.reltolerance);}function hO(hQ,hR){return gz.op_DotGreaterGreater(cR.pfloat(),hJ,hQ,hR);}function hP(hQ,hR){return w.New(hR.stiff,hR.abstolerance,hQ);}hJ=cR.spaces();return cR.record(hI,bX.ofArray([["stiff",function(hQ){return gz.op_BarGreaterGreater(function(hR){return hK(hR[0],hR[1]);},function(hR){return function(hS){return hL(hR,hS);};},hQ[0],hQ[1]);}],["abstolerance",function(hQ){return gz.op_BarGreaterGreater(function(hR){return hM(hR[0],hR[1]);},function(hR){return function(hS){return hN(hR,hS);};},hQ[0],hQ[1]);}],["reltolerance",function(hQ){return gz.op_BarGreaterGreater(function(hR){return hO(hR[0],hR[1]);},function(hR){return function(hS){return hP(hR,hS);};},hQ[0],hQ[1]);}]]));};w.New=function(hI,hJ,hK){return{stiff:hI,abstolerance:hJ,reltolerance:hK};};x.to_string=function(hI){return hI=="Log"?"Log":"Real";};x.get_parse=function(){var hI,hJ,hK;function hL(hN){return"Real";}function hM(hN){return"Log";}hI=cR.choice([(hJ=cR.kw("Real"),function(hN){return gz.op_BarGreaterGreater(hJ,hL,hN[0],hN[1]);}),(hK=cR.kw("Log"),function(hN){return gz.op_BarGreaterGreater(hK,hM,hN[0],hN[1]);})]);return function(hN){return hI([hN[0],hN[1]]);};};y=d.Truncated=hB.Class({},null,y);y.New=function(hI,hJ,hK,hL){return new y({mean:hI,stdev:hJ,min:hK,max:hL});};z=d.LogNormal=hB.Class({mode:function(){return hC.exp(this.mu-this.sigma*this.sigma);},quantile:function(hI){return hC.exp(eA.erfinv(2*hI-1)*hC.sqrt(2)*this.sigma+this.mu);}},null,z);z.New=function(hI,hJ){return new z({mu:hI,sigma:hJ});};A=d.Normal=hB.Class({},null,A);A.New=function(hI,hJ){return new A({mean:hI,stdev:hJ});};B=d.Uniform=hB.Class({},null,B);B.New=function(hI,hJ){return new B({min:hI,max:hJ});};C=d.Distribution=hB.Class({},null,C);C.to_string=function(hI){return hI.$==1?(((hB.Curried3(function(hJ,hK,hL){return hJ("Normal("+cA.toSafe(hK)+","+cA.toSafe(hL)+")");}))(a.id))(a.String(hI.$0.mean)))(a.String(hI.$0.stdev)):hI.$==2?(((hB.Curried3(function(hJ,hK,hL){return hJ("LogNormal("+cA.toSafe(hK)+","+cA.toSafe(hL)+")");}))(a.id))(a.String(hI.$0.mu)))(a.String(hI.$0.sigma)):hI.$==3?(((((hB.Curried(function(hJ,hK,hL,hM,hN){return hJ("TruncatedNormal("+cA.toSafe(hK)+","+cA.toSafe(hL)+","+cA.toSafe(hM)+","+cA.toSafe(hN)+")");},5))(a.id))(a.String(hI.$0.mean)))(a.String(hI.$0.stdev)))(a.String(hI.$0.min)))(a.String(hI.$0.max)):(((hB.Curried3(function(hJ,hK,hL){return hJ("Uniform("+cA.toSafe(hK)+","+cA.toSafe(hL)+")");}))(a.id))(a.String(hI.$0.min)))(a.String(hI.$0.max));};C.get_parse=function(){var hI,hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0,h1,h2,h3,h4,h5,h6,h7,h8,h9,h_,h$,ia;function ib(_if,ig){return new C({$:0,$0:B.New(_if,ig)});}function ic(_if,ig){return new C({$:1,$0:A.New(_if,ig)});}function id(_if,ig){return new C({$:2,$0:z.New(_if,ig)});}function ie(_if,ig){return new C({$:3,$0:y.New(_if[0],_if[1],ig[0],ig[1])});}hI=cR.choice([(hJ=(hK=cR.kw("Uniform"),(hL=(hM=(hN=(hO=cR.skw(","),function(_if){return gz.op_GreaterGreaterDot(hO,cR.pfloat(),_if[0],_if[1]);}),function(_if){return gz.op_DotGreaterGreaterDot(cR.pfloat(),hN,_if[0],_if[1]);}),(cR.bracket("(",")"))(hM)),function(_if){return gz.op_GreaterGreaterDot(hK,hL,_if[0],_if[1]);})),function(_if){return gz.op_BarGreaterGreater(hJ,function(ig){return ib(ig[0],ig[1]);},_if[0],_if[1]);}),(hP=(hQ=cR.kw("Normal"),(hR=(hS=(hT=(hU=cR.skw(","),function(_if){return gz.op_GreaterGreaterDot(hU,cR.pfloat(),_if[0],_if[1]);}),function(_if){return gz.op_DotGreaterGreaterDot(cR.pfloat(),hT,_if[0],_if[1]);}),(cR.bracket("(",")"))(hS)),function(_if){return gz.op_GreaterGreaterDot(hQ,hR,_if[0],_if[1]);})),function(_if){return gz.op_BarGreaterGreater(hP,function(ig){return ic(ig[0],ig[1]);},_if[0],_if[1]);}),(hV=(hW=cR.kw("LogNormal"),(hX=(hY=(hZ=(h0=cR.skw(","),function(_if){return gz.op_GreaterGreaterDot(h0,cR.pfloat(),_if[0],_if[1]);}),function(_if){return gz.op_DotGreaterGreaterDot(cR.pfloat(),hZ,_if[0],_if[1]);}),(cR.bracket("(",")"))(hY)),function(_if){return gz.op_GreaterGreaterDot(hW,hX,_if[0],_if[1]);})),function(_if){return gz.op_BarGreaterGreater(hV,function(ig){return id(ig[0],ig[1]);},_if[0],_if[1]);}),(h1=(h2=cR.kw("TruncatedNormal"),(h3=(h4=(h5=(h6=(h7=(h8=cR.skw(","),function(_if){return gz.op_GreaterGreaterDot(h8,cR.pfloat(),_if[0],_if[1]);}),function(_if){return gz.op_DotGreaterGreaterDot(cR.pfloat(),h7,_if[0],_if[1]);}),(h9=cR.skw(","),function(_if){return gz.op_DotGreaterGreater(h6,h9,_if[0],_if[1]);})),(h_=(h$=(ia=cR.skw(","),function(_if){return gz.op_GreaterGreaterDot(ia,cR.pfloat(),_if[0],_if[1]);}),function(_if){return gz.op_DotGreaterGreaterDot(cR.pfloat(),h$,_if[0],_if[1]);}),function(_if){return gz.op_DotGreaterGreaterDot(h5,h_,_if[0],_if[1]);})),(cR.bracket("(",")"))(h4)),function(_if){return gz.op_GreaterGreaterDot(h2,h3,_if[0],_if[1]);})),function(_if){return gz.op_BarGreaterGreater(h1,function(ig){return ie(ig[0],ig[1]);},_if[0],_if[1]);})]);return function(_if){return hI([_if[0],_if[1]]);};};D.to_string=function(hI){return hI=="Fixed"?"Fixed":hI=="Initial"?"Initial":hI=="Multiple"?"Multiple":"Random";};D.get_parse=function(){var hI,hJ,hK,hL,hM;function hN(hR){return"Random";}function hO(hR){return"Fixed";}function hP(hR){return"Initial";}function hQ(hR){return"Multiple";}hI=cR.choice([(hJ=cR.kw("Random"),function(hR){return gz.op_BarGreaterGreater(hJ,hN,hR[0],hR[1]);}),(hK=cR.kw("Fixed"),function(hR){return gz.op_BarGreaterGreater(hK,hO,hR[0],hR[1]);}),(hL=cR.kw("Initial"),function(hR){return gz.op_BarGreaterGreater(hL,hP,hR[0],hR[1]);}),(hM=cR.kw("Multiple"),function(hR){return gz.op_BarGreaterGreater(hM,hQ,hR[0],hR[1]);})]);return function(hR){return hI([hR[0],hR[1]]);};};E.is_fixed=function(hI){return cw.Equals(hI.variation,"Fixed");};E.to_string=function(hI){return((((hB.Curried(function(hJ,hK,hL,hM){return hJ("{interval="+cA.toSafe(hK)+"; distribution="+cA.toSafe(hL)+"; variation="+cA.toSafe(hM)+"}");},4))(a.id))(x.to_string(hI.interval)))(C.to_string(hI.distribution)))(D.to_string(hI.variation));};E.is_multiple=function(hI){return cw.Equals(hI.variation,"Multiple");};E.vary=function(hI){return E.New(hI.interval,hI.distribution,"Random");};E.get_parse=function(){var hI,hJ,hK;function hL(hO,hP){return E.New(hO,hP.distribution,hP.variation);}function hM(hO,hP){return E.New(hP.interval,hO,hP.variation);}function hN(hO,hP){return E.New(hP.interval,hP.distribution,hO);}return cR.record(E.get_empty(),bX.ofArray([["interval",(hI=x.get_parse(),function(hO){return gz.op_BarGreaterGreater(hI,function(hP){return function(hQ){return hL(hP,hQ);};},hO[0],hO[1]);})],["distribution",(hJ=C.get_parse(),function(hO){return gz.op_BarGreaterGreater(hJ,function(hP){return function(hQ){return hM(hP,hQ);};},hO[0],hO[1]);})],["variation",(hK=D.get_parse(),function(hO){return gz.op_BarGreaterGreater(hK,function(hP){return function(hQ){return hN(hP,hQ);};},hO[0],hO[1]);})]]));};E.get_empty=function(){return E.New("Log",new C({$:0,$0:B.New(0,0)}),"Random");};E.New=function(hI,hJ,hK){return{interval:hI,distribution:hJ,variation:hK};};F=d.Parameter=hB.Class({},null,F);F.variable=function(hI){var hJ;hJ=hI.prior;return hJ!=null&&hJ.$==1&&!E.is_fixed(hJ.$0);};F.to_string=function(hI){var hJ,hK;hJ=(hK=hI.prior,hK==null?"":(function(hL){return function(hM){return hL(", "+cA.toSafe(hM));};}(a.id))(E.to_string(hK.$0)));return((((hB.Curried(function(hL,hM,hN,hO){return hL(cA.toSafe(hM)+" = "+cA.toSafe(hN)+cA.toSafe(hO));},4))(a.id))(hI.name))(a.String(hI.value)))(hJ);};F.is_multiple=function(hI){var hJ;hJ=hI.prior;return hJ!=null&&hJ.$==1&&E.is_multiple(hJ.$0);};F.create$1=function(hI,hJ,hK){return F.New(hI,hJ,hK);};F.getname=function(hI){return hI.name;};F.substitute=function(hI,hJ){var hK;hK=bW.TryFind(hJ.name,hI);return hK!=null&&hK.$==1?F.create$1(hJ.name,hK.$0,hJ.prior):hJ;};F.get_parse=function(){var hI,hJ,hK;function hL(hM,hN){var hO,hP,hQ,hR,hS;function hT(hU){return cR.preturn(F.create$1(hM,hN,{$:1,$0:hU}));}hO=(hP=(hQ=cR.skw(","),(hR=E.get_parse(),function(hU){return gz.op_GreaterGreaterDot(hQ,hR,hU[0],hU[1]);})),function(hU){return gz.op_GreaterGreaterEquals(hP,hT,hU[0],hU[1]);});hS=cR.preturn(F.create$1(hM,hN,null));return function(hU){return gz.op_LessBarGreater(hO,hS,hU[0],hU[1]);};}hI=(hJ=(hK=cR.skw("="),function(hM){return gz.op_GreaterGreaterDot(hK,cR.pfloat(),hM[0],hM[1]);}),function(hM){return gz.op_DotGreaterGreaterDot(cR.name(),hJ,hM[0],hM[1]);});return function(hM){return gz.op_GreaterGreaterEquals(hI,function(hN){return hL(hN[0],hN[1]);},hM[0],hM[1]);};};F.to_filzbach=function(hI){var hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0;hJ=hI.prior;return hJ==null?cs.New(hI.name,bi.New(bh.Fixed,hI.value,hI.value),{$:1,$0:hI.value},null,false):(hK=hJ.$0,(hL=cw.Equals(hK.variation,"Fixed")?bh.Fixed:hK.interval=="Log"?bh.Log:bh.Real,(hM=(hN=hK.distribution,hN.$==1?(hO=hN.$0.stdev,(hP=hN.$0.mean,(hQ=20,(hR=hP-hQ*hO,(hS=hP+hQ*hO,hL.$==1?bi.New(hL,(hT=0,cw.Compare(hR,hT)===1?hR:hT),hS):hL.$==2?bi.New(hL,hP,hP):bi.New(hL,hR,hS)))))):hN.$==2?(hU=hN.$0,bi.New(hL,hU.quantile(1E-06),hU.quantile(1-1E-06))):hN.$==3?(hV=hN.$0,bi.New(hL,hV.min,hV.max)):bi.New(hL,hN.$0.min,hN.$0.max)),(hW=(hX=hK.distribution,hX.$==1?(hY=hX.$0,[{$:1,$0:bg.createNormal(hY.mean,hY.stdev)},hY.mean]):hX.$==2?(hZ=hX.$0,[{$:1,$0:bg.createLogNormal(hZ.mu,hZ.sigma)},hZ.mode()]):hX.$==3?(h0=hX.$0,[{$:1,$0:bg.createTruncatedNormal(h0.mean,h0.stdev,h0.min,h0.max)},h0.mean]):[null,hI.value]),cs.New(hI.name,hM,{$:1,$0:hW[1]},hW[0],true)))));};F.New=function(hI,hJ,hK){return new F({name:hI,value:hJ,prior:hK});};G.map=function(hI,hJ){function hK(hL,hM){return[hI(hL),hM];}return G.New(hJ.parameters,bX.map(function(hL){return hK(hL[0],hL[1]);},hJ.diffusibles),hJ.dimensions,hJ.boundary,hJ.xmax,hJ.nx,hJ.dt,hJ.default_diffusion,hJ.random);};G.to_string=function(hI,hJ){var hK,hL;hK=G.get_defaults();hL=cS.concat("; ",bX.choose(a.id,bX.ofArray([hJ.dimensions===hK.dimensions?null:{$:1,$0:(function(hM){return function(hN){return hM("dimensions = "+a.String(hN));};}(a.id))(hJ.dimensions)},cw.Equals(hJ.boundary,hK.boundary)?null:{$:1,$0:(function(hM){return function(hN){return hM("boundary = "+cA.toSafe(hN));};}(a.id))(a.String(hJ.boundary))},hJ.diffusibles.$==0?null:{$:1,$0:(function(hM){return function(hN){return hM("diffusibles = ["+cA.toSafe(hN)+"]");};}(a.id))(G.diffusibles_to_string(hI,hJ.diffusibles))},hJ.default_diffusion===hK.default_diffusion?null:{$:1,$0:(function(hM){return function(hN){return hM("default_diffusion = "+cA.toSafe(hN));};}(a.id))(a.String(hJ.default_diffusion))},hJ.xmax===hK.xmax?null:{$:1,$0:(function(hM){return function(hN){return hM("xmax = "+cA.toSafe(hN));};}(a.id))(a.String(hJ.xmax))},hJ.nx===hK.nx?null:{$:1,$0:(function(hM){return function(hN){return hM("nx = "+a.String(hN));};}(a.id))(hJ.nx)},hJ.dt===hK.dt?null:{$:1,$0:(function(hM){return function(hN){return hM("dt = "+cA.toSafe(hN));};}(a.id))(a.String(hJ.dt))},hJ.random===hK.random?null:{$:1,$0:(function(hM){return function(hN){return hM("random = "+cA.toSafe(hN));};}(a.id))(a.String(hJ.random))}])));return(function(hM){return function(hN){return hM("{ "+cA.toSafe(hN)+" }");};}(a.id))(hL);};G.get_defaults=function(){return G.New(bY.Empty,bY.Empty,1,"Periodic",1,20,0,0,0);};G.diffusibles_to_string=function(hI,hJ){function hK(hL,hM){return(((hB.Curried3(function(hN,hO,hP){return hN(cA.toSafe(hO)+"="+cA.toSafe(hP));}))(a.id))(hI(hL)))(br.to_string(a.id,hM));}return cS.concat("; ",bX.map(function(hL){return hK(hL[0],hL[1]);},hJ));};G.get_parse=function(){var hI;hI=G.get_defaults();return function(hJ){return G.parse_defaults(hI,hJ);};};G.parse_defaults=function(hI,hJ){var hK,hL,hM,hN,hO,hP,hQ;function hR(h2,h3){return gz.op_DotGreaterGreater(cR.pint32(),cR.spaces(),h2,h3);}function hS(h2,h3){return gz.op_DotGreaterGreater(cR.pfloat(),cR.spaces(),h2,h3);}function hT(h2,h3){return G.New(h3.parameters,h2,h3.dimensions,h3.boundary,h3.xmax,h3.nx,h3.dt,h3.default_diffusion,h3.random);}function hU(h2,h3){return G.New(h3.parameters,h3.diffusibles,h3.dimensions,h3.boundary,h3.xmax,h3.nx,h3.dt,h2,h3.random);}function hV(h2,h3){return G.New(h3.parameters,h3.diffusibles,h2,h3.boundary,h3.xmax,h3.nx,h3.dt,h3.default_diffusion,h3.random);}function hW(h2,h3){return G.New(h3.parameters,h3.diffusibles,h3.dimensions,h3.boundary,h3.xmax,h3.nx,h3.dt,h3.default_diffusion,h2);}function hX(h2,h3){return G.New(h3.parameters,h3.diffusibles,h3.dimensions,h3.boundary,h2,h3.nx,h3.dt,h3.default_diffusion,h3.random);}function hY(h2,h3){return G.New(h3.parameters,h3.diffusibles,h3.dimensions,h3.boundary,h3.xmax,h2,h3.dt,h3.default_diffusion,h3.random);}function hZ(h2,h3){return G.New(h3.parameters,h3.diffusibles,h3.dimensions,h3.boundary,h3.xmax,h3.nx,h2,h3.default_diffusion,h3.random);}function h0(h2,h3){return G.New(h3.parameters,h3.diffusibles,h3.dimensions,"Periodic",h3.xmax,h3.nx,h3.dt,h3.default_diffusion,h3.random);}function h1(h2,h3){return G.New(h3.parameters,h3.diffusibles,h3.dimensions,"ZeroFlux",h3.xmax,h3.nx,h3.dt,h3.default_diffusion,h3.random);}return cR.record(hI,bX.ofArray([["diffusibles",(hK=cR.list_of((hL=(hM=cR.skw("="),(hN=br.parse(cR.name()),function(h2){return gz.op_GreaterGreaterDot(hM,hN,h2[0],h2[1]);})),function(h2){return gz.op_DotGreaterGreaterDot(hJ,hL,h2[0],h2[1]);})),function(h2){return gz.op_BarGreaterGreater(hK,function(h3){return function(h4){return hT(h3,h4);};},h2[0],h2[1]);})],["default_diffusion",function(h2){return gz.op_BarGreaterGreater(function(h3){return hS(h3[0],h3[1]);},function(h3){return function(h4){return hU(h3,h4);};},h2[0],h2[1]);}],["dimensions",function(h2){return gz.op_BarGreaterGreater(function(h3){return hR(h3[0],h3[1]);},function(h3){return function(h4){return hV(h3,h4);};},h2[0],h2[1]);}],["random",function(h2){return gz.op_BarGreaterGreater(function(h3){return hS(h3[0],h3[1]);},function(h3){return function(h4){return hW(h3,h4);};},h2[0],h2[1]);}],["xmax",function(h2){return gz.op_BarGreaterGreater(function(h3){return hS(h3[0],h3[1]);},function(h3){return function(h4){return hX(h3,h4);};},h2[0],h2[1]);}],["nx",function(h2){return gz.op_BarGreaterGreater(function(h3){return hR(h3[0],h3[1]);},function(h3){return function(h4){return hY(h3,h4);};},h2[0],h2[1]);}],["dt",function(h2){return gz.op_BarGreaterGreater(function(h3){return hS(h3[0],h3[1]);},function(h3){return function(h4){return hZ(h3,h4);};},h2[0],h2[1]);}],["boundary",(hO=cR.choice([(hP=cR.kw("Periodic"),function(h2){return gz.op_BarGreaterGreater(hP,function(h3){return function(h4){return h0(h3,h4);};},h2[0],h2[1]);}),(hQ=cR.kw("ZeroFlux"),function(h2){return gz.op_BarGreaterGreater(hQ,function(h3){return function(h4){return h1(h3,h4);};},h2[0],h2[1]);})]),function(h2){return hO([h2[0],h2[1]]);})]]));};G.New=function(hI,hJ,hK,hL,hM,hN,hO,hP,hQ){return{parameters:hI,diffusibles:hJ,dimensions:hK,boundary:hL,xmax:hM,nx:hN,dt:hO,default_diffusion:hP,random:hQ};};H.to_string=function(hI){return hI=="Proportional"?"proportional":"constant";};H.get_parse=function(){var hI;hI=cR.choice([cR.op_GreaterGreaterPercent(cR.kw("constant"),"Constant"),cR.op_GreaterGreaterPercent(cR.kw("proportional"),"Proportional")]);return function(hJ){return hI([hJ[0],hJ[1]]);};};I.to_string=function(hI){return hI=="Random"?"Random":hI=="Multiple"?"Multiple":(function(hJ){return function(hK){return hJ("Fixed("+hK.toFixed(6)+")");};}(a.id))(hI.$0);};I.get_parse=function(){var hI,hJ;hI=cR.choice([cR.op_BarGreaterGreater(cR.op_GreaterGreaterDot(cR.kw("Fixed"),(hJ=cR.pfloat(),(cR.bracket("(",")"))(hJ))),function(hK){return{$:0,$0:hK};}),cR.op_GreaterGreaterPercent(cR.kw("Random"),"Random"),cR.op_GreaterGreaterPercent(cR.kw("Multiple"),"Multiple")]);return function(hK){return hI([hK[0],hK[1]]);};};J.get_to_string=function(){var hI,hJ;hI=J.get_defaults();hJ=bX.ofArray([["name",function(hK){return hK.name;}],["burnin",function(hK){return(function(hL){return function(hM){return hL(a.String(hM));};}(a.id))(hK.burnin);}],["samples",function(hK){return(function(hL){return function(hM){return hL(a.String(hM));};}(a.id))(hK.samples);}],["thin",function(hK){return(function(hL){return function(hM){return hL(a.String(hM));};}(a.id))(hK.thin);}],["seed",function(hK){return(function(hL){return function(hM){return hL(a.String(hM));};}(a.id))(hK.seed);}],["seeds",function(hK){var hL;hL=cS.concat("; ",bX.map(function(hM){return function(hN){return hM(a.String(hN));};}(a.id),hK.seeds));return(function(hM){return function(hN){return hM("[ "+cA.toSafe(hN)+" ]");};}(a.id))(hL);}],["lowerbound",function(hK){var hL;hL=hK.lowerbound;return hL==null?"":a.String(hL.$0);}],["noise_model",function(hK){return H.to_string(hK.noise_model);}],["noise_parameter",function(hK){return I.to_string(hK.noise_parameter);}],["prune",function(hK){return(function(hL){return function(hM){return hL(a.String(hM));};}(a.id))(hK.prune);}],["timer",function(hK){return(function(hL){return function(hM){return hL(a.String(hM));};}(a.id))(hK.timer);}],["print_console",function(hK){return(function(hL){return function(hM){return hL(a.String(hM));};}(a.id))(hK.print_console);}],["print_summary",function(hK){return(function(hL){return function(hM){return hL(a.String(hM));};}(a.id))(hK.print_summary);}],["partial",function(hK){return(function(hL){return function(hM){return hL(a.String(hM));};}(a.id))(hK.partial_evaluation);}]]);return function(hK){return dZ.emit_record(hI,hJ,hK);};};J.get_defaults=function(){return J.New("default",100,100,10,"Constant","Random",false,0,bY.Empty,null,false,false,true,true);};J.get_parse=function(){return J.parse_defaults(J.get_defaults());};J.parse_defaults=function(hI){var hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW;function hX(ia,ib,ic){return(cR.op_BarGreaterGreater(ia,ib))(ic);}function hY(ia,ib){return J.New(ia,ib.burnin,ib.samples,ib.thin,ib.noise_model,ib.noise_parameter,ib.prune,ib.seed,ib.seeds,ib.lowerbound,ib.timer,ib.partial_evaluation,ib.print_console,ib.print_summary);}function hZ(ia,ib){return J.New(ib.name,ia,ib.samples,ib.thin,ib.noise_model,ib.noise_parameter,ib.prune,ib.seed,ib.seeds,ib.lowerbound,ib.timer,ib.partial_evaluation,ib.print_console,ib.print_summary);}function h0(ia,ib){return J.New(ib.name,ib.burnin,ia,ib.thin,ib.noise_model,ib.noise_parameter,ib.prune,ib.seed,ib.seeds,ib.lowerbound,ib.timer,ib.partial_evaluation,ib.print_console,ib.print_summary);}function h1(ia,ib){return J.New(ib.name,ib.burnin,ib.samples,ia,ib.noise_model,ib.noise_parameter,ib.prune,ib.seed,ib.seeds,ib.lowerbound,ib.timer,ib.partial_evaluation,ib.print_console,ib.print_summary);}function h2(ia,ib){return J.New(ib.name,ib.burnin,ib.samples,ib.thin,ia,ib.noise_parameter,ib.prune,ib.seed,ib.seeds,ib.lowerbound,ib.timer,ib.partial_evaluation,ib.print_console,ib.print_summary);}function h3(ia,ib){return J.New(ib.name,ib.burnin,ib.samples,ib.thin,ib.noise_model,ia,ib.prune,ib.seed,ib.seeds,ib.lowerbound,ib.timer,ib.partial_evaluation,ib.print_console,ib.print_summary);}function h4(ia,ib){return J.New(ib.name,ib.burnin,ib.samples,ib.thin,ib.noise_model,ib.noise_parameter,ia,ib.seed,ib.seeds,ib.lowerbound,ib.timer,ib.partial_evaluation,ib.print_console,ib.print_summary);}function h5(ia,ib){return J.New(ib.name,ib.burnin,ib.samples,ib.thin,ib.noise_model,ib.noise_parameter,ib.prune,ia,ib.seeds,ib.lowerbound,ib.timer,ib.partial_evaluation,ib.print_console,ib.print_summary);}function h6(ia,ib){return J.New(ib.name,ib.burnin,ib.samples,ib.thin,ib.noise_model,ib.noise_parameter,ib.prune,ib.seed,bX.map(a.id,ia),ib.lowerbound,ib.timer,ib.partial_evaluation,ib.print_console,ib.print_summary);}function h7(ia,ib){return J.New(ib.name,ib.burnin,ib.samples,ib.thin,ib.noise_model,ib.noise_parameter,ib.prune,ib.seed,ib.seeds,{$:1,$0:ia},ib.timer,ib.partial_evaluation,ib.print_console,ib.print_summary);}function h8(ia,ib){return J.New(ib.name,ib.burnin,ib.samples,ib.thin,ib.noise_model,ib.noise_parameter,ib.prune,ib.seed,ib.seeds,ib.lowerbound,ia,ib.partial_evaluation,ib.print_console,ib.print_summary);}function h9(ia,ib){return J.New(ib.name,ib.burnin,ib.samples,ib.thin,ib.noise_model,ib.noise_parameter,ib.prune,ib.seed,ib.seeds,ib.lowerbound,ib.timer,ib.partial_evaluation,ia,ib.print_summary);}function h_(ia,ib){return J.New(ib.name,ib.burnin,ib.samples,ib.thin,ib.noise_model,ib.noise_parameter,ib.prune,ib.seed,ib.seeds,ib.lowerbound,ib.timer,ib.partial_evaluation,ib.print_console,ia);}function h$(ia,ib){return J.New(ib.name,ib.burnin,ib.samples,ib.thin,ib.noise_model,ib.noise_parameter,ib.prune,ib.seed,ib.seeds,ib.lowerbound,ib.timer,ia,ib.print_console,ib.print_summary);}return cR.record(hI,bX.ofArray([["name",(hJ=cR.name(),function(ia){return hX(hJ,function(ib){return function(ic){return hY(ib,ic);};},ia);})],["burnin",(hK=cR.pint32(),function(ia){return hX(hK,function(ib){return function(ic){return hZ(ib,ic);};},ia);})],["samples",(hL=cR.pint32(),function(ia){return hX(hL,function(ib){return function(ic){return h0(ib,ic);};},ia);})],["thin",(hM=cR.pint32(),function(ia){return hX(hM,function(ib){return function(ic){return h1(ib,ic);};},ia);})],["noise_model",(hN=H.get_parse(),function(ia){return hX(hN,function(ib){return function(ic){return h2(ib,ic);};},ia);})],["noise_parameter",(hO=I.get_parse(),function(ia){return hX(hO,function(ib){return function(ic){return h3(ib,ic);};},ia);})],["prune",(hP=cR.pbool(),function(ia){return hX(hP,function(ib){return function(ic){return h4(ib,ic);};},ia);})],["seed",(hQ=cR.pint32(),function(ia){return hX(hQ,function(ib){return function(ic){return h5(ib,ic);};},ia);})],["seeds",(hR=cR.list_of(cR.pint32()),function(ia){return hX(hR,function(ib){return function(ic){return h6(ib,ic);};},ia);})],["lowerbound",(hS=cR.pfloat(),function(ia){return hX(hS,function(ib){return function(ic){return h7(ib,ic);};},ia);})],["timer",(hT=cR.pbool(),function(ia){return hX(hT,function(ib){return function(ic){return h8(ib,ic);};},ia);})],["print_console",(hU=cR.pbool(),function(ia){return hX(hU,function(ib){return function(ic){return h9(ib,ic);};},ia);})],["print_summary",(hV=cR.pbool(),function(ia){return hX(hV,function(ib){return function(ic){return h_(ib,ic);};},ia);})],["partial",(hW=cR.pbool(),function(ia){return hX(hW,function(ib){return function(ic){return h$(ib,ic);};},ia);})]]));};J.New=function(hI,hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV){return{name:hI,burnin:hJ,samples:hK,thin:hL,noise_model:hM,noise_parameter:hN,prune:hO,seed:hP,seeds:hQ,lowerbound:hR,timer:hS,partial_evaluation:hT,print_console:hU,print_summary:hV};};L.New=function(hI,hJ,hK,hL){return{order:hI,initial_minimum:hJ,log_evaluation:hK,plots:hL};};M.get_defaults=function(){return M.New("Multistability","Portfolio",null,null);};M.get_parse=function(){return M.parse_defaults(M.get_defaults());};M.parse_defaults=function(hI){var hJ,hK,hL,hM,hN,hO;function hP(hV,hW){return M.New("Multistability",hW.solver,hW.timeout,hW.seed);}function hQ(hV,hW){return M.New("Turing",hW.solver,hW.timeout,hW.seed);}function hR(hV,hW){return M.New(hW.mode,"NLSat",hW.timeout,hW.seed);}function hS(hV,hW){return M.New(hW.mode,"Portfolio",hW.timeout,hW.seed);}function hT(hV,hW){return M.New(hW.mode,hW.solver,{$:1,$0:hV},hW.seed);}function hU(hV,hW){return M.New(hW.mode,hW.solver,hW.timeout,{$:1,$0:hV});}return cR.record(hI,bX.ofArray([["mode",(hJ=cR.choice([(hK=cR.kw("multistability"),function(hV){return gz.op_BarGreaterGreater(hK,function(hW){return function(hX){return hP(hW,hX);};},hV[0],hV[1]);}),(hL=cR.kw("turing"),function(hV){return gz.op_BarGreaterGreater(hL,function(hW){return function(hX){return hQ(hW,hX);};},hV[0],hV[1]);})]),function(hV){return hJ([hV[0],hV[1]]);})],["solver",(hM=cR.choice([(hN=cR.kw("nlsat"),function(hV){return gz.op_BarGreaterGreater(hN,function(hW){return function(hX){return hR(hW,hX);};},hV[0],hV[1]);}),(hO=cR.kw("portfolio"),function(hV){return gz.op_BarGreaterGreater(hO,function(hW){return function(hX){return hS(hW,hX);};},hV[0],hV[1]);})]),function(hV){return hM([hV[0],hV[1]]);})],["timeout",function(hV){return gz.op_BarGreaterGreater(cR.pfloat(),function(hW){return function(hX){return hT(hW,hX);};},hV[0],hV[1]);}],["seed",function(hV){return gz.op_BarGreaterGreater(cR.pint32(),function(hW){return function(hX){return hU(hW,hX);};},hV[0],hV[1]);}]]));};M.New=function(hI,hJ,hK,hL){return{mode:hI,solver:hJ,timeout:hK,seed:hL};};N.create=function(hI,hJ){return N.New(hJ,hI);};N.reverse=function(hI){return N.New(hI.name,bX.rev(hI.values));};N.New=function(hI,hJ){return{name:hI,values:hJ};};O.to_rows=function(hI){return bX.rev(O.to_rows_reverse(hI));};O.to_rows_reverse=function(hI){function hJ(hK,hL){return function(hM){return[new bY({$:1,$0:bJ.create(hM,bX.map(bX.head,hL)),$1:hK}),bX.map(bX.tail,hL)];};}return(co.fold(function(hK,hL){return(function(hM){return hJ(hM[0],hM[1]);}(hK))(hL);},[bY.Empty,O.get_column_values(hI)],hI.times))[0];};O.from_array_columns=function(hI,hJ,hK){return O.New(hI,bX.ofSeq(co.map2(function(hL,hM){return N.create(bX.ofArray(hM),hL);},hK,hJ)));};O.from_rows_reverse=function(hI,hJ){var hK;function hL(hM,hN){return N.New(hN.name,new bY({$:1,$0:hM,$1:hN.values}));}return co.fold(function(hM,hN){return O.New(new bY({$:1,$0:hN.time,$1:hM.times}),bX.map2(hL,bX.ofArray(hN.values),hM.columns));},O.New(bY.Empty,bX.map((hK=bY.Empty,function(hM){return N.create(hK,hM);}),hI)),hJ);};O.get_column_values=function(hI){return bX.map(function(hJ){return hJ.values;},hI.columns);};O.qsummary=function(hI){var hJ;hJ=bX.head(hI).times;return O.New(hJ,bX.concat(bX.init(bX.head(hI).columns.get_Length(),function(hK){var hL,hM,hN,hO,hP;hL=bX.map(function(hQ){return hQ.columns.get_Item(hK).values;},hI);hM=bX.head(hI).columns.get_Item(hK).name;hN=bX.unzip(bX.init(hJ.get_Length(),function(hQ){var hR;hR=bX.map(function(hS){return co.nth(hQ,hS);},hL);return[eE.summary(hR),eE.qsummary(hR)];}));hO=hN[0];hP=hN[1];return bX.ofArray([N.create(bX.map(function(hQ){return hQ.mean;},hO),hM+" Mean"),N.create(bX.map(function(hQ){return hC.sqrt(hQ.variance);},hO),hM+" Std"),N.create(bX.map(function(hQ){return hQ.lb95;},hP),hM+" L95"),N.create(bX.map(function(hQ){return hQ.ub95;},hP),hM+" U95")]);})));};O.from_rows=function(hI,hJ){return O.reverse(O.from_rows_reverse(hI,hJ));};O.filter_by_tmax=function(hI,hJ){var hK,hL;hK=co.tryFindIndex(function(hM){return hM>hI;},hJ.times);return hK==null?hJ:(hL=hK.$0,O.New(hJ.times.GetSlice({$:1,$0:0},{$:1,$0:hL-1}),bX.map(function(hM){return N.New(hM.name,hM.values.GetSlice({$:1,$0:0},{$:1,$0:hL-1}));},hJ.columns)));};O.likelihood=function(hI,hJ,hK){return co.sum(bX.map3(function(hL,hM,hN){return co.sum(bX.map2(function(hO,hP){return(hL(hO))(hP);},hM.values,hN.values));},hI,hJ.columns,hK.columns));};O.reverse=function(hI){return O.New(bX.rev(hI.times),bX.map(N.reverse,hI.columns));};O.New=function(hI,hJ){return{times:hI,columns:hJ};};P.empty=function(hI){return P.New(hI,bY.Empty);};P.New=function(hI,hJ){return{file:hI,data:hJ};};Q=d.Concentration=hB.Class({get_to_string:function(){return this.$0===-24?"yM":this.$0===-21?"zM":this.$0===-18?"aM":this.$0===-15?"fM":this.$0===-12?"pM":this.$0===-9?"nM":this.$0===-6?"uM":this.$0===-3?"mM":this.$0===0?"M":"M*10\\\\^"+a.String(this.$0);}},null,Q);R=d.Time=hB.Class({get_to_string:function(){return this.$0===1E-09?"ns":this.$0===1E-06?"us":this.$0===0.001?"ms":this.$0===1?"s":this.$0===60?"min":this.$0===3600?"h":(function(hI){return function(hJ){return hI(hJ.toFixed(6)+"s");};}(a.id))(this.$0);}},null,R);S=d.Space=hB.Class({get_to_string:function(){return this.$0===-15?"fm":this.$0===-12?"pm":this.$0===-9?"nm":this.$0===-6?"um":this.$0===-3?"mm":this.$0===0?"m":"m*10\\\\^"+a.String(this.$0);}},null,S);T=d.Units=hB.Class({get_to_string:function(){return dZ.emit_record(T.get_defaults(),bX.ofArray([["concentration",function(hI){return hI.concentration.get_to_string();}],["time",function(hI){return hI.time.get_to_string();}],["space",function(hI){return hI.space.get_to_string();}]]),this);}},null,T);T.get_defaults=function(){return T.New(new Q({$:0,$0:-9}),new R({$:0,$0:1}),new S({$:0,$0:-3}));};T.get_parse=function(){var hI,hJ,hK,hL,hM,hN;hI=(hJ=cR.choice([cR.op_GreaterGreaterDot(cR.kw("M"),cR.preturn(new Q({$:0,$0:0}))),cR.op_GreaterGreaterDot(cR.kw("mM"),cR.preturn(new Q({$:0,$0:-3}))),cR.op_GreaterGreaterDot(cR.kw("uM"),cR.preturn(new Q({$:0,$0:-6}))),cR.op_GreaterGreaterDot(cR.kw("nM"),cR.preturn(new Q({$:0,$0:-9}))),cR.op_GreaterGreaterDot(cR.kw("pM"),cR.preturn(new Q({$:0,$0:-12}))),cR.op_GreaterGreaterDot(cR.kw("fM"),cR.preturn(new Q({$:0,$0:-15}))),cR.op_GreaterGreaterDot(cR.kw("aM"),cR.preturn(new Q({$:0,$0:-18}))),cR.op_GreaterGreaterDot(cR.kw("zM"),cR.preturn(new Q({$:0,$0:-21}))),cR.op_GreaterGreaterDot(cR.kw("yM"),cR.preturn(new Q({$:0,$0:-24})))]),function(hO){return hJ([hO[0],hO[1]]);});hK=(hL=cR.choice([cR.op_GreaterGreaterDot(cR.kw("ns"),cR.preturn(new R({$:0,$0:1E-09}))),cR.op_GreaterGreaterDot(cR.kw("us"),cR.preturn(new R({$:0,$0:1E-06}))),cR.op_GreaterGreaterDot(cR.kw("ms"),cR.preturn(new R({$:0,$0:0.001}))),cR.op_GreaterGreaterDot(cR.kw("s"),cR.preturn(new R({$:0,$0:1}))),cR.op_GreaterGreaterDot(cR.kw("min"),cR.preturn(new R({$:0,$0:60}))),cR.op_GreaterGreaterDot(cR.kw("h"),cR.preturn(new R({$:0,$0:3600})))]),function(hO){return hL([hO[0],hO[1]]);});hM=(hN=cR.choice([cR.op_GreaterGreaterDot(cR.kw("m"),cR.preturn(new S({$:0,$0:0}))),cR.op_GreaterGreaterDot(cR.kw("mm"),cR.preturn(new S({$:0,$0:-3}))),cR.op_GreaterGreaterDot(cR.kw("um"),cR.preturn(new S({$:0,$0:-6}))),cR.op_GreaterGreaterDot(cR.kw("nm"),cR.preturn(new S({$:0,$0:-9}))),cR.op_GreaterGreaterDot(cR.kw("pm"),cR.preturn(new S({$:0,$0:-12}))),cR.op_GreaterGreaterDot(cR.kw("fm"),cR.preturn(new S({$:0,$0:-15})))]),function(hO){return hN([hO[0],hO[1]]);});return cR.record(T.get_defaults(),bX.ofArray([["concentration",cR.op_BarGreaterGreater(cR.op_DotGreaterGreater(hI,cR.spaces()),function(hO){return function(hP){return T.New(hO,hP.time,hP.space);};})],["time",cR.op_BarGreaterGreater(cR.op_DotGreaterGreater(hK,cR.spaces()),function(hO){return function(hP){return T.New(hP.concentration,hO,hP.space);};})],["space",cR.op_BarGreaterGreater(cR.op_DotGreaterGreater(hM,cR.spaces()),function(hO){return function(hP){return T.New(hP.concentration,hP.time,hO);};})]]));};T.New=function(hI,hJ,hK){return new T({concentration:hI,time:hJ,space:hK});};U.get_to_string=function(hI){return hI=="Sundials"?"sundials":hI=="SSA"?"stochastic":hI=="CME"?"cme":hI=="CMESundials"?"cmesundials":hI=="LNA"?"lna":hI=="PDE"?"pde":hI=="MC"?"mc":"deterministic";};U.shouldPrint=function(hI,hJ,hK,hL,hM,hN){return hM||(hJ>=hK||hJ>=hI||hL!=null);};U.shouldStop=function(hI,hJ,hK,hL,hM){return hJ>=hI||hL[0]||hM!=null&&hM.$==1&&hK>=hM.$0;};U.get_defaults=function(){return"SSA";};U.plot_label=function(hI,hJ,hK){var hL,hM,hN,hO,hP;hM="Concentration ("+hK.concentration.get_to_string()+")";hN="Individuals";hO="Distance ("+hK.space.get_to_string()+")";hP="Time ("+hK.time.get_to_string()+")";switch(hI=="Sundials"?1:hI=="SSA"?2:hI=="CME"?3:hI=="CMESundials"?3:hI=="LNA"?4:hI=="PDE"?5:hI=="MC"?6:0){case 0:return[hP,hM];case 1:return[hP,hM];case 2:return[hP,hN];case 3:return[hP,hN];case 4:return[hP,hN];case 5:return hJ===1?[hO,hP]:[hO,hO];case 6:return[hP,hN];}};U.get_parse=function(){var hI,hJ,hK,hL,hM,hN,hO,hP,hQ;hI=cR.choice([(hJ=cR.kw("deterministic"),function(hR){return gz.op_GreaterGreaterPercent(hJ,"Oslo",hR[0],hR[1]);}),(hK=cR.kw("stochastic"),function(hR){return gz.op_GreaterGreaterPercent(hK,"SSA",hR[0],hR[1]);}),(hL=cR.kw("lna"),function(hR){return gz.op_GreaterGreaterPercent(hL,"LNA",hR[0],hR[1]);}),(hM=cR.kw("cme"),function(hR){return gz.op_GreaterGreaterPercent(hM,"CME",hR[0],hR[1]);}),(hN=cR.kw("cmesundials"),function(hR){return gz.op_GreaterGreaterPercent(hN,"CMESundials",hR[0],hR[1]);}),(hO=cR.kw("sundials"),function(hR){return gz.op_GreaterGreaterPercent(hO,"Sundials",hR[0],hR[1]);}),(hP=cR.kw("pde"),function(hR){return gz.op_GreaterGreaterPercent(hP,"PDE",hR[0],hR[1]);}),(hQ=cR.kw("mc"),function(hR){return gz.op_GreaterGreaterPercent(hQ,"MC",hR[0],hR[1]);})]);return function(hR){return hI([hR[0],hR[1]]);};};V=d.Assignment=hB.Class({get_string:function(){var hI,hJ,hK,hL;hI=dZ.tuple_to_string(this.variables);hJ=cS.concat("; ",bX.map((hK=(hL=function(hM){return br.to_string(a.id,hM);},function(hM){return bX.map(hL,hM);}),function(hM){return dZ.tuple_to_string(hK(hM));}),this.values));return(((hB.Curried3(function(hM,hN,hO){return hM(cA.toSafe(hN)+" = ["+cA.toSafe(hO)+"]");}))(a.id))(hI))(hJ);},partial_inline:function(hI){var hJ;function hK(hL){return br.substitute(hJ,hL);}hJ=bW.Map(function(hL,hM){return{$:1,$0:hM};},hI);return V.New(this.variables,bX.map(function(hL){return bX.map(hK,hL);},this.values));},"eval":function(hI){var hJ;hJ=this;return bX.map(function(hK){function hL(hM){return cY.find(hI,hM);}return bW.OfArray(ck.ofSeq(bX.zip(hJ.variables,bX.map(function(hM){return br["eval"](hL,hM);},hK))));},this.values);},add_multiples:function(hI,hJ){var hK;hK=bX.unzip(bX.map(function(hL){var hM;hI[0]=hI[0]+1;hM=bX.map(function(hN){return hN+"_"+a.String(hI[0]);},hJ);return[hM,bX.append(hL,bX.map(function(hN){return{$:0,$0:hN};},hM))];},this.values));return[hK[0],V.create$5(bX.append(this.variables,hJ),hK[1])];},eval_label:function(hI){return bX.zip(bX.map(function(hJ){return function(hK){return hJ("["+cA.toSafe(hK)+"]");};}(a.id),this.get_to_string_separated()),this["eval"](hI));},get_to_string_separated:function(){var hI,hJ;hI=this;return bX.map(function(hK){return cS.concat("; ",bX.map2(function(hL,hM){return(((hB.Curried3(function(hN,hO,hP){return hN(cA.toSafe(hO)+" = "+cA.toSafe(hP));}))(a.id))(hL))(hM);},hI.variables,hK));},bX.map((hJ=function(hK){return br.to_string(a.id,hK);},function(hK){return bX.map(hJ,hK);}),this.values));},get_mentions:function(){return bX.append(this.variables,bX.collect(br.mentions,bX.concat(this.values)));}},null,V);V.create$4=function(){return V.New(bY.Empty,bX.ofArray([bY.Empty]));};V.create$5=function(hI,hJ){return V.New(hI,hJ);};V.get_parse=function(){var hI,hJ,hK,hL,hM;hI=cR.tuple_of(cR.name());hJ=cR.list_of(cR.tuple_of(br.parse(cR.name())));hK=(hL=(hM=cR.skw("="),function(hN){return gz.op_DotGreaterGreater(hI,hM,hN[0],hN[1]);}),function(hN){return gz.op_DotGreaterGreaterDot(hL,hJ,hN[0],hN[1]);});return function(hN){return gz.op_BarGreaterGreater(hK,function(hO){return V.create$5(hO[0],hO[1]);},hN[0],hN[1]);};};V.New=function(hI,hJ){return new V({variables:hI,values:hJ});};W=d.Sweep=hB.Class({get_string:function(){return this.name+" = ["+cS.concat("; ",bX.map(function(hI){return hI.get_string();},this.assignments))+"]";},inline_env:function(hI){return W.New(this.name,bX.map(function(hJ){return hJ.partial_inline(hI);},this.assignments));},get_merge:function(){return co.fold(function(hI,hJ){var hK;function hL(hM,hN){return bX.map(function(hO){var hP;hP=bW.OfArray(ck.ofSeq(bX.zip(hI.variables,hO)));return bX.append(hO,bX.map(function(hQ){return br.substitute(hP,hQ);},hN));},hM);}return V.create$5(bX.append(hI.variables,hJ.variables),bX.concat(bX.map((hK=hI.values,function(hM){return hL(hK,hM);}),hJ.values)));},V.create$4(),this.assignments);},get_variables:function(){return dZ.remove_duplicates(function(hI,hJ){return hI===hJ;},bX.collect(function(hI){return hI.variables;},this.assignments));},"eval":function(hI){return(this.get_merge())["eval"](hI);},add_multiples:function(hI,hJ){var hK;hK=this.get_merge().add_multiples(hI,hJ);return[hK[0],W.create$6(this.name,bX.ofArray([hK[1]]))];},eval_label:function(hI){return this.get_merge().eval_label(hI);},simplify_assignments:function(){return W.New(this.name,bX.filter(function(hI){return hI.values.get_Length()>1;},this.assignments));},get_mentions:function(){return bX.collect(function(hI){return bX.distinct(hI.get_mentions());},this.assignments);}},null,W);W.list_to_string=function(hI){return(function(hJ){return function(hK){return hJ("[\\n  "+cA.toSafe(hK)+";\\n]");};}(a.id))(cS.concat(";\\n  ",bX.map(function(hJ){return hJ.get_string();},hI)));};W.create$6=function(hI,hJ){return W.New(hI,hJ);};W.create$7=function(){return W.New("",bY.Empty);};W.get_parse=function(){var hI,hJ,hK,hL;hI=(hJ=(hK=cR.skw("="),function(hM){return gz.op_DotGreaterGreater(cR.name(),hK,hM[0],hM[1]);}),(hL=cR.list_of(V.get_parse()),function(hM){return gz.op_DotGreaterGreaterDot(hJ,hL,hM[0],hM[1]);}));return function(hM){return gz.op_BarGreaterGreater(hI,function(hN){return W.create$6(hN[0],hN[1]);},hM[0],hM[1]);};};W.New=function(hI,hJ){return new W({name:hI,assignments:hJ});};X=d.Plot_settings=hB.Class({map:function(hI){return X.New(this.x_label,this.y_label,this.title,this.label_font_size,this.tick_font_size,this.x_ticks,this.y_ticks,this.x_min,this.x_max,this.y_min,this.y_max,bX.map(hI,this.v_boundaries),bX.map(hI,this.h_boundaries));},update_empty_labels:function(hI,hJ){var hK;hK=this.x_label===""?X.New(hI,this.y_label,this.title,this.label_font_size,this.tick_font_size,this.x_ticks,this.y_ticks,this.x_min,this.x_max,this.y_min,this.y_max,this.v_boundaries,this.h_boundaries):this;return hK.y_label===""?X.New(hK.x_label,hJ,hK.title,hK.label_font_size,hK.tick_font_size,hK.x_ticks,hK.y_ticks,hK.x_min,hK.x_max,hK.y_min,hK.y_max,hK.v_boundaries,hK.h_boundaries):hK;}},null,X);X.get_defaults=function(){return X.New("","","",16,16,bY.Empty,bY.Empty,null,null,null,null,bY.Empty,bY.Empty);};X.parse=function(hI){return X.parse_defaults(X.get_defaults(),hI);};X.parse_defaults=function(hI,hJ){var hK,hL,hM,hN,hO,hP,hQ,hR;function hS(h5,h6){return X.New(h5,h6.y_label,h6.title,h6.label_font_size,h6.tick_font_size,h6.x_ticks,h6.y_ticks,h6.x_min,h6.x_max,h6.y_min,h6.y_max,h6.v_boundaries,h6.h_boundaries);}function hT(h5,h6){return X.New(h6.x_label,h5,h6.title,h6.label_font_size,h6.tick_font_size,h6.x_ticks,h6.y_ticks,h6.x_min,h6.x_max,h6.y_min,h6.y_max,h6.v_boundaries,h6.h_boundaries);}function hU(h5,h6){return X.New(h6.x_label,h6.y_label,h5,h6.label_font_size,h6.tick_font_size,h6.x_ticks,h6.y_ticks,h6.x_min,h6.x_max,h6.y_min,h6.y_max,h6.v_boundaries,h6.h_boundaries);}function hV(h5,h6){return X.New(h6.x_label,h6.y_label,h6.title,h5,h6.tick_font_size,h6.x_ticks,h6.y_ticks,h6.x_min,h6.x_max,h6.y_min,h6.y_max,h6.v_boundaries,h6.h_boundaries);}function hW(h5,h6){return X.New(h6.x_label,h6.y_label,h6.title,h6.label_font_size,h5,h6.x_ticks,h6.y_ticks,h6.x_min,h6.x_max,h6.y_min,h6.y_max,h6.v_boundaries,h6.h_boundaries);}function hX(h5,h6){return X.New(h6.x_label,h6.y_label,h6.title,h6.label_font_size,h6.tick_font_size,h5,h6.y_ticks,h6.x_min,h6.x_max,h6.y_min,h6.y_max,h6.v_boundaries,h6.h_boundaries);}function hY(h5,h6){return X.New(h6.x_label,h6.y_label,h6.title,h6.label_font_size,h6.tick_font_size,h6.x_ticks,h5,h6.x_min,h6.x_max,h6.y_min,h6.y_max,h6.v_boundaries,h6.h_boundaries);}function hZ(h5,h6){return X.New(h6.x_label,h6.y_label,h6.title,h6.label_font_size,h6.tick_font_size,h6.x_ticks,h6.y_ticks,{$:1,$0:h5},h6.x_max,h6.y_min,h6.y_max,h6.v_boundaries,h6.h_boundaries);}function h0(h5,h6){return X.New(h6.x_label,h6.y_label,h6.title,h6.label_font_size,h6.tick_font_size,h6.x_ticks,h6.y_ticks,h6.x_min,{$:1,$0:h5},h6.y_min,h6.y_max,h6.v_boundaries,h6.h_boundaries);}function h1(h5,h6){return X.New(h6.x_label,h6.y_label,h6.title,h6.label_font_size,h6.tick_font_size,h6.x_ticks,h6.y_ticks,h6.x_min,h6.x_max,{$:1,$0:h5},h6.y_max,h6.v_boundaries,h6.h_boundaries);}function h2(h5,h6){return X.New(h6.x_label,h6.y_label,h6.title,h6.label_font_size,h6.tick_font_size,h6.x_ticks,h6.y_ticks,h6.x_min,h6.x_max,h6.y_min,{$:1,$0:h5},h6.v_boundaries,h6.h_boundaries);}function h3(h5,h6){return X.New(h6.x_label,h6.y_label,h6.title,h6.label_font_size,h6.tick_font_size,h6.x_ticks,h6.y_ticks,h6.x_min,h6.x_max,h6.y_min,h6.y_max,h5,h6.h_boundaries);}function h4(h5,h6){return X.New(h6.x_label,h6.y_label,h6.title,h6.label_font_size,h6.tick_font_size,h6.x_ticks,h6.y_ticks,h6.x_min,h6.x_max,h6.y_min,h6.y_max,h6.v_boundaries,h5);}hK=cR.satisfy(function(h5){return h5!=="\\"";});return cR.record(hI,bX.ofArray([["x_label",(hL=cR.between(cR.pchar("\\""),cR.pchar("\\""),cR.manyChars(hK)),function(h5){return gz.op_BarGreaterGreater(hL,function(h6){return function(h7){return hS(h6,h7);};},h5[0],h5[1]);})],["y_label",(hM=cR.between(cR.pchar("\\""),cR.pchar("\\""),cR.manyChars(hK)),function(h5){return gz.op_BarGreaterGreater(hM,function(h6){return function(h7){return hT(h6,h7);};},h5[0],h5[1]);})],["title",(hN=cR.between(cR.pchar("\\""),cR.pchar("\\""),cR.manyChars(hK)),function(h5){return gz.op_BarGreaterGreater(hN,function(h6){return function(h7){return hU(h6,h7);};},h5[0],h5[1]);})],["label_font_size",function(h5){return gz.op_BarGreaterGreater(cR.pint32(),function(h6){return function(h7){return hV(h6,h7);};},h5[0],h5[1]);}],["tick_font_size",function(h5){return gz.op_BarGreaterGreater(cR.pint32(),function(h6){return function(h7){return hW(h6,h7);};},h5[0],h5[1]);}],["x_ticks",(hO=cR.list_of(cR.pfloat()),function(h5){return gz.op_BarGreaterGreater(hO,function(h6){return function(h7){return hX(h6,h7);};},h5[0],h5[1]);})],["y_ticks",(hP=cR.list_of(cR.pfloat()),function(h5){return gz.op_BarGreaterGreater(hP,function(h6){return function(h7){return hY(h6,h7);};},h5[0],h5[1]);})],["x_min",function(h5){return gz.op_BarGreaterGreater(cR.pfloat(),function(h6){return function(h7){return hZ(h6,h7);};},h5[0],h5[1]);}],["x_max",function(h5){return gz.op_BarGreaterGreater(cR.pfloat(),function(h6){return function(h7){return h0(h6,h7);};},h5[0],h5[1]);}],["y_min",function(h5){return gz.op_BarGreaterGreater(cR.pfloat(),function(h6){return function(h7){return h1(h6,h7);};},h5[0],h5[1]);}],["y_max",function(h5){return gz.op_BarGreaterGreater(cR.pfloat(),function(h6){return function(h7){return h2(h6,h7);};},h5[0],h5[1]);}],["v_boundaries",(hQ=cR.list_of(hJ),function(h5){return gz.op_BarGreaterGreater(hQ,function(h6){return function(h7){return h3(h6,h7);};},h5[0],h5[1]);})],["h_boundaries",(hR=cR.list_of(hJ),function(h5){return gz.op_BarGreaterGreater(hR,function(h6){return function(h7){return h4(h6,h7);};},h5[0],h5[1]);})]]));};X.New=function(hI,hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU){return new X({x_label:hI,y_label:hJ,title:hK,label_font_size:hL,tick_font_size:hM,x_ticks:hN,y_ticks:hO,x_min:hP,x_max:hQ,y_min:hR,y_max:hS,v_boundaries:hT,h_boundaries:hU});};Y=d.Crn_settings=hB.Class({map_plots:function(hI,hJ){return Y.New(this.simulation.map(hJ),bX.map(function(hK){return hK.map(hJ);},this.simulations),this.stochastic,this.deterministic,G.map(hJ,this.spatial),this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,this.parameters,this.sweeps,bW.Map(function(hK,hL){return(function(){return hI;}(hK))(hL);},this.rates),this.plot.map(hJ),this.quiet);},to_string:function(hI,hJ){var hK;function hL(hN,hO){return(function(hP){return function(hQ){return hP("[\\n  "+cA.toSafe(hQ)+"\\n]");};}(a.id))(cS.concat(";\\n  ",bX.map(hN,hO)));}function hM(hN,hO,hP){return hN?"":(((hB.Curried3(function(hQ,hR,hS){return hQ("directive "+cA.toSafe(hR)+" "+cA.toSafe(hS)+"\\n");}))(a.id))(hO))(hP);}hK=Y.get_defaults();return hM(cw.Equals(this.simulation,hK.simulation),"simulation",this.simulation.to_string(hJ))+hM(cw.Equals(this.simulations,hK.simulations),"simulations",hL(function(hN){return(((hB.Curried3(function(hO,hP,hQ){return hO(cA.toSafe(hP)+" = "+cA.toSafe(hQ));}))(a.id))(hN.name))(hN.to_string(hJ));},this.simulations))+hM(cw.Equals(this.simulator,hK.simulator),"simulator",U.get_to_string(this.simulator))+hM(cw.Equals(this.stochastic,hK.stochastic),"stochastic",v.to_string(this.stochastic))+hM(cw.Equals(this.deterministic,hK.deterministic),"deterministic",w.to_string(this.deterministic))+hM(cw.Equals(this.units,hK.units),"units",this.units.get_to_string())+hM(cw.Equals(this.spatial,hK.spatial),"spatial",G.to_string(hJ,this.spatial))+hM(cw.Equals(this.parameters,hK.parameters),"parameters",cX.to_string(this.parameters))+hM(cw.Equals(this.inference,hK.inference),"inference",(J.get_to_string())(this.inference))+hM(cw.Equals(this.sweeps,hK.sweeps),"sweeps",W.list_to_string(this.sweeps))+hM(cw.Equals(this.data,hK.data),"data","["+cS.concat("; ",bX.map(function(hN){return hN.file;},this.data))+"]")+hM(cw.Equals(this.rates,hK.rates),"rates",hL(function(hN){return(((hB.Curried3(function(hO,hP,hQ){return hO(cA.toSafe(hP)+" = "+cA.toSafe(hQ));}))(a.id))(hN[0]))(hI(hN[1]));},bX.ofSeq(bW.ToSeq(this.rates))));},map:function(hI){return Y.New(this.simulation.map(hI),bX.map(function(hJ){return hJ.map(hI);},this.simulations),this.stochastic,this.deterministic,G.map(hI,this.spatial),this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,this.parameters,this.sweeps,bW.Map(function(hJ,hK){return(function(){return hI;}(hJ))(hK);},this.rates),this.plot.map(hI),this.quiet);},update_simulation:function(hI){return Y.New(hI,this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,this.parameters,this.sweeps,this.rates,this.plot,this.quiet);},collect_plots:function(hI){return Y.New(this.simulation.collect_plots(hI),bX.map(function(hJ){return hJ.collect_plots(hI);},this.simulations),this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,this.parameters,this.sweeps,this.rates,this.plot,this.quiet);},update_empty_plot_labels:function(){var hI;hI=U.plot_label(this.simulator,this.spatial.dimensions,this.units);return Y.New(this.simulation,this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,this.parameters,this.sweeps,this.rates,this.plot.update_empty_labels(hI[0],hI[1]),this.quiet);},update_times:function(hI){return Y.New(this.simulation.update_times(hI),this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,this.parameters,this.sweeps,this.rates,this.plot,this.quiet);},to_inference_runs:function(hI){var hJ,hK,hL;hJ=bX.unzip3(bX.map(function(hM){var hN;hN=bX.unzip3(bX.map(function(hO){var hP,hQ,hR,hS,hT,hU;hP=hO.filter_data(hM.data);hQ=bX.collect(function(hV){return bX.map(function(hW){return hO["final"]<bX.max(hW.times)?O.filter_by_tmax(hO["final"],hW):hW;},hV.data);},hP);hR=hO.filter_sweeps(hM.sweeps);hS=hP.get_Length();hT=hR.get_Length();(hS===1?hT===0||(hU=[hS,hT],false):(hU=[hS,hT],false))?void 0:hU[0]!==hU[1]?(function(hV){return function(hW){return hV("Incompatible number of sweeps and data in simulation "+cA.toSafe(hW));};}(be.FailWith))(hO.name):void 0;return[bX.map(function(hV){return hO.update_times(hV.times);},hQ),hQ,hR];},hM.simulations.$===0?bX.ofArray([hM.simulation]):hM.simulations));return[bX.concat(hN[0]),bX.concat(hN[1]),bX.concat(hN[2])];},hI));hK=hJ[2];hL=cX.expand_multiples(cw.Equals(hK,bX.ofArray([bY.Empty]))?bX.ofArray([bX.ofArray([W.create$7()])]):hK,this.parameters);return[hL[1],hJ[1],hL[0],hJ[0],hL[2]];},to_simulation_runs:function(hI){var hJ,hK,hL;hJ=this;hK=cX.to_env(this.parameters);hL=bX.unzip(bX.map(function(hM){var hN;function hO(hP,hQ,hR,hS){return by.create$5(hI,hP,hQ,hR,hM,hS);}hN=bX.collect(function(hP){return hP.data;},hM.filter_data(hJ.data));return[bX.map(function(hP){return hO(hP[0],hP[1],hP[2],hP[3]);},fy.eval_label(hK,hM.filter_sweeps(hJ.sweeps))),hN];},this.simulations.$===0?bX.ofArray([this.simulation]):this.simulations));return[bX.concat(hL[0]),bX.concat(hL[1])];},all_used_rates:function(hI,hJ){var hK;hK=this;return bW.OfArray(ck.ofSeq(bX.map(function(hL){return[hL,hK.rates.get_Item(hL)];},function(hL){var hM,hN,hO;while(true){hN=new cK.New$1(c6.OfSeq((function(hP){return function(hQ){return bX.collect(hP,hQ);};}(function(hP){return hI(hK.rates.get_Item(hP));}))(hL)));hO=bX.ofSeq((hM=new cK.New$1(c6.OfSeq(hL)),c5.Filter(function(hP){return!hM.Contains(hP);},hN)));if(hO.$==0)return hL;else hL=bX.append(hL,hO);}}(bX.append(bX.collect(function(hL){var hM,hN;return bX.append((hM=hL.rate,hM.$==1?hI(hM.$0):bY.Empty),(hN=hL.reverse,hN!=null&&hN.$==1?hN.$0.$==1?hI(hN.$0.$0):bY.Empty:bY.Empty));},hJ),bX.collect(hI,bX.append(this.simulation.plots,bX.concat(bX.map(function(hL){return hL.plots;},this.simulations)))))))));},substitute:function(hI){return Y.New(this.simulation,this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,cX.substitute(hI,this.parameters),this.sweeps,this.rates,this.plot,this.quiet);},from_directive:function(hI){return hI.$==1?Y.New(this.simulation,hI.$0,this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,this.parameters,this.sweeps,this.rates,this.plot,this.quiet):hI.$==2?Y.New(this.simulation,this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,this.units,hI.$0,this.parameters,this.sweeps,this.rates,this.plot,this.quiet):hI.$==3?Y.New(this.simulation,this.simulations,hI.$0,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,this.parameters,this.sweeps,this.rates,this.plot,this.quiet):hI.$==4?Y.New(this.simulation,this.simulations,this.stochastic,hI.$0,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,this.parameters,this.sweeps,this.rates,this.plot,this.quiet):hI.$==5?Y.New(this.simulation,this.simulations,this.stochastic,this.deterministic,this.spatial,hI.$0,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,this.parameters,this.sweeps,this.rates,this.plot,this.quiet):hI.$==6?Y.New(this.simulation,this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,hI.$0,this.sweeps,this.rates,this.plot,this.quiet):hI.$==7?Y.New(this.simulation,this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,this.parameters,this.sweeps,hI.$0,this.plot,this.quiet):hI.$==8?Y.New(this.simulation,this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,this.parameters,hI.$0,this.rates,this.plot,this.quiet):hI.$==9?Y.New(this.simulation,this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,bX.map(P.empty,hI.$0),this.units,this.simulator,this.parameters,this.sweeps,this.rates,this.plot,this.quiet):hI.$==10?Y.New(this.simulation,this.simulations,this.stochastic,this.deterministic,hI.$0,this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,this.parameters,this.sweeps,this.rates,this.plot,this.quiet):hI.$==11?Y.New(this.simulation,this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,this.parameters,this.sweeps,this.rates,hI.$0,this.quiet):hI.$==12?Y.New(this.simulation,this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,hI.$0,this.simulator,this.parameters,this.sweeps,this.rates,this.plot,this.quiet):hI.$==13?Y.New(this.simulation,this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,hI.$0,this.synthesis,this.data,this.units,this.simulator,this.parameters,this.sweeps,this.rates,this.plot,this.quiet):hI.$==14?Y.New(this.simulation,this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,hI.$0,this.data,this.units,this.simulator,this.parameters,this.sweeps,this.rates,this.plot,this.quiet):Y.New(hI.$0,this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,this.parameters,this.sweeps,this.rates,this.plot,this.quiet);},from_directive_list:function(hI){return Y.checkSweepParameters(co.fold(function(hJ,hK){return hJ.from_directive(hK);},this,hI));},from_default_directive_list:function(hI){return co.fold(function(hJ,hK){return hJ.from__default_directive(hK);},this,hI);},from__default_directive:function(hI){var hJ,hK,hL;function hM(hP){function hQ(hR){return hR.name!==hP.name;}return function(hR){return bX.filter(hQ,hR);};}function hN(hP){function hQ(hR){return hR.name!==hP.name;}return function(hR){return bX.filter(hQ,hR);};}function hO(hP){function hQ(hR){return hR.name!==hP.name;}return function(hR){return bX.filter(hQ,hR);};}return hI.$==1?(hJ=hI.$0,Y.New(this.simulation,bX.append(co.fold(function(hP,hQ){return(hM(hQ))(hP);},this.simulations,hJ),hJ),this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,this.parameters,this.sweeps,this.rates,this.plot,this.quiet)):hI.$==2?Y.New(this.simulation,this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,this.units,hI.$0,this.parameters,this.sweeps,this.rates,this.plot,this.quiet):hI.$==3?Y.New(this.simulation,this.simulations,hI.$0,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,this.parameters,this.sweeps,this.rates,this.plot,this.quiet):hI.$==4?Y.New(this.simulation,this.simulations,this.stochastic,hI.$0,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,this.parameters,this.sweeps,this.rates,this.plot,this.quiet):hI.$==5?Y.New(this.simulation,this.simulations,this.stochastic,this.deterministic,this.spatial,hI.$0,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,this.parameters,this.sweeps,this.rates,this.plot,this.quiet):hI.$==6?(hK=hI.$0,Y.New(this.simulation,this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,bX.append(co.fold(function(hP,hQ){return(hN(hQ))(hP);},this.parameters,hK),hK),this.sweeps,this.rates,this.plot,this.quiet)):hI.$==7?Y.New(this.simulation,this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,this.parameters,this.sweeps,co.fold(function(hP,hQ){return hP.Add(hQ[0],hQ[1]);},this.rates,bX.ofSeq(bW.ToSeq(hI.$0))),this.plot,this.quiet):hI.$==8?(hL=hI.$0,Y.New(this.simulation,this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,this.parameters,bX.append(co.fold(function(hP,hQ){return(hO(hQ))(hP);},this.sweeps,hL),hL),this.rates,this.plot,this.quiet)):hI.$==9?Y.New(this.simulation,this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,bX.map(P.empty,hI.$0),this.units,this.simulator,this.parameters,this.sweeps,this.rates,this.plot,this.quiet):hI.$==10?Y.New(this.simulation,this.simulations,this.stochastic,this.deterministic,hI.$0,this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,this.parameters,this.sweeps,this.rates,this.plot,this.quiet):hI.$==11?Y.New(this.simulation,this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,this.parameters,this.sweeps,this.rates,hI.$0,this.quiet):hI.$==12?Y.New(this.simulation,this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,hI.$0,this.simulator,this.parameters,this.sweeps,this.rates,this.plot,this.quiet):hI.$==13?Y.New(this.simulation,this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,hI.$0,this.synthesis,this.data,this.units,this.simulator,this.parameters,this.sweeps,this.rates,this.plot,this.quiet):hI.$==14?Y.New(this.simulation,this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,hI.$0,this.data,this.units,this.simulator,this.parameters,this.sweeps,this.rates,this.plot,this.quiet):Y.New(hI.$0,this.simulations,this.stochastic,this.deterministic,this.spatial,this.inference,this.moment_closure,this.synthesis,this.data,this.units,this.simulator,this.parameters,this.sweeps,this.rates,this.plot,this.quiet);}},null,Y);Y.get_defaults=function(){return Y.New(bx.get_defaults(),bY.Empty,v.get_defaults(),w.get_defaults(),G.get_defaults(),J.get_defaults(),K.defaults(),M.get_defaults(),bY.Empty,T.get_defaults(),U.get_defaults(),bY.Empty,bY.Empty,new cj.New([]),X.get_defaults(),false);};Y.parse_defaults=function(hI,hJ,hK){var hL;function hM(hN){return hK.from_directive_list(hN);}hL=f6.parse_list(hI,hJ);return function(hN){return gz.op_BarGreaterGreater(hL,hM,hN[0],hN[1]);};};Y.checkSweepParameters=function(hI){var hJ;hJ=bX.distinct(bX.map(function(hK){return hK.name;},hI.parameters));bX.iter(function(hK){if(!bX.contains(hK,hJ))((function(hL){return function(hM){return hL("Sweep variable "+cA.toSafe(hM)+" not initialised");};}(be.FailWith))(hK));},bX.collect(function(hK){return hK.get_mentions();},hI.sweeps));return hI;};Y.parse_directives_defaults=function(hI,hJ,hK){var hL,hM;return cR.sepBy((hL=cR.kw("directive"),(hM=Y.parse_directive_defaults(hI,hJ,hK),function(hN){return gz.op_GreaterGreaterDot(hL,hM,hN[0],hN[1]);})),cR.spaces());};Y.parse_directive_defaults=function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0,h1,h2,h3,h4,h5,h6,h7,h8,h9,h_,h$,ia,ib,ic,id,ie,_if,ig,ih,ii,ij,ik,il,im,_in,io,ip,iq,ir,is,it;function iu(iJ){return co.fold(function(iK,iL){var iM;iM=iL[0];if(iK.ContainsKey(iM))throw new dT.New((function(iN){return function(iO){return iN("Failed trying to parse duplicate rate expression "+cA.toSafe(iO));};}(a.id))(iM));else return iK.Add(iM,iL[1]);},new cj.New([]),iJ);}function iv(iJ){return{$:4,$0:iJ};}function iw(iJ){return{$:3,$0:iJ};}function ix(iJ){return{$:1,$0:iJ};}function iy(iJ){return{$:0,$0:iJ};}function iz(iJ){return{$:2,$0:iJ};}function iA(iJ){return{$:6,$0:iJ};}function iB(iJ){return{$:8,$0:iJ};}function iC(iJ){return{$:9,$0:iJ};}function iD(iJ){return{$:5,$0:iJ};}function iE(iJ){return{$:10,$0:iJ};}function iF(iJ){return{$:7,$0:iJ};}function iG(iJ){return{$:11,$0:iJ};}function iH(iJ){return{$:13,$0:iJ};}function iI(iJ){return{$:12,$0:iJ};}hL=(hM=cR.list_of((hN=(hO=cR.skw("="),function(iJ){return gz.op_GreaterGreaterDot(hO,hJ,iJ[0],iJ[1]);}),function(iJ){return gz.op_DotGreaterGreaterDot(cR.name(),hN,iJ[0],iJ[1]);})),(hP=function(iJ){return cR.preturn(iu(iJ));},function(iJ){return gz.op_GreaterGreaterEquals(hM,hP,iJ[0],iJ[1]);}));hQ=cR.choice([(hR=(hS=cR.kw("deterministic"),(hT=w.parse_defaults(hI.deterministic),function(iJ){return gz.op_GreaterGreaterDot(hS,hT,iJ[0],iJ[1]);})),function(iJ){return gz.op_BarGreaterGreater(hR,iv,iJ[0],iJ[1]);}),(hU=(hV=cR.kw("stochastic"),(hW=v.parse_defaults(hI.stochastic),function(iJ){return gz.op_GreaterGreaterDot(hV,hW,iJ[0],iJ[1]);})),function(iJ){return gz.op_BarGreaterGreater(hU,iw,iJ[0],iJ[1]);}),(hX=(hY=cR.kw("simulations"),(hZ=cR.list_of(bx.parse_named_defaults(hI.simulation,hK)),function(iJ){return gz.op_GreaterGreaterDot(hY,hZ,iJ[0],iJ[1]);})),function(iJ){return gz.op_BarGreaterGreater(hX,ix,iJ[0],iJ[1]);}),(h0=(h1=cR.kw("simulation"),(h2=bx.parse_defaults(hI.simulation,hK),function(iJ){return gz.op_GreaterGreaterDot(h1,h2,iJ[0],iJ[1]);})),function(iJ){return gz.op_BarGreaterGreater(h0,iy,iJ[0],iJ[1]);}),(h3=(h4=cR.kw("simulator"),(h5=U.get_parse(),function(iJ){return gz.op_GreaterGreaterDot(h4,h5,iJ[0],iJ[1]);})),function(iJ){return gz.op_BarGreaterGreater(h3,iz,iJ[0],iJ[1]);}),(h6=(h7=cR.kw("parameters"),(h8=cR.list_of(F.get_parse()),function(iJ){return gz.op_GreaterGreaterDot(h7,h8,iJ[0],iJ[1]);})),function(iJ){return gz.op_BarGreaterGreater(h6,iA,iJ[0],iJ[1]);}),(h9=(h_=cR.kw("sweeps"),(h$=cR.list_of(W.get_parse()),function(iJ){return gz.op_GreaterGreaterDot(h_,h$,iJ[0],iJ[1]);})),function(iJ){return gz.op_BarGreaterGreater(h9,iB,iJ[0],iJ[1]);}),(ia=(ib=cR.kw("data"),(ic=cR.list_of(cR.name()),function(iJ){return gz.op_GreaterGreaterDot(ib,ic,iJ[0],iJ[1]);})),function(iJ){return gz.op_BarGreaterGreater(ia,iC,iJ[0],iJ[1]);}),(id=(ie=cR.kw("inference"),(_if=J.parse_defaults(hI.inference),function(iJ){return gz.op_GreaterGreaterDot(ie,_if,iJ[0],iJ[1]);})),function(iJ){return gz.op_BarGreaterGreater(id,iD,iJ[0],iJ[1]);}),(ig=(ih=cR.kw("spatial"),(ii=G.parse_defaults(hI.spatial,hK),function(iJ){return gz.op_GreaterGreaterDot(ih,ii,iJ[0],iJ[1]);})),function(iJ){return gz.op_BarGreaterGreater(ig,iE,iJ[0],iJ[1]);}),(ij=(ik=cR.kw("rates"),function(iJ){return gz.op_GreaterGreaterDot(ik,hL,iJ[0],iJ[1]);}),function(iJ){return gz.op_BarGreaterGreater(ij,iF,iJ[0],iJ[1]);}),(il=(im=cR.kw("plot_settings"),(_in=X.parse_defaults(hI.plot,hK),function(iJ){return gz.op_GreaterGreaterDot(im,_in,iJ[0],iJ[1]);})),function(iJ){return gz.op_BarGreaterGreater(il,iG,iJ[0],iJ[1]);}),(io=(ip=cR.kw("moments"),(iq=K.parse_defaults(hI.moment_closure),function(iJ){return gz.op_GreaterGreaterDot(ip,iq,iJ[0],iJ[1]);})),function(iJ){return gz.op_BarGreaterGreater(io,iH,iJ[0],iJ[1]);}),(ir=(is=cR.kw("units"),(it=T.get_parse(),function(iJ){return gz.op_GreaterGreaterDot(is,it,iJ[0],iJ[1]);})),function(iJ){return gz.op_BarGreaterGreater(ir,iI,iJ[0],iJ[1]);})]);return function(iJ){return hQ([iJ[0],iJ[1]]);};};Y.New=function(hI,hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX){return new Y({simulation:hI,simulations:hJ,stochastic:hK,deterministic:hL,spatial:hM,inference:hN,moment_closure:hO,synthesis:hP,data:hQ,units:hR,simulator:hS,parameters:hT,sweeps:hU,rates:hV,plot:hW,quiet:hX});};_0.New=function(hI,hJ){return{element:hI,multiplicity:hJ};};_1=d.Rate=hB.Class({map:function(hI,hJ){return this.$==1?new _1({$:1,$0:hJ(this.$0)}):new _1({$:0,$0:hI(this.$0)});},to_string_bare:function(hI,hJ){return this.fold(hI,hJ);},fold:function(hI,hJ){return this.$==1?hJ(this.$0):hI(this.$0);},to_string:function(hI,hJ){return this.fold(function(hK){return"{"+hI(hK)+"}";},function(hK){return"["+hJ(hK)+"]";});}},null,_1);_1.map2=function(hI,hJ,hK){return hK.map(hI,hJ);};_1.parse=function(hI,hJ){var hK,hL,hM,hN;function hO(hQ){return new _1({$:0,$0:hQ});}function hP(hQ){return new _1({$:1,$0:hQ});}hK=(hL=(cR.bracket("{","}"))(hI),function(hQ){return gz.op_BarGreaterGreater(hL,hO,hQ[0],hQ[1]);});hM=(hN=(cR.bracket("[","]"))(hJ),function(hQ){return gz.op_BarGreaterGreater(hN,hP,hQ[0],hQ[1]);});return function(hQ){return gz.op_LessBarGreater(hK,hM,hQ[0],hQ[1]);};};_2=d.Reaction=hB.Class({stochastic_to_deterministic:function(hI){return br.mul(hI,{$:1,$0:this.get_conversion_factor()});},getStoich:function(hI,hJ){return hI?0:this.numInProducts(hJ)-this.numInReactants(hJ);},get_allSpecies:function(){return Z.elements(Z.union(cw.Equals,Z.union(cw.Equals,this.reactants,this.products),this.catalysts));},scale:function(hI,hJ,hK){var hL,hM,hN;function hO(hP,hQ){return hQ.map(hI(hJ,hP),hK);}return hJ===1?this:(hL=Z.size(this.reactants)+Z.size(this.catalysts),(hM=Z.size(this.products)+Z.size(this.catalysts),(hN=hO(hL,this.rate),_2.create$4(this.catalysts,this.reactants,dZ.option_map2(function(hP){return hO(hM,hP);},this.reverse),hN,this.products))));},get_conversion_factor:function(){return Z.fold_left_m(function(hI,hJ){return hI*dZ.fac(hJ.multiplicity);},1,this.reactants);},numInProducts:function(hI){return Z.get_mult(cw.Equals,this.products,hI);},numInReactants:function(hI){return Z.get_mult(cw.Equals,this.reactants,hI);},normalise:function(){var hI,hJ;hI=_2.create$4(Z.empty(),Z.union(cw.Equals,this.reactants,this.catalysts),null,this.rate,Z.union(cw.Equals,this.products,this.catalysts));return[hI,(hJ=this.reverse,hJ!=null&&hJ.$==1?{$:1,$0:_2.create$4(Z.empty(),hI.products,null,hJ.$0,hI.reactants)}:null)];},string:function(hI,hJ,hK){var hL;function hM(hO){var hP;hP=hO.to_string(hJ,hK);return hP==="{1.0}"?"":hP;}function hN(hO){return Z.to_string(hI," + ",hO);}return dZ.string_of_list(a.id," ",bX.filter(function(hO){return hO!=="";},bX.ofArray([Z.is_empty(this.catalysts)?"":hN(this.catalysts)+" ~",hN(this.reactants),(hL=this.reverse,hL!=null&&hL.$==1?"<->"+hM(this.rate)+hM(hL.$0):"->"+hM(this.rate)),hN(this.products)])));},deterministic_to_stochastic:function(hI){return br.div(hI,{$:1,$0:this.get_conversion_factor()});}},null,_2);_2.map=function(hI,hJ,hK,hL){return _2.create$4(Z.map(hI,hL.catalysts),Z.map(hI,hL.reactants),dZ.option_map2(function(hM){return _1.map2(hJ,hK,hM);},hL.reverse),_1.map2(hJ,hK,hL.rate),Z.map(hI,hL.products));};_2.create$3=function(hI,hJ,hK,hL){return _2.create$4(Z.empty(),hI,hJ,hK,hL);};_2.normalise_list=function(hI){return bX.rev(co.fold(function(hJ,hK){var hL,hM,hN;hL=hK.normalise();hM=hL[0];hN=hL[1];return hN!=null&&hN.$==1?new bY({$:1,$0:hN.$0,$1:new bY({$:1,$0:hM,$1:hJ})}):new bY({$:1,$0:hM,$1:hJ});},bY.Empty,hI));};_2.create$4=function(hI,hJ,hK,hL,hM){return _2.New(hI,hJ,hK,hL,hM);};_2.get_sim_reactions_products=function(hI,hJ,hK,hL,hM){function hN(hO){return _2.map(a.id,a.id,br.to_lambda,hO);}return bX.rev(dZ.fold_left(function(hO,hP){var hQ,hR,hS,hT,hU,hV;hQ=_2.convert_simplify(hI,hJ,hK,hL,hP);hR=hQ[0];hS=hQ[1];hT=Z.union(function(hW,hX){return hW===hX;},hR.products,hR.catalysts);return hS!=null&&hS.$==1?(hU=hS.$0,(hV=Z.union(function(hW,hX){return hW===hX;},hU.reactants,hU.catalysts),new bY({$:1,$0:[hN(hU),hV,hU.rate],$1:new bY({$:1,$0:[hN(hR),hT,hR.rate],$1:hO})}))):new bY({$:1,$0:[hN(hR),hT,hR.rate],$1:hO});},bY.Empty,hM));};_2.to_string=function(hI,hJ,hK,hL){return hL.string(hI,hJ,hK);};_2.convert_simplify=function(hI,hJ,hK,hL,hM){var hN;function hO(hR,hS,hT){return hT*hC.pow(hR,1-hS);}function hP(hR){var hS;hS=hJ.tryFind_index(hR);return hS==null?be.FailWith("Species "+hR.name+" not found in a rate expression"):hS.$0;}function hQ(hR){function hS(hT){return es.map(hP,hT);}return function(hT){return br.map(hS,hT);};}hN=bW.Map(function(hR,hS){return(hQ(hR))(hS);},hL);return _2.map(hP,function(hR){return br["eval"](function(hS){return cY.find(hK,hS);},hR);},function(hR){function hS(hU){return bq.map(hP,hU);}function hT(hU){return bq.inline_keys(hK,hN,hU);}return br.simplify(br.expand(function(hU){return hT(hS(hU));},hR));},hM).scale(function(hR,hS){return function(hT){return hO(hR,hS,hT);};},hI,a.id).normalise();};_2.parse=function(hI,hJ,hK,hL){var hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW;function hX(hZ){return{$:1,$0:hZ};}function hY(hZ,h0){var h1,h2,h3,h4;function h5(h6,h7){return cR.preturn(h0!=null&&h0.$==1?_2.create$4(hZ,h0.$0,h6[1],h6[0],h7):_2.create$3(hZ,h6[1],h6[0],h7));}h1=(h2=(h3=cR.choice([_2.parse_reversible(hJ,hK,hL),_2.parse_irreversible(hJ,hK,hL)]),function(h6){return h3([h6[0],h6[1]]);}),(h4=Z.parse(hI),function(h6){return gz.op_PlusGreaterGreaterPlus(h2,h4,h6[0],h6[1]);}));return function(h6){return gz.op_GreaterGreaterEquals(h1,function(h7){return h5(h7[0],h7[1]);},h6[0],h6[1]);};}hM=cR.pTry((hN=(hO=Z.parse(hI),(hP=(hQ=cR.choice([(hR=(hS=cR.kw("~"),(hT=Z.parse(hI),function(hZ){return gz.op_GreaterGreaterDot(hS,hT,hZ[0],hZ[1]);})),function(hZ){return gz.op_BarGreaterGreater(hR,hX,hZ[0],hZ[1]);}),cR.preturn(null)]),function(hZ){return hQ([hZ[0],hZ[1]]);}),function(hZ){return gz.op_PlusGreaterGreaterPlus(hO,hP,hZ[0],hZ[1]);})),(hU=(hV=cR.lookAhead("<->"),(hW=cR.lookAhead("->"),function(hZ){return gz.op_LessBarGreater(hV,hW,hZ[0],hZ[1]);})),function(hZ){return gz.op_PlusGreaterGreater(hN,hU,hZ[0],hZ[1]);})));return function(hZ){return gz.op_GreaterGreaterEquals(hM,function(h0){return hY(h0[0],h0[1]);},hZ[0],hZ[1]);};};_2.parse_reversible=function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW;function hX(hZ,h0){return[new _1({$:0,$0:hZ}),new _1({$:0,$0:h0})];}function hY(hZ,h0){return[hZ,{$:1,$0:h0}];}hL=(hM=cR.kw("<->"),(hN=(hO=cR.pTry((hP=_1.parse(hI,hJ),(hQ=_1.parse(hI,hJ),function(hZ){return gz.op_PlusGreaterGreaterPlus(hP,hQ,hZ[0],hZ[1]);}))),(hR=(hS=(hT=cR.braces((hU=(hV=cR.kw(","),function(hZ){return gz.op_PlusGreaterGreater(hI,hV,hZ[0],hZ[1]);}),function(hZ){return gz.op_PlusGreaterGreaterPlus(hU,hI,hZ[0],hZ[1]);})),(hW=cR.preturn([hK,hK]),function(hZ){return gz.op_LessBarGreater(hT,hW,hZ[0],hZ[1]);})),function(hZ){return gz.op_BarGreaterGreater(hS,function(h0){return hX(h0[0],h0[1]);},hZ[0],hZ[1]);}),function(hZ){return gz.op_LessBarGreater(hO,hR,hZ[0],hZ[1]);})),function(hZ){return gz.op_GreaterGreaterDot(hM,hN,hZ[0],hZ[1]);}));return function(hZ){return gz.op_BarGreaterGreater(hL,function(h0){return hY(h0[0],h0[1]);},hZ[0],hZ[1]);};};_2.parse_irreversible=function(hI,hJ,hK){var hL,hM,hN,hO,hP;function hQ(hR){return[hR,null];}hL=cR.kw("->");hM=(hN=(hO=_1.parse(hI,hJ),function(hR){return gz.op_BarGreaterGreater(hO,hQ,hR[0],hR[1]);}),(hP=cR.preturn([new _1({$:0,$0:hK}),null]),function(hR){return gz.op_LessBarGreater(hN,hP,hR[0],hR[1]);}));return function(hR){return gz.op_GreaterGreaterDot(hL,hM,hR[0],hR[1]);};};_2.New=function(hI,hJ,hK,hL,hM){return new _2({catalysts:hI,reactants:hJ,reverse:hK,rate:hL,products:hM});};_4=_3.core=hB.Class({apply1d:function(hI,hJ){return hC.abs(hI-0.5)<=this.width/2?[hI,hJ+this.inner]:[hI,hJ+this.outer];},apply2d:function(hI,hJ){return _3.distance_from_xy(0.5,0.5,hI[0],hI[1])<=this.width/2?[hI,this.inner+hJ]:[hI,this.outer+hJ];},to_string:function(){return((((hB.Curried(function(hI,hJ,hK,hL){return hI("centralcore = {inner="+cS.PadLeft(hJ.toFixed(3),1)+"; outer="+cS.PadLeft(hK.toFixed(3),1)+"; width="+cS.PadLeft(hL.toFixed(3),1)+"}");},4))(a.id))(this.inner))(this.outer))(this.width);}},null,_4);_4.New=function(hI,hJ,hK){return new _4({inner:hI,outer:hJ,width:hK});};_5=_3.point=hB.Class({apply1d:function(hI,hJ){return hC.abs(this.x-hI)<=this.width/2?[hI,hJ+this.value]:[hI,hJ];},apply2d:function(hI,hJ){return _3.distance_from_xy(this.x,this.y,hI[0],hI[1])<=this.width/2?[hI,this.value+hJ]:[hI,hJ];},to_string:function(){return(((((hB.Curried(function(hI,hJ,hK,hL,hM){return hI("{x="+cS.PadLeft(hJ.toFixed(3),1)+"; y="+cS.PadLeft(hK.toFixed(3),1)+"; width="+cS.PadLeft(hL.toFixed(3),1)+"; value="+cS.PadLeft(hM.toFixed(3),1)+"}");},5))(a.id))(this.x))(this.y))(this.width))(this.value);}},null,_5);_5.New=function(hI,hJ,hK,hL){return new _5({x:hI,y:hJ,width:hK,value:hL});};_6=_3.rectangle=hB.Class({apply1d:function(hI,hJ){return hI>=this.xmin&&hI<=this.xmax?[hI,hJ+this.value]:[hI,hJ];},apply2d:function(hI,hJ){var hK,hL;hK=hI[1];hL=hI[0];return hL>=this.xmin&&hL<=this.xmax&&hK>=this.ymin&&hK<=this.ymax?[[hL,hK],this.value+hJ]:[[hL,hK],hJ];},to_string:function(){return((((((hB.Curried(function(hI,hJ,hK,hL,hM,hN){return hI("{xmin="+cS.PadLeft(hJ.toFixed(3),1)+"; xmax="+cS.PadLeft(hK.toFixed(3),1)+"; ymin = "+cS.PadLeft(hL.toFixed(3),1)+"; ymax = "+cS.PadLeft(hM.toFixed(3),1)+"; value="+cS.PadLeft(hN.toFixed(3),1)+"}");},6))(a.id))(this.xmin))(this.xmax))(this.ymin))(this.ymax))(this.value);}},null,_6);_6.New=function(hI,hJ,hK,hL,hM){return new _6({xmin:hI,xmax:hJ,ymin:hK,ymax:hL,value:hM});};_7.New=function(hI,hJ,hK,hL){return{random:hI,core:hJ,points:hK,rectangles:hL};};_8=d.Initial=hB.Class({scale:function(hI){return _8.New(this.constant,hI(this.value),this.species,this.time,this.spatial);}},null,_8);_8.to_gui=function(hI,hJ,hK){var hL;return _8.create$4(hK.constant,hJ(hK.value),hI(hK.species),(hL=hK.time,hL==null?null:{$:1,$0:hJ(hL.$0)}),hK.spatial);};_8.create$4=function(hI,hJ,hK,hL,hM){return _8.New(hI,hJ,hK,hL,hM);};_8.from_gui=function(hI,hJ,hK){var hL;return _8.create$4(hK.constant,hJ(hK.value),hI(hK.species),(hL=hK.time,hL==null?null:{$:1,$0:hJ(hL.$0)}),hK.spatial);};_8.create$1=function(hI,hJ,hK){return _8.create$4(false,hI,hJ,hK,null);};_8.to_initialpops_events=function(hI,hJ,hK){function hL(hM){return hM.value;}return _8.to_initialpops_events_poly(hI,hJ,hK,function(hM){return co.sumBy(hL,hM);});};_8.create$3=function(hI,hJ,hK,hL){return _8.create$4(hI,hJ,hK,hL,null);};_8.to_initialpops_events_poly=function(hI,hJ,hK,hL){var hM,hN,hO;function hP(hU){return cY.find(hI,hU);}function hQ(hU,hV){function hW(hX,hY){var hZ;hZ=cD.create(co.exists(function(h0){return h0.constant;},hY),hL(hY),hX);return cD.New(hZ.constant,hZ.value,hZ.species,false,hZ.input,hZ.spatial_initial,hZ.max);}return dQ.create(cE.create(bX.ofSeq(co.map(function(hX){return hW(hX[0],hX[1]);},co.groupBy(function(hX){return hX.species;},hV)))),hU);}function hR(hU,hV,hW){return cD.create(hW,hV,hU);}function hS(hU){var hV;hV=co.length(co.filter(function(hW){return hW.constant;},hU));return hV===0?false:hV===1?co.length(hU)===1||be.FailWith("Constancy overload"):be.FailWith("Constancy overload");}function hT(hU,hV){return[hU,hL(co.filter(function(hW){var hX;hX=hW.time;return hX==null||hX.$0===hJ;},hV)),hS(hV)];}hM=bX.map((hN=function(hU){return br["eval"](hP,hU);},function(hU){return _8["eval"](hN,hU);}),hK);hO=bX.ofSeq(co.map(function(hU){return hQ(hU[0],hU[1]);},co.groupBy(function(hU){return hU.time.$0;},bX.filter(function(hU){var hV;hV=hU.time;return hV==null?false:hV.$0!==hJ;},hM))));return[cE.create(bX.ofSeq(co.map(function(hU){return hR(hU[0],hU[1],hU[2]);},co.map(function(hU){return hT(hU[0],hU[1]);},co.groupBy(function(hU){return hU.species;},hM))))),hO];};_8.mapSpecies=function(hI,hJ){return _8.create$4(hJ.constant,hJ.value,hI(hJ.species),hJ.time,hJ.spatial);};_8.mapValues=function(hI,hJ){var hK;return _8.create$4(hJ.constant,hI(hJ.value),hJ.species,(hK=hJ.time,hK==null?null:{$:1,$0:hI(hK.$0)}),hJ.spatial);};_8.to_string=function(hI,hJ,hK,hL){var hM,hN,hO;return(hL.constant?"constant ":"")+hJ(hL.value)+" "+hI(hL.species)+(hM=hL.spatial,hM!=null&&hM.$==1?(hN=hM.$0,!cw.Equals(hN,_3.defaults())?"{ spatial = "+_3.to_string(hN)+"}":""):(hO=hL.time,hO==null?"":" @ "+hJ(hO.$0)));};_8["eval"]=function(hI,hJ){var hK;return _8.create$4(hJ.constant,hI(hJ.value),hJ.species,(hK=hJ.time,hK==null?null:{$:1,$0:hI(hK.$0)}),hJ.spatial);};_8.parse=function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ,hR;function hS(hU,hV){return cR.preturn(_8.create$4(hU[0][0][0],hU[0][1],hU[0][0][1],hU[1],hV));}function hT(hU){return cR.op_LessQmarkGreater(cR.record(_8.create$4(false,hK,hU,null,null),bX.ofArray([["spatial",cR.op_BarGreaterGreater(_3.parser(),function(hV){return function(hW){return _8.New(hW.constant,hW.value,hW.species,hW.time,{$:1,$0:hV});};})],["time",cR.op_BarGreaterGreater(hJ,function(hV){return function(hW){return _8.New(hW.constant,hW.value,hW.species,{$:1,$0:hV},hW.spatial);};})],["value",cR.op_BarGreaterGreater(hJ,function(hV){return function(hW){return _8.New(hW.constant,hV,hW.species,hW.time,hW.spatial);};})],["constant",cR.op_BarGreaterGreater(cR.op_DotGreaterGreater(cR.pbool(),cR.spaces()),function(hV){return function(hW){return _8.New(hV,hW.value,hW.species,hW.time,hW.spatial);};})]])),"{InitialFields}");}hL=cR.kw("constant");hM=cR.kw("init");hN=cR.kw("spatial");hO=cR.opt(cR.op_GreaterGreaterPlus(cR.kw("@"),hJ));hP=cR.op_BarGreaterGreater(cR.opt(hL),function(hU){return hU!=null;});hQ=cR.braces(cR.op_GreaterGreaterDot(cR.op_GreaterGreaterDot(hN,cR.kw("=")),_3.parser()));hR=cR.choice([cR.op_GreaterGreaterEquals(cR.op_DotGreaterGreater(cR.op_GreaterGreaterDot(hM,cR.op_PlusGreaterGreaterPlus(hP,hI)),cR.spaces()),function(hU){var hV;hV=cR.choice([cR.op_BarGreaterGreater(hT(hU[1]),function(hW){return _8.create$4(hU[0],hW.value,hW.species,hW.time,hW.spatial);}),cR.op_GreaterGreaterEquals(cR.op_PlusGreaterGreaterPlus(hJ,hO),function(hW){return hS([[hU,hW[0]],hW[1]],null);})]);return function(hW){return hV([hW[0],hW[1]]);};}),cR.op_LessQmarkGreater(cR.pTry(cR.op_GreaterGreaterEquals(cR.op_PlusGreaterGreater(hI,cR.kw("=")),hT)),"<species> = <record>"),cR.op_GreaterGreaterEquals(cR.op_DotGreaterGreaterDot(cR.op_LessQmarkGreater(cR.pTry(cR.op_PlusGreaterGreaterPlus(cR.op_PlusGreaterGreaterPlus(cR.op_DotGreaterGreaterDot(hP,hJ),hI),hO)),"<value> <species>"),cR.opt(hQ)),function(hU){var hV;hV=hU[0];return hS([[[hV[0][0][0],hV[0][1]],hV[0][0][1]],hV[1]],hU[1]);})]);return function(hU){return hR([hU[0],hU[1]]);};};_8.New=function(hI,hJ,hK,hL,hM){return new _8({constant:hI,value:hJ,species:hK,time:hL,spatial:hM});};_9.New=function(hI,hJ,hK){return{name:hI,structure:hJ,svg:hK};};_=d.Gui=hB.Class({to_crn:function(){var hI,hJ,hK,hL,hM,hN,hO,hP,hQ,hR;function hS(hU){return br.from_string(cR.name(),hU);}function hT(hU){return br.from_string(cR.name(),hU);}hI=(hJ=bG.get_from_string(),function(hU){return _2.map(hJ,hS,cL.from_string,hU);});hK=(hL=bG.get_from_string(),function(hU){return _8.from_gui(hL,hT,hU);});hM=this.settings.map_plots(cL.from_string,cL.from_string_plot);return cn.New(this.name,hM.map((hN=(hO=hM.rates,function(hU){return cn.species_to_rates(hO,hU);}),function(hU){return br.map(hN,hU);})),bX.map((hP=(hQ=(hR=hM.rates,function(hU){return cn.species_to_rates(hR,hU);}),function(hU){return br.map(hQ,hU);}),function(hU){return _2.map(a.id,a.id,hP,hU);}),bX.map(hI,this.reactions)),bX.map(hK,this.initials),this.attributes);}},null,_);_.from_crn=function(hI){var hJ,hK;return _.New(hI.name,hI.settings.map_plots(cL.to_string,cL.to_string_plot),bX.map((hJ=function(hL){return br.to_string(a.id,hL);},function(hL){return _2.map(bG.to_string,hJ,cL.to_string,hL);}),hI.reactions),bX.map((hK=function(hL){return br.to_string(a.id,hL);},function(hL){return _8.to_gui(bG.to_string,hK,hL);}),hI.initials),hI.attributes);};_.New=function(hI,hJ,hK,hL,hM){return new _({name:hI,settings:hJ,reactions:hK,initials:hL,attributes:hM});};$=d.GuiModel=hB.Class({to_model:function(){return cm.New(this.top.to_crn(),bX.map(function(hI){return hI.to_crn();},this.systems));}},null,$);$.from_model=function(hI){return $.New(_.from_crn(hI.top),bX.map(_.from_crn,hI.systems));};$.New=function(hI,hJ){return new $({top:hI,systems:hJ});};ba.user_parse_code=function(hI){return r.from_ig(ba.parse_code(hI));};ba.user_get_exports=function(hI,hJ,hK){return ba.model_to_export(hI,hJ.to_ig(),hK);};ba.user_get_export=function(hI,hJ,hK){return ba.model_to_single_export(hI.to_ig(),hJ,hK);};ba.user_infer_gui=function(hI,hJ,hK,hL,hM){var hN,hO;hN=m.expandAndLift(hI.to_ig());hO=[];m.inferWith(function(hP){var hQ,hR,hS,hT,hU;function hV(hW,hX,hY){return hW!=null&&hW.$==1?{$:1,$0:ba.convert_inference_result(hP.top.name,hW.$0,hY)}:null;}hQ=null;hR=hP.infer_seq(function(hW){hQ={$:1,$0:hW};});hS=bX.map(function(hW){var hX;return bC.New(hW.name,bB.New((hX=hW.range.pType,hX.$==1?"Log":hX.$==2?"Fixed":"Real"),hW.range.lb,hW.range.ub),hW.initValue);},hR[1]);hT=co.choose(function(hW){return hV(hW[0],hW[1],hW[2]);},hR[0]);hK(bD.New(hP.top.name,hS));co.iter(hL,hT);hQ==null?void 0:(hU=hQ.$0,hU.posterior.$!==0?hO.push([hP.top.name,cr.results_to_html_content(cr.mcmc_to_results(hP.top.settings,hP,hU))]):void 0);return hQ.$0.to_summary();},hN);hJ(ba.combine_dynchar_exports(bX.ofSeq(hO)));};ba.user_state_space=function(hI){var hJ;hJ=(co.head(bW.ToSeq(hI.nodes)))[1].top.to_crn();return ba.convert_state_space(hJ.to_ctmc(),function(hK){return cu.find(hK.name,hJ.attributes);});};ba.user_state_space_jit=function(hI){var hJ;hJ=bH.to_ctmc(hI.jit,hI.calculus);return ba.convert_state_space(hJ[0],hJ[1]);};ba.user_get_sim_runs=function(hI,hJ){var hK,hL,hM;hK=m.expandAndLift(hI.to_ig()).nodes.get_Item(hJ);hL=(hM=hK.systems,hM.$==1?hM.$0.settings:hK.top.settings);bX.iter(function(hN){if(!cw.Equals(hN.settings.simulator,hL.simulator))be.FailWith("Systems with different simulators are not supported");},hK.systems);return bE.New(ba.simulator_to_value_type(hL),ba.get_instances(hI,hJ));};ba.simulateFloat=function(hI,hJ,hK,hL,hM,hN){var hO,hP,hQ;function hR(hS){hM(bP.New("image/svg+xml","finals","Finals",{$:1,$0:hJ},hP===""?null:{$:1,$0:hP},{$:1,$0:[ba.pop_to_svg(hO,hS)]},null));}hO=ba.prepare_CRN_for_sim(hI,hJ,hK);hP=ba.make_instance_name(hK);hQ=hO.settings.simulator;hQ=="Oslo"?hO.to_oslo().simulate_callback(hN,hL,hR):hQ=="SSA"?hO.to_ssa().simulate_callback(hN,hL,hR,{$:1,$0:hB.Curried3(function(hS,hT,hU){return null;})}):hQ=="Sundials"?bX.iter(hL,O.to_rows(hO.to_sundials().simulate())):(function(hS){return function(hT){return hS("The "+cA.toSafe(hT)+" simulator cannot be used here");};}(be.FailWith))(U.get_to_string(hO.settings.simulator));};ba.simulateFloatJIT=function(hI,hJ,hK,hL,hM,hN,hO){var hP,hQ,hR,hS,hT,hU;bH.simulate_callback(hO,hK,hL,hJ.jit,hJ.calculus);hT=hI.top.to_crn();hU=bH.to_crn(hJ.jit,hT);hQ="";try{hQ=cB.to_string(cn.get_default_svg_style(),cn.initials_to_svg(hU));}catch(hV){hQ=hV.message;}hM(bP.New("image/svg+xml","finals","Finals",{$:1,$0:hI.top.name},null,{$:1,$0:[hQ]},null));hR="";try{hR=cB.to_string(cn.get_default_svg_style(),cn.reactions_to_svg(hU));}catch(hW){hR=hW.message;}hM(bP.New("image/svg+xml","reactions","Reactions",{$:1,$0:hI.top.name},null,{$:1,$0:[hR]},null));hS="";try{hS=hU.to_string();}catch(hX){hS=hX.message;}hM(bP.New("text/plain","code","Code",{$:1,$0:hI.top.name},null,{$:1,$0:[hS]},null));hN(r.New(null,bW.OfArray(ck.ofSeq(bX.ofArray([["",$.New(_.from_crn(cn.New(hU.name,hU.settings,hU.reactions,hT.initials,hU.attributes).saturate_initials()),bY.Empty)]]))),new cj.New([]),false));};ba.simulateMeanStdev=function(hI,hJ,hK,hL,hM,hN){var hO,hP;hO=ba.prepare_CRN_for_sim(hI,hJ,hK);hP=hO.settings.simulator;hP=="LNA"?hO.to_lna().simulate_callback(hN,hL):hP=="CME"?hO.simulate_cme_callback(hN,a.ignore,hL):hP=="MC"?be.FailWith("MC simulator cannot be invoked this way"):be.FailWith("simulator does not return mean+stdev");};ba.simulateMeanStdevProbabilities=function(hI,hJ,hK,hL,hM,hN,hO){var hP,hQ,hR,hS;function hT(hV){return cu.find(hV.name,hP.attributes);}function hU(hV){hL(ba.convert_state_space(hV,hT));}hP=ba.prepare_CRN_for_sim(hI,hJ,hK);hQ=(hR=hP.settings.simulator,hR=="CME"?hP.simulate_cme_callback(hO,hU,hM):hR=="CMESundials"?(hP.simulate_cmesundials_callback(hO,hU,hM))[0]:be.FailWith("simulator does not return mean+stdev and probabilities"));hS=new ct.New$5();ck.iter(function(hV){hS.Add(hV.species.name,hV.species);},hQ.simulator.populations.index_to_species);return hQ.probabilities;};ba.getProbabilityMap=function(hI,hJ,hK){var hL,hM;hL=bK.get_bounds(hI,hJ);hM=hL[2];return bO.New(cG.get_times(hI),bX.init(hL[1]-hM+1,function(hN){return hN+hM;}),bK.probability_map({$:1,$0:hK},hI,hJ));};ba.simulateSpatial1D=function(hI,hJ,hK,hL,hM,hN){var hO;hO=ba.prepare_CRN_for_sim(hI,hJ,hK);hO.settings.simulator=="PDE"?hO.settings.spatial.dimensions===1?cH.simulate_1d_callback(hN,hL,hO.to_pde1d()):be.FailWith("wrong number of dimensions"):be.FailWith("simulator does not return 1d spatial");};ba.simulateSpatial2D=function(hI,hJ,hK,hL,hM,hN){var hO;hO=ba.prepare_CRN_for_sim(hI,hJ,hK);hO.settings.simulator=="PDE"?hO.settings.spatial.dimensions===2?cH.simulate_2d_callback(hN,hL,hO.to_pde2d()):be.FailWith("wrong number of dimensions"):be.FailWith("simulator does not return 2d spatial");};ba.simulateMeanStdevTable=function(hI,hJ,hK,hL,hM,hN){var hO;hO=ba.prepare_CRN_for_sim(hI,hJ,hK);hO.settings.stochastic.trajectories>1?hO.to_ssa().simulate_trajectories_callback(hN,hL):be.FailWith("simulator does not return mean+stdev table");};ba.expression_to_string=function(hI){return br.to_string(a.id,hI);};ba.mcplot_to_string=function(hI){return K.to_string_monomial(hI);};ba.parse_code=function(hI){var hJ,hL,hM;function hK(hN){return cm.New(hN.top.initialise(),bX.map(function(hO){return hO.initialise();},hN.systems));}hL=cR.from_string_first_error_with_msg(m.parse(),hI);if(hL.$==1){hM=hL.$0;throw new dc.New(hM.text,[hM]);}else hJ=hL.$0;return cv.New(hJ.task,bW.Map(function(hN,hO){return hK(hO);},hJ.nodes),hJ.edges,hJ.expanded);};ba.model_to_export=function(hI,hJ,hK){var hL,hM,hN;hN=hJ.nodes.get_Item(hK).saturate_initials();try{hL=hI?null:{$:1,$0:cB.to_string(cn.get_default_svg_style(),cm.initials_to_svg(hN))};}catch(hO){hL={$:1,$0:hO.message};}try{hM=hI?{$:1,$0:cB.to_string(cn.get_default_svg_style(),cm.initials_to_svg(hN))}:{$:1,$0:""};}catch(hP){hM={$:1,$0:hP.message};}return[bP.New("text/plain","code","Code",{$:1,$0:hK},null,null,null),bP.New("text/plain","sbml","SBML",{$:1,$0:hK},null,null,null),bP.New("image/svg+xml","initials","Initials",{$:1,$0:hK},null,hL==null?null:{$:1,$0:[hL.$0]},null),bP.New("image/svg+xml","finals","Finals",{$:1,$0:hK},null,hM==null?null:{$:1,$0:[hM.$0]},null),bP.New("image/svg+xml","reactions","Reactions",{$:1,$0:hK},null,null,null),bP.New("text/plain","matlab","Matlab",{$:1,$0:hK},null,null,null)];};ba.model_to_single_export=function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ,hR,hS;hR=hI.nodes.get_Item(hJ).saturate_initials();if(hK==="code"){hL="";try{if(hJ==="")hL=cv.New(hI.task,bW.OfArray(ck.ofSeq(bX.ofArray([["",hR]]))),new cj.New([]),false).to_string();else hL=hR.string();}catch(hT){hL=hT.message;}return bP.New("text/plain",hK,"Code",{$:1,$0:hJ},null,{$:1,$0:[hL]},null);}else if(hK==="sbml"){hM="";try{hM=de.to_xml(hR.to_sbml());}catch(hU){hM=hU.message;}return bP.New("text/plain",hK,"SBML",{$:1,$0:hJ},null,{$:1,$0:[hM]},null);}else if(hK==="initials"){hN="";try{hN=cB.to_string(cn.get_default_svg_style(),cm.initials_to_svg(hR));}catch(hV){hN=hV.message;}return bP.New("image/svg+xml",hK,"Initials",{$:1,$0:hJ},null,{$:1,$0:[hN]},null);}else if(hK==="finals")return bP.New("image/svg+xml",hK,"Finals",{$:1,$0:hJ},null,{$:1,$0:["Finals not available for single export"]},null);else if(hK==="reactions"){hO=[];try{hO=ck.ofList(bX.map((hS=cn.get_default_svg_style(),function(hW){return cB.to_string(hS,hW);}),cm.reactions_to_svgs(hR)));}catch(hW){hO=[hW.message];}hP="";try{hP=cB.to_string(cn.get_default_svg_style(),cm.reactions_to_svg(hR));}catch(hX){hP=hX.message;}return bP.New("image/svg+xml",hK,"Reactions",{$:1,$0:hJ},null,{$:1,$0:hO},{$:1,$0:hP});}else if(hK==="matlab"){hQ="";try{hQ=hR.to_matlab();}catch(hY){hQ=hY.message;}return bP.New("text/plain",hK,"Matlab",{$:1,$0:hJ},null,{$:1,$0:[hQ]},null);}else return bP.New("text/plain",hK,hK,{$:1,$0:hJ},null,{$:1,$0:["Unknown export ID "+hK]},null);};ba.combine_dynchar_exports=function(hI){var hJ,hK;return hI.$==1&&(hI.$1.$==0&&(hJ=hI.$0[1],true))?bP.New("text/html","dynamicCharacterization","Dynamic Characterization",null,null,{$:1,$0:[dg.structured_tabbed_embedded("top_tabs",hJ)]},{$:1,$0:dg.structured_tabbed("","top_tabs",hJ)}):(hK=bX.ofSeq(bX.mapi(function(hL,hM){return[hM[0],dg.structured_tabbed_embedded((function(hN){return function(hO){return hN("group"+a.String(hO));};}(a.id))(hL),hM[1])];},hI)),bP.New("text/html","dynamicCharacterization","Dynamic Characterization",null,null,{$:1,$0:[dg.make_embedded(dg.arbitrary_tabbed_content("top_tabs",hK))]},{$:1,$0:dg.arbitrary_tabbed("Dynamic Characterisation",hK)}));};ba.convert_inference_result=function(hI,hJ,hK){var hL,hM,hN;function hO(hP){var hQ;hQ=new ct.New$5();ck.iter(function(hR){hQ.Add(hR,hP.Item(hR));},hP.get_Names());return hQ;}return bA.New(hI,hJ.iteration,hK,(hL=hJ.state,hL.$==1?(hM=hL.$0,{$:1,$0:bn.New(hO(hM.space),ba.convert_evaluated_values(hM.state),hM.thinningSkippedCount,bX.map(ba.convert_evaluated_values,hM.chain),ba.convert_evaluated_values(hM.mle),hM.priors,hM.indexes)}):(hN=hL.$0,{$:0,$0:bp.New(hO(hN.space),ba.convert_evaluated_values(hN.state),hN.stats,ba.convert_evaluated_values(hN.mle),hN.priors,hN.indexes)})),hK?{$:1,$0:hJ.mlesims}:null,hJ.summary);};ba.convert_state_space=function(hI,hJ){var hK,hL,hM,hN;function hO(hQ){var hR;hR=hJ(hQ);hM.push(hR);return hR.name;}function hP(hQ,hR){var hS;hS=hR[1];return function(hT){return bM.New(hT.species,ck.ofList(bX.map(function(hU){return bL.New(dA.find(hK,hU.target),br.to_string(a.id,hU.propensity));},hS)));};}hK=dA.empty();hL=ck.ofSeq(dA.toSeq(hI.ctmc.graph));hM=[];return bN.New((hN=ck.mapi(function(hQ,hR){var hS;hS=hR[0];dA.add(hK,hS,hQ);return bM.New(cu.of_list(bX.ofSeq(co.map(function(hT){return[hO(ck.get(hI.to_species,hT.K)),hT.V];},hS))),[]);},hL),(((hB.Curried3(ck.mapi2))(function(hQ,hR,hS){return(hP(hQ,hR))(hS);}))(hL))(hN)),dA.find(hK,hI.ctmc.initial_state),hM.slice());};ba.get_instances=function(hI,hJ){var hK;function hL(hM){return bX.map(function(hN){return by.create$5(hN.model,hN.sweep,hN.assignment,hN.environment,hN.settings.map(cL.to_string_plot),hN.name);},hM.get_instances());}hK=ba.prepare_Model(hI,hJ);return hK.systems.$==0?hL(hK.top):bX.collect(hL,hK.systems);};ba.simulator_to_value_type=function(hI){var hJ,hK,hL;hK=hI.simulator;switch(hK=="CME"?1:hK=="CMESundials"?1:hK=="Oslo"?2:hK=="SSA"?3:hK=="Sundials"?4:hK=="PDE"?5:hK=="MC"?6:0){case 0:return"MeanStdev";case 1:return"MeanStdevProbabilities";case 2:return"Float";case 3:return hI.stochastic.trajectories>1?"MeanStdevTable":"Float";case 4:return"Float";case 5:hL=hI.spatial.dimensions;return hL===1?"Spatial1D":hL===2?"Spatial2D":be.FailWith("unsupported number of dimensions");case 6:return"MeanStdev";}};ba.prepare_CRN_for_sim=function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ,hR;hL=ba.prepare_Model(hI,hJ);hM=(hN=hK.model,hN===""?hL.top:(hO=co.tryFind(function(hS){return hS.name===hN;},hL.systems),hO==null?hL.top:hO.$0));return cn.New(hM.name,hM.settings.update_simulation(hK.settings.map((hP=(hQ=(hR=hM.settings.rates,function(hS){return cn.species_to_rates(hR,hS);}),function(hS){return br.map(hQ,hS);}),function(hS){return hP(cL.from_string_plot(hS));}))),hM.reactions,hM.initials,hM.attributes).substitute(hK.environment);};ba.make_instance_name=function(hI){return hI.name!==""?hI.name:hI.sweep===""?hI.model:hI.model+"."+hI.sweep;};ba.pop_to_svg=function(hI,hJ){try{return cB.to_string(cn.get_default_svg_style(),cn.initials_to_svg(cn.New(hI.name,hI.settings,hI.reactions,bX.ofArray(ck.map(function(hK){return _8.create$1({$:1,$0:hK.value},hK.species,null);},hJ.index_to_species)),hI.attributes)));}catch(hK){return hK.message;}};ba.convert_evaluated_values=function(hI){var hJ,hK;return bj.New((hJ=hI.values,(hK=new ct.New$5(),(ck.iter(function(hL){hK.Add(hL,hJ.Item(hL));},hJ.get_Names()),hK))),hI.logLikelihood);};ba.prepare_Model=function(hI,hJ){return m.expandAndLift(hI.to_ig()).nodes.get_Item(hJ).merge_shared_settings();};bd.EncodeArray=hB.Curried3(function(hI,hJ,hK){return ck.map(hI(),hK);});bd.Id=hB.Curried3(function(hI,hJ,hK){return hK;});bd.DecodeRecord=function(hI,hJ){return function(){return function(hK){var hL;function hM(hN,hO,hP){if(hP===0){if(hK.hasOwnProperty(hN))hL[hN]=(hO(null))(hK[hN]);else be.FailWith("Missing mandatory field: "+hN);}else if(hP===1)hL[hN]=hK.hasOwnProperty(hN)?{$:1,$0:(hO(null))(hK[hN])}:null;else if(hP===2){if(hK.hasOwnProperty(hN))hL[hN]=(hO(null))(hK[hN]);}else if(hP===3){if(hK[hN]===void 0)hL[hN]=(hO(null))(hK[hN]);}else be.FailWith("Invalid field option kind");}hL=hI===void 0?{}:new hI();ck.iter(function(hN){return hM(hN[0],hN[1],hN[2]);},hJ);return hL;};};};bd.DecodeStringMap=hB.Curried3(function(hI,hJ,hK){var hL,hM,hN;hL=[new cj.New([])];hM=hI();for(var hO in hK)if(function(hP){var hQ;hL[0]=(hQ=hM(hK[hP]),hL[0].Add(hP,hQ));return false;}(hO))break;return hL[0];});bd.DecodeList=hB.Curried3(function(hI,hJ,hK){var hL;hL=hI();return bX.init(ck.length(hK),function(hM){return hL(ck.get(hK,hM));});});bd.EncodeRecord=function(hI,hJ){return function(){return function(hK){var hL;function hM(hN,hO,hP){var hQ;if(hP===0)hL[hN]=(hO(null))(hK[hN]);else if(hP===1){hQ=hK[hN];hQ==null?void 0:hL[hN]=(hO(null))(hQ.$0);}else if(hP===2){if(hK.hasOwnProperty(hN))hL[hN]=(hO(null))(hK[hN]);}else if(hP===3){if(hK[hN]===void 0)hL[hN]=(hO(null))(hK[hN]);}else be.FailWith("Invalid field option kind");}hL={};ck.iter(function(hN){return hM(hN[0],hN[1],hN[2]);},hJ);return hL;};};};bd.EncodeStringMap=hB.Curried3(function(hI,hJ,hK){var hL,hM;hL={};hM=hI();bW.Iterate(function(hN,hO){hL[hN]=hM(hO);},hK);return hL;});bd.EncodeList=hB.Curried3(function(hI,hJ,hK){var hL,hM;hL=[];hM=hI();bX.iter(function(hN){hL.push(hM(hN));},hK);return hL;});bd.EncodeStringDictionary=hB.Curried3(function(hI,hJ,hK){var hL,hM,hN,hO;hL={};hM=hI();hN=df.Get(hK);try{while(hN.MoveNext()){hO=be.KeyValue(hN.Current());hL[hO[0]]=hM(hO[1]);}}finally{if(typeof hN=="object"&&"Dispose"in hN)hN.Dispose();}return hL;});bd.DecodeArray=function(hI){return bd.EncodeArray(hI);};bd.DecodeStringDictionary=hB.Curried3(function(hI,hJ,hK){var hL,hM,hN;hL=new ct.New$5();hM=hI();for(var hO in hK)if(function(hP){hL.Add(hP,hM(hK[hP]));return false;}(hO))break;return hL;});bd.DecodeUnion=function(hI,hJ,hK){return function(){return function(hL){var hM,hN,hQ,hR,hS;function hO(hT,hU){return hT===hN;}function hP(hT,hU,hV,hW){var hX;if(hT===null){hX=(hV(null))(hL);hU?delete hX[hJ]:void 0;hQ.$0=hX;}else if(hW===0)hQ[hT]=(hV(null))(hL[hU]);else if(hW===1)hQ[hT]=hL.hasOwnProperty(hU)?{$:1,$0:(hV(null))(hL[hU])}:null;else be.FailWith("Invalid field option kind");}if(typeof hL==="object"&&hL!=null){hQ=hI===void 0?{}:new hI();if(cw.Equals(typeof hJ,"string"))hM=(hN=hL[hJ],ck.findIndex(function(hT){return hO(hT[0],hT[1]);},hK));else{hR=[void 0];for(var hT in hJ)if(function(hU){return hL.hasOwnProperty(hU)&&(hR[0]=hJ[hU],true);}(hT))break;hM=hR[0];}hQ.$=hM;ck.iter(function(hU){return hP(hU[0],hU[1],hU[2],hU[3]);},(ck.get(hK,hM))[1]);return hQ;}else return hL;};};};bd.DecodeTuple=function(hI){return bd.EncodeTuple(hI);};bd.EncodeTuple=hB.Curried3(function(hI,hJ,hK){return ck.map2(function(hL,hM){return(hL(null))(hM);},hI,hK);});bd.EncodeArrayMap=function(hI,hJ){return function(){return function(hK){var hL,hM,hN;hL=[];hM=hI();hN=hJ();bW.Iterate(function(hO,hP){var hQ;hQ=[[hM(hO),hN(hP)]],hL.push.apply(hL,hQ);},hK);return hL;};};};bd.EncodeSet=hB.Curried3(function(hI,hJ,hK){var hL,hM;hL=[];hM=hI();co.iter(function(hN){hL.push(hM(hN));},hK);return hL;});bd.DecodeArrayMap=function(hI,hJ){return function(){return function(hK){var hL,hM,hN,hO,hP,hQ;hM=hI();hN=hJ();hL=new cj.New(bY.Empty);for(hO=0,hP=hK.length-1;hO<=hP;hO++){hQ=ck.get(hK,hO);hL=hL.Add(hM(hQ[0]),hN(hQ[1]));}return hL;};};};bd.DecodeSet=hB.Curried3(function(hI,hJ,hK){return new cK.New$1(c6.OfSeq(ck.map(hI(),hK)));});bd.EncodeUnion=function(hI,hJ,hK){return function(){return function(hL){var hM,hN;function hO(hP,hQ,hR,hS){var hT,hU,hV;if(hP===null){hT=(hR(null))(hL.$0);for(var hW in hT)if(function(hX){hM[hX]=hT[hX];return false;}(hW))break;}else if(hS===0)hM[hQ]=(hR(null))(hL[hP]);else if(hS===1){hV=hL[hP];hV==null?void 0:hM[hQ]=(hR(null))(hV.$0);}else be.FailWith("Invalid field option kind");}return typeof hL==="object"&&hL!=null?(hM={},(hN=ck.get(hK,hL.$),(cw.Equals(typeof hJ,"string")?hM[hJ]=hN[0]:void 0,ck.iter(function(hP){return hO(hP[0],hP[1],hP[2],hP[3]);},hN[1]),hM))):hL;};};};be.FailWith=function(hI){throw new db(hI);};be.toInt=function(hI){var hJ;hJ=be.toUInt(hI);return hJ>=2147483648?hJ-4294967296:hJ;};be.range=function(hI,hJ){var hK;hK=1+hJ-hI;return hK<=0?[]:co.init(hK,function(hL){return hL+hI;});};be.KeyValue=function(hI){return[hI.K,hI.V];};be.toUInt=function(hI){return(hI<0?hC.ceil(hI):hC.floor(hI))>>>0;};be.step=function(hI,hJ,hK){var hL;hL=be.Sign(hJ);return co.takeWhile(function(hM){return hL*(hK-hM)>=0;},co.initInfinite(function(hM){return hI+hM*hJ;}));};be.InvalidArg=function(hI,hJ){throw new fY.New(hI,hJ);};be.Sign=function(hI){return hI===0?0:hI<0?-1:1;};bh.Fixed={$:2};bh.Log={$:1};bh.Real={$:0};bi.New=function(hI,hJ,hK){return{pType:hI,lb:hJ,ub:hK};};bj.New=function(hI,hJ){return{values:hI,lglk:hJ};};bk.New=function(hI,hJ,hK,hL,hM){return{mean:hI,stdev:hJ,lb:hK,ub:hL,denominator:hM};};bl.New=function(hI,hJ){return{mu:hI,sigma:hJ};};bm.New=function(hI,hJ){return{mean:hI,stdev:hJ};};bn.New=function(hI,hJ,hK,hL,hM,hN,hO){return{space:hI,state:hJ,thinningSkippedCount:hK,chain:hL,mle:hM,priors:hN,indexes:hO};};bo.New=function(hI,hJ){return{accepted:hI,altered:hJ};};bp.New=function(hI,hJ,hK,hL,hM,hN){return{space:hI,state:hJ,stats:hK,mle:hL,priors:hM,indexes:hN};};bq.inline_keys=function(hI,hJ,hK){var hL,hM;return hK.$==2?{$:0,$0:{$:0,$0:hK.$0}}:hK.$==3?{$:0,$0:es.Time}:hK.$==1?(hL=hK.$0,(hM=bW.TryFind(hL,hJ),hM!=null&&hM.$==1?hM.$0:be.FailWith("Rate "+hL+" is undefined."))):{$:1,$0:cY.find(hI,hK.$0)};};bq.inline_rates_env=function(hI,hJ){function hK(hL){var hM,hN;return hL.$==2?{$:0,$0:{$:0,$0:hL.$0}}:hL.$==3?{$:0,$0:es.Time}:hL.$==1?(hM=hL.$0,(hN=bW.TryFind(hM,hJ),hN!=null&&hN.$==1?br.expand(hK,hN.$0):be.FailWith("Rate "+hM+" is undefined."))):{$:1,$0:cY.find(hI,hL.$0)};}return bW.Map(function(hL,hM){return(function(){function hN(hO){return br.expand(hK,hO);}return function(hO){return br.simplify(hN(hO));};}(hL))(hM);},hJ);};bq.Time={$:3};bq.map=function(hI,hJ){return hJ.$==1?{$:1,$0:hJ.$0}:hJ.$==0?{$:0,$0:hJ.$0}:hJ.$==3?bq.Time:{$:2,$0:hI(hJ.$0)};};bq.to_string=function(hI,hJ){return hJ.$==1?"["+hJ.$0+"]":hJ.$==2?"["+hI(hJ.$0)+"]":hJ.$==3?"[time]":hJ.$0;};bq.collect=function(hI,hJ){return hJ.$==1?bX.ofArray([{$:1,$0:hJ.$0}]):hJ.$==0?bX.ofArray([{$:0,$0:hJ.$0}]):hJ.$==3?bX.ofArray([bq.Time]):bX.map(function(hK){return{$:2,$0:hK};},hI(hJ.$0));};bq.to_string_plot=function(hI,hJ){return hJ.$==2?hI(hJ.$0):bq.to_string(hI,hJ);};bq.scale=function(hI,hJ){return hJ.$==2?{$:3,$0:bw.New({$:0,$0:{$:2,$0:hJ.$0}},{$:1,$0:hI})}:{$:0,$0:hJ};};bq.eval_function=function(hI,hJ,hK){return br.to_lambda(br.simplify(br.expand(function(hL){return bq.inline_keys(hI,hJ,hL);},hK)));};bq.eval_massaction=function(hI,hJ){return br["eval"](function(hK){return cY.find(hI,hK);},hJ);};bq.to_matlab=function(hI,hJ,hK){return hK.$==1?hK.$0:hK.$==2?hI(hK.$0):hK.$==3?hJ:hK.$0;};bq.parse=function(hI){var hJ,hK,hL,hM,hN;function hO(hR){return{$:2,$0:hR};}function hP(hR,hS){return gz.op_DotGreaterGreater(cR.name(),cR.spaces(),hR,hS);}function hQ(hR){return{$:0,$0:hR};}hJ=cR.choice([(hK=cR.kw("[time]"),(hL=cR.preturn(bq.Time),function(hR){return gz.op_GreaterGreaterDot(hK,hL,hR[0],hR[1]);})),(hM=(hN=cR.sqBrackets(hI),function(hR){return gz.op_DotGreaterGreater(hN,cR.spaces(),hR[0],hR[1]);}),function(hR){return gz.op_BarGreaterGreater(hM,hO,hR[0],hR[1]);}),function(hR){return gz.op_BarGreaterGreater(function(hS){return hP(hS[0],hS[1]);},hQ,hR[0],hR[1]);}]);return function(hR){return hJ([hR[0],hR[1]]);};};bs.BFalse={$:1};bs.BTrue={$:0};bt.New=function(hI,hJ){return{div:hI,modulo:hJ};};bu.New=function(hI,hJ){return{sub1:hI,sub2:hJ};};bv.New=function(hI,hJ){return{base_:hI,exponent:hJ};};bw.New=function(hI,hJ){return{div1:hI,div2:hJ};};bx=d.Simulation_settings=hB.Class({map:function(hI){return bx.New(this.name,this.initial,this["final"],this.points,bX.map(hI,this.plots),this.plotcolours,this.seed,this.kinetics,this.times,this.prune,this.multicore,this.data,this.sweeps);},get_print_interval:function(){return this.points>0?(this["final"]-this.initial)/this.points:0;},to_string:function(hI){return this.to_string_defaults(bx.get_defaults(),hI);},collect_plots:function(hI){var hJ,hK,hL;hJ=this;hK=bX.unzip(bX.concat(bX.mapi(function(hM,hN){return bX.map(function(hO){return[hO,hJ.plotcolours.get_Length()>hM?hJ.plotcolours.get_Item(hM):""];},hI(hN));},this.plots)));hL=hK[1];return bx.New(this.name,this.initial,this["final"],this.points,hK[0],bX.exists(function(hM){return hM!=="";},hL)?hL:bY.Empty,this.seed,this.kinetics,this.times,this.prune,this.multicore,this.data,this.sweeps);},to_string_defaults:function(hI,hJ){return"{"+(this.initial===hI.initial?"":(function(hK){return function(hL){return hK("initial="+cA.toSafe(hL)+"; ");};}(a.id))(a.String(this.initial)))+(this["final"]===hI["final"]?"":(function(hK){return function(hL){return hK("final="+cA.toSafe(hL)+"; ");};}(a.id))(a.String(this["final"])))+(this.points===hI.points?"":(function(hK){return function(hL){return hK("points="+cA.toSafe(hL)+"; ");};}(a.id))(a.String(this.points)))+(cw.Equals(this.plots,hI.plots)?"":(function(hK){return function(hL){return hK("plots=["+cA.toSafe(hL)+"]; ");};}(a.id))(cS.concat("; ",bX.map(hJ,this.plots))))+(bX.exists(function(hK){return hK!=="";},this.plotcolours)?(function(hK){return function(hL){return hK("plotcolours=["+cA.toSafe(hL)+"]; ");};}(a.id))(cS.concat("; ",bX.map(function(hK){return"\\""+hK+"\\"";},this.plotcolours))):"")+(cw.Equals(this.seed,hI.seed)?"":(function(hK){return function(hL){return hK("seed="+a.String(hL));};}(a.id))(this.seed.$0))+(cw.Equals(this.kinetics,hI.kinetics)?"":(function(hK){return function(hL){return hK("kinetics="+cA.toSafe(hL)+"; ");};}(a.id))(bF.get_to_string(this.kinetics)))+(cw.Equals(this.times,hI.times)?"":(function(hK){return function(hL){return hK("times=["+cA.toSafe(hL)+"]; ");};}(a.id))(cS.concat("; ",bX.map(function(hK){var hL;hL=hK;return a.String(hL);},this.times))))+(cw.Equals(this.prune,hI.prune)?"":(function(hK){return function(hL){return hK("prune="+cA.toSafe(hL)+"; ");};}(a.id))(a.String(this.prune)))+(cw.Equals(this.multicore,hI.multicore)?"":(function(hK){return function(hL){return hK("multicore="+cA.toSafe(hL)+"; ");};}(a.id))(a.String(this.multicore)))+(cw.Equals(this.data,hI.data)?"":(function(hK){return function(hL){return hK("data=["+cA.toSafe(hL)+"]; ");};}(a.id))(cS.concat("; ",this.data)))+(cw.Equals(this.sweeps,hI.sweeps)?"":(function(hK){return function(hL){return hK("sweeps=["+cA.toSafe(hL)+"]; ");};}(a.id))(cS.concat("; ",this.sweeps)))+"}";},update_times:function(hI){return bx.New(this.name,this.initial,this["final"],this.points,this.plots,this.plotcolours,this.seed,this.kinetics,hI,this.prune,this.multicore,this.data,this.sweeps);},filter_data:function(hI){return this.data.$===0?hI:bX.map(function(hJ){try{return co.find(function(hK){return hK.file===hJ;},hI);}catch(hK){return be.FailWith("dataset "+hJ+" not found in settings");}},this.data);},filter_sweeps:function(hI){return this.sweeps.$===0?hI:bX.map(function(hJ){try{return co.find(function(hK){return hK.name===hJ;},hI);}catch(hK){return be.FailWith("sweep "+hJ+" not found in settings");}},this.sweeps);}},null,bx);bx.get_defaults=function(){return bx.New("",0,1000,1000,bY.Empty,bY.Empty,null,"Contextual",bY.Empty,true,false,bY.Empty,bY.Empty);};bx.parse_named=function(hI){return bx.parse_named_defaults(bx.get_defaults(),hI);};bx.parse=function(hI){return bx.parse_defaults(bx.get_defaults(),hI);};bx.parse_named_defaults=function(hI,hJ){return cR.op_BarGreaterGreater(cR.op_DotGreaterGreaterDot(cR.name(),cR.op_GreaterGreaterDot(cR.skw("="),bx.parse_defaults(hI,hJ))),function(hK){var hL;hL=hK[1];return bx.New(hK[0],hL.initial,hL["final"],hL.points,hL.plots,hL.plotcolours,hL.seed,hL.kinetics,hL.times,hL.prune,hL.multicore,hL.data,hL.sweeps);});};bx.parse_defaults=function(hI,hJ){return cR.record(hI,bX.ofArray([["initial",cR.op_BarGreaterGreater(cR.op_DotGreaterGreater(cR.pfloat(),cR.spaces()),function(hK){return function(hL){return bx.New(hL.name,hK,hL["final"],hL.points,hL.plots,hL.plotcolours,hL.seed,hL.kinetics,hL.times,hL.prune,hL.multicore,hL.data,hL.sweeps);};})],["final",cR.op_BarGreaterGreater(cR.op_DotGreaterGreater(cR.pfloat(),cR.spaces()),function(hK){return function(hL){return bx.New(hL.name,hL.initial,hK,hL.points,hL.plots,hL.plotcolours,hL.seed,hL.kinetics,hL.times,hL.prune,hL.multicore,hL.data,hL.sweeps);};})],["points",cR.op_BarGreaterGreater(cR.op_DotGreaterGreater(cR.pint32(),cR.spaces()),function(hK){return function(hL){return bx.New(hL.name,hL.initial,hL["final"],hK,hL.plots,hL.plotcolours,hL.seed,hL.kinetics,hL.times,hL.prune,hL.multicore,hL.data,hL.sweeps);};})],["plots",cR.op_BarGreaterGreater(cR.list_of(cR.op_DotGreaterGreater(hJ,cR.spaces())),function(hK){return function(hL){return bx.New(hL.name,hL.initial,hL["final"],hL.points,hK,hL.plotcolours,hL.seed,hL.kinetics,hL.times,hL.prune,hL.multicore,hL.data,hL.sweeps);};})],["plotcolours",cR.op_BarGreaterGreater(cR.list_of(cR.op_DotGreaterGreater(cR.pcolour(),cR.spaces())),function(hK){return function(hL){return bx.New(hL.name,hL.initial,hL["final"],hL.points,hL.plots,hK,hL.seed,hL.kinetics,hL.times,hL.prune,hL.multicore,hL.data,hL.sweeps);};})],["seed",cR.op_BarGreaterGreater(cR.op_DotGreaterGreater(cR.pint32(),cR.spaces()),function(hK){return function(hL){return bx.New(hL.name,hL.initial,hL["final"],hL.points,hL.plots,hL.plotcolours,{$:1,$0:hK},hL.kinetics,hL.times,hL.prune,hL.multicore,hL.data,hL.sweeps);};})],["kinetics",cR.op_BarGreaterGreater(cR.op_DotGreaterGreater(bF.get_parse(),cR.spaces()),function(hK){return function(hL){return bx.New(hL.name,hL.initial,hL["final"],hL.points,hL.plots,hL.plotcolours,hL.seed,hK,hL.times,hL.prune,hL.multicore,hL.data,hL.sweeps);};})],["prune",cR.op_BarGreaterGreater(cR.op_DotGreaterGreater(cR.pbool(),cR.spaces()),function(hK){return function(hL){return bx.New(hL.name,hL.initial,hL["final"],hL.points,hL.plots,hL.plotcolours,hL.seed,hL.kinetics,hL.times,hK,hL.multicore,hL.data,hL.sweeps);};})],["multicore",cR.op_BarGreaterGreater(cR.op_DotGreaterGreater(cR.pbool(),cR.spaces()),function(hK){return function(hL){return bx.New(hL.name,hL.initial,hL["final"],hL.points,hL.plots,hL.plotcolours,hL.seed,hL.kinetics,hL.times,hL.prune,hK,hL.data,hL.sweeps);};})],["data",cR.op_BarGreaterGreater(cR.list_of(cR.op_DotGreaterGreater(cR.name(),cR.spaces())),function(hK){return function(hL){return bx.New(hL.name,hL.initial,hL["final"],hL.points,hL.plots,hL.plotcolours,hL.seed,hL.kinetics,hL.times,hL.prune,hL.multicore,hK,hL.sweeps);};})],["sweeps",cR.op_BarGreaterGreater(cR.list_of(cR.op_DotGreaterGreater(cR.name(),cR.spaces())),function(hK){return function(hL){return bx.New(hL.name,hL.initial,hL["final"],hL.points,hL.plots,hL.plotcolours,hL.seed,hL.kinetics,hL.times,hL.prune,hL.multicore,hL.data,hK);};})]]));};bx.New=function(hI,hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU){return new bx({name:hI,initial:hJ,"final":hK,points:hL,plots:hM,plotcolours:hN,seed:hO,kinetics:hP,times:hQ,prune:hR,multicore:hS,data:hT,sweeps:hU});};by=d.Instance=hB.Class({update_environment:function(hI){return by.New(this.model,this.sweep,this.assignment,new cj.New(co.concat([bW.ToSeq(this.environment),bW.ToSeq(hI)])),this.settings,this.name);}},null,by);by.create$5=function(hI,hJ,hK,hL,hM,hN){return by.New(hI,hJ,hK,hL,hM,hN);};by.same_sweep=function(hI,hJ){return hI.model===hJ.model&&hI.sweep===hJ.sweep;};by.New=function(hI,hJ,hK,hL,hM,hN){return new by({model:hI,sweep:hJ,assignment:hK,environment:hL,settings:hM,name:hN});};bz.group_sweeps=function(hI){return bX.map(function(hJ){return bX.length(hJ)>1?bX.map(bz.append_sweepstr_columns,hJ):hJ;},function(hJ,hK){var hL,hM,hN;while(true)if(hK.$==1){hL=hK.$1;hM=hK.$0;hN=bX.partition(function(hO){return function(hP){return bz.same_sweep(hO,hP);};}(hM),hL);hJ=new bY({$:1,$0:new bY({$:1,$0:hM,$1:hN[0]}),$1:hJ});hK=hN[1];}else return bX.rev(hJ);}(bY.Empty,hI));};bz.append_sweepstr_columns=function(hI){var hJ;hJ=cY.to_string(hI.instance.environment);return bz.New(hI.instance,O.New(hI.table.times,bX.map(function(hK){return N.New((((hB.Curried3(function(hL,hM,hN){return hL(cA.toSafe(hM)+" ("+cA.toSafe(hN)+")");}))(a.id))(hK.name))(hJ),hK.values);},hI.table.columns)));};bz.same_sweep=function(hI,hJ){return by.same_sweep(hI.instance,hJ.instance);};bz.to_table=function(hI){return hI.table;};bz.create=function(hI,hJ){return bz.New(hI,hJ);};bz.New=function(hI,hJ){return{instance:hI,table:hJ};};bA.New=function(hI,hJ,hK,hL,hM,hN){return{nodeId:hI,iteration:hJ,lkincreased:hK,state:hL,mlesims:hM,summary:hN};};bB.New=function(hI,hJ,hK){return{pType:hI,lb:hJ,ub:hK};};bC.New=function(hI,hJ,hK){return{name:hI,range:hJ,initValue:hK};};bD.New=function(hI,hJ){return{nodeId:hI,parameters:hJ};};bE.New=function(hI,hJ){return{value_type:hI,instances:hJ};};bF.get_to_string=function(hI){return hI=="Stochastic"?"Stochastic":hI=="Deterministic"?"Deterministic":"Contextual";};bF.get_parse=function(){var hI,hJ,hK,hL;function hM(hP){return"Contextual";}function hN(hP){return"Stochastic";}function hO(hP){return"Deterministic";}hI=cR.choice([(hJ=cR.kw("Contextual"),function(hP){return gz.op_BarGreaterGreater(hJ,hM,hP[0],hP[1]);}),(hK=cR.kw("Stochastic"),function(hP){return gz.op_BarGreaterGreater(hK,hN,hP[0],hP[1]);}),(hL=cR.kw("Deterministic"),function(hP){return gz.op_BarGreaterGreater(hL,hO,hP[0],hP[1]);})]);return function(hP){return hI([hP[0],hP[1]]);};};bG.to_string=function(hI){return hI.name;};bG.get_from_string=function(){var hI;hI=bG.get_parse();return function(hJ){return cR.from_string(hI,hJ);};};bG.create=function(hI){return bG.New(hI);};bG.get_parse=function(){return cR.op_BarGreaterGreater(cR.name_kw(fV.kwList()),bG.create);};bG.New=function(hI){return{name:hI};};bI.New=function(hI,hJ,hK){return{name:hI,structural:hJ,svg:hK};};bJ.interpolate_float=function(hI,hJ,hK,hL,hM){return hL+(hM-hL)*(hI-hJ)/(hK-hJ);};bJ.interpolate_reverse=function(hI,hJ,hK){var hL;function hM(hN,hO,hP){return ck.map2(function(hQ,hR){return((hI(hN,hO.time,hP.time))(hQ))(hR);},hO.values,hP.values);}return hJ.$==1?(hL=hJ.$0,function(hN,hO,hP,hQ){var hR,hS,hT,hU,hV,hW,hX,hY;while(true)if(hQ.$==1){hR=hQ.$1;hS=hQ.$0;if(hS>hO.time){if(hP.$==1){hT=hP.$0;hU=hP.$1;if(hT.time<=hS){hV=new bY({$:1,$0:hS,$1:hR});hO=hT;hP=hU;hQ=hV;}else{hW=hM(hS,hO,hT);hX=new bY({$:1,$0:bJ.New(hS,hW),$1:hN});hN=hX;hQ=hR;}}else return hN;}else{hY=new bY({$:1,$0:hO,$1:hN});hN=hY;hQ=hR;}}else return hN;}(bY.Empty,hL,hJ.$1,function(hN,hO){var hP,hQ;while(true)if(hO.$==1){hP=hO.$0;hQ=hO.$1;if(hN.time<=hP)return hO;else hO=hQ;}else return bY.Empty;}(hL,hK))):bY.Empty;};bJ.zero_order_hold=function(hI,hJ,hK,hL,hM){return hL;};bJ.create=function(hI,hJ){return bJ.New(hI,ck.ofList(hJ));};bJ.New=function(hI,hJ){return{time:hI,values:hJ};};bK.get_bounds=function(hI,hJ){var hK,hL;hK=dD.find(hI.species,hJ);hL=ck.init(ck.length(hI.stoichiometry),function(hM){return ck.get(ck.get(hI.stoichiometry,hM),hK);});return[hL,be.toInt(ck.max(hL)),be.toInt(ck.min(hL))];};bK.probability_map=function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU;function hV(hY,hZ){return[hY,co.map(function(h0){return h0[0];},hZ)];}function hW(hY){return hS.times$2(hY);}function hX(hY){return hY<hU?0:hY;}hL=bK.get_bounds(hJ,hK);hM=hL[2];hN=hL[1];hO=hL[0];hP=bW.OfArray(ck.ofSeq(co.map(function(hY){return hV(hY[0],hY[1]);},co.groupBy(function(hY){return hY[1];},ck.mapi(function(hY,hZ){return[hY,be.toInt(hZ)];},hO)))));hQ=ck.length(hO);hR=ck.map(function(hY){var hZ,h0,h1;hZ=bW.TryFind(hY,hP);return hZ!=null&&hZ.$==1?(h0=hZ.$0,(h1=co.length(h0),[ck.create(h1,1),ck.ofSeq(h0),h1])):[[],[],0];},ck.ofSeq(be.range(hM,hN)));hS=new d4.New$1(hN-hM+1,hQ,ck.map(function(hY){return dZ.fst3(hY[0],hY[1],hY[2]);},hR),ck.map(function(hY){return dZ.snd3(hY[0],hY[1],hY[2]);},hR),ck.map(function(hY){return dZ.trd3(hY[0],hY[1],hY[2]);},hR));return bX.map((hT=hI==null?a.id:(hU=hI.$0,function(hY){return ck.map(hX,hY);}),function(hY){return hT(hW(hY));}),hJ.stateprobabilities);};bK.get_empty=function(){return bK.New(bY.Empty,bY.Empty,[],dD.empty());};bK.New=function(hI,hJ,hK,hL){return{times:hI,stateprobabilities:hJ,stoichiometry:hK,species:hL};};bL.New=function(hI,hJ){return{target:hI,propensity:hJ};};bM.New=function(hI,hJ){return{species:hI,transitions:hJ};};bN.New=function(hI,hJ,hK){return{states:hI,start_index:hJ,attributes:hK};};bO.New=function(hI,hJ,hK){return{times:hI,values:hJ,probabilities:hK};};bP.New=function(hI,hJ,hK,hL,hM,hN,hO){return{content_type:hI,id:hJ,display_name:hK,node_id:hL,instance:hM,content:hN,save_content:hO};};bQ.interpolate=function(hI,hJ,hK,hL,hM){return bQ.New(hL.mean+(hM.mean-hL.mean)*(hI-hJ)/(hK-hJ),hL.stdev+(hM.stdev-hL.stdev)*(hI-hJ)/(hK-hJ));};bQ.create=function(hI,hJ){return bQ.New(hI,hJ);};bQ.New=function(hI,hJ){return{mean:hI,stdev:hJ};};bS.New=function(hI,hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0,h1,h2,h3,h4,h5,h6,h7,h8,h9,h_,h$,ia,ib,ic,id){return{rules:hI,leaks:hJ,pin_leaks:hK,polymers:hL,unproductive:hM,sequence_rates:hN,temperature:hO,stabilityCorrection:hP,coaxialDangle:hQ,doubleCoaxialDangle:hR,terminalDangleFactor:hS,coaxialCorrection:hT,declare_domains:hU,check_dna:hV,colour_toeholds:hW,program:hX,toeholds:hY,specificities:hZ,plot_names:h0,state_images:h1,toehold_bind_rate:h2,toehold_unbind_rate:h3,leak_rate_l:h4,leak_rate_w:h5,pinleak_rate:h6,tau_rate:h7,elementary_migration_rate:h8,toehold_length:h9,specificity_length:h_,local_concentrations:h$,generate_predicates:ia,rendering:ib,is_jit:ic,rulesProgram:id};};bT.set_options=function(hI,hJ){var hK,hL;return hI.$==1?(hK=hI.$0,{$:1,$0:cJ.New(hK.settings,hK.initials,hK.reactions,hK.plotsCache,hJ,hK.rules)}):(hL=hI.$0,{$:0,$0:cI.New(hL.settings,hL.meta,hL.sreactions,hL.initials,hJ)});};bT.get_options=function(hI){return hI.$==1?hI.$0.dsdOptions:hI.$0.dsdOptions;};bT.convert_unexpanded=function(hI){var hJ,hK,hL,hM,hN,hO,hP,hQ,hR;return hI.$==1?(hJ=hI.$0,(hK=(hL=bT.createRulesEmptyCache(),bT.getRulesDSDNamer(hL[0],hL[1])),(hM=cM.dom_map(new ct.New$5(),bX.map(function(hS){return new cO({$:4,$0:hS.species});},hJ.initials)),cn.from_calculus_translated(function(hS){return bT.to_engine_species(hK,hS);},(hN=hJ.dsdOptions,function(hS){return bT.rulesRenderer(hN,hK,hM,hS);}),function(hS){return function(hT){return cw.Equals(hS,hT);};},function(hS){return function(hT){return cw.Equals(hS,hT);};},function(){return true;},"",hJ.settings,cP.New(function(){return function(){return bY.Empty;};}),hJ.initials,bY.Empty,bR.get_is_jit(hJ.dsdOptions),bR.get_is_jit(hJ.dsdOptions),false)))):(hO=hI.$0,(hP=bT.default_namer(hO.dsdOptions,hO.meta.info),cn.group_reactions(cn.from_calculus_translated(function(hS){return bT.to_engine_species(hP,hS);},bT.get_species_attributes(hP,hO),(hQ=hO.dsdOptions,(hB.Curried3(cN.equal))(hQ)),(hR=hO.dsdOptions,(hB.Curried3(cN.matches))(hR)),function(hS){return cN.free_names(hS).$==0;},"",hO.settings,cP.New(function(){return function(){return bY.Empty;};}),hO.initials,hO.sreactions,bR.get_is_jit(hO.dsdOptions),bR.get_is_jit(hO.dsdOptions),false)).initialise()));};bT.convert_expand=function(hI){var hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT;return hI.$==1?(hJ=hI.$0,(hK=(hL=bT.createRulesEmptyCache(),bT.getRulesDSDNamer(hL[0],hL[1])),(hM=bT.to_rules_calculus(hI),(hN=cM.dom_map(new ct.New$5(),bX.map(function(hU){return new cO({$:4,$0:hU.species});},hJ.initials)),cn.group_reactions(cn.from_calculus_translated(function(hU){return bT.to_engine_species(hK,hU);},(hO=hJ.dsdOptions,function(hU){return bT.rulesRenderer(hO,hK,hN,hU);}),function(hU){return function(hV){return cw.Equals(hU,hV);};},function(hU){return function(hV){return cw.Equals(hU,hV);};},function(){return true;},"",hJ.settings,hM,hJ.initials,bY.Empty,false,true,false)).initialise())))):(hP=hI.$0,(hQ=bT.default_namer(hP.dsdOptions,hP.meta.info),(hR=bT.makeDsdCalculus(hI),cn.group_reactions(cn.from_calculus_translated(function(hU){return bT.to_engine_species(hQ,hU);},bT.get_species_attributes(hQ,hP),(hS=hP.dsdOptions,(hB.Curried3(cN.equal))(hS)),(hT=hP.dsdOptions,(hB.Curried3(cN.matches))(hT)),function(hU){return cN.free_names(hU).$==0;},"",hP.settings,hR,hP.initials,hP.sreactions,false,true,false)).initialise())));};bT.to_jit=function(hI){var hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0,h1,h2,h3,h4;function h5(h_,h$){var ia;ia=bX.ofArray([new cW({$:0,$0:{$:8,$0:h_},$1:{$:8,$0:h$}})]);return!((cV.unify(bT.cle()))(ia).$==0);}function h6(h_){return bq.inline_keys(hX,hY,h_);}function h7(h_){return br.expand(h6,h_);}function h8(h_){return cY.find(hX,h_);}function h9(h_){return br.expand(h6,h_);}return hI.$==1?(hJ=hI.$0,(hK=bT.to_rules_calculus(hI),(hL=bT.getRulesDSDNamer(hJ.plotsCache,[hJ.plotsCache.count]),(hM=cM.dom_map(new ct.New$5(),bX.map(function(h_){return new cO({$:4,$0:h_.species});},hJ.initials)),{$:1,$0:bT.generic_to_jit(hK,function(h_){return function(h$){return cw.Equals(h_,h$);};},function(h_){return function(h$){return h5(h_,h$);};},hJ.initials,bY.Empty,hJ.settings,function(h_){var h$;h$=bT.rulesRenderer(hJ.dsdOptions,hL,hM,h_);return bI.New(h$.name,{$:1,$0:h$.structure},{$:1,$0:h$.svg});})})))):(hN=hI.$0,(hO=(hP=hN.dsdOptions,(hB.Curried3(cN.equal))(hP)),(hQ=bT.makeDsdCalculus(hI),(hR=bX.collect(function(h_){return Z.elements(h_.products);},hN.sreactions),(hS=co.fold(function(h_,h$){return bX.exists(hO(h$),h_)?h_:bX.append(h_,bX.ofArray([h$]));},bY.Empty,bX.rev(bX.append(bX.map(function(h_){return h_.species;},hN.initials),hR))),(hT=function(h_,h$,ia,ib){var ic,id,ie,_if,ig,ih;while(true){id=function(ii){return function(ij){var ik;return!(ik=co.tryFind(hO(ij),ii),ik!=null&&ik.$==1);};}(h$);if(h_.$==1){ie=h_.$1;_if=h_.$0;if(!id(_if)){h_=ie;h$=new bY({$:1,$0:_if,$1:h$});}else{ig=(hQ.react(h$))(_if);ih=(ic=(function(ii){return function(ij){return bX.collect(ii,ij);};}(function(ii){return Z.elements(ii.products);}))(ig),(function(ii){return function(ij){return bX.filter(ii,ij);};}(id))(ic));h_=ie;h$=new bY({$:1,$0:_if,$1:h$});ia=bX.append(ig,ia);ib=bX.append(ih,ib);}}else return[ia,bX.ofSeq(co.distinct(ib))];}}(hS,bY.Empty,bY.Empty,bY.Empty),(hU=bX.append(hN.sreactions,bX.filter(function(h_){return!bX.exists(function(h$){return cw.Equals(h_,h$);},hN.sreactions);},hT[0])),(hV={$:1,$0:0},(hW=bX.append(hN.initials,bX.map(function(h_){return _8.create$4(false,hV,h_,null,null);},bX.filter(function(h_){return!bX.exists(function(h$){return cw.Equals(h$.species,h_);},hN.initials);},bX.distinct(hT[1])))),(hX=cX.to_env(hN.settings.parameters),(hY=bq.inline_rates_env(hX,hN.settings.rates),(hZ=hN.settings.map_plots(h7,h7),(h0=bX.map((h1=function(h_){return br["eval"](h8,h_);},function(h_){return _2.map(a.id,h1,h9,h_);}),hU),(h2=bT.default_namer(hN.dsdOptions,hN.meta.info),{$:0,$0:bH.create(hZ.simulation,hZ.stochastic,hZ.rates,hZ.parameters,hS,hW,h0,function(h_){var h$;h$=(bT.get_species_attributes(h2,hN))(h_);return bI.New(h$.name,{$:1,$0:h$.structure},{$:1,$0:h$.svg});},(h3=hN.dsdOptions,(hB.Curried3(cN.equal))(h3)),(h4=hN.dsdOptions,(hB.Curried3(cN.matches))(h4)))}))))))))))))));};bT.makeDsdCalculus=function(hI){var hJ;return hI.$==1?be.FailWith("ClassicDSD/RulesDSD calculus integration not available yet."):(hJ=hI.$0,cP.New(function(hK){return function(hL){return(cZ.add_new_species_reactions(hJ.meta.subdomains,hJ.settings,hJ.dsdOptions,hJ.meta.meta,hL,hK,hJ.meta.info,bY.Empty,hJ.sreactions))[0];};}));};bT.to_rules_calculus=function(hI){var hJ,hK,hL,hM;hJ=hI.$==1?hI.$0:be.FailWith("Rules bundle expected");hK=(hL=["reaction",3],!hJ.rules.ContainsKey(hL)?bY.Empty:bX.ofSeq(bW.ToSeq((hM=new cK.New$1(c6.OfSeq(co.map(function(hN){var hO;hO=bX.head(hN.head.get_Args());return hO.$==4?[hO.$0.get_Length(),hN.head]:hO.$==0?[-1,hN.head]:be.FailWith("");},c5.Filter(function(hN){var hO;return hN.head.get_Name()==="reaction"&&(hO=bX.head(hN.head.get_Args()),hO.$==4||(hO.$==0||be.FailWith((function(hP){return function(hQ){return hP("The first argument of "+cA.toSafe(hQ)+" must be a list or a variable.");};}(a.id))(hN.head.get_String()))));},hJ.rules.get_Item(hL))))),co.fold(function(hN,hO){var hP,hQ;hP=hO[0];hQ=hO[1];return hN.ContainsKey(hP)?hN.Add(hP,new bY({$:1,$0:hQ,$1:hN.get_Item(hP)})):hN.Add(hP,bX.ofArray([hQ]));},new cj.New([]),hM)))));return cP.New(function(hN){return function(hO){function hP(hS){var hT;return hS<=0?bY.Empty:(hT=hP(hS-1),hT.$==0?bX.map(function(hU){return bX.ofArray([{$:8,$0:hU}]);},hN):bX.collect(function(hU){return bX.map(function(hV){return new bY({$:1,$0:{$:8,$0:hU},$1:hV});},hT);},hN));}function hQ(hS,hT){var hU;return hS===-1?bX.map(function(hV){return new cg({$:0,$0:hV.get_Name(),$1:new bY({$:1,$0:{$:8,$0:hO},$1:bX.tail(hV.get_Args())})});},hT):hS===0?hT:hS===1?bX.map(function(hV){return new cg({$:0,$0:hV.get_Name(),$1:new bY({$:1,$0:{$:4,$0:bX.ofArray([{$:8,$0:hO}])},$1:bX.tail(hV.get_Args())})});},hT):(hU=hP(hS-1),bX.collect(function(hV){return bX.map(function(hW){var hX;return new cg({$:0,$0:hV.get_Name(),$1:new bY({$:1,$0:{$:4,$0:(hX=c2.Flatten(bT["cle\'"](),{$:3,$0:"|",$1:new bY({$:1,$0:{$:8,$0:hO},$1:hW})}),hX==null?be.FailWith(""):bX.map(function(hY){return{$:8,$0:hY};},b5.toDsdComplexes(b$.Canonical(bT["cle\'"](),hX.$0))))},$1:bX.tail(hV.get_Args())})});},hU);},hT));}function hR(hS){return be.FailWith((function(hT){return function(hU){return hT("Unexpected term "+cA.toSafe(hU)+" found in reaction enumeration; expecting a process or a list of processes.");};}(a.id))(ca.ToStringWith(b5.engine(),hS)));}return bX.filter(function(hS){return!cw.Equals(hS.reactants,hS.products);},bX.distinct(bX.concat(bX.choose(function(hS){var hT;function hU(hW,hX){var hY,hZ,h0,h1,h2,h3,h4,h5,h6,h7;function h8(h$){var ia,ib;return bX.map(function(ic){return _0.New(ic[0],ic[1]);},bX.countBy(a.id,(ia=(ib=bT.cle(),(hB.Curried3(b$.Compare))(ib)),bX.sortWith(function(ic,id){return(ia(ic))(id);},h$))));}function h9(h$){function ia(ib){var ic;return ib.$==1?ib.$1.$==1?new cd({$:1,$0:ib.$0,$1:cb.NoTag}):ib:(ic=ib.$0,ic.tag.$===1?new cd({$:0,$0:cc.New(ic.name,ic.isComplementary,ic.isToehold,cb.NoTag)}):ib);}return b$.Map(function(ib){var ic;return ib.$==1?ib:(ic=ib.$0,ic.$==0?new cf({$:0,$0:new ce({$:0,$0:ia(ic.$0)})}):new cf({$:0,$0:new ce({$:1,$0:ia(ic.$0),$1:ic.$1})}));},h$);}function h_(h$){return h$.$0;}return hW.$==8?(hY=h9(hW.$0),h8(hX?(hZ=b5.toDsdComplexes(b$.Canonical(bT.cle(),hY)),bX.map((h0=bT.cle(),function(h$){return b$.Canonical(h0,h$);}),hZ)):bX.ofArray([hY]))):hW.$==4?(h1=hW.$0,hX?(h2=bX.map((h3=bT.cle(),function(h$){return c2.Flatten(h3,h$);}),h1),bX.exists(function(h$){return h$==null;},h2)?be.FailWith(""):(h4={$:8,$0:h9(b$.OfList(bX.concat(bX.map(function(h$){return b$.ToList(h_(h$));},h2))))},(h5=c2.Flatten(bT.cle(),h4),h5!=null&&h5.$==1?h8((h6=b5.toDsdComplexes(b$.Canonical(bT.cle(),h5.$0)),bX.map((h7=bT.cle(),function(h$){return b$.Canonical(h7,h$);}),h6))):hR(hW)))):h8(bX.map(function(h$){return h$.$==8?h9(h$.$0):be.FailWith("");},h1))):hR(hW);}function hV(hW){var hX;switch(hW.$==2?(hX=hW.$0,0):hW.$==1?(hX=hW.$0,1):hW.$==3?hW.$0==="*"?(hX=hW.$1,2):hW.$0==="+"?(hX=hW.$1,3):hW.$0==="-"?hW.$1.$==1?hW.$1.$1.$==1?hW.$1.$1.$1.$==0?(hX=[hW.$1.$0,hW.$1.$1.$0],4):(hX=hW.$0,7):(hX=hW.$0,7):(hX=hW.$0,7):hW.$0==="**"?hW.$1.$==1?hW.$1.$1.$==1?hW.$1.$1.$1.$==0?(hX=[hW.$1.$0,hW.$1.$1.$0],5):(hX=hW.$0,7):(hX=hW.$0,7):(hX=hW.$0,7):hW.$0==="/"?hW.$1.$==1?hW.$1.$1.$==1?hW.$1.$1.$1.$==0?(hX=[hW.$1.$0,hW.$1.$1.$0],6):(hX=hW.$0,7):(hX=hW.$0,7):(hX=hW.$0,7):(hX=hW.$0,7):hW.$==8?8:9){case 0:return{$:1,$0:hX};case 1:return{$:0,$0:hX};case 2:return{$:2,$0:bX.map(hV,hX)};case 3:return{$:5,$0:bX.map(hV,hX)};case 4:return{$:6,$0:bu.New(hV(hX[0]),hV(hX[1]))};case 5:return{$:4,$0:bv.New(hV(hX[0]),hV(hX[1]))};case 6:return{$:3,$0:bw.New(hV(hX[0]),hV(hX[1]))};case 7:return be.FailWith((function(hY){return function(hZ){return hY("Conversion to rate not support for operation \\""+cA.toSafe(hZ)+"\\"");};}(a.id))(hX));case 8:return be.FailWith(function(hY){return hY("Conversion to functional rates not support yet");}(a.id));case 9:return be.FailWith((function(hY){return function(hZ){return hY("Unexpected term \\""+cA.toSafe(hZ)+"\\"in rate conversion.");};}(a.id))(ca.ToStringWith(b5.engine(),hW)));}}hT=c0.resolveAll(hS,hJ.rules,bT.cle());return hT!=null&&hT.$==1?{$:1,$0:bX.map(function(hW){var hX,hY;hX=hW.Apply$1(hS,bT.cle());return hX.$==0&&(hX.$0.$0==="reaction"&&(hX.$0.$1.$==1&&(hX.$0.$1.$1.$==1&&(hX.$0.$1.$1.$1.$==1&&(hX.$0.$1.$1.$1.$1.$==0&&(hY=[hX.$0.$1.$0,hX.$0.$1.$1.$1.$0,hX.$0.$1.$1.$0],true))))))?_2.create$3(hU(hY[0],true),null,new _1({$:0,$0:hV(hY[2])}),hU(hY[1],true)):be.FailWith("");},hT.$0)}:null;},bX.map(function(hS){return new ch({$:0,$0:hS});},bX.collect(function(hS){return hQ(hS[0],hS[1]);},hK))))));};});};bT.is_jit=function(hI){return hI.$==1?bR.get_is_jit(hI.$0.dsdOptions):bR.get_is_jit(hI.$0.dsdOptions);};bT.parse_extended=function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0,h1,h2,h3,h4;function h5(ie){var _if,ig;_if=bT.resolvePlot(hT[0],hT[1],ie);return _if==null?(ig=bT.resolvePlotMissing(hR,ie),ig==null?null:{$:1,$0:cN.erasePos(cN["eval"](hQ,ig.$0))}):{$:1,$0:cN.erasePos(cN["eval"](hQ,_if.$0))};}function h6(ie){return bq.map(h5,ie);}function h7(ie){return ie==null?be.FailWith("Unexpected null plot"):ie.$0;}function h8(ie){return ie[1];}function h9(ie){function _if(ig,ih){return cw.Equals(ig.rate,ih.rate);}return co.forall(function(ig){return _if(ig[0],ig[1]);},co.pairwise(ie))?co.head(ie):be.FailWith("Multiple rate definitons for same rxn reaction");}function h_(ie,_if){return _8.create$4(ie.constant,ie.value,ie.species,_if,ie.spatial_initial);}function h$(ie){var _if,ig,ih,ii,ij;function ik(_in){return new cd({$:0,$0:_in});}function il(_in){return new ce({$:0,$0:_in});}function im(_in){return new cf({$:0,$0:_in});}_if=ie.$==1?bT.toLogicProcess(bT.flattenGate(ie.$0)):ie.$==2?be.FailWith("Origami\'s are not supported in Logic DSD yet."):ie.$==3?be.FailWith((function(_in){return function(io){return _in("Unknown species "+cA.toSafe(io));};}(a.id))(ie.$0)):ie.$==4?ie.$0:(ig=ie.$0,ig.$==1?b$.OfList(bX.ofArray([(ih=(ii=(ij=function(_in){return ik(bT.toLogicDomain(_in));},function(_in){return il(ij(_in));}),function(_in){return im(ii(_in));}),function(_in){return bX.map(ih,_in);})(bX.rev(ig.$0))])):b$.OfList(bX.ofArray([(ih=(ii=(ij=function(_in){return ik(bT.toLogicDomain(_in));},function(_in){return il(ij(_in));}),function(_in){return im(ii(_in));}),function(_in){return bX.map(ih,_in);})(ig.$0)])));return b$.Canonical(bT.cle(),_if);}function ia(ie){return bq.map(h$,ie);}function ib(ie,_if){return[h$(ea.to_species(-1,-1,cR.from_string((ea.parse_molecule_dots())(false),ie))),_if];}function ic(ie,_if){return _8.create$4(ie[1],br.simplify({$:5,$0:bX.map(function(ig){return ig.value;},_if)}),ie[0],ie[3],ie[2]);}function id(ie){return bq.map(h$,ie);}hL=cR.from_string(ea.parser(),hK);hM=hL[0][1];hN=hL[0][3];hO=bR.setSpecificitiesText(hJ,bR.setToeholdsText(hI,hL[0][2]));hP=cU.expand(hO,ec.bindings_to_env(bX.map(function(ie){return[ie.name,ie.value];},hM.parameters)),bY.Empty,hL[1]);hQ=hP[4];hR=hP[3];hS=eb.eval_to_species(hO,[hP[1],hP[0]],hR,hQ,hP[2]);hT=hS[1];hU=cN.env_to_species(hT);cN.check(bX.map(function(ie){return ie[0].species;},hU));hV=hM.map(function(ie){return br.map(h6,ie);}).collect_plots(function(ie){return bX.exists(function(_if){return _if.$==2&&_if.$0==null;},br.mentions(ie))?bY.Empty:bX.ofArray([ie]);}).map((hW=function(ie){return bq.map(h7,ie);},function(ie){return br.map(hW,ie);}));hX=bX.ofSeq(co.map(function(ie){return h9(h8(ie));},co.groupBy(function(ie){return[ie.reactants,ie.products];},_2.normalise_list(hS[2]))));hY=bX.map(function(ie){return h_(ie[0],ie[1]);},hU);hZ={$:1,$0:0};h0=bX.append(hY,bX.map(function(ie){return _8.create$4(false,hZ,ie,null,null);},bX.ofSeq(co.distinct(bX.filter(function(ie){function _if(ig,ih){return ig.species;}return!bX.contains(ie,bX.map(function(ig){return _if(ig[0],ig[1]);},hU));},bX.collect(function(ie){return ie.get_allSpecies();},hX))))));h1=bT.build_meta(hO,hT[0],hT[1],hQ,hP[5],bX.map(function(ie){return ie.species;},h0));return[hN!=null&&hN.$==1?(h2=hV.map(function(ie){return br.map(ia,ie);}),(h3=new ct.New$1(bW.OfArray(ck.ofSeq(bX.map(function(ie){return ib(ie[0],ie[1]);},bX.ofSeq(bW.ToSeq(h1.info[1].$0)))))),{$:1,$0:cJ.New(h2,bX.map(function(ie){return ic(ie[0],ie[1]);},bX.groupBy(function(ie){return[ie.species,ie.constant,ie.spatial,ie.time];},bX.map(function(ie){return _8.mapSpecies(h$,ie);},h0))),bX.map((h4=function(ie){return br.map(id,ie);},function(ie){return _2.map(h$,a.id,h4,ie);}),hX),h3,hO,new ct.New$1(hN.$0))})):{$:0,$0:cI.New(hV,h1,hX,h0,hO)},hL[0][0]];};bT.createRulesEmptyCache=function(){return[new ct.New$5(),[0]];};bT.getRulesDSDNamer=function(hI,hJ){return function(hK){var hL,hM;return hI.ContainsKey(hK)?hI.get_Item(hK):(hL=hJ[0],(hJ[0]=hL+1,hM=(function(hN){return function(hO){return hN("sp_"+a.String(hO));};}(a.id))(hL),hI.Add(hK,hM),hM));};};bT.rulesRenderer=function(hI,hJ,hK,hL){var hM,hN,hO,hP;hM=(hN=hI.rendering.renderer,(hN=="No_predicates"?false:hN!="Branches")?ee.species_to_svg_circles(cM.species_style(hK,bX.ofArray([new cO({$:4,$0:hL})])),new cO({$:4,$0:hL})):(hP=cM.species_style(hK,bX.ofArray([new cO({$:4,$0:hL})])),cM.species_to_svg_branches(hI.rendering.arrange,hI.rendering.mode,ef.empty(),hI.rendering.rotate_labels,hP,new cO({$:4,$0:hL}))));return _9.New(hJ(hL),ca.ToStringWith(b5.engine(),{$:8,$0:hL}),hM);};bT.to_engine_species=function(hI,hJ){return bG.create(hI(hJ));};bT.default_namer=function(hI,hJ){var hK,hL;hK=new ct.New$5();hL=new ek.New$3();return function(hM){var hN,hO,hP,hQ;if(hK.ContainsKey(hM))return hK.get_Item(hM);else{hQ=cN.try_find_name(hI,hJ,true,hM);if(hQ==null){if(hM.$==3)hN=hM.$0;else{hO="";hP=hL.get_Count()+1;while(hO==="")if(!hL.Contains("sp"+a.String(hP)))hO="sp"+a.String(hP);else hP=hP+1;hN=hO;}}else hN=hQ.$0;hK.Add(hM,hN);hL.Add(hN);return hN;}};};bT.get_species_attributes=function(hI,hJ){var hK;function hL(hM){var hN;hN=hK.renderer;return hN=="Circles"?ee.species_to_svg_circles(cM.species_style(hJ.meta.domain_colours,bX.map(function(hO){return hO.species;},hJ.initials)),hM):hN=="No_predicates"?cB.to_string_normalise(!cw.Equals(hK.mode,"Nucleotides"),ep.species_style(hJ.meta.domain_colours,bX.map(function(hO){return hO.species;},hJ.initials)),ep.species_to_svg_mode(hK.mode,hJ.meta.meta,hM)):cM.species_to_svg_branches(hK.arrange,hK.mode,hJ.meta.meta,hK.rotate_labels,cM.species_style(hJ.meta.domain_colours,bX.map(function(hO){return hO.species;},hJ.initials)),hM);}hK=bR.getRendering(hJ.dsdOptions);return function(hM){return _9.New(hI(hM),cN.display(hM),hL(hM));};};bT.generic_to_jit=function(hI,hJ,hK,hL,hM,hN,hO){var hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY;function hZ(h3){return bq.inline_keys(hV,hW,h3);}function h0(h3){return br.expand(hZ,h3);}function h1(h3){return cY.find(hV,h3);}function h2(h3){return br.expand(hZ,h3);}hP=bX.collect(function(h3){return Z.elements(h3.products);},hM);hQ=co.fold(function(h3,h4){return bX.exists(hJ(h4),h3)?h3:bX.append(h3,bX.ofArray([h4]));},bY.Empty,bX.rev(bX.append(bX.map(function(h3){return h3.species;},hL),hP)));hR=function(h3,h4,h5,h6){var h7,h8,h9,h_,h$,ia;while(true){h8=function(ib){return function(ic){var id;return!(id=co.tryFind(hJ(ic),ib),id!=null&&id.$==1);};}(h4);if(h3.$==1){h9=h3.$1;h_=h3.$0;if(!h8(h_)){h3=h9;h4=new bY({$:1,$0:h_,$1:h4});}else{h$=(hI.react(h4))(h_);ia=(h7=(function(ib){return function(ic){return bX.collect(ib,ic);};}(function(ib){return Z.elements(ib.products);}))(h$),(function(ib){return function(ic){return bX.filter(ib,ic);};}(h8))(h7));h3=h9;h4=new bY({$:1,$0:h_,$1:h4});h5=bX.append(h$,h5);h6=bX.append(ia,h6);}}else return[h5,bX.ofSeq(co.distinct(h6))];}}(hQ,bY.Empty,bY.Empty,bY.Empty);hS=bX.append(hM,bX.filter(function(h3){return!bX.exists(function(h4){return cw.Equals(h3,h4);},hM);},hR[0]));hT={$:1,$0:0};hU=bX.append(hL,bX.map(function(h3){return _8.create$4(false,hT,h3,null,null);},bX.filter(function(h3){return!bX.exists(function(h4){return cw.Equals(h4.species,h3);},hL);},bX.distinct(hR[1]))));hV=cX.to_env(hN.parameters);hW=bq.inline_rates_env(hV,hN.rates);hX=hN.map_plots(h0,h0);return bH.create(hX.simulation,hX.stochastic,hX.rates,hX.parameters,hQ,hU,bX.map((hY=function(h3){return br["eval"](h1,h3);},function(h3){return _2.map(a.id,hY,h2,h3);}),hS),hO,hJ,hK);};bT.cle=function(){er.$cctor();return er.cle;};bT["cle\'"]=function(){er.$cctor();return er["cle\'"];};bT.build_meta=function(hI,hJ,hK,hL,hM,hN){var hO,hP,hQ;function hR(hS,hT){return co.pick(function(hU){var hV;return hU.$==1?(hV=hU.$1,hU.$0===hS?hT?{$:1,$0:{$:0,$0:hV,$1:{$:6,$0:1,$1:ec.emprange()},$2:false,$3:null}}:{$:1,$0:{$:1,$0:hV,$1:false,$2:null}}:null):null;},hL);}hO=dD.empty();hP=dD.empty();bX.iter(function(hS){var hT,hU;hT=hS.dom_colour;hT==null?void 0:dD.add(hP,hS.domain,hT.$0);hU=hS.subdomains;hU==null?void 0:dD.add(hO,hU.$0[0],hR(hS.domain,hU.$0[1]));},hM);hQ=bX.collect(cN.domains,hN);return cQ.New(ef.add_domains(ef.initialise_mapping(hI),hQ),[hJ,hK],hP,hO);};bT.toLogicProcess=function(hI){var hJ,hK,hL,hM,hN,hO;function hP(hV){return new cd({$:0,$0:hV});}function hQ(hV){return new ce({$:0,$0:hV});}function hR(hV){return new cf({$:0,$0:hV});}function hS(hV){var hW;function hX(hY,hZ){return function(h0){var h1,h2,h3,h4,h5;h1=bT.toLogicDomain(h0);h2=bT.logicComplement(h1);h3=new b6({$:0,$0:hJ[0]});hJ[0]=hJ[0]+1;h4=new cf({$:0,$0:new ce({$:1,$0:new cd({$:0,$0:h1}),$1:h3})});h5=new cf({$:0,$0:new ce({$:1,$0:new cd({$:0,$0:h2}),$1:h3})});return[new bY({$:1,$0:h4,$1:hY}),new bY({$:1,$0:h5,$1:hZ})];};}hW=co.fold(function(hY,hZ){return(function(h0){return hX(h0[0],h0[1]);}(hY))(hZ);},[bY.Empty,bY.Empty],hV);return[bX.rev(hW[0]),hW[1]];}function hT(hV){var hW,hX,hY,hZ,h0,h1,h2,h3,h4,h5,h6,h7;return hV.$==1?hV.$0[4].$==0?(hW=hK(hV.$0[0]),(hX=hK(hV.$0[1]),(hY=hS(hV.$0[2]),(hZ=hK(hV.$0[3]),{$:0,$0:bX.append(bX.rev(hW),bX.append(hY[1],bX.append(bX.rev(hZ),bX.append(hY[0],hX))))})))):(h0=hK(hV.$0[0]),(h1=hK(hV.$0[1]),(h2=hS(hV.$0[2]),{$:0,$0:bX.append(h1,bX.append(h2[0],bX.append(bX.rev(hK(hV.$0[3])),bX.append(h2[1],bX.rev(h0)))))}))):(h3=hK(bX.rev(hV.$0[0])),(h4=hK(hV.$0[1]),(h5=hS(hV.$0[2]),(h6=hK(hV.$0[3]),(h7=hK(bX.rev(hV.$0[4])),{$:1,$0:bX.append(h4,bX.append(h5[0],h6)),$1:bX.append(h7,bX.append(h5[1],h3))})))));}function hU(hV){var hW,hX,hY,hZ,h0,h1,h2,h3,h4,h5,h6,h7,h8,h9,h_,h$,ia,ib;return hV.$==0?(hW=hV.$0,(hX=hU(hV.$1),(hY=hX[0],(hZ=hX[1],hY.$==1?(h0=hY.$0,(h1=hZ.Add(hY.$1),(h2=hT(hW),h2.$==1?[{$:1,$0:bX.append(h2.$0,h0),$1:h2.$1},h1]:[{$:0,$0:bX.append(h2.$0,h0)},h1]))):(h3=hY.$0,(h4=hT(hW),h4.$==1?[{$:1,$0:bX.append(h4.$0,h3),$1:h4.$1},hZ]:[{$:0,$0:bX.append(h4.$0,h3)},hZ])))))):hV.$==1?(h5=hV.$0,(h6=hU(hV.$1),(h7=h6[0],(h8=h6[1],h7.$==1?(h9=h7.$1,(h_=h8.Add(h7.$0),(h$=hT(h5),h$.$==1?[{$:1,$0:h$.$0,$1:bX.append(h9,h$.$1)},h_]:[{$:0,$0:bX.append(h9,h$.$0)},h_]))):(ia=h7.$0,(ib=hT(h5),ib.$==1?[{$:1,$0:ib.$0,$1:bX.append(ia,ib.$1)},h8]:[{$:0,$0:bX.append(ia,ib.$0)},h8])))))):[hT(hV.$0),new cK.New$1(null)];}hJ=[0];hK=(hL=(hM=(hN=function(hV){return hP(bT.toLogicDomain(hV));},function(hV){return hQ(hN(hV));}),function(hV){return hR(hM(hV));}),function(hV){return bX.map(hL,hV);});hO=hU(hI);return hO[0].$==1?b$.OfList(bX.ofSeq(hO[1].Add(hO[0].$0).Add(hO[0].$1))):b$.OfList(bX.ofSeq(hO[1].Add(hO[0].$0)));};bT.flattenGate=function(hI){function hJ(hK){var hL;switch(hK.$==1?hK.$0.$==1?hK.$0.$1.$==0?hK.$1.$==0?(hL=hK.$0.$0,1):(hL=[hK.$1,hK.$0.$0],3):hK.$1.$==0?(hL=[hK.$0.$1,hK.$0.$0],2):(hL=[hK.$0.$1,hK.$1,hK.$0.$0],4):0:0){case 0:return be.FailWith("Unexpected empty strand in Classic to Logic DSD translation.");case 1:return{$:2,$0:hL};case 2:return{$:1,$0:hL[1],$1:hJ(bX.ofArray([hL[0]]))};case 3:return{$:0,$0:hL[1],$1:hJ(hL[0])};case 4:return{$:1,$0:hL[2],$1:hJ(new bY({$:1,$0:hL[0],$1:hL[1]}))};}}return hJ(hI);};bT.toLogicDomain=function(hI){var hJ,hL,hM,hN,hO;function hK(hP,hQ){return hQ<=0?hP:(((hB.Curried3(function(hR,hS,hT){return hR("_"+cA.toSafe(hS)+"_"+a.String(hT));}))(a.id))(hP))(hQ);}switch(hI.$==0?hI.$0.$==7?(hJ=[hI.$2,hI.$1,hI.$0.$0],2):hI.$0.$==3?(hJ=[hI.$2,hI.$1,hI.$0.$1,hI.$0.$0],3):hI.$0.$==2?(hJ=[hI.$2,hI.$1,hI.$0.$1,hI.$0.$0],3):4:hI.$0.$==3?(hJ=[hI.$1,hI.$0.$1,hI.$0.$0],0):hI.$0.$==2?(hJ=[hI.$1,hI.$0.$1,hI.$0.$0],0):hI.$0.$==7?(hJ=[hI.$1,hI.$0.$0],1):4){case 0:return cc.New(hK(hJ[2],hJ[1]),hJ[0],false,cb.NoTag);case 1:return cc.New(hJ[1],hJ[0],false,cb.NoTag);case 2:hL=hJ[1];return cc.New(hJ[2],hJ[0],true,hL.$==6?(hM=hL.$0,hM!==1?{$:2,$0:{$:3,$0:"complementarity",$1:bX.ofArray([{$:2,$0:hM}])}}:cb.NoTag):hL.$==7?{$:2,$0:{$:3,$0:"complementarity",$1:bX.ofArray([{$:1,$0:hL.$0}])}}:cb.NoTag);case 3:hN=hJ[1];return cc.New(hK(hJ[3],hJ[2]),hJ[0],true,hN.$==6?(hO=hN.$0,hO!==1?{$:2,$0:{$:3,$0:"complementarity",$1:bX.ofArray([{$:2,$0:hO}])}}:cb.NoTag):hN.$==7?{$:2,$0:{$:3,$0:"complementarity",$1:bX.ofArray([{$:1,$0:hN.$0}])}}:cb.NoTag);case 4:return be.FailWith("Conversion failed.");}};bT.resolvePlot=function(hI,hJ,hK){var hL,hM,hN,hO;hL=[hI,hJ];return hK.$==1?{$:1,$0:hK.$0}:hK.$==2?(hM=hK.$0,(hN=cu.tryFind(hM,hL[0]),hN==null?null:(hO=bX.ofSeq(co.filter(function(hP){var hQ;hQ=hL[1].$0;return cu.find(cN.display(hP),hQ)===hM;},co.distinct(bX.map(function(hP){return a.id(hP[0],hP[1],hP[2],hP[3],hP[4],hP[5]);},hN.$0)))),hO.$==0?null:hO.$1.$==0?{$:1,$0:hO.$0}:be.FailWith("Module \\""+hM+"\\" produces two or more species, but only one species can be plotted")))):be.FailWith("Unexpected plot "+hK.$0);};bT.resolvePlotMissing=function(hI,hJ){var hK;return hJ.$==1?{$:1,$0:hJ.$0}:hJ.$==2?(hK=hJ.$0,co.tryPick(function(hL){var hM,hN;hN=hL.$3;if(hL.$0===hK)switch(hN.$==2?1:hN.$==3?2:hN.$==8?3:hN.$==0?4:hN.$==4?4:hN.$==5?4:hN.$==6?4:hN.$==7?4:0){case 0:return{$:1,$0:new cO({$:0,$0:hN.$0})};case 1:return{$:1,$0:new cO({$:1,$0:hN.$0})};case 2:return be.FailWith("Cannot plot uninstantiated origami module "+hK);case 3:return{$:1,$0:new cO({$:4,$0:hN.$0})};case 4:return null;}else return null;},hI)):be.FailWith("Unexpected plot "+hJ.$0);};bT.logicComplement=function(hI){return cc.New(hI.name,!hI.isComplementary,hI.isToehold,hI.tag);};bU.$cctor=function(){bU.$cctor=a.ignore;bU.parser=hB.Curried3(bT.parse_extended);};bR.set_rules_program=function(hI,hJ){return bS.New(hJ.rules,hJ.leaks,hJ.pin_leaks,hJ.polymers,hJ.unproductive,hJ.sequence_rates,hJ.temperature,hJ.stabilityCorrection,hJ.coaxialDangle,hJ.doubleCoaxialDangle,hJ.terminalDangleFactor,hJ.coaxialCorrection,hJ.declare_domains,hJ.check_dna,hJ.colour_toeholds,hJ.program,hJ.toeholds,hJ.specificities,hJ.plot_names,hJ.state_images,hJ.toehold_bind_rate,hJ.toehold_unbind_rate,hJ.leak_rate_l,hJ.leak_rate_w,hJ.pinleak_rate,hJ.tau_rate,hJ.elementary_migration_rate,hJ.toehold_length,hJ.specificity_length,hJ.local_concentrations,hJ.generate_predicates,hJ.rendering,hJ.is_jit,hI);};bR.get_is_jit=function(hI){return hI.is_jit;};bR.display=function(hI){var hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX;hJ=hI.toehold_unbind_rate;hK=hI.toehold_length;hL=hI.toehold_bind_rate;hM=hI.tau_rate;hN=hI.specificity_length;hO=hI.rules;hP=hI.rendering;hQ=hI.pinleak_rate;hR=hI.local_concentrations;hS=hI.leak_rate_l;hT=hI.generate_predicates;hU=hI.elementary_migration_rate;hV=hQ!=null&&hQ.$==1?{$:1,$0:"directive pinleak "+br.to_string(a.id,hQ.$0)}:null;hW=[bR.default_options().toehold_length,bR.default_options().specificity_length];hX=bX.choose(a.id,bX.ofArray([cw.Equals(hO,bR.default_options().rules)?null:{$:1,$0:hO=="Finite"?"directive compilation finite":hO=="Detailed"?"directive compilation detailed":hO=="Default"?"directive compilation defaul":"directive compilation infinite"},cw.Equals(hI.leaks,bR.default_options().leaks)?null:{$:1,$0:"directive leaks"},cw.Equals(hI.pin_leaks,bR.default_options().pin_leaks)?null:{$:1,$0:"directive pinleaks"},cw.Equals(hI.polymers,bR.default_options().polymers)?null:{$:1,$0:"directive polymers"},cw.Equals(hI.unproductive,bR.default_options().unproductive)?null:{$:1,$0:"directive unproductive"},cw.Equals(hI.sequence_rates,bR.default_options().sequence_rates)?null:{$:1,$0:"directive sequenceRates"},cw.Equals(hI.declare_domains,bR.default_options().declare_domains)?null:{$:1,$0:"directive declare"},hL===bR.default_options().toehold_bind_rate||hJ===bR.default_options().toehold_unbind_rate?null:{$:1,$0:"directive toeholds "+a.String(hL)+" "+a.String(hJ)},cw.Equals(hS,bR.default_options().leak_rate_l)?null:{$:1,$0:"directive leak "+br.to_string(a.id,hS)},cw.Equals(hQ,bR.default_options().pinleak_rate)?null:hV,cw.Equals(hM,bR.default_options().tau_rate)?null:{$:1,$0:"directive tau "+br.to_string(a.id,hM)},cw.Equals(hU,bR.default_options().elementary_migration_rate)?null:{$:1,$0:"directive migrate "+br.to_string(a.id,hU)},cw.Equals([hK,hN],hW)?null:{$:1,$0:"directive lengths "+a.String(hK)+" "+a.String(hN)},cw.Equals(hR,bR.default_options().local_concentrations)?null:{$:1,$0:"directive localconcentrations ["+cS.concat("; ",bX.map(function(hY){return"("+hY[0]+", "+br.to_string(a.id,hY[1])+")";},hR))+"]"},cw.Equals(hT,bR.default_options().generate_predicates)?null:{$:1,$0:"directive predicates "+(hT=="No_predicates"?"none":"all")},cw.Equals(hP,bR.default_options().rendering)?null:{$:1,$0:bR.displayRendering(hP)},hI.is_jit?{$:1,$0:"directive jit"}:null]));return hX.$==0?"":cS.concat("\\n",hX)+"\\n";};bR.setSpecificitiesText=function(hI,hJ){return bS.New(hJ.rules,hJ.leaks,hJ.pin_leaks,hJ.polymers,hJ.unproductive,hJ.sequence_rates,hJ.temperature,hJ.stabilityCorrection,hJ.coaxialDangle,hJ.doubleCoaxialDangle,hJ.terminalDangleFactor,hJ.coaxialCorrection,hJ.declare_domains,hJ.check_dna,hJ.colour_toeholds,hJ.program,hJ.toeholds,hI,hJ.plot_names,hJ.state_images,hJ.toehold_bind_rate,hJ.toehold_unbind_rate,hJ.leak_rate_l,hJ.leak_rate_w,hJ.pinleak_rate,hJ.tau_rate,hJ.elementary_migration_rate,hJ.toehold_length,hJ.specificity_length,hJ.local_concentrations,hJ.generate_predicates,hJ.rendering,hJ.is_jit,hJ.rulesProgram);};bR.setToeholdsText=function(hI,hJ){return bS.New(hJ.rules,hJ.leaks,hJ.pin_leaks,hJ.polymers,hJ.unproductive,hJ.sequence_rates,hJ.temperature,hJ.stabilityCorrection,hJ.coaxialDangle,hJ.doubleCoaxialDangle,hJ.terminalDangleFactor,hJ.coaxialCorrection,hJ.declare_domains,hJ.check_dna,hJ.colour_toeholds,hJ.program,hI,hJ.specificities,hJ.plot_names,hJ.state_images,hJ.toehold_bind_rate,hJ.toehold_unbind_rate,hJ.leak_rate_l,hJ.leak_rate_w,hJ.pinleak_rate,hJ.tau_rate,hJ.elementary_migration_rate,hJ.toehold_length,hJ.specificity_length,hJ.local_concentrations,hJ.generate_predicates,hJ.rendering,hJ.is_jit,hJ.rulesProgram);};bR.getRendering=function(hI){return hI.rendering;};bR.default_options=function(){fk.$cctor();return fk.default_options;};bR.update_options=function(hI,hJ){return hJ.$==1?bS.New(hI.rules,true,hI.pin_leaks,hI.polymers,hI.unproductive,hI.sequence_rates,hI.temperature,hI.stabilityCorrection,hI.coaxialDangle,hI.doubleCoaxialDangle,hI.terminalDangleFactor,hI.coaxialCorrection,hI.declare_domains,hI.check_dna,hI.colour_toeholds,hI.program,hI.toeholds,hI.specificities,hI.plot_names,hI.state_images,hI.toehold_bind_rate,hI.toehold_unbind_rate,hI.leak_rate_l,hI.leak_rate_w,hI.pinleak_rate,hI.tau_rate,hI.elementary_migration_rate,hI.toehold_length,hI.specificity_length,hI.local_concentrations,hI.generate_predicates,hI.rendering,hI.is_jit,hI.rulesProgram):hJ.$==2?bS.New(hI.rules,hI.leaks,true,hI.polymers,hI.unproductive,hI.sequence_rates,hI.temperature,hI.stabilityCorrection,hI.coaxialDangle,hI.doubleCoaxialDangle,hI.terminalDangleFactor,hI.coaxialCorrection,hI.declare_domains,hI.check_dna,hI.colour_toeholds,hI.program,hI.toeholds,hI.specificities,hI.plot_names,hI.state_images,hI.toehold_bind_rate,hI.toehold_unbind_rate,hI.leak_rate_l,hI.leak_rate_w,hI.pinleak_rate,hI.tau_rate,hI.elementary_migration_rate,hI.toehold_length,hI.specificity_length,hI.local_concentrations,hI.generate_predicates,hI.rendering,hI.is_jit,hI.rulesProgram):hJ.$==3?bS.New(hI.rules,hI.leaks,hI.pin_leaks,true,hI.unproductive,hI.sequence_rates,hI.temperature,hI.stabilityCorrection,hI.coaxialDangle,hI.doubleCoaxialDangle,hI.terminalDangleFactor,hI.coaxialCorrection,hI.declare_domains,hI.check_dna,hI.colour_toeholds,hI.program,hI.toeholds,hI.specificities,hI.plot_names,hI.state_images,hI.toehold_bind_rate,hI.toehold_unbind_rate,hI.leak_rate_l,hI.leak_rate_w,hI.pinleak_rate,hI.tau_rate,hI.elementary_migration_rate,hI.toehold_length,hI.specificity_length,hI.local_concentrations,hI.generate_predicates,hI.rendering,hI.is_jit,hI.rulesProgram):hJ.$==4?bS.New(hI.rules,hI.leaks,hI.pin_leaks,hI.polymers,true,hI.sequence_rates,hI.temperature,hI.stabilityCorrection,hI.coaxialDangle,hI.doubleCoaxialDangle,hI.terminalDangleFactor,hI.coaxialCorrection,hI.declare_domains,hI.check_dna,hI.colour_toeholds,hI.program,hI.toeholds,hI.specificities,hI.plot_names,hI.state_images,hI.toehold_bind_rate,hI.toehold_unbind_rate,hI.leak_rate_l,hI.leak_rate_w,hI.pinleak_rate,hI.tau_rate,hI.elementary_migration_rate,hI.toehold_length,hI.specificity_length,hI.local_concentrations,hI.generate_predicates,hI.rendering,hI.is_jit,hI.rulesProgram):hJ.$==5?bS.New(hI.rules,hI.leaks,hI.pin_leaks,hI.polymers,hI.unproductive,true,hI.temperature,hI.stabilityCorrection,hI.coaxialDangle,hI.doubleCoaxialDangle,hI.terminalDangleFactor,hI.coaxialCorrection,hI.declare_domains,hI.check_dna,hI.colour_toeholds,hI.program,hI.toeholds,hI.specificities,hI.plot_names,hI.state_images,hI.toehold_bind_rate,hI.toehold_unbind_rate,hI.leak_rate_l,hI.leak_rate_w,hI.pinleak_rate,hI.tau_rate,hI.elementary_migration_rate,hI.toehold_length,hI.specificity_length,hI.local_concentrations,hI.generate_predicates,hI.rendering,hI.is_jit,hI.rulesProgram):hJ.$==6?bS.New(hI.rules,hI.leaks,hI.pin_leaks,hI.polymers,hI.unproductive,hI.sequence_rates,hI.temperature,hI.stabilityCorrection,hI.coaxialDangle,hI.doubleCoaxialDangle,hI.terminalDangleFactor,hI.coaxialCorrection,true,hI.check_dna,hI.colour_toeholds,hI.program,hI.toeholds,hI.specificities,hI.plot_names,hI.state_images,hI.toehold_bind_rate,hI.toehold_unbind_rate,hI.leak_rate_l,hI.leak_rate_w,hI.pinleak_rate,hI.tau_rate,hI.elementary_migration_rate,hI.toehold_length,hI.specificity_length,hI.local_concentrations,hI.generate_predicates,hI.rendering,hI.is_jit,hI.rulesProgram):hJ.$==7?bS.New(hI.rules,hI.leaks,hI.pin_leaks,hI.polymers,hI.unproductive,hI.sequence_rates,hI.temperature,hI.stabilityCorrection,hI.coaxialDangle,hI.doubleCoaxialDangle,hI.terminalDangleFactor,hI.coaxialCorrection,hI.declare_domains,true,hI.colour_toeholds,hI.program,hI.toeholds,hI.specificities,hI.plot_names,hI.state_images,hI.toehold_bind_rate,hI.toehold_unbind_rate,hI.leak_rate_l,hI.leak_rate_w,hI.pinleak_rate,hI.tau_rate,hI.elementary_migration_rate,hI.toehold_length,hI.specificity_length,hI.local_concentrations,hI.generate_predicates,hI.rendering,hI.is_jit,hI.rulesProgram):hJ.$==8?bS.New(hI.rules,hI.leaks,hI.pin_leaks,hI.polymers,hI.unproductive,hI.sequence_rates,hI.temperature,hI.stabilityCorrection,hI.coaxialDangle,hI.doubleCoaxialDangle,hI.terminalDangleFactor,hI.coaxialCorrection,hI.declare_domains,hI.check_dna,true,hI.program,hI.toeholds,hI.specificities,hI.plot_names,hI.state_images,hI.toehold_bind_rate,hI.toehold_unbind_rate,hI.leak_rate_l,hI.leak_rate_w,hI.pinleak_rate,hI.tau_rate,hI.elementary_migration_rate,hI.toehold_length,hI.specificity_length,hI.local_concentrations,hI.generate_predicates,hI.rendering,hI.is_jit,hI.rulesProgram):hJ.$==9?bS.New(hI.rules,hI.leaks,hI.pin_leaks,hI.polymers,hI.unproductive,hI.sequence_rates,hI.temperature,hI.stabilityCorrection,hI.coaxialDangle,hI.doubleCoaxialDangle,hI.terminalDangleFactor,hI.coaxialCorrection,hI.declare_domains,hI.check_dna,hI.colour_toeholds,hJ.$0,hI.toeholds,hI.specificities,hI.plot_names,hI.state_images,hI.toehold_bind_rate,hI.toehold_unbind_rate,hI.leak_rate_l,hI.leak_rate_w,hI.pinleak_rate,hI.tau_rate,hI.elementary_migration_rate,hI.toehold_length,hI.specificity_length,hI.local_concentrations,hI.generate_predicates,hI.rendering,hI.is_jit,hI.rulesProgram):hJ.$==10?bS.New(hI.rules,hI.leaks,hI.pin_leaks,hI.polymers,hI.unproductive,hI.sequence_rates,hI.temperature,hI.stabilityCorrection,hI.coaxialDangle,hI.doubleCoaxialDangle,hI.terminalDangleFactor,hI.coaxialCorrection,hI.declare_domains,hI.check_dna,hI.colour_toeholds,hI.program,hJ.$0,hI.specificities,hI.plot_names,hI.state_images,hI.toehold_bind_rate,hI.toehold_unbind_rate,hI.leak_rate_l,hI.leak_rate_w,hI.pinleak_rate,hI.tau_rate,hI.elementary_migration_rate,hI.toehold_length,hI.specificity_length,hI.local_concentrations,hI.generate_predicates,hI.rendering,hI.is_jit,hI.rulesProgram):hJ.$==11?bS.New(hI.rules,hI.leaks,hI.pin_leaks,hI.polymers,hI.unproductive,hI.sequence_rates,hI.temperature,hI.stabilityCorrection,hI.coaxialDangle,hI.doubleCoaxialDangle,hI.terminalDangleFactor,hI.coaxialCorrection,hI.declare_domains,hI.check_dna,hI.colour_toeholds,hI.program,hI.toeholds,hJ.$0,hI.plot_names,hI.state_images,hI.toehold_bind_rate,hI.toehold_unbind_rate,hI.leak_rate_l,hI.leak_rate_w,hI.pinleak_rate,hI.tau_rate,hI.elementary_migration_rate,hI.toehold_length,hI.specificity_length,hI.local_concentrations,hI.generate_predicates,hI.rendering,hI.is_jit,hI.rulesProgram):hJ.$==12?bS.New(hI.rules,hI.leaks,hI.pin_leaks,hI.polymers,hI.unproductive,hI.sequence_rates,hI.temperature,hI.stabilityCorrection,hI.coaxialDangle,hI.doubleCoaxialDangle,hI.terminalDangleFactor,hI.coaxialCorrection,hI.declare_domains,hI.check_dna,hI.colour_toeholds,hI.program,hI.toeholds,hI.specificities,hI.plot_names,hI.state_images,hI.toehold_bind_rate,hI.toehold_unbind_rate,hI.leak_rate_l,hI.leak_rate_w,hI.pinleak_rate,hI.tau_rate,hI.elementary_migration_rate,hI.toehold_length,hI.specificity_length,hI.local_concentrations,hI.generate_predicates,hJ.$0,hI.is_jit,hI.rulesProgram):hJ.$==13?bS.New(hI.rules,hI.leaks,hI.pin_leaks,hI.polymers,hI.unproductive,hI.sequence_rates,hI.temperature,hI.stabilityCorrection,hI.coaxialDangle,hI.doubleCoaxialDangle,hI.terminalDangleFactor,hI.coaxialCorrection,hI.declare_domains,hI.check_dna,hI.colour_toeholds,hI.program,hI.toeholds,hI.specificities,true,hI.state_images,hI.toehold_bind_rate,hI.toehold_unbind_rate,hI.leak_rate_l,hI.leak_rate_w,hI.pinleak_rate,hI.tau_rate,hI.elementary_migration_rate,hI.toehold_length,hI.specificity_length,hI.local_concentrations,hI.generate_predicates,hI.rendering,hI.is_jit,hI.rulesProgram):hJ.$==14?bS.New(hI.rules,hI.leaks,hI.pin_leaks,hI.polymers,hI.unproductive,hI.sequence_rates,hI.temperature,hI.stabilityCorrection,hI.coaxialDangle,hI.doubleCoaxialDangle,hI.terminalDangleFactor,hI.coaxialCorrection,hI.declare_domains,hI.check_dna,hI.colour_toeholds,hI.program,hI.toeholds,hI.specificities,hI.plot_names,true,hI.toehold_bind_rate,hI.toehold_unbind_rate,hI.leak_rate_l,hI.leak_rate_w,hI.pinleak_rate,hI.tau_rate,hI.elementary_migration_rate,hI.toehold_length,hI.specificity_length,hI.local_concentrations,hI.generate_predicates,hI.rendering,hI.is_jit,hI.rulesProgram):hJ.$==15?bS.New(hI.rules,hI.leaks,hI.pin_leaks,hI.polymers,hI.unproductive,hI.sequence_rates,hI.temperature,hI.stabilityCorrection,hI.coaxialDangle,hI.doubleCoaxialDangle,hI.terminalDangleFactor,hI.coaxialCorrection,hI.declare_domains,hI.check_dna,hI.colour_toeholds,hI.program,hI.toeholds,hI.specificities,hI.plot_names,hI.state_images,hJ.$0,hI.toehold_unbind_rate,hI.leak_rate_l,hI.leak_rate_w,hI.pinleak_rate,hI.tau_rate,hI.elementary_migration_rate,hI.toehold_length,hI.specificity_length,hI.local_concentrations,hI.generate_predicates,hI.rendering,hI.is_jit,hI.rulesProgram):hJ.$==16?bS.New(hI.rules,hI.leaks,hI.pin_leaks,hI.polymers,hI.unproductive,hI.sequence_rates,hI.temperature,hI.stabilityCorrection,hI.coaxialDangle,hI.doubleCoaxialDangle,hI.terminalDangleFactor,hI.coaxialCorrection,hI.declare_domains,hI.check_dna,hI.colour_toeholds,hI.program,hI.toeholds,hI.specificities,hI.plot_names,hI.state_images,hI.toehold_bind_rate,hJ.$0,hI.leak_rate_l,hI.leak_rate_w,hI.pinleak_rate,hI.tau_rate,hI.elementary_migration_rate,hI.toehold_length,hI.specificity_length,hI.local_concentrations,hI.generate_predicates,hI.rendering,hI.is_jit,hI.rulesProgram):hJ.$==17?bS.New(hI.rules,hI.leaks,hI.pin_leaks,hI.polymers,hI.unproductive,hI.sequence_rates,hI.temperature,hI.stabilityCorrection,hI.coaxialDangle,hI.doubleCoaxialDangle,hI.terminalDangleFactor,hI.coaxialCorrection,hI.declare_domains,hI.check_dna,hI.colour_toeholds,hI.program,hI.toeholds,hI.specificities,hI.plot_names,hI.state_images,hI.toehold_bind_rate,hI.toehold_unbind_rate,hJ.$0,hI.leak_rate_w,hI.pinleak_rate,hI.tau_rate,hI.elementary_migration_rate,hI.toehold_length,hI.specificity_length,hI.local_concentrations,hI.generate_predicates,hI.rendering,hI.is_jit,hI.rulesProgram):hJ.$==18?bS.New(hI.rules,hI.leaks,hI.pin_leaks,hI.polymers,hI.unproductive,hI.sequence_rates,hI.temperature,hI.stabilityCorrection,hI.coaxialDangle,hI.doubleCoaxialDangle,hI.terminalDangleFactor,hI.coaxialCorrection,hI.declare_domains,hI.check_dna,hI.colour_toeholds,hI.program,hI.toeholds,hI.specificities,hI.plot_names,hI.state_images,hI.toehold_bind_rate,hI.toehold_unbind_rate,hI.leak_rate_l,hJ.$0,hI.pinleak_rate,hI.tau_rate,hI.elementary_migration_rate,hI.toehold_length,hI.specificity_length,hI.local_concentrations,hI.generate_predicates,hI.rendering,hI.is_jit,hI.rulesProgram):hJ.$==19?bS.New(hI.rules,hI.leaks,hI.pin_leaks,hI.polymers,hI.unproductive,hI.sequence_rates,hI.temperature,hI.stabilityCorrection,hI.coaxialDangle,hI.doubleCoaxialDangle,hI.terminalDangleFactor,hI.coaxialCorrection,hI.declare_domains,hI.check_dna,hI.colour_toeholds,hI.program,hI.toeholds,hI.specificities,hI.plot_names,hI.state_images,hI.toehold_bind_rate,hI.toehold_unbind_rate,hI.leak_rate_l,hI.leak_rate_w,hJ.$0,hI.tau_rate,hI.elementary_migration_rate,hI.toehold_length,hI.specificity_length,hI.local_concentrations,hI.generate_predicates,hI.rendering,hI.is_jit,hI.rulesProgram):hJ.$==20?bS.New(hI.rules,hI.leaks,hI.pin_leaks,hI.polymers,hI.unproductive,hI.sequence_rates,hI.temperature,hI.stabilityCorrection,hI.coaxialDangle,hI.doubleCoaxialDangle,hI.terminalDangleFactor,hI.coaxialCorrection,hI.declare_domains,hI.check_dna,hI.colour_toeholds,hI.program,hI.toeholds,hI.specificities,hI.plot_names,hI.state_images,hI.toehold_bind_rate,hI.toehold_unbind_rate,hI.leak_rate_l,hI.leak_rate_w,hI.pinleak_rate,hJ.$0,hI.elementary_migration_rate,hI.toehold_length,hI.specificity_length,hI.local_concentrations,hI.generate_predicates,hI.rendering,hI.is_jit,hI.rulesProgram):hJ.$==21?bS.New(hI.rules,hI.leaks,hI.pin_leaks,hI.polymers,hI.unproductive,hI.sequence_rates,hI.temperature,hI.stabilityCorrection,hI.coaxialDangle,hI.doubleCoaxialDangle,hI.terminalDangleFactor,hI.coaxialCorrection,hI.declare_domains,hI.check_dna,hI.colour_toeholds,hI.program,hI.toeholds,hI.specificities,hI.plot_names,hI.state_images,hI.toehold_bind_rate,hI.toehold_unbind_rate,hI.leak_rate_l,hI.leak_rate_w,hI.pinleak_rate,hI.tau_rate,hJ.$0,hI.toehold_length,hI.specificity_length,hI.local_concentrations,hI.generate_predicates,hI.rendering,hI.is_jit,hI.rulesProgram):hJ.$==22?bS.New(hI.rules,hI.leaks,hI.pin_leaks,hI.polymers,hI.unproductive,hI.sequence_rates,hI.temperature,hI.stabilityCorrection,hI.coaxialDangle,hI.doubleCoaxialDangle,hI.terminalDangleFactor,hI.coaxialCorrection,hI.declare_domains,hI.check_dna,hI.colour_toeholds,hI.program,hI.toeholds,hI.specificities,hI.plot_names,hI.state_images,hI.toehold_bind_rate,hI.toehold_unbind_rate,hI.leak_rate_l,hI.leak_rate_w,hI.pinleak_rate,hI.tau_rate,hI.elementary_migration_rate,hJ.$0,hI.specificity_length,hI.local_concentrations,hI.generate_predicates,hI.rendering,hI.is_jit,hI.rulesProgram):hJ.$==23?bS.New(hI.rules,hI.leaks,hI.pin_leaks,hI.polymers,hI.unproductive,hI.sequence_rates,hI.temperature,hI.stabilityCorrection,hI.coaxialDangle,hI.doubleCoaxialDangle,hI.terminalDangleFactor,hI.coaxialCorrection,hI.declare_domains,hI.check_dna,hI.colour_toeholds,hI.program,hI.toeholds,hI.specificities,hI.plot_names,hI.state_images,hI.toehold_bind_rate,hI.toehold_unbind_rate,hI.leak_rate_l,hI.leak_rate_w,hI.pinleak_rate,hI.tau_rate,hI.elementary_migration_rate,hI.toehold_length,hJ.$0,hI.local_concentrations,hI.generate_predicates,hI.rendering,hI.is_jit,hI.rulesProgram):hJ.$==24?bS.New(hI.rules,hI.leaks,hI.pin_leaks,hI.polymers,hI.unproductive,hI.sequence_rates,hI.temperature,hI.stabilityCorrection,hI.coaxialDangle,hI.doubleCoaxialDangle,hI.terminalDangleFactor,hI.coaxialCorrection,hI.declare_domains,hI.check_dna,hI.colour_toeholds,hI.program,hI.toeholds,hI.specificities,hI.plot_names,hI.state_images,hI.toehold_bind_rate,hI.toehold_unbind_rate,hI.leak_rate_l,hI.leak_rate_w,hI.pinleak_rate,hI.tau_rate,hI.elementary_migration_rate,hI.toehold_length,hI.specificity_length,hJ.$0,hI.generate_predicates,hI.rendering,hI.is_jit,hI.rulesProgram):hJ.$==25?bS.New(hI.rules,hI.leaks,hI.pin_leaks,hI.polymers,hI.unproductive,hI.sequence_rates,hI.temperature,hI.stabilityCorrection,hI.coaxialDangle,hI.doubleCoaxialDangle,hI.terminalDangleFactor,hI.coaxialCorrection,hI.declare_domains,hI.check_dna,hI.colour_toeholds,hI.program,hI.toeholds,hI.specificities,hI.plot_names,hI.state_images,hI.toehold_bind_rate,hI.toehold_unbind_rate,hI.leak_rate_l,hI.leak_rate_w,hI.pinleak_rate,hI.tau_rate,hI.elementary_migration_rate,hI.toehold_length,hI.specificity_length,hI.local_concentrations,hJ.$0,hI.rendering,hI.is_jit,hI.rulesProgram):hJ.$==26?bS.New(hI.rules,hI.leaks,hI.pin_leaks,hI.polymers,hI.unproductive,hI.sequence_rates,hJ.$0,hI.stabilityCorrection,hI.coaxialDangle,hI.doubleCoaxialDangle,hI.terminalDangleFactor,hI.coaxialCorrection,hI.declare_domains,hI.check_dna,hI.colour_toeholds,hI.program,hI.toeholds,hI.specificities,hI.plot_names,hI.state_images,hI.toehold_bind_rate,hI.toehold_unbind_rate,hI.leak_rate_l,hI.leak_rate_w,hI.pinleak_rate,hI.tau_rate,hI.elementary_migration_rate,hI.toehold_length,hI.specificity_length,hI.local_concentrations,hI.generate_predicates,hI.rendering,hI.is_jit,hI.rulesProgram):hJ.$==27?bS.New(hI.rules,hI.leaks,hI.pin_leaks,hI.polymers,hI.unproductive,hI.sequence_rates,hI.temperature,hJ.$0,hI.coaxialDangle,hI.doubleCoaxialDangle,hI.terminalDangleFactor,hI.coaxialCorrection,hI.declare_domains,hI.check_dna,hI.colour_toeholds,hI.program,hI.toeholds,hI.specificities,hI.plot_names,hI.state_images,hI.toehold_bind_rate,hI.toehold_unbind_rate,hI.leak_rate_l,hI.leak_rate_w,hI.pinleak_rate,hI.tau_rate,hI.elementary_migration_rate,hI.toehold_length,hI.specificity_length,hI.local_concentrations,hI.generate_predicates,hI.rendering,hI.is_jit,hI.rulesProgram):hJ.$==28?bS.New(hI.rules,hI.leaks,hI.pin_leaks,hI.polymers,hI.unproductive,hI.sequence_rates,hI.temperature,hI.stabilityCorrection,hJ.$0,hI.doubleCoaxialDangle,hI.terminalDangleFactor,hI.coaxialCorrection,hI.declare_domains,hI.check_dna,hI.colour_toeholds,hI.program,hI.toeholds,hI.specificities,hI.plot_names,hI.state_images,hI.toehold_bind_rate,hI.toehold_unbind_rate,hI.leak_rate_l,hI.leak_rate_w,hI.pinleak_rate,hI.tau_rate,hI.elementary_migration_rate,hI.toehold_length,hI.specificity_length,hI.local_concentrations,hI.generate_predicates,hI.rendering,hI.is_jit,hI.rulesProgram):hJ.$==29?bS.New(hI.rules,hI.leaks,hI.pin_leaks,hI.polymers,hI.unproductive,hI.sequence_rates,hI.temperature,hI.stabilityCorrection,hI.coaxialDangle,hJ.$0,hI.terminalDangleFactor,hI.coaxialCorrection,hI.declare_domains,hI.check_dna,hI.colour_toeholds,hI.program,hI.toeholds,hI.specificities,hI.plot_names,hI.state_images,hI.toehold_bind_rate,hI.toehold_unbind_rate,hI.leak_rate_l,hI.leak_rate_w,hI.pinleak_rate,hI.tau_rate,hI.elementary_migration_rate,hI.toehold_length,hI.specificity_length,hI.local_concentrations,hI.generate_predicates,hI.rendering,hI.is_jit,hI.rulesProgram):hJ.$==30?bS.New(hI.rules,hI.leaks,hI.pin_leaks,hI.polymers,hI.unproductive,hI.sequence_rates,hI.temperature,hI.stabilityCorrection,hI.coaxialDangle,hI.doubleCoaxialDangle,hJ.$0,hI.coaxialCorrection,hI.declare_domains,hI.check_dna,hI.colour_toeholds,hI.program,hI.toeholds,hI.specificities,hI.plot_names,hI.state_images,hI.toehold_bind_rate,hI.toehold_unbind_rate,hI.leak_rate_l,hI.leak_rate_w,hI.pinleak_rate,hI.tau_rate,hI.elementary_migration_rate,hI.toehold_length,hI.specificity_length,hI.local_concentrations,hI.generate_predicates,hI.rendering,hI.is_jit,hI.rulesProgram):hJ.$==31?bS.New(hI.rules,hI.leaks,hI.pin_leaks,hI.polymers,hI.unproductive,hI.sequence_rates,hI.temperature,hI.stabilityCorrection,hI.coaxialDangle,hI.doubleCoaxialDangle,hI.terminalDangleFactor,hJ.$0,hI.declare_domains,hI.check_dna,hI.colour_toeholds,hI.program,hI.toeholds,hI.specificities,hI.plot_names,hI.state_images,hI.toehold_bind_rate,hI.toehold_unbind_rate,hI.leak_rate_l,hI.leak_rate_w,hI.pinleak_rate,hI.tau_rate,hI.elementary_migration_rate,hI.toehold_length,hI.specificity_length,hI.local_concentrations,hI.generate_predicates,hI.rendering,hI.is_jit,hI.rulesProgram):hJ.$==32?bS.New(hI.rules,hI.leaks,hI.pin_leaks,hI.polymers,hI.unproductive,hI.sequence_rates,hI.temperature,hI.stabilityCorrection,hI.coaxialDangle,hI.doubleCoaxialDangle,hI.terminalDangleFactor,hI.coaxialCorrection,hI.declare_domains,hI.check_dna,hI.colour_toeholds,hI.program,hI.toeholds,hI.specificities,hI.plot_names,hI.state_images,hI.toehold_bind_rate,hI.toehold_unbind_rate,hI.leak_rate_l,hI.leak_rate_w,hI.pinleak_rate,hI.tau_rate,hI.elementary_migration_rate,hI.toehold_length,hI.specificity_length,hI.local_concentrations,hI.generate_predicates,hI.rendering,hJ.$0,hI.rulesProgram):hJ.$==33?bS.New(hI.rules,hI.leaks,hI.pin_leaks,hI.polymers,hI.unproductive,hI.sequence_rates,hI.temperature,hI.stabilityCorrection,hI.coaxialDangle,hI.doubleCoaxialDangle,hI.terminalDangleFactor,hI.coaxialCorrection,hI.declare_domains,hI.check_dna,hI.colour_toeholds,hI.program,hI.toeholds,hI.specificities,hI.plot_names,hI.state_images,hI.toehold_bind_rate,hI.toehold_unbind_rate,hI.leak_rate_l,hI.leak_rate_w,hI.pinleak_rate,hI.tau_rate,hI.elementary_migration_rate,hI.toehold_length,hI.specificity_length,hI.local_concentrations,hI.generate_predicates,hI.rendering,hI.is_jit,{$:1,$0:hJ.$0}):bS.New(hJ.$0,hI.leaks,hI.pin_leaks,hI.polymers,hI.unproductive,hI.sequence_rates,hI.temperature,hI.stabilityCorrection,hI.coaxialDangle,hI.doubleCoaxialDangle,hI.terminalDangleFactor,hI.coaxialCorrection,hI.declare_domains,hI.check_dna,hI.colour_toeholds,hI.program,hI.toeholds,hI.specificities,hI.plot_names,hI.state_images,hI.toehold_bind_rate,hI.toehold_unbind_rate,hI.leak_rate_l,hI.leak_rate_w,hI.pinleak_rate,hI.tau_rate,hI.elementary_migration_rate,hI.toehold_length,hI.specificity_length,hI.local_concentrations,hI.generate_predicates,hI.rendering,hI.is_jit,hI.rulesProgram);};bR.displayRendering=function(hI){var hJ,hK,hL,hM,hN,hO;hJ=!cw.Equals(hI.renderer,bR.default_rendering().renderer)?(function(hP){return function(hQ){return hP("renderer = "+cA.toSafe(hQ)+"; ");};}(a.id))((hK=hI.renderer,hK=="Circles"?bR.KW_CIRCLES():hK=="No_predicates"?bR.KW_CLASSIC():bR.KW_BRANCHES())):"";hL=!cw.Equals(hI.mode,bR.default_rendering().mode)?(function(hP){return function(hQ){return hP("mode = "+cA.toSafe(hQ)+"; ");};}(a.id))((hM=hI.mode,hM=="Condensed"?bR.KW_CONDENSED():hM=="Nucleotides"?bR.KW_NUCLEOTIDES():bR.KW_COMPLEMENT())):"";hN=!cw.Equals(hI.rotate_labels,bR.default_rendering().rotate_labels)?(function(hP){return function(hQ){return hP("rotate_labels = "+cA.toSafe(hQ)+"; ");};}(a.id))(a.String(hI.rotate_labels)):"";hO=!cw.Equals(hI.arrange,bR.default_rendering().arrange)?(function(hP){return function(hQ){return hP("arrange = "+cA.toSafe(hQ)+"; ");};}(a.id))(hI.arrange=="Wide"?bR.KW_WIDE():bR.KW_BABYLON()):"";return!cw.Equals(hI,bR.default_rendering())?(function(hP){return function(hQ){return hP("directive rendering { "+cA.toSafe(hQ)+" }");};}(a.id))(hJ+hL+hO+hN):"";};bR.getDeclareDomains=function(hI){return hI.declare_domains;};bR.set_is_jit=function(hI,hJ){return bS.New(hJ.rules,hJ.leaks,hJ.pin_leaks,hJ.polymers,hJ.unproductive,hJ.sequence_rates,hJ.temperature,hJ.stabilityCorrection,hJ.coaxialDangle,hJ.doubleCoaxialDangle,hJ.terminalDangleFactor,hJ.coaxialCorrection,hJ.declare_domains,hJ.check_dna,hJ.colour_toeholds,hJ.program,hJ.toeholds,hJ.specificities,hJ.plot_names,hJ.state_images,hJ.toehold_bind_rate,hJ.toehold_unbind_rate,hJ.leak_rate_l,hJ.leak_rate_w,hJ.pinleak_rate,hJ.tau_rate,hJ.elementary_migration_rate,hJ.toehold_length,hJ.specificity_length,hJ.local_concentrations,hJ.generate_predicates,hJ.rendering,hI,hJ.rulesProgram);};bR.setStabilityCorrection=function(hI,hJ){return bS.New(hJ.rules,hJ.leaks,hJ.pin_leaks,hJ.polymers,hJ.unproductive,hJ.sequence_rates,hJ.temperature,hI*1,hJ.coaxialDangle,hJ.doubleCoaxialDangle,hJ.terminalDangleFactor,hJ.coaxialCorrection,hJ.declare_domains,hJ.check_dna,hJ.colour_toeholds,hJ.program,hJ.toeholds,hJ.specificities,hJ.plot_names,hJ.state_images,hJ.toehold_bind_rate,hJ.toehold_unbind_rate,hJ.leak_rate_l,hJ.leak_rate_w,hJ.pinleak_rate,hJ.tau_rate,hJ.elementary_migration_rate,hJ.toehold_length,hJ.specificity_length,hJ.local_concentrations,hJ.generate_predicates,hJ.rendering,hJ.is_jit,hJ.rulesProgram);};bR.setCoaxialDangle=function(hI,hJ){return bS.New(hJ.rules,hJ.leaks,hJ.pin_leaks,hJ.polymers,hJ.unproductive,hJ.sequence_rates,hJ.temperature,hJ.stabilityCorrection,hI*1,hJ.doubleCoaxialDangle,hJ.terminalDangleFactor,hJ.coaxialCorrection,hJ.declare_domains,hJ.check_dna,hJ.colour_toeholds,hJ.program,hJ.toeholds,hJ.specificities,hJ.plot_names,hJ.state_images,hJ.toehold_bind_rate,hJ.toehold_unbind_rate,hJ.leak_rate_l,hJ.leak_rate_w,hJ.pinleak_rate,hJ.tau_rate,hJ.elementary_migration_rate,hJ.toehold_length,hJ.specificity_length,hJ.local_concentrations,hJ.generate_predicates,hJ.rendering,hJ.is_jit,hJ.rulesProgram);};bR.setDoubleCoaxialDangle=function(hI,hJ){return bS.New(hJ.rules,hJ.leaks,hJ.pin_leaks,hJ.polymers,hJ.unproductive,hJ.sequence_rates,hJ.temperature,hJ.stabilityCorrection,hJ.coaxialDangle,hI*1,hJ.terminalDangleFactor,hJ.coaxialCorrection,hJ.declare_domains,hJ.check_dna,hJ.colour_toeholds,hJ.program,hJ.toeholds,hJ.specificities,hJ.plot_names,hJ.state_images,hJ.toehold_bind_rate,hJ.toehold_unbind_rate,hJ.leak_rate_l,hJ.leak_rate_w,hJ.pinleak_rate,hJ.tau_rate,hJ.elementary_migration_rate,hJ.toehold_length,hJ.specificity_length,hJ.local_concentrations,hJ.generate_predicates,hJ.rendering,hJ.is_jit,hJ.rulesProgram);};bR.setCoaxialCorrection=function(hI,hJ){return bS.New(hJ.rules,hJ.leaks,hJ.pin_leaks,hJ.polymers,hJ.unproductive,hJ.sequence_rates,hJ.temperature,hJ.stabilityCorrection,hJ.coaxialDangle,hJ.doubleCoaxialDangle,hJ.terminalDangleFactor,hI,hJ.declare_domains,hJ.check_dna,hJ.colour_toeholds,hJ.program,hJ.toeholds,hJ.specificities,hJ.plot_names,hJ.state_images,hJ.toehold_bind_rate,hJ.toehold_unbind_rate,hJ.leak_rate_l,hJ.leak_rate_w,hJ.pinleak_rate,hJ.tau_rate,hJ.elementary_migration_rate,hJ.toehold_length,hJ.specificity_length,hJ.local_concentrations,hJ.generate_predicates,hJ.rendering,hJ.is_jit,hJ.rulesProgram);};bR.setTemperature=function(hI,hJ){return bS.New(hI.rules,hI.leaks,hI.pin_leaks,hI.polymers,hI.unproductive,hI.sequence_rates,hJ*1,hI.stabilityCorrection,hI.coaxialDangle,hI.doubleCoaxialDangle,hI.terminalDangleFactor,hI.coaxialCorrection,hI.declare_domains,hI.check_dna,hI.colour_toeholds,hI.program,hI.toeholds,hI.specificities,hI.plot_names,hI.state_images,hI.toehold_bind_rate,hI.toehold_unbind_rate,hI.leak_rate_l,hI.leak_rate_w,hI.pinleak_rate,hI.tau_rate,hI.elementary_migration_rate,hI.toehold_length,hI.specificity_length,hI.local_concentrations,hI.generate_predicates,hI.rendering,hI.is_jit,hI.rulesProgram);};bR.setTerminalDangleFactor=function(hI,hJ){return bS.New(hI.rules,hI.leaks,hI.pin_leaks,hI.polymers,hI.unproductive,hI.sequence_rates,hI.temperature,hI.stabilityCorrection,hI.coaxialDangle,hI.doubleCoaxialDangle,hJ,hI.coaxialCorrection,hI.declare_domains,hI.check_dna,hI.colour_toeholds,hI.program,hI.toeholds,hI.specificities,hI.plot_names,hI.state_images,hI.toehold_bind_rate,hI.toehold_unbind_rate,hI.leak_rate_l,hI.leak_rate_w,hI.pinleak_rate,hI.tau_rate,hI.elementary_migration_rate,hI.toehold_length,hI.specificity_length,hI.local_concentrations,hI.generate_predicates,hI.rendering,hI.is_jit,hI.rulesProgram);};bR.default_rendering=function(){fk.$cctor();return fk.default_rendering;};bR.KW_WIDE=function(){fk.$cctor();return fk.KW_WIDE;};bR.KW_BABYLON=function(){fk.$cctor();return fk.KW_BABYLON;};bR.KW_CONDENSED=function(){fk.$cctor();return fk.KW_CONDENSED;};bR.KW_NUCLEOTIDES=function(){fk.$cctor();return fk.KW_NUCLEOTIDES;};bR.KW_COMPLEMENT=function(){fk.$cctor();return fk.KW_COMPLEMENT;};bR.KW_CIRCLES=function(){fk.$cctor();return fk.KW_CIRCLES;};bR.KW_CLASSIC=function(){fk.$cctor();return fk.KW_CLASSIC;};bR.KW_BRANCHES=function(){fk.$cctor();return fk.KW_BRANCHES;};bR.parse_option=function(){fk.$cctor();return fk.parse_option;};bR.get_rules_program=function(hI){return hI.rulesProgram;};bR.get_toehold_bind_rate=function(hI){return hI.toehold_bind_rate;};bR.get_toehold_unbind_rate=function(hI){return hI.toehold_unbind_rate;};bR.getRules=function(hI){return hI.rules;};bR.getToeholdsText=function(hI){return hI.toeholds;};bR.getSpecificitiesText=function(hI){return hI.specificities;};bR.getCheckDNA=function(hI){return hI.check_dna;};bR.optionParsers=function(){fk.$cctor();return fk.optionParsers;};bR.default_leak_rate_l=function(){fk.$cctor();return fk.default_leak_rate_l;};bR.default_toehold_unbind_rate=function(){fk.$cctor();return fk.default_toehold_unbind_rate;};bR.default_stabilityCorrection=function(){fk.$cctor();return fk.default_stabilityCorrection;};bR.default_coaxialDangle=function(){fk.$cctor();return fk.default_coaxialDangle;};bR.default_doubleCoaxialDangle=function(){fk.$cctor();return fk.default_doubleCoaxialDangle;};bR.default_terminalDangleFactor=function(){fk.$cctor();return fk.default_terminalDangleFactor;};bR.default_toehold_bind_rate=function(){fk.$cctor();return fk.default_toehold_bind_rate;};bR.default_leak_rate_w=function(){fk.$cctor();return fk.default_leak_rate_w;};bR.default_tau_rate=function(){fk.$cctor();return fk.default_tau_rate;};bR.default_elementary_migration_rate=function(){fk.$cctor();return fk.default_elementary_migration_rate;};bR.default_toehold_length=function(){fk.$cctor();return fk.default_toehold_length;};bR.default_specificity_length=function(){fk.$cctor();return fk.default_specificity_length;};bR.default_coaxialCorrection=function(){fk.$cctor();return fk.default_coaxialCorrection;};bR.nameSp=function(){fk.$cctor();return fk.nameSp;};bR.pint32Sp=function(){fk.$cctor();return fk.pint32Sp;};bR.intName=function(){fk.$cctor();return fk.intName;};bR.expParser=function(){fk.$cctor();return fk.expParser;};bR.pfloatSp=function(){fk.$cctor();return fk.pfloatSp;};bR.toeholds=function(){fk.$cctor();return fk.toeholds;};bR.leak=function(){fk.$cctor();return fk.leak;};bR.pinLeak=function(){fk.$cctor();return fk.pinLeak;};bR.tauRate=function(){fk.$cctor();return fk.tauRate;};bR.elemMigrateRate=function(){fk.$cctor();return fk.elemMigrateRate;};bR.lengths=function(){fk.$cctor();return fk.lengths;};bR.localConc=function(){fk.$cctor();return fk.localConc;};bR.localConc2=function(){fk.$cctor();return fk.localConc2;};bR.KW_ROTATE_LABELS=function(){fk.$cctor();return fk.KW_ROTATE_LABELS;};bR.cle=function(){fk.$cctor();return fk.cle;};bR.dictToMap=function(hI){return bW.OfArray(ck.ofSeq(co.map(be.KeyValue,hI)));};bR.getLeaks=function(hI){return hI.leaks;};bR.getUnproductive=function(hI){return hI.unproductive;};bR.getPinLeaks=function(hI){return hI.pin_leaks;};bR.getPolymers=function(hI){return hI.polymers;};bR.getSequenceRates=function(hI){return hI.sequence_rates;};bR.getTemperature=function(hI){return hI.temperature;};bR.get_leak_rate_l=function(hI){return hI.leak_rate_l;};bR.get_leak_rate_w=function(hI){return hI.leak_rate_w;};bR.get_tau_rate=function(hI){return hI.tau_rate;};bR.get_elementary_migration_rate=function(hI){return hI.elementary_migration_rate;};bR.get_specificity_length=function(hI){return hI.specificity_length;};bR.get_toehold_length=function(hI){return hI.toehold_length;};bR.get_pinleak_rate=function(hI){return hI.pinleak_rate;};bR.get_local_concentration=function(hI,hJ){var hK;hK=dZ.try_assoc(hJ,hI.local_concentrations);return hK==null?be.FailWith((function(hL){return function(hM){return hL("The local concentration of "+cA.toSafe(hM)+" is not defined");};}(a.id))(hJ)):hK.$0;};bR.getStabilityCorrection=function(hI){return hI.stabilityCorrection;};bR.getCoaxialCorrection=function(hI){return hI.coaxialCorrection;};bR.getCoaxialDangle=function(hI){return hI.coaxialDangle;};bR.getDoubleCoaxialDangle=function(hI){return hI.doubleCoaxialDangle;};bR.getTerminalDangleFactor=function(hI){return hI.terminalDangleFactor;};bW.ToSeq=function(hI){return co.map(function(hJ){return[hJ.Key,hJ.Value];},c6.Enumerate(false,hI.get_Tree()));};bW.Iterate=function(hI,hJ){co.iter(function(hK){hI(hK.K,hK.V);},hJ);};bW.Map=function(hI,hJ){return new cj.New$1(c6.OfSeq(co.map(function(hK){return c8.New(hK.Key,hI(hK.Key,hK.Value));},c6.Enumerate(false,hJ.get_Tree()))));};bW.TryFind=function(hI,hJ){return hJ.TryFind(hI);};bW.FindKey=function(hI,hJ){return co.pick(function(hK){return hI(hK.K,hK.V)?{$:1,$0:hK.K}:null;},hJ);};bW.OfArray=function(hI){return new cj.New$1(c6.OfSeq(co.map(function(hJ){return c8.New(hJ[0],hJ[1]);},hI)));};bW.FoldBack=function(hI,hJ,hK){return co.fold(function(hL,hM){return hI(hM.Key,hM.Value,hL);},hK,c6.Enumerate(true,hJ.get_Tree()));};bW.Fold=function(hI,hJ,hK){return co.fold(function(hL,hM){return hI(hL,hM.Key,hM.Value);},hJ,c6.Enumerate(false,hK.get_Tree()));};bW.Filter=function(hI,hJ){var hK;return new cj.New$1((hK=ck.ofSeq(co.filter(function(hL){return hI(hL.Key,hL.Value);},c6.Enumerate(false,hJ.get_Tree()))),c6.Build(hK,0,hK.length-1)));};bY=bX.T=hB.Class({get_Length:function(){return bX.length(this);},get_Item:function(hI){return co.nth(hI,this);},GetSlice:function(hI,hJ){var hK;return hI!=null&&hI.$==1?hJ!=null&&hJ.$==1?(hK=hI.$0,bX.ofSeq(co.take(hJ.$0-hK+1,bX.skip(hK,this)))):bX.skip(hI.$0,this):hJ!=null&&hJ.$==1?bX.ofSeq(co.take(hJ.$0+1,this)):this;},GetEnumerator:function(){return new ex.New(this,null,function(hI){var hJ;hJ=hI.s;return hJ.$==0?false:(hI.c=hJ.$0,hI.s=hJ.$1,true);},void 0);},GetEnumerator0:function(){return df.Get(this);}},null,bY);bY.Empty=new bY({$:0});bZ.convertSL=function(hI){var hJ,hM;function hK(hN){var hO;return hN.$==1?"["+cN.display(hN.$0)+"]":hN.$==2?(hO=hN.$1,"["+hN.$0+(hO.$==1?"("+cS.concat(", ",bX.map(cT.to_string,hO.$0))+")]":" _]")):hN.$0;}function hL(hN){var hO;return hN.$==1?cN.display(hN.$0):hN.$==2?(hO=hN.$1,hN.$0+(hO.$==1?"("+cS.concat(", ",bX.map(cT.to_string,hO.$0))+")":" _")):hN.$0;}hM=cR.run(bZ.parserOld(bZ.freshSweepIdGenerator()),hI);if(hM.$==1)throw new db(hM.$0);else hJ=[hM.$0[0],hM.$0[1],hM.$0[2]];return hJ[1].to_string(function(hN){return br.to_string(hK,hN);},function(hN){return hN.$==0?hL(hN.$0):br.to_string(hK,hN);})+bR.display(hJ[2])+cU.display(hJ[0]);};bZ.parserOld=function(hI){return cR.op_DotGreaterGreater(cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(cR.spaces(),cR.many(cR.op_GreaterGreaterDot(cR.kw("directive"),bZ.oldDirective$1()))),function(hJ){var hK,hL,hM;function hN(hO,hP,hQ){return function(hR){var hS;return hR.$==1?[hO,co.fold(bR.update_options,hP,hR.$0),hQ]:(hS=bZ.updateWithOldDirectives(hI,hR.$0,hO,hP),hS.$==1?[hO,hS.$0,hQ]:hS.$==2?[hO,hP,new bY({$:1,$0:hS.$0,$1:hQ})]:[hS.$0,hP,hQ]);};}hK=co.fold(function(hO,hP){return(function(hQ){return hN(hQ[0],hQ[1],hQ[2]);}(hO))(hP);},[Y.get_defaults(),bR.default_options(),bY.Empty],hJ);hL=hK[0];hM=hK[1];return cR.op_GreaterGreaterEquals(bZ.oldDsParser(hK[2]),function(hO){return cR.preturn([hO,hL,hM]);});}),cR.spaces());};bZ.freshSweepIdGenerator=function(){var hI;hI=[0];return function(){var hJ;hJ=hI[0]+1;hI[0]=hJ;return"sweep_"+a.String(hJ);};};bZ.oldDirective$1=function(){fj.$cctor();return fj.oldDirective;};bZ.oldDsParser=function(hI){var hJ;return cR.op_BarGreaterGreater(ea.seq1((hJ=cR.choice([cR.op_GreaterGreaterEquals(cR.op_DotGreaterGreater(bZ.op_AmpGreater("def",ea.parse_name()),cR.spaces()),function(hK){return cR.op_LessBarGreater(cR.op_GreaterGreaterEquals(bZ.op_AmpGreater("=",bZ.pValOrTuple()),function(hL){return cR.preturn({$:2,$0:[hK,hL]});}),cR.op_BarTwiddleGreater(cR.op_PlusGreaterGreaterPlus(function(hL){return ea.parse_parameters(hL[0],hL[1]);},bZ.op_AmpGreater("=",function(hL){return bZ.oldProc(hL[0],hL[1]);})),function(hL,hM){return{$:1,$0:[hK,ea.to_range(hL[0],hL[1]),hM[0],hM[1]]};}));}),cR.op_BarGreaterGreater(bZ.op_AmpGreater("new",ea.restriction()),function(hK){return{$:0,$0:[hK,true]};}),cR.op_BarGreaterGreater(bZ.op_AmpGreater("dom",cR.op_PlusGreaterGreaterPlus(ea.int_name(),bZ.op_AmpGreater("=",ea.record()))),function(hK){return{$:0,$0:[hK,false]};}),cR.op_GreaterGreaterEquals(cR.kw("predicate"),function(hK){return be.FailWith("\\""+hK+"\\" keyword not supported");}),cR.op_GreaterGreaterEquals(cR.kw("query"),function(hK){return be.FailWith("\\""+hK+"\\" keyword not supported");}),cR.op_GreaterGreaterEquals(function(hK){return bZ.oldProc(hK[0],hK[1]);},function(hK){return hI.$==0?cR.preturn({$:3,$0:hK}):hK.$==5?cR.preturn({$:3,$0:new fl({$:5,$0:bX.append(hK.$0,hI)})}):cR.preturn({$:3,$0:new fl({$:5,$0:new bY({$:1,$0:hK,$1:hI})})});})]),function(hK){return hJ([hK[0],hK[1]]);})),ea.to_syntax);};bZ.updateWithOldDirectives=function(hI,hJ,hK,hL){var hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0,h1,h2,h3;switch(hJ.$==1?(hM=[hJ.$1,hJ.$2,hJ.$0],0):hJ.$==2?1:hJ.$==3?2:hJ.$==4?3:hJ.$==5?4:hJ.$==6?5:hJ.$==7?6:hJ.$==8?7:hJ.$==9?8:hJ.$==10?9:hJ.$==11?10:hJ.$==12?11:hJ.$==13?12:hJ.$==14?13:hJ.$==15?14:hJ.$==16?15:hJ.$==17?16:hJ.$==18?17:hJ.$==19?18:hJ.$==20?19:hJ.$==21?20:hJ.$==22?21:hJ.$==23?22:hJ.$==24?23:hJ.$==25?24:hJ.$==26?25:hJ.$==27?26:hJ.$==28?27:hJ.$==29?28:hJ.$==30?29:hJ.$==31?30:hJ.$==32?31:hJ.$==33?32:(hM=[hJ.$1,hJ.$2,hJ.$0],0)){case 0:return bZ.c1(Y.New((hN=hK.simulation,hO=bZ.fromOpt(hM[1],hK.simulation.points),bx.New(hN.name,bZ.fromOpt(hM[2],hK.simulation.initial),bZ.fromOpt(hM[0],hK.simulation["final"]),hO,hN.plots,hN.plotcolours,hN.seed,hN.kinetics,hN.times,hN.prune,hN.multicore,hN.data,hN.sweeps)),hK.simulations,hK.stochastic,hK.deterministic,hK.spatial,hK.inference,hK.moment_closure,hK.synthesis,hK.data,hK.units,hK.simulator,hK.parameters,hK.sweeps,hK.rates,hK.plot,hK.quiet));case 1:return bZ.c1(Y.New(hK.simulation,hK.simulations,(hP=hK.stochastic,v.New(hJ.$0,hP.steps,hP.trajectories,hP.stationary_skiptime)),hK.deterministic,hK.spatial,hK.inference,hK.moment_closure,hK.synthesis,hK.data,hK.units,hK.simulator,hK.parameters,hK.sweeps,hK.rates,hK.plot,hK.quiet));case 2:return bZ.c1(Y.New((hQ=hK.simulation,bx.New(hQ.name,hQ.initial,hQ["final"],hQ.points,bX.append(bX.map(bZ.oldToCrnPlot,hJ.$0),hK.simulation.plots),hQ.plotcolours,hQ.seed,hQ.kinetics,hQ.times,hQ.prune,hQ.multicore,hQ.data,hQ.sweeps)),hK.simulations,hK.stochastic,hK.deterministic,hK.spatial,hK.inference,hK.moment_closure,hK.synthesis,hK.data,hK.units,hK.simulator,hK.parameters,hK.sweeps,hK.rates,hK.plot,hK.quiet));case 3:hR=hJ.$0;return(hR.$==1?false:hR.$==2?false:hR.$==3?false:hR.$==4?false:hR.$==5?false:hR.$!=6)?bZ.c2(bR.set_is_jit(true,hL)):bZ.c1(Y.New(hK.simulation,hK.simulations,hK.stochastic,(hT=hK.deterministic,w.New(hR.$==6?hR.$0:hR.$==4?hR.$0:hR.$==5?hR.$0:hR.$==3?false:hR.$==1?false:hR.$==0?false:hR.$0,hT.abstolerance,hT.reltolerance)),hK.spatial,hK.inference,hK.moment_closure,hK.synthesis,hK.data,hK.units,hR.$==1?"SSA":hR.$==2?"Oslo":hR.$==3?"PDE":hR.$==4?"Sundials":hR.$==5?"CME":hR.$==6?"LNA":"SSA",hK.parameters,hK.sweeps,hK.rates,hK.plot,hK.quiet));case 4:return bZ.c1(Y.New(hK.simulation,hK.simulations,hK.stochastic,(hU=hK.deterministic,w.New(hU.stiff,hU.abstolerance,hJ.$0)),hK.spatial,hK.inference,hK.moment_closure,hK.synthesis,hK.data,hK.units,hK.simulator,hK.parameters,hK.sweeps,hK.rates,hK.plot,hK.quiet));case 5:return bZ.c1(Y.New(hK.simulation,hK.simulations,hK.stochastic,(hV=hK.deterministic,w.New(hV.stiff,hJ.$0,hV.reltolerance)),hK.spatial,hK.inference,hK.moment_closure,hK.synthesis,hK.data,hK.units,hK.simulator,hK.parameters,hK.sweeps,hK.rates,hK.plot,hK.quiet));case 6:return bZ.c1(Y.New((hW=hK.simulation,bx.New(hW.name,hW.initial,hW["final"],hW.points,hW.plots,hW.plotcolours,{$:1,$0:hJ.$0},hW.kinetics,hW.times,hW.prune,hW.multicore,hW.data,hW.sweeps)),hK.simulations,hK.stochastic,hK.deterministic,hK.spatial,hK.inference,hK.moment_closure,hK.synthesis,hK.data,hK.units,hK.simulator,hK.parameters,hK.sweeps,hK.rates,hK.plot,hK.quiet));case 7:return bZ.c3(hJ.$0);case 8:return be.FailWith("specMax not supported");case 9:return bZ.c1(hK);case 10:return bZ.c1(hK);case 11:return bZ.c1(Y.New(hK.simulation,hK.simulations,hK.stochastic,hK.deterministic,(hX=hK.spatial,G.New(hX.parameters,hX.diffusibles,hX.dimensions,hX.boundary,hX.xmax,hX.nx,hJ.$0,hX.default_diffusion,hX.random)),hK.inference,hK.moment_closure,hK.synthesis,hK.data,hK.units,hK.simulator,hK.parameters,hK.sweeps,hK.rates,hK.plot,hK.quiet));case 12:return bZ.c1(Y.New(hK.simulation,hK.simulations,hK.stochastic,hK.deterministic,(hY=hK.spatial,G.New(hY.parameters,hY.diffusibles,hY.dimensions,hY.boundary,hJ.$0,hY.nx,hY.dt,hY.default_diffusion,hY.random)),hK.inference,hK.moment_closure,hK.synthesis,hK.data,hK.units,hK.simulator,hK.parameters,hK.sweeps,hK.rates,hK.plot,hK.quiet));case 13:return bZ.c1(Y.New(hK.simulation,hK.simulations,hK.stochastic,hK.deterministic,(hZ=hK.spatial,G.New(hZ.parameters,hZ.diffusibles,hZ.dimensions,hZ.boundary,hZ.xmax,hJ.$0,hZ.dt,hZ.default_diffusion,hZ.random)),hK.inference,hK.moment_closure,hK.synthesis,hK.data,hK.units,hK.simulator,hK.parameters,hK.sweeps,hK.rates,hK.plot,hK.quiet));case 14:return be.FailWith("theta directive not supported in the spatial simulator");case 15:return be.FailWith("spatial initial concentration not supported");case 16:return bZ.c1(Y.New(hK.simulation,hK.simulations,hK.stochastic,hK.deterministic,(h0=hK.spatial,G.New(h0.parameters,h0.diffusibles,h0.dimensions,hJ.$0.$==1?"ZeroFlux":"Periodic",h0.xmax,h0.nx,h0.dt,h0.default_diffusion,h0.random)),hK.inference,hK.moment_closure,hK.synthesis,hK.data,hK.units,hK.simulator,hK.parameters,hK.sweeps,hK.rates,hK.plot,hK.quiet));case 17:return bZ.c1(Y.New((h1=hK.simulation,bx.New(h1.name,h1.initial,h1["final"],h1.points,new bY({$:1,$0:bZ.oldToCrnPlot({$:3,$0:hJ.$0}),$1:hK.simulation.plots}),h1.plotcolours,h1.seed,h1.kinetics,h1.times,h1.prune,h1.multicore,h1.data,h1.sweeps)),hK.simulations,hK.stochastic,hK.deterministic,hK.spatial,hK.inference,hK.moment_closure,hK.synthesis,hK.data,hK.units,hK.simulator,hK.parameters,hK.sweeps,hK.rates,hK.plot,hK.quiet));case 18:return be.FailWith("directive \\"diffusion\\" not supported");case 19:return be.FailWith("directive \\"default diffusion\\" not supported");case 20:return bZ.c1(Y.New(hK.simulation,hK.simulations,hK.stochastic,hK.deterministic,hK.spatial,hK.inference,hK.moment_closure,hK.synthesis,hK.data,hK.units,hK.simulator,bX.map(bZ.oldToCrnParam,hJ.$0),hK.sweeps,hK.rates,hK.plot,hK.quiet));case 21:return bZ.c1(Y.New(hK.simulation,hK.simulations,hK.stochastic,hK.deterministic,hK.spatial,hK.inference,hK.moment_closure,hK.synthesis,hK.data,hK.units,hK.simulator,hK.parameters,bX.map(function(h4){return bZ.oldToCrnSweep(hI,h4);},hJ.$0),hK.rates,hK.plot,hK.quiet));case 22:return be.FailWith("directive \\"fit\\" not supported ");case 23:return bZ.c1(Y.New(hK.simulation,hK.simulations,hK.stochastic,hK.deterministic,hK.spatial,co.fold(function(h4,h5){var h6;return h5.$==1?J.New(h4.name,h4.burnin,h5.$0,h4.thin,h4.noise_model,h4.noise_parameter,h4.prune,h4.seed,h4.seeds,h4.lowerbound,h4.timer,h4.partial_evaluation,h4.print_console,h4.print_summary):h5.$==2?J.New(h4.name,h4.burnin,h4.samples,h5.$0,h4.noise_model,h4.noise_parameter,h4.prune,h4.seed,h4.seeds,h4.lowerbound,h4.timer,h4.partial_evaluation,h4.print_console,h4.print_summary):h5.$==3?J.New(h4.name,h4.burnin,h4.samples,h4.thin,h4.noise_model,h5.$0?"Multiple":"Random",h4.prune,h4.seed,h4.seeds,h4.lowerbound,h4.timer,h4.partial_evaluation,h4.print_console,h4.print_summary):h5.$==4?(h6=h5.$0,J.New(h4.name,h4.burnin,h4.samples,h4.thin,h6===0?"Constant":h6===1?"Proportional":be.FailWith("Unrecognised noise model. Use linear or proportional."),h4.noise_parameter,h4.prune,h4.seed,h4.seeds,h4.lowerbound,h4.timer,h4.partial_evaluation,h4.print_console,h4.print_summary)):h5.$==5?J.New(h4.name,h4.burnin,h4.samples,h4.thin,h4.noise_model,h4.noise_parameter,h5.$0,h4.seed,h4.seeds,h4.lowerbound,h4.timer,h4.partial_evaluation,h4.print_console,h4.print_summary):J.New(h4.name,h5.$0,h4.samples,h4.thin,h4.noise_model,h4.noise_parameter,h4.prune,h4.seed,h4.seeds,h4.lowerbound,h4.timer,h4.partial_evaluation,h4.print_console,h4.print_summary);},hK.inference,hJ.$0),hK.moment_closure,hK.synthesis,hK.data,hK.units,hK.simulator,hK.parameters,hK.sweeps,hK.rates,hK.plot,hK.quiet));case 24:return be.FailWith("plot window not supported");case 25:h2=hJ.$0;return bZ.c1(Y.New((h3=hK.simulation,bx.New(h3.name,h3.initial,h3["final"],h3.points,h3.plots,h3.plotcolours,h3.seed,h2.$==1?"Stochastic":h2.$==2?"Deterministic":"Contextual",h3.times,h3.prune,h3.multicore,h3.data,h3.sweeps)),hK.simulations,hK.stochastic,hK.deterministic,hK.spatial,hK.inference,hK.moment_closure,hK.synthesis,hK.data,hK.units,hK.simulator,hK.parameters,hK.sweeps,hK.rates,hK.plot,hK.quiet));case 26:return be.FailWith("directive \\"verification\\" not supported");case 27:return bZ.c2(bR.setStabilityCorrection(hJ.$0,hL));case 28:return bZ.c2(bR.setCoaxialDangle(hJ.$0,hL));case 29:return bZ.c2(bR.setDoubleCoaxialDangle(hJ.$0,hL));case 30:return bZ.c2(bR.setCoaxialCorrection(hJ.$0,hL));case 31:return bZ.c2(bR.setTemperature(hL,hJ.$0));case 32:return bZ.c2(bR.setTerminalDangleFactor(hL,hJ.$0));}};bZ.op_AmpGreater=function(hI,hJ){return ea.op_AmpGreater(hI,hJ);};bZ.pValOrTuple=function(){fj.$cctor();return fj.pValOrTuple;};bZ.oldProc=function(hI,hJ){var hK;hK=bq.parse(bZ.pOldSpecies());return(cR.choice(bX.ofArray([cR.op_BarGreaterGreater(bZ.op_AmpGreater("new",cR.op_PlusGreaterGreaterPlus(ea.restriction(),function(hL){return bZ.oldProc(hL[0],hL[1]);})),function(hL){return new fl({$:6,$0:hL[0],$1:hL[1]});}),cR.op_GreaterGreaterDot(cR.kw("rxn"),bZ.pReact(hK)),cR.pTry(cR.op_BarTwiddleGreater(bZ.op_AmpGreater("constant",bZ.pOldSpecies()),function(hL,hM){return new fl({$:0,$0:{$:1,$0:1,$1:ea.to_range(hL[0],hL[1])},$1:true,$2:hM,$3:null,$4:null});})),cR.pTry(cR.op_LessQmarkGreater(cR.op_BarTwiddleGreater(cR.op_PlusGreaterGreaterPlus(ea.before("constant",bZ.pOldValue()),cR.op_GreaterGreaterDot(cR.op_LessBarGreater(cR.kw("*"),cR.kw("of")),ea.before("constant",bZ.pOldSpecies()))),function(hL,hM){var hN,hO;hN=hM[0];hO=hM[1];return new fl({$:0,$0:hN[1],$1:hN[0]||hO[0],$2:hO[1],$3:null,$4:null});}),"species initialization")),cR.pTry(bZ.pOldSpecies()),cR.pTry(bZ.pReact(hK)),cR.op_BarGreaterGreater(cR.paren(ea.sep_by_bars(function(hL){return bZ.oldProc(hL[0],hL[1]);})),function(hL){return new fl({$:5,$0:hL});})])))([hI,hJ]);};bZ.c1=function(hI){return{$:0,$0:hI};};bZ.fromOpt=function(hI,hJ){return hI!=null&&hI.$==1?hI.$0:hJ;};bZ.oldToCrnPlot=function(hI){var hJ,hK;return hI.$==1?{$:0,$0:{$:0,$0:hI.$0}}:hI.$==2?{$:0,$0:{$:0,$0:hI.$0}}:hI.$==3?{$:0,$0:{$:1,$0:hI.$0}}:hI.$==4?{$:0,$0:{$:1,$0:hI.$0}}:hI.$==5?(hJ=hI.$1,{$:0,$0:{$:2,$0:hI.$0,$1:hJ.$==1&&(hJ.$0.$==12&&(hJ.$0.$0.$==1&&(hJ.$0.$0.$0.$==7&&(hJ.$0.$0.$0.$0==="_"&&(hJ.$0.$0.$1.$==0&&hJ.$1.$==0)))))?f5.All:{$:1,$0:hJ}}}):hI.$==6?{$:0,$0:{$:2,$0:hI.$0,$1:{$:1,$0:hI.$1}}}:hI.$==7?{$:5,$0:bX.map(bZ.oldToCrnPlot,hI.$0)}:hI.$==8?{$:6,$0:bu.New(bZ.oldToCrnPlot(hI.$0),bZ.oldToCrnPlot(hI.$1))}:hI.$==9?{$:7,$0:bZ.oldToCrnPlot({$:8,$0:hI.$0,$1:hI.$1})}:hI.$==10?{$:2,$0:bX.map(bZ.oldToCrnPlot,hI.$0)}:hI.$==11?{$:3,$0:bw.New(bZ.oldToCrnPlot(hI.$0),bZ.oldToCrnPlot(hI.$1))}:{$:1,$0:hI.$0};};bZ.c2=function(hI){return{$:1,$0:hI};};bZ.c3=function(hI){return{$:2,$0:hI};};bZ.oldToCrnParam=function(hI){var hJ;return hI.$==1?(hJ=hI.$5,F.create$1(hI.$0,hI.$3,{$:1,$0:E.New(hI.$4.$==1?"Log":"Real",new C({$:0,$0:B.New(hI.$1,hI.$2)}),hJ.$==1?"Random":hJ.$==2?"Initial":"Fixed")})):F.create$1(hI.$0,hI.$3,{$:1,$0:E.New("Real",new C({$:0,$0:B.New(hI.$1,hI.$2)}),"Fixed")});};bZ.oldToCrnSweep=function(hI,hJ){return hJ.$==0?W.create$6(hJ.$0,bX.map(bZ.oldToCrnSweepVar,hJ.$1)):W.create$6(hI(),bX.ofArray([bZ.oldToCrnSweepVar(hJ.$0)]));};bZ.pOldVal=function(hI,hJ){var hK;return(br.parse((hK=cR.choice([cR.op_GreaterGreaterEquals(cR.kw("float_of_int"),function(){return be.FailWith(bZ.fpMsg());}),cR.op_GreaterGreaterEquals(cR.kw("int_of_float"),function(){return be.FailWith(bZ.fpMsg());}),cR.pTry(cR.op_GreaterGreaterEquals(cR.op_DotGreaterGreater(ea.parse_name(),cR.spaces()),function(hL){return cR.op_LessBarGreater(cR.op_GreaterGreaterDot(cR.kw("("),cR.failParser("")),cR.preturn(hL));}))]),function(hL){return hK([hL[0],hL[1]]);})))([hI,hJ]);};bZ.pMolecule=function(hI,hJ){var hK,hL,hM,hN,hO,hP,hQ,hR;function hS(hU,hV){var hW,hX,hY,hZ;hW=cR.choice([cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(cR.kw("{"),hK),function(h0){var h1,h2,h3,h4,h5;h1=cR.choice([cR.op_GreaterGreaterDot(cR.kw(">"),cR.preturn(ea.mk_hpr(hU[0],hU[1],hV,h0))),cR.op_GreaterGreaterEquals(cR.op_DotGreaterGreaterDot(cR.op_GreaterGreaterDot(cR.kw("}"),cR.preturn(h0)),cR.op_LessBarGreater(hL,cR.preturn(bY.Empty))),(h2=(h3=(h4=hU[0],(h5=hU[1],function(h6){return ea.mk_m(h4,h5,hV,h6[0],h6[1]);})),function(h6){return h3(bZ.flip.apply(null,h6));}),function(h6){return cR.preturn(h2(h6));}))]);return function(h6){return h1([h6[0],h6[1]]);};}),cR.op_GreaterGreaterEquals(cR.op_DotGreaterGreaterDot(hL,cR.op_LessBarGreater(hM,cR.preturn(bY.Empty))),(hX=(hY=hU[0],(hZ=hU[1],function(h0){return ea.mk_m(hY,hZ,hV,h0[0],h0[1]);})),function(h0){return cR.preturn(hX(h0));})),cR.preturn(ea.mk_m(hU[0],hU[1],hV,bY.Empty,bY.Empty))]);return function(h0){return hW([h0[0],h0[1]]);};}function hT(hU,hV){return hU.$==0?hV.$==0?cR.failParser("a strand"):cR.preturn({$:1,$0:hV}):hV.$==0?cR.preturn({$:0,$0:hU}):cR.failParser("a strand");}hK=cR.many1(ea.parse_site(true,ea.parse_name()));hL=(cR.bracket("<",">"))(hK);hM=(cR.bracket("{","}"))(hK);hN=(cR.bracket("[","]"))(hK);hO=(hP=cR.choice([cR.op_DotGreaterGreaterDot(hL,cR.op_LessBarGreater(hM,cR.preturn(bY.Empty))),cR.op_GreaterGreaterEquals(cR.op_DotGreaterGreaterDot(hM,cR.op_LessBarGreater(hL,cR.preturn(bY.Empty))),function(hU){return cR.preturn([hU[1],hU[0]]);}),cR.preturn([bY.Empty,bY.Empty])]),function(hU){return hP([hU[0],hU[1]]);});hQ=cR.op_BarTwiddleGreater((hR=cR.choice([cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(cR.kw("<"),hK),function(hU){var hV;function hW(hX){return{$:1,$0:hX};}hV=cR.choice([cR.op_GreaterGreaterDot(cR.kw("}"),cR.preturn({$:0,$0:hU})),cR.op_GreaterGreaterEquals(cR.op_DotGreaterGreaterDot(cR.op_GreaterGreaterDot(cR.kw(">"),cR.preturn(hU)),cR.op_LessBarGreater(hM,cR.preturn(bY.Empty))),function(hX){return cR.preturn(hW(hX));})]);return function(hX){return hV([hX[0],hX[1]]);};}),function(hU){var hV;hV=cR.choice([cR.op_GreaterGreaterEquals(hN,function(hW){var hX,hY;function hZ(h2){return{$:2,$0:h2};}function h0(h2,h3){return ea.mk_hpl(hX,hW,h2,h3);}function h1(h2){return{$:2,$0:h2};}return hU.$==1?cR.op_GreaterGreaterEquals(hS(hU.$0,hW),function(h2){return cR.preturn(hZ(h2));}):(hX=hU.$0,cR.op_GreaterGreaterEquals(hO,(hY=function(h2){return h1(h0.apply(null,h2));},function(h2){return cR.preturn(hY(h2));})));}),hU.$==1?hT.apply(null,hU.$0):cR.failParser("a strand")]);return function(hW){return hV([hW[0],hW[1]]);};}),cR.op_GreaterGreaterEquals(hO,function(hU){var hV;hV=cR.choice([cR.op_GreaterGreaterEquals(hN,function(hW){function hX(hY){return{$:2,$0:hY};}return cR.op_GreaterGreaterEquals(hS.apply(null,[hU,hW]),function(hY){return cR.preturn(hX(hY));});}),hT.apply(null,hU)]);return function(hW){return hV([hW[0],hW[1]]);};})]),function(hU){return hR([hU[0],hU[1]]);}),function(hU,hV){return(function(hW){var hX,hY;hX=hW[0];hY=hW[1];return function(hZ){return ea.to_species(hX,hY,hZ);};}(hU))(hV);});return cR.op_BarTwiddleGreater(cR.op_DotGreaterGreaterDot(hQ,cR.many(cR.op_DotGreaterGreaterDot(cR.op_LessBarGreater(hI,hJ),hQ))),function(hU,hV){return cN.convert_raw_gate([hV[0],hV[1],ea.to_range(hU[0],hU[1])]);});};bZ.pOldVals=function(hI,hJ){return(ea.tuple(cR.op_LessBarGreater(bZ.pOldValue(),cR.op_BarTwiddleGreater(function(hK){return bZ.pOldVals(hK[0],hK[1]);},function(hK,hL){return{$:12,$0:hL,$1:ea.to_range(hK[0],hK[1])};}))))([hI,hJ]);};bZ.parseOldMolecule=function(){fj.$cctor();return fj.parseOldMolecule;};bZ.parseOldGroundSpecies=function(){fj.$cctor();return fj.parseOldGroundSpecies;};bZ.pOldValue=function(){fj.$cctor();return fj.pOldValue;};bZ.SAMPLE=function(){fj.$cctor();return fj.SAMPLE;};bZ.spFloat=function(){fj.$cctor();return fj.spFloat;};bZ.COMMA=function(){fj.$cctor();return fj.COMMA;};bZ.ALL=function(){fj.$cctor();return fj.ALL;};bZ.spInt=function(){fj.$cctor();return fj.spInt;};bZ.DURATION=function(){fj.$cctor();return fj.DURATION;};bZ.POINTS=function(){fj.$cctor();return fj.POINTS;};bZ.SEED=function(){fj.$cctor();return fj.SEED;};bZ.PLOT=function(){fj.$cctor();return fj.PLOT;};bZ.pPlots=function(hI,hJ){return(cR.sepBy1(function(hK){return bZ.pPlot(hK[0],hK[1]);},bZ.SEMI()))([hI,hJ]);};bZ.DLBRACKET=function(){fj.$cctor();return fj.DLBRACKET;};bZ.DRBRACKET=function(){fj.$cctor();return fj.DRBRACKET;};bZ.pMol=function(){fj.$cctor();return fj.pMol;};bZ.BAR=function(){fj.$cctor();return fj.BAR;};bZ.pOrigami=function(){fj.$cctor();return fj.pOrigami;};bZ.EVENT=function(){fj.$cctor();return fj.EVENT;};bZ.pEvent=function(){fj.$cctor();return fj.pEvent;};bZ.AT=function(){fj.$cctor();return fj.AT;};bZ.SPECMAX=function(){fj.$cctor();return fj.SPECMAX;};bZ.TIME=function(){fj.$cctor();return fj.TIME;};bZ.CONCENTRATION=function(){fj.$cctor();return fj.CONCENTRATION;};bZ.RELTOLERANCE=function(){fj.$cctor();return fj.RELTOLERANCE;};bZ.TOLERANCE=function(){fj.$cctor();return fj.TOLERANCE;};bZ.SCALE=function(){fj.$cctor();return fj.SCALE;};bZ.SIMULATION=function(){fj.$cctor();return fj.SIMULATION;};bZ.DT=function(){fj.$cctor();return fj.DT;};bZ.XMAX=function(){fj.$cctor();return fj.XMAX;};bZ.NX=function(){fj.$cctor();return fj.NX;};bZ.THETA=function(){fj.$cctor();return fj.THETA;};bZ.coreElem=function(hI,hJ){function hK(hN){return{$:0,$0:hN};}function hL(hN){return{$:1,$0:hN};}function hM(hN){return{$:2,$0:hN};}return(cR.choice([cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(cR.kw("width"),bZ.spFloat()),function(hN){return cR.preturn(hK(hN));}),cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(cR.kw("inner"),bZ.spFloat()),function(hN){return cR.preturn(hL(hN));}),cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(cR.kw("outer"),bZ.spFloat()),function(hN){return cR.preturn(hM(hN));}),cR.op_GreaterGreaterDot(cR.kw("species"),be.FailWith("species not supported in Spatial settings, Core"))]))([hI,hJ]);};bZ.SEMI=function(){fj.$cctor();return fj.SEMI;};bZ.pointElem=function(hI,hJ){function hK(hO){return{$:0,$0:hO};}function hL(hO){return{$:1,$0:hO};}function hM(hO){return{$:2,$0:hO};}function hN(hO){return{$:3,$0:hO};}return(cR.choice([cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(cR.kw("x"),bZ.spFloat()),function(hO){return cR.preturn(hK(hO));}),cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(cR.kw("y"),bZ.spFloat()),function(hO){return cR.preturn(hL(hO));}),cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(cR.kw("width"),bZ.spFloat()),function(hO){return cR.preturn(hM(hO));}),cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(cR.kw("value"),bZ.spFloat()),function(hO){return cR.preturn(hN(hO));}),cR.op_GreaterGreaterDot(cR.kw("species"),be.FailWith("species not supported in Spatial settings, Point"))]))([hI,hJ]);};bZ.SPATIALIC=function(){fj.$cctor();return fj.SPATIALIC;};bZ.speciesParser=function(hI,hJ){return(ea.speciesParser())([hI,hJ]);};bZ.coreRecord=function(){fj.$cctor();return fj.coreRecord;};bZ.pointRecord=function(){fj.$cctor();return fj.pointRecord;};bZ.SPATIALBC=function(){fj.$cctor();return fj.SPATIALBC;};bZ.SPATIALPLOT=function(){fj.$cctor();return fj.SPATIALPLOT;};bZ.DIFFUSION=function(){fj.$cctor();return fj.DIFFUSION;};bZ.DEFAULTDIFFUSION=function(){fj.$cctor();return fj.DEFAULTDIFFUSION;};bZ.spName=function(){fj.$cctor();return fj.spName;};bZ.EQUAL=function(){fj.$cctor();return fj.EQUAL;};bZ.PARAMETERS=function(){fj.$cctor();return fj.PARAMETERS;};bZ.paramP=function(){fj.$cctor();return fj.paramP;};bZ.valList=function(){fj.$cctor();return fj.valList;};bZ.valListP=function(){fj.$cctor();return fj.valListP;};bZ.namesList=function(){fj.$cctor();return fj.namesList;};bZ.valTuples=function(){fj.$cctor();return fj.valTuples;};bZ.valList1=function(){fj.$cctor();return fj.valList1;};bZ.varSweep=function(){fj.$cctor();return fj.varSweep;};bZ.SWEEP=function(){fj.$cctor();return fj.SWEEP;};bZ.combSweep=function(){fj.$cctor();return fj.combSweep;};bZ.FIT=function(){fj.$cctor();return fj.FIT;};bZ.pPlot=function(hI,hJ){function hK(hR){return bX.ofArray([{$:12,$0:bX.ofArray([{$:7,$0:"_",$1:hR}]),$1:hR}]);}function hL(hR){return{$:0,$0:hR};}function hM(hR){return{$:7,$0:hR};}function hN(hR,hS){return{$:8,$0:hR,$1:hS};}function hO(hR,hS){return{$:9,$0:hR,$1:hS};}function hP(hR){return{$:10,$0:hR};}function hQ(hR,hS){return{$:11,$0:hR,$1:hS};}return(cR.choice([cR.op_GreaterGreaterEquals(bZ.spFloat(),function(hR){return cR.preturn(hL(hR));}),cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(bZ.SUM(),cR.paren(cR.many1(function(hR){return bZ.pPlot(hR[0],hR[1]);}))),function(hR){return cR.preturn(hM(hR));}),cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(bZ.SUB(),cR.paren(cR.op_DotGreaterGreaterDot(cR.op_DotGreaterGreater(function(hR){return bZ.pPlot(hR[0],hR[1]);},bZ.SEMI()),function(hR){return bZ.pPlot(hR[0],hR[1]);}))),function(hR){return cR.preturn(hN.apply(null,hR));}),cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(bZ.DIFF(),cR.paren(cR.op_DotGreaterGreaterDot(cR.op_DotGreaterGreater(function(hR){return bZ.pPlot(hR[0],hR[1]);},bZ.SEMI()),function(hR){return bZ.pPlot(hR[0],hR[1]);}))),function(hR){return cR.preturn(hO.apply(null,hR));}),cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(bZ.PROD(),cR.paren(cR.many1(function(hR){return bZ.pPlot(hR[0],hR[1]);}))),function(hR){return cR.preturn(hP(hR));}),cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(bZ.DIV(),cR.paren(cR.op_DotGreaterGreaterDot(cR.op_DotGreaterGreater(function(hR){return bZ.pPlot(hR[0],hR[1]);},bZ.SEMI()),function(hR){return bZ.pPlot(hR[0],hR[1]);}))),function(hR){return cR.preturn(hQ.apply(null,hR));}),cR.op_GreaterGreaterEquals(bZ.pMol(),function(hR){var hS;hS=cR.choice([cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(bZ.AT(),cR.paren(bZ.spFloat())),function(hT){return cR.preturn({$:4,$0:hR,$1:hT});}),cR.preturn({$:3,$0:hR})]);return function(hT){return hS([hT[0],hT[1]]);};}),cR.op_GreaterGreaterEquals(bZ.spName(),function(hR){var hS,hT;hS=cR.choice([cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(bZ.AT(),cR.paren(bZ.spFloat())),function(hU){return cR.preturn({$:2,$0:hR,$1:hU});}),cR.op_GreaterGreaterDot(bZ.UNDERSCORE(),(hT=cR.choice([cR.op_BarTwiddleGreater(cR.op_GreaterGreaterDot(bZ.AT(),cR.paren(bZ.spFloat())),function(hU,hV){return{$:6,$0:hR,$1:hK(ea.to_range(hU[0],hU[1])),$2:hV};}),cR.op_BarTwiddleGreater(cR.preturn(),function(hU){return{$:5,$0:hR,$1:hK(ea.to_range(hU[0],hU[1]))};})]),function(hU){return hT([hU[0],hU[1]]);})),cR.op_GreaterGreaterEquals(cR.paren(cR.many(cT.parse())),function(hU){var hV;hV=cR.choice([cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(bZ.AT(),cR.paren(bZ.spFloat())),function(hW){return cR.preturn({$:6,$0:hR,$1:hU,$2:hW});}),cR.preturn({$:5,$0:hR,$1:hU})]);return function(hW){return hV([hW[0],hW[1]]);};}),cR.preturn({$:1,$0:hR})]);return function(hU){return hS([hU[0],hU[1]]);};})]))([hI,hJ]);};bZ.spBool=function(){fj.$cctor();return fj.spBool;};bZ.fitElem=function(){fj.$cctor();return fj.fitElem;};bZ.PLOTWINDOW=function(){fj.$cctor();return fj.PLOTWINDOW;};bZ.KINETICS=function(){fj.$cctor();return fj.KINETICS;};bZ.VERIFICATION=function(){fj.$cctor();return fj.VERIFICATION;};bZ.STABILITYCORRECTION=function(){fj.$cctor();return fj.STABILITYCORRECTION;};bZ.COAXIALDANGLE=function(){fj.$cctor();return fj.COAXIALDANGLE;};bZ.DOUBLECOAXIALDANGLE=function(){fj.$cctor();return fj.DOUBLECOAXIALDANGLE;};bZ.COAXIALCORRECTION=function(){fj.$cctor();return fj.COAXIALCORRECTION;};bZ.TEMPERATURE=function(){fj.$cctor();return fj.TEMPERATURE;};bZ.TERMINALDANGLE=function(){fj.$cctor();return fj.TERMINALDANGLE;};bZ.dirCoaxialCorrection=function(){fj.$cctor();return fj.dirCoaxialCorrection;};bZ.dirCoaxialDAngle=function(){fj.$cctor();return fj.dirCoaxialDAngle;};bZ.dirConcentration=function(){fj.$cctor();return fj.dirConcentration;};bZ.dirDT=function(){fj.$cctor();return fj.dirDT;};bZ.dirDefaultDiffusion=function(){fj.$cctor();return fj.dirDefaultDiffusion;};bZ.dirDiffusion=function(){fj.$cctor();return fj.dirDiffusion;};bZ.dirDoubleCoaxialDangle=function(){fj.$cctor();return fj.dirDoubleCoaxialDangle;};bZ.dirDuration=function(){fj.$cctor();return fj.dirDuration;};bZ.dirEvents=function(){fj.$cctor();return fj.dirEvents;};bZ.dirFitRun=function(hI,hJ){function hK(hL){return{$:24,$0:hL};}return(cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(bZ.FITRUN(),bZ.fitRecord()),function(hL){return cR.preturn(hK(hL));}))([hI,hJ]);};bZ.dirFit=function(){fj.$cctor();return fj.dirFit;};bZ.dirKinectics=function(){fj.$cctor();return fj.dirKinectics;};bZ.dirNX=function(){fj.$cctor();return fj.dirNX;};bZ.dirParameters=function(){fj.$cctor();return fj.dirParameters;};bZ.dirPlot=function(){fj.$cctor();return fj.dirPlot;};bZ.dirPlotWindow=function(){fj.$cctor();return fj.dirPlotWindow;};bZ.dirRelativeTolerance=function(){fj.$cctor();return fj.dirRelativeTolerance;};bZ.dirSamples=function(){fj.$cctor();return fj.dirSamples;};bZ.dirScale=function(){fj.$cctor();return fj.dirScale;};bZ.dirSeed=function(){fj.$cctor();return fj.dirSeed;};bZ.dirSimulation=function(){fj.$cctor();return fj.dirSimulation;};bZ.dirSpatialbc=function(){fj.$cctor();return fj.dirSpatialbc;};bZ.dirSpatialic=function(){fj.$cctor();return fj.dirSpatialic;};bZ.dirSpatialPlot=function(){fj.$cctor();return fj.dirSpatialPlot;};bZ.dirSpecMax=function(){fj.$cctor();return fj.dirSpecMax;};bZ.dirStabilityCorrection=function(){fj.$cctor();return fj.dirStabilityCorrection;};bZ.dirSweep=function(){fj.$cctor();return fj.dirSweep;};bZ.dirTemperature=function(){fj.$cctor();return fj.dirTemperature;};bZ.dirTerminalDAngle=function(){fj.$cctor();return fj.dirTerminalDAngle;};bZ.dirTheta=function(){fj.$cctor();return fj.dirTheta;};bZ.dirTime=function(){fj.$cctor();return fj.dirTime;};bZ.dirTolerance=function(){fj.$cctor();return fj.dirTolerance;};bZ.dirVerification=function(){fj.$cctor();return fj.dirVerification;};bZ.dirXMax=function(){fj.$cctor();return fj.dirXMax;};bZ.pOldDirectives=function(){fj.$cctor();return fj.pOldDirectives;};bZ.pOldSpecies=function(){fj.$cctor();return fj.pOldSpecies;};bZ.pReact=function(hI){return cR.op_BarTwiddleGreater(_2.parse(bZ.pOldSpecies(),br.parse(ea.parse_name()),br.parse(hI),{$:1,$0:1}),function(hJ,hK){return(function(hL){function hM(hO){return ea.to_dsd_reaction(hL,hO);}function hN(hO){return new fl({$:7,$0:hO});}return function(hO){return hN(hM(hO));};}(hJ))(hK);});};bZ.oldToCrnSweepVar=function(hI){return V.create$5(hI.$0,bX.map(function(hJ){return bX.map(cT.to_engineValue,hJ);},hI.$1));};bZ.fpMsg=function(){fj.$cctor();return fj.fpMsg;};bZ.flip=function(hI,hJ){return[hJ,hI];};bZ.SUM=function(){fj.$cctor();return fj.SUM;};bZ.SUB=function(){fj.$cctor();return fj.SUB;};bZ.DIFF=function(){fj.$cctor();return fj.DIFF;};bZ.PROD=function(){fj.$cctor();return fj.PROD;};bZ.DIV=function(){fj.$cctor();return fj.DIV;};bZ.UNDERSCORE=function(){fj.$cctor();return fj.UNDERSCORE;};bZ.FITRUN=function(){fj.$cctor();return fj.FITRUN;};bZ.fitRecord=function(){fj.$cctor();return fj.fitRecord;};b0.New=function(hI,hJ){return{jit:hI,calculus:hJ};};b1=bb.Obj=hB.Class({Equals:function(hI){return this===hI;},GetHashCode:function(){return -1;}},null,b1);b1.New=hB.Ctor(function(){},b1);b2.j$58=function(){return b2._v$58?b2._v$58:b2._v$58=(bd.EncodeRecord(void 0,[["rules",b2.j$59,0],["leaks",bd.Id(),0],["pin_leaks",bd.Id(),0],["polymers",bd.Id(),0],["unproductive",bd.Id(),0],["sequence_rates",bd.Id(),0],["temperature",bd.Id(),0],["stabilityCorrection",bd.Id(),0],["coaxialDangle",bd.Id(),0],["doubleCoaxialDangle",bd.Id(),0],["terminalDangleFactor",bd.Id(),0],["coaxialCorrection",b2.j$17,0],["declare_domains",bd.Id(),0],["check_dna",bd.Id(),0],["colour_toeholds",bd.Id(),0],["program",bd.Id(),0],["toeholds",bd.Id(),0],["specificities",bd.Id(),0],["plot_names",bd.Id(),0],["state_images",bd.Id(),0],["toehold_bind_rate",bd.Id(),0],["toehold_unbind_rate",bd.Id(),0],["leak_rate_l",b2.j$17,0],["leak_rate_w",b2.j$17,0],["pinleak_rate",b2.j$17,1],["tau_rate",b2.j$17,0],["elementary_migration_rate",b2.j$17,0],["toehold_length",bd.Id(),0],["specificity_length",bd.Id(),0],["local_concentrations",bd.EncodeList(bd.EncodeTuple([bd.Id(),b2.j$17])),0],["generate_predicates",b2.j$60,0],["rendering",b2.j$61,0],["is_jit",bd.Id(),0],["rulesProgram",bd.EncodeArrayMap(bd.EncodeTuple([bd.Id(),bd.Id()]),bd.EncodeSet(b2.j$65)),1]]))();};b2.j$78=function(){return b2._v$78?b2._v$78:b2._v$78=(bd.EncodeRecord(r,[["task",b2.j$79,1],["nodes",bd.EncodeStringMap(b2.j),0],["edges",bd.EncodeStringMap(bd.EncodeList(b2.j$81)),0],["expanded",bd.Id(),0]]))();};b3.j$1=function(){return b3._v$1?b3._v$1:b3._v$1=(bd.DecodeRecord(void 0,[["rules",b3.j$2,0],["leaks",bd.Id(),0],["pin_leaks",bd.Id(),0],["polymers",bd.Id(),0],["unproductive",bd.Id(),0],["sequence_rates",bd.Id(),0],["temperature",bd.Id(),0],["stabilityCorrection",bd.Id(),0],["coaxialDangle",bd.Id(),0],["doubleCoaxialDangle",bd.Id(),0],["terminalDangleFactor",bd.Id(),0],["coaxialCorrection",b3.j$3,0],["declare_domains",bd.Id(),0],["check_dna",bd.Id(),0],["colour_toeholds",bd.Id(),0],["program",bd.Id(),0],["toeholds",bd.Id(),0],["specificities",bd.Id(),0],["plot_names",bd.Id(),0],["state_images",bd.Id(),0],["toehold_bind_rate",bd.Id(),0],["toehold_unbind_rate",bd.Id(),0],["leak_rate_l",b3.j$3,0],["leak_rate_w",b3.j$3,0],["pinleak_rate",b3.j$3,1],["tau_rate",b3.j$3,0],["elementary_migration_rate",b3.j$3,0],["toehold_length",bd.Id(),0],["specificity_length",bd.Id(),0],["local_concentrations",bd.DecodeList(bd.DecodeTuple([bd.Id(),b3.j$3])),0],["generate_predicates",b3.j$9,0],["rendering",b3.j$10,0],["is_jit",bd.Id(),0],["rulesProgram",bd.DecodeArrayMap(bd.DecodeTuple([bd.Id(),bd.Id()]),bd.DecodeSet(b3.j$14)),1]]))();};b3.j$27=function(){return b3._v$27?b3._v$27:b3._v$27=(bd.DecodeRecord(r,[["task",b3.j$28,1],["nodes",bd.DecodeStringMap(b3.j$30),0],["edges",bd.DecodeStringMap(bd.DecodeList(b3.j$82)),0],["expanded",bd.Id(),0]]))();};b2.j=function(){return b2._v?b2._v:b2._v=(bd.EncodeRecord($,[["top",b2.j$1,0],["systems",bd.EncodeList(b2.j$1),0]]))();};b2.j$59=function(){return b2._v$59?b2._v$59:b2._v$59=(bd.EncodeUnion(void 0,"$",[null,null,null,null]))();};b2.j$17=function(){return b2._v$17?b2._v$17:b2._v$17=(bd.EncodeUnion(void 0,{Item1:13,Round:12,Floor:11,Ceiling:10,Modulo:9,Log:8,Absolute:7,Minus:6,Plus:5,Power:4,Divide:3,Times:2,Float:1,Key:0},[["Key",[["$0","Key",bd.Id(),0]]],["Float",[["$0","Float",bd.Id(),0]]],["Times",[["$0","Times",bd.EncodeList(b2.j$17),0]]],["Divide",[["$0","Divide",b2.j$22,0]]],["Power",[["$0","Power",b2.j$21,0]]],["Plus",[["$0","Plus",bd.EncodeList(b2.j$17),0]]],["Minus",[["$0","Minus",b2.j$20,0]]],["Absolute",[["$0","Absolute",b2.j$17,0]]],["Log",[["$0","Log",b2.j$17,0]]],["Modulo",[["$0","Modulo",b2.j$19,0]]],["Ceiling",[["$0","Ceiling",b2.j$17,0]]],["Floor",[["$0","Floor",b2.j$17,0]]],["Round",[["$0","Round",b2.j$17,0]]],["If",[["$0","Item1",b2.j$18,0],["$1","Item2",b2.j$17,0],["$2","Item3",b2.j$17,0]]]]))();};b2.j$60=function(){return b2._v$60?b2._v$60:b2._v$60=(bd.EncodeUnion(void 0,"$",[null,null]))();};b2.j$61=function(){return b2._v$61?b2._v$61:b2._v$61=(bd.EncodeRecord(void 0,[["renderer",b2.j$62,0],["mode",b2.j$63,0],["rotate_labels",bd.Id(),0],["arrange",b2.j$64,0]]))();};b2.j$65=function(){return b2._v$65?b2._v$65:b2._v$65=(bd.EncodeRecord(ci,[["head",b2.j$76,0],["body",bd.EncodeList(b2.j$77),0]]))();};b2.j$79=function(){return b2._v$79?b2._v$79:b2._v$79=(bd.EncodeRecord(l,[["task_type",b2.j$80,1],["copies",bd.Id(),0],["copy_id",bd.Id(),0],["nodes",bd.Id(),0]]))();};b2.j$81=function(){return b2._v$81?b2._v$81:b2._v$81=(bd.EncodeRecord(void 0,[["location",b2.j$82,0],["parameters",bd.EncodeList(b2.j$83),0]]))();};b3.j$2=function(){return b3._v$2?b3._v$2:b3._v$2=(bd.DecodeUnion(void 0,"$",[null,null,null,null]))();};b3.j$3=function(){return b3._v$3?b3._v$3:b3._v$3=(bd.DecodeUnion(void 0,{Item1:13,Round:12,Floor:11,Ceiling:10,Modulo:9,Log:8,Absolute:7,Minus:6,Plus:5,Power:4,Divide:3,Times:2,Float:1,Key:0},[["Key",[["$0","Key",bd.Id(),0]]],["Float",[["$0","Float",bd.Id(),0]]],["Times",[["$0","Times",bd.DecodeList(b3.j$3),0]]],["Divide",[["$0","Divide",b3.j$8,0]]],["Power",[["$0","Power",b3.j$7,0]]],["Plus",[["$0","Plus",bd.DecodeList(b3.j$3),0]]],["Minus",[["$0","Minus",b3.j$6,0]]],["Absolute",[["$0","Absolute",b3.j$3,0]]],["Log",[["$0","Log",b3.j$3,0]]],["Modulo",[["$0","Modulo",b3.j$5,0]]],["Ceiling",[["$0","Ceiling",b3.j$3,0]]],["Floor",[["$0","Floor",b3.j$3,0]]],["Round",[["$0","Round",b3.j$3,0]]],["If",[["$0","Item1",b3.j$4,0],["$1","Item2",b3.j$3,0],["$2","Item3",b3.j$3,0]]]]))();};b3.j$9=function(){return b3._v$9?b3._v$9:b3._v$9=(bd.DecodeUnion(void 0,"$",[null,null]))();};b3.j$10=function(){return b3._v$10?b3._v$10:b3._v$10=(bd.DecodeRecord(void 0,[["renderer",b3.j$11,0],["mode",b3.j$12,0],["rotate_labels",bd.Id(),0],["arrange",b3.j$13,0]]))();};b3.j$14=function(){return b3._v$14?b3._v$14:b3._v$14=(bd.DecodeRecord(ci,[["head",b3.j$25,0],["body",bd.DecodeList(b3.j$26),0]]))();};b3.j$28=function(){return b3._v$28?b3._v$28:b3._v$28=(bd.DecodeRecord(l,[["task_type",b3.j$29,1],["copies",bd.Id(),0],["copy_id",bd.Id(),0],["nodes",bd.Id(),0]]))();};b3.j$30=function(){return b3._v$30?b3._v$30:b3._v$30=(bd.DecodeRecord($,[["top",b3.j$31,0],["systems",bd.DecodeList(b3.j$31),0]]))();};b3.j$82=function(){return b3._v$82?b3._v$82:b3._v$82=(bd.DecodeRecord(void 0,[["location",b3.j$83,0],["parameters",bd.DecodeList(b3.j$84),0]]))();};b2.j$1=function(){return b2._v$1?b2._v$1:b2._v$1=(bd.EncodeRecord(_,[["name",bd.Id(),0],["settings",b2.j$2,0],["reactions",bd.EncodeList(b2.j$49),0],["initials",bd.EncodeList(b2.j$52),0],["attributes",bd.EncodeStringMap(bd.Id()),0]]))();};b2.j$22=function(){return b2._v$22?b2._v$22:b2._v$22=(bd.EncodeRecord(void 0,[["div1",b2.j$17,0],["div2",b2.j$17,0]]))();};b2.j$21=function(){return b2._v$21?b2._v$21:b2._v$21=(bd.EncodeRecord(void 0,[["base_",b2.j$17,0],["exponent",b2.j$17,0]]))();};b2.j$20=function(){return b2._v$20?b2._v$20:b2._v$20=(bd.EncodeRecord(void 0,[["sub1",b2.j$17,0],["sub2",b2.j$17,0]]))();};b2.j$19=function(){return b2._v$19?b2._v$19:b2._v$19=(bd.EncodeRecord(void 0,[["div",b2.j$17,0],["modulo",b2.j$17,0]]))();};b2.j$18=function(){return b2._v$18?b2._v$18:b2._v$18=(bd.EncodeUnion(void 0,"$",[[0,[]],[1,[]],[2,[["$0","Item1",b2.j$17,0],["$1","Item2",b2.j$17,0]]],[3,[["$0","Item1",b2.j$17,0],["$1","Item2",b2.j$17,0]]],[4,[["$0","Item1",b2.j$17,0],["$1","Item2",b2.j$17,0]]],[5,[["$0","Item1",b2.j$17,0],["$1","Item2",b2.j$17,0]]],[6,[["$0","Item1",b2.j$17,0],["$1","Item2",b2.j$17,0]]],[7,[["$0","Item",b2.j$18,0]]],[8,[["$0","Item1",b2.j$18,0],["$1","Item2",b2.j$18,0]]],[9,[["$0","Item1",b2.j$18,0],["$1","Item2",b2.j$18,0]]]]))();};b2.j$62=function(){return b2._v$62?b2._v$62:b2._v$62=(bd.EncodeUnion(void 0,"$",[null,null,null]))();};b2.j$63=function(){return b2._v$63?b2._v$63:b2._v$63=(bd.EncodeUnion(void 0,"$",[null,null,null]))();};b2.j$64=function(){return b2._v$64?b2._v$64:b2._v$64=(bd.EncodeUnion(void 0,"$",[null,null]))();};b2.j$76=function(){return b2._v$76?b2._v$76:b2._v$76=(bd.EncodeUnion(cg,"$",[[0,[["$0","Item1",bd.Id(),0],["$1","Item2",bd.EncodeList(b2.j$71),0]]]]))();};b2.j$77=function(){return b2._v$77?b2._v$77:b2._v$77=(bd.EncodeUnion(ch,"$",[[0,[["$0","Item",b2.j$76,0]]],[1,[["$0","Item",b2.j$76,0]]]]))();};b2.j$80=function(){return b2._v$80?b2._v$80:b2._v$80=(bd.EncodeUnion(void 0,"$",[null,null,null]))();};b2.j$82=function(){return b2._v$82?b2._v$82:b2._v$82=(bd.EncodeUnion(n,{SystemLoc:1,NodeLoc:0},[["NodeLoc",[["$0","NodeLoc",bd.Id(),0]]],["SystemLoc",[["$0","SystemLoc",bd.EncodeTuple([bd.Id(),bd.Id()]),0]]]]))();};b2.j$83=function(){return b2._v$83?b2._v$83:b2._v$83=(bd.EncodeRecord(void 0,[["source",bd.Id(),0],["target",bd.Id(),0],["prior",b2.j$84,0]]))();};b3.j$8=function(){return b3._v$8?b3._v$8:b3._v$8=(bd.DecodeRecord(void 0,[["div1",b3.j$3,0],["div2",b3.j$3,0]]))();};b3.j$7=function(){return b3._v$7?b3._v$7:b3._v$7=(bd.DecodeRecord(void 0,[["base_",b3.j$3,0],["exponent",b3.j$3,0]]))();};b3.j$6=function(){return b3._v$6?b3._v$6:b3._v$6=(bd.DecodeRecord(void 0,[["sub1",b3.j$3,0],["sub2",b3.j$3,0]]))();};b3.j$5=function(){return b3._v$5?b3._v$5:b3._v$5=(bd.DecodeRecord(void 0,[["div",b3.j$3,0],["modulo",b3.j$3,0]]))();};b3.j$4=function(){return b3._v$4?b3._v$4:b3._v$4=(bd.DecodeUnion(void 0,"$",[[0,[]],[1,[]],[2,[["$0","Item1",b3.j$3,0],["$1","Item2",b3.j$3,0]]],[3,[["$0","Item1",b3.j$3,0],["$1","Item2",b3.j$3,0]]],[4,[["$0","Item1",b3.j$3,0],["$1","Item2",b3.j$3,0]]],[5,[["$0","Item1",b3.j$3,0],["$1","Item2",b3.j$3,0]]],[6,[["$0","Item1",b3.j$3,0],["$1","Item2",b3.j$3,0]]],[7,[["$0","Item",b3.j$4,0]]],[8,[["$0","Item1",b3.j$4,0],["$1","Item2",b3.j$4,0]]],[9,[["$0","Item1",b3.j$4,0],["$1","Item2",b3.j$4,0]]]]))();};b3.j$11=function(){return b3._v$11?b3._v$11:b3._v$11=(bd.DecodeUnion(void 0,"$",[null,null,null]))();};b3.j$12=function(){return b3._v$12?b3._v$12:b3._v$12=(bd.DecodeUnion(void 0,"$",[null,null,null]))();};b3.j$13=function(){return b3._v$13?b3._v$13:b3._v$13=(bd.DecodeUnion(void 0,"$",[null,null]))();};b3.j$25=function(){return b3._v$25?b3._v$25:b3._v$25=(bd.DecodeUnion(cg,"$",[[0,[["$0","Item1",bd.Id(),0],["$1","Item2",bd.DecodeList(b3.j$20),0]]]]))();};b3.j$26=function(){return b3._v$26?b3._v$26:b3._v$26=(bd.DecodeUnion(ch,"$",[[0,[["$0","Item",b3.j$25,0]]],[1,[["$0","Item",b3.j$25,0]]]]))();};b3.j$29=function(){return b3._v$29?b3._v$29:b3._v$29=(bd.DecodeUnion(void 0,"$",[null,null,null]))();};b3.j$31=function(){return b3._v$31?b3._v$31:b3._v$31=(bd.DecodeRecord(_,[["name",bd.Id(),0],["settings",b3.j$32,0],["reactions",bd.DecodeList(b3.j$73),0],["initials",bd.DecodeList(b3.j$76),0],["attributes",bd.DecodeStringMap(bd.Id()),0]]))();};b3.j$83=function(){return b3._v$83?b3._v$83:b3._v$83=(bd.DecodeUnion(n,{SystemLoc:1,NodeLoc:0},[["NodeLoc",[["$0","NodeLoc",bd.Id(),0]]],["SystemLoc",[["$0","SystemLoc",bd.DecodeTuple([bd.Id(),bd.Id()]),0]]]]))();};b3.j$84=function(){return b3._v$84?b3._v$84:b3._v$84=(bd.DecodeRecord(void 0,[["source",bd.Id(),0],["target",bd.Id(),0],["prior",b3.j$85,0]]))();};b2.j$2=function(){return b2._v$2?b2._v$2:b2._v$2=(bd.EncodeRecord(Y,[["simulation",b2.j$3,0],["simulations",bd.EncodeList(b2.j$3),0],["stochastic",b2.j$5,0],["deterministic",bd.Id(),0],["spatial",b2.j$7,0],["inference",b2.j$24,0],["moment_closure",b2.j$27,0],["synthesis",b2.j$35,0],["data",bd.EncodeList(b2.j$38),0],["units",b2.j$41,0],["simulator",b2.j$45,0],["parameters",bd.EncodeList(b2.j$8),0],["sweeps",bd.EncodeList(b2.j$46),0],["rates",bd.EncodeStringMap(bd.Id()),0],["plot",b2.j$48,0],["quiet",bd.Id(),0]]))();};b2.j$49=function(){return b2._v$49?b2._v$49:b2._v$49=(bd.EncodeRecord(_2,[["catalysts",bd.EncodeList(bd.Id()),0],["reactants",bd.EncodeList(bd.Id()),0],["reverse",b2.j$51,1],["rate",b2.j$51,0],["products",bd.EncodeList(bd.Id()),0]]))();};b2.j$52=function(){return b2._v$52?b2._v$52:b2._v$52=(bd.EncodeRecord(_8,[["constant",bd.Id(),0],["value",bd.Id(),0],["species",bd.Id(),0],["time",bd.Id(),1],["spatial",b2.j$53,1]]))();};b2.j$71=function(){return b2._v$71?b2._v$71:b2._v$71=(bd.EncodeUnion(void 0,"$",[[0,[["$0","Item1",bd.Id(),0],["$1","Item2",bd.Id(),0]]],[1,[["$0","Item",bd.Id(),0]]],[2,[["$0","Item",bd.Id(),0]]],[3,[["$0","Item1",bd.Id(),0],["$1","Item2",bd.EncodeList(b2.j$71),0]]],[4,[["$0","Item",bd.EncodeList(b2.j$71),0]]],[5,[["$0","Item1",b2.j$71,0],["$1","Item2",b2.j$71,0]]],[6,[["$0","Item",bd.EncodeList(b2.j$71),0]]],[7,[["$0","Item",bd.EncodeList(bd.EncodeTuple([bd.Id(),b2.j$71])),0]]],[8,[["$0","Item",b2.j$74,0]]],[9,[["$0","Item",b2.j$72,0]]]]))();};b2.j$84=function(){return b2._v$84?b2._v$84:b2._v$84=(bd.EncodeUnion(void 0,"$",[null,null,null,null]))();};b3.j$20=function(){return b3._v$20?b3._v$20:b3._v$20=(bd.DecodeUnion(void 0,"$",[[0,[["$0","Item1",bd.Id(),0],["$1","Item2",bd.Id(),0]]],[1,[["$0","Item",bd.Id(),0]]],[2,[["$0","Item",bd.Id(),0]]],[3,[["$0","Item1",bd.Id(),0],["$1","Item2",bd.DecodeList(b3.j$20),0]]],[4,[["$0","Item",bd.DecodeList(b3.j$20),0]]],[5,[["$0","Item1",b3.j$20,0],["$1","Item2",b3.j$20,0]]],[6,[["$0","Item",bd.DecodeList(b3.j$20),0]]],[7,[["$0","Item",bd.DecodeList(bd.DecodeTuple([bd.Id(),b3.j$20])),0]]],[8,[["$0","Item",b3.j$23,0]]],[9,[["$0","Item",b3.j$21,0]]]]))();};b3.j$32=function(){return b3._v$32?b3._v$32:b3._v$32=(bd.DecodeRecord(Y,[["simulation",b3.j$33,0],["simulations",bd.DecodeList(b3.j$33),0],["stochastic",b3.j$35,0],["deterministic",bd.Id(),0],["spatial",b3.j$37,0],["inference",b3.j$48,0],["moment_closure",b3.j$51,0],["synthesis",b3.j$59,0],["data",bd.DecodeList(b3.j$62),0],["units",b3.j$65,0],["simulator",b3.j$69,0],["parameters",bd.DecodeList(b3.j$38),0],["sweeps",bd.DecodeList(b3.j$70),0],["rates",bd.DecodeStringMap(bd.Id()),0],["plot",b3.j$72,0],["quiet",bd.Id(),0]]))();};b3.j$73=function(){return b3._v$73?b3._v$73:b3._v$73=(bd.DecodeRecord(_2,[["catalysts",bd.DecodeList(bd.Id()),0],["reactants",bd.DecodeList(bd.Id()),0],["reverse",b3.j$75,1],["rate",b3.j$75,0],["products",bd.DecodeList(bd.Id()),0]]))();};b3.j$76=function(){return b3._v$76?b3._v$76:b3._v$76=(bd.DecodeRecord(_8,[["constant",bd.Id(),0],["value",bd.Id(),0],["species",bd.Id(),0],["time",bd.Id(),1],["spatial",b3.j$77,1]]))();};b3.j$85=function(){return b3._v$85?b3._v$85:b3._v$85=(bd.DecodeUnion(void 0,"$",[null,null,null,null]))();};b2.j$3=function(){return b2._v$3?b2._v$3:b2._v$3=(bd.EncodeRecord(bx,[["name",bd.Id(),0],["initial",bd.Id(),0],["final",bd.Id(),0],["points",bd.Id(),0],["plots",bd.EncodeList(bd.Id()),0],["plotcolours",bd.EncodeList(bd.Id()),0],["seed",bd.Id(),1],["kinetics",b2.j$4,0],["times",bd.EncodeList(bd.Id()),0],["prune",bd.Id(),0],["multicore",bd.Id(),0],["data",bd.EncodeList(bd.Id()),0],["sweeps",bd.EncodeList(bd.Id()),0]]))();};b2.j$5=function(){return b2._v$5?b2._v$5:b2._v$5=(bd.EncodeRecord(void 0,[["scale",bd.Id(),0],["steps",bd.Id(),1],["trajectories",bd.Id(),0],["stationary_skiptime",bd.Id(),1]]))();};b2.j$7=function(){return b2._v$7?b2._v$7:b2._v$7=(bd.EncodeRecord(void 0,[["parameters",bd.EncodeList(b2.j$8),0],["diffusibles",bd.EncodeList(bd.EncodeTuple([bd.Id(),b2.j$17])),0],["dimensions",bd.Id(),0],["boundary",b2.j$23,0],["xmax",bd.Id(),0],["nx",bd.Id(),0],["dt",bd.Id(),0],["default_diffusion",bd.Id(),0],["random",bd.Id(),0]]))();};b2.j$24=function(){return b2._v$24?b2._v$24:b2._v$24=(bd.EncodeRecord(void 0,[["name",bd.Id(),0],["burnin",bd.Id(),0],["samples",bd.Id(),0],["thin",bd.Id(),0],["noise_model",b2.j$25,0],["noise_parameter",b2.j$26,0],["prune",bd.Id(),0],["seed",bd.Id(),0],["seeds",bd.EncodeList(bd.Id()),0],["lowerbound",bd.Id(),1],["timer",bd.Id(),0],["partial_evaluation",bd.Id(),0],["print_console",bd.Id(),0],["print_summary",bd.Id(),0]]))();};b2.j$27=function(){return b2._v$27?b2._v$27:b2._v$27=(bd.EncodeRecord(void 0,[["order",bd.Id(),0],["initial_minimum",bd.Id(),0],["log_evaluation",bd.Id(),0],["plots",bd.EncodeList(b2.j$28),0]]))();};b2.j$35=function(){return b2._v$35?b2._v$35:b2._v$35=(bd.EncodeRecord(void 0,[["mode",b2.j$36,0],["solver",b2.j$37,0],["timeout",bd.Id(),1],["seed",bd.Id(),1]]))();};b2.j$38=function(){return b2._v$38?b2._v$38:b2._v$38=(bd.EncodeRecord(void 0,[["file",bd.Id(),0],["data",bd.EncodeList(b2.j$39),0]]))();};b2.j$41=function(){return b2._v$41?b2._v$41:b2._v$41=(bd.EncodeRecord(T,[["concentration",b2.j$42,0],["time",b2.j$43,0],["space",b2.j$44,0]]))();};b2.j$45=function(){return b2._v$45?b2._v$45:b2._v$45=(bd.EncodeUnion(void 0,"$",[null,null,null,null,null,null,null,null]))();};b2.j$8=function(){return b2._v$8?b2._v$8:b2._v$8=(bd.EncodeRecord(F,[["name",bd.Id(),0],["value",bd.Id(),0],["prior",b2.j$9,1]]))();};b2.j$46=function(){return b2._v$46?b2._v$46:b2._v$46=(bd.EncodeRecord(W,[["name",bd.Id(),0],["assignments",bd.EncodeList(b2.j$47),0]]))();};b2.j$48=function(){return b2._v$48?b2._v$48:b2._v$48=(bd.EncodeRecord(X,[["x_label",bd.Id(),0],["y_label",bd.Id(),0],["title",bd.Id(),0],["label_font_size",bd.Id(),0],["tick_font_size",bd.Id(),0],["x_ticks",bd.EncodeList(bd.Id()),0],["y_ticks",bd.EncodeList(bd.Id()),0],["x_min",bd.Id(),1],["x_max",bd.Id(),1],["y_min",bd.Id(),1],["y_max",bd.Id(),1],["v_boundaries",bd.EncodeList(bd.Id()),0],["h_boundaries",bd.EncodeList(bd.Id()),0]]))();};b2.j$51=function(){return b2._v$51?b2._v$51:b2._v$51=(bd.EncodeUnion(_1,{Function:1,MassAction:0},[["MassAction",[["$0","MassAction",bd.Id(),0]]],["Function",[["$0","Function",bd.Id(),0]]]]))();};b2.j$53=function(){return b2._v$53?b2._v$53:b2._v$53=(bd.EncodeRecord(void 0,[["random",bd.Id(),0],["core",b2.j$54,1],["points",bd.EncodeList(b2.j$55),0],["rectangles",bd.EncodeList(b2.j$56),0]]))();};b2.j$74=function(){return b2._v$74?b2._v$74:b2._v$74=(bd.EncodeUnion(void 0,"$",[[0,[["$0","Item",bd.EncodeArrayMap(bd.Id(),bd.EncodeList(b2.j$66)),0]]]]))();};b2.j$72=function(){return b2._v$72?b2._v$72:b2._v$72=(bd.EncodeUnion(b_,"$",[[0,[["$0","Item1",bd.EncodeList(bd.EncodeTuple([b2.j$66,b2.j$73])),0],["$1","Item2",bd.EncodeList(bd.EncodeTuple([b2.j$66,b2.j$73])),0]]],[1,[["$0","Item",bd.EncodeList(bd.EncodeTuple([b2.j$66,b2.j$73])),0]]],[2,[["$0","Item",bd.EncodeList(bd.EncodeTuple([b2.j$66,b2.j$73])),0]]],[3,[["$0","Item",bd.EncodeList(bd.EncodeTuple([b2.j$66,b2.j$73])),0]]],[4,[["$0","Item",bd.EncodeList(bd.EncodeTuple([b2.j$66,b2.j$73])),0]]],[5,[]]]))();};b3.j$23=function(){return b3._v$23?b3._v$23:b3._v$23=(bd.DecodeUnion(void 0,"$",[[0,[["$0","Item",bd.DecodeArrayMap(bd.Id(),bd.DecodeList(b3.j$15)),0]]]]))();};b3.j$21=function(){return b3._v$21?b3._v$21:b3._v$21=(bd.DecodeUnion(b_,"$",[[0,[["$0","Item1",bd.DecodeList(bd.DecodeTuple([b3.j$15,b3.j$22])),0],["$1","Item2",bd.DecodeList(bd.DecodeTuple([b3.j$15,b3.j$22])),0]]],[1,[["$0","Item",bd.DecodeList(bd.DecodeTuple([b3.j$15,b3.j$22])),0]]],[2,[["$0","Item",bd.DecodeList(bd.DecodeTuple([b3.j$15,b3.j$22])),0]]],[3,[["$0","Item",bd.DecodeList(bd.DecodeTuple([b3.j$15,b3.j$22])),0]]],[4,[["$0","Item",bd.DecodeList(bd.DecodeTuple([b3.j$15,b3.j$22])),0]]],[5,[]]]))();};b3.j$33=function(){return b3._v$33?b3._v$33:b3._v$33=(bd.DecodeRecord(bx,[["name",bd.Id(),0],["initial",bd.Id(),0],["final",bd.Id(),0],["points",bd.Id(),0],["plots",bd.DecodeList(bd.Id()),0],["plotcolours",bd.DecodeList(bd.Id()),0],["seed",bd.Id(),1],["kinetics",b3.j$34,0],["times",bd.DecodeList(bd.Id()),0],["prune",bd.Id(),0],["multicore",bd.Id(),0],["data",bd.DecodeList(bd.Id()),0],["sweeps",bd.DecodeList(bd.Id()),0]]))();};b3.j$35=function(){return b3._v$35?b3._v$35:b3._v$35=(bd.DecodeRecord(void 0,[["scale",bd.Id(),0],["steps",bd.Id(),1],["trajectories",bd.Id(),0],["stationary_skiptime",bd.Id(),1]]))();};b3.j$37=function(){return b3._v$37?b3._v$37:b3._v$37=(bd.DecodeRecord(void 0,[["parameters",bd.DecodeList(b3.j$38),0],["diffusibles",bd.DecodeList(bd.DecodeTuple([bd.Id(),b3.j$3])),0],["dimensions",bd.Id(),0],["boundary",b3.j$47,0],["xmax",bd.Id(),0],["nx",bd.Id(),0],["dt",bd.Id(),0],["default_diffusion",bd.Id(),0],["random",bd.Id(),0]]))();};b3.j$48=function(){return b3._v$48?b3._v$48:b3._v$48=(bd.DecodeRecord(void 0,[["name",bd.Id(),0],["burnin",bd.Id(),0],["samples",bd.Id(),0],["thin",bd.Id(),0],["noise_model",b3.j$49,0],["noise_parameter",b3.j$50,0],["prune",bd.Id(),0],["seed",bd.Id(),0],["seeds",bd.DecodeList(bd.Id()),0],["lowerbound",bd.Id(),1],["timer",bd.Id(),0],["partial_evaluation",bd.Id(),0],["print_console",bd.Id(),0],["print_summary",bd.Id(),0]]))();};b3.j$51=function(){return b3._v$51?b3._v$51:b3._v$51=(bd.DecodeRecord(void 0,[["order",bd.Id(),0],["initial_minimum",bd.Id(),0],["log_evaluation",bd.Id(),0],["plots",bd.DecodeList(b3.j$52),0]]))();};b3.j$59=function(){return b3._v$59?b3._v$59:b3._v$59=(bd.DecodeRecord(void 0,[["mode",b3.j$60,0],["solver",b3.j$61,0],["timeout",bd.Id(),1],["seed",bd.Id(),1]]))();};b3.j$62=function(){return b3._v$62?b3._v$62:b3._v$62=(bd.DecodeRecord(void 0,[["file",bd.Id(),0],["data",bd.DecodeList(b3.j$63),0]]))();};b3.j$65=function(){return b3._v$65?b3._v$65:b3._v$65=(bd.DecodeRecord(T,[["concentration",b3.j$66,0],["time",b3.j$67,0],["space",b3.j$68,0]]))();};b3.j$69=function(){return b3._v$69?b3._v$69:b3._v$69=(bd.DecodeUnion(void 0,"$",[null,null,null,null,null,null,null,null]))();};b3.j$38=function(){return b3._v$38?b3._v$38:b3._v$38=(bd.DecodeRecord(F,[["name",bd.Id(),0],["value",bd.Id(),0],["prior",b3.j$39,1]]))();};b3.j$70=function(){return b3._v$70?b3._v$70:b3._v$70=(bd.DecodeRecord(W,[["name",bd.Id(),0],["assignments",bd.DecodeList(b3.j$71),0]]))();};b3.j$72=function(){return b3._v$72?b3._v$72:b3._v$72=(bd.DecodeRecord(X,[["x_label",bd.Id(),0],["y_label",bd.Id(),0],["title",bd.Id(),0],["label_font_size",bd.Id(),0],["tick_font_size",bd.Id(),0],["x_ticks",bd.DecodeList(bd.Id()),0],["y_ticks",bd.DecodeList(bd.Id()),0],["x_min",bd.Id(),1],["x_max",bd.Id(),1],["y_min",bd.Id(),1],["y_max",bd.Id(),1],["v_boundaries",bd.DecodeList(bd.Id()),0],["h_boundaries",bd.DecodeList(bd.Id()),0]]))();};b3.j$75=function(){return b3._v$75?b3._v$75:b3._v$75=(bd.DecodeUnion(_1,{Function:1,MassAction:0},[["MassAction",[["$0","MassAction",bd.Id(),0]]],["Function",[["$0","Function",bd.Id(),0]]]]))();};b3.j$77=function(){return b3._v$77?b3._v$77:b3._v$77=(bd.DecodeRecord(void 0,[["random",bd.Id(),0],["core",b3.j$78,1],["points",bd.DecodeList(b3.j$79),0],["rectangles",bd.DecodeList(b3.j$80),0]]))();};b2.j$4=function(){return b2._v$4?b2._v$4:b2._v$4=(bd.EncodeUnion(void 0,"$",[null,null,null]))();};b2.j$23=function(){return b2._v$23?b2._v$23:b2._v$23=(bd.EncodeUnion(void 0,"$",[null,null]))();};b2.j$25=function(){return b2._v$25?b2._v$25:b2._v$25=(bd.EncodeUnion(void 0,"$",[null,null]))();};b2.j$26=function(){return b2._v$26?b2._v$26:b2._v$26=(bd.EncodeUnion(void 0,"$",[[0,[["$0","Fixed",bd.Id(),0]]],null,null]))();};b2.j$28=function(){return b2._v$28?b2._v$28:b2._v$28=(bd.EncodeUnion(void 0,{Item1:13,Round:12,Floor:11,Ceiling:10,Modulo:9,Log:8,Absolute:7,Minus:6,Plus:5,Power:4,Divide:3,Times:2,Float:1,Key:0},[["Key",[["$0","Key",bd.EncodeList(bd.EncodeTuple([bd.Id(),bd.Id()])),0]]],["Float",[["$0","Float",bd.Id(),0]]],["Times",[["$0","Times",bd.EncodeList(b2.j$28),0]]],["Divide",[["$0","Divide",b2.j$34,0]]],["Power",[["$0","Power",b2.j$33,0]]],["Plus",[["$0","Plus",bd.EncodeList(b2.j$28),0]]],["Minus",[["$0","Minus",b2.j$32,0]]],["Absolute",[["$0","Absolute",b2.j$28,0]]],["Log",[["$0","Log",b2.j$28,0]]],["Modulo",[["$0","Modulo",b2.j$31,0]]],["Ceiling",[["$0","Ceiling",b2.j$28,0]]],["Floor",[["$0","Floor",b2.j$28,0]]],["Round",[["$0","Round",b2.j$28,0]]],["If",[["$0","Item1",b2.j$30,0],["$1","Item2",b2.j$28,0],["$2","Item3",b2.j$28,0]]]]))();};b2.j$36=function(){return b2._v$36?b2._v$36:b2._v$36=(bd.EncodeUnion(void 0,"$",[null,null]))();};b2.j$37=function(){return b2._v$37?b2._v$37:b2._v$37=(bd.EncodeUnion(void 0,"$",[null,null]))();};b2.j$39=function(){return b2._v$39?b2._v$39:b2._v$39=(bd.EncodeRecord(void 0,[["times",bd.EncodeList(bd.Id()),0],["columns",bd.EncodeList(b2.j$40),0]]))();};b2.j$42=function(){return b2._v$42?b2._v$42:b2._v$42=(bd.EncodeUnion(Q,{Molar:0},[["Molar",[["$0","Molar",bd.Id(),0]]]]))();};b2.j$43=function(){return b2._v$43?b2._v$43:b2._v$43=(bd.EncodeUnion(R,{Seconds:0},[["Seconds",[["$0","Seconds",bd.Id(),0]]]]))();};b2.j$44=function(){return b2._v$44?b2._v$44:b2._v$44=(bd.EncodeUnion(S,{Metres:0},[["Metres",[["$0","Metres",bd.Id(),0]]]]))();};b2.j$9=function(){return b2._v$9?b2._v$9:b2._v$9=(bd.EncodeRecord(void 0,[["interval",b2.j$10,0],["distribution",b2.j$11,0],["variation",b2.j$16,0]]))();};b2.j$47=function(){return b2._v$47?b2._v$47:b2._v$47=(bd.EncodeRecord(V,[["variables",bd.EncodeList(bd.Id()),0],["values",bd.EncodeList(bd.EncodeList(b2.j$17)),0]]))();};b2.j$54=function(){return b2._v$54?b2._v$54:b2._v$54=(bd.EncodeRecord(_4,[["inner",bd.Id(),0],["outer",bd.Id(),0],["width",bd.Id(),0]]))();};b2.j$55=function(){return b2._v$55?b2._v$55:b2._v$55=(bd.EncodeRecord(_5,[["x",bd.Id(),0],["y",bd.Id(),0],["width",bd.Id(),0],["value",bd.Id(),0]]))();};b2.j$56=function(){return b2._v$56?b2._v$56:b2._v$56=(bd.EncodeRecord(_6,[["xmin",bd.Id(),0],["xmax",bd.Id(),0],["ymin",bd.Id(),0],["ymax",bd.Id(),0],["value",bd.Id(),0]]))();};b2.j$66=function(){return b2._v$66?b2._v$66:b2._v$66=(bd.EncodeUnion(cf,"$",[[0,[["$0","Item",b2.j$67,0]]],[1,[["$0","Item",bd.EncodeTuple([bd.Id(),bd.Id()]),0]]]]))();};b2.j$73=function(){return b2._v$73?b2._v$73:b2._v$73=(bd.EncodeUnion(void 0,"$",[[0,[["$0","Item1",bd.Id(),0],["$1","Item2",bd.Id(),0]]],[1,[["$0","Item",bd.EncodeTuple([bd.Id(),bd.Id()]),0]]]]))();};b3.j$15=function(){return b3._v$15?b3._v$15:b3._v$15=(bd.DecodeUnion(cf,"$",[[0,[["$0","Item",b3.j$16,0]]],[1,[["$0","Item",bd.DecodeTuple([bd.Id(),bd.Id()]),0]]]]))();};b3.j$22=function(){return b3._v$22?b3._v$22:b3._v$22=(bd.DecodeUnion(void 0,"$",[[0,[["$0","Item1",bd.Id(),0],["$1","Item2",bd.Id(),0]]],[1,[["$0","Item",bd.DecodeTuple([bd.Id(),bd.Id()]),0]]]]))();};b3.j$34=function(){return b3._v$34?b3._v$34:b3._v$34=(bd.DecodeUnion(void 0,"$",[null,null,null]))();};b3.j$47=function(){return b3._v$47?b3._v$47:b3._v$47=(bd.DecodeUnion(void 0,"$",[null,null]))();};b3.j$49=function(){return b3._v$49?b3._v$49:b3._v$49=(bd.DecodeUnion(void 0,"$",[null,null]))();};b3.j$50=function(){return b3._v$50?b3._v$50:b3._v$50=(bd.DecodeUnion(void 0,"$",[[0,[["$0","Fixed",bd.Id(),0]]],null,null]))();};b3.j$52=function(){return b3._v$52?b3._v$52:b3._v$52=(bd.DecodeUnion(void 0,{Item1:13,Round:12,Floor:11,Ceiling:10,Modulo:9,Log:8,Absolute:7,Minus:6,Plus:5,Power:4,Divide:3,Times:2,Float:1,Key:0},[["Key",[["$0","Key",bd.DecodeList(bd.DecodeTuple([bd.Id(),bd.Id()])),0]]],["Float",[["$0","Float",bd.Id(),0]]],["Times",[["$0","Times",bd.DecodeList(b3.j$52),0]]],["Divide",[["$0","Divide",b3.j$58,0]]],["Power",[["$0","Power",b3.j$57,0]]],["Plus",[["$0","Plus",bd.DecodeList(b3.j$52),0]]],["Minus",[["$0","Minus",b3.j$56,0]]],["Absolute",[["$0","Absolute",b3.j$52,0]]],["Log",[["$0","Log",b3.j$52,0]]],["Modulo",[["$0","Modulo",b3.j$55,0]]],["Ceiling",[["$0","Ceiling",b3.j$52,0]]],["Floor",[["$0","Floor",b3.j$52,0]]],["Round",[["$0","Round",b3.j$52,0]]],["If",[["$0","Item1",b3.j$54,0],["$1","Item2",b3.j$52,0],["$2","Item3",b3.j$52,0]]]]))();};b3.j$60=function(){return b3._v$60?b3._v$60:b3._v$60=(bd.DecodeUnion(void 0,"$",[null,null]))();};b3.j$61=function(){return b3._v$61?b3._v$61:b3._v$61=(bd.DecodeUnion(void 0,"$",[null,null]))();};b3.j$63=function(){return b3._v$63?b3._v$63:b3._v$63=(bd.DecodeRecord(void 0,[["times",bd.DecodeList(bd.Id()),0],["columns",bd.DecodeList(b3.j$64),0]]))();};b3.j$66=function(){return b3._v$66?b3._v$66:b3._v$66=(bd.DecodeUnion(Q,{Molar:0},[["Molar",[["$0","Molar",bd.Id(),0]]]]))();};b3.j$67=function(){return b3._v$67?b3._v$67:b3._v$67=(bd.DecodeUnion(R,{Seconds:0},[["Seconds",[["$0","Seconds",bd.Id(),0]]]]))();};b3.j$68=function(){return b3._v$68?b3._v$68:b3._v$68=(bd.DecodeUnion(S,{Metres:0},[["Metres",[["$0","Metres",bd.Id(),0]]]]))();};b3.j$39=function(){return b3._v$39?b3._v$39:b3._v$39=(bd.DecodeRecord(void 0,[["interval",b3.j$40,0],["distribution",b3.j$41,0],["variation",b3.j$46,0]]))();};b3.j$71=function(){return b3._v$71?b3._v$71:b3._v$71=(bd.DecodeRecord(V,[["variables",bd.DecodeList(bd.Id()),0],["values",bd.DecodeList(bd.DecodeList(b3.j$3)),0]]))();};b3.j$78=function(){return b3._v$78?b3._v$78:b3._v$78=(bd.DecodeRecord(_4,[["inner",bd.Id(),0],["outer",bd.Id(),0],["width",bd.Id(),0]]))();};b3.j$79=function(){return b3._v$79?b3._v$79:b3._v$79=(bd.DecodeRecord(_5,[["x",bd.Id(),0],["y",bd.Id(),0],["width",bd.Id(),0],["value",bd.Id(),0]]))();};b3.j$80=function(){return b3._v$80?b3._v$80:b3._v$80=(bd.DecodeRecord(_6,[["xmin",bd.Id(),0],["xmax",bd.Id(),0],["ymin",bd.Id(),0],["ymax",bd.Id(),0],["value",bd.Id(),0]]))();};b2.j$34=function(){return b2._v$34?b2._v$34:b2._v$34=(bd.EncodeRecord(void 0,[["div1",b2.j$28,0],["div2",b2.j$28,0]]))();};b2.j$33=function(){return b2._v$33?b2._v$33:b2._v$33=(bd.EncodeRecord(void 0,[["base_",b2.j$28,0],["exponent",b2.j$28,0]]))();};b2.j$32=function(){return b2._v$32?b2._v$32:b2._v$32=(bd.EncodeRecord(void 0,[["sub1",b2.j$28,0],["sub2",b2.j$28,0]]))();};b2.j$31=function(){return b2._v$31?b2._v$31:b2._v$31=(bd.EncodeRecord(void 0,[["div",b2.j$28,0],["modulo",b2.j$28,0]]))();};b2.j$30=function(){return b2._v$30?b2._v$30:b2._v$30=(bd.EncodeUnion(void 0,"$",[[0,[]],[1,[]],[2,[["$0","Item1",b2.j$28,0],["$1","Item2",b2.j$28,0]]],[3,[["$0","Item1",b2.j$28,0],["$1","Item2",b2.j$28,0]]],[4,[["$0","Item1",b2.j$28,0],["$1","Item2",b2.j$28,0]]],[5,[["$0","Item1",b2.j$28,0],["$1","Item2",b2.j$28,0]]],[6,[["$0","Item1",b2.j$28,0],["$1","Item2",b2.j$28,0]]],[7,[["$0","Item",b2.j$30,0]]],[8,[["$0","Item1",b2.j$30,0],["$1","Item2",b2.j$30,0]]],[9,[["$0","Item1",b2.j$30,0],["$1","Item2",b2.j$30,0]]]]))();};b2.j$40=function(){return b2._v$40?b2._v$40:b2._v$40=(bd.EncodeRecord(void 0,[["name",bd.Id(),0],["values",bd.EncodeList(bd.Id()),0]]))();};b2.j$10=function(){return b2._v$10?b2._v$10:b2._v$10=(bd.EncodeUnion(void 0,"$",[null,null]))();};b2.j$11=function(){return b2._v$11?b2._v$11:b2._v$11=(bd.EncodeUnion(C,{TruncatedNormal:3,LogNormal:2,Normal:1,Uniform:0},[["Uniform",[["$0","Uniform",b2.j$15,0]]],["Normal",[["$0","Normal",b2.j$14,0]]],["LogNormal",[["$0","LogNormal",b2.j$13,0]]],["TruncatedNormal",[["$0","TruncatedNormal",b2.j$12,0]]]]))();};b2.j$16=function(){return b2._v$16?b2._v$16:b2._v$16=(bd.EncodeUnion(void 0,"$",[null,null,null,null]))();};b2.j$67=function(){return b2._v$67?b2._v$67:b2._v$67=(bd.EncodeUnion(ce,"$",[[0,[["$0","Item",b2.j$69,0]]],[1,[["$0","Item1",b2.j$69,0],["$1","Item2",b2.j$68,0]]]]))();};b3.j$16=function(){return b3._v$16?b3._v$16:b3._v$16=(bd.DecodeUnion(ce,"$",[[0,[["$0","Item",b3.j$18,0]]],[1,[["$0","Item1",b3.j$18,0],["$1","Item2",b3.j$17,0]]]]))();};b3.j$58=function(){return b3._v$58?b3._v$58:b3._v$58=(bd.DecodeRecord(void 0,[["div1",b3.j$52,0],["div2",b3.j$52,0]]))();};b3.j$57=function(){return b3._v$57?b3._v$57:b3._v$57=(bd.DecodeRecord(void 0,[["base_",b3.j$52,0],["exponent",b3.j$52,0]]))();};b3.j$56=function(){return b3._v$56?b3._v$56:b3._v$56=(bd.DecodeRecord(void 0,[["sub1",b3.j$52,0],["sub2",b3.j$52,0]]))();};b3.j$55=function(){return b3._v$55?b3._v$55:b3._v$55=(bd.DecodeRecord(void 0,[["div",b3.j$52,0],["modulo",b3.j$52,0]]))();};b3.j$54=function(){return b3._v$54?b3._v$54:b3._v$54=(bd.DecodeUnion(void 0,"$",[[0,[]],[1,[]],[2,[["$0","Item1",b3.j$52,0],["$1","Item2",b3.j$52,0]]],[3,[["$0","Item1",b3.j$52,0],["$1","Item2",b3.j$52,0]]],[4,[["$0","Item1",b3.j$52,0],["$1","Item2",b3.j$52,0]]],[5,[["$0","Item1",b3.j$52,0],["$1","Item2",b3.j$52,0]]],[6,[["$0","Item1",b3.j$52,0],["$1","Item2",b3.j$52,0]]],[7,[["$0","Item",b3.j$54,0]]],[8,[["$0","Item1",b3.j$54,0],["$1","Item2",b3.j$54,0]]],[9,[["$0","Item1",b3.j$54,0],["$1","Item2",b3.j$54,0]]]]))();};b3.j$64=function(){return b3._v$64?b3._v$64:b3._v$64=(bd.DecodeRecord(void 0,[["name",bd.Id(),0],["values",bd.DecodeList(bd.Id()),0]]))();};b3.j$40=function(){return b3._v$40?b3._v$40:b3._v$40=(bd.DecodeUnion(void 0,"$",[null,null]))();};b3.j$41=function(){return b3._v$41?b3._v$41:b3._v$41=(bd.DecodeUnion(C,{TruncatedNormal:3,LogNormal:2,Normal:1,Uniform:0},[["Uniform",[["$0","Uniform",b3.j$45,0]]],["Normal",[["$0","Normal",b3.j$44,0]]],["LogNormal",[["$0","LogNormal",b3.j$43,0]]],["TruncatedNormal",[["$0","TruncatedNormal",b3.j$42,0]]]]))();};b3.j$46=function(){return b3._v$46?b3._v$46:b3._v$46=(bd.DecodeUnion(void 0,"$",[null,null,null,null]))();};b2.j$15=function(){return b2._v$15?b2._v$15:b2._v$15=(bd.EncodeRecord(B,[["min",bd.Id(),0],["max",bd.Id(),0]]))();};b2.j$14=function(){return b2._v$14?b2._v$14:b2._v$14=(bd.EncodeRecord(A,[["mean",bd.Id(),0],["stdev",bd.Id(),0]]))();};b2.j$13=function(){return b2._v$13?b2._v$13:b2._v$13=(bd.EncodeRecord(z,[["mu",bd.Id(),0],["sigma",bd.Id(),0]]))();};b2.j$12=function(){return b2._v$12?b2._v$12:b2._v$12=(bd.EncodeRecord(y,[["mean",bd.Id(),0],["stdev",bd.Id(),0],["min",bd.Id(),0],["max",bd.Id(),0]]))();};b2.j$69=function(){return b2._v$69?b2._v$69:b2._v$69=(bd.EncodeUnion(cd,"$",[[0,[[null,null,b2.j$75]]],[1,[["$0","Item1",bd.EncodeTuple([bd.Id(),bd.Id()]),0],["$1","Item2",b2.j$70,0]]]]))();};b2.j$68=function(){return b2._v$68?b2._v$68:b2._v$68=(bd.EncodeUnion(b6,"$",[[0,[["$0","Item",bd.Id(),0]]],[1,[["$0","Item",bd.EncodeTuple([bd.Id(),bd.Id()]),0]]]]))();};b3.j$18=function(){return b3._v$18?b3._v$18:b3._v$18=(bd.DecodeUnion(cd,"$",[[0,[[null,null,b3.j$24]]],[1,[["$0","Item1",bd.DecodeTuple([bd.Id(),bd.Id()]),0],["$1","Item2",b3.j$19,0]]]]))();};b3.j$17=function(){return b3._v$17?b3._v$17:b3._v$17=(bd.DecodeUnion(b6,"$",[[0,[["$0","Item",bd.Id(),0]]],[1,[["$0","Item",bd.DecodeTuple([bd.Id(),bd.Id()]),0]]]]))();};b3.j$45=function(){return b3._v$45?b3._v$45:b3._v$45=(bd.DecodeRecord(B,[["min",bd.Id(),0],["max",bd.Id(),0]]))();};b3.j$44=function(){return b3._v$44?b3._v$44:b3._v$44=(bd.DecodeRecord(A,[["mean",bd.Id(),0],["stdev",bd.Id(),0]]))();};b3.j$43=function(){return b3._v$43?b3._v$43:b3._v$43=(bd.DecodeRecord(z,[["mu",bd.Id(),0],["sigma",bd.Id(),0]]))();};b3.j$42=function(){return b3._v$42?b3._v$42:b3._v$42=(bd.DecodeRecord(y,[["mean",bd.Id(),0],["stdev",bd.Id(),0],["min",bd.Id(),0],["max",bd.Id(),0]]))();};b2.j$75=function(){return b2._v$75?b2._v$75:b2._v$75=(bd.EncodeRecord(cc,[["name",bd.Id(),0],["isComplementary",bd.Id(),0],["isToehold",bd.Id(),0],["tag",b2.j$70,0]]))();};b2.j$70=function(){return b2._v$70?b2._v$70:b2._v$70=(bd.EncodeUnion(void 0,"$",[[0,[]],[1,[]],[2,[["$0","Item",b2.j$71,0]]]]))();};b3.j$24=function(){return b3._v$24?b3._v$24:b3._v$24=(bd.DecodeRecord(cc,[["name",bd.Id(),0],["isComplementary",bd.Id(),0],["isToehold",bd.Id(),0],["tag",b3.j$19,0]]))();};b3.j$19=function(){return b3._v$19?b3._v$19:b3._v$19=(bd.DecodeUnion(void 0,"$",[[0,[]],[1,[]],[2,[["$0","Item",b3.j$20,0]]]]))();};b4.New=function(hI,hJ,hK,hL){return{renderer:hI,mode:hJ,rotate_labels:hK,arrange:hL};};b6=b5.Bond=hB.Class({toString:function(){return b6.ToString(this);}},null,b6);b6.ToString=function(hI){var hJ;return hI.$==1?(hJ=hI.$0,b8.printVar(hJ[0],hJ[1])):(function(hK){return function(hL){return hK(a.String(hL));};}(a.id))(hI.$0);};b6.Compare=function(hI,hJ,hK){return hJ.$==0?hK.$==0?hI(hJ.$0,hK.$0):b8.GT():hK.$==0?b8.LT():cw.Compare(hJ.$0[1],hK.$0[1]);};b9.ToString=function(hI){var hJ;return hI.$==1?(hJ=hI.$0,b8.printVar(hJ[0],hJ[1])):(((hB.Curried3(function(hK,hL,hM){return hK("("+a.String(hL)+", "+a.String(hM)+")");}))(a.id))(hI.$0))(hI.$1);};b9.refresh=function(hI,hJ){var hK,hL;switch(hJ.$==1?hJ.$0[0]===-1?hJ.$0[1]==="_"?1:(hK=[hJ.$0[1],hJ.$0[0]],2):(hK=[hJ.$0[1],hJ.$0[0]],2):0){case 0:return hJ;case 1:return hJ;case 2:hL=hK[0];return{$:1,$0:[hI(hL),hL]};}};b9.Compare=function(hI,hJ){var hK,hL;return hI.$==0?hJ.$==0?(hK=hI.$0,(hL=hJ.$0,hK===hL?cw.Compare(hI.$1,hJ.$1):cw.Compare(hK,hL))):b8.GT():hJ.$==0?b8.LT():cw.Compare(hI.$0[1],hJ.$0[1]);};b_=b8.Pattern=hB.Class({Overlaps:function(hI){var hJ;function hK(hN){return hN.$==4?bX.ofArray([hN.$0]):hN.$==0?bX.ofArray([hN.$0,hN.$1]):hN.$==2?bX.ofArray([hN.$0]):hN.$==1?bX.ofArray([hN.$0]):hN.$==5?bY.Empty:bX.ofArray([hN.$0]);}function hL(hN,hO){var hP,hQ;hP=(bX.head(hO))[1];return hP.$==1?be.FailWith((function(hR){return function(hS){return hR("Unexpected uninstantiated pattern "+cA.toSafe(hS));};}(a.id))(b_.ToString(hN))):(hQ=hP.$1,[hP.$0,[hQ,hQ+hO.get_Length()-1]]);}function hM(hN,hO){return hN[0]===hO[0]&&(hN[1][0]<=hO[1][1]&&hN[1][1]>=hO[1][0]);}return bX.exists(function(hN){return bX.exists(function(hO){return hM(hN,hO);},bX.map(function(hO){return hL(hI,hO);},hK(hI)));},bX.map((hJ=this,function(hN){return hL(hJ,hN);}),hK(this)));}},null,b_);b_.ToStringWith=function(hI,hJ){var hK,hL,hM,hN,hO,hP;function hQ(hR){function hS(hT,hU){var hV;return hU.$==1&&(hU.$0[0]===-1&&hU.$0[1]==="_")?hI.toString(hT):(((hB.Curried3(function(hW,hX,hY){return hW(cA.toSafe(hX)+" @ "+cA.toSafe(hY));}))(a.id))(hI.toString(hT)))(b9.ToString(hU));}return cS.concat(" ",bX.map(function(hT){return hS(hT[0],hT[1]);},hR));}return hJ.$==1?(hK=hQ(hJ.$0),(function(hR){return function(hS){return hR(cA.toSafe(hS));};}(a.id))(hK)):hJ.$==0?(hL=hQ(hJ.$0),(hM=hQ(hJ.$1),(((hB.Curried3(function(hR,hS,hT){return hR(cA.toSafe(hS)+"> | <"+cA.toSafe(hT));}))(a.id))(hL))(hM))):hJ.$==2?(hN=hQ(hJ.$0),(function(hR){return function(hS){return hR("<"+cA.toSafe(hS)+">");};}(a.id))(hN)):hJ.$==3?(hO=hQ(hJ.$0),(function(hR){return function(hS){return hR(cA.toSafe(hS)+">");};}(a.id))(hO)):hJ.$==4?(hP=hQ(hJ.$0),(function(hR){return function(hS){return hR("<"+cA.toSafe(hS));};}(a.id))(hP)):"0";};b_.Map=function(hI,hJ){function hK(hL){return bX.map(hI,hL);}return hJ.$==1?new b_({$:1,$0:hK(hJ.$0)}):hJ.$==0?new b_({$:0,$0:hK(hJ.$0),$1:hK(hJ.$1)}):hJ.$==2?new b_({$:2,$0:hK(hJ.$0)}):hJ.$==3?new b_({$:3,$0:hK(hJ.$0)}):hJ.$==4?new b_({$:4,$0:hK(hJ.$0)}):b_.Nihil;};b_.Nihil=new b_({$:5});b_.refresh=function(hI,hJ,hK){function hL(hM,hN){var hO;hO=b9.refresh(hJ,hN);return[(hI.refresh(hJ))(hM),hO];}return hK.$==1?new b_({$:1,$0:bX.map(function(hM){return hL(hM[0],hM[1]);},hK.$0)}):hK.$==3?new b_({$:3,$0:bX.map(function(hM){return hL(hM[0],hM[1]);},hK.$0)}):hK.$==4?new b_({$:4,$0:bX.map(function(hM){return hL(hM[0],hM[1]);},hK.$0)}):hK.$==2?new b_({$:2,$0:bX.map(function(hM){return hL(hM[0],hM[1]);},hK.$0)}):hK.$==0?new b_({$:0,$0:bX.map(function(hM){return hL(hM[0],hM[1]);},hK.$0),$1:bX.map(function(hM){return hL(hM[0],hM[1]);},hK.$1)}):b_.Nihil;};b_.ToString=function(hI){return b_.ToStringWith(ew.get_empty(),hI);};b_.Canonical=function(hI,hJ){function hK(hL,hM){return[hI.toCanonicalForm(hL),hM];}return b_.Map(function(hL){return hK(hL[0],hL[1]);},hJ);};b$.Compare=function(hI,hJ,hK){return bX.compareWith(function(hL,hM){var hN;return((hN=hI.compare,(hB.Curried3(bX.compareWith))(function(hO,hP){return(hN(hO))(hP);}))(hL))(hM);},b$.ToList(hJ),b$.ToList(hK));};b$.Map=function(hI,hJ){return{$:0,$0:bW.Map(function(hK,hL){return bX.map(hI,hL);},hJ.$0)};};b$.Canonical=function(hI,hJ){return hI.toCanonicalFormProcess(hJ);};b$.ToList=function(hI){return bX.map(function(hJ){return hJ[1];},bX.ofSeq(bW.ToSeq(hI.$0)));};b$.OfList=function(hI){return{$:0,$0:bW.OfArray(ck.ofSeq(bX.mapi(function(hJ,hK){return[hJ,hK];},hI)))};};b$.ToStringWith=function(hI,hJ){var hK,hL,hM,hN,hO,hP;function hQ(hS){return hS[1];}function hR(hS){return cS.concat(" ",hS);}return cS.concat(" | ",(hK=bX.ofSeq(bW.ToSeq(hJ.$0)),bX.map((hL=(hM=(hN=(hO=hI.toString,function(hS){return bX.map(hO,hS);}),function(hS){return hN(hQ(hS));}),function(hS){return hR(hM(hS));}),(hP=function(hS){return function(hT){return hS("<"+cA.toSafe(hT)+">");};}(a.id),function(hS){return hP(hL(hS));})),hK)));};b$.ToString=function(hI){return b$.ToStringWith(ew.get_empty(),hI);};b$.Fold=function(hI,hJ,hK){return bW.Fold(function(hL,hM,hN){return co.fold(hI,hL,hN);},hJ,hK.$0);};b$.refresh=function(hI,hJ,hK){return b$.Map(hI.refresh(hJ),hK);};ca.ToStringWith=function(hI,hJ){var hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h3,h4;function h0(h5){return ca.ToStringWith(hI,h5);}function h1(h5){var h6,h7;function h8(h9){return ca.ToStringWith(hI,h9);}if(h5.$==3&&(h5.$0==="_functionalRate"?h5.$1.$==1&&(h5.$1.$1.$==0&&(h6=h5.$1.$0,true)):h5.$0==="_massActionRate"&&(h5.$1.$==1&&(h5.$1.$1.$==0&&(h6=h5.$1.$0,true))))){if(cw.Equals(h6,{$:2,$0:1}))return"";else switch(h5.$==3?h5.$0==="_massActionRate"?0:h5.$0==="_functionalRate"?1:2:2){case 0:return(function(h9){return function(h_){return h9("{"+cA.toSafe(h_)+"}");};}(a.id))(br.to_string(function(h9){return ca.ToStringWith(hI,h9);},ca.ToExpression(h6)));case 1:return(function(h9){return function(h_){return h9("["+cA.toSafe(h_)+"]");};}(a.id))(br.to_string(function(h9){return bq.to_string(h8,h9);},ca.ToFuncExpression(h6)));case 2:return be.FailWith("");}}else return(function(h9){return function(h_){return h9("Ill-formed rate "+cA.toSafe(h_));};}(be.FailWith))(ca.ToStringWith(hI,h5));}function h2(h5,h6){return h5===1?h0(h6):(((hB.Curried3(function(h7,h8,h9){return h7(a.String(h8)+" "+cA.toSafe(h9));}))(a.id))(h5))(h0(h6));}if(hJ.$==1)return(function(h5){return function(h6){return h5("\\""+cA.toSafe(h6)+"\\"");};}(a.id))(hJ.$0);else if(hJ.$==2)return(function(h5){return function(h6){return h5(h6.toFixed(6));};}(a.id))(hJ.$0);else if(hJ.$==3){h3=hJ.$1;h4=hJ.$0;if(h4==="_ctx")switch(h3.$==1?h3.$1.$==1?h3.$1.$0.$==0?h3.$1.$1.$==0?(hK=[h3.$1.$0.$0,h3.$1.$0.$1],0):2:h3.$1.$0.$==4?h3.$1.$1.$==0?(hK=h3.$1.$0.$0,1):2:2:2:2){case 0:return(function(h5){return function(h6){return h5("ctx("+cA.toSafe(h6)+")");};}(a.id))(b8.printVar(hK[0],hK[1]));case 1:return(function(h5){return function(h6){return h5("ctx("+cA.toSafe(h6)+")");};}(a.id))(cS.concat("",bX.map(h0,hK)));case 2:return(function(h5){return function(h6){return h5("Ill-formed context "+cA.toSafe(h6)+" in");};}(a.id))(h0(hJ));}else return h4==="_rxn"?h3.$==1&&(h3.$1.$==1&&(h3.$1.$1.$==1&&(h3.$1.$1.$1.$==1&&(h3.$1.$1.$1.$1.$==1&&(h3.$1.$1.$1.$1.$1.$==0&&(hL=[h3.$1.$1.$1.$0,h3.$0,h3.$1.$0,h3.$1.$1.$1.$1.$0,h3.$1.$1.$0],true))))))?(hM=hL[0],hN=hL[1],hO=h0(hL[2]),hP=h0(hL[3]),hQ=h1(hL[4]),hR=!cw.Equals(hN,{$:7,$0:bY.Empty}),hS=hR?h0(hN):"",hT=!cw.Equals(hM,{$:3,$0:"",$1:bY.Empty}),hU=hT?h1(hM):"",hR?hT?((((((hB.Curried(function(h5,h6,h7,h8,h9,h_){return h5(cA.toSafe(h6)+" ~ "+cA.toSafe(h7)+" <->"+cA.toSafe(h8)+cA.toSafe(h9)+" "+cA.toSafe(h_));},6))(a.id))(hS))(hO))(hQ))(hU))(hP):(((((hB.Curried(function(h5,h6,h7,h8,h9){return h5(cA.toSafe(h6)+" ~ "+cA.toSafe(h7)+" ->"+cA.toSafe(h8)+" "+cA.toSafe(h9));},5))(a.id))(hS))(hO))(hQ))(hP):hT?(((((hB.Curried(function(h5,h6,h7,h8,h9){return h5(cA.toSafe(h6)+" <->"+cA.toSafe(h7)+cA.toSafe(h8)+" "+cA.toSafe(h9));},5))(a.id))(hO))(hQ))(hU))(hP):((((hB.Curried(function(h5,h6,h7,h8){return h5(cA.toSafe(h6)+" ->"+cA.toSafe(h7)+" "+cA.toSafe(h8));},4))(a.id))(hO))(hQ))(hP)):(function(h5){return function(h6){return h5("Ill-formed reaction "+cA.toSafe(h6)+" in");};}(a.id))(h0(hJ)):(((hB.Curried3(function(h5,h6,h7){return h5(cA.toSafe(h6)+"("+cA.toSafe(h7)+")");}))(a.id))(h4))(cS.concat(", ",bX.map(h0,h3)));}else return hJ.$==4?(hV=cS.concat("; ",bX.map(h0,hJ.$0)),(function(h5){return function(h6){return h5("["+cA.toSafe(h6)+"]");};}(a.id))(hV)):hJ.$==5?(hW=ca.FlattenList(hJ),hW.$==1?(hX=cS.concat("; ",bX.map(h0,hW.$0[0])),hY=h0(hW.$0[1]),(((hB.Curried3(function(h5,h6,h7){return h5("["+cA.toSafe(h6)+" # "+cA.toSafe(h7)+"]");}))(a.id))(hX))(hY)):h0({$:4,$0:hW.$0})):hJ.$==6?(hZ=cS.concat(" | ",bX.map(h0,hJ.$0)),(function(h5){return function(h6){return h5("{ "+cA.toSafe(h6)+" }");};}(a.id))(hZ)):hJ.$==7?cS.concat(":",bX.map(function(h5){return h2(h5[0],h5[1]);},hJ.$0)):hJ.$==9?b_.ToStringWith(hI,hJ.$0):hJ.$==8?b$.ToStringWith(hI,hJ.$0):b8.printVar(hJ.$0,hJ.$1);};ca.ToExpression=function(hI){var hJ;switch(hI.$==2?(hJ=hI.$0,0):hI.$==3?hI.$0==="_key"?hI.$1.$==1?hI.$1.$0.$==2?hI.$1.$1.$==0?(hJ=hI.$1.$0.$0,1):14:hI.$1.$1.$==0?(hJ=hI.$1.$0,2):14:14:hI.$0==="_Times"?(hJ=hI.$1,3):hI.$0==="_Plus"?(hJ=hI.$1,4):hI.$0==="_Divide"?hI.$1.$==1?hI.$1.$1.$==1?hI.$1.$1.$1.$==0?(hJ=[hI.$1.$0,hI.$1.$1.$0],5):14:14:14:hI.$0==="_Power"?hI.$1.$==1?hI.$1.$1.$==1?hI.$1.$1.$1.$==0?(hJ=[hI.$1.$0,hI.$1.$1.$0],6):14:14:14:hI.$0==="_Minus"?hI.$1.$==1?hI.$1.$1.$==1?hI.$1.$1.$1.$==0?(hJ=[hI.$1.$0,hI.$1.$1.$0],7):14:14:14:hI.$0==="_Absolute"?hI.$1.$==1?hI.$1.$1.$==0?(hJ=hI.$1.$0,8):14:14:hI.$0==="_Log"?hI.$1.$==1?hI.$1.$1.$==0?(hJ=hI.$1.$0,9):14:14:hI.$0==="_Modulo"?hI.$1.$==1?hI.$1.$1.$==1?hI.$1.$1.$1.$==0?(hJ=[hI.$1.$0,hI.$1.$1.$0],10):14:14:14:hI.$0==="_Ceiling"?hI.$1.$==1?hI.$1.$1.$==0?(hJ=hI.$1.$0,11):14:14:hI.$0==="_Floor"?hI.$1.$==1?hI.$1.$1.$==0?(hJ=hI.$1.$0,12):14:14:hI.$0==="_Round"?hI.$1.$==1?hI.$1.$1.$==0?(hJ=hI.$1.$0,13):14:14:14:14){case 0:return{$:1,$0:hJ};case 1:return{$:1,$0:hJ};case 2:return{$:0,$0:hJ};case 3:return{$:2,$0:bX.map(ca.ToExpression,hJ)};case 4:return{$:5,$0:bX.map(ca.ToExpression,hJ)};case 5:return{$:3,$0:bw.New(ca.ToExpression(hJ[0]),ca.ToExpression(hJ[1]))};case 6:return{$:4,$0:bv.New(ca.ToExpression(hJ[0]),ca.ToExpression(hJ[1]))};case 7:return{$:6,$0:bu.New(ca.ToExpression(hJ[0]),ca.ToExpression(hJ[1]))};case 8:return{$:7,$0:ca.ToExpression(hJ)};case 9:return{$:8,$0:ca.ToExpression(hJ)};case 10:return{$:9,$0:bt.New(ca.ToExpression(hJ[0]),ca.ToExpression(hJ[1]))};case 11:return{$:10,$0:ca.ToExpression(hJ)};case 12:return{$:11,$0:ca.ToExpression(hJ)};case 13:return{$:12,$0:ca.ToExpression(hJ)};case 14:return(function(hK){return function(hL){return hK("Conversion of term "+cA.toSafe(hL)+" to expression not supported.");};}(be.FailWith))(ca.ToString(hI));}};ca.ToFuncExpression=function(hI){var hJ;switch(hI.$==1?hI.$0==="_time"?0:(hJ=hI.$0,1):hI.$==2?(hJ=hI.$0,2):hI.$==3?hI.$0==="_key"?hI.$1.$==1?hI.$1.$0.$==2?hI.$1.$1.$==0?(hJ=hI.$1.$0.$0,3):19:hI.$1.$1.$==0?(hJ=hI.$1.$0,4):19:19:hI.$0==="_key_species"?hI.$1.$==1?hI.$1.$1.$==0?(hJ=hI.$1.$0,5):19:19:hI.$0==="_key_param"?hI.$1.$==1?hI.$1.$0.$==1?hI.$1.$1.$==0?(hJ=hI.$1.$0.$0,6):19:19:19:hI.$0==="_key_rate"?hI.$1.$==1?hI.$1.$0.$==1?hI.$1.$1.$==0?(hJ=hI.$1.$0.$0,7):19:19:19:hI.$0==="_Times"?(hJ=hI.$1,8):hI.$0==="_Plus"?(hJ=hI.$1,9):hI.$0==="_Divide"?hI.$1.$==1?hI.$1.$1.$==1?hI.$1.$1.$1.$==0?(hJ=[hI.$1.$0,hI.$1.$1.$0],10):19:19:19:hI.$0==="_Power"?hI.$1.$==1?hI.$1.$1.$==1?hI.$1.$1.$1.$==0?(hJ=[hI.$1.$0,hI.$1.$1.$0],11):19:19:19:hI.$0==="_Minus"?hI.$1.$==1?hI.$1.$1.$==1?hI.$1.$1.$1.$==0?(hJ=[hI.$1.$0,hI.$1.$1.$0],12):19:19:19:hI.$0==="_Absolute"?hI.$1.$==1?hI.$1.$1.$==0?(hJ=hI.$1.$0,13):19:19:hI.$0==="_Log"?hI.$1.$==1?hI.$1.$1.$==0?(hJ=hI.$1.$0,14):19:19:hI.$0==="_Modulo"?hI.$1.$==1?hI.$1.$1.$==1?hI.$1.$1.$1.$==0?(hJ=[hI.$1.$0,hI.$1.$1.$0],15):19:19:19:hI.$0==="_Ceiling"?hI.$1.$==1?hI.$1.$1.$==0?(hJ=hI.$1.$0,16):19:19:hI.$0==="_Floor"?hI.$1.$==1?hI.$1.$1.$==0?(hJ=hI.$1.$0,17):19:19:hI.$0==="_Round"?hI.$1.$==1?hI.$1.$1.$==0?(hJ=hI.$1.$0,18):19:19:19:19){case 0:return{$:0,$0:bq.Time};case 1:return{$:0,$0:{$:0,$0:hJ}};case 2:return{$:1,$0:hJ};case 3:return{$:1,$0:hJ};case 4:return{$:0,$0:{$:2,$0:hJ}};case 5:return{$:0,$0:{$:2,$0:hJ}};case 6:return{$:0,$0:{$:0,$0:hJ}};case 7:return{$:0,$0:{$:1,$0:hJ}};case 8:return{$:2,$0:bX.map(ca.ToFuncExpression,hJ)};case 9:return{$:5,$0:bX.map(ca.ToFuncExpression,hJ)};case 10:return{$:3,$0:bw.New(ca.ToFuncExpression(hJ[0]),ca.ToFuncExpression(hJ[1]))};case 11:return{$:4,$0:bv.New(ca.ToFuncExpression(hJ[0]),ca.ToFuncExpression(hJ[1]))};case 12:return{$:6,$0:bu.New(ca.ToFuncExpression(hJ[0]),ca.ToFuncExpression(hJ[1]))};case 13:return{$:7,$0:ca.ToFuncExpression(hJ)};case 14:return{$:8,$0:ca.ToFuncExpression(hJ)};case 15:return{$:9,$0:bt.New(ca.ToFuncExpression(hJ[0]),ca.ToFuncExpression(hJ[1]))};case 16:return{$:10,$0:ca.ToFuncExpression(hJ)};case 17:return{$:11,$0:ca.ToFuncExpression(hJ)};case 18:return{$:12,$0:ca.ToFuncExpression(hJ)};case 19:return(function(hK){return function(hL){return hK("Conversion of term "+cA.toSafe(hL)+" to expression not supported.");};}(be.FailWith))(ca.ToString(hI));}};ca.FlattenList=function(hI){function hJ(hK){var hL,hM;return hK.$==5?(hL=hK.$0,(hM=hJ(hK.$1),hM.$==1?{$:1,$0:[new bY({$:1,$0:hL,$1:hM.$0[0]}),hM.$0[1]]}:{$:0,$0:new bY({$:1,$0:hL,$1:hM.$0})})):hK.$==4?{$:0,$0:hK.$0}:hK.$==0?{$:1,$0:[bY.Empty,{$:0,$0:hK.$0,$1:hK.$1}]}:be.FailWith((function(hN){return function(hO){return hN("Ill-formed list: "+cA.toSafe(hO));};}(a.id))(ca.ToString(hK)));}return hJ(hI);};ca.ToString=function(hI){return ca.ToStringWith(ew.get_empty(),hI);};ca.refresh=function(hI,hJ,hK){var hL,hM;function hN(hO,hP){return[hO,ca.refresh(hI,hJ,hP)];}switch(hK.$==3?(hL=[hK.$1,hK.$0],2):hK.$==1?3:hK.$==2?4:hK.$==9?(hL=hK.$0,5):hK.$==8?(hL=hK.$0,6):hK.$==5?(hL=[hK.$0,hK.$1],7):hK.$==4?(hL=hK.$0,8):hK.$==6?(hL=hK.$0,9):hK.$==7?(hL=hK.$0,10):hK.$0===-1?hK.$1==="_"?0:(hL=[hK.$0,hK.$1],1):(hL=[hK.$0,hK.$1],1)){case 0:return hK;case 1:hM=hL[1];return{$:0,$0:hJ(hM),$1:hM};case 2:return{$:3,$0:hL[1],$1:bX.map(function(hO){return ca.refresh(hI,hJ,hO);},hL[0])};case 3:return hK;case 4:return hK;case 5:return{$:9,$0:b_.refresh(hI,hJ,hL)};case 6:return{$:8,$0:b$.refresh(hI,hJ,hL)};case 7:return{$:5,$0:ca.refresh(hI,hJ,hL[0]),$1:ca.refresh(hI,hJ,hL[1])};case 8:return{$:4,$0:bX.map(function(hO){return ca.refresh(hI,hJ,hO);},hL)};case 9:return{$:6,$0:bX.map(function(hO){return ca.refresh(hI,hJ,hO);},hL)};case 10:return{$:7,$0:bX.map(function(hO){return hN(hO[0],hO[1]);},hL)};}};ca.IsExpression=function(hI){return hI.$==2||hI.$==3&&(hI.$0==="_key"?hI.$1.$==1&&hI.$1.$1.$==0:hI.$0==="_key_species"?hI.$1.$==1&&hI.$1.$1.$==0:hI.$0==="_key_param"?hI.$1.$==1&&hI.$1.$1.$==0:hI.$0==="_key_rate"?hI.$1.$==1&&hI.$1.$1.$==0:hI.$0==="_Times"?bX.forAll(ca.IsExpression,hI.$1):hI.$0==="_Plus"?bX.forAll(ca.IsExpression,hI.$1):hI.$0==="_Divide"?hI.$1.$==1&&(hI.$1.$1.$==1&&(hI.$1.$1.$1.$==0&&(ca.IsExpression(hI.$1.$0)&&ca.IsExpression(hI.$1.$1.$0)))):hI.$0==="_Power"?hI.$1.$==1&&(hI.$1.$1.$==1&&(hI.$1.$1.$1.$==0&&(ca.IsExpression(hI.$1.$0)&&ca.IsExpression(hI.$1.$1.$0)))):hI.$0==="_Minus"?hI.$1.$==1&&(hI.$1.$1.$==1&&(hI.$1.$1.$1.$==0&&(ca.IsExpression(hI.$1.$0)&&ca.IsExpression(hI.$1.$1.$0)))):hI.$0==="_Absolute"?hI.$1.$==1&&(hI.$1.$1.$==0&&ca.IsExpression(hI.$1.$0)):hI.$0==="_Log"?hI.$1.$==1&&(hI.$1.$1.$==0&&ca.IsExpression(hI.$1.$0)):hI.$0==="_Modulo"?hI.$1.$==1&&(hI.$1.$1.$==1&&(hI.$1.$1.$1.$==0&&(ca.IsExpression(hI.$1.$0)&&ca.IsExpression(hI.$1.$1.$0)))):hI.$0==="_Ceiling"?hI.$1.$==1&&(hI.$1.$1.$==0&&ca.IsExpression(hI.$1.$0)):hI.$0==="_Floor"?hI.$1.$==1&&(hI.$1.$1.$==0&&ca.IsExpression(hI.$1.$0)):hI.$0==="_Round"&&(hI.$1.$==1&&(hI.$1.$1.$==0&&ca.IsExpression(hI.$1.$0))));};ca.FromExpression=function(hI){var hJ,hK,hL,hM;return hI.$==0?{$:3,$0:"_key",$1:bX.ofArray([hI.$0])}:hI.$==2?{$:3,$0:"_Times",$1:bX.map(ca.FromExpression,hI.$0)}:hI.$==5?{$:3,$0:"_Plus",$1:bX.map(ca.FromExpression,hI.$0)}:hI.$==3?(hJ=hI.$0,{$:3,$0:"_Divide",$1:bX.ofArray([ca.FromExpression(hJ.div1),ca.FromExpression(hJ.div2)])}):hI.$==4?(hK=hI.$0,{$:3,$0:"_Power",$1:bX.ofArray([ca.FromExpression(hK.base_),ca.FromExpression(hK.exponent)])}):hI.$==6?(hL=hI.$0,{$:3,$0:"_Minus",$1:bX.ofArray([ca.FromExpression(hL.sub1),ca.FromExpression(hL.sub2)])}):hI.$==7?{$:3,$0:"_Absolute",$1:bX.ofArray([ca.FromExpression(hI.$0)])}:hI.$==8?{$:3,$0:"_Log",$1:bX.ofArray([ca.FromExpression(hI.$0)])}:hI.$==9?(hM=hI.$0,{$:3,$0:"_Modulo",$1:bX.ofArray([ca.FromExpression(hM.div),ca.FromExpression(hM.modulo)])}):hI.$==10?{$:3,$0:"_Ceiling",$1:bX.ofArray([ca.FromExpression(hI.$0)])}:hI.$==11?{$:3,$0:"_Floor",$1:bX.ofArray([ca.FromExpression(hI.$0)])}:hI.$==12?{$:3,$0:"_Round",$1:bX.ofArray([ca.FromExpression(hI.$0)])}:hI.$==13?be.FailWith("Conditional expression are not supported yet."):{$:2,$0:hI.$0};};ca.FromFuncExpression=function(hI){var hJ,hK,hL,hM,hN;return hI.$==0?(hJ=hI.$0,hJ.$==0?{$:3,$0:"_key_param",$1:bX.ofArray([{$:1,$0:hJ.$0}])}:hJ.$==1?{$:3,$0:"_key_rate",$1:bX.ofArray([{$:1,$0:hJ.$0}])}:hJ.$==3?{$:1,$0:"_time"}:{$:3,$0:"_key_species",$1:bX.ofArray([hJ.$0])}):hI.$==2?{$:3,$0:"_Times",$1:bX.map(ca.FromFuncExpression,hI.$0)}:hI.$==5?{$:3,$0:"_Plus",$1:bX.map(ca.FromFuncExpression,hI.$0)}:hI.$==3?(hK=hI.$0,{$:3,$0:"_Divide",$1:bX.ofArray([ca.FromFuncExpression(hK.div1),ca.FromFuncExpression(hK.div2)])}):hI.$==4?(hL=hI.$0,{$:3,$0:"_Power",$1:bX.ofArray([ca.FromFuncExpression(hL.base_),ca.FromFuncExpression(hL.exponent)])}):hI.$==6?(hM=hI.$0,{$:3,$0:"_Minus",$1:bX.ofArray([ca.FromFuncExpression(hM.sub1),ca.FromFuncExpression(hM.sub2)])}):hI.$==7?{$:3,$0:"_Absolute",$1:bX.ofArray([ca.FromFuncExpression(hI.$0)])}:hI.$==8?{$:3,$0:"_Log",$1:bX.ofArray([ca.FromFuncExpression(hI.$0)])}:hI.$==9?(hN=hI.$0,{$:3,$0:"_Modulo",$1:bX.ofArray([ca.FromFuncExpression(hN.div),ca.FromFuncExpression(hN.modulo)])}):hI.$==10?{$:3,$0:"_Ceiling",$1:bX.ofArray([ca.FromFuncExpression(hI.$0)])}:hI.$==11?{$:3,$0:"_Floor",$1:bX.ofArray([ca.FromFuncExpression(hI.$0)])}:hI.$==12?{$:3,$0:"_Round",$1:bX.ofArray([ca.FromFuncExpression(hI.$0)])}:hI.$==13?be.FailWith("Conditional expression are not supported yet."):{$:2,$0:hI.$0};};ca.Compare=function(hI,hJ,hK){var hL,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hX,hY,hZ,h0,h1,h2,h3,h4,h5,h6,h7,h8,h9;function hM(h_){return h_.$==1?1:h_.$==2?2:h_.$==9?3:h_.$==8?4:h_.$==5?5:h_.$==4?6:h_.$==0?7:h_.$==6?8:h_.$==7?9:0;}hN=hM(hJ);hO=hM(hK);function hW(h_,h$){return function(ia){var ib;ib=(hI.compare(h_))(ia[0]);return ib===b8.EQ()?b9.Compare(h$,ia[1]):ib;};}if(hN<hO)return b8.LT();else if(hN>hO)return b8.GT();else switch(hJ.$==1?hK.$==1?(hL=[hJ.$0,hK.$0],1):12:hJ.$==2?hK.$==2?(hL=[hJ.$0,hK.$0],2):12:hJ.$==0?hK.$==0?(hL=[hJ.$1,hK.$1],3):12:hJ.$==9?hK.$==9?(hL=[hJ.$0,hK.$0],4):12:hJ.$==4?hK.$==4?(hL=[hJ.$0,hK.$0],5):hK.$==5?(hL=[hK.$0,hJ.$0,hK.$1],7):12:hJ.$==5?hK.$==4?(hL=[hJ.$0,hJ.$1,hK.$0],6):hK.$==5?(hL=[hJ.$0,hK.$0,hJ.$1,hK.$1],8):12:hJ.$==7?hK.$==7?(hL=[hJ.$0,hK.$0],9):12:hJ.$==6?hK.$==6?(hL=[hJ.$0,hK.$0],10):12:hJ.$==8?hK.$==8?(hL=[hJ.$0,hK.$0],11):12:hK.$==3?(hL=[hJ.$1,hK.$1,hJ.$0,hK.$0],0):12){case 0:hP=cw.Compare(hL[2],hL[3]);return hP<0?b8.LT():hP>0?b8.GT():(hQ=bX.zip(hL[0],hL[1]),co.fold(function(h_,h$){return h_===b8.GT()||h_===b8.LT()?h_:ca.Compare(hI,h$[0],h$[1]);},b8.EQ(),hQ));case 1:return cw.Compare(hL[0],hL[1]);case 2:hR=hL[0];hS=hL[1];return hR<hS?b8.LT():hR>hS?b8.GT():b8.EQ();case 3:return cw.Compare(hL[0],hL[1]);case 4:hT=hL[1];hU=hL[0];return hU.$==1&&(hT.$==1&&(hV=[hU.$0,hT.$0],true))?bX.compareWith(function(h_,h$){return(function(ia){return hW(ia[0],ia[1]);}(h_))(h$);},hV[0],hV[1]):be.FailWith("Tagging a domain with a pattern is not supported yet.");case 5:hX=hL[0];hY=hL[1];return hX.$==0&&hY.$==0?b8.EQ():hX.$==0?b8.GT():(hZ=ca.Compare(hI,bX.head(hX),bX.head(hY)),hZ===b8.EQ()?ca.Compare(hI,{$:4,$0:bX.tail(hX)},{$:4,$0:bX.tail(hY)}):hZ);case 6:h0=hL[2];return h0.$==0?b8.LT():(h1=ca.Compare(hI,hL[0],bX.head(h0)),h1===b8.EQ()?ca.Compare(hI,hL[1],{$:4,$0:bX.tail(h0)}):h1);case 7:h2=hL[1];return h2.$==0?b8.LT():(h3=ca.Compare(hI,bX.head(h2),hL[0]),h3===b8.EQ()?ca.Compare(hI,{$:4,$0:bX.tail(h2)},hL[2]):h3);case 8:h4=ca.Compare(hI,hL[0],hL[1]);return h4===b8.EQ()?ca.Compare(hI,hL[2],hL[3]):h4;case 9:h5=hL[1];h6=hL[0];return h6.$==1?h5.$==1?(h7=h6.$0[0],h8=h5.$0[0],h7===h8?(h9=ca.Compare(hI,h6.$0[1],h5.$0[1]),h9!==b8.EQ()?h9:ca.Compare(hI,{$:7,$0:h6.$1},{$:7,$0:h5.$1})):cw.Compare(h7,h8)):b8.GT():h5.$==0?b8.EQ():b8.LT();case 10:return ca.Compare(hI,{$:4,$0:hL[0]},{$:4,$0:hL[1]});case 11:return b$.Compare(hI,hL[0],hL[1]);case 12:return be.FailWith("");}};ca.Canonical=function(hI,hJ){function hK(hM,hN){return function(hO){var hP;hP=cw.Compare(hM,hO[0]);return hP!==b8.EQ()?hP:ca.Compare(hI,hN,hO[1]);};}function hL(hM,hN){return[hM,ca.Canonical(hI,hN)];}return hJ.$==1?hJ:hJ.$==2?hJ:hJ.$==9?{$:9,$0:b_.Canonical(hI,hJ.$0)}:hJ.$==8?{$:8,$0:b$.Canonical(hI,hJ.$0)}:hJ.$==5?{$:5,$0:ca.Canonical(hI,hJ.$0),$1:ca.Canonical(hI,hJ.$1)}:hJ.$==4?{$:4,$0:bX.map(function(hM){return ca.Canonical(hI,hM);},hJ.$0)}:hJ.$==0?hJ:hJ.$==7?{$:7,$0:bX.sortWith(function(hM,hN){return(function(hO){return hK(hO[0],hO[1]);}(hM))(hN);},bX.map(function(hM){return hL(hM[0],hM[1]);},hJ.$0))}:hJ.$==6?{$:6,$0:bX.distinct(bX.sortWith(function(hM,hN){return ca.Compare(hI,hM,hN);},bX.map(function(hM){return ca.Canonical(hI,hM);},hJ.$0)))}:{$:3,$0:hJ.$0,$1:bX.map(function(hM){return ca.Canonical(hI,hM);},hJ.$1)};};cb.NoTag={$:0};cb.AnyTag={$:1};cb.ToString=function(hI){return hI.$==1?"":hI.$==2?(function(hJ){return function(hK){return hJ("{"+cA.toSafe(hK)+"}");};}(a.id))(ca.ToString(hI.$0)):"{}";};cb.Compare=function(hI,hJ,hK){return hJ.$==1?hK.$==1?b8.EQ():hK.$==2?b8.LT():b8.GT():hJ.$==2?hK.$==2?ca.Compare(hI,hJ.$0,hK.$0):b8.GT():hK.$==0?b8.EQ():b8.LT();};cb.Canonical=function(hI,hJ){return hJ.$==1?hJ:hJ.$==2?{$:2,$0:ca.Canonical(hI,hJ.$0)}:hJ;};cc=b5.Domain=hB.Class({toString:function(){return cc.ToString(this);}},null,cc);cc.ToString=function(hI){return hI.name+(hI.isToehold?"^":"")+(hI.isComplementary?"*":"")+(hI.tag.$===0?"":cb.ToString(hI.tag));};cc.Create$1=function(hI,hJ,hK,hL){return cc.New(hI,hJ,hK,hL);};cc.Canonical=function(hI,hJ){return cc.New(hJ.name,hJ.isComplementary,hJ.isToehold,cb.Canonical(hI,hJ.tag));};cc.Compare=function(hI,hJ){var hK,hL,hM,hN,hO,hP;hL=cw.Compare(hI.name,hJ.name);if(hL===b8.LT())return b8.LT();else if(hL===b8.GT())return b8.GT();else if(hL===b8.EQ()){hM=hJ.isToehold;switch(hI.isToehold?hM?2:0:hM?1:2){case 0:return b8.LT();case 1:return b8.GT();case 2:hP=hJ.isComplementary;switch(hI.isComplementary?hP?2:0:hP?1:2){case 0:hN=b8.LT();break;case 1:hN=b8.GT();break;case 2:hN=b8.EQ();break;}return hN;}}else return be.FailWith("Unexpected error.");};cc.New=function(hI,hJ,hK,hL){return new cc({name:hI,isComplementary:hJ,isToehold:hK,tag:hL});};cd=b5.DomainT=hB.Class({toString:function(){return cd.ToString(this);}},null,cd);cd.ToString=function(hI){var hJ;return hI.$==1?(hJ=hI.$0,b8.printVar(hJ[0],hJ[1])+cb.ToString(hI.$1)):cc.ToString(hI.$0);};cd.Canonical=function(hI,hJ){return hJ.$==0?new cd({$:0,$0:cc.Canonical(hI,hJ.$0)}):hJ;};cd.Compare=function(hI,hJ,hK){var hL,hN,hO,hP,hQ,hR,hS;function hM(hT){var hU,hV;return hT.$==1?(hU=hT.$1,hU.$==0?4:hU.$==2?5:3):(hV=hT.$0.tag,hV.$==1?1:hV.$==2?2:0);}hN=hM(hJ);hO=hM(hK);if(hN<hO)return b8.LT();else if(hN>hO)return b8.GT();else switch(hJ.$==0?hK.$==0?(hL=[hJ.$0,hK.$0],2):3:hJ.$1.$==0?hK.$==1?hK.$1.$==0?(hL=[hJ.$0[1],hK.$0[1]],0):(hL=[hJ.$0[1],hK.$0[1],hJ.$1,hK.$1],1):3:hK.$==1?(hL=[hJ.$0[1],hK.$0[1],hJ.$1,hK.$1],1):3){case 0:return cw.Compare(hL[0],hL[1]);case 1:hP=cw.Compare(hL[0],hL[1]);return hP===b8.EQ()?cb.Compare(hI,hL[2],hL[3]):hP;case 2:hQ=hL[0];hR=hL[1];hS=cc.Compare(hQ,hR);return hS===b8.EQ()?cb.Compare(hI,hQ.tag,hR.tag):hS;case 3:return be.FailWith("");}};ce=b5.Site=hB.Class({toString:function(){return ce.ToString(this);}},null,ce);ce.GetBonds=function(hI){return hI.$==1?(new cK.New$1(null)).Add(hI.$1):new cK.New$1(null);};ce.ToString=function(hI){return ce.ToStringWith(cd.ToString,hI);};ce.Canonical=function(hI,hJ){return hJ.$==0?new ce({$:0,$0:cd.Canonical(hI,hJ.$0)}):new ce({$:1,$0:cd.Canonical(hI,hJ.$0),$1:hJ.$1});};ce.Compare=function(hI,hJ,hK,hL){var hM;return hK.$==1?hL.$==1?(hM=cd.Compare(hI,hK.$0,hL.$0),hM===b8.LT()?b8.LT():hM===b8.GT()?b8.GT():hM===b8.EQ()?b6.Compare(hJ,hK.$1,hL.$1):be.FailWith("Unexpected error.")):b8.GT():hL.$==1?b8.LT():cd.Compare(hI,hK.$0,hL.$0);};ce.ToStringWith=function(hI,hJ){return hJ.$==1?(((hB.Curried3(function(hK,hL,hM){return hK(cA.toSafe(hL)+"!"+cA.toSafe(hM));}))(a.id))(hI(hJ.$0)))(b6.ToString(hJ.$1)):hI(hJ.$0);};ce.Map=function(hI,hJ){return hJ.$==1?new ce({$:1,$0:hJ.$0,$1:hI(hJ.$1)}):hJ;};cf=b5.SiteT=hB.Class({toString:function(){return cf.ToString(this);}},null,cf);cf.GetBonds=function(hI){return hI.$==1?new cK.New$1(null):ce.GetBonds(hI.$0);};cf.ToString=function(hI){return cf.ToStringWith(cd.ToString,hI);};cf.Canonical=function(hI,hJ){return hJ.$==0?new cf({$:0,$0:ce.Canonical(hI,hJ.$0)}):hJ;};cf.Compare=function(hI,hJ,hK,hL){return hK.$==0?hL.$==0?ce.Compare(hI,hJ,hK.$0,hL.$0):b8.GT():hL.$==0?b8.LT():cw.Compare(hK.$0[1],hL.$0[1]);};cf.ToStringWith=function(hI,hJ){var hK;return hJ.$==1?(hK=hJ.$0,b8.printVar(hK[0],hK[1])):ce.ToStringWith(hI,hJ.$0);};cf.Map=function(hI,hJ){return hJ.$==0?new cf({$:0,$0:ce.Map(hI,hJ.$0)}):hJ;};cg=b8.Predicate=hB.Class({get_Name:function(){return this.$0;},get_Args:function(){return this.$1;},get_String:function(){return cg.ToString(this);}},null,cg);cg.ToString=function(hI){return cg.ToStringWith(ew.get_empty(),new cg({$:0,$0:hI.$0,$1:hI.$1}));};cg.ToStringWith=function(hI,hJ){return(((hB.Curried3(function(hK,hL,hM){return hK(cA.toSafe(hL)+"("+cA.toSafe(hM)+")");}))(a.id))(hJ.$0))(cS.concat(", ",bX.map(function(hK){return ca.ToStringWith(hI,hK);},hJ.$1)));};cg.refresh=function(hI,hJ,hK){return new cg({$:0,$0:hK.$0,$1:bX.map(function(hL){return ca.refresh(hI,hJ,hL);},hK.$1)});};cg.Map=function(hI,hJ){return new cg({$:0,$0:hJ.$0,$1:bX.map(hI,hJ.$1)});};ch=b8.Literal=hB.Class({},null,ch);ch.refresh=function(hI,hJ,hK){return hK.$==1?new ch({$:1,$0:cg.refresh(hI,hJ,hK.$0)}):new ch({$:0,$0:cg.refresh(hI,hJ,hK.$0)});};ch.Map=function(hI,hJ){return hJ.$==1?new ch({$:1,$0:cg.Map(hI,hJ.$0)}):new ch({$:0,$0:cg.Map(hI,hJ.$0)});};ci=b8.Clause=hB.Class({},null,ci);ci.Create=function(hI){return ci.New(hI,bY.Empty);};ci.Map=function(hI,hJ){return ci.New(cg.Map(hI,hJ.head),bX.map(function(hK){return ch.Map(hI,hK);},hJ.body));};ci.Create$1=function(hI,hJ){return ci.New(hI,hJ);};ci.New=function(hI,hJ){return new ci({head:hI,body:hJ});};cj=bV.FSharpMap=hB.Class({Add:function(hI,hJ){return new cj.New$1(c6.Add(c8.New(hI,hJ),this.tree));},ContainsKey:function(hI){return c6.Contains(c8.New(hI,void 0),this.tree);},get_Item:function(hI){var hJ;hJ=this.TryFind(hI);return hJ==null?be.FailWith("The given key was not present in the dictionary."):hJ.$0;},TryFind:function(hI){var hJ;hJ=c6.TryFind(c8.New(hI,void 0),this.tree);return hJ==null?null:{$:1,$0:hJ.$0.Value};},Remove:function(hI){return new cj.New$1(c6.Remove(c8.New(hI,void 0),this.tree));},get_Count:function(){var hI;hI=this.tree;return hI==null?0:hI.Count;},get_IsEmpty:function(){return this.tree==null;},get_Tree:function(){return this.tree;},GetEnumerator$1:function(){return df.Get(co.map(function(hI){return{K:hI.Key,V:hI.Value};},c6.Enumerate(false,this.tree)));},Equals:function(hI){return this.get_Count()===hI.get_Count()&&co.forall2(cw.Equals,this,hI);},GetHashCode:function(){return cw.Hash(ck.ofSeq(this));},GetEnumerator:function(){return this.GetEnumerator$1();},GetEnumerator0:function(){return this.GetEnumerator$1();},CompareTo0:function(hI){return co.compareWith(cw.Compare,this,hI);}},b1,cj);cj.New=hB.Ctor(function(hI){cj.New$1.call(this,ed.fromSeq(hI));},cj);cj.New$1=hB.Ctor(function(hI){b1.New.call(this);this.tree=hI;},cj);ck.map=function(hI,hJ){var hK,hL,hM;hK=new a.Array(hJ.length);for(hL=0,hM=hJ.length-1;hL<=hM;hL++)hK[hL]=hI(hJ[hL]);return hK;};ck.iter=function(hI,hJ){var hK,hL;for(hK=0,hL=hJ.length-1;hK<=hL;hK++)hI(hJ[hK]);};ck.ofList=function(hI){var hJ,hK;hK=[];hJ=hI;while(!(hJ.$==0)){hK.push(bX.head(hJ));hJ=bX.tail(hJ);}return hK;};ck.last=function(hI){ck.nonEmpty(hI);return hI[hI.length-1];};ck.ofSeq=function(hI){var hJ,hK;if(hI instanceof a.Array)return hI.slice();else if(hI instanceof bY)return ck.ofList(hI);else{hJ=[];hK=df.Get(hI);try{while(hK.MoveNext())hJ.push(hK.Current());return hJ;}finally{if(typeof hK=="object"&&"Dispose"in hK)hK.Dispose();}}};ck.mapi2=function(hI,hJ,hK){var hL,hM,hN;ck.checkLength(hJ,hK);hL=new a.Array(hJ.length);for(hM=0,hN=hJ.length-1;hM<=hN;hM++)hL[hM]=hI(hM,hJ[hM],hK[hM]);return hL;};ck.mapi=function(hI,hJ){var hK,hL,hM;hK=new a.Array(hJ.length);for(hL=0,hM=hJ.length-1;hL<=hM;hL++)hK[hL]=hI(hL,hJ[hL]);return hK;};ck.iteri=function(hI,hJ){var hK,hL;for(hK=0,hL=hJ.length-1;hK<=hL;hK++)hI(hK,hJ[hK]);};ck.fold=function(hI,hJ,hK){var hL,hM,hN;hL=hJ;for(hM=0,hN=hK.length-1;hM<=hN;hM++)hL=hI(hL,hK[hM]);return hL;};ck.exists=function(hI,hJ){var hK,hL,hM,hN;hK=false;hL=0;hN=ck.length(hJ);while(!hK&&hL<hN)if(hI(hJ[hL]))hK=true;else hL=hL+1;return hK;};ck.create=function(hI,hJ){var hK,hL,hM;hK=new a.Array(hI);for(hL=0,hM=hI-1;hL<=hM;hL++)hK[hL]=hJ;return hK;};ck.init=function(hI,hJ){var hK,hL,hM;hI<0?be.FailWith("Negative size given."):null;hK=new a.Array(hI);for(hL=0,hM=hI-1;hL<=hM;hL++)hK[hL]=hJ(hL);return hK;};ck.tryFindIndex=function(hI,hJ){var hK,hL;hK=null;hL=0;while(hL<hJ.length&&hK==null){hI(hJ[hL])?hK={$:1,$0:hL}:void 0;hL=hL+1;}return hK;};ck.collect=function(hI,hJ){return a.Array.prototype.concat.apply([],ck.map(hI,hJ));};ck.concat=function(hI){return a.Array.prototype.concat.apply([],ck.ofSeq(hI));};ck.min=function(hI){var hJ,hK,hL,hM;ck.nonEmpty(hI);hJ=hI[0];for(hK=1,hL=hI.length-1;hK<=hL;hK++){hM=hI[hK];cw.Compare(hM,hJ)===-1?hJ=hM:void 0;}return hJ;};ck.max=function(hI){var hJ,hK,hL,hM;ck.nonEmpty(hI);hJ=hI[0];for(hK=1,hL=hI.length-1;hK<=hL;hK++){hM=hI[hK];cw.Compare(hM,hJ)===1?hJ=hM:void 0;}return hJ;};ck.findIndex=function(hI,hJ){var hK;hK=ck.tryFindIndex(hI,hJ);return hK==null?be.FailWith("KeyNotFoundException"):hK.$0;};ck.sortInPlaceWith=function(hI,hJ){hJ.sort(hI);};ck.map2=function(hI,hJ,hK){var hL,hM,hN;ck.checkLength(hJ,hK);hL=new a.Array(hK.length);for(hM=0,hN=hK.length-1;hM<=hN;hM++)hL[hM]=hI(hJ[hM],hK[hM]);return hL;};ck.nonEmpty=function(hI){if(hI.length===0)be.FailWith("The input array was empty.");};ck.average=function(hI){return a.Number(ck.sum(hI))/hI.length;};ck.sum=function(hI){var hJ,hK;hJ=0;hK=0;for(;hK<hI.length;hK++)hJ+=hI[hK];return hJ;};ck.unzip=function(hI){var hJ,hK,hL,hM,hN;hJ=[];hK=[];for(hL=0,hM=hI.length-1;hL<=hM;hL++){hN=hI[hL];hJ.push(hN[0]);hK.push(hN[1]);}return[hJ,hK];};ck.fold2=function(hI,hJ,hK,hL){var hM,hN,hO;ck.checkLength(hK,hL);hM=hJ;for(hN=0,hO=hK.length-1;hN<=hO;hN++)hM=hI(hM,hK[hN],hL[hN]);return hM;};ck.head=function(hI){ck.nonEmpty(hI);return hI[0];};ck.checkLength=function(hI,hJ){if(hI.length!==hJ.length)be.FailWith("The arrays have different lengths.");};ck.sortInPlace=function(hI){ck.mapInPlace(function(hJ){return hJ[0];},ck.mapiInPlace(function(hJ,hK){return[hK,hJ];},hI).sort(cw.Compare));};ck.partition=function(hI,hJ){var hK,hL,hM,hN;hK=[];hL=[];for(hM=0,hN=hJ.length-1;hM<=hN;hM++)if(hI(hJ[hM]))hK.push(hJ[hM]);else hL.push(hJ[hM]);return[hK,hL];};ck.pick=function(hI,hJ){var hK;hK=ck.tryPick(hI,hJ);return hK==null?be.FailWith("KeyNotFoundException"):hK.$0;};ck.filter=function(hI,hJ){var hK,hL,hM;hK=[];for(hL=0,hM=hJ.length-1;hL<=hM;hL++)if(hI(hJ[hL]))hK.push(hJ[hL]);return hK;};ck.sortInPlaceBy=function(hI,hJ){ck.mapInPlace(function(hK){return hK[0];},ck.mapiInPlace(function(hK,hL){return[hL,[hI(hL),hK]];},hJ).sort(function(hK,hL){return cw.Compare(hK[1],hL[1]);}));};ck.reduce=function(hI,hJ){var hK,hL,hM;ck.nonEmpty(hJ);hK=hJ[0];for(hL=1,hM=hJ.length-1;hL<=hM;hL++)hK=hI(hK,hJ[hL]);return hK;};ck.unzip3=function(hI){var hJ,hK,hL,hM,hN,hO;hJ=[];hK=[];hL=[];for(hM=0,hN=hI.length-1;hM<=hN;hM++){hO=hI[hM];hJ.push(hO[0]);hK.push(hO[1]);hL.push(hO[2]);}return[hJ,hK,hL];};ck.foldBack=function(hI,hJ,hK){var hL,hM,hN,hO,hP;hL=hK;hN=hJ.length;for(hO=1,hP=hN;hO<=hP;hO++)hL=hI(hJ[hN-hO],hL);return hL;};ck.findIndexBack=function(hI,hJ){var hK;hK=ck.tryFindIndexBack(hI,hJ);return hK==null?be.FailWith("KeyNotFoundException"):hK.$0;};ck.allPairs=function(hI,hJ){var hK,hL,hM,hN,hO,hP,hQ;hK=hI.length;hL=hJ.length;hM=new a.Array(hK*hL);for(hN=0,hO=hK-1;hN<=hO;hN++){for(hP=0,hQ=hL-1;hP<=hQ;hP++)hM[hN*hL+hP]=[hI[hN],hJ[hP]];}return hM;};ck.tryPick=function(hI,hJ){var hK,hL,hM;hK=null;hL=0;while(hL<hJ.length&&hK==null){hM=hI(hJ[hL]);hM!=null&&hM.$==1?hK=hM:void 0;hL=hL+1;}return hK;};ck.choose=function(hI,hJ){var hK,hL,hM,hN;hK=[];for(hL=0,hM=hJ.length-1;hL<=hM;hL++){hN=hI(hJ[hL]);hN==null?void 0:hK.push(hN.$0);}return hK;};ck.sumBy=function(hI,hJ){var hK,hL;hK=0;hL=0;for(;hL<hJ.length;hL++)hK+=hI(hJ[hL]);return hK;};ck.forall=function(hI,hJ){var hK,hL,hM,hN;hK=true;hL=0;hN=ck.length(hJ);while(hK&&hL<hN)if(hI(hJ[hL]))hL=hL+1;else hK=false;return hK;};ck.exists2=function(hI,hJ,hK){var hL,hM,hN,hO;ck.checkLength(hJ,hK);hL=false;hM=0;hO=ck.length(hJ);while(!hL&&hM<hO)if(hI(hJ[hM],hK[hM]))hL=true;else hM=hM+1;return hL;};ck.zip=function(hI,hJ){var hK,hL,hM;ck.checkLength(hI,hJ);hK=ck.create(hI.length,null);for(hL=0,hM=hI.length-1;hL<=hM;hL++)hK[hL]=[hI[hL],hJ[hL]];return hK;};ck.sortWith=function(hI,hJ){return hJ.slice().sort(hI);};cl=bV.List=hB.Class({GetEnumerator:function(){return df.Get(this);},GetEnumerator0:function(){return df.Get0(this);}},null,cl);m.inferWith=function(hI,hJ){var hK,hL,hM;hK=m.getNextCandidates(hJ);return hK.$==0?bY.Empty:(hL=bX.map(function(hN){return[hN,hI(hJ.nodes.get_Item(hN))];},hK),(hM=co.fold(function(hN,hO){return m.updateGraph(hN,hO[0],hO[1]);},hJ,hL),bX.append(bX.zip(hK,hL),m.inferWith(hI,hM))));};m.expandAndLift=function(hI){var hJ,hK,hL,hM;function hN(hP,hQ){var hR;hR=hQ.expandAndLift();return[[hP,hR[0]],[hQ.top.name,hR[1]]];}function hO(hP,hQ,hR){var hS,hT,hU,hV,hW,hX,hY,hZ,h0,h1,h2,h3,h4,h5,h6,h7,h8,h9,h_;function h$(ib){return be.FailWith(((((((hB.Curried(function(ic,id,ie,_if,ig,ih){return ic(cA.toSafe(id)+" in edge "+cA.toSafe(ie)+"."+cA.toSafe(_if)+"->"+cA.toSafe(ig)+"."+cA.toSafe(ih));},6))(a.id))(ib))(hV))(hW))(hX))(hY));}function ia(ib,ic){return[ib,ic,hU];}hS=hR[0];hT=hR[1];hU=hR[2];return hP.$==1?hQ.$==0?be.FailWith(((((hB.Curried(function(ib,ic,id,ie){return ib("Unsupported edge "+cA.toSafe(ic)+"."+cA.toSafe(id)+"->"+cA.toSafe(ie)+"; only node->node and system->system edges are supported.");},4))(a.id))(hP.$0[0]))(hP.$0[1]))(hQ.$0)):(hV=hP.$0[0],(hW=hP.$0[1],(hX=hQ.$0[0],(hY=hQ.$0[1],(hZ=(h0=hL.TryFind(hV),h0==null?h$((function(ib){return function(ic){return ib("Source node "+cA.toSafe(ic)+" not found");};}(a.id))(hV)):h0.$0),(h1=(h2=hL.TryFind(hX),h2==null?h$((function(ib){return function(ic){return ib("Target node "+cA.toSafe(ic)+" not found");};}(a.id))(hX)):h2.$0),(h3=(h4=hZ.TryFind(hW),h4==null?h$((function(ib){return function(ic){return ib("Source system "+cA.toSafe(ic)+" not found");};}(a.id))(hW)):h4.$0),(h5=(h6=h1.TryFind(hY),h6==null?h$((function(ib){return function(ic){return ib("Target system "+cA.toSafe(ic)+" not found");};}(a.id))(hY)):h6.$0),(h7=(h8=h3.TryFind(hS),h8==null?h$((function(ib){return function(ic){return ib("Source parameter "+cA.toSafe(ic)+" not found");};}(a.id))(hS)):h8.$0),(h9=(h_=h5.TryFind(hT),h_==null?h$((function(ib){return function(ic){return ib("Target parameter "+cA.toSafe(ic)+" not found");};}(a.id))(hT)):h_.$0),(h7.get_Length()!==h9.get_Length()?h$((((hB.Curried3(function(ib,ic,id){return ib("Mismatched multiples count ("+a.String(ic)+" source, "+a.String(id)+" target)");}))(a.id))(h7.get_Length()))(h9.get_Length())):void 0,bX.map(function(ib){return ia(ib[0],ib[1]);},bX.zip(h7,h9))))))))))))):hQ.$==1?be.FailWith(((((hB.Curried(function(ib,ic,id,ie){return ib("Unsupported edge "+cA.toSafe(ic)+"->"+cA.toSafe(id)+"."+cA.toSafe(ie)+"; only node->node and system->system edges are supported.");},4))(a.id))(hP.$0))(hQ.$0[0]))(hQ.$0[1])):bX.ofArray([[hS,hT,hU]]);}hJ=(hK=bX.unzip(bX.map(function(hP){return hN(hP[0],hP[1]);},bX.ofSeq(bW.ToSeq(hI.nodes)))),[bW.OfArray(ck.ofSeq(hK[0])),bW.OfArray(ck.ofSeq(hK[1]))]);hL=hJ[1];hM=m.collectEdges(function(hP,hQ){return function(hR){return hO(hP,hQ,hR);};},cv.New(hI.task,hJ[0],hI.edges,hI.expanded));return cv.New(hM.task,hM.nodes,hM.edges,true);};m.parse=function(){ey.$cctor();return ey.parse;};m.getNextCandidates=function(hI){var hJ;return hI.nodes.get_IsEmpty()?bY.Empty:(hJ=m.getRoots(hI),hJ.get_IsEmpty()?be.FailWith("Inference graph is not acyclic."):bX.ofSeq(hJ));};m.updateGraph=function(hI,hJ,hK){var hL,hM,hN;hL=hI.nodes.get_Item(hJ);hM=co.fold(function(hO,hP){var hQ,hR;hQ=hP[1];hR=hO.nodes.get_Item(m.toNodeID(hQ));return cv.New(hO.task,hO.nodes.Add(hR.top.name,m.applyEdgeToNode(hP[0],hQ,hP[2],hR)),hO.edges,hO.expanded);},hI,bX.collect(function(hO){function hP(hQ,hR){function hS(hT,hU,hV){var hW;hW=bW.TryFind(hT,hK.parameters);return hW==null?(function(hX){return function(hY){return hX("Error: cannot find parameter "+cA.toSafe(hY)+" in results");};}(be.FailWith))(hT):[hU,[hW.$0,hV]];}return[hO,hQ,bW.OfArray(ck.ofSeq(bX.map(function(hT){return hS(hT[0],hT[1],hT[2]);},hR)))];}return hI.edges.ContainsKey(hO)?bX.map(function(hQ){return hP(hQ[0],hQ[1]);},hI.edges.get_Item(hO)):bY.Empty;},new bY({$:1,$0:new n({$:0,$0:hJ}),$1:bX.map(function(hO){return new n({$:1,$0:[hJ,hO.name]});},hL.systems)})));hN=new bY({$:1,$0:new n({$:0,$0:hJ}),$1:bX.map(function(hO){return new n({$:1,$0:[hJ,hO.name]});},hM.nodes.get_Item(hJ).systems)});return cv.New(hM.task,hM.nodes.Remove(hJ),co.fold(function(hO,hP){return hO.Remove(hP);},hM.edges,hN),hM.expanded);};m.collectEdges=function(hI,hJ){return cv.New(hJ.task,hJ.nodes,bW.Map(function(hK,hL){function hM(hN,hO){return[hN,bX.collect(hI(hK,hN),hO)];}return bX.map(function(hN){return hM(hN[0],hN[1]);},hL);},hJ.edges),hJ.expanded);};m.getRoots=function(hI){var hJ,hK,hL,hM;function hN(hP){return hP[1];}function hO(hP){return hP[0];}hJ=new cK.New$1(c6.OfSeq(co.map(function(hP){return hP[0];},bW.ToSeq(hI.nodes))));hK=new cK.New$1(c6.OfSeq(co.collect((hL=(hM=function(hP){return m.toNodeID(hO(hP));},function(hP){return bX.map(hM,hP);}),function(hP){return hL(hN(hP));}),bW.ToSeq(hI.edges))));return c5.Filter(function(hP){return!hK.Contains(hP);},hJ);};m.toNodeID=function(hI){return hI.$==1?hI.$0[0]:hI.$0;};m.applyEdgeToNode=function(hI,hJ,hK,hL){var hM;function hN(hP){var hQ,hR;return hK.ContainsKey(hP.name)?(hQ=hK.get_Item(hP.name),(hR=hQ[0],F.New(hP.name,hR.mle,m.toPrior(hQ[1],hP.prior,hR,m.printLoc(hI),m.printLoc(hJ))))):hP;}function hO(hP){var hQ;return hP.update_settings((hQ=hP.settings,Y.New(hQ.simulation,hQ.simulations,hQ.stochastic,hQ.deterministic,hQ.spatial,hQ.inference,hQ.moment_closure,hQ.synthesis,hQ.data,hQ.units,hQ.simulator,hM(hP.settings.parameters),hQ.sweeps,hQ.rates,hQ.plot,hQ.quiet)));}hM=function(hP){return bX.map(hN,hP);};return cm.New(hO(hL.top),bX.map(hO,hL.systems));};m.pid=function(){ey.$cctor();return ey.pid;};m.parseTask=function(){ey.$cctor();return ey.parseTask;};m.pinferenceGraph=function(hI,hJ,hK){return cR.op_BarGreaterGreater(cR.op_GreaterGreaterDot(cR.spaces(),cR.many1(m.pline(hJ,hK))),function(hL){var hM;function hN(hO,hP){return function(hQ){return hQ.$==1?[hO,new bY({$:1,$0:hQ.$0,$1:hP})]:[new bY({$:1,$0:hQ.$0,$1:hO}),hP];};}hM=co.fold(function(hO,hP){return(function(hQ){return hN(hQ[0],hQ[1]);}(hO))(hP);},[bY.Empty,bY.Empty],hL);return cv.New(hI,bW.OfArray(ck.ofSeq(bX.map(function(hO){return[hO.top.name,hO];},hM[0]))),bW.Map(function(hO,hP){function hQ(hR,hS,hT){return[hT,hS];}return bX.map(function(hR){return hQ(hR[0],hR[1],hR[2]);},hP);},bW.OfArray(ck.ofSeq(bX.groupBy(function(hO){return a.id(hO[0],hO[1],hO[2]);},hM[1])))),false);});};m.toPrior=function(hI,hJ,hK,hL,hM){var hN,hO,hP,hQ,hR,hS;return hI=="Normal"?(hN=hK.toNormalDist(),hJ==null?be.FailWith(((((hB.Curried(function(hT,hU,hV,hW){return hT("Cannot propagate parameter "+cA.toSafe(hU)+"\'s fixed prior in "+cA.toSafe(hV)+" to normal prior in "+cA.toSafe(hW));},4))(a.id))(hK.name))(hL))(hM)):(hO=hJ.$0,{$:1,$0:E.New(hO.interval,hN,hO.variation)})):hI=="LogNormal"?(hP=hK.toLogNormalDist(),hJ==null?be.FailWith(((((hB.Curried(function(hT,hU,hV,hW){return hT("Cannot propagate parameter "+cA.toSafe(hU)+"\'s fixed prior in "+cA.toSafe(hV)+" to lognormal prior in "+cA.toSafe(hW));},4))(a.id))(hK.name))(hL))(hM)):(hQ=hJ.$0,{$:1,$0:E.New(hQ.interval,hP,hQ.variation)})):hI=="TruncatedNormal"?(hR=hK.toTruncatedNormalDist(),hJ==null?be.FailWith(((((hB.Curried(function(hT,hU,hV,hW){return hT("Cannot propagate parameter "+cA.toSafe(hU)+"\'s fixed prior in "+cA.toSafe(hV)+" to truncated normal prior in "+cA.toSafe(hW));},4))(a.id))(hK.name))(hL))(hM)):(hS=hJ.$0,{$:1,$0:E.New(hS.interval,hR,hS.variation)})):null;};m.printLoc=function(hI){return hI.$==1?hI.$0[0]+"."+hI.$0[1]:hI.$0;};m.pline=function(hI,hJ){var hK;hK=cR.choice([cR.op_GreaterGreaterEquals(cR.op_DotGreaterGreaterDot(cR.op_DotGreaterGreaterDot(cR.op_DotGreaterGreater(cR.op_GreaterGreaterDot(cR.kw("edge"),m.plocation()),cR.kw("->")),cR.list_of(m.pparameter())),m.plocation()),function(hL){var hM;hM=hL[0];return cR.preturn({$:1,$0:[hM[0],hM[1],hL[1]]});}),cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(cR.kw("node"),m.pid()),function(hL){var hM;return cR.op_BarGreaterGreater(cR.record(cm.New((hM=hI.top,cn.New(hL,hM.settings,hM.reactions,hM.initials,hM.attributes)),hI.systems),bX.ofArray([["systems",cR.op_BarGreaterGreater(cR.list_of(cR.name()),function(hN){return function(hO){return cm.New(hO.top,bX.map(function(hP){return hJ.ContainsKey(hP)?hJ.get_Item(hP):be.FailWith("Undefined system "+hP+" in node "+hL);},hN));};})],["inference",cR.op_BarGreaterGreater(J.parse_defaults(hI.top.settings.inference),function(hN){return function(hO){var hP,hQ;return cm.New((hP=hO.top,cn.New(hP.name,(hQ=hO.top.settings,Y.New(hQ.simulation,hQ.simulations,hQ.stochastic,hQ.deterministic,hQ.spatial,hN,hQ.moment_closure,hQ.synthesis,hQ.data,hQ.units,hQ.simulator,hQ.parameters,hQ.sweeps,hQ.rates,hQ.plot,hQ.quiet)),hP.reactions,hP.initials,hP.attributes)),hO.systems);};})]])),function(hN){return{$:0,$0:hN};});})]);return function(hL){return hK([hL[0],hL[1]]);};};m.plocation=function(){ey.$cctor();return ey.plocation;};m.pparameter=function(){ey.$cctor();return ey.pparameter;};bX.ofSeq=function(hI){var hJ,hK,hL,hM,hN,hO;if(hI instanceof bY)return hI;else if(hI instanceof a.Array)return bX.ofArray(hI);else{hJ=df.Get(hI);try{hL=hJ.MoveNext();if(!hL)hK=bY.Empty;else{hN=new bY({$:1});hM=hN;while(hL){hM.$0=hJ.Current();hJ.MoveNext()?hM=(hO=new bY({$:1}),hM.$1=hO,hO):hL=false;}hM.$1=bY.Empty;hK=hN;}return hK;}finally{if(typeof hJ=="object"&&"Dispose"in hJ)hJ.Dispose();}}};bX.map=function(hI,hJ){var hK,hL,hM,hN,hO;if(hJ.$==0)return hJ;else{hN=new bY({$:1});hK=hN;hL=hJ;hM=true;while(hM){hK.$0=hI(hL.$0);hL=hL.$1;hL.$==0?hM=false:hK=(hO=new bY({$:1}),hK.$1=hO,hO);}hK.$1=bY.Empty;return hN;}};bX.iter=function(hI,hJ){var hK;hK=hJ;while(hK.$==1){hI(bX.head(hK));hK=bX.tail(hK);}};bX.ofArray=function(hI){var hJ,hK,hL;hJ=bY.Empty;for(hK=ck.length(hI)-1,hL=0;hK>=hL;hK--)hJ=new bY({$:1,$0:ck.get(hI,hK),$1:hJ});return hJ;};bX.init=function(hI,hJ){return bX.ofArray(ck.init(hI,hJ));};bX.rev=function(hI){var hJ,hK;hJ=bY.Empty;hK=hI;while(hK.$==1){hJ=new bY({$:1,$0:hK.$0,$1:hJ});hK=hK.$1;}return hJ;};bX.exists=function(hI,hJ){var hK,hL;hK=false;hL=hJ;while(!hK&&hL.$==1){hK=hI(hL.$0);hL=hL.$1;}return hK;};bX.distinct=function(hI){return bX.ofSeq(co.distinct(hI));};bX.filter=function(hI,hJ){return bX.ofSeq(co.filter(hI,hJ));};bX.collect=function(hI,hJ){return bX.ofSeq(co.collect(hI,hJ));};bX.choose=function(hI,hJ){return bX.ofSeq(co.choose(hI,hJ));};bX.sortWith=function(hI,hJ){var hK;hK=ck.ofList(hJ);ck.sortInPlaceWith(hI,hK);return bX.ofArray(hK);};bX.countBy=function(hI,hJ){return bX.ofArray(ck.countBy(hI,ck.ofList(hJ)));};bX.concat=function(hI){return bX.ofSeq(co.concat(hI));};bX.zip=function(hI,hJ){return bX.map2(function(hK,hL){return[hK,hL];},hI,hJ);};bX.mapi=function(hI,hJ){var hK,hL,hM,hN,hO,hP;if(hJ.$==0)return hJ;else{hO=new bY({$:1});hK=hO;hL=hJ;hM=0;hN=true;while(hN){hK.$0=hI(hM,hL.$0);hL=hL.$1;hL.$==0?hN=false:(hK=(hP=new bY({$:1}),hK.$1=hP,hP),hM=hM+1);}hK.$1=bY.Empty;return hO;}};bX.groupBy=function(hI,hJ){var hK;function hL(hM,hN){return[hM,bX.ofArray(hN)];}hK=ck.groupBy(hI,ck.ofList(hJ));ck.mapInPlace(function(hM){return hL(hM[0],hM[1]);},hK);return bX.ofArray(hK);};bX.length=function(hI){var hJ,hK;hJ=hI;hK=0;while(hJ.$==1){hJ=bX.tail(hJ);hK=hK+1;}return hK;};bX.map2=function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ;hL=hJ.$==1&&hK.$==1;if(!hL)return hJ.$==1||hK.$==1?bX.badLengths():hJ;else{hP=new bY({$:1});hM=hP;hN=hJ;hO=hK;while(hL){hM.$0=hI(hN.$0,hO.$0);hN=hN.$1;hO=hO.$1;hN.$==1&&hO.$==1?hM=(hQ=new bY({$:1}),hM.$1=hQ,hQ):hL=false;}if(hN.$==1||hO.$==1)bX.badLengths();hM.$1=bY.Empty;return hP;}};bX.unzip=function(hI){var hJ,hK,hL,hM;hJ=[];hK=[];hL=df.Get(hI);try{while(hL.MoveNext()){hM=hL.Current();hJ.push(hM[0]);hK.push(hM[1]);}}finally{if(typeof hL=="object"&&"Dispose"in hL)hL.Dispose();}return[bX.ofArray(hJ.slice(0)),bX.ofArray(hK.slice(0))];};bX.max=function(hI){var hJ,hK,hL;bX.nonEmpty(hI);hJ=hI.$0;hK=hI.$1;while(hK.$==1){hL=hK.$0;cw.Compare(hL,hJ)===1?hJ=hL:void 0;hK=hK.$1;}return hJ;};bX.sort=function(hI){var hJ;hJ=ck.ofList(hI);ck.sortInPlace(hJ);return bX.ofArray(hJ);};bX.append=function(hI,hJ){var hK,hL,hM,hN,hO;if(hI.$==0)return hJ;else if(hJ.$==0)return hI;else{hN=new bY({$:1});hK=hN;hL=hI;hM=true;while(hM){hK.$0=hL.$0;hL=hL.$1;hL.$==0?hM=false:hK=(hO=new bY({$:1}),hK.$1=hO,hO);}hK.$1=hJ;return hN;}};bX.iteri=function(hI,hJ){var hK,hL;hK=hJ;hL=0;while(hK.$==1){hI(hL,bX.head(hK));hK=bX.tail(hK);hL=hL+1;}};bX.maxBy=function(hI,hJ){var hK,hL,hM,hN,hO;bX.nonEmpty(hJ);hK=hJ.$0;hL=hI(hK);hM=hJ.$1;while(hM.$==1){hN=hM.$0;hO=hI(hN);cw.Compare(hO,hL)===1?(hK=hN,hL=hO):void 0;hM=hM.$1;}return hK;};bX.reduce=function(hI,hJ){var hK,hL;bX.nonEmpty(hJ);hK=hJ.$0;hL=hJ.$1;while(hL.$==1){hK=hI(hK,hL.$0);hL=hL.$1;}return hK;};bX.contains=function(hI,hJ){var hK,hL;hK=false;hL=hJ;while(!hK&&hL.$==1){hK=cw.Equals(hI,hL.$0);hL=hL.$1;}return hK;};bX.forAll=function(hI,hJ){var hK,hL;hK=true;hL=hJ;while(hK&&hL.$==1){hK=hI(hL.$0);hL=hL.$1;}return hK;};bX.compareWith=function(hI,hJ,hK){return co.compareWith(hI,hJ,hK);};bX.partition=function(hI,hJ){var hK;hK=ck.partition(hI,ck.ofList(hJ));return[bX.ofArray(hK[0]),bX.ofArray(hK[1])];};bX.tail=function(hI){return hI.$==1?hI.$1:bX.listEmpty();};bX.head=function(hI){return hI.$==1?hI.$0:bX.listEmpty();};bX.badLengths=function(){return be.FailWith("The lists have different lengths.");};bX.zip3=function(hI,hJ,hK){return bX.map3(function(hL,hM,hN){return[hL,hM,hN];},hI,hJ,hK);};bX.sortBy=function(hI,hJ){var hK;hK=ck.ofList(hJ);ck.sortInPlaceBy(hI,hK);return bX.ofArray(hK);};bX.min=function(hI){var hJ,hK,hL;bX.nonEmpty(hI);hJ=hI.$0;hK=hI.$1;while(hK.$==1){hL=hK.$0;cw.Compare(hL,hJ)===-1?hJ=hL:void 0;hK=hK.$1;}return hJ;};bX.nonEmpty=function(hI){if(hI.$==0)bX.listEmpty();};bX.foldBack=function(hI,hJ,hK){return ck.foldBack(hI,ck.ofList(hJ),hK);};bX.forall2=function(hI,hJ,hK){var hL,hM,hN;hL=true;hM=hJ;hN=hK;while(hL&&hM.$==1&&hN.$==1){hL=hI(hM.$0,hN.$0);hM=hM.$1;hN=hN.$1;}hL&&(hM.$==1||hN.$==1)?bX.badLengths():void 0;return hL;};bX.allPairs=function(hI,hJ){return bX.ofArray(ck.allPairs(ck.ofList(hI),ck.ofList(hJ)));};bX.listEmpty=function(){return be.FailWith("The input list was empty.");};bX.indexed=function(hI){return bX.mapi(function(hJ,hK){return[hJ,hK];},hI);};bX.map3=function(hI,hJ,hK,hL){var hM,hN,hO,hP,hQ,hR,hS;hM=hJ.$==1&&hK.$==1&&hL.$==1;if(!hM)return hJ.$==1||hK.$==1||hL.$==1?bX.badLengths():hJ;else{hR=new bY({$:1});hN=hR;hO=hJ;hP=hK;hQ=hL;while(hM){hN.$0=hI(hO.$0,hP.$0,hQ.$0);hO=hO.$1;hP=hP.$1;hQ=hQ.$1;hO.$==1&&hP.$==1&&hQ.$==1?hN=(hS=new bY({$:1}),hN.$1=hS,hS):hM=false;}if(hO.$==1||hP.$==1||hQ.$==1)bX.badLengths();hN.$1=bY.Empty;return hR;}};bX.distinctBy=function(hI,hJ){return bX.ofSeq(co.distinctBy(hI,hJ));};bX.splitAt=function(hI,hJ){return[bX.ofSeq(co.take(hI,hJ)),bX.skip(hI,hJ)];};bX.mapFold=function(hI,hJ,hK){var hL;hL=ck.mapFold(hI,hJ,ck.ofList(hK));return[bX.ofArray(hL[0]),hL[1]];};bX.last=function(hI){var hJ,hK;bX.nonEmpty(hI);hJ=hI;hK=hJ.$1;while(hK.$==1){hJ=hK;hK=hJ.$1;}return hJ.$0;};bX.minBy=function(hI,hJ){var hK,hL,hM,hN,hO;bX.nonEmpty(hJ);hK=hJ.$0;hL=hI(hK);hM=hJ.$1;while(hM.$==1){hN=hM.$0;hO=hI(hN);cw.Compare(hO,hL)===-1?(hK=hN,hL=hO):void 0;hM=hM.$1;}return hK;};bX.unzip3=function(hI){var hJ,hK,hL,hM,hN;hJ=[];hK=[];hL=[];hM=df.Get(hI);try{while(hM.MoveNext()){hN=hM.Current();hJ.push(hN[0]);hK.push(hN[1]);hL.push(hN[2]);}}finally{if(typeof hM=="object"&&"Dispose"in hM)hM.Dispose();}return[bX.ofArray(hJ.slice(0)),bX.ofArray(hK.slice(0)),bX.ofArray(hL.slice(0))];};bX.mapi2=function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ,hR;hL=hJ.$==1&&hK.$==1;if(!hL)return hJ.$==1||hK.$==1?bX.badLengths():hJ;else{hQ=new bY({$:1});hM=hQ;hN=hJ;hO=hK;hP=0;while(hL){hM.$0=hI(hP,hN.$0,hO.$0);hN=hN.$1;hO=hO.$1;hN.$==1&&hO.$==1?(hM=(hR=new bY({$:1}),hM.$1=hR,hR),hP=hP+1):hL=false;}if(hN.$==1||hO.$==1)bX.badLengths();hM.$1=bY.Empty;return hQ;}};bX.replicate=function(hI,hJ){return bX.ofArray(ck.create(hI,hJ));};bX.scan=function(hI,hJ,hK){return bX.ofSeq(co.scan(hI,hJ,hK));};bX.iter2=function(hI,hJ,hK){var hL,hM;hL=hJ;hM=hK;while(hL.$==1){hM.$==0?bX.badLengths():void 0;hI(bX.head(hL),bX.head(hM));hL=bX.tail(hL);hM=bX.tail(hM);}hM.$==1?bX.badLengths():void 0;};bX.mapFoldBack=function(hI,hJ,hK){var hL;hL=ck.mapFoldBack(hI,ck.ofList(hJ),hK);return[bX.ofArray(hL[0]),hL[1]];};cm=d.Model=hB.Class({infer_seq:function(hI){var hJ,hK;hJ=this.to_list_infer();hK=dh.list_to_inference(hJ[0],hJ[1]);return[co.scan(function(hL,hM){var hN;hN=hM[1];return[{$:1,$0:hM[0]},hN,hL[0]==null||hN>hL[1]];},[null,-a.Infinity,false],co.map(function(hL){var hM;return[hL,(hM=hL.state,hM.$==1?hM.$0.mle.logLikelihood:hM.$0.mle.logLikelihood)];},cp.run_mcmc_seq(hK,hI))),hK.$==1?hK.$0.parameters:hK.$0.parameters];},saturate_initials:function(){return cm.New(this.top.saturate_initials(),bX.map(function(hI){return hI.saturate_initials();},this.systems));},string:function(){var hI;hI=bX.map(function(hJ){return(((hB.Curried3(function(hK,hL,hM){return hK("system "+cA.toSafe(hL)+" = { \\n"+cA.toSafe(hM)+"\\n}");}))(a.id))(hJ.name))(hJ.to_string());},this.systems);return cS.concat("\\n\\n",new bY({$:1,$0:this.top.to_string(),$1:hI}));},to_sbml:function(){return this.systems.$==0?this.top.to_sbml():be.FailWith("SBML export not implemented for multi-system models.");},to_matlab:function(){return this.systems.$==0?this.top.to_matlab():be.FailWith("Matlab export not implemented for multi-system models.");},to_list_infer:function(){var hI,hJ;hI=cm.New(this.top,bX.filter(function(hK){return!(hK.settings.data.$==0);},this.systems)).trim_rates();return[(hJ=hI.top.settings,Y.New(hJ.simulation,hJ.simulations,hJ.stochastic,hJ.deterministic,hJ.spatial,hJ.inference,hJ.moment_closure,hJ.synthesis,hJ.data,hJ.units,hJ.simulator,hI.used_parameters(),hJ.sweeps,hJ.rates,hJ.plot,hJ.quiet)),bX.filter(function(hK){return!(hK.settings.data.$==0);},bX.map(function(hK){return hK.saturate_initials().to_ode();},new bY({$:1,$0:hI.top,$1:hI.systems})))];},expandAndLift:function(){var hI,hJ;hI=this;hJ=bX.unzip(bX.map(function(hK){var hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW;function hX(h2){return hK.name+"."+h2;}function hY(h2){return bX.exists(function(h3){return h3.name===h2;},hK.settings.parameters)?hX(h2):h2;}function hZ(h2){return br.map(hY,h2);}function h0(h2){var h3;return h2.$==0?{$:0,$0:hY(h2.$0)}:h2.$==1?(h3=h2.$0,{$:1,$0:hK.settings.rates.ContainsKey(h3)?hX(h3):h3}):h2;}function h1(h2,h3){return[hX(h2),hT(h3)];}hL=(hM=cX.expand_multiples(bX.ofArray([hK.settings.simulation.sweeps.$==0?hK.settings.sweeps:bX.filter(function(h2){return bX.contains(h2.name,hK.settings.simulation.sweeps);},bX.append(hK.settings.sweeps,hI.top.settings.sweeps))]),hK.settings.parameters),[bX.head(hM[0]),hM[1],hM[2]]);hN=hL[1];hO=hL[2];hP=bX.map(function(h2){return F.New(hX(h2.name),h2.value,h2.prior);},hN);hQ=bW.Map(function(h2,h3){return bX.map(hX,h3);},hO);hR=bX.map(function(h2){return W.New(h2.name,bX.map(function(h3){var h4,h5;function h6(h7){return bX.exists(function(h8){return h8.name===h7;},hN)?hX(h7):h7;}h4=bX.map((h5=function(h7){return br.map(h6,h7);},function(h7){return bX.map(h5,h7);}),h3.values);return V.New(bX.map(function(h7){return hO.ContainsKey(h7)?hX(h7):h7;},h3.variables),h4);},h2.assignments));},hL[0]);hS=bX.map(function(h2){return _8.mapValues(hZ,h2);},hK.initials);hT=function(h2){return br.map(h0,h2);};hU=bX.map(function(h2){return _2.map(a.id,hZ,hT,h2);},hK.reactions);return[cn.New(hK.name,(hV=hK.settings,Y.New((hW=hK.settings.simulation,bx.New(hW.name,hW.initial,hW["final"],hW.points,bX.map(hT,hK.settings.simulation.plots),hW.plotcolours,hW.seed,hW.kinetics,hW.times,hW.prune,hW.multicore,hW.data,hW.sweeps)),hV.simulations,hV.stochastic,hV.deterministic,hV.spatial,hV.inference,hV.moment_closure,hV.synthesis,hV.data,hV.units,hV.simulator,hP,hR,bW.FoldBack(function(h2,h3,h4){return h4.Add(h2,h3);},bW.OfArray(ck.ofSeq(bX.map(function(h2){return h1(h2[0],h2[1]);},bX.ofSeq(bW.ToSeq(hK.settings.rates))))),hI.top.settings.rates),hV.plot,hV.quiet)),hU,hS,hK.attributes),[hK.name,hQ]];},this.systems));return[cm.New(this.top,bX.map(function(hK){return hK.disambiguate_species_to_rates();},hJ[0])).trim_rates(),bW.OfArray(ck.ofSeq(hJ[1]))];},trim_rates:function(){var hI,hJ,hK;return this.systems.$==0?cm.New((hI=this.top,cn.New(hI.name,(hJ=this.top.settings,Y.New(hJ.simulation,hJ.simulations,hJ.stochastic,hJ.deterministic,hJ.spatial,hJ.inference,hJ.moment_closure,hJ.synthesis,hJ.data,hJ.units,hJ.simulator,hJ.parameters,hJ.sweeps,this.top.all_used_rates(),hJ.plot,hJ.quiet)),hI.reactions,hI.initials,hI.attributes)),this.systems):cm.New(this.top.update_settings((hK=this.top.settings,Y.New(hK.simulation,hK.simulations,hK.stochastic,hK.deterministic,hK.spatial,hK.inference,hK.moment_closure,hK.synthesis,hK.data,hK.units,hK.simulator,hK.parameters,hK.sweeps,new cj.New([]),hK.plot,hK.quiet))),bX.map(function(hL){var hM;return hL.update_settings((hM=hL.settings,Y.New(hM.simulation,hM.simulations,hM.stochastic,hM.deterministic,hM.spatial,hM.inference,hM.moment_closure,hM.synthesis,hM.data,hM.units,hM.simulator,hM.parameters,hM.sweeps,hL.all_used_rates(),hM.plot,hM.quiet)));},this.systems));},used_parameters:function(){var hI;hI=bX.distinct(bX.collect(function(hJ){return hJ.all_used_parameters();},new bY({$:1,$0:this.top,$1:this.systems})));return bX.distinct(bX.filter(function(hJ){return bX.exists(function(hK){return hK===hJ.name;},hI);},bX.collect(function(hJ){return hJ.settings.parameters;},new bY({$:1,$0:this.top,$1:this.systems}))));},merge_shared_settings:function(){var hI;hI=this;return cm.New(this.top,bX.map(function(hJ){var hK;return cn.New(hJ.name,(hK=hJ.settings,Y.New(hK.simulation,hK.simulations,hK.stochastic,hK.deterministic,hK.spatial,hK.inference,hK.moment_closure,hK.synthesis,hK.data,hK.units,hK.simulator,bX.append(hI.top.settings.parameters,hJ.settings.parameters),hK.sweeps,hK.rates,hK.plot,hK.quiet)),hJ.reactions,hJ.initials,hJ.attributes);},this.systems));}},null,cm);cm.initials_to_svg=function(hI){return cm.stack_crn_svg_exports(cn.initials_to_svg,hI);};cm.reactions_to_svgs=function(hI){return cm.list_crn_svg_exports(function(hJ){return bX.map(function(hK){return cn.reaction_to_svg(hJ,hK);},hJ.reactions);},hI);};cm.reactions_to_svg=function(hI){return cm.stack_crn_svg_exports(cn.reactions_to_svg,hI);};cm.stack_crn_svg_exports=function(hI,hJ){return cB.stackv(dW.New(0,0),50,new bY({$:1,$0:hI(hJ.top),$1:bX.map(function(hK){var hL;hL=hI(hK);return cB.stackv(dW.New(0,0),15,bX.ofArray([cB.label_box({$:1,$0:"c-export__system-header"},20,hK.name),hL]));},hJ.systems)}));};cm.list_crn_svg_exports=function(hI,hJ){return bX.append(hI(hJ.top),bX.concat(bX.map(function(hK){return bX.append(hI(hK),bX.ofArray([cB.label_box({$:1,$0:"c-export__system-header"},20,hK.name)]));},hJ.systems)));};cm.get_parse=function(){var hI;hI=cn.parse_with_modules(bY.Empty,Y.get_defaults());return function(hJ){return gz.op_GreaterGreaterEquals(hI,function(hK){return cm.parse_model(hK[0],hK[1]);},hJ[0],hJ[1]);};};cm.parse_model=function(hI,hJ){var hK,hL;function hM(hN){return cm.New(hI,hN);}hK=(hL=cm.parse_systems(hI.settings,hJ),function(hN){return gz.op_GreaterGreaterDot(cR.spaces(),hL,hN[0],hN[1]);});return function(hN){return gz.op_BarGreaterGreater(hK,hM,hN[0],hN[1]);};};cm.parse_systems=function(hI,hJ){return cR.pfix(function(hK){var hL;function hM(hN){return cR.preturn(bX.append(hK,bX.ofArray([hN])));}hL=cm.parse_with_systems(hI,hJ,hK);return function(hN){return gz.op_GreaterGreaterEquals(hL,hM,hN[0],hN[1]);};},bY.Empty);};cm.parse_with_systems=function(hI,hJ,hK){var hL,hM,hN,hO;function hP(hT){var hU;function hV(hW,hX){var hY,hZ,h0,h1,h2,h3;hY=bX.map((hZ=(h0=(h1=hI.rates,function(h4){return cn.species_to_rates(h1,h4);}),function(h4){return br.map(h0,h4);}),function(h4){return _2.map(a.id,a.id,hZ,h4);}),hW.reactions);return cn.New(hT,hW.settings.map((h2=(h3=hI.rates,function(h4){return cn.species_to_rates(h3,h4);}),function(h4){return br.map(h2,h4);})),hY,hW.initials,hW.attributes);}hU=cn.parse_with_modules_defaultSettings(hJ,Y.New(hI.simulation,hI.simulations,hI.stochastic,hI.deterministic,hI.spatial,hI.inference,hI.moment_closure,hI.synthesis,hI.data,hI.units,hI.simulator,bY.Empty,bY.Empty,new cj.New([]),hI.plot,hI.quiet));return function(hW){return gz.op_BarGreaterGreater(hU,function(hX){return hV(hX[0],hX[1]);},hW[0],hW[1]);};}function hQ(hT,hU){var hV,hW;function hX(hZ,h0){return gz.op_DotGreaterGreater(cR.name(),cR.spaces(),hZ,h0);}function hY(hZ){var h0,h1,h2;function h3(h4,h5){var h6,h7,h8,h9,h_,h$,ia,ib;h6=bX.map((h7=(h8=(h9=hI.rates,function(ic){return cn.species_to_rates(h9,ic);}),function(ic){return br.map(h8,ic);}),function(ic){return _2.map(a.id,a.id,h7,ic);}),h4.reactions);h_=h4.settings.map((h$=(ia=hI.rates,function(ic){return cn.species_to_rates(ia,ic);}),function(ic){return br.map(h$,ic);}));ib=cu.fold(function(ic,id,ie){return ic.Add(id,ie);},h4.attributes,h1.attributes);return cn.New(hT,h_,bX.append(h1.reactions,h6),bX.append(h1.initials,h4.initials),ib);}h0=co.tryFind(function(h4){return h4.name===hZ;},hU);return h0==null?be.FailWith("System "+hZ+" not defined"):(h1=h0.$0,(h2=cn.parse_with_modules_defaultSettings(hJ,h1.settings),function(h4){return gz.op_BarGreaterGreater(h2,function(h5){return h3(h5[0],h5[1]);},h4[0],h4[1]);}));}hV=(hW=cR.kw("with"),function(hZ){return gz.op_DotGreaterGreater(function(h0){return hX(h0[0],h0[1]);},hW,hZ[0],hZ[1]);});return function(hZ){return gz.op_GreaterGreaterEquals(hV,hY,hZ[0],hZ[1]);};}function hR(hT,hU){return gz.op_DotGreaterGreater(cR.name(),cR.spaces(),hT,hU);}function hS(hT){var hU,hV,hW,hX,hY,hZ,h0;function h1(h3){return true;}function h2(h3){return h3?cR.braces(hQ(hT,hK)):cR.braces(hP(hT));}hU=cR.plookAheadWith((hV=cR.choice([cR.pTry((hW=(hX=(hY=(hZ=cR.kw("{"),function(h3){return gz.op_GreaterGreaterDot(hZ,cR.name(),h3[0],h3[1]);}),function(h3){return gz.op_DotGreaterGreater(hY,cR.spaces(),h3[0],h3[1]);}),(h0=cR.kw("with"),function(h3){return gz.op_DotGreaterGreater(hX,h0,h3[0],h3[1]);})),function(h3){return gz.op_BarGreaterGreater(hW,h1,h3[0],h3[1]);})),cR.preturn(false)]),function(h3){return hV([h3[0],h3[1]]);}));return function(h3){return gz.op_GreaterGreaterEquals(hU,h2,h3[0],h3[1]);};}hL=(hM=(hN=cR.kw("system"),function(hT){return gz.op_GreaterGreaterDot(hN,function(hU){return hR(hU[0],hU[1]);},hT[0],hT[1]);}),(hO=cR.kw("="),function(hT){return gz.op_DotGreaterGreater(hM,hO,hT[0],hT[1]);}));return function(hT){return gz.op_GreaterGreaterEquals(hL,hS,hT[0],hT[1]);};};cm.New=function(hI,hJ){return new cm({top:hI,systems:hJ});};cn=d.Crn=hB.Class({to_ctmc:function(){var hI;hI=this.initialise_ctmc();return hI[0].to_ctmc(dD.ofMap(this.settings.rates),1,hI[1],hI[2],hI[3]);},to_oslo:function(){return this.to_ode().to_oslo();},to_ssa:function(){var hI,hJ,hK,hL,hM,hN,hO;hI=this.scale();hJ=cX.to_env(hI.settings.parameters);hK=bq.inline_rates_env(hJ,hI.settings.rates);hL=_8.to_initialpops_events(hJ,hI.settings.simulation.initial,hI.initials);hM=hI.settings.stochastic.scale;hN=cF.create(hL[0],hL[1],hI.settings.simulation,hM);hO=cy.make_sim_reactions_pops(hJ,hK,hM,cw.Equals(hI.settings.simulation.kinetics,"Deterministic")?bX.map(function(hP){return _2.New(hP.catalysts,hP.reactants,hP.reverse,hP.rate.map(function(hQ){return hP.stochastic_to_deterministic(hQ);},a.id),hP.products);},hI.reactions):hI.reactions,hN.populations);return cy.create(hN,hI.settings.stochastic,hO[0],hO[2],hI.settings.parameters,hK);},to_sundials:function(){return this.to_ode().to_sundials();},to_string:function(){var hI;hI=this;return this.to_string_with(br.is_not_empty,function(hJ){return!cw.Equals(br.simplify(hJ),{$:1,$0:hI.settings.simulation.initial});},void 0);},saturate_initials:function(){var hI,hJ;function hK(hL){return hL[1];}hI=bX.distinct(bX.append(Z.elements(Z.union_all(cw.Equals,bX.map(function(hL){return Z.union_all(cw.Equals,bX.ofArray([hL.reactants,hL.products,hL.catalysts]));},this.reactions))),co.fold(function(hL,hM){return hM.$==2?new bY({$:1,$0:hM.$0,$1:hL}):hL;},bY.Empty,bX.distinct(bX.collect(function(hL){return br.mentions(hK(hL));},bX.ofSeq(bW.ToSeq(this.settings.rates)))))));hJ=bX.map(function(hL){return hL.species;},this.initials);return cn.New(this.name,this.settings,this.reactions,bX.rev(dZ.fold_left(function(hL,hM){return bX.exists(function(hN){return cw.Equals(hM,hN);},hJ)?hL:new bY({$:1,$0:_8.create$4(false,{$:1,$0:0},hM,null,null),$1:hL});},bX.rev(this.initials),hI)),this.attributes);},to_lna:function(){var hI;hI=this.scale();return hI.to_ode().to_lna(hI.settings.stochastic.scale);},simulate_cme_callback:function(hI,hJ,hK){var hL,hM,hN,hO;hL=cX.to_env(this.settings.parameters);hM=cn.to_inlined_rates(this.settings);hN=this.to_ctmc();hO=this.to_cme(hN);hJ(hN);return cG.simulate_callback(hL,hM,hI,hK,false,hO);},simulate_cmesundials_callback:function(hI,hJ,hK){var hL,hM,hN,hO;hL=cX.to_env(this.settings.parameters);hM=cn.to_inlined_rates(this.settings);hN=this.to_ctmc();hO=this.to_cme(hN);hJ(hN);return hO.simulate_sundials_callback(hI,hL,hM,hK);},to_pde1d:function(){var hI,hJ,hK,hL;hI=cX.to_env(this.settings.parameters);hJ=(hK=this.settings.simulation.seed,hK==null?new dP.New():new dP.New$1(hK.$0));return this.to_pde(hJ,(_8.to_initialpops_events_poly(hI,this.settings.simulation.initial,this.initials,(hL=this.settings.spatial.nx,function(hM){return cH.accumulator_1d(hJ,hL,hM);})))[0]);},to_pde2d:function(){var hI,hJ,hK,hL;hI=cX.to_env(this.settings.parameters);hJ=(hK=this.settings.simulation.seed,hK==null?new dP.New():new dP.New$1(hK.$0));return this.to_pde(hJ,(_8.to_initialpops_events_poly(hI,this.settings.simulation.initial,this.initials,(hL=this.settings.spatial.nx,function(hM){return cH.accumulator_2d(hJ,hL,hM);})))[0]);},initialise:function(){return this.create_blank_attributes().update_empty_plot_labels();},initialise_ctmc:function(){var hI,hJ,hK,hL,hM,hN;function hO(hP,hQ){return hJ;}hI=this.scale();hJ=bX.map(function(hP){return cw.Equals(hI.settings.simulation.kinetics,"Deterministic")?_2.New(hP.catalysts,hP.reactants,hP.reverse,hP.rate.map(function(hQ){return hP.stochastic_to_deterministic(hQ);},a.id),hP.products):hP;},_2.normalise_list(hI.reactions));hK=cX.to_env(hI.settings.parameters);hL=bX.map(function(hP){return[hP.species,be.toInt(br["eval"](function(hQ){return cY.find(hK,hQ);},hP.value))];},hI.initials);hM=cP.New(function(hP){return function(hQ){return hO(hP,hQ);};});hN=hM.initialise_ctmc(hL);return[hM,hN[0],hN[1],hN[2]];},get_instances:function(){return(this.to_simulation_runs())[0];},substitute:function(hI){var hJ;return this.update_settings((hJ=this.settings,Y.New(hJ.simulation,hJ.simulations,hJ.stochastic,hJ.deterministic,hJ.spatial,hJ.inference,hJ.moment_closure,hJ.synthesis,hJ.data,hJ.units,hJ.simulator,cX.substitute(hI,this.settings.parameters),hJ.sweeps,hJ.rates,hJ.plot,hJ.quiet)));},to_ode:function(){var hI;hI=bX.ofSeq(this.initials);return dh.create(this.name,_2.normalise_list(this.reactions),hI,this.settings);},scale:function(){var hI,hJ,hK;function hL(hO,hP,hQ){return hP===0?{$:2,$0:bX.ofArray([hQ,{$:1,$0:hO}])}:hP===1?hQ:hP===2?{$:3,$0:bw.New(hQ,{$:1,$0:hO})}:{$:2,$0:bX.ofArray([hQ,{$:1,$0:hC.pow(hO,1-hP)}])};}function hM(hO){return{$:2,$0:bX.ofArray([br.expand(function(hP){return bq.scale(hI,hP);},hO),{$:1,$0:hI}])};}function hN(hO){return{$:2,$0:bX.ofArray([hO,{$:1,$0:hI}])};}hI=this.settings.stochastic.scale;return hI===1?this:cn.New(this.name,(hJ=this.settings,Y.New(hJ.simulation,hJ.simulations,(hK=this.settings.stochastic,v.New(1,hK.steps,hK.trajectories,hK.stationary_skiptime)),hJ.deterministic,hJ.spatial,hJ.inference,hJ.moment_closure,hJ.synthesis,hJ.data,hJ.units,hJ.simulator,hJ.parameters,hJ.sweeps,hJ.rates,hJ.plot,hJ.quiet)),bX.map(function(hO){return hO.scale(function(hP,hQ){return function(hR){return hL(hP,hQ,hR);};},hI,hM);},this.reactions),bX.map(function(hO){return hO.scale(hN);},this.initials),this.attributes);},to_string_with:function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU;cX.to_env(this.settings.parameters);hL=this.settings.to_string(cL.to_string,cL.to_string_plot);hM=(hN=bX.filter(function(hV){return hI(hV.value);},this.initials),bX.map((hO=(hP=function(hV){return br.to_string(a.id,hV);},function(hV){return _8.to_string(bG.to_string,hP,hJ,hV);}),(hQ=function(hV){return function(hW){return hV("| "+cA.toSafe(hW));};}(a.id),function(hV){return hQ(hO(hV));})),hN));hR=bX.map((hS=(hT=function(hV){return br.to_string(a.id,hV);},function(hV){return _2.to_string(bG.to_string,hT,cL.to_string,hV);}),(hU=function(hV){return function(hW){return hV("| "+cA.toSafe(hW));};}(a.id),function(hV){return hU(hS(hV));})),this.reactions);return hL+(hM.$===0?"":"\\n"+cS.concat("\\n",hM))+(hR.$===0?"":"\\n"+cS.concat("\\n",hR));},to_cme:function(hI){var hJ,hK,hL;hJ=this.scale();hK=_8.to_initialpops_events(cX.to_env(hJ.settings.parameters),hJ.settings.simulation.initial,hJ.initials);hL=cG.create(hK[0],hK[1],hJ.settings.deterministic,hJ.settings.simulation,1);return cG.New(hL.name,hL.simulator,hL.settings,[hI.ctmc],hL.probabilities);},to_pde:function(hI,hJ){var hK,hL,hM;hK=_2.normalise_list(this.reactions);hL=dh.get_matrices(this.initials,hK);return cH.create(this.name,hJ,this.settings.simulation,(hM=this.settings.spatial,G.New(this.settings.parameters,hM.diffusibles,hM.dimensions,hM.boundary,hM.xmax,hM.nx,hM.dt,hM.default_diffusion,hM.random)),hL[1],hL[2],dh.get_rates(hL[0],hK,cw.Equals(this.settings.simulation.kinetics,"Stochastic")),this.settings.rates,hI);},update_empty_plot_labels:function(){return cn.New(this.name,this.settings.update_empty_plot_labels(),this.reactions,this.initials,this.attributes);},create_blank_attributes:function(){return cn.New(this.name,this.settings,this.reactions,this.initials,co.fold(function(hI,hJ){return cu.tryFind(hJ.species.name,hI)==null?cu.add(hJ.species.name,_9.New(hJ.species.name,"",""),hI):hI;},this.attributes,this.saturate_initials().initials));},to_sbml:function(){var hI,hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0,h1,h2,h3,h4,h5;function h6(){var ik;ik=hN[0];hN[0]=ik+1;return ik;}function h7(ik){var il;return de.mkSId(ik+(il=h6(),a.String(il)));}function h8(){return h7("s_id");}function h9(){return h7("r_id");}function h_(ik,il,im,_in,io){return[ik,[ik,il,im,_in,io]];}function h$(ik){var il;il=bW.TryFind(ik,hP);return il!=null&&il.$==1?il.$0[4]:be.FailWith("Error - getSId - key "+ik+" not found.");}function ia(ik){var il,im;il=de.mkUnitSId("k_unit_"+(im=ik,a.String(im)));return[il,de.create_unitDefinition(il,new bY({$:1,$0:de.u_set_multiplier(hL,de.u_set_scale(hK,de.u_set_exponent(-1,de.create_sbmlUnit(ft.Second)))),$1:ik!==1?bX.ofArray([de.u_set_scale(hM,de.u_set_exponent(1-ik,de.create_sbmlUnit(ft.Mole))),de.u_set_exponent(ik-1,de.create_sbmlUnit(ft.Litre))]):bY.Empty}))];}function ib(ik){var il,im,_in;il=dD.tryFind(hQ,ik);return il==null?(im=ia(ik),(_in=im[0],(dD.add(hQ,ik,[_in,im[1]]),_in))):il.$0[0];}function ic(ik,il){return function(im){var _in,io,ip;_in=dD.tryFind(h1,[ik,il]);return _in==null?(io=de.mkSId(ik),(ip=de.p_set_units(im,de.p_set_value(il,de.create_parameter(io))),(dD.add(h1,[ik,il],[io,ip]),[io,ip]))):[_in.$0[0],_in.$0[1]];};}function id(ik,il){return dD.add(h2,ik,il);}function ie(ik,il){var im;im=de.create_initialAssignment(ik,{$:2,$0:fu.Times,$1:bX.ofArray([{$:3,$0:{$:0,$0:1},$1:{$:1,$0:hW}},il])});return function(_in){return de.model_add_initialAssignment(im,_in);};}function _if(ik){return((function(il){return ic(il[0],il[1]);}([ik,br["eval"](hI,{$:0,$0:ik})]))(hV))[0];}function ig(ik,il,im,_in,io){return im.$==1?_in?de.sp_set_boundaryCondition(true,de.sp_set_constant(_in,de.sp_set_initialConcentration(im.$0,de.sp_set_name(il,de.create_species(io,hX))))):de.sp_set_constant(_in,de.sp_set_initialConcentration(im.$0,de.sp_set_name(il,de.create_species(io,hX)))):(id(io,br.to_mathML(_if,im)),_in?de.sp_set_boundaryCondition(true,de.sp_set_constant(_in,de.sp_set_name(il,de.create_species(io,hX)))):de.sp_set_constant(_in,de.sp_set_name(il,de.create_species(io,hX))));}function ih(ik){return Z.collectm(function(il){return de.sr_set_stoichiometry(il.multiplicity,de.create_speciesReference(h$(il.element)));},ik);}function ii(ik,il){var im;im=il[1];return function(_in){return de.model_add_parameter(im,_in);};}function ij(ik,il){var im;im=il[1];return function(_in){return de.model_add_unitDefinition(im,_in);};}hI=(hJ=cX.to_env(this.settings.parameters),function(ik){return cY.find(hJ,ik);});hK=0;hL=1;hM=this.settings.units.concentration.$0;hN=[0];hO=bX.map(function(ik){return[ik.species.name,de.mkString(ik.species.name),ik.value,ik.constant,h8()];},this.initials);hP=bW.OfArray(ck.ofSeq(bX.map(function(ik){return h_(ik[0],ik[1],ik[2],ik[3],ik[4]);},hO)));hQ=dD.empty();hR=de.mkUnitSId("time");dD.add(hQ,-1,[hR,de.create_unitDefinition(hR,bX.ofArray([de.u_set_multiplier(hL,de.u_set_scale(hK,de.create_sbmlUnit(ft.Second)))]))]);hS=de.mkUnitSId("substance");hT=de.u_set_scale(hM,de.create_sbmlUnit(ft.Mole));dD.add(hQ,-2,[hS,de.create_unitDefinition(hS,bX.ofArray([hT]))]);hU=de.mkUnitSId("volume");dD.add(hQ,-3,[hU,de.create_unitDefinition(hU,bX.ofArray([de.create_sbmlUnit(ft.Litre)]))]);hV=de.mkUnitSId("dimless");dD.add(hQ,-4,[hV,de.create_unitDefinition(hV,bX.ofArray([de.create_sbmlUnit(ft.Dimensionless)]))]);hW=de.mkUnitSId("concentration");dD.add(hQ,-5,[hW,de.create_unitDefinition(hW,bX.ofArray([hT,de.u_set_exponent(-1,de.create_sbmlUnit(ft.Litre))]))]);hX=de.mkSId("c");hY=de.mkSId("c_size");hZ=this.settings.stochastic.scale/6.0221415*hC.pow(10,-23-hM);h0=de.p_set_units(hU,de.p_set_value(hZ,de.create_parameter(hY)));h1=dD.empty();h2=dD.empty();dD.empty();h3=bW.OfArray(ck.ofSeq(bX.map(function(ik){return[ik.name,{$:1,$0:ik.value}];},this.settings.parameters)));return dD.fold(function(ik,il,im){return(ie(ik,il))(im);},h2,dD.fold(function(ik,il,im){return(ii(ik,il))(im);},h1,dD.fold(function(ik,il,im){return(ij(ik,il))(im);},hQ,(h4=(h5=de.model_add_compartment(de.cmt_set_size(hZ,de.create_compartment(hX)),de.empty_model()),de.model_set_species(bX.map(function(ik){return ig(ik[0],ik[1],ik[2],ik[3],ik[4]);},hO),h5)),de.model_set_reactions(bX.map(function(ik){var il,im,_in,io,ip,iq,ir,is,it,iu;function iv(ix,iy){return iy===1?ix:{$:1,$0:fv.Power,$1:ix,$2:{$:3,$0:{$:0,$0:iy},$1:{$:1,$0:hV}}};}function iw(ix,iy){return iy===1?ix:{$:1,$0:fv.Divide,$1:ix,$2:{$:3,$0:{$:0,$0:iy},$1:{$:1,$0:hV}}};}il=_2.map(function(ix){return ix.name;},a.id,a.id,ik);return de.r_set_kineticLaw((im=il.rate,im.$==1?de.create_kineticLaw(br.to_mathML(h$,br.substitute(h3,br.map(function(ix){return bq.to_matlab(bG.to_string,"time",ix);},im.$0)))):(_in=im.$0,(io=br["eval"](hI,_in),(ip=ib(Z.size(il.reactants)),(iq=_in.$==0?(ir=(function(ix){return ic(ix[0],ix[1]);}([_in.$0,io]))(ip),[ir[0],ir[1],false]):(is=de.mkSId("k"),[is,de.p_set_units(ip,de.p_set_value(io,de.create_parameter(is))),true]),iq[2]?de.kl_add_parameter(iq[1],de.kl_add_parameter(h0,de.create_kineticLaw({$:2,$0:fu.Times,$1:new bY({$:1,$0:{$:4,$0:hY},$1:new bY({$:1,$0:{$:4,$0:iq[0]},$1:Z.collectm(function(ix){return iw(iv({$:4,$0:h$(ix.element)},ix.multiplicity),dZ.fac(ix.multiplicity));},il.reactants)})})}))):de.kl_add_parameter(h0,de.create_kineticLaw({$:2,$0:fu.Times,$1:new bY({$:1,$0:{$:4,$0:hY},$1:new bY({$:1,$0:{$:4,$0:iq[0]},$1:Z.collectm(function(ix){return iw(iv({$:4,$0:h$(ix.element)},ix.multiplicity),dZ.fac(ix.multiplicity));},il.reactants)})})}))))))),de.r_set_reversible(false,(it=(iu=de.create_reaction(h9()),de.r_set_reactants(ih(il.reactants),iu)),de.r_set_products(ih(il.products),it))));},_2.normalise_list(this.reactions)),h4)))));},to_matlab:function(){var hI,hJ,hK;hI=this.saturate_initials().create_blank_attributes();hJ=this.settings.simulator;return hJ=="Oslo"||hJ=="Sundials"?dh.to_matlab(hI.to_ode()):a.String(hJ)+" simulator does not support MATLAB export, try Oslo or Sundials";},disambiguate_species_to_rates:function(){var hI,hJ,hK,hL,hM;return cn.New(this.name,this.settings.map((hI=(hJ=this.settings.rates,function(hN){return cn.species_to_rates(hJ,hN);}),function(hN){return br.map(hI,hN);})),bX.map((hK=(hL=(hM=this.settings.rates,function(hN){return cn.species_to_rates(hM,hN);}),function(hN){return br.map(hL,hN);}),function(hN){return _2.map(a.id,a.id,hK,hN);}),this.reactions),this.initials,this.attributes);},to_simulation_runs:function(){return this.settings.to_simulation_runs(this.name);},update_settings:function(hI){return cn.New(this.name,hI,this.reactions,this.initials,this.attributes);},saturate_plots:function(){var hI,hJ,hK,hL,hM;function hN(hO){return hO.plots.$==0?hI.settings.simulator=="MC"?hO:bx.New(hO.name,hO.initial,hO["final"],hO.points,bX.map(function(hP){return{$:0,$0:{$:2,$0:hP.species}};},hI.initials),hO.plotcolours,hO.seed,hO.kinetics,hO.times,hO.prune,hO.multicore,hO.data,hO.sweeps):hO;}hI=this.settings.simulation.plots.$==0?this.settings.simulator=="MC"?cn.New(this.name,(hJ=this.settings,Y.New(hJ.simulation,hJ.simulations,hJ.stochastic,hJ.deterministic,hJ.spatial,hJ.inference,K.saturate_plots(this.all_species(),this.settings.moment_closure),hJ.synthesis,hJ.data,hJ.units,hJ.simulator,hJ.parameters,hJ.sweeps,hJ.rates,hJ.plot,hJ.quiet)),this.reactions,this.initials,this.attributes):cn.New(this.name,(hK=this.settings,Y.New((hL=this.settings.simulation,bx.New(hL.name,hL.initial,hL["final"],hL.points,bX.map(function(hO){return{$:0,$0:{$:2,$0:hO}};},this.all_species()),hL.plotcolours,hL.seed,hL.kinetics,hL.times,hL.prune,hL.multicore,hL.data,hL.sweeps)),hK.simulations,hK.stochastic,hK.deterministic,hK.spatial,hK.inference,hK.moment_closure,hK.synthesis,hK.data,hK.units,hK.simulator,hK.parameters,hK.sweeps,hK.rates,hK.plot,hK.quiet)),this.reactions,this.initials,this.attributes):this;return cn.New(hI.name,(hM=hI.settings,Y.New(hN(hI.settings.simulation),bX.map(hN,hI.settings.simulations),hM.stochastic,hM.deterministic,hM.spatial,hM.inference,hM.moment_closure,hM.synthesis,hM.data,hM.units,hM.simulator,hM.parameters,hM.sweeps,hM.rates,hM.plot,hM.quiet)),hI.reactions,hI.initials,hI.attributes);},all_used_rates:function(){var hI;function hJ(hK){return hK.$==1?{$:1,$0:hK.$0}:null;}return this.settings.all_used_rates((hI=function(hK){return bX.choose(hJ,hK);},function(hK){return hI(br.mentions(hK));}),this.reactions);},all_used_parameters:function(){var hI,hJ,hK,hL,hM,hN,hO;function hP(hQ){return hQ.$==0?{$:1,$0:hQ.$0}:null;}hI=(hJ=function(hQ){return bX.choose(hP,hQ);},function(hQ){return hJ(br.mentions(hQ));});hK=bX.collect(function(hQ){var hR;return bX.append((hR=hQ.time,hR==null?bY.Empty:br.mentions(hR.$0)),br.mentions(hQ.value));},this.initials);hL=bX.collect(function(hQ){var hR,hS;return bX.append((hR=hQ.rate,hR.$==1?hI(hR.$0):br.mentions(hR.$0)),(hS=hQ.reverse,hS!=null&&hS.$==1?hS.$0.$==1?hI(hS.$0.$0):br.mentions(hS.$0.$0):bY.Empty));},this.reactions);hM=bX.collect(hI,bX.append(this.settings.simulation.plots,bX.concat(bX.map(function(hQ){return hQ.plots;},this.settings.simulations))));hN=bX.collect(hI,bX.map(function(hQ){return hQ[1];},bX.ofSeq(bW.ToSeq(this.settings.rates))));hO=bX.collect(function(hQ){return hQ.sweeps;},this.settings.simulations);return bX.distinct(bX.append(hK,bX.append(hL,bX.append(hM,bX.append(hN,bX.collect(function(hQ){return bX.collect(function(hR){return bX.append(hR.variables,bX.collect(br.mentions,bX.concat(hR.values)));},hQ.assignments);},hO.$==0?this.settings.sweeps:bX.filter(function(hQ){return bX.contains(hQ.name,hO);},this.settings.sweeps)))))));},all_species:function(){return bX.distinct(bX.append(bX.distinctBy(function(hI){return hI.name;},bX.map(function(hI){return hI.species;},this.initials)),bX.collect(function(hI){return hI.get_allSpecies();},this.reactions)));}},null,cn);cn.get_default_svg_style=function(){return"\\r\\n  .crnsvgvalue {\\r\\n      text-anchor: end;\\r\\n      stroke: black;\\r\\n      fill: black;\\r\\n      stroke-width: 0;\\r\\n      font-family: Verdana, Arial, sans-serif;\\r\\n      font-size: 15px;\\r\\n  }\\r\\n  .crnsvgrate {\\r\\n      text-anchor: middle;\\r\\n      stroke: black;\\r\\n      fill: black;\\r\\n      stroke-width: 0;\\r\\n      font-family: Verdana, Arial, sans-serif;\\r\\n      font-size: 15px;\\r\\n  }\\r\\n  path.crnsvgrate { stroke-width: 2; fill: none; stroke-linejoin: round }\\r\\n  .crnsvgplus { text-anchor: start }\\r\\n  .crnsvgspeciestext { text-anchor: start }\\r\\n  ";};cn.initials_to_svg=function(hI){var hJ,hK,hL;function hM(hN){return bX.head(hN).box_dim.x;}hJ=dW.New(30,10);hK=bX.map(function(hN){return bX.ofArray([cn.svg_label_box({$:1,$0:"crnsvgvalue"},br.to_string(a.id,hN.value)),cn.get_svg(hI,hN.species.name,true)]);},bX.filter(function(hN){return!cw.Equals(hN.value,{$:1,$0:0});},hI.initials));hL=hK.$==0?0:hM(bX.maxBy(hM,hK));return cB.stackv(hJ,10,bX.map(function(hN){var hO,hP;hO=cB.stackhc(dW.New(hL+10,hJ.y),cn.get_svgListMargin(),hN);return dX.New((hP=hO.box_group,dY.New(hP.name,hP.content,hP.anchors,hP.debug_anchors,hP.sub_groups,{$:1,$0:dW.New(hL,0)})),hO.box_dim);},bX.map(function(hN){var hO;return hN.$==1?(hO=hN.$0,new bY({$:1,$0:dX.New(hO.box_group,dW.New(0,hO.box_dim.y)),$1:hN.$1})):bY.Empty;},hK)));};cn.reactions_to_svg=function(hI){var hJ,hK;hJ=hI.reactions;return hJ.$==0?cn.svg_raw_box(""):(hK=bX.map(function(hL){return cn.reaction_to_svg(hI,hL);},hJ),cB.stackv(dW.New(0,0),cn.get_svgListMargin(),hK));};cn.from_calculus_translated=function(hI,hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU){var hV,hW,hX,hY,hZ,h0,h1,h2,h3,h4,h5,h6,h7,h8,h9,h_,h$;function ia(_if){function ig(ih){var ii;ii=bW.TryFind(hI(ih).name,h0);return ii!=null&&ii.$==1?ii.$0.structure:hJ(ih).structure;}return br.to_string(function(ih){return bq.to_string(ig,ih);},_if);}function ib(_if){var ig;ig=bW.TryFind(_if,h7);return ig==null?h7.get_Item(bW.FindKey(function(ih){return(hK(_if))(ih);},h7)).species:ig.$0.species;}function ic(_if){return bX.ofSeq(co.distinct(bX.filter(hL(_if),h5)));}function id(_if){return bq.map(hI,_if);}function ie(_if){return bq.map(ib,_if);}hV=bX.map(function(_if){return _if.species;},hQ);hW={$:1,$0:0};hX=null;hY=bX.ofSeq(co.distinct(bX.filter(function(_if){return!bX.contains(_if,hV);},bX.choose(function(_if){var ig;return _if.$==2?(ig=_if.$0,hM(ig)?{$:1,$0:ig}:null):null;},bX.collect(br.mentions,hO.simulation.plots)))));hZ=bX.map(function(_if){return _8.create$4(false,hW,hI(_if),hX,null);},hY);h0=(h1=bX.map(hJ,bX.append(hV,hY)),co.fold(function(_if,ig){return cu.add(ig.name,ig,_if);},cu.empty(),h1));h2=co.fold(function(_if,ig){return bX.exists(hK(ig),_if)?_if:bX.append(_if,bX.ofArray([ig]));},bY.Empty,bX.rev(bX.append(hV,bX.collect(function(_if){return Z.elements(_if.products);},hR))));h3=co.fold(function(_if,ig){var ih;function ii(ij){return hI(ij).name;}ih=br.to_string_plot(function(ij){return bq.to_string_plot(ii,ij);},ig);return cu.inDomain(_if,ih)?_if:cu.add(ih,_9.New(ih,ia(ig),""),_if);},h0,hO.simulation.plots);h4=function(_if,ig,ih){var ii,ij,il,im,_in,io;function ik(ip,iq){var ir;return!(ir=co.tryFind(hK(iq),ip),ir!=null&&ir.$==1);}while(true){if(ih.$==1){il=ih.$1;im=ih.$0;if(!ik(ig,im))ih=il;else{_in=(hP.react(ig))(im);io=(ii=bX.distinct((function(ip){return function(iq){return bX.collect(ip,iq);};}(function(ip){var iq;return hU?bX.append(ip.get_allSpecies(),(iq=ip.rate,iq.$==1?bX.collect(function(ir){return ir.$==2?bX.ofArray([ir.$0]):bY.Empty;},br.mentions(iq.$0)):bY.Empty)):Z.elements(ip.products);}))(_in)),(function(ip){return function(iq){return bX.filter(ip,iq);};}((ij=bX.append(ig,il),function(ip){return ik(ij,ip);})))(ii));_if=bX.append(_in,_if);ig=new bY({$:1,$0:im,$1:ig});ih=bX.append(il,io);}}else return[_if,bX.ofSeq(co.distinct(ig))];}}(bY.Empty,bY.Empty,h2);h5=h4[1];h6=bX.append(hR,bX.filter(function(_if){return!bX.exists(function(ig){return cw.Equals(_if,ig);},hR);},h4[0]));h7=bW.OfArray(ck.ofSeq(dZ.rev_map(function(_if){var ig,ih,ii;ig=hI(_if);return[_if,(ih=co.tryFind(function(ij){return cw.Equals(ij.species,_if);},hQ),ih==null?_8.create$4(false,hW,ig,hX,null):(ii=ih.$0,_8.create$4(ii.constant,ii.value,ig,ii.time,ii.spatial)))];},h5)));h8=bX.map(function(_if){return _8.create$4(false,hW,hI(_if),hX,null);},bX.filter(function(_if){return bX.forAll(function(ig){return!cw.Equals(ig,_if);},hY);},bX.filter(function(_if){return bX.forAll(function(ig){return!cw.Equals(ig.species,_if);},hQ);},h5)));h9=bX.append(bX.map(function(_if){return _8.mapSpecies(hI,_if);},hQ),bX.append(h8,hZ));return cn.create(hN,(!hS?hO.collect_plots(br.collect(function(_if){return bq.collect(ic,_if);})):hO).map(function(_if){return br.map(id,_if);}),dZ.rev_map((h_=function(_if){return br.map(a.id,_if);},(h$=function(_if){return br.map(ie,_if);},function(_if){return _2.map(ib,h_,h$,_if);})),h6),h9,co.fold(function(_if,ig){return cu.add(ig.name,ig,_if);},h3,bX.map(hJ,h5)),hT);};cn.group_reactions=function(hI){return cn.New(hI.name,hI.settings,cn.compute_reversibles(cn.name_eq,hI),hI.initials,hI.attributes);};cn.species_to_rates=function(hI,hJ){var hK;return hJ.$==3?bq.Time:hJ.$==0?{$:0,$0:hJ.$0}:hJ.$==1?{$:1,$0:hJ.$0}:(hK=hJ.$0,hI.ContainsKey(hK.name)?{$:1,$0:hK.name}:{$:2,$0:hK});};cn.create=function(hI,hJ,hK,hL,hM,hN){return hN?cn.New(hI,hJ,hK,hL,hM).saturate_initials().saturate_plots():cn.New(hI,hJ,hK,hL,hM).saturate_initials();};cn.svg_label_box=function(hI,hJ){var hK;hK=cB.label_box(hI,cB.default_letter_width(),hJ);return dX.New(hK.box_group,dW.New(hK.box_dim.x,22));};cn.get_svg=function(hI,hJ,hK){var hL,hM;hL=cu.tryFind(hJ,hI.attributes);hM=hL!=null&&hL.$==1?hL.$0.svg:"";return hM===""?cn.svg_label_box({$:1,$0:"crnsvgvalue crnsvgspeciestext"},hJ):cn.svg_raw_box(hK&&cS.StartsWith(hM,"<svg")?"<g"+cS.Remove(cS.Remove(hM,0,4),hM.length-10,6)+"</g>":hM);};cn.get_svgListMargin=function(){return 20;};cn.svg_raw_box=function(hI){return cn.svg_raw_box_sized(hI,cn.try_grab("width",150,hI),cn.try_grab("height",60,hI));};cn.reaction_to_svg=function(hI,hJ){var hK,hL,hM,hN,hO,hP,hQ,hR;function hS(hU){return hU.multiplicity===1?bX.ofArray([cn.get_svg(hI,hU.element.name,true)]):bX.ofArray([cn.svg_label_box({$:1,$0:"crnsvgvalue"},a.String(hU.multiplicity)),cn.get_svg(hI,hU.element.name,true)]);}function hT(hU){return cB.stackhc(dW.New(0,0),10,bX.collect(a.id,bX.mapi(function(hV,hW){return hV===0?hW:new bY({$:1,$0:cn.svg_label_box({$:1,$0:"crnsvgvalue crnsvgplus"},"+"),$1:hW});},bX.map(hS,hU))));}hK=dW.New(0,0);hL=Z.is_empty(hJ.reactants)?null:{$:1,$0:hT(hJ.reactants)};hM=Z.is_empty(hJ.catalysts)?null:{$:1,$0:hT(hJ.catalysts)};hN=Z.is_empty(hJ.products)?null:{$:1,$0:hT(hJ.products)};hO=hM!=null&&hM.$==1?(hP=hM.$0,hL!=null&&hL.$==1?{$:1,$0:cB.stackhc(hK,20,bX.ofArray([hL.$0,cn.svg_label_box({$:1,$0:"crnsvgvalue"},"~"),hP]))}:{$:1,$0:hP}):hL;hQ=cn.rate_box_svg(hJ.rate,hJ.reverse);hR=cB.stackhc(hK,20,hO!=null&&hO.$==1?hN!=null&&hN.$==1?bX.ofArray([hO.$0,hQ,hN.$0]):bX.ofArray([hO.$0,hQ]):hN!=null&&hN.$==1?bX.ofArray([hQ,hN.$0]):be.FailWith("invalid reaction"));return dX.New(hR.box_group,dW.New(hR.box_dim.x*1.05,hR.box_dim.y));};cn.to_inlined_rates=function(hI){return bq.inline_rates_env(cX.to_env(hI.parameters),hI.rates);};cn.compute_reversibles=function(hI,hJ){var hK,hL,hM;function hN(hX,hY,hZ){var h0,h1,h2;while(true){h0=hY;h1=hZ;if(h0.$==1){if(h1.$==1){h2=(hX(h0.$0))(h1.$0);if(h2===0){hY=h0.$1;hZ=h1.$1;}else return h2;}else return 1;}else return h1.$==0?0:-1;}}function hO(hX){var hY,hZ;hY=dD.tryFind(hK,hX);return hY==null?(hZ=dD.count(hK),(dD.add(hK,hX,hZ),hZ)):hY.$0;}function hP(hX,hY){return hX-hY;}function hQ(hX,hY){var hZ;hZ=hP(hX.element,hY.element);return hZ===0?hX.multiplicity-hY.multiplicity:hZ;}function hR(hX){var hY,hZ;hY=bX.sortWith(hQ,Z.map(hO,Z.union(hI,hX.catalysts,hX.reactants)));hZ=bX.sortWith(hQ,Z.map(hO,Z.union(hI,hX.catalysts,hX.products)));return hN(function(h0){return function(h1){return hQ(h0,h1);};},hY,hZ)>0?[hZ,hY,true]:[hY,hZ,false];}function hS(hX,hY){var hZ;return hX.$==0&&(hY.$==0&&(hZ=[hX.$0,hY.$0],true))?new _1({$:0,$0:{$:5,$0:bX.ofArray([hZ[0],hZ[1]])}}):be.FailWith("Not implemented");}function hT(hX,hY){var hZ;switch(hX!=null&&hX.$==1?hY!=null&&hY.$==1?(hZ=[hX.$0,hY.$0],2):(hZ=hX.$0,1):hY!=null&&hY.$==1?(hZ=hY.$0,1):0){case 0:return null;case 1:return{$:1,$0:hZ};case 2:return{$:1,$0:hS(hZ[0],hZ[1])};}}function hU(hX,hY){return hY!=null&&hY.$==1?hS(hX,hY.$0):hX;}function hV(hX){return dD.find(hL,hX);}function hW(hX){var hY,hZ;function h0(h2,h3){return function(h4){var h5,h6,h7;h5=h4[0];return cw.Equals(h3,h4[1])?(h6=hS(h2.rate,h5.rate),[_2.create$4(h2.catalysts,h2.reactants,hT(h2.reverse,h5.reverse),h6,h2.products),h3]):(h7=hU(h2.rate,h5.reverse),[_2.create$4(h2.catalysts,h2.reactants,{$:1,$0:hU(h5.rate,h2.reverse)},h7,h2.products),h3]);};}function h1(h2,h3){var h4;h4=h2.reverse;return h2.rate.$==0&&(h4!=null&&h4.$==1?h4.$0.$==0:true);}hY=bX.partition(function(h2){return h1(h2[0],h2[1]);},hX);hZ=hY[0];return bX.append(hY[1],hZ.$==1?hZ.$1.$==0?bX.ofArray([[hZ.$0[0],hZ.$0[1]]]):bX.ofArray([dZ.fold_left(function(h2,h3){return(function(h4){return h0(h4[0],h4[1]);}(h2))(h3);},hZ.$0,hZ.$1)]):bY.Empty);}hK=dD.empty();bX.iteri(function(hX,hY){return dD.add(hK,hY,hX);},bX.ofSeq(new cK.New$1(c6.OfSeq(bX.map(function(hX){return hX.species;},hJ.initials)))));hL=dD.empty();hM=[bY.Empty];bX.iter(function(hX){var hY,hZ,h0,h1,h2;hY=hR(hX);hZ=hY[0];h0=hY[1];h1=hY[2];h2=dD.tryFind(hL,[hZ,h0]);h2==null?(hM[0]=new bY({$:1,$0:[hZ,h0],$1:hM[0]}),dD.add(hL,[hZ,h0],bX.ofArray([[hX,h1]]))):dD.add(hL,[hZ,h0],new bY({$:1,$0:[hX,h1],$1:h2.$0}));},bX.rev(hJ.reactions));return bX.map(function(hX){return hX[0];},bX.collect(function(hX){return hW(hV(hX));},hM[0]));};cn.name_eq=function(hI,hJ){return hI.name===hJ.name;};cn.svg_raw_box_sized=function(hI,hJ,hK){return dX.New(dY.New("",{$:1,$0:hI},bY.Empty,false,bY.Empty,null),dW.New(hJ,hK));};cn.try_grab=function(hI,hJ,hK){var hL,hM,hN;hL=(function(hO){return function(hP){return hO(cA.toSafe(hP)+"=\\"");};}(a.id))(hI);hM=hL.length;return hK.indexOf(hL)!=-1?(hN=hK.substring(hK.indexOf(hL)+hM),hN.indexOf("\\"")!=-1?a.Number(cS.Substring(hN,0,hN.indexOf("\\""))):hJ):hJ;};cn.rate_box_svg=function(hI,hJ){var hK,hL,hM,hN,hO,hP,hQ,hR;function hS(hT){return hT.to_string_bare(function(hU){return br.to_string(a.id,hU);},cL.to_string);}hK=13;hL=hS(hI);hM=hJ!=null&&hJ.$==1?{$:1,$0:hS(hJ.$0)}:null;hN=(hO=hM!=null&&hM.$==1?hK*(hP=cS.length(hL),(hQ=cS.length(hM.$0),cw.Compare(hP,hQ)===1?hP:hQ)):hK*cS.length(hL),(hR=50,cw.Compare(hO,hR)===1?hO:hR));return dX.New(cB.content_group(hM!=null&&hM.$==1?{$:0,$0:bX.ofArray([fZ.New({$:1,$0:"crnsvgrate"},bX.ofArray([{$:0,$0:dW.New(0,20)},{$:1,$0:dW.New(hN,20)},{$:1,$0:dW.New(hN-10,10)},{$:0,$0:dW.New(hN,25)},{$:1,$0:dW.New(0,25)},{$:1,$0:dW.New(10,35)}]),null),fZ.New(null,bY.Empty,{$:1,$0:f0.New(hL,dW.New(hN/2,17),{$:1,$0:"crnsvgrate"},cB.default_letter_width(),dW.New(hN,17))}),fZ.New(null,bY.Empty,{$:1,$0:f0.New(hM.$0,dW.New(hN/2,38),{$:1,$0:"crnsvgrate"},cB.default_letter_width(),dW.New(hN,38))})])}:{$:0,$0:bX.ofArray([fZ.New({$:1,$0:"crnsvgrate"},bX.ofArray([{$:0,$0:dW.New(0,20)},{$:1,$0:dW.New(hN,20)},{$:1,$0:dW.New(hN-10,10)}]),null),fZ.New(null,bY.Empty,{$:1,$0:f0.New(hL,dW.New(hN/2,17),{$:1,$0:"crnsvgrate"},cB.default_letter_width(),dW.New(hN,17))})])}),dW.New(hN,40));};cn.parse_with_modules=function(hI,hJ){var hK,hL,hM;hK=Y.parse_defaults(cL.parse(),cL.parse_plot(),hJ);hL=(hM=bG.get_parse(),function(hN){return cn.parse_instructions_modules(hM,hI,hN);});return function(hN){return gz.op_GreaterGreaterEquals(hK,hL,hN[0],hN[1]);};};cn.parse_instructions_modules=function(hI,hJ,hK){var hL;function hM(hN,hO){var hP;hP=bX.append(hJ,hN);return[cn.create_from_instructions(hK,[hP,hO]),hP];}hL=hm.parse(hI,hK);return function(hN){return gz.op_BarGreaterGreater(hL,function(hO){return hM(hO[0],hO[1]);},hN[0],hN[1]);};};cn.create_from_instructions=function(hI,hJ){var hK,hL,hM,hN,hO,hP,hQ,hR,hS;hK=hm.convert_instructions(hJ[0],hJ[1]);hL=hK[1];(function(hT){var hU,hV,hW;while(true)if(hT.$==1){if(hT.$1.$==0)return null;else{hU=hT.$0[0];hV=hT.$0[1];hW=hT.$1;bX.iter(function(hX,hY){return function(hZ){var h0,h1;h0=(h1=hZ[1],c5.Filter(function(h2){return h1.Contains(h2);},hX));!h0.get_IsEmpty()?be.FailWith(((((hB.Curried(function(h2,h3,h4,h5){return h2("Naming conflict: "+cA.toSafe(h3)+" and "+cA.toSafe(h4)+" \\""+cA.toSafe(h5)+"\\" share the same name");},4))(a.id))(hY))(hZ[0]))(bX.head(bX.ofSeq(h0)))):void 0;};}(hV,hU),hW);hT=hW;}}else return null;}(bX.ofArray([["parameter",new cK.New$1(c6.OfSeq(bX.map(function(hT){return hT.name;},hI.parameters)))],["initial",new cK.New$1(c6.OfSeq(bX.map(function(hT){return hT.species.name;},hL)))],["rates",new cK.New$1(c6.OfSeq(bX.map(function(hT){return hT[0];},bX.ofSeq(bW.ToSeq(hI.rates)))))]])));hM=bX.filter((hN=hI.rates,function(hT){return hN.ContainsKey(hT);}),bX.map(function(hT){return hT.species.name;},hL));return hM.$==0?cn.create("",hI.map((hO=(hP=hI.rates,function(hT){return cn.species_to_rates(hP,hT);}),function(hT){return br.map(hO,hT);})),bX.map((hQ=(hR=(hS=hI.rates,function(hT){return cn.species_to_rates(hS,hT);}),function(hT){return br.map(hR,hT);}),function(hT){return _2.map(a.id,a.id,hQ,hT);}),hK[0]),hL,cu.empty(),true):be.FailWith("Name conflict: an initial species and a rate share the name \\""+bX.head(hM)+"\\"");};cn.parse_with_modules_defaultSettings=function(hI,hJ){var hK,hL,hM,hN;function hO(hP){return hJ.from_default_directive_list(hP);}hK=(hL=Y.parse_directives_defaults(hJ,cL.parse(),cL.parse_plot()),function(hP){return gz.op_BarGreaterGreater(hL,hO,hP[0],hP[1]);});hM=(hN=bG.get_parse(),function(hP){return cn.parse_instructions_modules(hN,hI,hP);});return function(hP){return gz.op_GreaterGreaterEquals(hK,hM,hP[0],hP[1]);};};cn.New=function(hI,hJ,hK,hL,hM){return new cn({name:hI,settings:hJ,reactions:hK,initials:hL,attributes:hM});};co.iter=function(hI,hJ){var hK;hK=df.Get(hJ);try{while(hK.MoveNext())hI(hK.Current());}finally{if(typeof hK=="object"&&"Dispose"in hK)hK.Dispose();}};co.choose=function(hI,hJ){return co.collect(function(hK){var hL;hL=hI(hK);return hL==null?bY.Empty:bX.ofArray([hL.$0]);},hJ);};co.head=function(hI){var hJ;hJ=df.Get(hI);try{return hJ.MoveNext()?hJ.Current():co.insufficient();}finally{if(typeof hJ=="object"&&"Dispose"in hJ)hJ.Dispose();}};co.distinct=function(hI){return co.distinctBy(a.id,hI);};co.fold=function(hI,hJ,hK){var hL,hM;hL=hJ;hM=df.Get(hK);try{while(hM.MoveNext())hL=hI(hL,hM.Current());return hL;}finally{if(typeof hM=="object"&&"Dispose"in hM)hM.Dispose();}};co.map=function(hI,hJ){return{GetEnumerator:function(){var hK;hK=df.Get(hJ);return new ex.New(null,null,function(hL){return hK.MoveNext()&&(hL.c=hI(hK.Current()),true);},function(){hK.Dispose();});}};};co.scan=function(hI,hJ,hK){return{GetEnumerator:function(){var hL;hL=df.Get(hK);return new ex.New(false,null,function(hM){return hM.s?hL.MoveNext()&&(hM.c=hI(hM.c,hL.Current()),true):(hM.c=hJ,hM.s=true,true);},function(){hL.Dispose();});}};};co.collect=function(hI,hJ){return co.concat(co.map(hI,hJ));};co.filter=function(hI,hJ){return{GetEnumerator:function(){var hK;hK=df.Get(hJ);return new ex.New(null,null,function(hL){var hM,hN,hO;hM=hK.MoveNext();hN=hK.Current();hO=false;while(hM)if(hI(hN)){hL.c=hN;hO=true;hM=false;}else if(hK.MoveNext())hN=hK.Current();else hM=false;return hO;},function(){hK.Dispose();});}};};co.length=function(hI){var hJ,hK;hJ=0;hK=df.Get(hI);try{while(hK.MoveNext())hJ=hJ+1;return hJ;}finally{if(typeof hK=="object"&&"Dispose"in hK)hK.Dispose();}};co.groupBy=function(hI,hJ){return co.delay(function(){return ck.groupBy(hI,ck.ofSeq(hJ));});};co.pairwise=function(hI){return co.map(function(hJ){return[ck.get(hJ,0),ck.get(hJ,1)];},co.windowed(2,hI));};co.forall=function(hI,hJ){return!co.exists(function(hK){return!hI(hK);},hJ);};co.tryFind=function(hI,hJ){var hK,hL,hM;hK=df.Get(hJ);try{hL=null;while(hL==null&&hK.MoveNext()){hM=hK.Current();hI(hM)?hL={$:1,$0:hM}:void 0;}return hL;}finally{if(typeof hK=="object"&&"Dispose"in hK)hK.Dispose();}};co.distinctBy=function(hI,hJ){return{GetEnumerator:function(){var hK,hL;hK=df.Get(hJ);hL=new ek.New$3();return new ex.New(null,null,function(hM){var hN,hO;if(hK.MoveNext()){hN=hK.Current();hO=hL.Add(hI(hN));while(!hO&&hK.MoveNext()){hN=hK.Current();hO=hL.Add(hI(hN));}return hO&&(hM.c=hN,true);}else return false;},function(){hK.Dispose();});}};};co.concat=function(hI){return{GetEnumerator:function(){var hJ;hJ=df.Get(hI);return new ex.New(null,null,function(hK){var hL;while(true){hL=hK.s;if(cw.Equals(hL,null)){if(hJ.MoveNext()){hK.s=df.Get(hJ.Current());hK=hK;}else{hJ.Dispose();return false;}}else if(hL.MoveNext()){hK.c=hL.Current();return true;}else{hK.Dispose();hK.s=null;hK=hK;}}},function(hK){var hL;hL=hK.s;!cw.Equals(hL,null)?hL.Dispose():void 0;!cw.Equals(hJ,null)?hJ.Dispose():void 0;});}};};co.isEmpty=function(hI){var hJ;hJ=df.Get(hI);try{return!hJ.MoveNext();}finally{if(typeof hJ=="object"&&"Dispose"in hJ)hJ.Dispose();}};co.delay=function(hI){return{GetEnumerator:function(){return df.Get(hI());}};};co.append=function(hI,hJ){return{GetEnumerator:function(){var hK,hL;hK=df.Get(hI);hL=[true];return new ex.New(hK,null,function(hM){var hN;return hM.s.MoveNext()?(hM.c=hM.s.Current(),true):(hN=hM.s,!cw.Equals(hN,null)?hN.Dispose():void 0,hM.s=null,hL[0]&&(hL[0]=false,hM.s=df.Get(hJ),hM.s.MoveNext()?(hM.c=hM.s.Current(),true):(hM.s.Dispose(),hM.s=null,false)));},function(hM){var hN;hN=hM.s;!cw.Equals(hN,null)?hN.Dispose():void 0;});}};};co.find=function(hI,hJ){var hK;hK=co.tryFind(hI,hJ);return hK==null?be.FailWith("KeyNotFoundException"):hK.$0;};co.sum=function(hI){return co.fold(function(hJ,hK){return hJ+hK;},0,hI);};co.sumBy=function(hI,hJ){return co.fold(function(hK,hL){return hK+hI(hL);},0,hJ);};co.init=function(hI,hJ){return co.take(hI,co.initInfinite(hJ));};co.map2=function(hI,hJ,hK){return{GetEnumerator:function(){var hL,hM;hL=df.Get(hJ);hM=df.Get(hK);return new ex.New(null,null,function(hN){return hL.MoveNext()&&hM.MoveNext()&&(hN.c=hI(hL.Current(),hM.Current()),true);},function(){hL.Dispose();hM.Dispose();});}};};co.exists=function(hI,hJ){var hK,hL;hK=df.Get(hJ);try{hL=false;while(!hL&&hK.MoveNext())hL=hI(hK.Current());return hL;}finally{if(typeof hK=="object"&&"Dispose"in hK)hK.Dispose();}};co.windowed=function(hI,hJ){hI<=0?be.FailWith("The input must be positive."):void 0;return co.delay(function(){return co.enumUsing(df.Get(hJ),function(hK){var hL;hL=[];return co.append(co.enumWhile(function(){return hL.length<hI&&hK.MoveNext();},co.delay(function(){hL.push(hK.Current());return[];})),co.delay(function(){return hL.length===hI?co.append([hL.slice(0)],co.delay(function(){return co.enumWhile(function(){return hK.MoveNext();},co.delay(function(){hL.shift();hL.push(hK.Current());return[hL.slice(0)];}));})):[];}));});});};co.pick=function(hI,hJ){var hK;hK=co.tryPick(hI,hJ);return hK==null?be.FailWith("KeyNotFoundException"):hK.$0;};co.compareWith=function(hI,hJ,hK){var hL,hM,hN,hO,hP;hL=df.Get(hJ);try{hN=df.Get(hK);try{hO=0;hP=true;while(hP&&hO===0)if(hL.MoveNext())hO=hN.MoveNext()?hI(hL.Current(),hN.Current()):1;else if(hN.MoveNext())hO=-1;else hP=false;hM=hO;}finally{if(typeof hN=="object"&&"Dispose"in hN)hN.Dispose();}return hM;}finally{if(typeof hL=="object"&&"Dispose"in hL)hL.Dispose();}};co.take=function(hI,hJ){hI<0?co.nonNegative():void 0;return{GetEnumerator:function(){var hK;hK=[df.Get(hJ)];return new ex.New(0,null,function(hL){var hM;hL.s=hL.s+1;return hL.s>hI?false:(hM=hK[0],cw.Equals(hM,null)?co.insufficient():hM.MoveNext()?(hL.c=hM.Current(),hL.s===hI?(hM.Dispose(),hK[0]=null):void 0,true):(hM.Dispose(),hK[0]=null,co.insufficient()));},function(){var hL;hL=hK[0];!cw.Equals(hL,null)?hL.Dispose():void 0;});}};};co.rev=function(hI){return co.delay(function(){return ck.ofSeq(hI).slice().reverse();});};co.unfold=function(hI,hJ){return{GetEnumerator:function(){return new ex.New(hJ,null,function(hK){var hL;hL=hI(hK.s);return hL==null?false:(hK.c=hL.$0[0],hK.s=hL.$0[1],true);},void 0);}};};co.initInfinite=function(hI){return{GetEnumerator:function(){return new ex.New(0,null,function(hJ){hJ.c=hI(hJ.s);hJ.s=hJ.s+1;return true;},void 0);}};};co.mapi=function(hI,hJ){return co.map2(hI,co.initInfinite(a.id),hJ);};co.iteri=function(hI,hJ){var hK,hL;hK=0;hL=df.Get(hJ);try{while(hL.MoveNext()){hI(hK,hL.Current());hK=hK+1;}}finally{if(typeof hL=="object"&&"Dispose"in hL)hL.Dispose();}};co.sortBy=function(hI,hJ){return co.delay(function(){var hK;hK=ck.ofSeq(hJ);ck.sortInPlaceBy(hI,hK);return hK;});};co.findIndex=function(hI,hJ){var hK;hK=co.tryFindIndex(hI,hJ);return hK==null?be.FailWith("KeyNotFoundException"):hK.$0;};co.tryPick=function(hI,hJ){var hK,hL;hK=df.Get(hJ);try{hL=null;while(cw.Equals(hL,null)&&hK.MoveNext())hL=hI(hK.Current());return hL;}finally{if(typeof hK=="object"&&"Dispose"in hK)hK.Dispose();}};co.min=function(hI){var hJ,hK,hL;hJ=df.Get(hI);try{if(!hJ.MoveNext())co.seqEmpty();hK=hJ.Current();while(hJ.MoveNext()){hL=hJ.Current();cw.Compare(hL,hK)===-1?hK=hL:void 0;}return hK;}finally{if(typeof hJ=="object"&&"Dispose"in hJ)hJ.Dispose();}};co.max=function(hI){var hJ,hK,hL;hJ=df.Get(hI);try{if(!hJ.MoveNext())co.seqEmpty();hK=hJ.Current();while(hJ.MoveNext()){hL=hJ.Current();cw.Compare(hL,hK)===1?hK=hL:void 0;}return hK;}finally{if(typeof hJ=="object"&&"Dispose"in hJ)hJ.Dispose();}};co.skip=function(hI,hJ){return{GetEnumerator:function(){var hK;hK=df.Get(hJ);return new ex.New(true,null,function(hL){var hM,hN;if(hL.s){for(hM=1,hN=hI;hM<=hN;hM++)if(!hK.MoveNext())co.insufficient();hL.s=false;}else null;return hK.MoveNext()&&(hL.c=hK.Current(),true);},function(){hK.Dispose();});}};};co.forall2=function(hI,hJ,hK){return!co.exists2(function(hL,hM){return!hI(hL,hM);},hJ,hK);};co.tryFindIndex=function(hI,hJ){var hK,hL,hM;hK=df.Get(hJ);try{hL=true;hM=0;while(hL&&hK.MoveNext())if(hI(hK.Current()))hL=false;else hM=hM+1;return hL?null:{$:1,$0:hM};}finally{if(typeof hK=="object"&&"Dispose"in hK)hK.Dispose();}};co.takeWhile=function(hI,hJ){return co.delay(function(){return co.enumUsing(df.Get(hJ),function(hK){return co.enumWhile(function(){return hK.MoveNext()&&hI(hK.Current());},co.delay(function(){return[hK.Current()];}));});});};co.seqEmpty=function(){return be.FailWith("The input sequence was empty.");};co.nth=function(hI,hJ){var hK,hL;if(hI<0)be.FailWith("negative index requested");hK=-1;hL=df.Get(hJ);try{while(hK<hI){!hL.MoveNext()?co.insufficient():void 0;hK=hK+1;}return hL.Current();}finally{if(typeof hL=="object"&&"Dispose"in hL)hL.Dispose();}};co.exists2=function(hI,hJ,hK){var hL,hM,hN,hO;hL=df.Get(hJ);try{hN=df.Get(hK);try{hO=false;while(!hO&&hL.MoveNext()&&hN.MoveNext())hO=hI(hL.Current(),hN.Current());hM=hO;}finally{if(typeof hN=="object"&&"Dispose"in hN)hN.Dispose();}return hM;}finally{if(typeof hL=="object"&&"Dispose"in hL)hL.Dispose();}};cq=cp.mcmc_result=hB.Class({to_summary:function(){return dx.New(this.summary,co.fold(function(hI,hJ){return hI.Add(hJ.name,hJ);},bW.Map(function(hI,hJ){var hK;hK=dp.get_defaults();return dp.New(hI,hJ,hJ,hK.variance,hK.median,hK.lb,hK.ub,hK.l68,hK.u68,hK.l95,hK.u95,hK.ptype);},this.pfixed),this.parameters));}},null,cq);cq.New=function(hI,hJ,hK,hL,hM,hN,hO,hP){return new cq({parameters:hI,posterior:hJ,burnin:hK,pfixed:hL,mle:hM,mlesims:hN,postsims:hO,summary:hP});};cr.mcmc_to_results=function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW;function hX(h0,h1){var h2;h2=co.find(function(h3){return h3.name===bX.head(h0).instance.model;},hN).settings;return ds.New(h0,h1.data,h1.file,h2.plot.x_label,h2.plot.y_label);}function hY(h0){return h0[1];}function hZ(h0,h1){return h1.get_Length()===hV;}hL=bW.Map(function(h0){return ck.ofList(bX.map(function(h1){return h1.get_Item(h0);},hK.posterior));},bX.head(hK.posterior));hM=dt.correlation_pearson(ck.ofList(bX.map(function(h0){return hL.get_Item(h0);},bX.map(function(h0){return h0.name;},hK.parameters))));hN=new bY({$:1,$0:hJ.top,$1:hJ.systems});hO=bX.collect(function(h0){return h0.settings.data;},hN);hP=bX.collect(function(h0){return bX.collect(function(h1){return h1.data;},h0.settings.simulations);},hN);hQ=hP.$===0?hO:bX.map(function(h0){return co.find(function(h1){return h1.file===h0;},hO);},hP);hR=bz.group_sweeps(hK.mlesims);hS=hR.get_Length()===hQ.get_Length()?(((hB.Curried3(bX.map2))(hX))(hR))(hQ):be.FailWith("HTML report internal error: incompatible specification of simulations and data files");hT=bX.map(function(h0){return[h0.file,bX.map(function(h1){return ck.get(cS.SplitChars(bX.head(h1.columns).name,["("],0),0);},h0.data)];},hQ);hU=bX.map(function(h0){return h0.name;},bX.filter(function(h0){var h1;h1=h0.prior;return h1==null?false:cw.Equals(h1.$0.variation,"Multiple");},hI.parameters));hV=co.sum(bX.map(function(h0){return bX.length(hY(h0));},hT));hW=bX.distinct(bX.append(hU,bX.map(function(h0){return h0[0];},bX.filter(function(h0){return hZ(h0[0],h0[1]);},bX.groupBy(a.id,bX.map(function(h0){var h1;h1=cS.SplitChars(ck.last(cS.SplitChars(h0.name,["."],0)),["_"],0);return cS.concat("_",ck.sub(h1,0,ck.length(h1)-1));},bX.filter(function(h0){return h0.name.indexOf("_")!=-1&&F.variable(h0);},bX.collect(function(h0){return h0.settings.parameters;},new bY({$:1,$0:hJ.top,$1:hJ.systems})))))))));return dr.New(cr.codify(hJ.string()),hS,hM,hT,hK.parameters,hL,hW);};cr.results_to_html_content=function(hI){var hJ,hK,hL,hM,hN,hO,hP,hQ,hR;function hS(hT,hU){return dg.plot_marginal(hI.marginals.get_Item(hT),hT,hU);}hJ=new bY({$:1,$0:["logLikelihood",false],$1:bX.map(function(hT){return[hT.name,cw.Equals(hT.ptype,"Log")];},hI.parameters)});hK=bX.map(function(hT){return hS(hT[0],hT[1]);},hJ);hL=bX.map(function(hT){var hU;hU=hT[0];return dg.plot_trace(hI.marginals.get_Item("Iteration"),hI.marginals.get_Item(hU),hU);},hJ);hM=bX.map(function(hT){return hT.name;},hI.parameters);hN=bX.choose(function(hT){var hU,hV;hU=bX.filter(function(hW){return hW.indexOf(hT+"_")!=-1;},hM);return hU.$==0?null:(hV=dg.plot_variation(hI.marginals,hI.keys,hU),{$:1,$0:["Parameter variation: "+hT,cr.gridplot(hV[1],500,1,hV[0])]});},hI.multiple_paras);hO=dg.plot_correlation(hI.correlations,hM);hP=bX.mapi(function(hT,hU){var hV;hV=dg.plot_comparisons(hU.sim,hU.dat,null,hU.xlabel,hU.ylabel);return[hI.comparisons.get_Length()>1?(function(hW){return function(hX){return hW("Comparison "+a.String(hX));};}(a.id))(hT+1):"Comparison",cr.gridplot_with_title(hU.name,200,150,6,hV)];},hI.comparisons);hQ=bX.ofArray(["Parameter name","Type","Lower bound","Upper bound","MLE","Posterior mean","Posterior stdev","Posterior l95","Posterior l68","Posterior median","Posterior u68","Posterior u95"]);hR=bX.map(function(hT){return new bY({$:1,$0:hT.name,$1:new bY({$:1,$0:x.to_string(hT.ptype),$1:bX.map(function(hU){return function(hV){return hU(cS.PadLeft(hV.toFixed(3),1));};}(a.id),bX.ofArray([hT.lb,hT.ub,hT.mle,hT.mean,hC.sqrt(hT.variance),hT.l95,hT.l68,hT.median,hT.u68,hT.u95]))})});},hI.parameters);return du.New(hI.model,hP,cr.gridplot(200,150,6,hK),dw.ofChart(hO),cr.gridplot(300,150,4,hL),cr.table(hQ,hR),hN);};cr.codify=function(hI){var hJ;hJ=bX.ofArray(["directive","simulation","deterministic","inference","simulator","parameters","system","sweeps","data"]);return co.fold(function(hK,hL){return cS.Replace(hK,hL,"<font color=\\"blue\\">"+hL+"</font>");},cS.Replace("<font face=\\"courier\\">"+hI+"<font>","\\n","<br> \\n"),hJ);};cr.gridplot=function(hI,hJ,hK,hL){return dw.ofSubplots(cr.subplots(hI,hJ,hK,hL));};cr.table=function(hI,hJ){var hK,hL,hM;hK=(hL=cS.concat("\\n",bX.map(function(hN){return function(hO){return hN("\\u0009\\u0009<th>"+cA.toSafe(hO)+"</th>");};}(a.id),hI)),(function(hN){return function(hO){return hN("\\u0009<tr>\\n"+cA.toSafe(hO)+"\\n\\u0009</tr>");};}(a.id))(hL));hM=cS.concat("\\n",bX.map(function(hN){var hO;hO=cS.concat("\\n",bX.map(function(hP){return function(hQ){return hP("\\u0009\\u0009<td>"+cA.toSafe(hQ)+"</td>");};}(a.id),hN));return(function(hP){return function(hQ){return hP("\\u0009<tr>\\n"+cA.toSafe(hQ)+"\\n\\u0009</tr>");};}(a.id))(hO);},hJ));return(((hB.Curried3(function(hN,hO,hP){return hN("<table id=\\"pTable\\">\\n"+cA.toSafe(hO)+"\\n"+cA.toSafe(hP)+"\\n</table>");}))(a.id))(hK))(hM);};cr.gridplot_with_title=function(hI,hJ,hK,hL,hM){return dw.ofSubplots(eI.setTitle(hI,cr.subplots(hJ,hK,hL,hM)));};cr.subplots=function(hI,hJ,hK,hL){return eI.setSubplotSize(hI,hJ,eI.createSubplots(1+(hL.get_Length()/hK>>0),hK,function(hM,hN){return hL.get_Length()>hM*hK+hN?{$:1,$0:hL.get_Item(hM*hK+hN)}:null;}));};cs=bg.Parameter=hB.Class({isFixed:function(){return this.range.pType.$===2;},isReal:function(){return this.range.pType.$===0;}},null,cs);cs.New=function(hI,hJ,hK,hL,hM){return new cs({name:hI,range:hJ,initValue:hK,prior:hL,summary:hM});};ct=bV.Dictionary=hB.Class({Add:function(hI,hJ){this.add(hI,hJ);},ContainsKey:function(hI){var hJ,hK;hJ=this;hK=this.data[this.hash(hI)];return hK==null?false:ck.exists(function(hL){return hJ.equals.apply(null,[(be.KeyValue(hL))[0],hI]);},hK);},get_Item:function(hI){return this.get(hI);},get_Values:function(){return new eZ.New(this);},add:function(hI,hJ){var hK,hL,hM;hK=this;hL=this.hash(hI);hM=this.data[hL];hM==null?(this.count=this.count+1,this.data[hL]=new a.Array({K:hI,V:hJ})):(ck.exists(function(hN){return hK.equals.apply(null,[(be.KeyValue(hN))[0],hI]);},hM)?d2.alreadyAdded():void 0,this.count=this.count+1,hM.push({K:hI,V:hJ}));},get_Keys:function(){return new fn.New(this);},get:function(hI){var hJ,hK;hJ=this;hK=this.data[this.hash(hI)];return hK==null?d2.notPresent():ck.pick(function(hL){var hM;hM=be.KeyValue(hL);return hJ.equals.apply(null,[hM[0],hI])?{$:1,$0:hM[1]}:null;},hK);},set_Item:function(hI,hJ){this.set(hI,hJ);},set:function(hI,hJ){var hK,hL,hM,hN;hK=this;hL=this.hash(hI);hM=this.data[hL];hM==null?(this.count=this.count+1,this.data[hL]=new a.Array({K:hI,V:hJ})):(hN=ck.tryFindIndex(function(hO){return hK.equals.apply(null,[(be.KeyValue(hO))[0],hI]);},hM),hN==null?(this.count=this.count+1,hM.push({K:hI,V:hJ})):hM[hN.$0]={K:hI,V:hJ});},GetEnumerator:function(){return df.Get0(this);},GetEnumerator0:function(){return df.Get0(ck.concat(c$.GetFieldValues(this.data)));}},b1,ct);ct.New$5=hB.Ctor(function(){ct.New$6.call(this,[],cw.Equals,cw.Hash);},ct);ct.New$6=hB.Ctor(function(hI,hJ,hK){var hL,hM;b1.New.call(this);this.equals=hJ;this.hash=hK;this.count=0;this.data=[];hL=df.Get(hI);try{while(hL.MoveNext()){hM=hL.Current();this.set(hM.K,hM.V);}}finally{if(typeof hL=="object"&&"Dispose"in hL)hL.Dispose();}},ct);ct.New$1=hB.Ctor(function(hI){ct.New$6.call(this,hI,cw.Equals,cw.Hash);},ct);ct.New$3=hB.Ctor(function(hI){ct.New$6.call(this,[],d2.equals(hI),function(hJ){return d2.getHashCode(hI,hJ);});},ct);cu.find=function(hI,hJ){return hJ.get_Item(hI);};cu.of_list=function(hI){return dZ.fold_right(function(hJ,hK){return(function(hL){var hM,hN;hM=hL[0];hN=hL[1];return function(hO){return cu.add(hM,hN,hO);};}(hJ))(hK);},hI,cu.empty());};cu.empty=function(){fe.$cctor();return fe.empty;};cu.add=function(hI,hJ,hK){return hK.Add(hI,hJ);};cu.inDomain=function(hI,hJ){var hK;hK=cu.tryFind(hJ,hI);return hK!=null&&hK.$==1;};cu.tryFind=function(hI,hJ){return bW.TryFind(hI,hJ);};cu.iter=function(hI,hJ){bW.Iterate(hI,hJ);};cu.fold=function(hI,hJ,hK){return bW.Fold(hI,hJ,hK);};cu.remove=function(hI,hJ){return hJ.Remove(hI);};bH.to_ctmc=function(hI,hJ){var hK,hL,hM;function hN(hO,hP){return[hO,br.map(function(hQ){return hQ.$==1?bq.Time:{$:2,$0:hQ.$0};},hP)];}cX.to_env(hI.parameters);hK=bX.ofSeq(co.map(function(hO){return[hO.payload,be.toInt(hO.population)];},hI.spDict.get_Values()));hL=bW.OfArray(ck.ofSeq(bX.map(function(hO){return hN(hO[0],hO[1]);},bX.ofSeq(bW.ToSeq(hI.rates)))));hM=hJ.initialise_ctmc(hK);return[hJ.to_ctmc(dD.ofMap(hL),hI.stochastic.scale,hM[0],hM[1],hM[2]),function(hO){var hP,hQ,hR;hP=hI.printSpecies(hO);return _9.New(hP.name,(hQ=hP.structural,hQ==null?"":hQ.$0),(hR=hP.svg,hR==null?"":hR.$0));}];};bH.simulate_callback=function(hI,hJ,hK,hL,hM){var hN,hO;function hP(hQ){return cY.find(hN,hQ);}bH.init(hL);hN=cX.to_env(hL.parameters);hO=function(hQ){return br["eval"](hP,hQ);};(function(hQ){var hR,hT,hU,hV,hW,hX,hY,hZ;function hS(h0,h1){var h2;h2=hL.spDict.get_Item(h0);return h2.isExplored?null:{$:1,$0:h2};}while(true){hT=bH.timeToNextReaction(hL);hU=bH.enactEvents(hT,hJ,hL);hV=hL.now+hU;if(bH.isPrintTime(hL,hV,hQ)){hR=bH.createRow(hL.now,bH.evaluatePlots(hL));hJ(hR);hL.dataPoints=new bY({$:1,$0:hR,$1:hL.dataPoints});hL.nextPrintTime=hV+hL.simulation.get_print_interval();}if(bH.isStopTime(hL,hI)||hL.totalProp===0)return hL;else{hL.now=hV;hW=bH.pickNextReaction(hL);if(hW!=null&&hW.$==1){hX=hW.$0;bH.executeReaction(hL,hX);hY=(function(h0){return function(h1){return bX.choose(h0,h1);};}(function(h0){return hS(h0[0],h0[1]);}))(hX.prods);if(hL.mustPlotAll)bX.iter(hK,(function(h0){return function(h1){return bX.map(h0,h1);};}(function(h0){return hL.printSpecies(h0.payload);}))(hY));else if(!(hY.$==0))bH.extendPlotPatterns(hL,(function(h0){return function(h1){return bX.map(h0,h1);};}(function(h0){return h0.payload;}))(hY));hZ=df.Get(hY);try{while(hZ.MoveNext())((function(h0){return function(){var h1,h2,h3,h4,h6,h7,h8,h9,h_,h$,ia,ib,ic,id,ie,_if,ig,ih;h1=h0.Current();h2=bX.ofSeq(co.map(function(ii){return ii.K;},co.filter(function(ii){return hL.spDict.get_Item(ii.V).isExplored;},hL.sidDict)));h1.isExplored=true;h3=(hM.react(h2))(h1.payload);h4=df.Get(h3);function h5(ii){return[hL.sidDict.get_Item(ii.element),ii.multiplicity];}try{while(h4.MoveNext()){h6=h4.Current();h7=df.Get(h6.products);try{while(h7.MoveNext()){h8=h7.Current();!hL.sidDict.ContainsKey(h8.element)?(h9=dF.New(bH.newSID(hL),h8.element,0,false,false,new cK.New$1(null)),hL.sidDict.Add(h8.element,h9.id),hL.spDict.Add(h9.id,h9)):void 0;}}finally{if(typeof h7=="object"&&"Dispose"in h7)h7.Dispose();}h_=bX.map(h5,h6.reactants);h$=bX.map(h5,h6.products);ia=_2.map(a.id,hO,function(ii){var ij;return br.simplify(br.expand((ij=hL.rates,function(ik){return bq.inline_keys(hN,ij,ik);}),ii));},h6);ib=bH.scaleReaction(hL,ia);ic=dV.New(bH.newRID(hL),ib,h_,h$,0);id=bH.calculate_reaction_prop(hL,ic);ie=dV.New(ic.id,ic.payload,ic.reacts,ic.prods,id);hL.totalProp=hL.totalProp+id;hL.rxDict.Add(ie.id,ie);_if=bX.map(function(ii){return ii[0];},bX.append(h_,h$));ig=df.Get(_if);try{while(ig.MoveNext()){ih=hL.spDict.get_Item(ig.Current());ih.deps=ih.deps.Add(ie.id);}}finally{if(typeof ig=="object"&&"Dispose"in ig)ig.Dispose();}}return;}finally{if(typeof h4=="object"&&"Dispose"in h4)h4.Dispose();}};}(hZ))());}finally{if(typeof hZ=="object"&&"Dispose"in hZ)hZ.Dispose();}hL.stepsDone=hL.stepsDone+1;hQ=false;}else return hL;}}}(true));};bH.to_crn=function(hI,hJ){var hK,hL,hM,hN,hO;function hP(hR){var hS,hT,hU;hS=hI.printSpecies(hR);return _9.New(hS.name,(hT=hS.structural,hT==null?"":hT.$0),(hU=hS.svg,hU==null?"":hU.$0));}function hQ(hR){return bG.New(hR.name);}hK=(hL=hI.printSpecies,function(hR){return hQ(hL(hR));});hM=bX.append(bX.ofSeq(co.map(function(hR){return _8.create$3(hR.isConstant,{$:1,$0:hR.population},hK(hR.payload),null);},hI.spDict.get_Values())),bX.collect(function(hR){var hS,hT;return hI.now>=hR.time?bY.Empty:(hS=hR.time-hI.now,(hT=hR.target,hT=="OutputPoint"?bY.Empty:bX.map(function(hU){return _8.create$3(hU.constant,{$:1,$0:hU.value},hK(hU.species),{$:1,$0:{$:1,$0:hS}});},bX.ofArray(hT.$0.index_to_species))));},hI.events));return cn.create(hJ.name,(hN=hJ.settings,Y.New(hN.simulation,hN.simulations,(hO=hJ.settings.stochastic,v.New(1,hO.steps,hO.trajectories,hO.stationary_skiptime)),hN.deterministic,hN.spatial,hN.inference,hN.moment_closure,hN.synthesis,hN.data,hN.units,hN.simulator,hN.parameters,hN.sweeps,hN.rates,hN.plot,hN.quiet)),bX.ofSeq(co.map(function(hR){function hS(hT){return hT.$==0?{$:2,$0:hK(hT.$0)}:bq.Time;}return _2.map(hK,function(hT){return{$:1,$0:hT};},function(hT){return br.map(hS,hT);},hR.payload);},hI.rxDict.get_Values())),hM,cu.of_list(bX.map(function(hR){var hS;hS=hP(hR.payload);return[hS.name,hS];},bX.ofSeq(hI.spDict.get_Values()))),true);};bH.create=function(hI,hJ,hK,hL,hM,hN,hO,hP,hQ,hR){var hS,hT,hU,hV,hW,h1,h2,h3,h4,h5,h6,h7,h8,h9,h_,h$,ia,ib,ic;function hX(_if){return cY.find(h1,_if);}function hY(_if){return dF.New(bH.newSID(h6),_if.species,h4.get_population(h4.find_index(_if.species)),co.exists(h6.equalsSpecies(_if.species),h7),_if.constant,new cK.New$1(null));}function hZ(_if){h6.spDict.Add(_if.id,_if);}function h0(_if){return[h6.sidDict.get_Item(_if.element),_if.multiplicity];}h1=cX.to_env(hL);h2=function(_if){return br["eval"](hX,_if);};h3=(hS=_8.to_initialpops_events(h1,hI.initial,hN),(hT=hS[0],(hU=hS[1],hJ.scale!==1?[cE.scale(hT,hJ.scale),hU]:[hT,hU])));h4=h3[0];h5=(hV=bH.empty(hP,hQ,hR),dE.New(hI,hJ,hK,hL,hV.random,hV.sidDict,hV.spDict,hV.rxDict,hV.plotDict,hI.plots.$==0,hV.printSpecies,hV.equalsSpecies,hV.matchesSpecies,hV.now,hV.stepsDone,hV.nextPrintTime,h3[1],hV.totalProp,hV.nextSID,hV.nextRID,hV.dataPoints));h6=(hW=hI.seed,hW!=null&&hW.$==1?dE.New(h5.simulation,h5.stochastic,h5.rates,h5.parameters,new dP.New$1(hW.$0),h5.sidDict,h5.spDict,h5.rxDict,h5.plotDict,h5.mustPlotAll,h5.printSpecies,h5.equalsSpecies,h5.matchesSpecies,h5.now,h5.stepsDone,h5.nextPrintTime,h5.events,h5.totalProp,h5.nextSID,h5.nextRID,h5.dataPoints):h5);h7=new cK.New$1(c6.OfSeq(hM));bX.iter(function(_if){return hZ(hY(_if));},bX.filter(function(_if){var ig;ig=_if.time;return ig==null||h2(ig.$0)===0;},hN));co.iter(function(_if){h6.sidDict.Add(_if.payload,_if.id);},co.map(function(_if){return _if.V;},h6.spDict));bX.iter(function(_if){bX.iter(function(ig){if(ig.$==1);else h6.plotDict.Add(ig.$0,bY.Empty);},br.mentions(_if));},h6.simulation.plots);bH.extendPlotPatterns(h6,bX.ofSeq(h6.sidDict.get_Keys()));h8=df.Get(hO);function id(_if){return _if[0];}function ie(_if){var ig;ig=h6.spDict.get_Item(_if).deps;h6.spDict.get_Item(_if).deps=ig.Add(h$);}try{while(h8.MoveNext()){h9=(h_=h8.Current(),(h$=bH.newRID(h6),(ia=bX.map(h0,h_.reactants),(ib=bX.map(h0,h_.products),(bX.iter(function(_if){return ie(id(_if));},ia),ic=dV.New(h$,bH.scaleReaction(h6,h_),ia,ib,0),ic.prop=bH.calculate_reaction_prop(h6,ic),ic)))));h6.rxDict.Add(h9.id,h9);}}finally{if(typeof h8=="object"&&"Dispose"in h8)h8.Dispose();}h6.totalProp=bH.computeTotalProp(h6);return h6;};bH.init=function(hI){!co.fold(function(hJ,hK){var hL;hL=hK.population;return(hC.round(hL)-hL===0||hK.isConstant)&&hJ;},true,bX.ofSeq(hI.spDict.get_Values()))?be.FailWith("Can\'t use non-integer initial conditions without specifying the species as constant"):void 0;hI.events=bX.sortBy(function(hJ){return hJ.time;},hI.events);};bH.isPrintTime=function(hI,hJ,hK){return U.shouldPrint(hI.simulation["final"],hJ,hI.nextPrintTime,bH.getFinalStep(hI),hK,hI.now);};bH.createRow=function(hI,hJ){return bJ.New(hI,hJ);};bH.evaluatePlots=function(hI){function hJ(hL){return co.fold(function(hM,hN){return hM+hI.spDict.get_Item(hN).population;},0,hI.plotDict.get_Item(hL));}function hK(hL){return hL.$==0?hJ(hL.$0):hI.now;}return hI.mustPlotAll?ck.ofSeq(co.map(function(hL){return hL.population;},co.filter(function(hL){return hL.isExplored;},hI.spDict.get_Values()))):ck.ofList(bX.map(function(hL){return br["eval"](hK,hL);},hI.simulation.plots));};bH.isStopTime=function(hI,hJ){return U.shouldStop(hI.simulation["final"],hI.now,hI.stepsDone,hJ,bH.getFinalStep(hI));};bH.pickNextReaction=function(hI){var hJ,hK,hL;hJ=hI.totalProp;hK=hI.random.NextDouble()*hJ;hL=hI.rxDict;return function(hM,hN){var hO,hP;while(true){hO=hL.get_Item(hN);hP=hM+hO.prop;if(hP>hK)return{$:1,$0:hO};else if(hN+1>=hL.count)return hP===0?null:hP!==hJ?be.FailWith("Incorrect total propensity used."):be.FailWith("Index outside range");else{hM=hP;hN=hN+1;}}}(0,0);};bH.executeReaction=function(hI,hJ){hI.totalProp=bH.update_props_direct(hI,bX.ofSeq(new cK.New$1(c6.OfSeq(co.concat(bX.append(bX.choose(function(hK){var hL;hL=hI.spDict.get_Item(hK[0]);return hL.isConstant?null:(hL.population=hL.population-hK[1],{$:1,$0:hL.deps});},hJ.reacts),bX.choose(function(hK){var hL;hL=hI.spDict.get_Item(hK[0]);return hL.isConstant?null:(hL.population=hL.population+hK[1],{$:1,$0:hL.deps});},hJ.prods)))))));};bH.extendPlotPatterns=function(hI,hJ){bX.iter(function(hK){bX.iter(function(hL){var hM;if(hL.$==1);else{hM=hL.$0;co.iter(function(hN){if((hI.matchesSpecies(hM))(hN))hI.plotDict.set_Item(hM,bX.append(hI.plotDict.get_Item(hM),bX.ofArray([hI.sidDict.get_Item(hN)])));},hJ);}},br.mentions(hK));},hI.simulation.plots);};bH.newSID=function(hI){var hJ;hJ=hI.nextSID;hI.nextSID=hJ+1;return hJ;};bH.newRID=function(hI){var hJ;hJ=hI.nextRID;hI.nextRID=hJ+1;return hJ;};bH.calculate_reaction_prop=function(hI,hJ){var hK,hL,hO,hP,hQ,hR,hS;function hM(hT){return hI.spDict.get_Item(hT).population;}function hN(hT){return hM(hT)/hK;}hO=hJ.payload.rate;if(hO.$==1){hK=hI.stochastic.scale;return br["eval"](function(hT){return hT.$==1?hI.now:hN(hI.sidDict.get_Item(hT.$0));},hO.$0)*hK;}else{hP=hO.$0;hQ=hJ.reacts;switch(hQ.$==1?hQ.$0[1]===1?hQ.$1.$==1?hQ.$1.$0[1]===1?hQ.$1.$1.$==0?(hL=[hQ.$0[0],hQ.$1.$0[0]],4):(hL=hQ,5):(hL=hQ,5):(hL=hQ.$0[0],1):hQ.$0[1]===2?hQ.$1.$==0?(hL=hQ.$0[0],2):(hL=hQ,5):hQ.$0[1]===3?hQ.$1.$==0?(hL=hQ.$0[0],3):(hL=hQ,5):(hL=hQ,5):0){case 0:return hP;case 1:return hP*hM(hL);case 2:hR=hM(hL);return hP*hR*(hR-1)*0.5;case 3:hS=hM(hL);return hP*hS*(hS-1)*(hS-2)/6;case 4:return hP*hM(hL[0])*hM(hL[1]);case 5:return dZ.fold_left(function(hT,hU){return hT*dZ.binom(be.toInt(hM(hU[0])),hU[1]);},hP,hL);}}};bH.scaleReaction=function(hI,hJ){function hK(hL,hM,hN){return hN*hC.pow(hL,1-hM);}return hJ.scale(function(hL,hM){return function(hN){return hK(hL,hM,hN);};},hI.stochastic.scale,a.id);};bH.enactEvents=function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0,h1,h2;hM=hI/hK.totalProp;hN=hK.events;if(hN.$==1){hO=hN.$0;if(hO.time>=hK.now+hM)return hM;else{hK.events=hN.$1;hP=bH.evaluatePlots(hK);hQ=0.99999999;hR=hQ*hO.time+(1-hQ)*hK.now;hS=bH.createRow(hK.now,hP);hT=bH.createRow(hR,hP);hJ(hS);hJ(hT);hK.dataPoints=new bY({$:1,$0:hT,$1:new bY({$:1,$0:hS,$1:hK.dataPoints})});hU=hO.time-hK.now;hV=hK.totalProp;hW=hO.target;if(hW=="OutputPoint");else{hX=hW.$0.index_to_species;for(hY=0,hZ=hX.length-1;hY<=hZ;hY++){h0=ck.get(hX,hY);h1=hK.sidDict.get_Item(h0.species);h2=hK.spDict.get_Item(h1);hK.spDict.set_Item(h1,dF.New(h2.id,h2.payload,h2.population+h0.value,h2.isExplored,h2.isConstant,h2.deps));}}return bH.enactEvents(hI-hU*hV,hJ,hK);}}else return hM;};bH.timeToNextReaction=function(hI){var hJ;hJ=hI.random.NextDouble();return hJ>0?hC.log(1/hJ):0;};bH.empty=function(hI,hJ,hK){var hL,hM,hN,hO,hP;hL={CEquals:function(hQ,hR){return(hJ(hQ))(hR);},CGetHashCode:function(hQ){var hR;hR=hQ;return cw.Hash(hR);}};hM=cF.empty();hN=new cj.New([]);hO=new dP.New();hP=new ct.New$5();return dE.New(bx.get_defaults(),v.get_defaults(),hN,bY.Empty,hO,new ct.New$3(hL),hP,new ct.New$5(),new ct.New$3(hL),true,hI,hJ,hK,hM.currenttime,hM.stepsdone,hM.nextprinttime,bY.Empty,0,0,0,bY.Empty);};bH.computeTotalProp=function(hI){return co.fold(function(hJ,hK){return hJ+hK.prop;},0,bX.ofSeq(co.map(function(hJ){return hJ.V;},hI.rxDict)));};bH.getFinalStep=function(hI){var hJ;hJ=hI.stochastic.steps;return hJ!=null&&hJ.$==1?{$:1,$0:hI.stepsDone+hJ.$0}:null;};bH.update_props_direct=function(hI,hJ){var hK,hL;hK=0;bX.iter(function(hM){var hN,hO;hN=hI.rxDict.get_Item(hM);hO=bH.calculate_reaction_prop(hI,hN);hK=hK+(hO-hN.prop);hN.prop=hO;},hJ);hL=hI.totalProp+hK;return hL<0?0:hL;};cv=m.IGraph=hB.Class({to_string:function(){var hI,hJ,hK,hL,hM,hN,hO,hP,hQ,hR;function hS(hU,hV){return hV;}function hT(hU,hV){return"system "+hU+" =\\n{"+hV.to_string()+"\\n}";}this.expanded?be.FailWith("Cannot convert an Inference Graph to string after it has been expanded."):void 0;hI=(hJ=this.task,hJ!=null&&hJ.$==1?hJ.$0.to_string()+"\\n":"");return this.nodes.get_Count()===0?hI:(hK=co.map(function(hU){return hS(hU[0],hU[1]);},bW.ToSeq(this.nodes)),(hL=co.map(function(hU){return bX.map(function(hV){return[hV.name,hV];},hU.systems);},hK),(hM=dZ.string_of_list(a.id,"\\n",bX.map(function(hU){return hT(hU[0],hU[1]);},bX.ofSeq(bW.ToSeq(bW.OfArray(ck.ofSeq(co.isEmpty(hL)?bY.Empty:co.fold(function(hU,hV){return bX.append(hV,hU);},bY.Empty,hL))))))),(hN=co.isEmpty(hK)?"":(hO=bX.head(bX.ofSeq(hK)).top,cn.New(hO.name,(hP=hO.settings,Y.New(hP.simulation,hP.simulations,hP.stochastic,hP.deterministic,hP.spatial,J.get_defaults(),hP.moment_closure,hP.synthesis,hP.data,hP.units,hP.simulator,hP.parameters,hP.sweeps,hP.rates,hP.plot,hP.quiet)),hO.reactions,hO.initials,hO.attributes).to_string()),(hQ=dZ.string_of_list(function(hU){return cv.node_to_igraph_string(hU[0],hU[1]);},"\\n",bX.ofSeq(bW.ToSeq(this.nodes))),(hR=dZ.string_of_list(function(hU){return cv.edge_to_igraph_string(hU[0],hU[1]);},"\\n",bX.ofSeq(bW.ToSeq(this.edges))),hI+hN+"\\n"+hM+"\\n"+(this.nodes.get_Count()===1?(co.head(bW.ToSeq(this.nodes)))[1].systems.$==0?"":hQ:hQ+"\\n"+hR)))))));}},null,cv);cv.node_to_igraph_string=function(hI,hJ){return"node "+hI+"{"+"systems = ["+dZ.string_of_list(function(hK){return hK.name;},"; ",hJ.systems)+"]; "+"inference = "+(J.get_to_string())(hJ.top.settings.inference)+"}";};cv.edge_to_igraph_string=function(hI,hJ){var hK;function hL(hM,hN){function hO(hP,hQ,hR){return hP+" = "+o.get_to_string(hR);}return"["+dZ.string_of_list(function(hP){return hO(hP[0],hP[1],hP[2]);},"; ",hN)+"] "+hM.get_to_string();}hK="edge "+hI.get_to_string()+" -> ";return dZ.string_of_list(function(hM){return hK+hL.apply(null,hM);},"\\n",hJ);};cv.New=function(hI,hJ,hK,hL){return new cv({task:hI,nodes:hJ,edges:hK,expanded:hL});};cw.Equals=function(hI,hJ){var hK,hL,hM,hN;if(hI===hJ)return true;else{hK=typeof hI;if(hK=="object"){if(hI===null||hI===void 0||hJ===null||hJ===void 0)return false;else if("Equals"in hI)return hI.Equals(hJ);else if(hI instanceof a.Array&&hJ instanceof a.Array)return cw.arrayEquals(hI,hJ);else if(hI instanceof a.Date&&hJ instanceof a.Date)return cw.dateEquals(hI,hJ);else{hL=[true];for(var hO in hI)if(function(hP){hL[0]=!hI.hasOwnProperty(hP)||hJ.hasOwnProperty(hP)&&cw.Equals(hI[hP],hJ[hP]);return!hL[0];}(hO))break;if(hL[0]){for(var hP in hJ)if(function(hQ){hL[0]=!hJ.hasOwnProperty(hQ)||hI.hasOwnProperty(hQ);return!hL[0];}(hP))break;}return hL[0];}}else return hK=="function"&&("$Func"in hI?hI.$Func===hJ.$Func&&hI.$Target===hJ.$Target:"$Invokes"in hI&&"$Invokes"in hJ&&cw.arrayEquals(hI.$Invokes,hJ.$Invokes));}};cw.arrayEquals=function(hI,hJ){var hK,hL;if(ck.length(hI)===ck.length(hJ)){hK=true;hL=0;while(hK&&hL<ck.length(hI)){!cw.Equals(ck.get(hI,hL),ck.get(hJ,hL))?hK=false:void 0;hL=hL+1;}return hK;}else return false;};cw.dateEquals=function(hI,hJ){return hI.getTime()===hJ.getTime();};cw.Compare=function(hI,hJ){var hK,hL,hM,hN,hO,hP;if(hI===hJ)return 0;else{hL=typeof hI;switch(hL=="function"?1:hL=="boolean"?2:hL=="number"?2:hL=="string"?2:hL=="object"?3:0){case 0:return typeof hJ=="undefined"?0:-1;case 1:return be.FailWith("Cannot compare function values.");case 2:return hI<hJ?-1:1;case 3:if(hI===null)hM=-1;else if(hJ===null)hM=1;else if("CompareTo"in hI)hM=hI.CompareTo(hJ);else if("CompareTo0"in hI)hM=hI.CompareTo0(hJ);else if(hI instanceof a.Array&&hJ instanceof a.Array)hM=cw.compareArrays(hI,hJ);else if(hI instanceof a.Date&&hJ instanceof a.Date)hM=cw.compareDates(hI,hJ);else{hN=[0];for(var hQ in hI)if(function(hR){return!hI.hasOwnProperty(hR)?false:!hJ.hasOwnProperty(hR)?(hN[0]=1,true):(hN[0]=cw.Compare(hI[hR],hJ[hR]),hN[0]!==0);}(hQ))break;if(hN[0]===0){for(var hR in hJ)if(function(hS){return!hJ.hasOwnProperty(hS)?false:!hI.hasOwnProperty(hS)&&(hN[0]=-1,true);}(hR))break;}hM=hN[0];}return hM;}}};cw.Hash=function(hI){var hJ;hJ=typeof hI;return hJ=="function"?0:hJ=="boolean"?hI?1:0:hJ=="number"?hI:hJ=="string"?cw.hashString(hI):hJ=="object"?hI==null?0:hI instanceof a.Array?cw.hashArray(hI):cw.hashObject(hI):0;};cw.compareArrays=function(hI,hJ){var hK,hL;if(ck.length(hI)<ck.length(hJ))return -1;else if(ck.length(hI)>ck.length(hJ))return 1;else{hK=0;hL=0;while(hK===0&&hL<ck.length(hI)){hK=cw.Compare(ck.get(hI,hL),ck.get(hJ,hL));hL=hL+1;}return hK;}};cw.compareDates=function(hI,hJ){return cw.Compare(hI.getTime(),hJ.getTime());};cw.hashString=function(hI){var hJ,hK,hL;if(hI===null)return 0;else{hJ=5381;for(hK=0,hL=hI.length-1;hK<=hL;hK++)hJ=cw.hashMix(hJ,hI[hK].charCodeAt());return hJ;}};cw.hashArray=function(hI){var hJ,hK,hL;hJ=-34948909;for(hK=0,hL=ck.length(hI)-1;hK<=hL;hK++)hJ=cw.hashMix(hJ,cw.Hash(ck.get(hI,hK)));return hJ;};cw.hashObject=function(hI){var hJ,hK;if("GetHashCode"in hI)return hI.GetHashCode();else{hJ=[0];for(var hL in hI)if(function(hM){hJ[0]=cw.hashMix(cw.hashMix(hJ[0],cw.hashString(hM)),cw.Hash(hI[hM]));return false;}(hL))break;return hJ[0];}};cw.hashMix=function(hI,hJ){return(hI<<5)+hI+hJ;};cx=d.OdeOslo=hB.Class({simulate_callback:function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ;function hR(hV,hW){return hC.pow(hV,hW);}function hS(hV,hW){return hV[hW];}function hT(hV,hW){var hY,hZ,h0;function hX(h1){return h1.$==1?hV:hS(hW,h1.$0);}for(hY=0,hZ=hO.length-1;hY<=hZ;hY++){hP.set_Item(hY,(h0=ck.get(hO,hY),h0.$==1?(h0.$0.get_key())(hX):co.fold(function(h1,h2){return h1*hR(hW[h2[0]],h2[1]);},h0.$0,ck.get(hN,hY))));}return dN.matrMultVec(hM,dK.ofArray(hP.ToArray()));}function hU(hV,hW){function hX(hY){return hY.$==1?hV:hS(hW,hY.$0);}return ck.map(function(hY){return br["eval"](hX,hY);},hL.plots);}hL=this;hM=this.stoich;hN=this.powers;hO=this.rateDs;hP=dG.create(hO.length,1);hQ=dH.simulate_callback(hI,hJ,dH.create(this.name,this.simulator,function(hV){return function(hW){return hU(hV,hW);};},hB.Curried(bJ.interpolate_float,5),this.settings,this.concs,function(hV){return function(hW){return hT(hV,hW);};}));ck.iteri(function(hV,hW){return hQ.simulator.populations.set_population(hV,hW);},dK.toArray(hQ.concs));hK(hQ.simulator.populations);return cx.New(this.name,hQ.simulator,this.plots,this.settings,this.stoich,this.powers,this.rateDs,this.concs);},simulate:function(){return(this.simulate_state())[1];},simulate_state:function(){var hI;hI=[bY.Empty];return[this.simulate_callback([false],function(hJ){hI[0]=new bY({$:1,$0:hJ,$1:hI[0]});},a.ignore),this.process_simulation(hI[0])];},process_simulation:function(hI){var hJ,hK;hJ=this.simulator.settings.times;hK=bX.map(cL.to_string_plot,this.simulator.settings.plots);return hJ.$==0?O.from_rows_reverse(hK,hI):O.from_rows_reverse(hK,bJ.interpolate_reverse(function(hL,hM,hN){return hB.Curried(bJ.interpolate_float,2,[hL,hM,hN]);},bX.rev(hI),hJ));}},null,cx);cx.New=function(hI,hJ,hK,hL,hM,hN,hO,hP){return new cx({name:hI,simulator:hJ,plots:hK,settings:hL,stoich:hM,powers:hN,rateDs:hO,concs:hP});};cy=d.Ssa=hB.Class({simulate_callback:function(hI,hJ,hK,hL){var hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX;function hY(h0,h1){function h2(h3){return h3.$==0?h1.get_population(h3.$0):h0;}return ck.map(function(h3){return br["eval"](h2,h3);},hM.plots);}function hZ(h0,h1){var h2;h2=h0/h1.total_propensity;return function(h3){var h4,h5,h6,h7,h8,h9;return h3.$==1?(h4=h3.$0,(h5=h3.$1,h4.time<h1.simulator.currenttime+h2?(h6=hY(h1.simulator.currenttime,h1.simulator.populations),(h7=0.99999999,(hJ(bJ.New(h1.simulator.currenttime,h6)),hJ(bJ.New(h7*h4.time+(1-h7)*h1.simulator.currenttime,h6)),h8=h4.target,h8=="OutputPoint"?void 0:bX.iter(function(h_){cy.incPop(h1.simulator.populations,_0.New(h1.simulator.populations.find_index(h_.species),be.toInt(h_.value*h1.settings.scale)));},h8.$0.get_get_pop_info_list()),ck.iteri(function(h_,h$){return ck.set(hT,h_,dR.New(h$.reaction,cy.calculate_reaction_prop(hU,h1.simulator.populations,h$.reaction),h$.dependencies));},hT),(hZ(h0-(h4.time-h1.simulator.currenttime)*h1.total_propensity,cy.New((h9=h1.simulator,cF.New(h9.settings,h9.populations,h9.events,h4.time,h9.nextprinttime,h9.stepsdone)),h1.plots,h1.settings,h1.reactions,ck.fold(function(h_,h$){return h_+h$.propensity;},0,hT))))(h5)))):[h2,new bY({$:1,$0:h4,$1:h5}),h1])):[h2,bY.Empty,h1];};}hM=this;hN=this.settings;hO=(hP=this.simulator.settings.seed,hP!=null&&hP.$==1?new dP.New$1(hP.$0):new dP.New());cw.Equals(cE.test_integer_or_constant(this.simulator.populations),false)?be.FailWith("Can\'t use non-integer initial conditions without specifying the species as constant"):void 0;hQ=(hR=hN.steps,hR!=null&&hR.$==1?{$:1,$0:this.simulator.stepsdone+hR.$0}:null);hS=this.reactions;hT=ck.create(dD.count(hS),null);dD.iter(function(h0,h1){return ck.set(hT,h0,h1);},hS);hU=hN.scale;hV=this.simulator.settings["final"];hW=this.simulator.settings.get_print_interval();hX=function(h0,h1,h2,h3){var h4,h5,h6,h7,h8,h9,h_,h$,ia,ib,ic,id,ie,_if;while(true){h7=hO.NextDouble();h8=h7>0?hC.log(1/h7):0;h9=(hZ(h8,h1))(h2);h_=h9[2];h$=h9[1];ia=h9[0];ib=h_.simulator.currenttime+ia;if(h$.$==0)return h_;else{if(hL!=null)((hL.$0(h_.simulator.currenttime))(ia))(h_.simulator.populations);ic=U.shouldPrint(hV,ib,h_.simulator.nextprinttime,hQ,h0,h_.simulator.currenttime)?(h3(bJ.New(h_.simulator.currenttime,hY(h_.simulator.currenttime,h_.simulator.populations))),cy.New((h4=h_.simulator,cF.New(h4.settings,h4.populations,h4.events,h4.currenttime,ib+hW,h4.stepsdone)),h_.plots,h_.settings,h_.reactions,h_.total_propensity)):h_;if(U.shouldStop(hV,ic.simulator.currenttime,ic.simulator.stepsdone,hI,hQ))return ic;else{id=cy.New((h5=ic.simulator,cF.New(h5.settings,h5.populations,h5.events,ib,h5.nextprinttime,h5.stepsdone)),ic.plots,ic.settings,ic.reactions,ic.total_propensity);ie=cy.pickReactionRandom(id.total_propensity,hT,hO);cy.executeReaction(id.simulator.populations,ie[0]);_if=cy.update_props_direct(hU,id.total_propensity,hT,ie[1],id.simulator.populations);h0=false;h1=cy.New((h6=id.simulator,cF.New(h6.settings,h6.populations,h6.events,h6.currenttime,h6.nextprinttime,id.simulator.stepsdone+1)),id.plots,id.settings,id.reactions,_if);h2=h$;}}}}(true,this,this.simulator.events,hJ);hK(hX.simulator.populations);return hX;},simulate_trajectories_callback:function(hI,hJ){var hK,hL,hM,hN,hO,hP,hQ;hK=this;hL=(hM=this.simulator.settings.seed,hM!=null&&hM.$==1?new dP.New$1(hM.$0):new dP.New());hN=(this.simulator.settings["final"]-this.simulator.settings.initial)/this.simulator.settings.points;hO=bX.init(this.simulator.settings.points,function(hR){return hK.simulator.settings.initial+hN*hR;});hP=this.simulator.populations;hQ=bX.map(cL.to_string_plot,this.simulator.settings.plots);(function(hR,hS){var hT,hU,hV,hW,hX,hY,hZ,h0,h1,h2,h3,h4,h5;while(true){if(hR>=hK.settings.trajectories||hI[0])return null;else{hX=(hT=hK.simulator.settings.seed,hT!=null&&hT.$==1?hT.$0+hR:hL.Next$1());hY=[bY.Empty];hZ=function(h6){return function(h7){h6[0]=new bY({$:1,$0:h7,$1:h6[0]});};}(hY);h0=cy.New((hU=hK.simulator,cF.New((hV=hK.simulator.settings,bx.New(hV.name,hV.initial,hV["final"],hV.points,hV.plots,hV.plotcolours,{$:1,$0:hX},hV.kinetics,hV.times,hV.prune,hV.multicore,hV.data,hV.sweeps)),hP.get_clone(),hU.events,hU.currenttime,hU.nextprinttime,hU.stepsdone)),hK.plots,hK.settings,hK.reactions,hK.total_propensity);h0.simulate_callback([false],hZ,a.ignore,null);h1=bJ.interpolate_reverse(function(h6,h7,h8){return hB.Curried(bJ.zero_order_hold,2,[h6,h7,h8]);},bX.rev(hY[0]),hO);h2=bX.map(cL.to_string_plot,hK.simulator.settings.plots);h3=O.from_rows_reverse(h2,h1);h4=(hW=hS.columns,(((hB.Curried3(function(h6,h7,h8){return bX.map2(function(h9,h_){return(h6(h9))(h_);},h7,h8);}))((hB.Curried3(function(h6,h7,h8){function h9(h_,h$){var ia;ia=dt.online_meanvar(h_.mean,h_.stdev*h_.stdev,h$,h6+1);return bQ.New(ia[0],hC.sqrt(ia[1]));}return N.New(h8.name,(((hB.Curried3(bX.map2))(h9))(h7.values))(h8.values));}))(hR)))(hW))(h3.columns));h5=O.New(hS.times,h4);hJ(h5);hR=hR+1;hS=h5;}}}(0,O.from_array_columns(hO,ck.create(hQ.get_Length(),ck.create(this.simulator.settings.points,bQ.New(0,0))),hQ)));}},null,cy);cy.incPop=function(hI,hJ){if(!hI.is_constant(hJ.element))hI.set_population(hJ.element,hI.get_population(hJ.element)+hJ.multiplicity);};cy.calculate_reaction_prop=function(hI,hJ,hK){var hL,hN,hO,hP,hQ,hR;function hM(hS){return hJ.get_population(hS);}hN=hK.rate;if(hN.$==1)return(hN.$0.get_key())(function(hS){return hS.$==1?be.FailWith("Time dependent rates not supported in SSA."):hM(hS.$0)/hI;})*hI;else{hO=hN.$0;hP=Z.to_mlist(hK.reactants);switch(hP.$==1?hP.$0.multiplicity===1?hP.$1.$==1?hP.$1.$0.multiplicity===1?hP.$1.$1.$==0?(hL=[hP.$0.element,hP.$1.$0.element],4):(hL=hP,5):(hL=hP,5):(hL=hP.$0.element,1):hP.$0.multiplicity===2?hP.$1.$==0?(hL=hP.$0.element,2):(hL=hP,5):hP.$0.multiplicity===3?hP.$1.$==0?(hL=hP.$0.element,3):(hL=hP,5):(hL=hP,5):0){case 0:return hO;case 1:return hO*hM(hL);case 2:hQ=hM(hL);return hO*hQ*(hQ-1)*0.5;case 3:hR=hM(hL);return hO*hR*(hR-1)*(hR-2)/6;case 4:return hO*hM(hL[0])*hM(hL[1]);case 5:return dZ.fold_left(function(hS,hT){return hS*dZ.binom(be.toInt(hM(hT.element)),hT.multiplicity);},hO,hL);}}};cy.pickReactionRandom=function(hI,hJ,hK){var hL,hM;hL=hK.NextDouble()*hI;hM=ck.length(hJ);return function(hN,hO){var hP,hQ;while(true){hP=ck.get(hJ,hO);hQ=hN+hP.propensity;if(hQ>hL)return[hP.reaction,hP.dependencies];else if(hO+1>=hM)return hQ!==hI?be.FailWith("Incorrect total propensity used!"):be.FailWith("Index outside range");else{hN=hQ;hO=hO+1;}}}(0,0);};cy.executeReaction=function(hI,hJ){function hK(hL,hM){return!hL.is_constant(hM.element)?hL.set_population(hM.element,hL.get_population(hM.element)-hM.multiplicity):null;}Z.iterm(function(hL){return hK(hI,hL);},hJ.reactants);Z.iterm(function(hL){cy.incPop(hI,hL);},hJ.products);};cy.update_props_direct=function(hI,hJ,hK,hL,hM){var hN;hN=hJ+dZ.fold_left(function(hO,hP){var hQ,hR;hQ=ck.get(hK,hP);hR=cy.calculate_reaction_prop(hI,hM,hQ.reaction);ck.set(hK,hP,dR.New(hQ.reaction,hR,hQ.dependencies));return hO+(hR-hQ.propensity);},0,hL);return hN<0?0:hN;};cy.make_sim_reactions_pops=function(hI,hJ,hK,hL,hM){var hN,hO,hP,hQ,hR;function hS(hV,hW,hX){return[hV,cy.calculate_reaction_prop(hK,hM,hV),hX];}function hT(hV,hW,hX){return[hV,hX];}function hU(hV,hW,hX){return[hV,hW,cy.calculate_reaction_deps(hV,hP)];}hN=bX.map(function(hV){return hS(hV[0],hV[1],hV[2]);},_2.get_sim_reactions_products(hK,hM,hI,hJ,hL));hO=(hP=bX.map(function(hV){return hT(hV[0],hV[1],hV[2]);},hN),bX.map(function(hV){return hU(hV[0],hV[1],hV[2]);},hN));hQ=dD.empty();hR=dZ.fold_left(function(hV,hW){return(function(hX){var hY,hZ;hY=hX[0];hZ=hX[1];return function(h0){var h1;h1=h0[1];dD.add(hQ,hY,dR.New(h0[0],h1,h0[2]));return[hY+1,hZ+h1];};}(hV))(hW);},[0,0],hO);return[hQ,hR[0],hR[1]];};cy.create=function(hI,hJ,hK,hL,hM,hN){var hO,hP,hQ,hR,hS,hT,hU,hV;hO=bW.Map(function(hW,hX){return(function(){var hY,hZ,h0;hY=(hZ=(h0=hI.populations,function(h1){return h0.find_index(h1);}),function(h1){return es.map(hZ,h1);});return function(h1){return br.map(hY,h1);};}(hW))(hX);},hN);cy.empty();return cy.New(hI,ck.ofList(bX.map((hP=(hQ=(hR=(hS=(hT=hI.populations,function(hW){return hT.find_index(hW);}),function(hW){return bq.map(hS,hW);}),(hU=(hV=cX.to_env(hM),function(hW){return bq.inline_keys(hV,hO,hW);}),function(hW){return hU(hR(hW));})),function(hW){return br.expand(hQ,hW);}),function(hW){return br.simplify(hP(hW));}),hI.settings.plots)),hJ,hK,hL);};cy.calculate_reaction_deps=function(hI,hJ){var hK;function hL(hN,hO){function hP(hQ){return hQ.$==1?bY.Empty:bX.ofArray([hQ.$0]);}return dZ.disjoint(function(hQ,hR){return hQ===hR;},dZ.union(function(hQ,hR){return hQ===hR;},Z.nonzero_elements(hN.reactants),hO.$==0?bY.Empty:bX.collect(hP,br.mentions(hO.$0))),hK);}function hM(hN,hO){return function(hP){return hL(hP[0],hP[1])?[hN,hO+1]:[new bY({$:1,$0:hO,$1:hN}),hO+1];};}hK=Z.nonzero_elements(Z.difference(function(hN,hO){return hN===hO;},hI.products,hI.reactants));return bX.rev((dZ.fold_left(function(hN,hO){return(function(hP){return hM(hP[0],hP[1]);}(hN))(hO);},[bY.Empty,0],hJ))[0]);};cy.empty=function(){return cy.New(cF.empty(),[],v.get_defaults(),dD.empty(),0);};cy.New=function(hI,hJ,hK,hL,hM){return new cy({simulator:hI,plots:hJ,settings:hK,reactions:hL,total_propensity:hM});};cz=d.OdeSundials=hB.Class({simulate:function(){var hI,hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0,h1,h2,h3,h4,h5,h6,h7,h8;function h9(ib){var ic;return ib.time>=hJ.currenttime&&(ic=ib.target,ic.$==0?ck.exists(function(id){return id!==0;},ic.$0.get_get_pop_array()):true);}function h_(ib,ic){return be.toInt(ic.getStoich(hM.is_constant(ib),ib));}function h$(ib,ic){var id,ie,_if;id=ck.create(h4,1);for(ie=0,_if=h4-1;ie<=_if;ie++)ck.set(id,ie,(ck.get(h6,ie).get_key())(function(ig){return ig.$==1?ib:ck.get(ic,ig.$0);}));return id;}function ia(ib,ic,id){return function(ie){var _if,ig,ih,ii,ij,ik,il,im,_in,io,ip,iq,ir,is,it,iu,iv,iw,ix;ij=ie.time;ik=ck.tryFindIndex(function(iy){return iy>=ib;},hU);if(ik!=null&&ik.$==1){il=ik.$0;im=(_if=ck.tryFindIndex(function(iy){return iy>ij;},hU),_if!=null&&_if.$==1?_if.$0:hU.length)-il;_in=ck.sub(hU,il,im);io=im===0?[[ib],1,true]:ck.get(_in,0)>ib?[[ib].concat(_in),im+1,true]:[_in,im,false];ip=io[0];iq=io[1];ir=io[2];is=ck.get(ip,iq-1)<ij?[ip.concat([ij]),iq+1,true]:[ip,iq,false];it=is[1];iu=is[2];iv={sN:hV,rNM:hZ,stoichM:h1,powersM:h2,ratesM:hY,rNF:h4,stoichF:h5,functionalRates:h$,concs:ic,t:is[0],tN:it,sundialsOutput:function(iy,iz){function iA(iB){return iB.$==1?iy:ck.get(iz,iB.$0);}(!ir||iy!==ib)&&(iy===hN&&!iu||iy!==ij)?ck.iteri(function(iB,iC){ck.get(h7,iB).push((iC.get_key())(iA));},h8):void 0;return null;},stiff:hI.settings.stiff,abstol:hI.settings.abstolerance,reltol:hI.settings.reltolerance};ig=[hD.fnSundialsSolver(iv),iv.conc];iw=ig[0];ix=ig[1];if(iw!==0)throw new dU.New((function(iy){return function(iz){return iy("Sundials solver failed with code: "+a.String(iz));};}(a.id))(iw));return[ij,(ih=ie.target,ih.$==0?(ii=bW.OfArray(ck.ofSeq(bX.map(function(iy){var iz;return[(iz=hM.tryFind_index(iy.species),iz==null?be.FailWith("Unknown species in event"):iz.$0),iy.value];},ih.$0.get_get_pop_info_list()))),ck.mapi(function(iy,iz){var iA;iA=bW.TryFind(iy,ii);return iA==null?iz:iz+iA.$0;},ix)):ix),id+it];}else return[ib,ic,id];};}hI=this;hJ=this.simulator;hK=this.reactions;hL=hJ.settings;hM=hJ.populations;hN=hL["final"];hO=hL.times.$!==0?[hL.times,bX.map(function(ib){return ib.target=="OutputPoint"?dQ.New(bX.max(hL.times)+1,ib.target):ib;},bX.filter(h9,hJ.events))]:(hP=hL.initial,(hQ=hL.get_print_interval(),(hR=bX.init(hL.points+1,function(ib){return hP+ib*hQ;}),(hS=bX.filter(h9,hJ.events),[bX.sort(bX.append(hR,bX.collect(function(ib){return ib.target=="OutputPoint"?bY.Empty:bX.ofArray([ib.time-1E-08,ib.time]);},hS))),hS]))));hT=hO[0];hU=ck.ofList(hT);hV=hM.get_get_count();hW=ck.length(this.plots);hX=bX.filter(function(ib){return ib.rate.$==0;},hK);hY=ck.ofList(bX.map(function(ib){var ic;ic=ib.rate;return ic.$==0?ic.$0:be.FailWith("Unexpected reaction type");},hX));hZ=bX.length(hX);h0=be.range(0,hV-1);h1=ck.ofSeq(co.collect(function(ib){return co.map(function(ic){return h_(ic,ib);},h0);},hX));h2=ck.create(hV*hZ,0);bX.iteri(function(ib,ic){return Z.iterm(function(id){ck.set(h2,hV*ib+id.element,id.multiplicity);},ic.reactants);},hX);h3=bX.filter(function(ib){return ib.rate.$==1;},hK);h4=bX.length(h3);h5=ck.ofSeq(co.collect(function(ib){return co.map(function(ic){return h_(ic,ib);},h0);},h3));h6=ck.create(h4,null);bX.iteri(function(ib,ic){var id;id=ic.rate;return id.$==1?ck.set(h6,ib,id.$0):be.FailWith("Unexpected reaction type");},h3);h7=ck.init(hW,function(){return[];});h8=ck.map(br.to_lambda,this.plots);co.fold(function(ib,ic){return(function(id){return ia(id[0],id[1],id[2]);}(ib))(ic);},[hL.initial,this.concs,0],hO[1]);return O.from_array_columns(hT,ck.ofSeq(co.map(ck.ofSeq,h7)),bX.map(cL.to_string_plot,hL.plots));}},null,cz);cz.New=function(hI,hJ,hK,hL,hM){return new cz({simulator:hI,plots:hJ,reactions:hK,settings:hL,concs:hM});};cA.toSafe=function(hI){return hI==null?"":hI;};cA.prettyPrint=function(hI){var hJ,hK;function hL(hM,hN){return hM+" = "+cA.prettyPrint(hN);}return hI===null?"null":(hJ=typeof hI,hJ=="string"?"\\""+hI+"\\"":hJ=="object"?hI instanceof a.Array?"[|"+cS.concat("; ",ck.map(cA.prettyPrint,hI))+"|]":(hK=a.String(hI),hK==="[object Object]"?"{"+cS.concat("; ",ck.map(function(hM){return hL(hM[0],hM[1]);},c$.GetFields(hI)))+"}":hK):a.String(hI));};cA.printArray=function(hI,hJ){return hJ===null?"null":"[|"+cS.concat("; ",ck.map(hI,hJ))+"|]";};cB.to_string=function(hI,hJ){return cB.to_string_normalise(true,hI,hJ);};cB.to_string_normalise=function(hI,hJ,hK){return"<svg xmlns=\\"http://www.w3.org/2000/svg\\" height=\\""+cB.display_float(hK.box_dim.y)+"\\" width=\\""+cB.display_float(hK.box_dim.x)+"\\">\\r\\n  <style>"+hJ+"</style>\\r\\n  "+cB.group_to_string(hI,hK.box_group)+"\\r\\n</svg>";};cB.stackhc=function(hI,hJ,hK){var hL,hM;function hN(hO,hP){return function(hQ){var hR;return[new bY({$:1,$0:(hR=hQ.box_group,dY.New(hR.name,hR.content,hR.anchors,hR.debug_anchors,hR.sub_groups,{$:1,$0:dW.New(hP.x,hP.y+(hL-hQ.box_dim.y)/2)})),$1:hO}),dW.New(hP.x+hQ.box_dim.x+hJ,hP.y)];};}hL=bX.max(bX.map(function(hO){return hO.box_dim.y;},hK));hM=co.fold(function(hO,hP){return(function(hQ){return hN(hQ[0],hQ[1]);}(hO))(hP);},[bY.Empty,hI],hK);return dX.New(dY.New("",{$:0,$0:bY.Empty},bY.Empty,false,hM[0],null),dW.New(hM[1].x-hJ+hI.x,hL+2*hI.y));};cB.stackv=function(hI,hJ,hK){var hL;function hM(hN,hO){return function(hP){var hQ;return[new bY({$:1,$0:(hQ=hP.box_group,dY.New(hQ.name,hQ.content,hQ.anchors,hQ.debug_anchors,hQ.sub_groups,{$:1,$0:hO})),$1:hN}),dW.New(hO.x,hO.y+hP.box_dim.y+hJ)];};}hL=co.fold(function(hN,hO){return(function(hP){return hM(hP[0],hP[1]);}(hN))(hO);},[bY.Empty,hI],hK);return dX.New(dY.New("",{$:0,$0:bY.Empty},bY.Empty,false,hL[0],null),dW.New((hK.$==0?0:bX.max(bX.map(function(hN){return hN.box_dim.x;},hK)))+2*hI.x,hL[1].y-hJ+hI.y));};cB.display_float=function(hI){return a.String(hC.floor(hI*1000)/1000);};cB.group_to_string=function(hI,hJ){return"<g"+(cB.translate_to_string())(hJ.offset)+">\\r\\n  "+cB.content_to_string(hI,hJ.content)+(hJ.debug_anchors?cS.concat(" ",bX.map(cB.debug_anchor,hJ.anchors)):"")+cB.string_of_list(function(hK){return cB.group_to_string(hI,hK);},"\\r\\n  ",hJ.sub_groups)+"\\r\\n</g>";};cB.label_box=function(hI,hJ,hK){var hL;hL=hJ*cS.length(hK);return dX.New(dY.New("",{$:0,$0:bX.ofArray([fZ.New(hI,bY.Empty,{$:1,$0:f0.New(hK,dW.New(0,cB.text_height()),hI,hJ,dW.New(hL,cB.text_height()))})])},bY.Empty,false,bY.Empty,null),dW.New(hL,cB.text_height()));};cB.default_letter_width=function(){f1.$cctor();return f1.default_letter_width;};cB.emerge_groups=function(hI){var hJ,hK,hL,hM,hN,hO;hJ=bX.collect(cB.points_in_group,hI);hK=bX.map(function(hP){return hP.x;},hJ);hL=bX.map(function(hP){return hP.y;},hJ);hM=dW.New(bX.min(hK),bX.min(hL));hN=dW.New(bX.max(hK),bX.max(hL));hO=cB.sub(cB.origo(),hM);return dX.New(dY.New(co.fold(function(hP,hQ){return hP+" "+hQ.name;},"",hI),{$:0,$0:bY.Empty},bY.Empty,false,bX.map((cB.translate_group_by())(hO),hI),null),cB.translate_point_by(hO,hN));};cB.translate_to_string=function(){f1.$cctor();return f1.translate_to_string;};cB.content_to_string=function(hI,hJ){return hJ.$==1?hJ.$0:cB.string_of_list(function(hK){return cB.path_to_string(hI,hK);},"\\r\\n  ",hJ.$0);};cB.debug_anchor=function(hI){return(((hB.Curried3(function(hJ,hK,hL){return hJ("<circle cx=\\""+hK.toFixed(6)+"\\" cy=\\""+hL.toFixed(6)+"\\" r=\\"5\\" stroke=\\"#DDDDFF\\" stroke-width=\\"0.5\\"/>");}))(a.id))(hI.anchor_point.x))(hI.anchor_point.y);};cB.string_of_list=function(hI,hJ,hK){return hK.$==0?"":bX.reduce(function(hL,hM){return hL+hJ+hM;},bX.map(hI,hK));};cB.text_height=function(){f1.$cctor();return f1.text_height;};cB.content_group=function(hI){return dY.New("",hI,bY.Empty,false,bY.Empty,null);};cB.rounded_box=function(hI,hJ,hK){var hL;hL=go.New(hK,hK,false,true,0);return bX.ofArray([{$:0,$0:dW.New(hI.x+hK,hI.y)},{$:1,$0:dW.New(hJ.x-hK,hI.y)},{$:2,$0:dW.New(hJ.x,hI.y+hK),$1:hL},{$:1,$0:dW.New(hJ.x,hJ.y-hK)},{$:2,$0:dW.New(hJ.x-hK,hJ.y),$1:hL},{$:1,$0:dW.New(hI.x+hK,hJ.y)},{$:2,$0:dW.New(hI.x,hJ.y-hK),$1:hL},{$:1,$0:dW.New(hI.x,hI.y+hK)},{$:2,$0:dW.New(hI.x+hK,hI.y),$1:hL},gT.ClosePath]);};cB.sub=function(hI,hJ){return dW.New(hI.x-hJ.x,hI.y-hJ.y);};cB.translate_point_by=function(hI,hJ){return dW.New(hI.x+hJ.x,hI.y+hJ.y);};cB.scale_by=function(hI,hJ){return dW.New(hI*hJ.x,hI*hJ.y);};cB.points_in_group=function(hI){return bX.append(cB.points_in_content(hI.content),bX.collect(cB.points_in_group,hI.sub_groups));};cB.origo=function(){f1.$cctor();return f1.origo;};cB.translate_group_by=function(){f1.$cctor();return f1.translate_group_by;};cB.attach_group_to=function(hI,hJ,hK,hL){return cB.translate_group_to(cB.get_anchor(hJ,hI).anchor_point,hK,hL);};cB.get_anchor_point=function(hI,hJ){return cB.get_anchor(hI,hJ).anchor_point;};cB.rotate_point_around=function(hI,hJ,hK){var hL,hM,hN;hL=cB.sub(hK,hI);hM=cB.norm(hL);hN=cB.dir(hL)+cB.pi()*hJ/180;return cB.translate_point_by(hI,dW.New(hM*hC.cos(hN),hM*hC.sin(hN)));};cB.path_to_string=function(hI,hJ){var hK,hL,hM,hN;hK=(hL=hJ.commands,hL.$==0?"":"<path "+(hM=hJ.path_class,hM!=null&&hM.$==1?"class=\\""+hM.$0+"\\" ":"")+"d=\\""+cB.string_of_list(cB.path_command_to_string,"\\r\\n         ",hL)+"\\" />");hN=hJ.path_label;return hN!=null&&hN.$==1?hK+"\\r\\n"+cB.label_to_string(hI,hN.$0):hK;};cB.fontsize=function(){f1.$cctor();return f1.fontsize;};cB.transform_anchor_by=function(hI,hJ){return e_.New(hJ.anchor_id,hI(hJ.anchor_point));};cB.transform_path_command_by=function(hI,hJ){return hJ.$==1?{$:1,$0:hI(hJ.$0)}:hJ.$==2?{$:2,$0:hI(hJ.$0),$1:hJ.$1}:hJ.$==3?gT.ClosePath:{$:0,$0:hI(hJ.$0)};};cB.transform_label_by=function(hI,hJ){return f0.New(hJ.label_text,hI(hJ.label_anchor),hJ.label_class,hJ.letter_width,hI(hJ.label_dir));};cB.transform_path_by=function(hI,hJ){var hK;return fZ.New(hJ.path_class,bX.map(function(hL){return cB.transform_path_command_by(hI,hL);},hJ.commands),(hK=hJ.path_label,hK!=null&&hK.$==1?{$:1,$0:cB.transform_label_by(hI,hK.$0)}:null));};cB.on_option=function(hI,hJ,hK){return hK!=null&&hK.$==1?hI(hK.$0):hJ;};cB.point_to_string=function(hI){return cB.display_float(hI.x)+","+cB.display_float(hI.y);};cB.transform_group_by=function(hI,hJ){return dY.New(hJ.name,cB.transform_content_by(hI,hJ.content),bX.map(function(hK){return cB.transform_anchor_by(hI,hK);},hJ.anchors),hJ.debug_anchors,bX.map(function(hK){return cB.transform_group_by(hI,hK);},hJ.sub_groups),hJ.offset);};cB.points_in_content=function(hI){return hI.$==1?bY.Empty:bX.collect(cB.points_in_path,hI.$0);};cB.rotate_group_around_anchor=function(hI,hJ,hK){return(cB.rotate_group_around(cB.get_anchor_point(hI,hK),hJ))(hK);};cB.translate_group_to=function(hI,hJ,hK){var hL;hL=cB.sub(hI,cB.get_anchor(hK,hJ).anchor_point);return((cB.translate_group_by())(hL))(hJ);};cB.get_anchor=function(hI,hJ){return co.find(function(hK){return hK.anchor_id===hI;},hJ.anchors);};cB.norm=function(hI){return hC.sqrt(hI.x*hI.x+hI.y*hI.y);};cB.pi=function(){f1.$cctor();return f1.pi;};cB.dir=function(hI){var hJ,hK;hJ=hI.x;hK=hI.y;return hJ===0?hK===0?0:hK>0?cB.pi()/2:3*cB.pi()/2:hK===0?hJ>0?0:cB.pi():hJ>0?hC.atan(hK/hJ):hC.atan(hK/hJ)+cB.pi();};cB.anchor_to_anchor=function(hI,hJ,hK,hL){return cB.sub(cB.get_anchor_point(hL,hK),cB.get_anchor_point(hJ,hI));};cB.rad_to_deg=function(hI){return 180*hI/cB.pi();};cB.ang=function(hI){return cB.rad_to_deg(cB.dir(hI));};cB.path_command_to_string=function(hI){return hI.$==1?"L "+cB.point_to_string(hI.$0):hI.$==2?"A "+cB.arc_to_string(hI.$1)+" "+cB.point_to_string(hI.$0):hI.$==3?"z":"M "+cB.point_to_string(hI.$0);};cB.label_to_string=function(hI,hJ){var hK,hL;hK=hI?cB.normalise_label(hJ):hJ;return"<text "+(hL=hK.label_class,hL!=null&&hL.$==1?"class=\\""+hL.$0+"\\" ":"")+" x=\\""+cB.display_float(hK.label_anchor.x)+"\\" y=\\""+cB.display_float(hK.label_anchor.y)+"\\" transform=\\"rotate("+cB.display_float(cB.label_angle(hK))+" "+cB.point_to_string(hK.label_anchor)+")\\">"+hK.label_text+"</text>";};cB.transform_content_by=function(hI,hJ){return hJ.$==1?{$:1,$0:hJ.$0}:{$:0,$0:bX.map(function(hK){return cB.transform_path_by(hI,hK);},hJ.$0)};};cB.points_in_path=function(hI){var hJ,hK;hJ=bX.collect(function(hL){var hM,hN,hO;switch(hL.$==1?(hM=hL.$0,0):hL.$==2?1:hL.$==3?2:(hM=hL.$0,0)){case 0:return bX.ofArray([dW.New(hM.x+cB.pointradius(),hM.y+cB.pointradius()),dW.New(hM.x-cB.pointradius(),hM.y-cB.pointradius())]);case 1:hN=hL.$0;hO=hL.$1;return bX.ofArray([dW.New(hN.x+hO.rx,hN.y+hO.ry),dW.New(hN.x-hO.rx,hN.y-hO.ry)]);case 2:return bY.Empty;}},hI.commands);hK=hI.path_label;return hK!=null&&hK.$==1?bX.append(cB.points_in_label(hK.$0),hJ):hJ;};cB.rotate_group_around=function(hI,hJ){function hK(hL){return cB.rotate_point_around(hI,hJ,hL);}return function(hL){return cB.transform_group_by(hK,hL);};};cB.arc_to_string=function(hI){return cB.display_float(hI.rx)+","+cB.display_float(hI.ry)+" "+cB.display_float(hI.angle)+" "+cB.flag_to_string(hI.large_flag)+","+cB.flag_to_string(hI.sweep_flag);};cB.normalise_label=function(hI){var hJ,hK,hL,hM,hN,hO,hP;hJ=cB.sub(hI.label_dir,hI.label_anchor);hK=cB.ang(hJ)%360;hL=hK<270&&hK>90?(hM=(hN=cB.rotate_point_around(cB.origo(),-90,hJ),cB.scale_to(cB.half_text_height(),hN)),(hO=cB.rotate_point_around(cB.origo(),-180,hJ),(hP=cB.translate_point_by(hM,hI.label_anchor),[hP,cB.translate_point_by(hO,hP)]))):[hI.label_anchor,hI.label_dir];return f0.New(hI.label_text,hL[0],hI.label_class,hI.letter_width,hL[1]);};cB.label_angle=function(hI){return cB.ang(cB.sub(hI.label_dir,hI.label_anchor));};cB.pointradius=function(){f1.$cctor();return f1.pointradius;};cB.points_in_label=function(hI){var hJ,hK,hL;hJ=(hK=cS.length(hI.label_text)*hI.letter_width/2,(hL=cB.text_height(),cw.Compare(hK,hL)===1?hK:hL));return bX.ofArray([dW.New(hI.label_anchor.x-hJ,hI.label_anchor.y-hJ),dW.New(hI.label_anchor.x+hJ,hI.label_anchor.y+hJ)]);};cB.translate_path_by=function(){f1.$cctor();return f1.translate_path_by;};cB.rotate_path_around=function(hI,hJ){function hK(hL){return cB.rotate_point_around(hI,hJ,hL);}return function(hL){return cB.transform_path_by(hK,hL);};};cB.rotate_label_around=function(hI,hJ){function hK(hL){return cB.rotate_point_around(hI,hJ,hL);}return function(hL){return cB.transform_label_by(hK,hL);};};cB.rotate_path_command_around=function(hI,hJ){function hK(hL){return cB.rotate_point_around(hI,hJ,hL);}return function(hL){return cB.transform_path_command_by(hK,hL);};};cB.flag_to_string=function(hI){return hI?"1":"0";};cB.scale_to=function(hI,hJ){return cB.scale_by(hI/cB.norm(hJ),hJ);};cB.half_text_height=function(){f1.$cctor();return f1.half_text_height;};cC=d.Lna=hB.Class({simulate_callback:function(hI,hJ){var hK,hL,hM,hN,hO,hP;function hQ(hT){return[d1.array(hT,{$:1,$0:0},{$:1,$0:hN-1}),d1.array(hT,{$:1,$0:hN},{$:1,$0:2*hN-1}),ck.init(hN,function(hU){return d1.array(hT,{$:1,$0:(2+hU)*hN},{$:1,$0:(3+hU)*hN-1});})];}function hR(hT,hU){var hV,hW,hX,hY,hZ,h0,h1,h2;hV=hQ(dK.toArray(hU));hW=dK.ofArray(hV[0]);hX=dK.ofArray(hV[1]);hY=dN.ofArray(hV[2]);hZ=(hK.props(hT))(hW);h0=hK.drift(hZ);h1=hK.jacobian(hW);h2=dN.add(dN.add(dN.matrMultMatr(h1,hY),dN.matrMultMatr(hY,cC.OsloTranspose(h1))),h0);return dK.ofArray(ck.concat(bX.ofArray([dK.toArray(dN.matrMultVec(dN.ofArray(hK.stoich),hZ)),dK.toArray(dN.matrMultVec(h1,hX)),ck.collect(function(h3){return dK.toArray(h2.get_Item(h3));},ck.ofSeq(be.range(0,hN-1)))])));}function hS(hT,hU){function hV(hX){return hU[hX];}function hW(hX){var hY;hY=hU[2*hN+hX*(hN+1)];return hY<0?0:hC.sqrt(hY);}return ck.map(function(hX){function hY(hZ,h0){return h0.$==0?hZ(h0.$0):hT;}return hK.outputconcentrations?bQ.create(br["eval"](function(hZ){return hY(hV,hZ);},hX),br["eval"](function(hZ){return hY(hW,hZ);},hX)/hM):bQ.create(hL*br["eval"](function(hZ){return hY(hV,hZ);},hX),br["eval"](function(hZ){return hY(hW,hZ);},hX)*hM);},hK.ode.plots);}hK=this;hL=this.scale;hM=hC.sqrt(hL);bX.exists(function(hT){return hT.target!="OutputPoint";},this.ode.simulator.events)?be.FailWith("Events not supported for LNA integration"):void 0;hN=ck.length(this.initials);hO=dK.ofArray(this.initials.concat(ck.create(hN+hN*hN,0)));return cC.New((hP=this.ode,cx.New(hP.name,dH.simulate_callback(hI,hJ,dH.create(this.ode.name,this.ode.simulator,function(hT){return function(hU){return hS(hT,hU);};},hB.Curried(bQ.interpolate,5),this.ode.settings,hO,function(hT){return function(hU){return hR(hT,hU);};})).simulator,hP.plots,hP.settings,hP.stoich,hP.powers,hP.rateDs,hP.concs)),this.outputconcentrations,this.initials,this.stoich,this.covariance,this.times,this.nextprinttime,this.jacobian,this.drift,this.props,this.stepsdone,this.scale);}},null,cC);cC.OsloTranspose=function(hI){var hJ,hK,hL,hM,hN,hO,hP;hJ=dN.numCols(hI);hK=dN.numRows(hI);hL=dN.zeros(hJ,hK);for(hM=0,hN=hK-1;hM<=hN;hM++){for(hO=0,hP=hJ-1;hO<=hP;hO++)(hL.get_Item(hO))[hM]=(hI.get_Item(hM))[hO];}return hL;};cC.initialise=function(hI,hJ,hK,hL){var hM,hN;function hO(hR){return hR.$==1?be.FailWith("Functional rates not yet implemented"):hR.$0;}function hP(hR){return ck.mapi(function(hS,hT){return ck.map(function(hU){var hV;function hW(hX,hY){return hX===hU;}return bX.exists(function(hX){return hW(hX[0],hX[1]);},ck.get(hI.powers,hS))?(hV=ck.get(hI.powers,hS),co.fold(function(hX,hY){var hZ,h0;hZ=hY[0];h0=hY[1];return hZ===hU?hX*h0*hC.pow(hR[hZ],h0-1):hX*hC.pow(hR[hZ],h0);},hO(hT),hV)):0;},ck.ofSeq(be.range(0,hM-1)));},hI.rateDs);}function hQ(hR,hS){var hT,hU,hV,hW;hT=new a.Float64Array(hN);for(hU=0,hV=hN-1;hU<=hV;hU++){hT[hU]=(hW=ck.get(hI.rateDs,hU),hW.$==1?hW.$0.$0(function(hX){return hX.$==1?hR:hS[hX.$0];}):co.fold(function(hX,hY){return hX*hC.pow(hS[hY[0]],hY[1]);},hW.$0,ck.get(hI.powers,hU)));}return hT;}hM=hJ.length;hN=ck.get(hJ,0).length;return cC.New(hI,true,hK,hJ,dN.zeros(0,0),bY.Empty,0,function(hR){var hS;hS=hP(hR);return dN.matrMultMatr(dN.ofArray(hJ),dN.ofArray(hS));},function(hR){return ck.reduce(dN.add,ck.mapi(function(hS){var hT;hT=dN.copyCol(hI.stoich,hS);return dN.matrMultScal(cC.CrossProduct(hT,hT),hR[hS]);},ck.ofSeq(be.range(0,hN-1))));},function(hR){return function(hS){return hQ(hR,hS);};},0,hL);};cC.CrossProduct=function(hI,hJ){var hK,hL,hM,hN,hO,hP,hQ,hR;hK=hI.length;hL=hJ.length;hM=dN.zeros(hK,hL);for(hN=0,hO=hK-1;hN<=hO;hN++){for(hP=0,hQ=hL-1;hP<=hQ;hP++){hR=hI[hN]*hJ[hP];(ck.get(hM.MatrixData,hN))[hP]=hR;}}return hM;};cC.New=function(hI,hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT){return new cC({ode:hI,outputconcentrations:hJ,initials:hK,stoich:hL,covariance:hM,times:hN,nextprinttime:hO,jacobian:hP,drift:hQ,props:hR,stepsdone:hS,scale:hT});};cD=d.Population=hB.Class({},null,cD);cD.create=function(hI,hJ,hK){return cD.create$1(hI,hJ,hK,true,true,null);};cD.create$1=function(hI,hJ,hK,hL,hM,hN){return cD.New(hI,hJ,hK,hL,hM,null,hN);};cD.New=function(hI,hJ,hK,hL,hM,hN,hO){return new cD({constant:hI,value:hJ,species:hK,initial:hL,input:hM,spatial_initial:hN,max:hO});};cE=d.Populations=hB.Class({set_population:function(hI,hJ){var hK;ck.set(this.index_to_species,hI,(hK=ck.get(this.index_to_species,hI),cD.New(hK.constant,hJ,hK.species,hK.initial,hK.input,hK.spatial_initial,hK.max)));},get_population:function(hI){return ck.get(this.index_to_species,hI).value;},get_get_pop_info_list:function(){return bX.ofArray(this.index_to_species);},find_index:function(hI){return dD.find(this.species_to_index,hI);},get_get_pop_array:function(){return ck.map(function(hI){return hI.value;},this.index_to_species);},get_get_count:function(){return this.index_to_species.length;},is_constant:function(hI){return ck.get(this.index_to_species,hI).constant;},tryFind_index:function(hI){return dD.tryFind(this.species_to_index,hI);},get_clone:function(){return cE.New(this.index_to_species.slice(),dD.copy(this.species_to_index));},map_population:function(hI){return cE.New(ck.map(function(hJ){return cD.create$1(hJ.constant,hI(hJ.value),hJ.species,hJ.initial,hJ.input,hJ.max);},this.index_to_species),dD.copy(this.species_to_index));},add_pop_info:function(hI){var hJ,hK,hL,hM;return(hJ=dD.tryFind(this.species_to_index,hI.species),hJ!=null&&hJ.$==1)?be.FailWith("Adding pop_info for species twice"):(hK=this.index_to_species.length,(hL=this.index_to_species.concat([hI]),(hM=dD.copy(this.species_to_index),(dD.add(hM,hI.species,hK),cE.New(hL,hM)))));}},null,cE);cE.test_integer_or_constant=function(hI){return ck.fold(function(hJ,hK){var hL;hL=hK.value;return(hC.round(hL)-hL===0||hK.constant)&&hJ;},true,hI.index_to_species);};cE.scale=function(hI,hJ){return hI.map_population(function(hK){return hJ*hK;});};cE.merge=function(hI,hJ,hK){return ck.fold(function(hL,hM){var hN,hO,hP;hN=dD.tryFind(hL.species_to_index,hM.species);return hN!=null&&hN.$==1?(hO=hN.$0,(hP=ck.get(hL.index_to_species,hO),(ck.set(hL.index_to_species,hO,cD.New(hP.constant,hI(hP.value,hM.value),hP.species,hP.initial,hP.input,hP.spatial_initial,hP.max)),hL))):hL.add_pop_info(hM);},hJ,hK.index_to_species);};cE.create=function(hI){var hJ,hK;hJ=ck.ofList(hI);hK=dD.empty();bX.iteri(function(hL,hM){ck.set(hJ,hL,hM);return dD.add(hK,hM.species,hL);},hI);return cE.New(hJ,hK);};cE.empty=function(){return cE.New([],dD.empty());};cE.New=function(hI,hJ){return new cE({index_to_species:hI,species_to_index:hJ});};cF.create=function(hI,hJ,hK,hL){var hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV;function hW(hY,hZ){return hY+hZ;}function hX(hY,hZ){return hY+hZ;}hM=hL!==1?[cE.scale(hI,hL),bX.map(function(hY){var hZ;hZ=hY.target;return hZ.$==0?dQ.New(hY.time,{$:0,$0:cE.scale(hZ.$0,hL)}):hY;},hJ)]:[hI,hJ];hN=hM[0];hO=new bY({$:1,$0:dQ.New(hK["final"],"OutputPoint"),$1:bX.filter(function(hY){var hZ;hZ=hY.target;return hZ.$==0?ck.exists(function(h0){return h0!==0;},hZ.$0.get_get_pop_array()):true;},hM[1])});hP=bX.choose(function(hY){return hY.target.$==0?{$:1,$0:hY.time}:null;},hO);hQ=hP.$==0?[hN,bX.sortBy(function(hY){return hY.time;},hO)]:(hR=bX.min(hP),hR<hK.initial?(hS=bX.partition(function(hY){return hY.target.$==0&&hY.time<hK.initial;},hO),[cE.merge(function(hY,hZ){return hY+hZ;},hN,(hT=(hB.Curried3(cE.merge))(hW),bX.reduce(function(hY,hZ){return(hT(hY))(hZ);},bX.choose(function(hY){var hZ;hZ=hY.target;return hZ.$==0?{$:1,$0:hZ.$0}:null;},hS[0])))),bX.sortBy(function(hY){return hY.time;},hS[1])]):hR===hK.initial?(hU=bX.partition(function(hY){return hY.target.$==0&&hY.time===hR;},hO),[cE.merge(function(hY,hZ){return hY+hZ;},hN,(hV=(hB.Curried3(cE.merge))(hX),bX.reduce(function(hY,hZ){return(hV(hY))(hZ);},bX.choose(function(hY){var hZ;hZ=hY.target;return hZ.$==0?{$:1,$0:hZ.$0}:null;},hU[0])))),bX.sortBy(function(hY){return hY.time;},hU[1])]):[hN,bX.sortBy(function(hY){return hY.time;},hO)]);return cF.New(hK,hQ[0],hQ[1],hK.initial,hK.initial,0);};cF.empty=function(){return cF.New(bx.get_defaults(),cE.empty(),bY.Empty,0,0,0);};cF.New=function(hI,hJ,hK,hL,hM,hN){return{settings:hI,populations:hJ,events:hK,currenttime:hL,nextprinttime:hM,stepsdone:hN};};cG=d.Cme=hB.Class({simulate_sundials_callback:function(hI,hJ,hK,hL){var hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h2,h3,h4,h5,h6,h7,h8,h9,h_,h$,ia,ib,ic;function h0(id){return bq.inline_keys(hJ,hK,id);}function h1(id){return br.expand(hS,id);}h2=this.simulator;h3=h2.settings;h4=h3.times.$!==0?h3.times:(hM=h3.initial,hN=h3.get_print_interval(),bX.init(h3.points+1,function(id){return hM+id*hN;}));if(bX.exists(function(id){return id.target!="OutputPoint";},h2.events))be.FailWith("Events not supported for CME integration");h5=this.statespace[0].statespace_for_CME_sundials(hJ,h2.populations.index_to_species.length);h6=h5[1];h7=h5[0][0];h8=h5[2];h9=dN.ofRows(ck.init(dN.numRows(h6),function(id){return dK.ofArray(ck.init(dN.numCols(h6),function(ie){return hC.pow((ck.get(h6.MatrixData,id))[ie],2);}));}));h_=ck.ofList(h4);h$=h8.length;ia=h4.get_Length();ib=[];ic={stateN:h$,transN:h7.length,propensities:h7,sources:h5[0][2],targets:h5[0][1],diagonals:h5[0][3],prob_mass:h8,timesToReturnParam:h_,numTimesToReturnParam:ia,sundialsOutput:function(id,ie){ib.push(dK.ofArray(ie));return null;},stiff:this.settings.stiff,abstol:this.settings.abstolerance,reltol:this.settings.reltolerance};hQ=[hD.fnSundialsCMESolver(ic),ic.prob_mass];hP=hQ[0];hP!==0?(function(id){return function(ie){return id("Sundials solver failed with code: "+a.String(ie));};}(be.FailWith))(hP):void 0;hR=bX.ofSeq(ib);hS=(hT=(hU=(hV=(hW=h2.populations,function(id){return hW.find_index(id);}),function(id){return es.map(hV,id);}),function(id){return br.map(hU,id);}),function(id){return hT(h0(id));});hX=ck.map(function(id){return br.simplify(h1(id));},ck.ofList(h2.settings.plots));hY=bK.New(h4,bX.map(dK.toArray,hR),dN.toArray(h6),dD.map_key(function(id){return id.name;},h2.populations.species_to_index));hZ=bX.map2(function(id,ie){function _if(ih){return dK.dot(ie,dN.copyCol(h6,ih));}function ig(ih,ii){var ij;ij=dK.dot(ie,dN.copyCol(h9,ii))-ih*ih;return ij<0?0:hC.sqrt(ij);}return bJ.New(id,ck.map(function(ih){var ii,ij;return ih.$==0&&(ih.$0.$==0&&(ii=ih.$0.$0,true))?(ij=_if(ii),bQ.New(ij,ig(ij,ii))):be.FailWith("Species functions are not supported in plots (use single species only).");},hX));},h4,hR);bX.iter(hL,hZ);return[cG.New(this.name,this.simulator,this.settings,this.statespace,hY),this.process_simulation(hZ)];},process_simulation:function(hI){var hJ,hK;hJ=this.simulator.settings.times;hK=bX.map(cL.to_string_plot,this.simulator.settings.plots);return hJ.$===0?O.from_rows(hK,hI):O.from_rows(hK,bJ.interpolate_reverse(function(hL,hM,hN){return hB.Curried(bQ.interpolate,2,[hL,hM,hN]);},hI,hJ));}},null,cG);cG.get_times=function(hI){return hI.times;};cG.simulate_callback=function(hI,hJ,hK,hL,hM,hN){var hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0;function h1(h4){return bq.inline_keys(hI,hJ,h4);}function h2(h4){return br.expand(hP,h4);}function h3(h4,h5){function h6(h8){return dK.dot(h5,dN.copyCol(hX,h8));}function h7(h8,h9){var h_;h_=dK.dot(h5,dN.copyCol(hY,h9))-h8*h8;return h_<0?0:hC.sqrt(h_);}hZ[0]=new bY({$:1,$0:h4,$1:hZ[0]});h0[0]=new bY({$:1,$0:h5,$1:h0[0]});return ck.map(function(h8){var h9,h_;return h8.$==0&&(h8.$0.$==0&&(h9=h8.$0.$0,true))?(h_=h6(h9),bQ.New(h_,h7(h_,h9))):be.FailWith("Species functions are not supported in plots (use single species only).");},hU);}hO=hN.simulator;hP=(hQ=(hR=(hS=(hT=hO.populations,function(h4){return hT.find_index(h4);}),function(h4){return es.map(hS,h4);}),function(h4){return br.map(hR,h4);}),function(h4){return hQ(h1(h4));});hU=ck.map(function(h4){return br.simplify(h2(h4));},ck.ofList(hO.settings.plots));bX.exists(function(h4){return h4.target!="OutputPoint";},hO.events)?be.FailWith("Events not supported for CME integration"):void 0;hM?cG.consoleWrite("Converting state-space to sparse matrix for CME integration"):void 0;hV=hN.statespace[0].statespace_for_CME_integration(hI,hO.populations.index_to_species.length);hW=hV[0];hX=hV[1];hY=dN.ofRows(ck.init(dN.numRows(hX),function(h4){return dK.ofArray(ck.init(dN.numCols(hX),function(h5){return hC.pow((ck.get(hX.MatrixData,h4))[h5],2);}));}));hM?cG.consoleWrite("Integrating CME for probabilities"):void 0;hZ=[bY.Empty];h0=[bY.Empty];return cG.New(hN.name,dH.simulate_callback(hK,hL,dH.create(hN.name,hN.simulator,function(h4){return function(h5){return h3(h4,h5);};},hB.Curried(bQ.interpolate,5),hN.settings,hV[2],function(){var h4;function h5(h6){return hW.timesRight(h6);}h4=function(h6){return h5(dK.toArray(h6));};return function(h6){return dK.ofArray(h4(h6));};})).simulator,hN.settings,hN.statespace,bK.New(bX.rev(hZ[0]),dZ.rev_map(dK.toArray,h0[0]),dN.toArray(hX),dD.map_key(function(h4){return h4.name;},hO.populations.species_to_index)));};cG.consoleWrite=function(hI){hE.log(hI);};cG.create=function(hI,hJ,hK,hL,hM){var hN;hN=cG.get_empty();return cG.New(hN.name,cF.create(hI,hJ,hL,hM),hK,hN.statespace,hN.probabilities);};cG.get_empty=function(){return cG.New("None",cF.empty(),w.get_defaults(),[dB.New(dA.empty(),new cj.New([]))],bK.get_empty());};cG.New=function(hI,hJ,hK,hL,hM){return new cG({name:hI,simulator:hJ,settings:hK,statespace:hL,probabilities:hM});};cH.simulate_1d_callback=function(hI,hJ,hK){var hL,hM,hN,hO;function hP(hR,hS){function hT(hU,hV){return hV.$==1?hR:ck.get(ck.get(hS,hU),hV.$0);}return ck.map(function(hU){return ck.init(hM.nx,function(hV){return br["eval"](function(hW){return hT(hV,hW);},hU);});},hN);}function hQ(hR){return bJ.New(hR.t,hP(hR.t,hR.u));}hL=cH.inline_parameters(hK);hM=hL[1];hN=hL[2];hO=hL[0];co.iter(function(hR){return hJ(hQ(hR));},hK.settings.boundary=="ZeroFlux"?d6.neumann_solve(hK.sim_settings.initial,cH.generate_initialconditions1d(hK.rng,hK.settings,hK.populations.index_to_species),function(hR,hS){return(hO(hR))(hS);},hM,1):d6.periodic_solve(hK.sim_settings.initial,cH.generate_initialconditions1d(hK.rng,hK.settings,hK.populations.index_to_species),function(hR,hS){return(hO(hR))(hS);},hM));};cH.simulate_2d_callback=function(hI,hJ,hK){var hL,hM,hN,hO;function hP(hQ,hR){return ck.map(function(hS){return ck.init(hM.nx,function(hT){return ck.init(hM.nx,function(hU){var hV;function hW(hX){return hX.$==1?hQ:ck.get(hV,hX.$0);}hV=ck.get(ck.get(hR,hT),hU);return br["eval"](hW,hS);});});},hN);}hL=cH.inline_parameters(hK);hM=hL[1];hN=hL[2];hO=hL[0];co.iter(hJ,co.map(function(hQ){return bJ.New(hQ.t,hP(hQ.t,hQ.u));},hK.settings.boundary=="ZeroFlux"?d_.neumann_solve(hK.sim_settings.initial,cH.generate_initialconditions2d(hK.rng,hK.settings,hK.populations.index_to_species),function(hQ,hR){return(hO(hQ))(hR);},hM):d_.periodic_solve(hK.sim_settings.initial,cH.generate_initialconditions2d(hK.rng,hK.settings,hK.populations.index_to_species),function(hQ,hR){return(hO(hQ))(hR);},hM)));};cH.accumulator_1d=function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ,hR;function hS(hT,hU){return(cH.perturb(hI,hP.random))(hU);}hL=bX.partition(function(hT){return hT.spatial!=null;},bX.ofSeq(hK));hM=hL[0];hN=co.sumBy(function(hT){return hT.value;},hL[1]);hO=ck.init(hJ,function(hT){return[hT/(hJ-1),hN];});return hM.$==1?hM.$1.$==0?(hP=hM.$0.spatial.$0,ck.map(function(hT){return hS(hT[0],hT[1]);},bX.foldBack(function(hT,hU){return ck.map(function(hV){return hT.apply1d(hV[0],hV[1]);},hU);},hP.rectangles,bX.foldBack(function(hT,hU){return ck.map(function(hV){return hT.apply1d(hV[0],hV[1]);},hU);},hP.points,(hQ=hP.core,hQ==null?hO:(hR=hQ.$0,ck.map(function(hT){return hR.apply1d(hT[0],hT[1]);},hO))))))):be.FailWith("Received more than one spatial initial condition for species _"):ck.map(function(hT){return hT[1];},hO);};cH.inline_parameters=function(hI){var hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS;function hT(h0){var h1;function h2(h3){var h4;h4=hI.populations.tryFind_index(h3);return h4==null?(function(h5){return function(h6){return h5("Could not locate species "+cA.toSafe(h6));};}(be.FailWith))(h3.name):h4.$0;}h1=function(h3){return es.map(h2,h3);};return function(h3){return br.map(h1,h3);};}function hU(h0){return bq.eval_massaction(hJ,h0);}function hV(h0){return bq.eval_function(hJ,hK,h0);}function hW(h0){return h0.map(a.id,function(h1){return h1.get_key();});}function hX(h0){return h0.$==2?{$:1,$0:h0.$0}:h0.$==1?be.FailWith("Not implemented yet"):null;}function hY(h0){return co.findIndex(function(h1){return cw.Equals(h1,h0);},hN);}function hZ(h0){return bq.inline_keys(hJ,hK,h0);}hJ=cX.to_env(hI.settings.parameters);hK=bW.Map(function(h0,h1){return(hT(h0))(h1);},bq.inline_rates_env(hJ,hI.rateExpressions));hL=cH.reaction_term(hI.stoich,hI.powers,ck.map((hM=function(h0){return _1.map2(hU,hV,h0);},function(h0){return hW(hM(h0));}),hI.rates));hN=bX.distinct(bX.collect((hO=function(h0){return bX.choose(hX,h0);},function(h0){return hO(br.mentions(h0));}),hI.sim_settings.plots));hP=ck.ofList(bX.map((hQ=(hR=(hS=function(h0){return bq.map(hY,h0);},function(h0){return hZ(hS(h0));}),function(h0){return br.expand(hR,h0);}),function(h0){return br.simplify(hQ(h0));}),hI.sim_settings.plots));return[hL,cH.map_settings(hJ,bX.map(hI.species_index,hN),hI),hP];};cH.generate_initialconditions1d=function(hI,hJ,hK){var hL,hM,hN;hL=(hM=hJ.random,hM>0?function(hO){return hO*(1+hM*(hI.NextDouble()-0.5));}:a.id);hN=ck.map(function(hO){return ck.map(hL,hO.value);},hK);return ck.init(hJ.nx,function(hO){return ck.init(ck.length(hK),function(hP){return ck.get(ck.get(hN,hP),hO);});});};cH.accumulator_2d=function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU;function hV(hY,hZ){return hS.apply2d(hY,hZ);}function hW(hY){return hY[1];}function hX(hY){return hY[1];}hL=bX.partition(function(hY){return hY.spatial!=null;},bX.ofSeq(hK));hM=hL[0];hN=co.sumBy(function(hY){return hY.value;},hL[1]);hO=ck.init(hJ,function(hY){return ck.init(hJ,function(hZ){return[[hY/(hJ-1),hZ/(hJ-1)],hN];});});return hM.$==1?hM.$1.$==0?(hP=hM.$0.spatial.$0,(hQ=bX.foldBack(function(hY,hZ){function h0(h1,h2){return hY.apply2d(h1,h2);}return ck.map(function(h1){return ck.map(function(h2){return h0(h2[0],h2[1]);},h1);},hZ);},hP.rectangles,bX.foldBack(function(hY,hZ){function h0(h1,h2){return hY.apply2d(h1,h2);}return ck.map(function(h1){return ck.map(function(h2){return h0(h2[0],h2[1]);},h1);},hZ);},hP.points,(hR=hP.core,hR==null?hO:(hS=hR.$0,ck.map(function(hY){return ck.map(function(hZ){return hV(hZ[0],hZ[1]);},hY);},hO))))),ck.map((hT=(hU=cH.perturb(hI,hP.random),function(hY){return hU(hW(hY));}),function(hY){return ck.map(hT,hY);}),hQ))):be.FailWith("Received more than one spatial initial condition for species _"):ck.map(function(hY){return ck.map(hX,hY);},hO);};cH.generate_initialconditions2d=function(hI,hJ,hK){var hL,hM,hN;hL=(hM=hJ.random,hM>0?function(hO){return hO*(1+hM*(hI.NextDouble()-0.5));}:a.id);hN=ck.map(function(hO){return ck.map(function(hP){return ck.map(hL,hP);},hO.value);},hK);return ck.init(hJ.nx,function(hO){return ck.init(hJ.nx,function(hP){return ck.init(ck.length(hK),function(hQ){return ck.get(ck.get(ck.get(hN,hQ),hO),hP);});});});};cH.perturb=function(hI,hJ){return hJ>0?function(hK){return hK*(1+hJ*(hI.NextDouble()-0.5));}:a.id;};cH.create=function(hI,hJ,hK,hL,hM,hN,hO,hP,hQ){return cH.New(hI,function(hR){return hJ.find_index(hR);},hJ,hK,hL,dN.ofArray(hM),hN,hO,hP,hQ);};cH.map_settings=function(hI,hJ,hK){var hL,hM,hN,hO,hP;hL=hK.settings;hM=hK.populations.get_get_count();hN=ck.map(function(hQ){var hR;hR=bW.TryFind({$:0,$0:{$:2,$0:hQ.species}},bW.OfArray(ck.ofSeq(hL.diffusibles)));return hR==null?hL.default_diffusion:br["eval"](function(hS){return cY.find(hI,hS);},hR.$0);},hK.populations.index_to_species);hO=hL.xmax/(hL.nx-1);hP=hL.dt>0?hL.dt:0.2*hO*hO/ck.max(hN);return d9.New(hM,be.toInt(hC.ceil((hK.sim_settings["final"]-hK.sim_settings.initial)/hP/hK.sim_settings.points)),hL.nx,0,hL.xmax,0,hL.xmax,hK.sim_settings["final"],hP,hN,ck.ofList(hJ));};cH.reaction_term=function(hI,hJ,hK){var hL,hM,hN,hO,hP;function hQ(hS,hT){return hT===1?hS:hT===2?hS*hS:hC.pow(hS,hT);}function hR(hS,hT){var hV,hW,hX;function hU(hY){return hY.$==1?hS:ck.get(hT,hY.$0);}for(hV=0,hW=hK.length-1;hV<=hW;hV++){hL[hV]=(hX=ck.get(hK,hV),hX.$==1?hX.$0(hU):ck.fold2(function(hY,hZ,h0){return hY*hQ(ck.get(hT,hZ),h0);},hX.$0,ck.get(hO,hV),ck.get(hP,hV)));}dN.matrMultVecStore(hI,hL,hM);return hM;}hL=dK.ofArray(new a.Float64Array(hK.length));hM=new a.Float64Array(dN.numRows(hI));hN=ck.map(ck.ofList,hJ);hO=ck.map(function(hS){return ck.map(function(hT){return hT[0];},hS);},hN);hP=ck.map(function(hS){return ck.map(function(hT){return hT[1];},hS);},hN);return function(hS){return function(hT){return hR(hS,hT);};};};cH.New=function(hI,hJ,hK,hL,hM,hN,hO,hP,hQ,hR){return{name:hI,species_index:hJ,populations:hK,sim_settings:hL,settings:hM,stoich:hN,powers:hO,rates:hP,rateExpressions:hQ,rng:hR};};br.to_string=function(hI,hJ){var hK,hL;function hM(hN){return br.to_string(hI,hN);}return hJ.$==1?a.String(hJ.$0):hJ.$==3?"("+hM(hJ.$0.div1)+" / "+hM(hJ.$0.div2)+")":hJ.$==4?"("+hM(hJ.$0.base_)+" ^ "+hM(hJ.$0.exponent)+")":hJ.$==2?(hK=hJ.$0,hK.get_Length()===1?"prod("+hM(bX.head(hK))+")":br.bracket(bX.reduce(function(hN,hO){return hN+" * "+hO;},bX.map(hM,hK)))):hJ.$==5?(hL=hJ.$0,hL.get_Length()===1?"sum("+hM(bX.head(hL))+")":br.bracket(bX.reduce(function(hN,hO){return hN+" + "+hO;},bX.map(hM,hL)))):hJ.$==6?"("+hM(hJ.$0.sub1)+" - "+hM(hJ.$0.sub2)+")":hJ.$==7?"|"+hM(hJ.$0)+"|":hJ.$==8?"log("+hM(hJ.$0)+")":hJ.$==9?hM(hJ.$0.div)+" % "+hM(hJ.$0.modulo):hJ.$==10?"ceiling("+hM(hJ.$0)+")":hJ.$==11?"floor("+hM(hJ.$0)+")":hJ.$==12?"round("+hM(hJ.$0)+")":hJ.$==13?"if "+br.to_string_bool(hI,hJ.$0)+" then "+hM(hJ.$1)+" else "+hM(hJ.$2):hI(hJ.$0);};br.expand=function(hI,hJ){function hK(hL){return br.expand(hI,hL);}return hJ.$==1?{$:1,$0:hJ.$0}:hJ.$==2?{$:2,$0:bX.map(hK,hJ.$0)}:hJ.$==3?{$:3,$0:bw.New(hK(hJ.$0.div1),hK(hJ.$0.div2))}:hJ.$==4?{$:4,$0:bv.New(hK(hJ.$0.base_),hK(hJ.$0.exponent))}:hJ.$==5?{$:5,$0:bX.map(hK,hJ.$0)}:hJ.$==6?{$:6,$0:bu.New(hK(hJ.$0.sub1),hK(hJ.$0.sub2))}:hJ.$==7?{$:7,$0:hK(hJ.$0)}:hJ.$==8?{$:8,$0:hK(hJ.$0)}:hJ.$==9?{$:9,$0:bt.New(hK(hJ.$0.div),hK(hJ.$0.modulo))}:hJ.$==10?{$:10,$0:hK(hJ.$0)}:hJ.$==11?{$:11,$0:hK(hJ.$0)}:hJ.$==12?{$:12,$0:hK(hJ.$0)}:hJ.$==13?{$:13,$0:br.expandBool(hI,hJ.$0),$1:hK(hJ.$1),$2:hK(hJ.$2)}:hI(hJ.$0);};br["eval"]=function(hI,hJ){function hK(hL){return br["eval"](hI,hL);}return hJ.$==1?hJ.$0:hJ.$==2?co.fold(function(hL,hM){return hL*hK(hM);},1,hJ.$0):hJ.$==3?hK(hJ.$0.div1)/hK(hJ.$0.div2):hJ.$==4?hC.pow(hK(hJ.$0.base_),hK(hJ.$0.exponent)):hJ.$==5?co.fold(function(hL,hM){return hL+hK(hM);},0,hJ.$0):hJ.$==6?hK(hJ.$0.sub1)-hK(hJ.$0.sub2):hJ.$==7?hC.abs(hK(hJ.$0)):hJ.$==8?hC.log(hK(hJ.$0)):hJ.$==9?br.moduloFloat(hK(hJ.$0.div),hK(hJ.$0.modulo)):hJ.$==10?hC.ceil(hK(hJ.$0)):hJ.$==11?hC.floor(hK(hJ.$0)):hJ.$==12?hC.round(hK(hJ.$0)):hJ.$==13?br.evalBool(hI,hJ.$0)?hK(hJ.$1):hK(hJ.$2):hI(hJ.$0);};br.map=function(hI,hJ){return hJ.$==1?{$:1,$0:hJ.$0}:hJ.$==2?{$:2,$0:bX.map(function(hK){return br.map(hI,hK);},hJ.$0)}:hJ.$==3?{$:3,$0:bw.New(br.map(hI,hJ.$0.div1),br.map(hI,hJ.$0.div2))}:hJ.$==4?{$:4,$0:bv.New(br.map(hI,hJ.$0.base_),br.map(hI,hJ.$0.exponent))}:hJ.$==5?{$:5,$0:bX.map(function(hK){return br.map(hI,hK);},hJ.$0)}:hJ.$==6?{$:6,$0:bu.New(br.map(hI,hJ.$0.sub1),br.map(hI,hJ.$0.sub2))}:hJ.$==7?{$:7,$0:br.map(hI,hJ.$0)}:hJ.$==8?{$:8,$0:br.map(hI,hJ.$0)}:hJ.$==9?{$:9,$0:bt.New(br.map(hI,hJ.$0.div),br.map(hI,hJ.$0.modulo))}:hJ.$==10?{$:10,$0:br.map(hI,hJ.$0)}:hJ.$==11?{$:11,$0:br.map(hI,hJ.$0)}:hJ.$==12?{$:12,$0:br.map(hI,hJ.$0)}:hJ.$==13?{$:13,$0:br.mapBool(hI,hJ.$0),$1:br.map(hI,hJ.$1),$2:br.map(hI,hJ.$2)}:{$:0,$0:hI(hJ.$0)};};br.from_string=function(hI,hJ){return cR.from_string(br.parse(hI),hJ);};br.to_lambda=function(hI){return new dM({$:0,$0:br.to_lambda_inner(hI)});};br.simplify=function(hI){var hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0,h1,h2,h3,h4,h5,h6,h7,h8,h9,h_,h$;switch(hI.$==1?1:hI.$==2?(hJ=hI.$0,2):hI.$==3?(hJ=[hI,hI.$0.div1,hI.$0.div2],3):hI.$==4?(hJ=[hI.$0.base_,hI.$0.exponent],4):hI.$==5?hI.$0.$==1?hI.$0.$1.$==0?(hJ=hI.$0.$0,5):(hJ=hI.$0,6):(hJ=hI.$0,6):hI.$==6?(hJ=[hI.$0.sub1,hI.$0.sub2],7):hI.$==7?(hJ=hI.$0,8):hI.$==8?(hJ=hI.$0,9):hI.$==9?(hJ=[hI.$0.div,hI.$0.modulo],10):hI.$==10?(hJ=hI.$0,11):hI.$==11?(hJ=hI.$0,12):hI.$==12?(hJ=hI.$0,13):hI.$==13?(hJ=[hI.$0,hI.$1,hI.$2],14):0){case 0:return hI;case 1:return hI;case 2:if(hJ.$==1&&(hJ.$1.$==0&&(hL=hJ.$0,true)))hK=br.simplify(hL);else if(bX.exists(function(ia){return cw.Equals(ia,{$:1,$0:0});},hJ))hK={$:1,$0:0};else{hO=bX.filter((hM={$:1,$0:1},function(ia){return!cw.Equals(hM,ia);}),hJ);hP=bX.collect(function(ia){return ia.$==2?ia.$0:bX.ofArray([ia]);},hO);hQ=br.split_floats(bX.map(br.simplify,hP));switch(hQ[0].$==0?hQ[1].$==0?0:(hN=[hQ[1],hQ[0]],2):hQ[1].$==0?1:(hN=[hQ[1],hQ[0]],2)){case 0:hK={$:1,$0:1};break;case 1:hK={$:1,$0:co.fold(function(ia,ib){return ia*ib;},1,hQ[0])};break;case 2:hK=(hR=hN[0],hS={$:1,$0:co.fold(function(ia,ib){return ia*ib;},1,hN[1])},cw.Equals(hS,{$:1,$0:0})?hS:cw.Equals(hS,{$:1,$0:1})?{$:2,$0:hR}:{$:2,$0:new bY({$:1,$0:hS,$1:hR})});break;}}return hK;case 3:hT=br.simplify(hJ[1]);hU=br.simplify(hJ[2]);return cw.Equals(hT,{$:1,$0:0})?hT:br.div(hT,hU);case 4:hV=br.simplify(hJ[0]);hW=br.simplify(hJ[1]);return cw.Equals(hV,{$:1,$0:0})?hV:br.power$1(hV,hW);case 5:return br.simplify(hJ);case 6:hZ=br.split_floats(bX.map(br.simplify,hJ));switch(hZ[0].$==0?hZ[1].$==0?0:(hY=[hZ[1],hZ[0]],2):hZ[1].$==0?1:(hY=[hZ[1],hZ[0]],2)){case 0:hX={$:1,$0:0};break;case 1:hX={$:1,$0:co.sum(hZ[0])};break;case 2:hX=(h0={$:1,$0:co.sum(hY[1])},h1=br.simpleFactoring(bX.collect(function(ia){return ia.$==5?ia.$0:bX.ofArray([ia]);},hY[0])),cw.Equals(h0,{$:1,$0:0})?h1.get_Length()===1?bX.head(h1):{$:5,$0:h1}:{$:5,$0:new bY({$:1,$0:h0,$1:h1})});break;}return hX;case 7:h2=br.simplify(hJ[0]);h3=br.simplify(hJ[1]);return cw.Equals(h2,h3)?{$:1,$0:0}:br.sub(h2,h3);case 8:h6=br.simplify(hJ);switch(h6.$==1?h6.$0===0?0:(h5=h6,2):h6.$==6?h6.$0.sub1.$==1?h6.$0.sub1.$0===0?(h5=h6.$0.sub2,1):(h5=h6,2):(h5=h6,2):(h5=h6,2)){case 0:h4={$:1,$0:0};break;case 1:h4={$:7,$0:h5};break;case 2:h4={$:7,$0:h5};break;}return h4;case 9:return{$:8,$0:br.simplify(hJ)};case 10:h7=br.simplify(hJ[0]);h8=br.simplify(hJ[1]);return cw.Equals(h8,{$:1,$0:1})||cw.Equals(h7,{$:1,$0:0})?{$:1,$0:0}:{$:9,$0:bt.New(h7,h8)};case 11:return{$:10,$0:br.simplify(hJ)};case 12:return{$:11,$0:br.simplify(hJ)};case 13:return{$:12,$0:br.simplify(hJ)};case 14:h9=hJ[1];h_=hJ[2];h$=br.simplifyBool(hJ[0]);return h$.$==0?br.simplify(h9):h$.$==1?br.simplify(h_):{$:13,$0:h$,$1:br.simplify(h9),$2:br.simplify(h_)};}};br.is_not_empty=function(hI){return!cw.Equals(br.simplify(hI),{$:1,$0:0});};br.mentions=function(hI){function hJ(hL,hM){var hN;switch(hM.$==1?1:hM.$==2?2:hM.$==3?3:hM.$==4?4:hM.$==5?5:hM.$==6?6:hM.$==7?(hN=hM.$0,7):hM.$==8?(hN=hM.$0,7):hM.$==9?8:hM.$==10?(hN=hM.$0,9):hM.$==11?(hN=hM.$0,9):hM.$==12?(hN=hM.$0,9):hM.$==13?10:0){case 0:return new bY({$:1,$0:hM.$0,$1:hL});case 1:return hL;case 2:return co.fold(hJ,hL,hM.$0);case 3:return hJ(hJ(hL,hM.$0.div1),hM.$0.div2);case 4:return hJ(hJ(hL,hM.$0.base_),hM.$0.exponent);case 5:return co.fold(hJ,hL,hM.$0);case 6:return hJ(hJ(hL,hM.$0.sub1),hM.$0.sub2);case 7:return hJ(hL,hN);case 8:return hJ(hJ(hL,hM.$0.div),hM.$0.modulo);case 9:return hJ(hL,hN);case 10:return hJ(hJ(hK(hL,hM.$0),hM.$1),hM.$2);}}function hK(hL,hM){return hM.$==1?hL:hM.$==2?hJ(hJ(hL,hM.$0),hM.$1):hM.$==3?hJ(hJ(hL,hM.$0),hM.$1):hM.$==4?hJ(hJ(hL,hM.$0),hM.$1):hM.$==5?hJ(hJ(hL,hM.$0),hM.$1):hM.$==6?hJ(hJ(hL,hM.$0),hM.$1):hM.$==7?hK(hL,hM.$0):hM.$==8?hK(hK(hL,hM.$0),hM.$1):hM.$==9?hK(hK(hL,hM.$0),hM.$1):hL;}return bX.rev(hJ(bY.Empty,hI));};br.bracket=function(hI){return hI===""?"":"("+hI+")";};br.to_string_bool=function(hI,hJ){function hK(hM){return br.to_string(hI,hM);}function hL(hM){return br.to_string_bool(hI,hM);}return hJ.$==1?"false":hJ.$==2?hK(hJ.$0)+" < "+hK(hJ.$1):hJ.$==3?hK(hJ.$0)+" <= "+hK(hJ.$1):hJ.$==4?hK(hJ.$0)+" = "+hK(hJ.$1):hJ.$==5?hK(hJ.$0)+" >= "+hK(hJ.$1):hJ.$==6?hK(hJ.$0)+" >= "+hK(hJ.$1):hJ.$==7?"not "+hL(hJ.$0):hJ.$==8?hL(hJ.$0)+" && "+hL(hJ.$1):hJ.$==9?hL(hJ.$0)+" || "+hL(hJ.$1):"true";};br.collect=function(hI){function hJ(hL,hM){function hN(hO,hP){return new bY({$:1,$0:hO,$1:hP});}return hM.$==0?bX.ofArray([hL]):bX.map(function(hO){return hN(hO[0],hO[1]);},br.cartesianProd(hL,hM));}function hK(hL){function hM(hO){return hO.$==0;}function hN(hO){return!hO;}return bX.foldBack(hJ,bX.filter(function(hO){return hN(hM(hO));},bX.map(br.collect(hI),hL)),bY.Empty);}return function(hL){return hL.$==1?bX.ofArray([{$:1,$0:hL.$0}]):hL.$==2?bX.map(function(hM){return{$:2,$0:hM};},hK(hL.$0)):hL.$==5?bX.map(function(hM){return{$:5,$0:hM};},hK(hL.$0)):hL.$==3?bX.map(function(hM){return{$:3,$0:bw.New(hM[0],hM[1])};},br.cartesianProd((br.collect(hI))(hL.$0.div1),(br.collect(hI))(hL.$0.div2))):hL.$==4?bX.map(function(hM){return{$:4,$0:bv.New(hM[0],hM[1])};},br.cartesianProd((br.collect(hI))(hL.$0.base_),(br.collect(hI))(hL.$0.exponent))):hL.$==6?bX.map(function(hM){return{$:6,$0:bu.New(hM[0],hM[1])};},br.cartesianProd((br.collect(hI))(hL.$0.sub1),(br.collect(hI))(hL.$0.sub2))):hL.$==7?bX.map(function(hM){return{$:7,$0:hM};},(br.collect(hI))(hL.$0)):hL.$==8?bX.map(function(hM){return{$:8,$0:hM};},(br.collect(hI))(hL.$0)):hL.$==9?bX.map(function(hM){return{$:9,$0:bt.New(hM[0],hM[1])};},br.cartesianProd((br.collect(hI))(hL.$0.div),(br.collect(hI))(hL.$0.modulo))):hL.$==10?bX.map(function(hM){return{$:10,$0:hM};},(br.collect(hI))(hL.$0)):hL.$==11?bX.map(function(hM){return{$:11,$0:hM};},(br.collect(hI))(hL.$0)):hL.$==12?bX.map(function(hM){return{$:12,$0:hM};},(br.collect(hI))(hL.$0)):hL.$==13?bX.map(function(hM){var hN;hN=hM[1];return{$:13,$0:hM[0],$1:hN[0],$2:hN[1]};},br.cartesianProd(br.collectBool(hI,hL.$0),br.cartesianProd((br.collect(hI))(hL.$1),(br.collect(hI))(hL.$2)))):bX.map(function(hM){return{$:0,$0:hM};},hI(hL.$0));};};br.to_string_plot=function(hI,hJ){return hJ.$==0?hI(hJ.$0):br.to_string(function(hK){return"["+hI(hK)+"]";},hJ);};br.expandBool=function(hI,hJ){function hK(hM){return br.expandBool(hI,hM);}function hL(hM){return br.expand(hI,hM);}return hJ.$==1?bs.BFalse:hJ.$==2?{$:2,$0:hL(hJ.$0),$1:hL(hJ.$1)}:hJ.$==3?{$:3,$0:hL(hJ.$0),$1:hL(hJ.$1)}:hJ.$==4?{$:4,$0:hL(hJ.$0),$1:hL(hJ.$1)}:hJ.$==5?{$:5,$0:hL(hJ.$0),$1:hL(hJ.$1)}:hJ.$==6?{$:6,$0:hL(hJ.$0),$1:hL(hJ.$1)}:hJ.$==7?{$:7,$0:hK(hJ.$0)}:hJ.$==8?{$:8,$0:hK(hJ.$0),$1:hK(hJ.$1)}:hJ.$==9?{$:9,$0:hK(hJ.$0),$1:hK(hJ.$1)}:bs.BTrue;};br.moduloFloat=function(hI,hJ){return(hI%hJ+hJ)%hJ;};br.evalBool=function(hI,hJ){function hK(hM){return br["eval"](hI,hM);}function hL(hM){return br.evalBool(hI,hM);}return hJ.$==1?false:hJ.$==2?hK(hJ.$0)<hK(hJ.$1):hJ.$==3?hK(hJ.$0)<=hK(hJ.$1):hJ.$==4?hK(hJ.$0)===hK(hJ.$1):hJ.$==5?hK(hJ.$0)>=hK(hJ.$1):hJ.$==6?hK(hJ.$0)>hK(hJ.$1):hJ.$==7?!hL(hJ.$0):hJ.$==8?hL(hJ.$0)&&hL(hJ.$1):hJ.$==9?hL(hJ.$0)||hL(hJ.$1):true;};br.mapBool=function(hI,hJ){function hK(hM){return br.mapBool(hI,hM);}function hL(hM){return br.map(hI,hM);}return hJ.$==1?bs.BFalse:hJ.$==2?{$:2,$0:hL(hJ.$0),$1:hL(hJ.$1)}:hJ.$==3?{$:3,$0:hL(hJ.$0),$1:hL(hJ.$1)}:hJ.$==4?{$:4,$0:hL(hJ.$0),$1:hL(hJ.$1)}:hJ.$==5?{$:5,$0:hL(hJ.$0),$1:hL(hJ.$1)}:hJ.$==6?{$:6,$0:hL(hJ.$0),$1:hL(hJ.$1)}:hJ.$==7?{$:7,$0:hK(hJ.$0)}:hJ.$==8?{$:8,$0:hK(hJ.$0),$1:hK(hJ.$1)}:hJ.$==9?{$:9,$0:hK(hJ.$0),$1:hK(hJ.$1)}:bs.BTrue;};br.parse=function(hI){function hJ(hK){return{$:0,$0:hK};}return br.exp(function(hK){return br.op_BarGreaterGreater(hI,hJ,hK[0],hK[1]);});};br.mul=function(hI,hJ){var hK;switch(hI.$==1?hI.$0===0?(hK=hJ,0):hI.$0===1?hJ.$==1?hJ.$0===0?(hK=hI,0):hJ.$0===1?(hK=hJ,1):(hK=hJ,1):hJ.$==2?(hK=hJ,1):(hK=hJ,1):hJ.$==1?hJ.$0===0?(hK=hI,0):hJ.$0===1?(hK=hI,1):(hK=[hI.$0,hJ.$0],2):hJ.$==2?hJ.$0.$==1?hJ.$0.$0.$==1?(hK=[hI.$0,hJ.$0.$0.$0,hJ.$0.$1],3):(hK=[hI,hJ.$0],4):(hK=[hI,hJ.$0],4):5:hI.$==2?hJ.$==1?hJ.$0===0?(hK=hI,0):hJ.$0===1?(hK=hI,1):hI.$0.$==1?hI.$0.$0.$==1?(hK=[hI.$0.$0.$0,hJ.$0,hI.$0.$1],3):(hK=[hJ,hI.$0],4):(hK=[hJ,hI.$0],4):hJ.$==2?(hK=[hJ,hI.$0],4):(hK=[hJ,hI.$0],4):hJ.$==1?hJ.$0===0?(hK=hI,0):hJ.$0===1?(hK=hI,1):5:hJ.$==2?(hK=[hI,hJ.$0],4):5){case 0:return{$:1,$0:0};case 1:return hK;case 2:return{$:1,$0:hK[0]*hK[1]};case 3:return{$:2,$0:new bY({$:1,$0:{$:1,$0:hK[0]*hK[1]},$1:hK[2]})};case 4:return{$:2,$0:new bY({$:1,$0:hK[0],$1:hK[1]})};case 5:return{$:2,$0:bX.ofArray([hI,hJ])};}};br.to_lambda_inner=function(hI){var hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0,h1,h2,h3,h4,h5;switch(hI.$==1?(hJ=hI.$0,1):hI.$==2?hI.$0.$==1?hI.$0.$1.$==1?hI.$0.$1.$1.$==0?(hJ=[hI.$0.$0,hI.$0.$1.$0],2):(hJ=hI.$0,3):(hJ=hI.$0,3):(hJ=hI.$0,3):hI.$==3?(hJ=[hI.$0.div1,hI.$0.div2],4):hI.$==4?(hJ=[hI.$0.base_,hI.$0.exponent],5):hI.$==5?hI.$0.$==1?hI.$0.$1.$==1?hI.$0.$1.$1.$==0?(hJ=[hI.$0.$0,hI.$0.$1.$0],6):(hJ=hI.$0,7):(hJ=hI.$0,7):(hJ=hI.$0,7):hI.$==6?(hJ=[hI.$0.sub1,hI.$0.sub2],8):hI.$==7?(hJ=hI.$0,9):hI.$==8?(hJ=hI.$0,10):hI.$==9?(hJ=[hI.$0.div,hI.$0.modulo],11):hI.$==10?(hJ=hI.$0,12):hI.$==11?(hJ=hI.$0,13):hI.$==12?(hJ=hI.$0,14):hI.$==13?(hJ=[hI.$0,hI.$1,hI.$2],15):(hJ=hI.$0,0)){case 0:return function(h6){return h6(hJ);};case 1:return function(){return hJ;};case 2:hK=br.to_lambda_inner(hJ[0]);hL=br.to_lambda_inner(hJ[1]);return function(h6){return hK(h6)*hL(h6);};case 3:hM=bX.map(br.to_lambda_inner,hJ);return function(h6){var h7,h8;h7=1;h8=df.Get(hM);try{while(h8.MoveNext())h7=h7*(h8.Current())(h6);}finally{if(typeof h8=="object"&&"Dispose"in h8)h8.Dispose();}return h7;};case 4:hN=br.to_lambda_inner(hJ[0]);hO=br.to_lambda_inner(hJ[1]);return function(h6){return hN(h6)/hO(h6);};case 5:hP=br.to_lambda_inner(hJ[0]);hQ=br.to_lambda_inner(hJ[1]);return function(h6){return hC.pow(hP(h6),hQ(h6));};case 6:hR=br.to_lambda_inner(hJ[0]);hS=br.to_lambda_inner(hJ[1]);return function(h6){return hR(h6)+hS(h6);};case 7:hT=bX.map(br.to_lambda_inner,hJ);return function(h6){var h7,h8;h7=0;h8=df.Get(hT);try{while(h8.MoveNext())h7=h7+(h8.Current())(h6);}finally{if(typeof h8=="object"&&"Dispose"in h8)h8.Dispose();}return h7;};case 8:hU=br.to_lambda_inner(hJ[0]);hV=br.to_lambda_inner(hJ[1]);return function(h6){return hU(h6)-hV(h6);};case 9:hW=br.to_lambda_inner(hJ);return function(h6){return hC.abs(hW(h6));};case 10:hX=br.to_lambda_inner(hJ);return function(h6){return hC.log(hX(h6));};case 11:hY=br.to_lambda_inner(hJ[0]);hZ=br.to_lambda_inner(hJ[1]);return function(h6){return br.moduloFloat(hY(h6),hZ(h6));};case 12:h0=br.to_lambda_inner(hJ);return function(h6){return hC.ceil(h0(h6));};case 13:h1=br.to_lambda_inner(hJ);return function(h6){return hC.floor(h1(h6));};case 14:h2=br.to_lambda_inner(hJ);return function(h6){return hC.round(h2(h6));};case 15:h3=br.to_lambda_bool(hJ[0]);h4=br.to_lambda_inner(hJ[1]);h5=br.to_lambda_inner(hJ[2]);return function(h6){return h3(h6)?h4(h6):h5(h6);};}};br.split_floats=function(hI){var hJ,hK,hL,hM,hN,hO,hP;hJ=bY.Empty;hK=bY.Empty;hL=hI;while(true)if(hL.$==1){if(hL.$0.$==1){hM=hL.$1;hN=hL.$0.$0;hJ=new bY({$:1,$0:hN,$1:hJ});hL=hM;}else{hO=hL.$0;hP=hL.$1;hK=new bY({$:1,$0:hO,$1:hK});hL=hP;}}else return[bX.rev(hJ),bX.rev(hK)];};br.div=function(hI,hJ){var hK;switch(hJ.$==1?hJ.$0===0?(hK=hI,0):hJ.$0===1?hI.$==1?hI.$0===0?(hK=hJ,1):(hK=hI,2):(hK=hI,2):hI.$==1?hI.$0===0?(hK=hJ,1):(hK=[hI.$0,hJ.$0],3):4:hI.$==1?hI.$0===0?(hK=hJ,1):4:4){case 0:return be.FailWith("Division by 0");case 1:return{$:1,$0:0};case 2:return hK;case 3:return{$:1,$0:hK[0]/hK[1]};case 4:return{$:3,$0:bw.New(hI,hJ)};}};br.power$1=function(hI,hJ){var hK;switch(hJ.$==1?hJ.$0===0?(hK=hI,0):hJ.$0===1?hI.$==1?hI.$0===1?1:(hK=hI,2):(hK=hI,2):hI.$==1?hI.$0===1?1:(hK=[hI.$0,hJ.$0],3):4:hI.$==1?hI.$0===1?1:4:4){case 0:return{$:1,$0:1};case 1:return{$:1,$0:1};case 2:return hK;case 3:return{$:1,$0:hC.pow(hK[0],hK[1])};case 4:return{$:4,$0:bv.New(hI,hJ)};}};br.simpleFactoring=function(hI){var hJ,hK,hL,hM;return hI.$==1?(hJ=hI.$1,(hK=hI.$0,br.isFactor(hK)?(hL=(br.splitFactor(hK))[1],(hM=bX.partition(function(hN){return br.isFactor(hN)&&cw.Equals((br.splitFactor(hN))[1],hL);},hJ),new bY({$:1,$0:co.fold(br.addFactors,hK,hM[0]),$1:br.simpleFactoring(hM[1])}))):new bY({$:1,$0:hK,$1:br.simpleFactoring(hJ)}))):bY.Empty;};br.sub=function(hI,hJ){var hK;switch(hJ.$==1?hJ.$0===0?(hK=hI,0):hI.$==1?(hK=[hI.$0,hJ.$0],1):2:2){case 0:return hK;case 1:return{$:1,$0:hK[0]-hK[1]};case 2:return{$:6,$0:bu.New(hI,hJ)};}};br.simplifyBool=function(hI){var hJ;function hK(hN){return hN?bs.BTrue:bs.BFalse;}function hL(hN,hO,hP,hQ){var hR,hS,hT;hR=br.simplify(hN);hS=br.simplify(hO);return(hR.$==1?hS.$==1?(hT=[hR.$0,hS.$0],true):(hT=[hR,hS],false):(hT=[hR,hS],false))?hK((hP(hT[0]))(hT[1])):hQ([hT[0],hT[1]]);}function hM(hN,hO,hP,hQ){var hR,hS,hT;hS=br.simplifyBool(hN);hT=br.simplifyBool(hO);switch(hS.$==0?hT.$==0?0:hT.$==1?1:(hR=[hS,hT],4):hS.$==1?hT.$==0?2:hT.$==1?3:(hR=[hS,hT],4):(hR=[hS,hT],4)){case 0:return hK((hP(true))(true));case 1:return hK((hP(true))(false));case 2:return hK((hP(false))(true));case 3:return hK((hP(false))(false));case 4:return hQ([hR[0],hR[1]]);}}return hI.$==1?bs.BFalse:hI.$==2?hL(hI.$0,hI.$1,function(hN){return function(hO){return hN<hO;};},function(hN){return{$:2,$0:hN[0],$1:hN[1]};}):hI.$==3?hL(hI.$0,hI.$1,function(hN){return function(hO){return hN<=hO;};},function(hN){return{$:3,$0:hN[0],$1:hN[1]};}):hI.$==4?hL(hI.$0,hI.$1,function(hN){return function(hO){return hN===hO;};},function(hN){return{$:4,$0:hN[0],$1:hN[1]};}):hI.$==5?hL(hI.$0,hI.$1,function(hN){return function(hO){return hN>=hO;};},function(hN){return{$:5,$0:hN[0],$1:hN[1]};}):hI.$==6?hL(hI.$0,hI.$1,function(hN){return function(hO){return hN>hO;};},function(hN){return{$:6,$0:hN[0],$1:hN[1]};}):hI.$==7?(hJ=br.simplifyBool(hI.$0),hJ.$==0?bs.BFalse:hJ.$==1?bs.BTrue:{$:7,$0:hJ}):hI.$==8?hM(hI.$0,hI.$1,function(hN){return function(hO){return hN&&hO;};},function(hN){return{$:8,$0:hN[0],$1:hN[1]};}):hI.$==9?hM(hI.$0,hI.$1,function(hN){return function(hO){return hN||hO;};},function(hN){return{$:9,$0:hN[0],$1:hN[1]};}):bs.BTrue;};br.add=function(hI,hJ){var hK,hL;switch(hI.$==1?hI.$0===0?(hK=hJ,0):hJ.$==1?hJ.$0===0?(hK=hI,0):(hK=[hI.$0,hJ.$0],1):hJ.$==5?hJ.$0.$==1?hJ.$0.$0.$==1?(hK=[hI.$0,hJ.$0.$0.$0,hJ.$0.$1],2):(hK=[hI,hJ.$0],3):(hK=[hI,hJ.$0],3):hJ.$==2?hJ.$0.$==1?hJ.$0.$0.$==1?hJ.$0.$1.$==1?hJ.$0.$1.$1.$==0?cw.Equals(hI,hJ.$0.$1.$0)?(hK=[hJ.$0.$0.$0,hI,hJ.$0.$1.$0],4):hJ.$0.$1.$0.$==1?cw.Equals(hI,hJ.$0.$0)?(hK=[hJ.$0.$1.$0.$0,hI,hJ.$0.$0],4):5:5:5:5:hJ.$0.$1.$==1?hJ.$0.$1.$0.$==1?hJ.$0.$1.$1.$==0?cw.Equals(hI,hJ.$0.$0)?(hK=[hJ.$0.$1.$0.$0,hI,hJ.$0.$0],4):5:5:5:5:5:5:hI.$==5?hJ.$==1?hJ.$0===0?(hK=hI,0):hI.$0.$==1?hI.$0.$0.$==1?(hK=[hI.$0.$0.$0,hJ.$0,hI.$0.$1],2):(hK=[hJ,hI.$0],3):(hK=[hJ,hI.$0],3):hJ.$==5?(hK=[hJ,hI.$0],3):hJ.$==2?(hK=[hJ,hI.$0],3):(hK=[hJ,hI.$0],3):hI.$==2?hJ.$==1?hJ.$0===0?(hK=hI,0):hI.$0.$==1?hI.$0.$0.$==1?hI.$0.$1.$==1?hI.$0.$1.$1.$==0?cw.Equals(hI.$0.$1.$0,hJ)?(hK=[hI.$0.$0.$0,hI.$0.$1.$0,hJ],4):hI.$0.$1.$0.$==1?cw.Equals(hI.$0.$0,hJ)?(hK=[hI.$0.$1.$0.$0,hI.$0.$0,hJ],4):5:5:5:5:hI.$0.$1.$==1?hI.$0.$1.$0.$==1?hI.$0.$1.$1.$==0?cw.Equals(hI.$0.$0,hJ)?(hK=[hI.$0.$1.$0.$0,hI.$0.$0,hJ],4):5:5:5:5:5:hJ.$==5?(hK=[hI,hJ.$0],3):hJ.$==2?hI.$0.$==1?hI.$0.$0.$==1?hI.$0.$1.$==1?hI.$0.$1.$1.$==0?cw.Equals(hI.$0.$1.$0,hJ)?(hK=[hI.$0.$0.$0,hI.$0.$1.$0,hJ],4):hI.$0.$1.$0.$==1?cw.Equals(hI.$0.$0,hJ)?(hK=[hI.$0.$1.$0.$0,hI.$0.$0,hJ],4):hJ.$0.$==1?hJ.$0.$0.$==1?hJ.$0.$1.$==1?hJ.$0.$1.$1.$==0?cw.Equals(hI,hJ.$0.$1.$0)?(hK=[hJ.$0.$0.$0,hI,hJ.$0.$1.$0],4):hJ.$0.$1.$0.$==1?cw.Equals(hI,hJ.$0.$0)?(hK=[hJ.$0.$1.$0.$0,hI,hJ.$0.$0],4):5:5:5:5:hJ.$0.$1.$==1?hJ.$0.$1.$0.$==1?hJ.$0.$1.$1.$==0?cw.Equals(hI,hJ.$0.$0)?(hK=[hJ.$0.$1.$0.$0,hI,hJ.$0.$0],4):5:5:5:5:5:hJ.$0.$==1?hJ.$0.$0.$==1?hJ.$0.$1.$==1?hJ.$0.$1.$1.$==0?cw.Equals(hI,hJ.$0.$1.$0)?(hK=[hJ.$0.$0.$0,hI,hJ.$0.$1.$0],4):hJ.$0.$1.$0.$==1?cw.Equals(hI,hJ.$0.$0)?(hK=[hJ.$0.$1.$0.$0,hI,hJ.$0.$0],4):5:5:5:5:hJ.$0.$1.$==1?hJ.$0.$1.$0.$==1?hJ.$0.$1.$1.$==0?cw.Equals(hI,hJ.$0.$0)?(hK=[hJ.$0.$1.$0.$0,hI,hJ.$0.$0],4):5:5:5:5:5:hJ.$0.$==1?hJ.$0.$0.$==1?hJ.$0.$1.$==1?hJ.$0.$1.$1.$==0?cw.Equals(hI,hJ.$0.$1.$0)?(hK=[hJ.$0.$0.$0,hI,hJ.$0.$1.$0],4):hJ.$0.$1.$0.$==1?cw.Equals(hI,hJ.$0.$0)?(hK=[hJ.$0.$1.$0.$0,hI,hJ.$0.$0],4):5:5:5:5:hJ.$0.$1.$==1?hJ.$0.$1.$0.$==1?hJ.$0.$1.$1.$==0?cw.Equals(hI,hJ.$0.$0)?(hK=[hJ.$0.$1.$0.$0,hI,hJ.$0.$0],4):5:5:5:5:5:hJ.$0.$==1?hJ.$0.$0.$==1?hJ.$0.$1.$==1?hJ.$0.$1.$1.$==0?cw.Equals(hI,hJ.$0.$1.$0)?(hK=[hJ.$0.$0.$0,hI,hJ.$0.$1.$0],4):hJ.$0.$1.$0.$==1?cw.Equals(hI,hJ.$0.$0)?(hK=[hJ.$0.$1.$0.$0,hI,hJ.$0.$0],4):5:5:5:5:hJ.$0.$1.$==1?hJ.$0.$1.$0.$==1?hJ.$0.$1.$1.$==0?cw.Equals(hI,hJ.$0.$0)?(hK=[hJ.$0.$1.$0.$0,hI,hJ.$0.$0],4):5:5:5:5:5:hI.$0.$1.$==1?hI.$0.$1.$0.$==1?hI.$0.$1.$1.$==0?cw.Equals(hI.$0.$0,hJ)?(hK=[hI.$0.$1.$0.$0,hI.$0.$0,hJ],4):hJ.$0.$==1?hJ.$0.$0.$==1?hJ.$0.$1.$==1?hJ.$0.$1.$1.$==0?cw.Equals(hI,hJ.$0.$1.$0)?(hK=[hJ.$0.$0.$0,hI,hJ.$0.$1.$0],4):hJ.$0.$1.$0.$==1?cw.Equals(hI,hJ.$0.$0)?(hK=[hJ.$0.$1.$0.$0,hI,hJ.$0.$0],4):5:5:5:5:hJ.$0.$1.$==1?hJ.$0.$1.$0.$==1?hJ.$0.$1.$1.$==0?cw.Equals(hI,hJ.$0.$0)?(hK=[hJ.$0.$1.$0.$0,hI,hJ.$0.$0],4):5:5:5:5:5:hJ.$0.$==1?hJ.$0.$0.$==1?hJ.$0.$1.$==1?hJ.$0.$1.$1.$==0?cw.Equals(hI,hJ.$0.$1.$0)?(hK=[hJ.$0.$0.$0,hI,hJ.$0.$1.$0],4):hJ.$0.$1.$0.$==1?cw.Equals(hI,hJ.$0.$0)?(hK=[hJ.$0.$1.$0.$0,hI,hJ.$0.$0],4):5:5:5:5:hJ.$0.$1.$==1?hJ.$0.$1.$0.$==1?hJ.$0.$1.$1.$==0?cw.Equals(hI,hJ.$0.$0)?(hK=[hJ.$0.$1.$0.$0,hI,hJ.$0.$0],4):5:5:5:5:5:hJ.$0.$==1?hJ.$0.$0.$==1?hJ.$0.$1.$==1?hJ.$0.$1.$1.$==0?cw.Equals(hI,hJ.$0.$1.$0)?(hK=[hJ.$0.$0.$0,hI,hJ.$0.$1.$0],4):hJ.$0.$1.$0.$==1?cw.Equals(hI,hJ.$0.$0)?(hK=[hJ.$0.$1.$0.$0,hI,hJ.$0.$0],4):5:5:5:5:hJ.$0.$1.$==1?hJ.$0.$1.$0.$==1?hJ.$0.$1.$1.$==0?cw.Equals(hI,hJ.$0.$0)?(hK=[hJ.$0.$1.$0.$0,hI,hJ.$0.$0],4):5:5:5:5:5:hJ.$0.$==1?hJ.$0.$0.$==1?hJ.$0.$1.$==1?hJ.$0.$1.$1.$==0?cw.Equals(hI,hJ.$0.$1.$0)?(hK=[hJ.$0.$0.$0,hI,hJ.$0.$1.$0],4):hJ.$0.$1.$0.$==1?cw.Equals(hI,hJ.$0.$0)?(hK=[hJ.$0.$1.$0.$0,hI,hJ.$0.$0],4):5:5:5:5:hJ.$0.$1.$==1?hJ.$0.$1.$0.$==1?hJ.$0.$1.$1.$==0?cw.Equals(hI,hJ.$0.$0)?(hK=[hJ.$0.$1.$0.$0,hI,hJ.$0.$0],4):5:5:5:5:5:hJ.$0.$==1?hJ.$0.$0.$==1?hJ.$0.$1.$==1?hJ.$0.$1.$1.$==0?cw.Equals(hI,hJ.$0.$1.$0)?(hK=[hJ.$0.$0.$0,hI,hJ.$0.$1.$0],4):hJ.$0.$1.$0.$==1?cw.Equals(hI,hJ.$0.$0)?(hK=[hJ.$0.$1.$0.$0,hI,hJ.$0.$0],4):5:5:5:5:hJ.$0.$1.$==1?hJ.$0.$1.$0.$==1?hJ.$0.$1.$1.$==0?cw.Equals(hI,hJ.$0.$0)?(hK=[hJ.$0.$1.$0.$0,hI,hJ.$0.$0],4):5:5:5:5:5:hI.$0.$==1?hI.$0.$0.$==1?hI.$0.$1.$==1?hI.$0.$1.$1.$==0?cw.Equals(hI.$0.$1.$0,hJ)?(hK=[hI.$0.$0.$0,hI.$0.$1.$0,hJ],4):hI.$0.$1.$0.$==1?cw.Equals(hI.$0.$0,hJ)?(hK=[hI.$0.$1.$0.$0,hI.$0.$0,hJ],4):5:5:5:5:hI.$0.$1.$==1?hI.$0.$1.$0.$==1?hI.$0.$1.$1.$==0?cw.Equals(hI.$0.$0,hJ)?(hK=[hI.$0.$1.$0.$0,hI.$0.$0,hJ],4):5:5:5:5:5:hJ.$==1?hJ.$0===0?(hK=hI,0):5:hJ.$==5?(hK=[hI,hJ.$0],3):hJ.$==2?hJ.$0.$==1?hJ.$0.$0.$==1?hJ.$0.$1.$==1?hJ.$0.$1.$1.$==0?cw.Equals(hI,hJ.$0.$1.$0)?(hK=[hJ.$0.$0.$0,hI,hJ.$0.$1.$0],4):hJ.$0.$1.$0.$==1?cw.Equals(hI,hJ.$0.$0)?(hK=[hJ.$0.$1.$0.$0,hI,hJ.$0.$0],4):5:5:5:5:hJ.$0.$1.$==1?hJ.$0.$1.$0.$==1?hJ.$0.$1.$1.$==0?cw.Equals(hI,hJ.$0.$0)?(hK=[hJ.$0.$1.$0.$0,hI,hJ.$0.$0],4):5:5:5:5:5:5){case 0:return hK;case 1:return{$:1,$0:hK[0]+hK[1]};case 2:return{$:5,$0:new bY({$:1,$0:{$:1,$0:hK[0]+hK[1]},$1:hK[2]})};case 3:return{$:5,$0:new bY({$:1,$0:hK[0],$1:hK[1]})};case 4:return{$:2,$0:bX.ofArray([{$:1,$0:hK[0]+1},hK[1]])};case 5:return hI.$==2&&(hI.$0.$==1&&(hI.$0.$0.$==1?hI.$0.$1.$==1&&(hI.$0.$1.$1.$==0&&(hJ.$==2&&(hJ.$0.$==1&&(hJ.$0.$0.$==1?hJ.$0.$1.$==1&&(hJ.$0.$1.$1.$==0&&(cw.Equals(hI.$0.$1.$0,hJ.$0.$1.$0)?(hL=[hI.$0.$0.$0,hJ.$0.$0.$0,hI.$0.$1.$0,hJ.$0.$1.$0],true):hJ.$0.$1.$0.$==1&&(cw.Equals(hI.$0.$1.$0,hJ.$0.$0)?(hL=[hI.$0.$0.$0,hJ.$0.$1.$0.$0,hI.$0.$1.$0,hJ.$0.$0],true):hI.$0.$1.$0.$==1&&(cw.Equals(hI.$0.$0,hJ.$0.$0)&&(hL=[hI.$0.$1.$0.$0,hJ.$0.$1.$0.$0,hI.$0.$0,hJ.$0.$0],true))))):hJ.$0.$1.$==1&&(hJ.$0.$1.$0.$==1&&(hJ.$0.$1.$1.$==0&&(cw.Equals(hI.$0.$1.$0,hJ.$0.$0)?(hL=[hI.$0.$0.$0,hJ.$0.$1.$0.$0,hI.$0.$1.$0,hJ.$0.$0],true):hI.$0.$1.$0.$==1&&(cw.Equals(hI.$0.$0,hJ.$0.$0)&&(hL=[hI.$0.$1.$0.$0,hJ.$0.$1.$0.$0,hI.$0.$0,hJ.$0.$0],true))))))))):hI.$0.$1.$==1&&(hI.$0.$1.$0.$==1&&(hI.$0.$1.$1.$==0&&(hJ.$==2&&(hJ.$0.$==1&&(hJ.$0.$1.$==1&&(hJ.$0.$1.$0.$==1&&(hJ.$0.$1.$1.$==0&&(cw.Equals(hI.$0.$0,hJ.$0.$0)&&(hL=[hI.$0.$1.$0.$0,hJ.$0.$1.$0.$0,hI.$0.$0,hJ.$0.$0],true)))))))))))?{$:2,$0:bX.ofArray([{$:1,$0:hL[0]+hL[1]},hL[2]])}:cw.Equals(hI,hJ)?{$:2,$0:bX.ofArray([{$:1,$0:2},hI])}:{$:5,$0:bX.ofArray([hI,hJ])};}};br.cartesianProd=function(hI,hJ){return bX.ofSeq(co.delay(function(){return co.collect(function(hK){return co.map(function(hL){return[hK,hL];},hJ);},hI);}));};br.collectBool=function(hI,hJ){function hK(hM,hN,hO){return bX.map(hO,br.cartesianProd((br.collect(hI))(hM),(br.collect(hI))(hN)));}function hL(hM,hN,hO){return bX.map(hO,br.cartesianProd(br.collectBool(hI,hM),br.collectBool(hI,hN)));}return hJ.$==1?bX.ofArray([bs.BFalse]):hJ.$==2?hK(hJ.$0,hJ.$1,function(hM){return{$:2,$0:hM[0],$1:hM[1]};}):hJ.$==3?hK(hJ.$0,hJ.$1,function(hM){return{$:3,$0:hM[0],$1:hM[1]};}):hJ.$==4?hK(hJ.$0,hJ.$1,function(hM){return{$:4,$0:hM[0],$1:hM[1]};}):hJ.$==5?hK(hJ.$0,hJ.$1,function(hM){return{$:5,$0:hM[0],$1:hM[1]};}):hJ.$==6?hK(hJ.$0,hJ.$1,function(hM){return{$:6,$0:hM[0],$1:hM[1]};}):hJ.$==7?bX.map(function(hM){return{$:7,$0:hM};},br.collectBool(hI,hJ.$0)):hJ.$==8?hL(hJ.$0,hJ.$1,function(hM){return{$:8,$0:hM[0],$1:hM[1]};}):hJ.$==9?hL(hJ.$0,hJ.$1,function(hM){return{$:9,$0:hM[0],$1:hM[1]};}):bX.ofArray([bs.BTrue]);};br.to_mathML=function(hI,hJ){return hJ.$==1?{$:3,$0:{$:1,$0:hJ.$0},$1:null}:hJ.$==2?{$:2,$0:fu.Times,$1:bX.map(function(hK){return br.to_mathML(hI,hK);},hJ.$0)}:hJ.$==3?{$:1,$0:fv.Divide,$1:br.to_mathML(hI,hJ.$0.div1),$2:br.to_mathML(hI,hJ.$0.div2)}:hJ.$==4?{$:1,$0:fv.Power,$1:br.to_mathML(hI,hJ.$0.base_),$2:br.to_mathML(hI,hJ.$0.exponent)}:hJ.$==5?{$:2,$0:fu.Plus,$1:bX.map(function(hK){return br.to_mathML(hI,hK);},hJ.$0)}:hJ.$==6?{$:1,$0:fv.Subtract,$1:br.to_mathML(hI,hJ.$0.sub1),$2:br.to_mathML(hI,hJ.$0.sub2)}:hJ.$==7?{$:0,$0:gJ.Abs,$1:br.to_mathML(hI,hJ.$0)}:hJ.$==8?{$:0,$0:{$:31,$0:null},$1:br.to_mathML(hI,hJ.$0)}:hJ.$==9?{$:1,$0:fv.Mod,$1:br.to_mathML(hI,hJ.$0.div),$2:br.to_mathML(hI,hJ.$0.modulo)}:hJ.$==10?{$:0,$0:gJ.Ceiling,$1:br.to_mathML(hI,hJ.$0)}:hJ.$==11?{$:0,$0:gJ.Floor,$1:br.to_mathML(hI,hJ.$0)}:hJ.$==12?be.FailWith("Conversion of rounding expression to MathML not supported."):hJ.$==13?be.FailWith("Conversion of conditional expressions to MathML not supported."):{$:4,$0:hI(hJ.$0)};};br.substitute=function(hI,hJ){var hK,hL;function hM(hN){return br.substitute(hI,hN);}return hJ.$==1?{$:1,$0:hJ.$0}:hJ.$==2?{$:2,$0:bX.map(hM,hJ.$0)}:hJ.$==3?{$:3,$0:bw.New(hM(hJ.$0.div1),hM(hJ.$0.div2))}:hJ.$==4?{$:4,$0:bv.New(hM(hJ.$0.base_),hM(hJ.$0.exponent))}:hJ.$==5?{$:5,$0:bX.map(hM,hJ.$0)}:hJ.$==6?{$:6,$0:bu.New(hM(hJ.$0.sub1),hM(hJ.$0.sub2))}:hJ.$==7?{$:7,$0:hM(hJ.$0)}:hJ.$==8?{$:8,$0:hM(hJ.$0)}:hJ.$==9?{$:9,$0:bt.New(hM(hJ.$0.div),hM(hJ.$0.modulo))}:hJ.$==10?{$:10,$0:hM(hJ.$0)}:hJ.$==11?{$:11,$0:hM(hJ.$0)}:hJ.$==12?{$:12,$0:hM(hJ.$0)}:hJ.$==13?{$:13,$0:br.substituteBool(hI,hJ.$0),$1:hM(hJ.$1),$2:hM(hJ.$2)}:(hK=hJ.$0,(hL=bW.TryFind(hK,hI),hL!=null&&hL.$==1?hL.$0:{$:0,$0:hK}));};br.exp=function(hI){var hJ,hK,hL,hM,hN,hO,hP;function hQ(hS,hT){return{$:6,$0:bu.New(hS,hT)};}function hR(hS,hT){return{$:5,$0:bX.ofArray([hS,hT])};}hJ=(hK=cR.choice([(hL=cR.skw("-"),function(hS){return br.op_GreaterGreaterPercent(hL,function(hT){return function(hU){return hQ(hT,hU);};},hS[0],hS[1]);}),(hM=cR.skw("+"),function(hS){return br.op_GreaterGreaterPercent(hM,function(hT){return function(hU){return hR(hT,hU);};},hS[0],hS[1]);})]),function(hS){return hK([hS[0],hS[1]]);});return cR.chainl1Try((hN=cR.choice([cR.pTry(br.op_GreaterGreaterEquals((hO=cR.kw("-"),(hP=br.term(hI),function(hS){return br.op_GreaterGreaterDot(hO,hP,hS[0],hS[1]);})),function(hS){return cR.preturn({$:6,$0:bu.New({$:1,$0:0},hS)});})),cR.pTry(br.term(hI))]),function(hS){return hN([hS[0],hS[1]]);}),hJ);};br.op_BarGreaterGreater=function(hI,hJ,hK,hL){return(cR.op_BarGreaterGreater(hI,hJ))([hK,hL]);};br.to_lambda_bool=function(hI){var hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX;return hI.$==1?function(){return false;}:hI.$==2?(hJ=br.to_lambda_inner(hI.$0),(hK=br.to_lambda_inner(hI.$1),function(hY){return hJ(hY)<hK(hY);})):hI.$==3?(hL=br.to_lambda_inner(hI.$0),(hM=br.to_lambda_inner(hI.$1),function(hY){return hL(hY)<=hM(hY);})):hI.$==4?(hN=br.to_lambda_inner(hI.$0),(hO=br.to_lambda_inner(hI.$1),function(hY){return hN(hY)===hO(hY);})):hI.$==5?(hP=br.to_lambda_inner(hI.$0),(hQ=br.to_lambda_inner(hI.$1),function(hY){return hP(hY)>=hQ(hY);})):hI.$==6?(hR=br.to_lambda_inner(hI.$0),(hS=br.to_lambda_inner(hI.$1),function(hY){return hR(hY)>hS(hY);})):hI.$==7?(hT=br.to_lambda_bool(hI.$0),function(hY){return!hT(hY);}):hI.$==8?(hU=br.to_lambda_bool(hI.$0),(hV=br.to_lambda_bool(hI.$1),function(hY){return hU(hY)&&hV(hY);})):hI.$==9?(hW=br.to_lambda_bool(hI.$0),(hX=br.to_lambda_bool(hI.$1),function(hY){return hW(hY)||hX(hY);})):function(){return true;};};br.isFactor=function(hI){return hI.$==0||hI.$==2&&(hI.$0.$==1&&(hI.$0.$0.$==1?hI.$0.$1.$==1&&(hI.$0.$1.$0.$==0&&hI.$0.$1.$1.$==0):hI.$0.$0.$==0&&(hI.$0.$1.$==1&&(hI.$0.$1.$0.$==1&&hI.$0.$1.$1.$==0))));};br.splitFactor=function(hI){var hJ;switch(hI.$==0?(hJ=hI.$0,0):hI.$==2?hI.$0.$==1?hI.$0.$0.$==1?hI.$0.$1.$==1?hI.$0.$1.$0.$==0?hI.$0.$1.$1.$==0?(hJ=[hI.$0.$1.$0.$0,hI.$0.$0.$0],1):2:2:2:hI.$0.$0.$==0?hI.$0.$1.$==1?hI.$0.$1.$0.$==1?hI.$0.$1.$1.$==0?(hJ=[hI.$0.$0.$0,hI.$0.$1.$0.$0],1):2:2:2:2:2:2){case 0:return[1,hJ];case 1:return[hJ[1],hJ[0]];case 2:return be.FailWith("unexpected factor");}};br.addFactors=function(hI,hJ){var hK;hK=br.splitFactor(hI);return{$:2,$0:bX.ofArray([{$:1,$0:hK[0]+(br.splitFactor(hJ))[0]},{$:0,$0:hK[1]}])};};br.modulo$1=function(hI,hJ){var hK;switch(hJ.$==1?hJ.$0===1?0:hI.$==1?hI.$0===0?1:(hK=[hI.$0,hJ.$0],2):3:hI.$==1?hI.$0===0?1:3:3){case 0:return{$:1,$0:0};case 1:return{$:1,$0:0};case 2:return{$:1,$0:br.moduloFloat(hK[0],hK[1])};case 3:return{$:9,$0:bt.New(hI,hJ)};}};br.substituteBool=function(hI,hJ){function hK(hM){return br.substituteBool(hI,hM);}function hL(hM){return br.substitute(hI,hM);}return hJ.$==1?bs.BFalse:hJ.$==2?{$:2,$0:hL(hJ.$0),$1:hL(hJ.$1)}:hJ.$==3?{$:3,$0:hL(hJ.$0),$1:hL(hJ.$1)}:hJ.$==4?{$:4,$0:hL(hJ.$0),$1:hL(hJ.$1)}:hJ.$==5?{$:5,$0:hL(hJ.$0),$1:hL(hJ.$1)}:hJ.$==6?{$:6,$0:hL(hJ.$0),$1:hL(hJ.$1)}:hJ.$==7?{$:7,$0:hK(hJ.$0)}:hJ.$==8?{$:8,$0:hK(hJ.$0),$1:hK(hJ.$1)}:hJ.$==9?{$:9,$0:hK(hJ.$0),$1:hK(hJ.$1)}:bs.BTrue;};br.op_GreaterGreaterEquals=function(hI,hJ){return cR.op_GreaterGreaterEquals(hI,hJ);};br.op_GreaterGreaterDot=function(hI,hJ,hK,hL){return(cR.op_GreaterGreaterDot(hI,hJ))([hK,hL]);};br.term=function(hI){var hJ,hK,hL,hM;function hN(hP,hQ){return{$:2,$0:bX.ofArray([hP,hQ])};}function hO(hP,hQ){return{$:9,$0:bt.New(hP,hQ)};}hJ=(hK=cR.choice([(hL=cR.skw("*"),function(hP){return br.op_GreaterGreaterPercent(hL,function(hQ){return function(hR){return hN(hQ,hR);};},hP[0],hP[1]);}),(hM=cR.skw("%"),function(hP){return br.op_GreaterGreaterPercent(hM,function(hQ){return function(hR){return hO(hQ,hR);};},hP[0],hP[1]);})]),function(hP){return hK([hP[0],hP[1]]);});return cR.chainl1Try(br.factor(hI),hJ);};br.op_GreaterGreaterPercent=function(hI,hJ,hK,hL){return(cR.op_GreaterGreaterPercent(hI,hJ))([hK,hL]);};br.factor=function(hI){var hJ,hK,hL,hM;function hN(hQ,hR){return{$:3,$0:bw.New(hQ,hR)};}function hO(hQ,hR){return{$:4,$0:bv.New(hQ,hR)};}function hP(hQ,hR){return{$:4,$0:bv.New(hQ,hR)};}return cR.chainl1Try(br.irr(hI),(hJ=cR.choice([(hK=cR.skw("/"),function(hQ){return br.op_GreaterGreaterPercent(hK,function(hR){return function(hS){return hN(hR,hS);};},hQ[0],hQ[1]);}),(hL=cR.skw("^"),function(hQ){return br.op_GreaterGreaterPercent(hL,function(hR){return function(hS){return hO(hR,hS);};},hQ[0],hQ[1]);}),(hM=cR.skw("**"),function(hQ){return br.op_GreaterGreaterPercent(hM,function(hR){return function(hS){return hP(hR,hS);};},hQ[0],hQ[1]);})]),function(hQ){return hJ([hQ[0],hQ[1]]);}));};br.irr=function(hI){return cR.pTry(function(hJ){var hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0,h1,h2,h3,h4,h5;function h6(il,im){return br.op_DotGreaterGreater(cR.pfloat(),cR.spaces(),il,im);}function h7(il){return{$:1,$0:il};}function h8(il,im){return br.op_DotGreaterGreater(cR.pint32(),cR.spaces(),il,im);}function h9(il){return{$:1,$0:il};}function h_(il,im){return br.es(hI,il,im);}function h$(il){return{$:5,$0:il};}function ia(il,im){return br.es(hI,il,im);}function ib(il){return{$:2,$0:il};}function ic(il,im){return br.e(hI,il,im);}function id(il){return{$:8,$0:il};}function ie(il,im){return br.e(hI,il,im);}function _if(il){return{$:10,$0:il};}function ig(il,im){return br.e(hI,il,im);}function ih(il){return{$:11,$0:il};}function ii(il,im){return br.e(hI,il,im);}function ij(il){return{$:12,$0:il};}function ik(il,im){return br.bexp$1(hI,il,im);}return(cR.choice([function(il){return br.op_BarGreaterGreater(function(im){return h6(im[0],im[1]);},h7,il[0],il[1]);},(hK=function(il){return h9(a.id(il));},function(il){return br.op_BarGreaterGreater(function(im){return h8(im[0],im[1]);},hK,il[0],il[1]);}),(hL=(hM=cR.kw("sum"),function(il){return br.op_GreaterGreaterDot(hM,function(im){return h_(im[0],im[1]);},il[0],il[1]);}),function(il){return br.op_BarGreaterGreater(hL,h$,il[0],il[1]);}),(hN=(hO=cR.kw("prod"),function(il){return br.op_GreaterGreaterDot(hO,function(im){return ia(im[0],im[1]);},il[0],il[1]);}),function(il){return br.op_BarGreaterGreater(hN,ib,il[0],il[1]);}),(hP=(hQ=cR.kw("log"),function(il){return br.op_GreaterGreaterDot(hQ,function(im){return ic(im[0],im[1]);},il[0],il[1]);}),function(il){return br.op_BarGreaterGreater(hP,id,il[0],il[1]);}),(hR=(hS=cR.kw("ceiling"),function(il){return br.op_GreaterGreaterDot(hS,function(im){return ie(im[0],im[1]);},il[0],il[1]);}),function(il){return br.op_BarGreaterGreater(hR,_if,il[0],il[1]);}),(hT=(hU=cR.kw("floor"),function(il){return br.op_GreaterGreaterDot(hU,function(im){return ig(im[0],im[1]);},il[0],il[1]);}),function(il){return br.op_BarGreaterGreater(hT,ih,il[0],il[1]);}),(hV=(hW=cR.kw("round"),function(il){return br.op_GreaterGreaterDot(hW,function(im){return ii(im[0],im[1]);},il[0],il[1]);}),function(il){return br.op_BarGreaterGreater(hV,ij,il[0],il[1]);}),br.op_GreaterGreaterEquals((hX=(hY=(hZ=(h0=(h1=cR.kw("if"),function(il){return br.op_GreaterGreaterDot(h1,function(im){return ik(im[0],im[1]);},il[0],il[1]);}),(h2=cR.kw("then"),function(il){return br.op_DotGreaterGreater(h0,h2,il[0],il[1]);})),(h3=br.exp(hI),function(il){return br.op_DotGreaterGreaterDot(hZ,h3,il[0],il[1]);})),(h4=cR.kw("else"),function(il){return br.op_DotGreaterGreater(hY,h4,il[0],il[1]);})),(h5=br.exp(hI),function(il){return br.op_DotGreaterGreaterDot(hX,h5,il[0],il[1]);})),function(il){var im;im=il[0];return cR.preturn({$:13,$0:im[0],$1:im[1],$2:il[1]});}),hI,function(il){return br.e(hI,il[0],il[1]);}]))([hJ[0],hJ[1]]);});};br.one=function(){hx.$cctor();return hx.one;};br.zero=function(){hx.$cctor();return hx.zero;};br.op_DotGreaterGreater=function(hI,hJ,hK,hL){return(cR.op_DotGreaterGreater(hI,hJ))([hK,hL]);};br.es=function(hI,hJ,hK){return(cR.paren(cR.sepBy(br.exp(hI),cR.kw(";"))))([hJ,hK]);};br.e=function(hI,hJ,hK){return(cR.paren(br.exp(hI)))([hJ,hK]);};br.op_DotGreaterGreaterDot=function(hI,hJ,hK,hL){return(cR.op_DotGreaterGreaterDot(hI,hJ))([hK,hL]);};br.bexp$1=function(hI,hJ,hK){var hL;function hM(hO,hP){return br.bexp$1(hI,hO,hP);}function hN(hO){return{$:7,$0:hO};}return(cR.choice([br.op_GreaterGreaterEquals((hL=cR.kw("not"),function(hO){return br.op_GreaterGreaterDot(hL,function(hP){return hM(hP[0],hP[1]);},hO[0],hO[1]);}),function(hO){return cR.preturn(hN(hO));}),br.op_GreaterGreaterEquals(function(hO){return br.bterm(hI,hO[0],hO[1]);},function(hO){var hP,hQ,hR;function hS(hU,hV){return br.bexp$1(hI,hU,hV);}function hT(hU,hV){return br.bexp$1(hI,hU,hV);}hP=cR.choice([br.op_GreaterGreaterEquals((hQ=cR.kw("&&"),function(hU){return br.op_GreaterGreaterDot(hQ,function(hV){return hS(hV[0],hV[1]);},hU[0],hU[1]);}),function(hU){return cR.preturn({$:8,$0:hO,$1:hU});}),br.op_GreaterGreaterEquals((hR=cR.kw("||"),function(hU){return br.op_GreaterGreaterDot(hR,function(hV){return hT(hV[0],hV[1]);},hU[0],hU[1]);}),function(hU){return cR.preturn({$:9,$0:hO,$1:hU});}),cR.preturn(hO)]);return function(hU){return hP([hU[0],hU[1]]);};}),cR.paren(function(hO){return br.bexp$1(hI,hO[0],hO[1]);})]))([hJ,hK]);};br.bterm=function(hI,hJ,hK){var hL,hM,hN,hO;return(cR.choice([(hL=cR.kw("true"),(hM=cR.preturn(bs.BTrue),function(hP){return br.op_GreaterGreaterDot(hL,hM,hP[0],hP[1]);})),(hN=cR.kw("false"),(hO=cR.preturn(bs.BFalse),function(hP){return br.op_GreaterGreaterDot(hN,hO,hP[0],hP[1]);})),br.op_GreaterGreaterEquals(br.exp(hI),function(hP){var hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0;hQ=cR.choice([br.op_GreaterGreaterEquals((hR=cR.kw("<="),(hS=br.exp(hI),function(h1){return br.op_GreaterGreaterDot(hR,hS,h1[0],h1[1]);})),function(h1){return cR.preturn({$:3,$0:hP,$1:h1});}),br.op_GreaterGreaterEquals((hT=cR.kw("<"),(hU=br.exp(hI),function(h1){return br.op_GreaterGreaterDot(hT,hU,h1[0],h1[1]);})),function(h1){return cR.preturn({$:2,$0:hP,$1:h1});}),br.op_GreaterGreaterEquals((hV=cR.kw("="),(hW=br.exp(hI),function(h1){return br.op_GreaterGreaterDot(hV,hW,h1[0],h1[1]);})),function(h1){return cR.preturn({$:4,$0:hP,$1:h1});}),br.op_GreaterGreaterEquals((hX=cR.kw(">="),(hY=br.exp(hI),function(h1){return br.op_GreaterGreaterDot(hX,hY,h1[0],h1[1]);})),function(h1){return cR.preturn({$:5,$0:hP,$1:h1});}),br.op_GreaterGreaterEquals((hZ=cR.kw(">"),(h0=br.exp(hI),function(h1){return br.op_GreaterGreaterDot(hZ,h0,h1[0],h1[1]);})),function(h1){return cR.preturn({$:6,$0:hP,$1:h1});})]);return function(h1){return hQ([h1[0],h1[1]]);};})]))([hJ,hK]);};K.to_string_monomial=function(hI){function hJ(hK,hL){return hL===1?hK.name:(((hB.Curried3(function(hM,hN,hO){return hM(cA.toSafe(hN)+"^"+a.String(hO));}))(a.id))(hK.name))(hL);}return br.to_string(function(hK){var hL;function hM(hO){return hO[1];}function hN(hO){return 0!==hO;}hL=cS.concat("*",bX.map(function(hO){return hJ(hO[0],hO[1]);},bX.filter(function(hO){return hN(hM(hO));},hK)));return(function(hO){return function(hP){return hO("<"+cA.toSafe(hP)+">");};}(a.id))(hL);},hI);};K.defaults=function(){gv.$cctor();return gv.defaults;};K.saturate_plots=function(hI,hJ){var hK;function hL(hN){return bX.zip(hI,hN);}function hM(hN){return{$:0,$0:hN};}return hJ.plots.$==0?L.New(hJ.order,hJ.initial_minimum,hJ.log_evaluation,bX.map((hK=function(hN){return hL(bX.ofArray(hN));},function(hN){return hM(hK(hN));}),K.initAllOrders(hI.get_Length(),hJ.order))):hJ;};K.initAllOrders=function(hI,hJ){function hK(hL,hM){var hN,hO;return hL.$==1?(hN=hL.$1,(hO=hL.$0,co.fold(function(hP,hQ){return bX.append(bX.map(function(hR){var hS;hS=hR.slice();ck.set(hS,hO,hQ);return hS;},hK(hN,hM-hQ)),hP);},bY.Empty,bX.ofSeq(be.range(0,hM))))):bX.ofArray([ck.create(hI,0)]);}return bX.filter(function(hL){return!ck.forall(function(hM){return hM===0;},hL);},hK(bX.ofSeq(be.range(0,hI-1)),hJ));};K.parse=function(){gv.$cctor();return gv.parse;};K.op_BarGreaterGreater=function(hI,hJ){return cR.op_BarGreaterGreater(hI,hJ);};K.op_GreaterGreaterDot=function(hI,hJ){return cR.op_GreaterGreaterDot(hI,hJ);};K.op_DotGreaterGreaterDot=function(hI,hJ){return cR.op_DotGreaterGreaterDot(hI,hJ);};K.op_DotGreaterGreater=function(hI,hJ){return cR.op_DotGreaterGreater(hI,hJ);};K.canonicalMonomial=function(hI){return bX.ofSeq(bW.ToSeq(co.fold(function(hJ,hK){var hL,hM,hN;hL=hK[0];hM=hK[1];hN=bW.TryFind(hL,hJ);return hN!=null&&hN.$==1?hJ.Add(hL,hN.$0+hM):hJ.Add(hL,hM);},new cj.New([]),hI)));};K.pmonomial=function(){gv.$cctor();return gv.pmonomial;};K.parse_defaults=function(hI){return cR.record(hI,bX.ofArray([["order",K.op_BarGreaterGreater(cR.pint32(),function(hJ){return function(hK){return L.New(hJ,hK.initial_minimum,hK.log_evaluation,hK.plots);};})],["initial_minimum",K.op_BarGreaterGreater(cR.pfloat(),function(hJ){return function(hK){return L.New(hK.order,hJ,hK.log_evaluation,hK.plots);};})],["log_evaluation",K.op_BarGreaterGreater(cR.pbool(),function(hJ){return function(hK){return L.New(hK.order,hK.initial_minimum,hJ,hK.plots);};})],["plots",K.op_BarGreaterGreater(cR.list_of(K.pplot()),function(hJ){return function(hK){return L.New(hK.order,hK.initial_minimum,hK.log_evaluation,hJ);};})]]));};K.pplot=function(){gv.$cctor();return gv.pplot;};cI.New=function(hI,hJ,hK,hL,hM){return{settings:hI,meta:hJ,sreactions:hK,initials:hL,dsdOptions:hM};};cJ.New=function(hI,hJ,hK,hL,hM,hN){return{settings:hI,initials:hJ,reactions:hK,plotsCache:hL,dsdOptions:hM,rules:hN};};cK=bV.FSharpSet=hB.Class({Add:function(hI){return new cK.New$1(c6.Add(hI,this.tree));},Contains:function(hI){return c6.Contains(hI,this.tree);},get_Count:function(){var hI;hI=this.tree;return hI==null?0:hI.Count;},get_IsEmpty:function(){return this.tree==null;},GetEnumerator$1:function(){return df.Get(c6.Enumerate(false,this.tree));},Equals:function(hI){return this.get_Count()===hI.get_Count()&&co.forall2(cw.Equals,this,hI);},GetHashCode:function(){return -1741749453+cw.Hash(ck.ofSeq(this));},Remove:function(hI){return new cK.New$1(c6.Remove(hI,this.tree));},GetEnumerator:function(){return this.GetEnumerator$1();},GetEnumerator0:function(){return this.GetEnumerator$1();},CompareTo0:function(hI){return co.compareWith(cw.Compare,this,hI);}},b1,cK);cK.op_Subtraction=function(hI,hJ){return c5.Filter(function(hK){return!hJ.Contains(hK);},hI);};cK.New$1=hB.Ctor(function(hI){b1.New.call(this);this.tree=hI;},cK);cL.to_string_plot=function(hI){var hJ;return hI.$==0&&(hI.$0.$==2&&(hJ=hI.$0.$0,true))?bG.to_string(hJ):cL.to_string(hI);};cL.to_string=function(hI){return br.to_string(function(hJ){return bq.to_string(bG.to_string,hJ);},hI);};cL.from_string_plot=function(hI){return cR.from_string(cL.parse_plot(),hI);};cL.from_string=function(hI){return cR.from_string(cL.parse(),hI);};cL.parse_plot=function(){fT.$cctor();return fT.parse_plot;};cL.parse=function(){fT.$cctor();return fT.parse;};cL.all_species=function(hI,hJ){return bX.collect(function(hK){return hK.$==2?bX.ofArray([hK.$0]):hK.$==1?cL.all_species(hI,hI.get_Item(hK.$0)):bY.Empty;},br.mentions(hJ));};cM.dom_map=function(hI,hJ){var hK,hL,hM,hN;hK=(bX.unzip(dD.to_list(hI)))[1];hL=bX.filter(function(hO){return!bX.exists(function(hP){return hO===hP;},hK);},cM.palette());hM=[0];hN=dD.empty();bX.iter(function(hO){var hP,hQ,hR,hS;hP=cM.from_dsd_domain(ef.empty(),hO).name;(hQ=dD.tryFind(hN,hP),hQ!=null&&hQ.$==1)?void 0:dD.add(hN,hP,(hR=dD.tryFind(hI,hP),hR!=null&&hR.$==1?hR.$0:(hS=hL.get_Item(hM[0]),(hM[0]=(hM[0]+1)%hL.get_Length(),hS))));},dZ.remove_duplicates(cw.Equals,bX.filter(eg.is_toehold,bX.collect(cN.domains,hJ))));return hN;};cM.species_style=function(hI,hJ){return cM.style(dD.to_list(cM.dom_map(hI,hJ)));};cM.species_to_svg_branches=function(hI,hJ,hK,hL,hM,hN){var hO;return cB.to_string_normalise(!hL&&!cw.Equals(hJ,"Nucleotides"),hM,cB.emerge_groups(bX.ofArray([hN.$==1?cM.dgate_to_group(hJ,hL,cM.from_dsd_gate(hK,hN.$0)):hN.$==2?cM.dorigami_to_group(hI,hJ,hL,cM.from_dsd_origami(hK,hN.$0)):hN.$==3?cM.unknown_to_group(hN.$0):hN.$==4?(hO=cM.from_logic_dsd(hN.$0),hO.$==1?cM.dbranch_to_group(hI,hJ,hL,hO.$0):cM.dstrand_to_group(hJ,hL,null,false,null,false,false,false,hO.$0)):cM.dstrand_to_group(hJ,hL,null,false,null,false,false,false,cM.from_dsd_strand(hK,hN.$0))])));};cM.palette=function(){fg.$cctor();return fg.palette;};cM.from_dsd_domain=function(hI,hJ){var hK,hL,hM,hN;hK=eg.get_name(hJ);return eh.New(cS.EndsWith(hK,"*")?cS.Substring(hK,0,hK.length-1):hK,(hL=ef.get_domain(hI,hJ),(hL!=null&&hL.$==1?(hN=hL.$0,hN!=null&&hN.$==1)?(hM=hL.$0.$0,false):true:true)?ef.parse_sequence(eg.get_sequence(hJ)):hM),eg.is_toehold(hJ),eg.is_complemented(hJ),eg.is_tethered(hJ)?{$:1,$0:eg.display_picture(hJ,true)}:null,null);};cM.style=function(hI){var hJ,hK;function hL(hM,hN){var hO;hO=cM.sanitize_id(hM);return"path."+cM.base_class()+".dom_"+hO+" { stroke: "+hN+" } text."+cM.base_class()+".dom_"+hO+" { fill: "+hN+" }";}hJ=dZ.string_of_list(function(hM){return hL(hM[0],hM[1]);}," ",hI);hK="g { fill: none; } path."+cM.base_class()+" { stroke: silver; stroke-width: "+cB.display_float(cM.line_width())+"; stroke-linejoin: round; } text."+cM.base_class()+" { fill: black; stroke-width: 0; font-family: Verdana,Arial,sans-serif; font-size: "+a.String(be.toInt(cM.font_size()))+"px; text-anchor: middle } text.fixedwidth { font-family:Lucida Console,monospace } text.pseudoknot { font-weight:bold } path.shortbranchjoin { "+cM.short_branch_join_style()+" } path.branchjoin { "+cM.branch_join_style()+" }";return(function(hM){return function(hN){return hM("path { stroke: silver; stroke-width: "+hN.toFixed(6)+"; stroke-linejoin: round; fill: none; }");};}(a.id))(cM.line_width())+" "+(function(hM){return function(hN){return hM("text { stroke: black; fill: black; stroke-width: 0; font-family: Verdana,Arial,sans-serif; font-size: "+hN.toFixed(6)+"px; text-anchor: middle; }");};}(a.id))(cM.font_size())+" "+hK+" "+hJ+" "+("path."+cM.base_class()+".tether-pin { stroke : black }");};cM.dgate_to_group=function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0,h1;function h2(h4,h5,h6){return cM.dsegment_to_group(hI,hJ,h4,h5,h6);}function h3(h4,h5,h6){return function(h7){var h8,h9,h_;h8=h2(h4,h6,h7);h9=(h_=h4.connection,h_!=null&&h_.$==1?h_.$0.$==1?cB.attach_group_to(h5,"br",h8,"bl"):h_.$0.$==2?cB.attach_group_to(h5,"tr",h8,"tl"):cB.attach_group_to(h5,"tr",h8,"tl"):be.FailWith("unconnected segment"));return[h9,[h6,h9,h7]];};}hL=bX.head(hK.segments);hM=(hN=bX.tail(hK.segments),hN.$==1?hN.$0:cM.empty_dsegment());hO=h2(gf.New(cM.empty_dsegment().top_left,cM.empty_dsegment().top_right,cM.empty_dsegment().bottom_left,cM.empty_dsegment().bottom_right,cM.empty_dsegment().double_strand,cM.empty_dsegment().hairpin_left,cM.empty_dsegment().hairpin_right,hK.left_connection),hL,hM);hP=(hQ=bX.tail(hK.segments),hQ.$==1?(hR=bX.mapFold(function(h4,h5){return(function(h6){return h3(h6[0],h6[1],h6[2]);}(h4))(h5);},[hL,hO,hQ.$0],hQ.$1),(hS=new bY({$:1,$0:hO,$1:hR[0]}),(hT=(function(h4){return h3(h4[0],h4[1],h4[2]);}([hR[1][0],bX.last(hS),hR[1][2]]))(cM.empty_dsegment()),[bX.append(hS,bX.ofArray([hT[0]])),[hT[1][0],hT[1][1]]]))):[bX.ofArray([hO]),[hL,hO]]);hU=hP[1][0];hV=hP[1][1];hW=hK.left_connection;hX=hU.connection;return dY.New("Gate "+a.String(hK),{$:0,$0:bY.Empty},bX.choose(a.id,bX.ofArray([hL.hairpin_left!=null?null:(hY=cB.get_anchor_point("tl",hO),{$:1,$0:e_.New("tl",cw.Equals(hW,{$:1,$0:gh.DoubleLink})||cw.Equals(hW,{$:1,$0:gh.TopLink})?hY:hY.y===-cM.half_separation()?dW.New(hY.x-cM.extension_length(),hY.y):cB.rotate_point_around(hY,-cM.overhang_angle(),dW.New(hY.x-cM.extension_length(),hY.y)))}),hU.hairpin_right!=null?null:(hZ=cB.get_anchor_point("tr",hV),{$:1,$0:e_.New("tr",cw.Equals(hX,{$:1,$0:gh.DoubleLink})||cw.Equals(hX,{$:1,$0:gh.TopLink})?hZ:hZ.y===-cM.half_separation()?dW.New(hZ.x+cM.extension_length(),hZ.y):cB.rotate_point_around(hZ,-cM.overhang_angle(),dW.New(hZ.x+cM.extension_length(),hZ.y)))}),hL.hairpin_left!=null?null:(h0=cB.get_anchor_point("bl",hO),{$:1,$0:e_.New("bl",cw.Equals(hW,{$:1,$0:gh.DoubleLink})||cw.Equals(hW,{$:1,$0:gh.BottomLink})?h0:h0.y===cM.half_separation()?dW.New(h0.x-cM.extension_length(),h0.y):cB.rotate_point_around(h0,cM.overhang_angle(),dW.New(h0.x-cM.extension_length(),h0.y)))}),hU.hairpin_right!=null?null:(h1=cB.get_anchor_point("br",hV),{$:1,$0:e_.New("br",cw.Equals(hX,{$:1,$0:gh.DoubleLink})||cw.Equals(hX,{$:1,$0:gh.BottomLink})?h1:h1.y===cM.half_separation()?dW.New(h1.x+cM.extension_length(),h1.y):cB.rotate_point_around(h1,cM.overhang_angle(),dW.New(h1.x+cM.extension_length(),h1.y)))})])),cM.debug_anchors(),hP[0],null);};cM.from_dsd_gate=function(hI,hJ){var hK;function hL(hN){return cM.from_dsd_segment(hI,hN);}function hM(hN,hO){var hP;hP=hO.get_Length();return bX.mapi(function(hQ,hR){var hS;hS=hL(hR);return gf.New(hS.top_left,hS.top_right,hS.bottom_left,hS.bottom_right,hS.double_strand,hS.hairpin_left,hS.hairpin_right,hQ===hP-1?hN?null:{$:1,$0:gh.TopLink}:{$:1,$0:gh.BottomLink});},hO);}hK=hJ.get_Length();return gg.New(null,bX.concat(bX.mapi(function(hN,hO){return hM(hN===hK-1,hO);},hJ)));};cM.dorigami_to_group=function(hI,hJ,hK,hL){var hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV;function hW(hX,hY,hZ,h0,h1,h2,h3){return cM.dstrand_to_group(hJ,hK,hX,hY,hZ,h0,h1,h2,h3);}hM=bX.partition(function(hX){return hX.$==0;},hL);hN=bX.map(function(hX){return hX.$==0?hX.$0:be.FailWith("");},hM[0]);hO=bX.map(function(hX){return hX.$==1?hX.$0:be.FailWith("");},hM[1]);hP=(hQ=bX.map(function(hX){return cB.emerge_groups(bX.ofArray([hX]));},bX.append(bX.map(function(hX){return hW(null,false,null,false,false,false,hX);},hN),bX.map(function(hX){return cM.dbranch_to_group(hI,hJ,hK,hX);},hO))),cB.stackv(cM.origami_sep(),cM.species_skip(),hQ));hR="";hS=cS.length(hR)*cM.letter_width()/2;hT=dW.New(2,2);hU=fZ.New({$:1,$0:cM.base_class()+" origami-border"},cB.rounded_box(hT,cB.translate_point_by(cB.scale_by(-1,hT),hP.box_dim),cM.origami_round()),{$:1,$0:f0.New(hR,cB.translate_point_by(dW.New(-hS,0),cB.sub(hP.box_dim,cM.origami_sep())),{$:1,$0:cM.base_class()},cB.default_letter_width(),cB.translate_point_by(dW.New(-hS,0),cB.sub(hP.box_dim,cM.origami_sep())))});hV=hP.box_group;return dY.New(hV.name,{$:0,$0:bX.ofArray([hU])},hV.anchors,hV.debug_anchors,hV.sub_groups,hV.offset);};cM.from_dsd_origami=function(hI,hJ){function hK(hN){return cM.from_dsd_strand(hI,hN);}function hL(hN){return cM.from_dsd_gate(hI,hN);}function hM(hN){return gi.New(hL(hN),bY.Empty);}return bX.map(function(hN){return hN.$==1?{$:1,$0:hM(hN.$0)}:{$:0,$0:hK(hN.$0)};},hJ);};cM.unknown_to_group=function(hI){return dY.New(hI,{$:1,$0:hI},bY.Empty,false,bY.Empty,null);};cM.from_logic_dsd=function(hI){var hJ,hK;function hL(hP){return hP.$==1?new gj({$:1,$0:hP.$0}):new gj({$:0,$0:hP.$0,$1:hP.$1});}function hM(hP){var hQ,hR;function hS(hW,hX){function hY(hZ,h0){return co.delay(function(){var h1,h2;return h0.$==1?(h1=h0.$1,(h2=h0.$0,co.append([bX.append(bX.rev(hZ),bX.append(bX.ofArray([hW]),h0))],co.delay(function(){return hY(new bY({$:1,$0:h2,$1:hZ}),h1);})))):[bX.append(hX,bX.ofArray([hW]))];});}return hY(bY.Empty,hX);}function hT(hW){var hX;return hW.$==1?co.collect((hX=hW.$0,function(hY){return hS(hX,hY);}),hT(hW.$1)):[bY.Empty];}function hU(hW){var hX;function hY(hZ,h0){var h1,h2,h3;return h0.$==1?h0.$1.$==0?[hZ===h0.$0?null:{$:1,$0:hZ},bY.Empty]:(h1=h0.$0,hZ===h1?[null,h0.$1]:(h2=hY(h1,h0.$1),(h3=h2[0],h3==null?hY(hZ,h2[1]):[h3,h2[1]]))):[{$:1,$0:hZ},bY.Empty];}hX=bX.concat(bX.map(function(hZ){return bX.choose(function(h0){return h0.$==0?{$:1,$0:h0.$1}:null;},hZ);},hW));return hX.$===0?null:(function(hZ){var h0;while(true)if(hZ.$===0)return[null,bY.Empty];else{h0=hY(bX.head(hZ),bX.tail(hZ));if(h0[0]==null)hZ=h0[1];else return h0;}}(hX))[0];}function hV(hW){var hX;function hY(h0){function h1(h2){return bX.exists(function(h3){return h3.$==0&&h3.$1===h0;},h2);}bX.iter(function(h2){var h3;h3=h2[0];h1(h3)?hZ(h3,h2[1]):void 0;},hX);}function hZ(h0,h1){if(h1[0]);else{h1[0]=true;bX.iter(function(h2){if(h2.$==0)hY(h2.$1);},h0);}}hX=bX.map(function(h0){return[h0,[false]];},hW);hZ.apply(null,bX.head(hX));return!bX.exists(function(h0){return cw.Equals(false,h0[1][0]);},hX);}hQ=co.tryFind(function(hW){return hU(hW)==null&&hV(hW);},hT(hP));return hQ==null?(hR=bX.choose(function(hW){function hX(hY){var hZ,h0;return hY.$==0?(hZ=hY.$0,(h0=hY.$1,h0===hW?new gj({$:2,$0:hZ,$1:h0}):new gj({$:0,$0:hZ,$1:h0}))):hY;}return hM(bX.map(function(hY){return bX.map(hX,hY);},hP));},bX.distinct(bX.concat(bX.map(function(hW){return bX.choose(function(hX){return hX.$==0?{$:1,$0:hX.$1}:null;},hW);},hP)))),hR.$==0?null:{$:1,$0:bX.minBy(function(hW){return co.sumBy(function(hX){return hX.$==2?1:0;},bX.concat(hW));},hR)}):{$:1,$0:hQ.$0};}function hN(hP){var hQ;function hR(hT,hU){var hV,hW;switch(hU.$==0?2:(hW=hU.$0,hW!=null&&hW.$==1?hU.$0.$0.$==0?0:(hV=[hU.$1,hU.$0],1):(hV=[hU.$1,hU.$0],1))){case 0:return[hT,hU];case 1:return hR(bX.append(hT,bX.ofArray([hV[1]])),hV[0]);case 2:return[hT,hU];}}function hS(hT,hU){var hV,hW,hX,hY,hZ,h0,h1,h2;switch(hU.$==1?(hW=hU.$0,hW!=null&&hW.$==1?hU.$0.$0.$==0?(hV=[hU.$0.$0.$1,hU.$0.$0.$0,hU.$1],1):2:2):0){case 0:return[hT,hU];case 1:hX=hV[0];hY=function(h3,h4){var h5,h6,h7,h8;while(true){if(h4.$==1&&((h6=h4.$0,h6!=null&&h6.$==1)&&(h4.$0.$0.$==0&&(h4.$0.$0.$1===hX&&(h5=[h4.$1,h4.$0.$0.$1],true)))))return[h3,h5[0]];else if(h4.$==0)return be.FailWith("cannot find a matching bond site; this should never happen (bad pseudoknot elimination?)");else{h7=h4.$0;h8=h4.$1;h3=bX.append(h3,bX.ofArray([h7]));h4=h8;}}}(bY.Empty,hV[2]);hZ=gg.New(null,bX.ofArray([gf.New(null,null,null,null,gl.New(gm.DoubleStrand,bX.ofArray([cM.domainc_to_domain(hV[1],null)])),null,null,null)]));h0=hN(hY[0]);h1=hR(bY.Empty,hY[1]);h2=hS(bX.append(hT,bX.ofArray([[gk.New(hZ,h0),h1[0]]])),h1[1]);return[h2[0],h2[1]];case 2:return be.FailWith("non-bond site after following a leading/trailing sequence; this should never happen");}}hQ=hR(bY.Empty,hP);return gn.New(hQ[0],(hS(bY.Empty,hQ[1]))[0]);}function hO(hP,hQ){var hR,hS,hT,hU;function hV(hW){var hX,hY;switch(hW.$==0?1:(hY=hW.$0,hY!=null&&hY.$==1?hW.$0.$0.$==0?(hX=hW.$0.$0.$1,0):(hX=hW.$1,2):(hX=hW.$1,2))){case 0:return hU===hX;case 1:return false;case 2:return hV(hX);}}return hQ.$==1?(hR=hQ.$1,(hS=hQ.$0,(hT=bX.append(hP,bX.ofArray([hS])),hS!=null&&hS.$==1&&(hS.$0.$==0&&(hU=hS.$0.$1,true))?hV(hR)?[hT,hR]:hO(hT,hR):hO(hT,hR)))):[hP,bY.Empty];}return cM.from_lgraph(hN((hJ=hO(bY.Empty,bX.concat(bX.map(function(hP){return bX.append(bX.map(function(hQ){return{$:1,$0:hQ};},hP),bX.ofArray([null]));},(hK=hM(bX.map(function(hP){return bX.map(hL,hP);},b5.to_concrete_process(hI))),hK==null?be.FailWith("this should never happen (unable to eliminate pseudoknots and/or create a fully connected graph)"):hK.$0)))),bX.append(hJ[1],hJ[0]))));};cM.dbranch_to_group=function(hI,hJ,hK,hL){return hI=="Wide"?cM.dbranch_to_group_wide(hJ,hK,hL):cM.dbranch_to_group_babylon(hJ,hK,hL);};cM.dstrand_to_group=function(hI,hJ,hK,hL,hM,hN,hO,hP,hQ){var hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0,h1,h2,h3,h4,h5,h6,h7,h8,h9,h_,h$,ia,ib,ic,id,ie,_if,ig,ih,ii,ij,ik,il,im,_in,io,ip,iq,ir,is,it;function iu(ix){return cM.make_label_text(hR,ix);}function iv(ix,iy,iz,iA,iB,iC,iD){return cM.ddomain_to_path(hI,hJ,ix,iy,iz,iA,iB,iC,iD);}function iw(ix,iy,iz,iA,iB){return cM.ddomain_to_arc(hI,hJ,ix,iy,iz,iA,iB);}hR=cw.Equals(hI,"Nucleotides");hS=hR?cM.half_separation()+cM.label_sep():cM.half_separation();hT=hQ.kind;return hT.$==1?(hU=bX.mapFold(function(ix,iy){var iz,iA,iB;iz=iy[0];iA=(iz===0&&cw.Equals(hK,{$:1,$0:gh.BottomLink})?cM.extension_length():0)+(iz===0&&hL?cM.strut_len():0);iB=(iz===hQ.domains.get_Length()-1&&cw.Equals(hM,{$:1,$0:gh.BottomLink})?cM.extension_length():0)+(iz===hQ.domains.get_Length()-1&&hN?cM.strut_len():0);return iv(function(iC){return[cS.length(iu(iC))*cM.letter_width()+cM.domain_pad(),iA,iB];},0,ix,false,iz===0&&!hO,false,iy[1]);},0,bX.mapi(function(ix,iy){return[ix,iy];},hQ.domains)),dY.New("BottomStrand "+a.String(hQ),{$:0,$0:bX.concat(hU[0])},bX.ofArray([e_.New("bl",dW.New(0,0)),e_.New("br",dW.New(hU[1],0))]),false,bY.Empty,null)):hT.$==2?(hV=cw.Equals(hK,{$:1,$0:gh.BottomLink})?cM.extension_length():0,(hW=cw.Equals(hK,{$:1,$0:gh.TopLink})?cM.extension_length():0,(hX=bX.mapFold(function(ix,iy){var iz,iA,iB;iz=iy[0];iA=iz===0&&cw.Equals(hK,{$:1,$0:gh.TopLink})?cM.extension_length():0;iB=iz===hQ.domains.get_Length()-1&&cw.Equals(hM,{$:1,$0:gh.TopLink})?cM.extension_length():0;return iv(function(iC){return[cS.length(iu(eh.New(iC.name,iC.nucleotides,iC.toehold,true,iC.tether,iC.pseudoknot)))*cM.letter_width()+cM.domain_pad(),iA,iB];},-hS,ix,true,false,iz===hQ.domains.get_Length()-1&&!hP,iy[1]);},hV,bX.mapi(function(ix,iy){return[ix,iy];},hQ.domains)),(hY=bX.mapFold(function(ix,iy){var iz,iA,iB;iz=iy[0];iA=iz===0&&cw.Equals(hK,{$:1,$0:gh.BottomLink})?cM.extension_length():0;iB=iz===hQ.domains.get_Length()-1&&cw.Equals(hM,{$:1,$0:gh.BottomLink})?cM.extension_length():0;return iv(function(iC){return[cS.length(iu(eh.New(iC.name,iC.nucleotides,iC.toehold,true,iC.tether,iC.pseudoknot)))*cM.letter_width()+cM.domain_pad(),iA,iB];},hS,ix,false,iz===0&&!hO,false,iy[1].GetComplemented());},hW,bX.mapi(function(ix,iy){return[ix,iy];},hQ.domains)),dY.New("DoubleStrand "+a.String(hQ),{$:0,$0:bX.concat(bX.append(hX[0],hY[0]))},bX.ofArray([e_.New("tl",dW.New(hV,-hS)),e_.New("tr",dW.New(hX[1],-hS)),e_.New("bl",dW.New(hW,hS)),e_.New("br",dW.New(hY[1],hS))]),false,bY.Empty,null))))):hT.$==3?(hZ=hQ.domains,hZ.$==0?(h0=go.New(hS,hS,false,false,0),(h1=dW.New(0,hS),(h2=dW.New(-hS,0),(h3=dW.New(0,-hS),dY.New("LeftHairpin "+a.String(hQ),{$:0,$0:bX.ofArray([fZ.New({$:1,$0:cM.base_class()},bX.ofArray([{$:0,$0:h1},{$:2,$0:h2,$1:h0}]),null),fZ.New({$:1,$0:cM.base_class()},bX.ofArray([{$:0,$0:h2},{$:2,$0:h3,$1:h0}]),null)])},bX.ofArray([e_.New("tr",h3),e_.New("br",h1)]),false,bY.Empty,null))))):(h4=hR?co.fold(function(ix,iy){return ix+iy.nucleotides.get_Length()*cM.letter_width()*cM.nucleotide_hairpin_factor()+cM.arc_domain_pad();},cM.arc_domain_pad(),hZ):(h5=2,(h6=hZ.get_Length(),cw.Compare(h5,h6)===1?h5:h6))*cM.letter_width()*3,(h7=h4/3.14159265358979/2,(h8=hS-cM.line_width()/2,(h9=-hC.asin(-h8/h7),(h_=2*3.14159265358979-hC.asin(h8/h7),(h$=dW.New(h7*hC.cos(h9),-h8),(ia=dW.New(h7*hC.cos(h_),h8),dY.New("LeftHairpin "+a.String(hQ),{$:0,$0:hR?(ib=(h_-h9)*h7,bX.concat((bX.mapFold(function(ix,iy){return iw(h7,ix,(iy.nucleotides.get_Length()*cM.letter_width()*cM.nucleotide_hairpin_factor()+cM.arc_domain_pad())*ib/h4/h7,iy,false);},h$,hZ))[0])):(ic=(h_-h9)/hZ.get_Length(),bX.concat((bX.mapFold(function(ix,iy){return iw(h7,ix,ic,iy,false);},h$,hZ))[0]))},bX.ofArray([e_.New("tr",dW.New(ia.x,-hS)),e_.New("br",dW.New(h$.x,hS))]),false,bY.Empty,null))))))))):hT.$==4?(id=hQ.domains,id.$==0?(ie=go.New(hS,hS,false,false,0),(_if=dW.New(0,-hS),(ig=dW.New(hS,0),(ih=dW.New(0,hS),dY.New("RightHairpin "+a.String(hQ),{$:0,$0:bX.ofArray([fZ.New({$:1,$0:cM.base_class()},bX.ofArray([{$:0,$0:_if},{$:2,$0:ig,$1:ie}]),null),fZ.New({$:1,$0:cM.base_class()},bX.ofArray([{$:0,$0:ig},{$:2,$0:ih,$1:ie}]),null)])},bX.ofArray([e_.New("tl",_if),e_.New("bl",ih)]),false,bY.Empty,null))))):(ii=hR?co.fold(function(ix,iy){return ix+iy.nucleotides.get_Length()*cM.letter_width()*cM.nucleotide_hairpin_factor()+cM.arc_domain_pad();},0,id):(ij=2,(ik=id.get_Length(),cw.Compare(ij,ik)===1?ij:ik))*cM.letter_width()*3,(il=ii/3.14159265358979/2,(im=hS-cM.line_width()/2,(_in=-3.14159265358979+hC.asin(im/il),(io=3.14159265358979+hC.asin(-im/il),(ip=dW.New(il*hC.cos(_in),im),(iq=dW.New(il*hC.cos(io),-im),dY.New("RightHairpin "+a.String(hQ),{$:0,$0:hR?(ir=(io-_in)*il,bX.concat((bX.mapFold(function(ix,iy){return iw(il,ix,(iy.nucleotides.get_Length()*cM.letter_width()*cM.nucleotide_hairpin_factor()+cM.arc_domain_pad())*ir/ii/il,iy,false);},ip,id))[0])):(is=(io-_in)/id.get_Length(),bX.concat((bX.mapFold(function(ix,iy){return iw(il,ix,is,iy,false);},ip,id))[0]))},bX.ofArray([e_.New("tl",dW.New(iq.x,-hS)),e_.New("bl",dW.New(ip.x,hS))]),false,bY.Empty,null))))))))):(it=bX.mapFold(function(ix,iy){var iz,iA,iB;iz=iy[0];iA=(iz===0&&cw.Equals(hK,{$:1,$0:gh.TopLink})?cM.extension_length():0)+(iz===0&&hL?cM.strut_len():0);iB=(iz===hQ.domains.get_Length()-1&&cw.Equals(hM,{$:1,$0:gh.TopLink})?cM.extension_length():0)+(iz===hQ.domains.get_Length()-1&&hN?cM.strut_len():0);return iv(function(iC){return[cS.length(iu(iC))*cM.letter_width()+cM.domain_pad(),iA,iB];},0,ix,true,false,iz===hQ.domains.get_Length()-1&&!hP,iy[1]);},0,bX.mapi(function(ix,iy){return[ix,iy];},hQ.domains)),dY.New("TopStrand "+a.String(hQ),{$:0,$0:bX.concat(it[0])},bX.ofArray([e_.New("tl",dW.New(0,0)),e_.New("tr",dW.New(it[1],0))]),false,bY.Empty,null));};cM.from_dsd_strand=function(hI,hJ){function hK(hL){return cM.from_dsd_domain(hI,hL);}return hJ.$==1?gl.New(gm.BottomStrand,bX.map(hK,hJ.$0)):gl.New(gm.TopStrand,bX.map(hK,hJ.$0));};cM.base_class=function(){fg.$cctor();return fg.base_class;};cM.font_size=function(){fg.$cctor();return fg.font_size;};cM.line_width=function(){fg.$cctor();return fg.line_width;};cM.short_branch_join_style=function(){fg.$cctor();return fg.short_branch_join_style;};cM.branch_join_style=function(){fg.$cctor();return fg.branch_join_style;};cM.sanitize_id=function(hI){return cS.ReplaceChar(cS.Replace(hI,"_","__"),"\'","_");};cM.dsegment_to_group=function(hI,hJ,hK,hL,hM){var hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0,h1,h2,h3,h4,h5,h6,h7,h8,h9,h_,h$,ia,ib,ic,id,ie,_if,ig,ih,ii;function ij(il,im,_in,io,ip,iq,ir){return cM.dstrand_to_group(hI,hJ,il,im,_in,io,ip,iq,ir);}function ik(il,im,_in){return cB.attach_group_to(hR,il,_in,im);}hN=hK.double_strand.domains.$===0;hO=hM.double_strand.domains.$===0;hP=hK.connection;hQ=hL.connection;hR=ij(hL.top_left!=null&&cw.Equals(hP,{$:1,$0:gh.TopLink})?null:hL.bottom_left!=null&&cw.Equals(hP,{$:1,$0:gh.BottomLink})?null:hP,false,hL.top_right!=null&&cw.Equals(hQ,{$:1,$0:gh.TopLink})?null:hL.bottom_right!=null&&cw.Equals(hQ,{$:1,$0:gh.BottomLink})?null:hQ,false,hL.bottom_left!=null||hL.hairpin_left!=null||cw.Equals(hP,{$:1,$0:gh.BottomLink})||cw.Equals(hP,{$:1,$0:gh.DoubleLink}),hL.top_right!=null||hL.hairpin_right!=null||cw.Equals(hQ,{$:1,$0:gh.TopLink})||cw.Equals(hQ,{$:1,$0:gh.DoubleLink}),hL.double_strand);hS=cw.Equals(hP,{$:1,$0:gh.DoubleLink})&&(hL.top_left!=null||hL.bottom_left!=null)&&!hN;hT=cw.Equals(hQ,{$:1,$0:gh.DoubleLink})&&(hL.top_right!=null||hL.bottom_right!=null)&&!hO;hU=((cM.bulge_lines()?hB.Curried(cM.bulge_to_group_lines,6):hB.Curried(cM.bulge_to_group_arcs,6))(hI))(hJ);hV=!hS?null:{$:1,$0:ik("tl","tr",(((hU((hW=hL.top_left,hW!=null&&hW.$==1?hW.$0.domains:bY.Empty)))(bX.head(hL.double_strand.domains)))((hX=hL.bottom_left,hX!=null&&hX.$==1?hX.$0.domains:bY.Empty)))(bX.head(hL.double_strand.domains)))};hY=!hT?null:{$:1,$0:ik("tr","tl",(((hU((hZ=hL.top_right,hZ!=null&&hZ.$==1?hZ.$0.domains:bY.Empty)))(bX.last(hL.double_strand.domains)))((h0=hL.bottom_right,h0!=null&&h0.$==1?h0.$0.domains:bY.Empty)))(bX.last(hL.double_strand.domains)))};h1=hS?null:(h2=hL.top_left,h2!=null&&h2.$==1?(h3=hL.bottom_left==null&&(cw.Equals(hP,null)||cw.Equals(hP,{$:1,$0:gh.TopLink})&&!hN),{$:1,$0:ik("tl","tr",(h4=ij(hP,false,null,hK.top_right!=null,false,true,h2.$0),h3?h4:cB.rotate_group_around_anchor("tr",cM.overhang_angle(),h4)))}):null);h5=hS?null:(h6=hL.bottom_left,h6!=null&&h6.$==1?(h7=hL.top_left==null&&(cw.Equals(hP,null)||cw.Equals(hP,{$:1,$0:gh.BottomLink})&&!hN),{$:1,$0:ik("bl","br",(h8=ij(hP,false,null,hK.bottom_right!=null,cw.Equals(hP,{$:1,$0:gh.BottomLink})||cw.Equals(hP,{$:1,$0:gh.DoubleLink}),false,h6.$0),h7?h8:cB.rotate_group_around_anchor("br",-cM.overhang_angle(),h8)))}):null);h9=hT?null:(h_=hL.top_right,h_!=null&&h_.$==1?(h$=hL.bottom_right==null&&(cw.Equals(hQ,null)||cw.Equals(hQ,{$:1,$0:gh.TopLink})&&!hO),{$:1,$0:ik("tr","tl",(ia=ij(null,hM.top_left!=null,hQ,false,false,cw.Equals(hQ,{$:1,$0:gh.TopLink})||cw.Equals(hQ,{$:1,$0:gh.DoubleLink}),h_.$0),h$?ia:cB.rotate_group_around_anchor("tl",-cM.overhang_angle(),ia)))}):null);ib=hT?null:(ic=hL.bottom_right,ic!=null&&ic.$==1?(id=hL.top_right==null&&(cw.Equals(hQ,null)||cw.Equals(hQ,{$:1,$0:gh.BottomLink})&&!hO),{$:1,$0:ik("br","bl",(ie=ij(null,hM.bottom_left!=null,hQ,false,true,false,ic.$0),id?ie:cB.rotate_group_around_anchor("bl",cM.overhang_angle(),ie)))}):null);_if=(ig=hL.hairpin_left,ig!=null&&ig.$==1?{$:1,$0:ik("tl","tr",ij(null,false,null,false,true,true,ig.$0))}:null);ih=(ii=hL.hairpin_right,ii!=null&&ii.$==1?{$:1,$0:ik("tr","tl",ij(null,false,null,false,true,true,ii.$0))}:null);return dY.New("Segment "+a.String(hL),{$:0,$0:bY.Empty},bX.choose(a.id,bX.ofArray([hL.hairpin_left!=null?null:{$:1,$0:e_.New("tl",cB.get_anchor_point("tl",hV==null?h1==null?hR:h1.$0:hV.$0))},hL.hairpin_right!=null?null:{$:1,$0:e_.New("tr",cB.get_anchor_point("tr",hY==null?h9==null?hR:h9.$0:hY.$0))},hL.hairpin_left!=null?null:{$:1,$0:e_.New("bl",cB.get_anchor_point("bl",hV==null?h5==null?hR:h5.$0:hV.$0))},hL.hairpin_right!=null?null:{$:1,$0:e_.New("br",cB.get_anchor_point("br",hY==null?ib==null?hR:ib.$0:hY.$0))}])),false,bX.choose(a.id,bX.ofArray([{$:1,$0:hR},h1,h9,h5,ib,_if,ih,hV,hY])),null);};cM.empty_dsegment=function(){fg.$cctor();return fg.empty_dsegment;};cM.debug_anchors=function(){fg.$cctor();return fg.debug_anchors;};cM.half_separation=function(){fg.$cctor();return fg.half_separation;};cM.extension_length=function(){fg.$cctor();return fg.extension_length;};cM.overhang_angle=function(){fg.$cctor();return fg.overhang_angle;};cM.from_dsd_segment=function(hI,hJ){var hK,hL,hM,hN,hO,hP,hQ,hR;function hS(hT){return cM.from_dsd_domain(hI,hT);}return hJ.$==1?(hK=hJ.$0[1],(hL=hJ.$0[2],(hM=hJ.$0[3],(hN=hJ.$0[0],hJ.$0[4].$==1?gf.New(hK.$===0?null:{$:1,$0:gl.New(gm.TopStrand,bX.map(hS,hK))},null,hN.$===0?null:{$:1,$0:gl.New(gm.BottomStrand,bX.map(hS,hN))},null,gl.New(gm.DoubleStrand,bX.map(hS,hL)),null,{$:1,$0:gl.New(gm.RightHairpinStrand,bX.map(hS,hM))},null):gf.New(null,hK.$===0?null:{$:1,$0:gl.New(gm.TopStrand,bX.map(hS,hK))},null,hN.$===0?null:{$:1,$0:gl.New(gm.BottomStrand,bX.map(hS,hN))},gl.New(gm.DoubleStrand,bX.map(hS,hL)),{$:1,$0:gl.New(gm.LeftHairpinStrand,bX.map(hS,hM))},null,null))))):(hO=hJ.$0[3],(hP=hJ.$0[1],(hQ=hJ.$0[4],(hR=hJ.$0[0],gf.New(hP.$===0?null:{$:1,$0:gl.New(gm.TopStrand,bX.map(hS,hP))},hO.$===0?null:{$:1,$0:gl.New(gm.TopStrand,bX.map(hS,hO))},hR.$===0?null:{$:1,$0:gl.New(gm.BottomStrand,bX.map(hS,hR))},hQ.$===0?null:{$:1,$0:gl.New(gm.BottomStrand,bX.map(hS,hQ))},gl.New(gm.DoubleStrand,bX.map(hS,hJ.$0[2])),null,null,null)))));};cM.origami_sep=function(){fg.$cctor();return fg.origami_sep;};cM.species_skip=function(){fg.$cctor();return fg.species_skip;};cM.letter_width=function(){fg.$cctor();return fg.letter_width;};cM.origami_round=function(){fg.$cctor();return fg.origami_round;};cM.domainc_to_domain=function(hI,hJ){var hK;return eh.New(hI.name,bY.Empty,hI.isToehold,hI.isComplementary,(hK=hI.tag,hK.$==1?{$:1,$0:"_"}:hK.$==2?{$:1,$0:hK.$0}:null),hJ);};cM.from_lgraph=function(hI){var hJ,hK,hL,hM;return hI.edges.$==0?{$:0,$0:cM.from_single_node_lgraph(hI.leading)}:(hJ=cM.iron_root_graph(hI),(hK=cM.collapse_dual_edge_nodes(cM.rotate_graph_structure(cM.collapse_single_edge_nodes(hJ))),{$:1,$0:cM.convert_to_dbranch((hL=hK.edges,hL.$==1?hL.$1.$==0?(hM=hL.$0[0],gn.New(hK.leading,bX.ofArray([[gk.New(gg.New(null,hM.gate.segments),hM.child),hL.$0[1]]]))):hJ:hJ))}));};cM.dbranch_to_group_wide=function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW;function hX(h4){return cM.dbranch_to_group_wide(hI,hJ,h4);}function hY(h4,h5){var h6,h7;h6=h5[0];h7=h5[1];return function(h8){return cM.connect_branches(hI,h4,h6,h7,h8[0],h8[1]);};}function hZ(h4){return bX.min(bX.map(function(h5){return h5.anchor_point.x;},h4.anchors));}function h0(h4){return(cB.get_anchor_point("bl",h4).y+cB.get_anchor_point("tl",h4).y)/2;}function h1(h4){return hC.abs(cB.get_anchor_point("bl",h4).y-cB.get_anchor_point("tl",h4).y);}function h2(h4,h5){return[dY.New(h4.name,h4.content,new bY({$:1,$0:e_.New("lc",dW.New(hZ(h4)-hS,h0(h4))),$1:h4.anchors}),h4.debug_anchors,h4.sub_groups,h4.offset),h5];}function h3(h4,h5){return function(h6){return function(h7){var h8,h9,h_,h$;return h7.$==1?(h8=h7.$0[1],(h9=cB.attach_group_to(h4,"rc",cB.rotate_group_around_anchor("lc",h6,h7.$0[0]),"lc"),(h_=(hY(hL,[h4,h5]))([h9,h8]),((function(ia){return h3(ia[0],ia[1]);}([dY.New(h_.name,h_.content,new bY({$:1,$0:e_.New("cc",cB.get_anchor_point("bl",h9)),$1:h_.anchors}),h_.debug_anchors,h_.sub_groups,h_.offset),h8]))(h6+hT))(h7.$1)))):(h$=cw.Equals(h5,hL)?[h4,h5]:[(hY(hL,[h4,h5]))(hU),hU[1]],[h$[0],h$[1]]);};};}hL=hK.gate;hM=[cM.dgate_to_group(hI,hJ,hL),hL];hN=bX.map(function(h4){return[hX(h4),h4.gate];},hK.children);hO=hN.get_Length()+1;hS=((hN.$===0?0:(hP=(hQ=hM[0],hC.abs(cB.get_anchor_point("br",hQ).y-cB.get_anchor_point("tr",hQ).y)),(hR=h1(bX.maxBy(h1,bX.map(function(h4){return h4[0];},hN))),cw.Compare(hP,hR)===1?hP:hR)))+1)*hO/3.14159265358979/2;hT=360/hO;hU=hN.$===0?hM:(hV=hM[0],[dY.New(hV.name,hV.content,new bY({$:1,$0:e_.New("rc",dW.New(bX.max(bX.map(function(h4){return h4.anchor_point.x;},hV.anchors))+hS,(cB.get_anchor_point("br",hV).y+cB.get_anchor_point("tr",hV).y)/2)),$1:hV.anchors}),hV.debug_anchors,hV.sub_groups,hV.offset),hM[1]]);hW=bX.map(function(h4){return h2(h4[0],h4[1]);},hN);return(((function(h4){return h3(h4[0],h4[1]);}(hU))(hT-180))(hW))[0];};cM.dbranch_to_group_babylon=function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW;function hX(h_,h$){var ia,ib;ia=h$[0];ib=h$[1];return function(ic){return cM.connect_branches(hI,h_,ia,ib,ic[0],ic[1]);};}function hY(h_){return cM.dbranch_to_group_babylon(hI,hJ,h_);}function hZ(h_,h$){return cB.norm(cw.Equals(h$,hL)?cB.anchor_to_anchor(h_,"br",h_,"tr"):cB.anchor_to_anchor(h_,"bl",h_,"tl"));}function h0(h_,h$){return 2*hC.asin(h$/h_/2);}function h1(h_){return co.sumBy(function(h$){return h0(h_,h$);},hO);}function h2(h_,h$){return function(ia){var ib,ic,id;ib=ia[0];ic=hC.abs(cw.Equals(h$,hL)?cB.get_anchor_point("tr",h_).y:cB.get_anchor_point("bl",h_).y);id=hC.abs(cw.Equals(ia[1],hL)?cB.get_anchor_point("br",ib).y:cB.get_anchor_point("tl",ib).y);return 1/((ic+id)*(ic+id));};}function h3(h_,h$){return(co.find(function(ia){var ib;ib=ia[0];return cw.Equals(ib[0],h_)&&cw.Equals(ib[1],h$);},hT))[1];}function h4(h_,h$){return hS*h3(h_,h$)/hU;}function h5(h_){var h$,ia,ib,ic,id,ie,_if,ig,ih;h$=cw.Equals(h_,hM);ia=h$?[cB.get_anchor_point("tr",h_),cB.get_anchor_point("br",h_)]:[cB.get_anchor_point("tl",h_),cB.get_anchor_point("bl",h_)];ib=ia[1];ic=ia[0];id=hC.sqrt(4*hR*hR/((ic.x-ib.x)*(ic.x-ib.x)+(ic.y-ib.y)*(ic.y-ib.y))-1)/2;ie=(ic.x+ib.x)/2+id*(ib.y-ic.y);_if=(ic.x+ib.x)/2-id*(ib.y-ic.y);ig=dW.New(ie,(ic.y+ib.y)/2-id*(ib.x-ic.x));ih=dW.New(_if,(ic.y+ib.y)/2+id*(ib.x-ic.x));return dY.New(h_.name,h_.content,new bY({$:1,$0:e_.New("cen",h$?ie>_if?ig:ih:ie>_if?ih:ig),$1:h_.anchors}),h_.debug_anchors,h_.sub_groups,h_.offset);}function h6(h_,h$){return[h5(h_),h$];}function h7(h_,h$){return[cB.attach_group_to(hV,"cen",h_,"cen"),h$];}function h8(h_,h$,ia){return function(ib){var ic,id,ie,_if,ig,ih,ii,ij,ik;ic=ib[0];id=ib[1];ie=(_if=cB.get_anchor_point("tl",ic),(ig=cB.get_anchor_point("bl",ic),cB.ang(cB.sub(dW.New((_if.x+ig.x)/2,(_if.y+ig.y)/2),cB.get_anchor_point("cen",ic)))));ih=cB.rad_to_deg(h4(h$,id));ii=hZ(h_,h$);ij=hZ(ic,id);ik=ia+cB.rad_to_deg(h0(hR,ii))/2+ih+cB.rad_to_deg(h0(hR,ij))/2;return[cB.rotate_group_around_anchor("cen",ik-ie,ic),ik];};}function h9(h_,h$){return function(ia){var ib,ic,id,ie;return ia.$==1?(ib=ia.$0[0],(ic=ia.$0[1],(id=(hX(hL,[h_,h$]))([ib,ic]),(function(_if){return h9(_if[0],_if[1]);}([dY.New(id.name,id.content,new bY({$:1,$0:e_.New("cc",cB.get_anchor_point("bl",ib)),$1:id.anchors}),id.debug_anchors,id.sub_groups,id.offset),ic]))(ia.$1)))):(ie=cw.Equals(h$,hL)?[h_,h$]:[(hX(hL,[h_,h$]))([hV,hL]),hL],[ie[0],ie[1]]);};}hL=hK.gate;hM=cM.dgate_to_group(hI,hJ,hL);return hK.children.$===0?hM:(hN=bX.map(function(h_){return[hY(h_),h_.gate];},hK.children),(hO=bX.map(function(h_){return hZ(h_[0],h_[1]);},new bY({$:1,$0:[hM,hL],$1:hN})),(hP=bX.max(hO),(hQ=hP>=co.sum(hO)/2?hP/2:function(h_){var h$,ia;while(true){h$=h_-1;if(h$<=0)return h$;else{ia=h1(h$);if(a.isNaN(ia)||ia>2*3.14159265358979)return h_;else h_=h$;}}}(hP),(hR=(hQ<=0?hP/2:hQ)+(hN.get_Length()+1)*1,(hS=3.14159265358979*2-h1(hR),(hT=bX.map(function(h_){var h$,ia,ib,ic;h$=h_[0];ia=h_[1];ib=h$[1];ic=ia[1];return[[ib,ic],(function(id){return h2(id[0],id[1]);}([h$[0],ib]))([ia[0],ic])];},(bX.mapFold(function(h_,h$){return[[h_,h$],h$];},[hM,hL],bX.append(hN,bX.ofArray([[hM,hL]]))))[0]),(hU=co.sumBy(a.snd,hT),(hV=h5(hM),(hW=bX.mapFold(function(h_,h$){var ia,ib,ic;ia=h$[1];ib=(function(id){return h8(id[0],id[1],id[2]);}(h_))([h$[0],ia]);ic=ib[0];return[[ic,ia],[ic,ia,ib[1]]];},[hV,hL,-180],bX.map(function(h_){return h7(h_[0],h_[1]);},bX.map(function(h_){return h6(h_[0],h_[1]);},hN))),((function(h_){return h9(h_[0],h_[1]);}([hV,hL]))(hW[0]))[0]))))))))));};cM.make_label_text=function(hI,hJ){var hK,hL;hK=hJ.tether;return hK!=null&&hK.$==1?hK.$0:(hJ.complemented&&!hI?(hI?ef.string_of_sequence(hJ.nucleotides):hJ.name)+"*":hI?ef.string_of_sequence(hJ.nucleotides):hJ.name)+(hL=hJ.pseudoknot,hL==null?"":"!"+a.String(hL.$0));};cM.ddomain_to_path=function(hI,hJ,hK,hL,hM,hN,hO,hP,hQ){var hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0,h1,h2;hR=cw.Equals(hI,"Nucleotides");hS=hR?cM.label_baseline_nucleotides():cM.label_baseline();hT=cM.get_domain_class(hR,hQ);hU=hK(hQ);hV=hU[1];hW=hU[0];hX=hW+hV+hU[2];hY=hP?bX.append(bX.append(hO?bX.ofArray([{$:0,$0:dW.New(hM-cM.margin()+hC.cos(cM.arrow_angle())*cM.arrow_length(),hL+hC.sin(cM.arrow_angle())*cM.arrow_length())},{$:1,$0:dW.New(hM,hL)}]):bX.ofArray([{$:0,$0:dW.New(hM-cM.margin(),hL)}]),bX.ofArray([{$:1,$0:dW.New(hM+hX+cM.margin(),hL)}])),bX.ofArray([{$:1,$0:dW.New(hM+hX+cM.margin()-hC.cos(cM.arrow_angle())*cM.arrow_length(),hL-hC.sin(cM.arrow_angle())*cM.arrow_length())}])):bX.append(hO?bX.ofArray([{$:0,$0:dW.New(hM-cM.margin()+hC.cos(cM.arrow_angle())*cM.arrow_length(),hL+hC.sin(cM.arrow_angle())*cM.arrow_length())},{$:1,$0:dW.New(hM,hL)}]):bX.ofArray([{$:0,$0:dW.New(hM-cM.margin(),hL)}]),bX.ofArray([{$:1,$0:dW.New(hM+hX+cM.margin(),hL)}]));hZ=!hR&&hJ||hR&&!hN;h0=dW.New(hR?hM+hW/2+hV:hM+hX/2,hR?hL+(hN?hZ?cM.label_sep_rotated():cM.label_sep():-hS-(hZ?cM.label_sep_rotated():cM.label_sep())):hL+(hZ?0:hS)+(hN?-(hZ?cM.label_sep_rotated():cM.label_sep()):hZ?cM.label_sep_rotated():cM.label_sep()));h1=fZ.New({$:1,$0:hT},hY,{$:1,$0:f0.New(cM.make_label_text(hR,hQ),h0,{$:1,$0:hT},hQ.pseudoknot!=null?cM.pseudoknot_letter_width():cM.letter_width(),cB.translate_point_by(dW.New(hR&&hN||!hR&&(hN||!hJ)?10:-10,0),h0))});return hQ.tether!=null?(h2=dW.New(hM+hX/2,hL),[bX.ofArray([h1,fZ.New({$:1,$0:cM.base_class()+" tether-pin"},bX.ofArray([{$:0,$0:cB.translate_point_by(dW.New(0,3),h2)},{$:2,$0:cB.translate_point_by(dW.New(0,-3),h2),$1:go.New(3,3,true,false,0)},{$:2,$0:cB.translate_point_by(dW.New(0,3),h2),$1:go.New(3,3,true,false,0)}]),null)]),hM+hX]):[bX.ofArray([h1]),hM+hX];};cM.ddomain_to_arc=function(hI,hJ,hK,hL,hM,hN,hO){var hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0,h1,h2,h3,h4,h5,h6,h7,h8,h9,h_,h$,ia,ib;hP=cw.Equals(hI,"Nucleotides");hQ=hP?cM.label_baseline_nucleotides():cM.label_baseline();hR=cM.get_domain_class(hP,hN);hS=hL.x<0?3.14159265358979-hC.asin(-hL.y/hK):hC.asin(-hL.y/hK);hT=hS+hM;hU=dW.New(hK*hC.cos(hT),-hK*hC.sin(hT));hV=go.New(hK,hK,hM>3.14159265358979||hM<-3.14159265358979,hO,0);hW=cM.make_label_text(hP,hN);hX=hP?(hY=cM.arc_domain_pad()/hK/2,(hZ=(hM>0?hM-2*hY:hM+2*hY)/hW.length,(h0=hT-hY-hZ/2,(h1=bX.ofSeq(co.mapi(function(ic,id){var ie,_if,ig,ih;ie=hK-cM.label_sep();_if=h0-hZ*ic;ig=dW.New(ie*hC.cos(_if),-ie*hC.sin(_if));ih=cB.translate_point_by(dW.New(10*hC.cos(_if-3.14159265358979/2),-10*hC.sin(_if-3.14159265358979/2)),ig);return fZ.New(null,bY.Empty,{$:1,$0:f0.New(id,ig,{$:1,$0:hR},cM.letter_width(),ih)});},hW)),new bY({$:1,$0:fZ.New({$:1,$0:hR},bX.ofArray([{$:0,$0:hL},{$:2,$0:hU,$1:hV}]),null),$1:h1}))))):(h2=hJ?cM.label_sep_rotated():cM.label_sep(),(h3=hS+hM/2,(h4=hK+h2,(h5=hJ?(h6=dW.New(h4*hC.cos(h3),-h4*hC.sin(h3)),[h6,cB.rotate_point_around(h6,90,dW.New((h4+10)*hC.cos(h3),-(h4+10)*hC.sin(h3)))]):(h7=cM.letter_width()*(hW.length-1)/2,(h8=hC.cos(h3)>0?h7:-h7,(h9=hC.abs(h4*hC.sin(h3))>hK+h2/2?0:h8,(h_=dW.New(h4*hC.cos(h3)+h9,-h4*hC.sin(h3)+hQ),[h_,cB.translate_point_by(dW.New(10,0),h_)])))),(h$=f0.New(hW,h5[0],{$:1,$0:hR},hN.pseudoknot!=null?cM.pseudoknot_letter_width():cM.letter_width(),h5[1]),bX.ofArray([fZ.New({$:1,$0:hR},bX.ofArray([{$:0,$0:hL},{$:2,$0:hU,$1:hV}]),{$:1,$0:h$})]))))));return hN.tether!=null?(ia=(hS+hT)/2,(ib=dW.New(hK*hC.cos(ia),-hK*hC.sin(ia)),[new bY({$:1,$0:fZ.New({$:1,$0:cM.base_class()+" tether-pin"},bX.ofArray([{$:0,$0:cB.translate_point_by(dW.New(0,3),ib)},{$:2,$0:cB.translate_point_by(dW.New(0,-3),ib),$1:go.New(3,3,true,false,0)},{$:2,$0:cB.translate_point_by(dW.New(0,3),ib),$1:go.New(3,3,true,false,0)}]),null),$1:hX}),hU])):[hX,hU];};cM.label_sep=function(){fg.$cctor();return fg.label_sep;};cM.domain_pad=function(){fg.$cctor();return fg.domain_pad;};cM.strut_len=function(){fg.$cctor();return fg.strut_len;};cM.nucleotide_hairpin_factor=function(){fg.$cctor();return fg.nucleotide_hairpin_factor;};cM.arc_domain_pad=function(){fg.$cctor();return fg.arc_domain_pad;};cM.empty_dstrand=function(){fg.$cctor();return fg.empty_dstrand;};cM.bulge_lines=function(){fg.$cctor();return fg.bulge_lines;};cM.bulge_to_group_lines=function(hI,hJ,hK,hL,hM,hN){var hO,hP,hQ;function hR(hV,hW,hX,hY,hZ,h0,h1){return cM.ddomain_to_path(hI,hJ,hV,hW,hX,hY,hZ,h0,h1);}function hS(hV){return(hV.name.length+(hV.complemented?1:0))*cM.letter_width()+cM.domain_pad();}function hT(hV){return[hS(hV)*hQ/hO,0,0];}function hU(hV){return[hS(hV)*hQ/hP,0,0];}hO=co.sumBy(hS,hK);hP=co.sumBy(hS,hM);hQ=cw.Compare(hO,hP)===1?hO:hP;return dY.New("Bulge",{$:0,$0:bX.append(hK.$==0?bX.ofArray([fZ.New({$:1,$0:cM.base_class()+" "+cM.dom_id(hL)},bX.ofArray([{$:0,$0:dW.New(0,-cM.half_separation())},{$:1,$0:dW.New(cM.bulge_sep(),-cM.half_separation()-cM.bulge_sep())},{$:1,$0:dW.New(cM.bulge_sep()+hQ,-cM.half_separation()-cM.bulge_sep())},{$:1,$0:dW.New(cM.bulge_sep()+cM.bulge_sep()+hQ,-cM.half_separation())}]),null)]):bX.ofArray([fZ.New({$:1,$0:cM.base_class()+" "+cM.dom_id(bX.head(hK))},bX.ofArray([{$:0,$0:dW.New(0,-cM.half_separation())},{$:1,$0:dW.New(cM.bulge_sep(),-cM.half_separation()-cM.bulge_sep())}]),null),fZ.New({$:1,$0:cM.base_class()+" "+cM.dom_id(bX.head(bX.rev(hK)))},bX.ofArray([{$:0,$0:dW.New(cM.bulge_sep()+hQ,-cM.half_separation()-cM.bulge_sep())},{$:1,$0:dW.New(cM.bulge_sep()+cM.bulge_sep()+hQ,-cM.half_separation())}]),null)]),bX.append(hM.$==0?bX.ofArray([fZ.New({$:1,$0:cM.base_class()+" "+cM.dom_id(hN)},bX.ofArray([{$:0,$0:dW.New(0,cM.half_separation())},{$:1,$0:dW.New(cM.bulge_sep(),cM.half_separation()+cM.bulge_sep())},{$:1,$0:dW.New(cM.bulge_sep()+hQ,cM.half_separation()+cM.bulge_sep())},{$:1,$0:dW.New(cM.bulge_sep()+cM.bulge_sep()+hQ,cM.half_separation())}]),null)]):bX.ofArray([fZ.New({$:1,$0:cM.base_class()+" "+cM.dom_id(bX.head(hM))},bX.ofArray([{$:0,$0:dW.New(0,cM.half_separation())},{$:1,$0:dW.New(cM.bulge_sep(),cM.half_separation()+cM.bulge_sep())}]),null),fZ.New({$:1,$0:cM.base_class()+" "+cM.dom_id(bX.head(bX.rev(hM)))},bX.ofArray([{$:0,$0:dW.New(cM.bulge_sep()+hQ,cM.half_separation()+cM.bulge_sep())},{$:1,$0:dW.New(cM.bulge_sep()+cM.bulge_sep()+hQ,cM.half_separation())}]),null)]),bX.append(bX.concat((bX.mapFold(function(hV,hW){return hR(hT,-cM.half_separation()-cM.bulge_sep(),hV,true,false,false,hW);},cM.bulge_sep(),hK))[0]),bX.concat((bX.mapFold(function(hV,hW){return hR(hU,cM.half_separation()+cM.bulge_sep(),hV,false,false,false,hW);},cM.bulge_sep(),hM))[0]))))},bX.ofArray([e_.New("bl",dW.New(0,cM.half_separation())),e_.New("tl",dW.New(0,-cM.half_separation())),e_.New("tr",dW.New(hQ+cM.bulge_sep()+cM.bulge_sep(),-cM.half_separation())),e_.New("br",dW.New(hQ+cM.bulge_sep()+cM.bulge_sep(),cM.half_separation()))]),false,bY.Empty,null);};cM.bulge_to_group_arcs=function(hI,hJ,hK,hL,hM,hN){var hO,hP,hQ,hR,hS,hT,hU,hV,hW;function hX(hY,hZ,h0,h1,h2){return cM.ddomain_to_arc(hI,hJ,hY,hZ,h0,h1,h2);}hO=(hP=2,(hQ=(hR=hK.get_Length(),(hS=hM.get_Length(),cw.Compare(hR,hS)===1?hR:hS)),cw.Compare(hP,hQ)===1?hP:hQ))*cM.letter_width()*3/3.14159265358979;hT=3.14159265358979-hC.asin(cM.half_separation()/hO);hU=hC.asin(cM.half_separation()/hO);hV=(hU-hT)/hK.get_Length();hW=(hU-hT)/hM.get_Length();return dY.New("Bulge",{$:0,$0:bX.append(hK.$==0?bX.ofArray([fZ.New({$:1,$0:cM.base_class()+" "+cM.dom_id(hL)},bX.ofArray([{$:0,$0:dW.New(-hO,-cM.half_separation())},{$:1,$0:dW.New(hO,-cM.half_separation())}]),null)]):bX.concat((bX.mapFold(function(hY,hZ){return hX(hO,hY,hV,hZ,true);},dW.New(-hO,-cM.half_separation()),hK))[0]),hM.$==0?bX.ofArray([fZ.New({$:1,$0:cM.base_class()+" "+cM.dom_id(hN)},bX.ofArray([{$:0,$0:dW.New(-hO,cM.half_separation())},{$:1,$0:dW.New(hO,cM.half_separation())}]),null)]):bX.concat((bX.mapFold(function(hY,hZ){return hX(hO,hY,hW,hZ,true);},dW.New(hO,cM.half_separation()),bX.rev(hM)))[0]))},bX.ofArray([e_.New("bl",dW.New(-hO,cM.half_separation())),e_.New("tl",dW.New(-hO,-cM.half_separation())),e_.New("tr",dW.New(hO,-cM.half_separation())),e_.New("br",dW.New(hO,cM.half_separation()))]),false,bY.Empty,null);};cM.from_single_node_lgraph=function(hI){var hJ;hJ=bX.map(function(hK){var hL;hL=hK.$==2?[hK.$0,{$:1,$0:hK.$1}]:hK.$==1?[hK.$0,null]:[hK.$0,null];return cM.domainc_to_domain(hL[0],hL[1]);},bX.choose(a.id,hI));return hJ.get_Length()!==hI.get_Length()-1?be.FailWith("Error: root node is a split leaf"):gl.New(gm.TopStrand,hJ);};cM.iron_root_graph=function(hI){var hJ,hK,hL,hM,hN,hO,hP,hQ;function hR(hW,hX){var hY,hZ;function h0(h1,h2){var h3,h4,h5,h6,h7,h8,h9,h_,h$,ia,ib,ic,id,ie;while(true){id=bX.rev(h1);if(id.$==1){if(id.$0==null)h3=null;else{ie=id.$0;switch(ie!=null&&ie.$==1?ie.$0.$==1?(h5=ie.$0.$0,0):ie.$0.$==2?(h5=[ie.$0.$0,ie.$0.$1],1):2:2){case 0:h4=cM.domainc_to_domain(h5,null);break;case 1:h4=cM.domainc_to_domain(h5[0],{$:1,$0:h5[1]});break;case 2:h4=be.FailWith("this should never happen (bound domain in a node)");break;}h3={$:1,$0:[bX.rev(id.$1),gk.New((h6=h2.gate.segments,h6.$==1?(h7=h6.$0,h8=(h9=h7.top_left,h9!=null&&h9.$==1?h9.$0:gl.New(gm.TopStrand,bY.Empty)),gg.New(h2.gate.left_connection,new bY({$:1,$0:gf.New({$:1,$0:gl.New(h8.kind,new bY({$:1,$0:h4,$1:h8.domains}))},h7.top_right,h7.bottom_left,h7.bottom_right,h7.double_strand,h7.hairpin_left,h7.hairpin_right,h7.connection),$1:h6.$1}))):be.FailWith("this should never happen (empty edge gate)")),h2.child)]};}}else h3=null;if(h3!=null&&h3.$==1){h1=h3.$0[0];h2=h3.$0[1];}else{h_=h1.$===0;h$=(ia=h2.gate.left_connection,(ia!=null&&ia.$==1?ia.$0.$==1?false:ia.$0.$!=2:true)?h_?{$:1,$0:gh.TopLink}:null:h_?{$:1,$0:gh.DoubleLink}:{$:1,$0:gh.BottomLink});ic=hR(h2.child.leading,h2.child.edges);return[h1,gk.New(gg.New(h$,h2.gate.segments),gn.New(ic[0],ic[1]))];}}}hY=bX.mapFold(function(h1,h2){return[[h1,h2[0]],h2[1]];},hW,hX);hZ=bX.mapFoldBack(function(h1,h2){return(function(h3){var h4,h5;h4=h3[0];h5=h3[1];return function(h6){return[[h5,h6],h4];};}(h1))(h2);},bX.map(function(h1){return h0(h1[0],h1[1]);},hY[0]),hY[1]);return[hZ[1],hZ[0]];}function hS(hW,hX){function hY(hZ,h0){var h1,h2,h3,h4,h5,h6,h7,h8,h9,h_,h$,ia,ib;while(true){if(hZ.$==1){if(hZ.$0==null)h1=null;else{ib=hZ.$0;switch(ib!=null&&ib.$==1?ib.$0.$==1?(h3=ib.$0.$0,0):ib.$0.$==2?(h3=[ib.$0.$0,ib.$0.$1],1):2:2){case 0:h2=cM.domainc_to_domain(h3,null);break;case 1:h2=cM.domainc_to_domain(h3[0],{$:1,$0:h3[1]});break;case 2:h2=be.FailWith("this should never happen (bound domain in a node)");break;}h1={$:1,$0:[gk.New((h4=h0.gate.segments,h4.$==1?(h5=h4.$0,h6=(h7=h5.bottom_left,h7!=null&&h7.$==1?h7.$0:gl.New(gm.BottomStrand,bY.Empty)),gg.New(h0.gate.left_connection,new bY({$:1,$0:gf.New(h5.top_left,h5.top_right,{$:1,$0:gl.New(h6.kind,new bY({$:1,$0:h2,$1:h6.domains}))},h5.bottom_right,h5.double_strand,h5.hairpin_left,h5.hairpin_right,h5.connection),$1:h4.$1}))):be.FailWith("this should never happen (empty edge gate)")),h0.child),hZ.$1]};}}else h1=null;if(h1!=null&&h1.$==1){hZ=h1.$0[1];h0=h1.$0[0];}else{h8=hZ.$===0;h9=(h_=h0.gate.left_connection,(h_!=null&&h_.$==1?h_.$0.$==0?false:h_.$0.$!=2:true)?h8?{$:1,$0:gh.BottomLink}:null:h8?{$:1,$0:gh.DoubleLink}:{$:1,$0:gh.TopLink});ia=hS(h0.child.leading,h0.child.edges);return[gk.New(gg.New(h9,h0.gate.segments),gn.New(ia[0],ia[1])),hZ];}}}return[hW,bX.map(function(hZ){return hY(hZ[1],hZ[0]);},hX)];}function hT(hW){var hX,hY,hZ,h0,h1,h2,h3,h4,h5,h6,h7,h8,h9,h_;while(true){h9=hW.child.leading;if(h9.$==1){if(h9.$0==null)hX=null;else{h_=h9.$0;switch(h_!=null&&h_.$==1?h_.$0.$==1?(hZ=h_.$0.$0,0):h_.$0.$==2?(hZ=[h_.$0.$0,h_.$0.$1],1):2:2){case 0:hY=cM.domainc_to_domain(hZ,null);break;case 1:hY=cM.domainc_to_domain(hZ[0],{$:1,$0:hZ[1]});break;case 2:hY=be.FailWith("this should never happen (bound domain in a node)");break;}hX={$:1,$0:gk.New((h0=bX.rev(hW.gate.segments),h0.$==1?(h1=h0.$0,h2=(h3=h1.top_right,h3!=null&&h3.$==1?h3.$0:gl.New(gm.TopStrand,bY.Empty)),gg.New(hW.gate.left_connection,bX.rev(new bY({$:1,$0:gf.New(h1.top_left,{$:1,$0:gl.New(h2.kind,bX.append(h2.domains,bX.ofArray([hY])))},h1.bottom_left,h1.bottom_right,h1.double_strand,h1.hairpin_left,h1.hairpin_right,h1.connection),$1:h0.$1})))):be.FailWith("this should never happen (empty edge gate)")),gn.New(h9.$1,hW.child.edges))};}}else hX=null;if(hX!=null&&hX.$==1)hW=hX.$0;else{h4=hW.child.leading.$===0;h5=bX.rev(hW.gate.segments);return h5.$==1?(h6=h5.$0,gk.New(gg.New(hW.gate.left_connection,bX.rev(new bY({$:1,$0:gf.New(h6.top_left,h6.top_right,h6.bottom_left,h6.bottom_right,h6.double_strand,h6.hairpin_left,h6.hairpin_right,(h7=h6.connection,(h7!=null&&h7.$==1?h7.$0.$==1?false:h7.$0.$!=2:true)?h4?{$:1,$0:gh.TopLink}:null:h4?{$:1,$0:gh.DoubleLink}:{$:1,$0:gh.BottomLink})),$1:h5.$1}))),hW.child)):be.FailWith("this should never happen (empty edge gate)");}}}function hU(hW){var hX,hY,hZ,h0,h1,h2,h3,h4,h5,h6,h7,h8,h9,h_,h$,ia,ib,ic,id,ie,_if,ig,ih,ii;while(true){ie=bX.rev(hW.child.edges);if(ie.$==1){_if=bX.rev(ie.$0[1]);if(_if.$==1){if(_if.$0==null)hX=null;else{ig=_if.$0;switch(ig!=null&&ig.$==1?ig.$0.$==1?(hZ=ig.$0.$0,0):ig.$0.$==2?(hZ=[ig.$0.$0,ig.$0.$1],1):2:2){case 0:hY=cM.domainc_to_domain(hZ,null);break;case 1:hY=cM.domainc_to_domain(hZ[0],{$:1,$0:hZ[1]});break;case 2:hY=be.FailWith("this should never happen (bound domain in a node)");break;}hX={$:1,$0:gk.New((h0=bX.rev(hW.gate.segments),h0.$==1?(h1=h0.$0,h2=(h3=h1.bottom_right,h3!=null&&h3.$==1?h3.$0:gl.New(gm.BottomStrand,bY.Empty)),gg.New(hW.gate.left_connection,bX.rev(new bY({$:1,$0:gf.New(h1.top_left,h1.top_right,h1.bottom_left,{$:1,$0:gl.New(h2.kind,bX.append(h2.domains,bX.ofArray([hY])))},h1.double_strand,h1.hairpin_left,h1.hairpin_right,h1.connection),$1:h0.$1})))):be.FailWith("this should never happen (empty edge gate)")),gn.New(hW.child.leading,bX.rev(new bY({$:1,$0:[ie.$0[0],bX.rev(_if.$1)],$1:ie.$1}))))};}}else hX=null;}else{ih=bX.rev(hW.child.leading);if(ih.$==1){if(ih.$0==null)hX=null;else{ii=ih.$0;switch(ii!=null&&ii.$==1?ii.$0.$==1?(h5=ii.$0.$0,0):ii.$0.$==2?(h5=[ii.$0.$0,ii.$0.$1],1):2:2){case 0:h4=cM.domainc_to_domain(h5,null);break;case 1:h4=cM.domainc_to_domain(h5[0],{$:1,$0:h5[1]});break;case 2:h4=be.FailWith("this should never happen (bound domain in a node)");break;}hX={$:1,$0:gk.New((h6=bX.rev(hW.gate.segments),h6.$==1?(h7=h6.$0,h8=(h9=h7.bottom_right,h9!=null&&h9.$==1?h9.$0:gl.New(gm.BottomStrand,bY.Empty)),gg.New(hW.gate.left_connection,bX.rev(new bY({$:1,$0:gf.New(h7.top_left,h7.top_right,h7.bottom_left,{$:1,$0:gl.New(h8.kind,bX.append(h8.domains,bX.ofArray([h4])))},h7.double_strand,h7.hairpin_left,h7.hairpin_right,h7.connection),$1:h6.$1})))):be.FailWith("this should never happen (empty edge gate)")),gn.New(bX.rev(ih.$1),bY.Empty))};}}else hX=null;}if(hX!=null&&hX.$==1)hW=hX.$0;else{h_=(h$=bX.rev(hW.child.edges),h$.$==1?h$.$0[1].$===0:hW.child.leading.$===0);ia=bX.rev(hW.gate.segments);return ia.$==1?(ib=ia.$0,gk.New(gg.New(hW.gate.left_connection,bX.rev(new bY({$:1,$0:gf.New(ib.top_left,ib.top_right,ib.bottom_left,ib.bottom_right,ib.double_strand,ib.hairpin_left,ib.hairpin_right,(ic=ib.connection,(ic!=null&&ic.$==1?ic.$0.$==0?false:ic.$0.$!=2:true)?h_?{$:1,$0:gh.BottomLink}:null:h_?{$:1,$0:gh.DoubleLink}:{$:1,$0:gh.TopLink})),$1:ia.$1}))),hW.child)):be.FailWith("this should never happen (empty edge gate)");}}}function hV(hW){var hX,hY;hX=hR(hW.leading,hW.edges);hY=hS(hX[0],hX[1]);return gn.New(hY[0],bX.map(function(hZ){var h0;h0=hZ[0];return[gk.New(h0.gate,hV(h0.child)),hZ[1]];},bX.map(function(hZ){return[hU(hZ[0]),hZ[1]];},bX.map(function(hZ){return[hT(hZ[0]),hZ[1]];},hY[1]))));}hJ=(hK=hI.edges,hK.$==1&&(hK.$1.$==0&&(hL=[hK.$0[0],hK.$0[1]],true))?[hL[0],hL[1]]:be.FailWith("root node does not have 1 edge"));hM=hR(bX.append(hJ[1],hI.leading),bX.ofArray([[hJ[0],bY.Empty]]));hN=hM[1];hO=hN.$==1&&(hN.$1.$==0&&(hP=[hN.$0[0],hN.$0[1]],true))?[hP[0],hP[1]]:be.FailWith("root node does not have 1 edge");hQ=hS(bY.Empty,bX.ofArray([[hO[0],bX.append(hO[1],hM[0])]]));return gn.New(hQ[0],bX.map(function(hW){var hX;hX=hW[0];return[gk.New(hX.gate,hV(hX.child)),hW[1]];},bX.map(function(hW){return[hU(hW[0]),hW[1]];},bX.map(function(hW){return[hT(hW[0]),hW[1]];},hQ[1]))));};cM.collapse_dual_edge_nodes=function(hI){function hJ(hK){var hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX;hN=hK.child.edges;if(hN.$==1&&(hN.$1.$==0&&(hL=[hN.$0[0],hN.$0[1]],true))){hO=hL[0];hP=bX.rev(hK.gate.segments);if(hP.$==0)return be.FailWith("this should never happen (empty dgate)");else{hQ=hP.$1;hR=hP.$0;hS=hO.gate.segments;if(hS.$==0)return be.FailWith("this should never happen (empty dgate)");else{hT=hS.$0;hU=hK.child.leading;hV=hL[1];switch(hU.$==0?hV.$==0?2:hV.$0==null?hV.$1.$==0?1:3:3:hU.$0==null?hU.$1.$==0?hV.$==0?0:3:3:3){case 0:return hJ(gk.New(gg.New(hK.gate.left_connection,bX.append(bX.append(bX.rev(hQ),bX.ofArray([gf.New(hR.top_left,hR.top_right,hR.bottom_left,hR.bottom_right,hR.double_strand,hR.hairpin_left,hR.hairpin_right,{$:1,$0:gh.BottomLink})])),hO.gate.segments)),hO.child));case 1:return hJ(gk.New(gg.New(hK.gate.left_connection,bX.append(bX.append(bX.rev(hQ),bX.ofArray([gf.New(hR.top_left,hR.top_right,hR.bottom_left,hR.bottom_right,hR.double_strand,hR.hairpin_left,hR.hairpin_right,{$:1,$0:gh.TopLink})])),hO.gate.segments)),hO.child));case 2:return hR.top_right==null&&(hR.bottom_right==null&&(hT.top_left==null&&hT.bottom_left==null))?(hX=gf.New(hR.top_left,hT.top_right,hR.bottom_left,hT.bottom_right,gl.New(gm.DoubleStrand,bX.append(hR.double_strand.domains,hT.double_strand.domains)),hR.hairpin_left,hT.hairpin_right,hT.connection),hJ(gk.New(gg.New(hK.gate.left_connection,bX.append(bX.append(bX.rev(hQ),bX.ofArray([hX])),hS.$1)),hO.child))):hJ(gk.New(gg.New(hK.gate.left_connection,bX.append(bX.append(bX.rev(hQ),bX.ofArray([gf.New(hR.top_left,hR.top_right,hR.bottom_left,hR.bottom_right,hR.double_strand,hR.hairpin_left,hR.hairpin_right,{$:1,$0:gh.DoubleLink})])),hO.gate.segments)),hO.child));case 3:return be.FailWith("this should never happen (unexpected dual-edge node content)");}}}}else return gk.New(hK.gate,cM.collapse_dual_edge_nodes(hK.child));}return gn.New(hI.leading,bX.map(function(hK){return[hJ(hK[0]),hK[1]];},hI.edges));};cM.convert_to_dbranch=function(hI){var hJ,hK;function hL(hM){return gi.New(hM.gate,bX.map(function(hN){return hL(hN[0]);},hM.child.edges));}hJ=hI.edges;return hJ.$==1&&(hJ.$1.$==0&&(hK=[hJ.$0[0],hJ.$0[1]],true))?hL(hK[0]):be.FailWith("this should never happen (root node is not a leaf)");};cM.rotate_graph_structure=function(hI){var hJ;hJ=hI.edges;return hJ.$==1?hJ.$1.$==1?be.FailWith("graph root is not a leaf node"):hI:hI;};cM.collapse_single_edge_nodes=function(hI){var hJ,hK,hL,hN,hO,hP,hQ,hR,hS,hT;function hM(hU){var hV,hW,hX,hY,hZ,h0,h1;hW=hU.child;if(hW.edges.$==0){hX=hW.leading;switch(hX.$==0?1:hX.$0==null?hX.$1.$==0?0:2:2){case 0:return gk.New(hU.gate,gn.New(bY.Empty,bY.Empty));case 1:hY=bX.rev(hU.gate.segments);return hY.$==1?(hZ=hY.$0,gk.New(gg.New(hU.gate.left_connection,bX.rev(new bY({$:1,$0:gf.New(hZ.top_left,null,hZ.bottom_left,null,hZ.double_strand,hZ.hairpin_left,{$:1,$0:gl.New(gm.RightHairpinStrand,bX.append(bX.rev((h0=hZ.top_right,h0!=null&&h0.$==1?h0.$0.domains:bY.Empty)),(h1=hZ.bottom_right,h1!=null&&h1.$==1?h1.$0.domains:bY.Empty)))},null),$1:hY.$1}))),gn.New(bY.Empty,bY.Empty))):be.FailWith("this should never happen (empty dgate)");case 2:return be.FailWith("this should never happen (domain found on a node during collapse)");}}else return gk.New(hU.gate,gn.New(hW.leading,bX.map(function(h2){return[hM(h2[0]),h2[1]];},hW.edges)));}if(hI.edges.$==1?hI.edges.$1.$==0?(hK=[hI.edges.$0[0],hI.leading,hI.edges.$0[1]],true):(hK=[hI.edges,hI.leading],false):(hK=[hI.edges,hI.leading],false)){hN=hK[0];hO=hK[2];hP=bX.append(hK[1],hO);switch(hP.$==0?1:hP.$0==null?hP.$1.$==0?0:2:2){case 0:hJ=gn.New(bY.Empty,bX.ofArray([[hM(hN),hO]]));break;case 1:hJ=(hQ=hN.gate.segments,hQ.$==1?(hR=hQ.$0,gn.New(bY.Empty,bX.ofArray([[hM(gk.New(gg.New(hN.gate.left_connection,new bY({$:1,$0:gf.New(null,hR.top_right,null,hR.bottom_right,hR.double_strand,{$:1,$0:gl.New(gm.LeftHairpinStrand,bX.append((hS=hR.bottom_left,hS!=null&&hS.$==1?hS.$0.domains:bY.Empty),bX.rev((hT=hR.top_left,hT!=null&&hT.$==1?hT.$0.domains:bY.Empty))))},hR.hairpin_right,hR.connection),$1:hQ.$1})),hN.child)),hO]]))):be.FailWith("this should never happen (empty dgate)"));break;case 2:hJ=be.FailWith("this should never happen (domain found on a node during collapse)");break;}}else hJ=gn.New(hK[1],bX.map(function(hU){return[hM(hU[0]),hU[1]];},hK[0]));return hJ;};cM.connect_branches=function(hI,hJ,hK,hL,hM,hN){var hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0,h1,h2,h3,h4,h5,h6,h7,h8,h9,h_,h$,ia,ib,ic,id,ie,_if,ig,ih,ii;function ij(_in){return cM.get_domain_class(hO,_in);}function ik(_in){var io,ip;io=bX.head(_in.segments);ip=io.top_left;return ip==null?[bX.head(io.double_strand.domains),false]:[bX.head(ip.$0.domains),true];}function il(_in){var io,ip;io=bX.head(_in.segments);ip=io.bottom_left;return ip==null?[bX.head(io.double_strand.domains),false]:[bX.head(ip.$0.domains),true];}function im(_in,io,ip){return function(iq){var ir,is,it,iu,iv;ir=iq[2];is=cB.get_anchor_point(_in,io);it=cB.get_anchor_point(iq[0],iq[1]);iu=hC.sqrt((is.x-it.x)*(is.x-it.x)+(is.y-it.y)*(is.y-it.y))<cM.short_branch_join()?" shortbranchjoin":" branchjoin";return ip===ir?bX.ofArray([fZ.New({$:1,$0:ip+iu},bX.ofArray([{$:0,$0:is},{$:1,$0:it}]),null)]):(iv=dW.New((is.x+it.x)/2,(is.y+it.y)/2),bX.ofArray([fZ.New({$:1,$0:ip+iu},bX.ofArray([{$:0,$0:is},{$:1,$0:iv}]),null),fZ.New({$:1,$0:ir+iu},bX.ofArray([{$:0,$0:iv},{$:1,$0:it}]),null)]));};}hO=cw.Equals(hI,"Nucleotides");hP="cc";return cw.Equals(hL,hJ)?(hQ=hN.left_connection,hQ==null||(hQ.$0.$==0?false:hQ.$0.$!=2)?dY.New(hK.name,hK.content,hK.anchors,hK.debug_anchors,new bY({$:1,$0:hM,$1:hK.sub_groups}),hK.offset):(hS=(hT=bX.last(hL.segments),(hU=hT.top_right,hU==null?[bX.last(hT.double_strand.domains),false]:[bX.last(hU.$0.domains),true])),hV=hS[0],ij(hV),hW=ik(hN),hX=hW[0],ij(hX),hY=cM.base_class(),hZ=cM.base_class(),dY.New(hK.name,hK.content,hK.anchors,hK.debug_anchors,new bY({$:1,$0:hM,$1:new bY({$:1,$0:(h0=cB.content_group({$:0,$0:(function(_in){return im(_in[0],_in[1],_in[2]);}(["tr",hK,hY]))(["tl",hM,hZ])}),dY.New("Connector",h0.content,h0.anchors,h0.debug_anchors,h0.sub_groups,h0.offset)),$1:hK.sub_groups})}),hK.offset))):cw.Equals(hN,hJ)?(h1=bX.last(hN.segments).connection,h1==null||(h1.$0.$==1?false:h1.$0.$!=2)?dY.New(hK.name,hK.content,hK.anchors,hK.debug_anchors,hK.sub_groups,hK.offset):(h3=il(hL),h4=h3[0],ij(h4),h5=(h6=bX.last(hN.segments),(h7=h6.bottom_right,h7==null?[bX.last(h6.double_strand.domains),false]:[bX.last(h7.$0.domains),true])),h8=h5[0],ij(h8),h9=cM.base_class(),h_=cM.base_class(),dY.New(hK.name,hK.content,hK.anchors,hK.debug_anchors,new bY({$:1,$0:(h$=cB.content_group({$:0,$0:(function(_in){return im(_in[0],_in[1],_in[2]);}([hP,hK,h9]))(["br",hM,h_])}),dY.New("Connector",h$.content,h$.anchors,h$.debug_anchors,h$.sub_groups,h$.offset)),$1:hK.sub_groups}),hK.offset))):(ia=hN.left_connection,ia==null||(ia.$0.$==0?false:ia.$0.$!=2)?dY.New(hK.name,hK.content,hK.anchors,hK.debug_anchors,new bY({$:1,$0:hM,$1:hK.sub_groups}),hK.offset):(ic=il(hL),id=ic[0],ij(id),ie=ik(hN),_if=ie[0],ij(_if),ig=cM.base_class(),ih=cM.base_class(),dY.New(hK.name,hK.content,hK.anchors,hK.debug_anchors,new bY({$:1,$0:hM,$1:new bY({$:1,$0:(ii=cB.content_group({$:0,$0:(function(_in){return im(_in[0],_in[1],_in[2]);}([hP,hK,ig]))(["tl",hM,ih])}),dY.New("Connector",ii.content,ii.anchors,ii.debug_anchors,ii.sub_groups,ii.offset)),$1:hK.sub_groups})}),hK.offset)));};cM.label_baseline_nucleotides=function(){fg.$cctor();return fg.label_baseline_nucleotides;};cM.label_baseline=function(){fg.$cctor();return fg.label_baseline;};cM.margin=function(){fg.$cctor();return fg.margin;};cM.label_sep_rotated=function(){fg.$cctor();return fg.label_sep_rotated;};cM.pseudoknot_letter_width=function(){fg.$cctor();return fg.pseudoknot_letter_width;};cM.arrow_angle=function(){fg.$cctor();return fg.arrow_angle;};cM.arrow_length=function(){fg.$cctor();return fg.arrow_length;};cM.get_domain_class=function(hI,hJ){return hJ.pseudoknot!=null?(hJ.toehold?(hI?cM.base_class()+" fixedwidth":cM.base_class())+" "+cM.dom_id(hJ):hI?cM.base_class()+" fixedwidth":cM.base_class())+" pseudoknot":hJ.toehold?(hI?cM.base_class()+" fixedwidth":cM.base_class())+" "+cM.dom_id(hJ):hI?cM.base_class()+" fixedwidth":cM.base_class();};cM.conn_to_string=function(hI){return hI!=null&&hI.$==1?hI.$0.$==1?"_":hI.$0.$==2?"=":"-":" ";};cM.bulge_sep=function(){fg.$cctor();return fg.bulge_sep;};cM.dom_id=function(hI){return"dom_"+cM.sanitize_id(hI.name);};cM.short_branch_join=function(){fg.$cctor();return fg.short_branch_join;};cO=cN.t=hB.Class({},null,cO);cP=d.Calculus=hB.Class({to_ctmc:function(hI,hJ,hK,hL,hM){var hN,hO,hP,hQ;function hR(hW){return hM.index.from_species.get_Item(hW);}function hS(hW,hX){return[hK,[hW,hX],hL];}function hT(hW,hX){var hY,hZ;hY=Z.to_map(hW.reactants);hZ=Z.to_map(hW.products);return bW.Fold(function(h0,h1,h2){var h3;h3=bW.TryFind(h1,h0);return h3==null?h0.Add(h1,h2):h0.Add(h1,h3.$0+h2);},bW.Fold(function(h0,h1,h2){var h3;h3=h0.get_Item(h1)-h2;return h3===0?h0.Remove(h1):h0.Add(h1,h3);},hX,hY),hZ);}function hU(hW,hX){var hY;hY=bW.TryFind(hX,hW);return hY!=null&&hY.$==1?hY.$0>0:true;}function hV(hW,hX,hY){var hZ;hZ=dA.containsKey(hO,hX);dA.add(hN,hW,new bY({$:1,$0:dC.New(hZ?dA.find(hO,hX):(dA.add(hN,hX,bY.Empty),dA.add(hO,hX,hX),hX),hY),$1:dA.find(hN,hW)}));return hZ;}hN=dA.empty();hO=dA.empty();dA.add(hN,hK,bY.Empty);dA.add(hO,hK,hK);hP=dD.map((hQ=function(hW){return bq.map(hR,hW);},function(hW){return br.map(hQ,hW);}),hI);(function(hW){var hX,hY,hZ,h1,h2,h3,h4,h5,h6,h7,h8,h9,h_,h$,ia,ib;function h0(ic,id){return function(ie){var _if;_if=(hM.react_st(id))(ie);return[bX.append(ic,_if),bX.ofSeq(co.distinct(bX.append(new bY({$:1,$0:ie,$1:id}),dB.get_all_product_species(_if))))];};}while(true){if(hW.$==1){h1=hW.$1;h2=hW.$0[0];h3=hW.$0[1][0];h4=hW.$0[1][1];h5=hW.$0[2];h6=hT(h3,h2);h7=hV(h2,h6,h4);if(h7)hW=h1;else{h8=bX.ofSeq(co.distinct((hX=dB.get_product_species(h3),(function(ic){return function(id){return bX.filter(ic,id);};}(function(ic){return hU(h2,ic);}))(hX))));h9=bX.ofSeq((hY=bW.ToSeq(h2),(function(ic){return function(id){return co.map(ic,id);};}(function(ic){return ic[0];}))(hY)));h_=(function(ic,id){return function(ie){return co.fold(function(_if,ig){return(ic(_if))(ig);},id,ie);};}(function(ic){return h0(ic[0],ic[1]);},[bY.Empty,h9]))(h8);h$=bX.ofSeq(co.distinct(bX.append(h_[0],h5)));ia=(hZ=(function(ic){return function(id){return bX.map(ic,id);};}(function(ic){return function(id){return[id,dB.calculate_reaction_prop(hJ,ic,id,hP)];};}(h6)))(h$),(function(ic){return function(id){return bX.filter(ic,id);};}(function(ic){return dB.nonzero_prop(ic[0],ic[1]);}))(hZ));ib=(function(ic){return function(id){return bX.map(ic,id);};}(function(ic,id){return function(ie){return[ic,[ie[0],ie[1]],id];};}(h6,h$)))(ia);hW=bX.append(h1,ib);}}else return null;}}(bX.map(function(hW){return hS(hW[0],hW[1]);},bX.filter(function(hW){return dB.nonzero_prop(hW[0],hW[1]);},bX.map(function(hW){return[hW,dB.calculate_reaction_prop(hJ,hK,hW,hP)];},hL)))));return{ctmc:dB.New(hN,hK),to_species:hM.index.to_species};},initialise_ctmc:function(hI){var hJ,hK,hL;function hM(hP){return hP[1];}function hN(hP){return 0<hP;}function hO(hP,hQ){return function(hR){var hS;hS=(hK.react_st(hQ))(hR);return[bX.distinct(bX.append(hP,hS)),bX.distinct(bX.append(new bY({$:1,$0:hR,$1:hQ}),dB.get_all_product_species(hS)))];};}hJ=bX.map(function(hP){return hP[1];},hI);hK=this.get_adapt();hL=hK.init(bX.map(function(hP){return hP[0];},hI));return[bW.OfArray(ck.ofSeq(bX.filter(function(hP){return hN(hM(hP));},bX.zip(hL,hJ)))),(co.fold(function(hP,hQ){return(function(hR){return hO(hR[0],hR[1]);}(hP))(hQ);},[bY.Empty,bY.Empty],hL))[0],hK];},get_adapt:function(){var hI,hJ;function hK(hM,hN){var hO,hP,hQ,hR;function hS(hU){return eX.index(hJ,hU);}function hT(hU){return bq.map(hS,hU);}hO=bX.map(function(hU){return ck.get(hJ.to_species,hU);},hM);hP=ck.get(hJ.to_species,hN);hQ=(hI.react(hO))(hP);bX.map(function(hU){return eX.index(hJ,hU);},dB.get_all_product_species(hQ));return bX.map((hR=function(hU){return br.map(hT,hU);},function(hU){return _2.map(hS,a.id,hR,hU);}),hQ);}function hL(hM){return eX.add(hJ,hM);}hI=this;hJ=eX.empty();return eY.New(function(hM){return bX.map(hL,hM);},function(hM){return function(hN){return hK(hM,hN);};},hJ);}},null,cP);cP.New=function(hI){return new cP({react:hI});};cQ.New=function(hI,hJ,hK,hL){return{meta:hI,info:hJ,domain_colours:hK,subdomains:hL};};cN.free_names=function(hI){return hI.$==0?em.free_names(hI.$0):hI.$==2?en.free_names(hI.$0):hI.$==3?bY.Empty:hI.$==4?bY.Empty:eo.free_names(hI.$0);};cN.matches=function(hI,hJ,hK){var hL,hM;hL=cN.standard_form(hI,hJ);hM=cN.standard_form(hI,hK);return hL.$==0?hM.$==0&&em.matches(hL.$0,hM.$0):hL.$==1?hM.$==1&&eo.matches(hI,hL.$0,hM.$0):hL.$==2?hM.$==2&&en.matches(hI,hL.$0,hM.$0):hL.$==3&&(hM.$==3&&hL.$0===hM.$0);};cN.equal=function(hI,hJ,hK){return hJ.$==0?hK.$==0&&em.equal(hJ.$0,hK.$0):hJ.$==1?hK.$==1&&eo.equal(hI,hJ.$0,hK.$0):hJ.$==2?hK.$==2&&en.equal(hI,hJ.$0,hK.$0):hJ.$==3&&(hK.$==3&&hJ.$0===hK.$0);};cN.display=function(hI){return hI.$==1?eo.display(hI.$0):hI.$==2?en.display(hI.$0):hI.$==3?hI.$0:hI.$==4?(function(hJ){return function(hK){return hJ("["+cA.toSafe(hK)+"]");};}(a.id))(b$.ToStringWith(b5.engine(),hI.$0)):em.display(hI.$0);};cN.env_to_species=function(hI){function hJ(hL,hM){return function(hN){var hO,hP,hQ;return hN.$==1?(hO=hN.$0[1],(hP=hN.$1,(hQ=hN.$0[0],cw.Equals(hL.species,hQ.species)&&cw.Equals(hL.constant,hQ.constant)&&cw.Equals(hM,hO)?new bY({$:1,$0:[cD.New(hL.constant,br.add(hL.value,hQ.value),hQ.species,hL.initial,hL.input,hL.spatial_initial,hL.max),hM],$1:hP}):new bY({$:1,$0:[hQ,hO],$1:(function(hR){return hJ(hR[0],hR[1]);}([hL,hM]))(hP)})))):bX.ofArray([[hL,hM]]);};}function hK(hL,hM,hN,hO,hP,hQ){return[cD.New(hN,hM,hL,true,true,hQ,null),hP];}return dZ.fold_left(function(hL,hM){return(function(hN){return hJ(hN[0],hN[1]);}(hM))(hL);},bY.Empty,bX.map(function(hL){return hK(hL[0],hL[1],hL[2],hL[3],hL[4],hL[5]);},cu.fold(function(hL,hM,hN){return bX.append(hN,hL);},bY.Empty,hI[0])));};cN.check=function(hI){cN.check_interacting_nontoeholds(hI);};cN["eval"]=function(hI,hJ){return hJ.$==0?new cO({$:0,$0:em["eval"](hI,hJ.$0)}):hJ.$==2?new cO({$:2,$0:en["eval"](hI,hJ.$0)}):hJ.$==3?new cO({$:3,$0:hJ.$0}):hJ.$==4?new cO({$:4,$0:hJ.$0}):new cO({$:1,$0:eo["eval"](hI,hJ.$0)});};cN.erasePos=function(hI){return hI.$==0?new cO({$:0,$0:em.erasePosns(hI.$0)}):hI.$==2?new cO({$:2,$0:en.erasePosns(hI.$0)}):hI.$==3?new cO({$:3,$0:hI.$0}):hI.$==4?new cO({$:4,$0:hI.$0}):new cO({$:1,$0:eo.erasePosns(hI.$0)});};cN.domains=function(hI){function hJ(hK){var hL;return hK.$==0&&(hK.$0.$==0?hK.$0.$0.$==0&&(hL=hK.$0.$0.$0,true):hK.$0.$0.$==0&&(hL=hK.$0.$0.$0,true))?hL.isToehold?{$:0,$0:{$:2,$0:hL.name,$1:0,$2:{$:1,$0:0},$3:{$:1,$0:0},$4:null},$1:{$:6,$0:1,$1:null},$2:hL.isComplementary,$3:null}:{$:1,$0:{$:2,$0:hL.name,$1:0,$2:{$:1,$0:0},$3:{$:1,$0:0},$4:null},$1:hL.isComplementary,$2:null}:be.FailWith("Unexpected uninstantiated Logic DSD process.");}return hI.$==1?eo.domains(hI.$0):hI.$==2?en.domains(hI.$0):hI.$==3?bY.Empty:hI.$==4?bX.collect(function(hK){return bX.map(hJ,hK);},b$.ToList(hI.$0)):em.domains(hI.$0);};cN.try_find_name=function(hI,hJ,hK,hL){var hM,hN;hM=hJ[1].$0;hN=cN.display(hL);return cu.inDomain(hM,hN)?{$:1,$0:cu.find(hN,hM)}:null;};cN.standard_form=function(hI,hJ){return hJ.$==1?new cO({$:1,$0:eo.standard_form(hI,hJ.$0)}):hJ.$==2?new cO({$:2,$0:en.standard_form(hI,hJ.$0)}):hJ.$==3?new cO({$:3,$0:hJ.$0}):hJ.$==4?be.FailWith("Logic DSD complexes are not supported in Classic DSD"):new cO({$:0,$0:em.standard_form(hJ.$0)});};cN.empty_env=function(hI){return[cu.empty(),{$:0,$0:cu.empty(),$1:hI}];};cN.add_env=function(hI,hJ,hK,hL){var hM,hN,hO,hP,hQ,hR,hS,hT,hU;hM=hK[0];hN=hL[0];hO=hL[1].$0;hP=hL[1].$1;hQ=hJ==="%"?["sp_"+a.String(hP),hP+1]:[hJ,hP];hR=hQ[0];hS=hQ[1];hT=cN.env_mem_name(hJ,hL[0],hL[1]);return hT!=null&&hT.$==1?cN.env_mem_species(hM,hL[0],hL[1])?[cu.add(hJ,cN.add(hI,hT.$0[0],hK[0],hK[1],hK[2],hK[3],hK[4],hK[5]),hT.$0[1][0]),hT.$0[1][1]]:(hU=hT.$0[0],[cu.add(hJ,cN.add(hI,hU,hK[0],hK[1],hK[2],hK[3],hK[4],hK[5]),hT.$0[1][0]),hJ==="%"?{$:0,$0:cu.add(cN.display(hM),hR,hO),$1:hS}:{$:0,$0:cu.add(cN.display(hM),hR+"_"+a.String(bX.length(hU)),hT.$0[1][1].$0),$1:hT.$0[1][1].$1}]):cN.env_mem_species(hM,hL[0],hL[1])?[cu.add(hJ,bX.ofArray([hK]),hN),{$:0,$0:hO,$1:hP}]:[cu.add(hJ,bX.ofArray([hK]),hN),{$:0,$0:cu.add(cN.display(hM),hR,hO),$1:hS}];};cN.rotate=function(hI,hJ){return hJ.$==1?new cO({$:1,$0:eo.rotate(hI,hJ.$0)}):hJ.$==2?new cO({$:2,$0:en.rotate(hI,hJ.$0)}):hJ.$==3?new cO({$:3,$0:hJ.$0}):hJ.$==4?be.FailWith("Logic DSD complexes are not supported in Classic DSD"):new cO({$:0,$0:em.rotate(hJ.$0)});};cN.check_interacting_nontoeholds=function(hI){var hJ,hK;hJ=function(hL){var hM,hN;while(true)if(hL.$==1){hM=hL.$1;hN=hL.$0;if(dZ.contains(eg.complement(hN),hM))return{$:1,$0:hN};else hL=hM;}else return null;}(dZ.collect(cN.exposed_nontoeholds,hI));hJ!=null&&hJ.$==1?(hK=hJ.$0,fc.interacting_nontoehold_error(eg.display(eg.unstar(hK)),eg.display(eg.star(hK)))):void 0;};cN.separate=function(hI){return dZ.fold_left(function(hJ,hK){return(function(hL){var hM,hN,hO;hM=hL[0];hN=hL[1];hO=hL[2];return function(hP){return hP.$==0?[hM,bX.append(hN,bX.ofArray([hP.$0])),hO]:hP.$==2?[hM,hN,new bY({$:1,$0:hP.$0,$1:hO})]:hP.$==3?[hM,hN,hO]:hP.$==4?be.FailWith("Logic DSD complexes are not supported in Classic DSD"):[bX.append(hM,bX.ofArray([hP.$0])),hN,hO];};}(hJ))(hK);},[bY.Empty,bY.Empty,bY.Empty],hI);};cN.env_mem_name=function(hI,hJ,hK){var hL;hL=cu.tryFind(hI,hJ);return hL!=null&&hL.$==1?{$:1,$0:[hL.$0,[cu.remove(hI,hJ),hK]]}:null;};cN.env_mem_species=function(hI,hJ,hK){return cu.tryFind(cN.display(hI),hK.$0)!=null;};cN.add=function(hI,hJ,hK,hL,hM,hN,hO,hP){var hQ,hR,hS,hT,hU,hV,hW;return hJ.$==1?(hQ=hJ.$0[4],(hR=hJ.$1,(hS=hJ.$0[5],(hT=hJ.$0[0],(hU=hJ.$0[1],(hV=hJ.$0[3],(hW=hJ.$0[2],cN.equal(hI,hK,hT)&&cw.Equals(hO,hQ)&&cw.Equals(hP,hS)?new bY({$:1,$0:[hT,br.simplify(br.add(hU,hL)),hM||hW,hV||hN,hQ,hS],$1:hR}):new bY({$:1,$0:[hT,hU,hW,hV,hQ,hS],$1:cN.add(hI,hR,hK,hL,hM,hN,hO,hP)})))))))):bX.ofArray([[hK,hL,hM,hN,hO,hP]]);};cN.exposed_nontoeholds=function(hI){return hI.$==1?eo.exposed_nontoeholds(hI.$0):hI.$==2?en.exposed_nontoeholds(hI.$0):hI.$==3?bY.Empty:hI.$==4?bY.Empty:em.exposed_nontoeholds(hI.$0);};cN.convert_raw_gate=function(hI){var hJ;hJ=hI[2];return dZ.fold_left(function(hK,hL){var hM,hN,hO;hN=hL[0];hO=hL[1];switch(hK.$==1?hO.$==1?(hM=[hK.$0,hO.$0,hN],0):hO.$==0?hO.$0.$==0?hN?(hM=[hK.$0,hO.$0.$0],2):7:hN?7:(hM=[hK.$0,hO.$0.$0],1):7:hK.$==0?hK.$0.$==0?hN?hO.$==1?(hM=[hO.$0,hK.$0.$0],4):hO.$==0?hO.$0.$==0?(hM=[hK.$0.$0,hO.$0.$0],6):7:7:7:hN?7:hO.$==1?(hM=[hO.$0,hK.$0.$0],3):hO.$==0?hO.$0.$==1?(hM=[hK.$0.$0,hO.$0.$0],5):7:7:7){case 0:return new cO({$:1,$0:eo.join(hM[0],hM[2],hM[1])});case 1:return new cO({$:1,$0:eo.append_strand_to_gate(hM[0],{$:1,$0:hM[1]})});case 2:return new cO({$:1,$0:eo.append_strand_to_gate(hM[0],{$:0,$0:hM[1]})});case 3:return new cO({$:1,$0:eo.cons_strand_to_gate({$:1,$0:hM[1]},hM[0])});case 4:return new cO({$:1,$0:eo.cons_strand_to_gate({$:0,$0:hM[1]},hM[0])});case 5:return new cO({$:0,$0:em.append({$:1,$0:hM[0]},{$:1,$0:hM[1]})});case 6:return new cO({$:0,$0:em.append({$:0,$0:hM[0]},{$:0,$0:hM[1]})});case 7:return fc.syntax_error(ec.rangeBegin(hJ),ec.rangeEnd(hJ),"Malformed gate");}},hI[0],hI[1]);};cN.collate=function(hI,hJ,hK){return bX.append(bX.map(function(hL){return new cO({$:1,$0:hL});},hI),bX.append(bX.map(function(hL){return new cO({$:0,$0:hL});},hJ),bX.map(function(hL){return new cO({$:2,$0:hL});},hK)));};cN.melt=function(hI){function hJ(hK){return new cO({$:0,$0:hK});}return cN.melt_with(function(hK){return hJ(cN.strand_to_lower(hK));},hI);};cN.melt_with=function(hI,hJ){var hK;if(hJ.$==0)return bX.ofArray([hI(hJ.$0)]);else if(hJ.$==1)return bX.map(hI,cN.melt_gate(hJ.$0));else if(hJ.$==2){hK=en.origami_species(hJ.$0);return bX.map(hI,bX.append(hK[1],bX.collect(cN.melt_gate,hK[0])));}else throw new db("The melting of complex and unknown species is not yet implemented");};cN.strand_to_lower=function(hI){return hI.$==1?em.rotate(hI):hI;};cN.melt_gate=function(hI){var hJ,hK,hL;function hM(hO,hP){function hQ(hR,hS){return function(hT){var hU;hU=cN.connect_lower(hR,hT);return[hU[0],bX.append(hU[1],hS)];};}return dZ.fold_left(function(hR,hS){return(function(hT){return hQ(hT[0],hT[1]);}(hR))(hS);},hO,bX.map(cN.melt_segment,hP));}function hN(hO,hP){return function(hQ){var hR;return hQ.$==1?(hR=cN.connect_upper(hO,cN.melt_segment(hQ.$0)),hM([hR[0],bX.append(hR[1],hP)],hQ.$1)):[hO,hP];};}return hI.$==1?hI.$0.$==1?(hJ=dZ.fold_left(function(hO,hP){return(function(hQ){return hN(hQ[0],hQ[1]);}(hO))(hP);},hM([cN.melt_segment(hI.$0.$0),bY.Empty],hI.$0.$1),hI.$1),(hK=hJ[1],(hL=hJ[0],hL.$==0?new bY({$:1,$0:{$:0,$0:hL.$0},$1:new bY({$:1,$0:{$:1,$0:hL.$1},$1:hK})}):new bY({$:1,$0:{$:1,$0:hL.$0},$1:hK})))):cN.melt_gate(hI.$1):bY.Empty;};cN.connect_lower=function(hI,hJ){return hI.$==0?hJ.$==0?[{$:0,$0:hJ.$0,$1:bX.append(hI.$1,hJ.$1)},bX.ofArray([{$:0,$0:hI.$0}])]:[{$:1,$0:bX.append(hI.$1,hJ.$0)},bX.ofArray([{$:0,$0:hI.$0}])]:hJ.$==0?[{$:0,$0:hJ.$0,$1:bX.append(hI.$0,hJ.$1)},bY.Empty]:be.FailWith("circular DNA");};cN.melt_segment=function(hI){var hJ,hK,hL;return hI.$==1?hI.$0[4].$==1?(hJ=eg.unstick_list(hI.$0[2]),{$:1,$0:bX.concat([hI.$0[0],hJ[1],hI.$0[3],bX.rev(hJ[0]),bX.rev(hI.$0[1])])}):(hK=eg.unstick_list(hI.$0[2]),{$:1,$0:bX.concat([bX.rev(hI.$0[1]),bX.rev(hK[0]),hI.$0[3],hK[1],hI.$0[0]])}):(hL=eg.unstick_list(hI.$0[2]),{$:0,$0:bX.concat([hI.$0[1],hL[0],hI.$0[3]]),$1:bX.concat([hI.$0[0],hL[1],hI.$0[4]])});};cN.connect_upper=function(hI,hJ){return hI.$==0?hJ.$==0?[{$:0,$0:bX.append(hI.$0,hJ.$0),$1:hJ.$1},bX.ofArray([{$:1,$0:hI.$1}])]:[{$:1,$0:bX.append(hJ.$0,bX.rev(hI.$0))},bX.ofArray([{$:1,$0:hI.$1}])]:hJ.$==0?[{$:0,$0:bX.append(bX.rev(hI.$0),hJ.$0),$1:hJ.$1},bY.Empty]:be.FailWith("circular DNA");};cR.run=function(hI,hJ){var hK,hL,hM,hN,hO;hK=cR.do_run(hI,hJ);return hK.$==1?{$:0,$0:hK.$0,$1:hK.$1[0],$2:hK.$1[1]}:hK.$==2?(hL=hK.$1,(hM=hK.$0,{$:1,$0:cR.errMsg(hM,hL[0],hL[1]),$1:hM,$2:hJ})):hK.$==3?(hN=hK.$1,(hO=hK.$0,{$:1,$0:cR.errMsg(hO,hN[0],hN[1]),$1:hO,$2:hJ})):{$:0,$0:hK.$0,$1:hK.$1[0],$2:hK.$1[1]};};cR.from_string_first_error_with_msg=function(hI,hJ){var hK,hN,hO,hP,hQ,hR,hS,hT,hU;function hL(hV){var hW;hW=cR.run(cR.manySatisfy(function(hX){return hX!==" "&&hX!=="\\n"&&hX!=="\\r";}),hV);return hW.$==1?"input":(function(hX){return function(hY){return hX("\'"+cA.toSafe(hY)+"\'");};}(a.id))(hW.$0);}function hM(hV,hW,hX,hY){return{$:1,$0:dd.New(hW,hX,(function(hZ){return function(h0){return hZ("Unexpected "+cA.toSafe(h0)+".");};}(a.id))(hV)+(hY!==""?"\\nExpecting: "+hY:""))};}hN=cR.do_run(hI,hJ);switch(hN.$==1?hN.$1[0]===""?(hK=hN.$0,0):(hK=[hN.$1[1][1],hN.$1[1][0],hN.$1[0]],1):hN.$==2?(hK=[hN.$1[1],hN.$0,hN.$1[0]],2):hN.$==3?(hK=[hN.$1[1],hN.$0,hN.$1[0]],2):hN.$1[0]===""?(hK=hN.$0,0):(hK=[hN.$1[1][1],hN.$1[1][0],hN.$1[0]],1)){case 0:return{$:0,$0:hK};case 1:hO=hK[0];hP=hK[1];hQ=hK[2];return hQ===""?hM("end of input",hP+1,hO,""):hM(hL(hQ),hP+1,hO,"");case 2:hR=hK[0];hS=hK[1];hT=hK[2];hU=ck.get(cS.SplitStrings(hJ,["\\n","\\r\\n"],0),hT).substring(hR);return hU===""?hM("end of input",hT+1,hR,hS):hM(hL(hU),hT+1,hR,hS);}};cR.name=function(){eV.$cctor();return eV.name;};cR.from_string=function(hI,hJ){var hK,hL,hM,hN,hO;hL=cR.do_run(hI,hJ);switch(hL.$==1?hL.$1[0]===""?(hK=hL.$0,0):(hK=[hL.$1[1][1],hL.$1[1][0],hL.$0,hL.$1[0]],1):hL.$==2?(hK=[hL.$1[1],hL.$0,hL.$1[0]],2):hL.$==3?(hK=[hL.$1[1],hL.$0,hL.$1[0]],2):hL.$1[0]===""?(hK=hL.$0,0):(hK=[hL.$1[1][1],hL.$1[1][0],hL.$0,hL.$1[0]],1)){case 0:return hK;case 1:hM=hK[0];hN=hK[1];throw new dc.New((((hB.Curried3(function(hP,hQ,hR){return hP("Unexpected end of input at row "+a.String(hQ)+" column "+a.String(hR));}))(a.id))(hN))(hM),[dd.New(hN+1,hM,(function(hP){return function(hQ){return hP("unexpected end of input at column "+a.String(hQ));};}(a.id))(hM))]);case 2:hO=hK[1];throw new dc.New(hO,[dd.New(hK[2]+1,hK[0],hO)]);}};cR.do_run=function(hI,hJ){return(cR.op_DotGreaterGreater(cR.op_GreaterGreaterDot(cR.spaces(),hI),cR.spaces()))([hJ,cR.start_pos()]);};cR.errMsg=function(hI,hJ,hK){return((((hB.Curried(function(hL,hM,hN,hO){return hL("Expecting "+cA.toSafe(hM)+" at row "+a.String(hN)+" column "+a.String(hO));},4))(a.id))(hI))(hJ+1))(hK+1);};cR.op_DotGreaterGreater=function(hI,hJ){return cR.op_BarGreaterGreater(cR.op_DotGreaterGreaterDot(hI,hJ),function(hK){return hK[0];});};cR.op_GreaterGreaterEquals=function(hI,hJ){return function(hK){var hL,hM;hL=hI(hK);return hL.$==1?(hM=(hJ(hL.$0))(hL.$1),hM.$==1?{$:1,$0:hM.$0,$1:hM.$1}:hM.$==2?{$:3,$0:hM.$0,$1:hM.$1}:hM.$==3?{$:3,$0:hM.$0,$1:hM.$1}:{$:1,$0:hM.$0,$1:hM.$1}):hL.$==2?{$:2,$0:hL.$0,$1:hL.$1}:hL.$==3?{$:3,$0:hL.$0,$1:hL.$1}:(hJ(hL.$0))(hL.$1);};};cR.op_GreaterGreaterDot=function(hI,hJ){return cR.op_BarGreaterGreater(cR.op_DotGreaterGreaterDot(hI,hJ),function(hK){return hK[1];});};cR.spaces=function(){eV.$cctor();return eV.spaces;};cR.many=function(hI){return function(hJ){var hK,hL,hM;hK=hI(hJ);return hK.$==1?(hL=hK.$0,(cR.op_GreaterGreaterEquals(cR.many(hI),function(hN){var hO;hO=new bY({$:1,$0:hL,$1:hN});return function(hP){return cR.preturnConsumed(hO,hP[0],hP[1]);};}))(hK.$1)):hK.$==2?{$:0,$0:bY.Empty,$1:hJ}:hK.$==3?{$:3,$0:hK.$0,$1:hK.$1}:(hM=hK.$0,(cR.op_GreaterGreaterEquals(cR.many(hI),function(hN){return cR.preturn(new bY({$:1,$0:hM,$1:hN}));}))(hK.$1));};};cR.kw=function(hI){return cR.op_DotGreaterGreater(function(hJ){return cR.pstringkw(hI,hJ[0],hJ[1]);},cR.spaces());};cR.preturn=function(hI){return function(hJ){return{$:0,$0:hI,$1:hJ};};};cR.manySatisfy=function(hI){return function(hJ){var hK,hL,hM,hN,hO,hP;function hQ(hR){return!hR;}hK=hJ[0];hL=hJ[1];hM=ck.tryFindIndex(function(hR){return hQ(hI(hR));},cS.ToCharArray(hK));return hM!=null&&hM.$==1?(hN=hM.$0,(hO=cS.Substring(hK,0,hN),(hP=hK.substring(hN),hO.length>0?{$:1,$0:hO,$1:[hP,cR.move(hO,hL)]}:{$:0,$0:hO,$1:[hP,cR.move(hO,hL)]}))):{$:0,$0:hK,$1:["",cR.add_cols(hK.length,hL)]};};};cR.start_pos=function(){eV.$cctor();return eV.start_pos;};cR.op_BarGreaterGreater=function(hI,hJ){return cR.op_GreaterGreaterEquals(hI,function(hK){return cR.preturn(hJ(hK));});};cR.op_DotGreaterGreaterDot=function(hI,hJ){return cR.op_GreaterGreaterEquals(hI,function(hK){return cR.op_GreaterGreaterEquals(hJ,function(hL){return cR.preturn([hK,hL]);});});};cR.preturnConsumed=function(hI,hJ,hK){return{$:1,$0:hI,$1:[hJ,hK]};};cR.pstringkw=function(hI,hJ,hK){var hL,hM;return cS.StartsWith(hJ,hI)?hJ.length===hI.length?{$:1,$0:hI,$1:[hJ.substring(hI.length),cR.add_cols(hI.length,hK)]}:(hL=hI[hI.length-1],cR.isDigit(hL)||cR.isLetter(hL)||hL==="_"?(hM=hJ[hI.length],cR.isDigit(hM)||cR.isLetter(hM)||hM==="_"?cR.mk_failEmpty(hK,(function(hN){return function(hO){return hN("\'"+cA.toSafe(hO)+"\'");};}(a.id))(hI)):{$:1,$0:hI,$1:[hJ.substring(hI.length),cR.add_cols(hI.length,hK)]}):{$:1,$0:hI,$1:[hJ.substring(hI.length),cR.add_cols(hI.length,hK)]}):cR.mk_failEmpty(hK,(function(hN){return function(hO){return hN("\'"+cA.toSafe(hO)+"\'");};}(a.id))(hI));};cR.choice=function(hI){return co.isEmpty(hI)?cR.failParser("Malformed grammar, choice is empty."):co.fold(cR.op_LessBarGreater,co.head(hI),co.skip(1,hI));};cR.op_LessBarGreater=function(hI,hJ){return function(hK){var hL,hM;hL=hI(hK);return hL.$==2?(hM=hJ(hK),hM.$==2?{$:2,$0:hL.$0+" or "+hM.$0,$1:hM.$1}:hM):hL;};};cR.op_BarTwiddleGreater=function(hI,hJ){return cR.op_GreaterGreaterEquals(hI,function(hK){return function(hL){var hM;hM=hL[1];return(cR.preturn(hJ(hM,hK)))([hL[0],hM]);};});};cR.op_PlusGreaterGreaterPlus=function(hI,hJ){return cR.op_DotGreaterGreaterDot(hI,cR.op_GreaterGreaterDot(cR.spaces(),hJ));};cR.move=function(hI,hJ){var hK,hL;hK=cS.SplitStrings(hI,cR.lineSeparators(),0);hL=ck.length(hK)-1;return[hJ[0]+hL,hL===0?hJ[1]+ck.get(hK,hL).length:ck.get(hK,hL).length];};cR.add_cols=function(hI,hJ){return[hJ[0],hJ[1]+hI];};cR.pchar=function(hI){return function(hJ){var hK,hL;hK=hJ[0];hL=hJ[1];return hK.length>0&&hK[0]===hI?{$:1,$0:hK[0],$1:[hK.substring(1),cR.add_cols(1,hL)]}:cR.mk_failEmpty(hL,hI);};};cR.opt=function(hI){return function(hJ){var hK;hK=hI(hJ);return hK.$==0?{$:0,$0:{$:1,$0:hK.$0},$1:hK.$1}:hK.$==2?{$:0,$0:null,$1:hJ}:hK.$==3?{$:3,$0:hK.$0,$1:hK.$1}:{$:1,$0:{$:1,$0:hK.$0},$1:hK.$1};};};cR.pTry=function(hI){return function(hJ){var hK;hK=hI(hJ);return hK.$==3?{$:2,$0:hK.$0,$1:hK.$1}:hK;};};cR.record=function(hI,hJ){var hK;function hL(hN,hO){return cR.op_GreaterGreaterDot(cR.kw(hN),cR.op_GreaterGreaterDot(cR.kw("="),hO));}function hM(hN,hO){return hO(hN);}return cR.op_BarGreaterGreater(cR.op_GreaterGreaterGreaterGreater(cR.kw("{"),cR.sepEndByAmb((hK=cR.choice(bX.map(function(hN){return hL(hN[0],hN[1]);},hJ)),function(hN){return hK([hN[0],hN[1]]);}),cR.kw("}"),cR.skw(";"))),function(hN){return co.fold(hM,hI,hN);});};cR.pint32=function(){eV.$cctor();return eV.pint32;};cR.add_rows=function(hI,hJ){return[hJ[0]+hI,hJ[1]];};cR.mk_failEmpty=function(hI,hJ){function hK(hL,hM){return{$:2,$0:hL,$1:hM};}return cR.mk_error(function(hL){return hK(hL[0],hL[1]);},hI[0],hI[1],hJ);};cR.op_LessQmarkGreater=function(hI,hJ){return function(hK){var hL;hL=hI(hK);return hL.$==2?{$:2,$0:hJ,$1:hL.$1}:hL.$==3?{$:3,$0:hJ,$1:hL.$1}:hL;};};cR.isDigit=function(hI){return fw.IsDigit(hI);};cR.many1Satisfy=function(hI){return function(hJ){var hK,hL;hK=hJ[0];hL=hJ[1];return hK.length>0&&hI(hK[0])?(cR.manySatisfy(hI))([hK,hL]):cR.mk_failEmpty(hL,"a string satisying a predicate");};};cR.newline=function(){eV.$cctor();return eV.newline;};cR.skipString=function(hI){return cR.op_BarGreaterGreater(cR.pstring(hI),a.ignore);};cR.pstring=function(hI){return function(hJ){var hK,hL;hK=hJ[0];hL=hJ[1];return cS.StartsWith(hK,hI)?{$:1,$0:hI,$1:[hK.substring(hI.length),cR.add_cols(hI.length,hL)]}:cR.mk_failEmpty(hL,(function(hM){return function(hN){return hM("\'"+cA.toSafe(hN)+"\'");};}(a.id))(hI));};};cR.sign=function(){eV.$cctor();return eV.sign;};cR.digits1=function(){eV.$cctor();return eV.digits1;};cR.guarded=function(hI,hJ){return function(hK){var hL,hM,hN,hO;hL=hK[0];hM=hJ([hL,hK[1]]);return hM.$==1?(hN=hM.$1,cR.do_guarded(hL,hN[0],hN[1],hI,function(hP,hQ){return{$:1,$0:hP,$1:hQ};})):hM.$==2?{$:2,$0:hM.$0,$1:hM.$1}:hM.$==3?{$:3,$0:hM.$0,$1:hM.$1}:(hO=hM.$1,cR.do_guarded(hL,hO[0],hO[1],hI,function(hP,hQ){return{$:0,$0:hP,$1:hQ};}));};};cR.opt_sign=function(){eV.$cctor();return eV.opt_sign;};cR.isLetter=function(hI){return fw.IsLetter(hI);};cR.linebreak=function(){eV.$cctor();return eV.linebreak;};cR.skipChar=function(hI,hJ,hK){var hL,hM;return hJ.length>0&&hI(hJ[0])?(hL=ck.contains((hM=hJ[0],a.String(hM)),cR.lineSeparators())?[hK[0]+1,0]:cR.add_cols(1,hK),{$:1,$0:null,$1:[hJ.substring(1),hL]}):cR.mk_failEmpty(hK,"a char satisying predicate");};cR.isWhiteSpace=function(hI){return fw.IsWhiteSpace(hI);};cR.keyword=function(){eV.$cctor();return eV.keyword;};cR.lineSeparators=function(){eV.$cctor();return eV.lineSeparators;};cR.eof=function(){eV.$cctor();return eV.eof;};cR.op_GreaterGreaterGreaterGreater=function(hI,hJ){return cR.op_GreaterGreaterEquals(hI,function(){return hJ;});};cR.CommentSingle=function(){eV.$cctor();return eV.CommentSingle;};cR.manyUntil=function(hI,hJ,hK,hL){var hM,hN;hM=[hK,hL];hN=hJ(hM);return hN.$==1?{$:1,$0:bY.Empty,$1:hN.$1}:hN.$==2?(cR.op_GreaterGreaterEquals(hI,function(hO){return cR.op_GreaterGreaterEquals(function(hP){return cR.manyUntil(hI,hJ,hP[0],hP[1]);},function(hP){return cR.preturn(new bY({$:1,$0:hO,$1:hP}));});}))(hM):hN.$==3?{$:3,$0:hN.$0,$1:hN.$1}:{$:0,$0:bY.Empty,$1:hN.$1};};cR.anyChar_INTERNAL=function(){eV.$cctor();return eV.anyChar_INTERNAL;};cR.commentLine=function(){eV.$cctor();return eV.commentLine;};cR.commentMultiline=function(){return cR.op_BarGreaterGreater(cR.op_GreaterGreaterDot((cR.keyword())(cR.CommentStart()),cR.commentMultilineShield(1)),a.ignore);};cR.whiteSpace=function(){eV.$cctor();return eV.whiteSpace;};cR.many1=function(hI){return cR.op_BarGreaterGreater(cR.op_DotGreaterGreaterDot(hI,cR.many(hI)),function(hJ){return new bY({$:1,$0:hJ[0],$1:hJ[1]});});};cR.op_GreaterGreaterPercent=function(hI,hJ){return cR.op_BarGreaterGreater(hI,function(){return hJ;});};cR.name_kw=function(hI){return cR.pTry(cR.op_GreaterGreaterEquals(cR.name(),function(hJ){return bX.contains(hJ,hI)?cR.failParser("Keyword found"):cR.preturn(hJ);}));};cR.failParser=function(hI){return function(hJ){return{$:2,$0:hI,$1:hJ[1]};};};cR.bracket=function(hI,hJ){var hK,hL;hK=cR.kw(hI);hL=cR.op_GreaterGreaterDot(cR.spaces(),cR.kw(hJ));return function(hM){return cR.between(hK,hL,hM);};};cR.op_PlusGreaterGreater=function(hI,hJ){return cR.op_BarGreaterGreater(cR.op_PlusGreaterGreaterPlus(hI,hJ),function(hK){return hK[0];});};cR.list_of1=function(hI){return cR.op_GreaterGreaterGreaterGreater(cR.kw("["),cR.sepEndBy1Amb(hI,cR.kw("]"),cR.kw(";")));};cR.sepEndBy1=function(hI,hJ){return cR.sepEndBy1Try(hI,hJ);};cR.skw=function(hI){return cR.op_GreaterGreaterDot(cR.spaces(),cR.kw(hI));};cR.paren=function(hI){return(cR.bracket("(",")"))(hI);};cR.sepBy1=function(hI,hJ){return cR.op_BarGreaterGreater(cR.op_DotGreaterGreaterDot(hI,cR.many(cR.op_GreaterGreaterDot(hJ,hI))),function(hK){return new bY({$:1,$0:hK[0],$1:hK[1]});});};cR.between=function(hI,hJ,hK){return cR.op_DotGreaterGreater(cR.op_GreaterGreaterDot(hI,hK),hJ);};cR.pfloat=function(){eV.$cctor();return eV.pfloat;};cR.sepBy=function(hI,hJ){return cR.op_BarGreaterGreater(cR.opt(cR.sepBy1(hI,hJ)),function(hK){return hK!=null&&hK.$==1?hK.$0:bY.Empty;});};cR.sqBrackets=function(hI){return(cR.bracket("[","]"))(hI);};cR.sepBy2=function(hI,hJ){return cR.op_BarGreaterGreater(cR.op_DotGreaterGreaterDot(hI,cR.many1(cR.op_GreaterGreaterDot(hJ,hI))),function(hK){return new bY({$:1,$0:hK[0],$1:hK[1]});});};cR.braces=function(hI){return(cR.bracket("{","}"))(hI);};cR.pbool=function(){eV.$cctor();return eV.pbool;};cR.sepEndByAmb=function(hI,hJ,hK){return cR.op_LessBarGreater(cR.op_GreaterGreaterGreaterGreater(hJ,cR.preturn(bY.Empty)),cR.sepEndBy1Amb(hI,hJ,hK));};cR.chainl1Try=function(hI,hJ){return cR.op_BarGreaterGreater(cR.op_DotGreaterGreaterDot(hI,cR.many(cR.pTry(cR.op_DotGreaterGreaterDot(hJ,hI)))),function(hK){return co.fold(function(hL,hM){return(hM[0](hL))(hM[1]);},hK[0],hK[1]);});};cR.mk_error=function(hI,hJ,hK,hL){return hI([hL,[hJ,hK]]);};cR.do_guarded=function(hI,hJ,hK,hL,hM){var hN;hN=hI.length-hJ.length;return hM(hL(cS.Substring(hI,0,hN)),[hI.substring(hN),hK]);};cR.CommentStart=function(){eV.$cctor();return eV.CommentStart;};cR.commentMultilineShield=function(hI){function hJ(hK,hL){var hM,hN,hO,hP,hQ,hR,hS,hT;while(true){hO=hL[0];hP=hL[1];hQ=hP[1];hR=hP[0];hS=[hR,hQ];if(hK===0)return{$:0,$0:null,$1:[hO,[hR,hQ]]};else if(hO==="")return{$:3,$0:"missing \\"*)\\" to close an open comment",$1:[hR,hQ]};else{hT=(hM=cR.CommentStart().length,hN=cR.CommentEnd().length,cS.StartsWith(hO,cR.CommentStart())?[hK+1,[hO.substring(hM),cR.add_cols(hM,hS)]]:cS.StartsWith(hO,cR.CommentEnd())?[hK-1,[hO.substring(hN),cR.add_cols(hN,hS)]]:cS.StartsWith(hO,"\\r\\n")?[hK,[hO.substring(2),[hR+1,0]]]:cS.StartsWith(hO,"\\r")||cS.StartsWith(hO,"\\n")?[hK,[hO.substring(1),[hR+1,0]]]:[hK,[hO.substring(1),cR.add_cols(1,hS)]]);hK=hT[0];hL=hT[1];}}}return function(hK){return hJ(hI,hK);};};cR.plookAheadWith=function(hI){return function(hJ){var hK,hL,hM;hK=hJ[1];hL=[hJ[0],hK];hM=hI(hL);return hM.$==1?{$:0,$0:hM.$0,$1:hL}:hM.$==2?{$:2,$0:hM.$0,$1:hK}:hM.$==3?{$:2,$0:hM.$0,$1:hK}:{$:0,$0:hM.$0,$1:hL};};};cR.attempt=function(hI){return cR.pTry(hI);};cR.sepEndBy1Amb=function(hI,hJ,hK){return cR.op_GreaterGreaterEquals(cR.op_DotGreaterGreater(hI,cR.spaces()),function(hL){var hM,hN;return cR.op_GreaterGreaterEquals((hM=cR.op_DotGreaterGreater(cR.op_GreaterGreaterGreaterGreater(hK,hI),cR.spaces()),(hN=cR.op_BarGreaterGreater(cR.op_LessBarGreater(hJ,cR.pTry(cR.op_GreaterGreaterGreaterGreater(hK,hJ))),a.ignore),function(hO){return cR.manyUntil(hM,hN,hO[0],hO[1]);})),function(hO){return cR.preturn(new bY({$:1,$0:hL,$1:hO}));});});};cR.sepEndBy1Try=function(hI,hJ){return cR.op_DotGreaterGreater(cR.op_BarGreaterGreater(cR.op_DotGreaterGreaterDot(hI,cR.many(cR.pTry(cR.op_GreaterGreaterDot(hJ,hI)))),function(hK){return new bY({$:1,$0:hK[0],$1:hK[1]});}),cR.opt(hJ));};cR.plookAhead=function(hI){return function(hJ){var hK,hL,hM;hK=hJ[1];hL=[hJ[0],hK];hM=hI(hL);return hM.$==1?{$:0,$0:null,$1:hL}:hM.$==2?{$:2,$0:hM.$0,$1:hK}:hM.$==3?{$:2,$0:hM.$0,$1:hK}:{$:0,$0:null,$1:hL};};};cR.list_of=function(hI){return cR.op_GreaterGreaterGreaterGreater(cR.kw("["),cR.sepEndByAmb(hI,cR.kw("]"),cR.kw(";")));};cR.angleBrackets=function(hI){return(cR.bracket("<",">"))(hI);};cR.CommentEnd=function(){eV.$cctor();return eV.CommentEnd;};cR.chainl1=function(hI,hJ){return cR.op_BarGreaterGreater(cR.op_DotGreaterGreaterDot(hI,cR.many(cR.op_DotGreaterGreaterDot(hJ,hI))),function(hK){return co.fold(function(hL,hM){return(hM[0](hL))(hM[1]);},hK[0],hK[1]);});};cR.pipe3=function(hI,hJ,hK,hL){return cR.op_BarGreaterGreater(cR.op_DotGreaterGreaterDot(cR.op_DotGreaterGreaterDot(hI,hJ),hK),function(hM){var hN;hN=hM[0];return hL(hN[0],hN[1],hM[1]);});};cR.lookAhead=function(hI){return function(hJ){var hK,hL;hK=hJ[0];hL=hJ[1];return cS.StartsWith(hK,hI)?{$:0,$0:null,$1:[hK,hL]}:{$:2,$0:hI,$1:hL};};};cR.anyChar=function(){eV.$cctor();return eV.anyChar;};cR.pfix=function(hI,hJ){var hK;hK=cR.choice([cR.op_GreaterGreaterEquals(hI(hJ),function(hL){return cR.pfix(hI,hL);}),cR.preturn(hJ)]);return function(hL){return hK([hL[0],hL[1]]);};};cR.pcolour=function(){eV.$cctor();return eV.pcolour;};cR.tuple_of=function(hI){return cR.op_LessBarGreater(cR.paren(cR.sepBy2(hI,cR.skw(","))),cR.op_BarGreaterGreater(hI,function(hJ){return bX.ofArray([hJ]);}));};cR.satisfy=function(hI){return function(hJ){var hK,hL,hM,hN;hK=hJ[0];hL=hJ[1];hM=co.tryHead(hK);return hM==null?{$:2,$0:hK,$1:hL}:(hN=hM.$0,hI(hN)?{$:1,$0:hN,$1:[cS.Substring(hK,1,hK.length-1),(cR.add_row())(hL)]}:{$:2,$0:hK,$1:hL});};};cR.manyChars=function(hI){return cR.op_BarGreaterGreater(cR.op_BarGreaterGreater(cR.many(hI),function(hJ){return bX.map(a.id,hJ);}),function(hJ){return cS.concat("",hJ);});};cR.add_row=function(){eV.$cctor();return eV.add_row;};cR.op_GreaterGreaterPlus=function(hI,hJ){return cR.op_BarGreaterGreater(cR.op_PlusGreaterGreaterPlus(hI,hJ),function(hK){return hK[1];});};cS.concat=function(hI,hJ){return ck.ofSeq(hJ).join(hI);};cS.PadLeft=function(hI,hJ){return cS.PadLeftWith(hI,hJ," ");};cS.SplitChars=function(hI,hJ,hK){return cS.Split(hI,new a.RegExp("["+cS.RegexEscape(hJ.join(""))+"]"),hK);};cS.PadLeftWith=function(hI,hJ,hK){return hJ>hI.length?a.Array(hJ-hI.length+1).join(hK)+hI:hI;};cS.Replace=function(hI,hJ,hK){function hL(hM){var hN,hO,hP;hN=hM.indexOf(hJ);return hN!==-1?(hO=cS.ReplaceOnce(hM,hJ,hK),(hP=hN+hK.length,cS.Substring(hO,0,hN+hK.length)+hL(hO.substring(hP)))):hM;}return hL(hI);};cS.SplitStrings=function(hI,hJ,hK){return cS.Split(hI,new a.RegExp(cS.concat("|",ck.map(cS.RegexEscape,hJ))),hK);};cS.Split=function(hI,hJ,hK){return hK===1?ck.filter(function(hL){return hL!=="";},cS.SplitWith(hI,hJ)):cS.SplitWith(hI,hJ);};cS.RegexEscape=function(hI){return hI.replace(new a.RegExp("[-\\\\/\\\\\\\\^$*+?.()|[\\\\]{}]","g"),"\\\\$&");};cS.map=function(hI,hJ){return cS.collect(hI,cS.protect(hJ));};cS.Join=function(hI,hJ){return hJ.join(hI);};cS.length=function(hI){return cS.protect(hI).length;};cS.StartsWith=function(hI,hJ){return hI.substring(0,hJ.length)==hJ;};cS.Remove=function(hI,hJ,hK){return hI.substring(0,hJ)+hI.substring(hJ+hK);};cS.EndsWith=function(hI,hJ){return hI.substring(hI.length-hJ.length)==hJ;};cS.Substring=function(hI,hJ,hK){return hI.substr(hJ,hK);};cS.ReplaceOnce=function(hI,hJ,hK){return hI.replace(hJ,hK);};cS.ToCharArray=function(hI){return ck.init(hI.length,function(hJ){return hI[hJ];});};cS.SplitWith=function(hI,hJ){return hI.split(hJ);};cS.collect=function(hI,hJ){return ck.init(hJ.length,function(hK){return hI(hJ[hK]);}).join("");};cS.protect=function(hI){return hI===null?"":hI;};cS.iter=function(hI,hJ){co.iter(hI,cS.protect(hJ));};cS.Trim=function(hI){return hI.replace(new a.RegExp("^\\\\s+"),"").replace(new a.RegExp("\\\\s+$"),"");};cS.ReplaceChar=function(hI,hJ,hK){return cS.Replace(hI,hJ,hK);};cS.IsNullOrEmpty=function(hI){return hI==null||hI=="";};cT.to_string=function(hI){return cT.display(false,hI);};cT.display=function(hI,hJ){function hK(hQ){return hI?"<font color=#990000>"+hQ+"</font>":hQ;}function hL(hQ){return hI?"<font color=#009900>\\""+hQ+"\\"</font>":"\\""+hQ+"\\"";}function hM(hQ){return hI?"<font color=#009900>\'"+hQ+"\'</font>":hQ;}function hN(hQ){return hK(" "+cT.display_operator(hQ)+" ");}function hO(hQ){var hR,hS;switch(hQ.$==1?1:hQ.$==2?(hR=[hQ.$1,hQ.$2,hQ.$0,hQ.$3],2):hQ.$==3?(hR=[hQ.$1,hQ.$3,hQ.$0,hQ.$4],2):hQ.$==4?3:hQ.$==5?4:hQ.$==6?5:hQ.$==7?6:hQ.$==8?7:hQ.$==9?8:hQ.$==13?9:hQ.$==14?10:hQ.$==10?11:hQ.$==11?12:hQ.$==12?13:0){case 0:return hL(hQ.$0);case 1:return a.String(hQ.$0);case 2:hS=hR[0];return hR[2]+(hS<=0?"":"."+a.String(hS));case 3:return hK(a.String(hQ.$0));case 4:return hM(a.String(hQ.$0.charCodeAt()));case 5:return dZ.display_float(hQ.$0);case 6:return hQ.$0;case 7:return hK("(")+hO(hQ.$0)+hN(hQ.$1)+hO(hQ.$2)+hK(")");case 8:return hK("-")+hO(hQ.$0);case 9:return"ceiling("+hO(hQ.$0)+")";case 10:return"floor("+hO(hQ.$0)+")";case 11:return hK("show ")+hO(hQ.$0);case 12:return hK("(")+hK(cT.display_function(hQ.$0))+" "+hO(hQ.$1)+hK(")");case 13:return hP(hQ.$0);}}function hP(hQ){function hR(hS){return hS.$==1?hS.$1.$==0?hO(hS.$0):hO(hS.$0)+hK(",")+hR(hS.$1):"";}return hK("(")+hR(hQ)+hK(")");}return hO(hJ);};cT["eval"]=function(hI,hJ){var hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0,h1,h2,h3,h4,h5,h6,h7,h8,h9,h_,h$,ia,ib,ic,id,ie,_if,ig,ih,ii,ij,ik,il,im,_in;if(hJ.$==7)return cT.env_lookup(hJ.$0,hI);else if(hJ.$==8){if(hJ.$1.$==1){hY=hJ.$3;hZ=cT["eval"](hI,hJ.$0);h0=cT["eval"](hI,hJ.$2);switch(hZ.$==1?h0.$==1?(hK=[hZ.$0,h0.$0],0):(hK=[hZ,h0],2):hZ.$==6?h0.$==6?(hK=[hZ.$0,h0.$0],1):(hK=[hZ,h0],2):(hK=[hZ,h0],2)){case 0:return{$:1,$0:hK[0]-hK[1],$1:hY};case 1:return{$:6,$0:hK[0]-hK[1],$1:hY};case 2:return{$:8,$0:hK[0],$1:f7.Minus,$2:hK[1],$3:hY};}}else if(hJ.$1.$==2){h1=hJ.$3;h2=cT["eval"](hI,hJ.$0);h3=cT["eval"](hI,hJ.$2);switch(h2.$==1?h3.$==1?(hL=[h2.$0,h3.$0],0):(hL=[h2,h3],3):h2.$==6?h3.$==6?(hL=[h2.$0,h3.$0],1):(hL=[h2,h3],3):h2.$==4?h3.$==4?(hL=[h2.$0,h3.$0],2):(hL=[h2,h3],3):(hL=[h2,h3],3)){case 0:return{$:1,$0:hL[0]*hL[1],$1:h1};case 1:return{$:6,$0:hL[0]*hL[1],$1:h1};case 2:return{$:4,$0:hL[0]&&hL[1],$1:h1};case 3:return{$:8,$0:hL[0],$1:f7.Mul,$2:hL[1],$3:h1};}}else if(hJ.$1.$==3){h4=hJ.$3;h5=cT["eval"](hI,hJ.$0);h6=cT["eval"](hI,hJ.$2);switch(h5.$==1?h6.$==1?(hM=[h5.$0,h6.$0],0):(hM=[h5,h6],2):h5.$==6?h6.$==6?(hM=[h5.$0,h6.$0],1):(hM=[h5,h6],2):(hM=[h5,h6],2)){case 0:return{$:1,$0:hM[0]/hM[1]>>0,$1:h4};case 1:return{$:6,$0:hM[0]/hM[1],$1:h4};case 2:return{$:8,$0:hM[0],$1:f7.Div,$2:hM[1],$3:h4};}}else if(hJ.$1.$==4){h7=hJ.$3;h8=cT["eval"](hI,hJ.$0);h9=cT["eval"](hI,hJ.$2);switch(h8.$==1?h9.$==1?(hN=[h8.$0,h9.$0],0):(hN=[h8,h9],2):h8.$==6?h9.$==1?(hN=[h8.$0,h9.$0],1):(hN=[h8,h9],2):(hN=[h8,h9],2)){case 0:return{$:1,$0:hC.pow(hN[0],hN[1]),$1:h7};case 1:return{$:6,$0:hC.pow(hN[0],hN[1]),$1:h7};case 2:return{$:8,$0:hN[0],$1:f7.Power,$2:hN[1],$3:h7};}}else if(hJ.$1.$==5){h_=hJ.$3;h$=cT["eval"](hI,hJ.$0);ia=cT["eval"](hI,hJ.$2);switch(h$.$==1?ia.$==1?(hO=[h$.$0,ia.$0],0):(hO=[h$,ia],2):h$.$==6?ia.$==6?(hO=[h$.$0,ia.$0],1):(hO=[h$,ia],2):(hO=[h$,ia],2)){case 0:ib=hO[1];return{$:1,$0:(ic=hO[0],cw.Compare(ic,ib)===1?ic:ib),$1:h_};case 1:id=hO[1];return{$:6,$0:(ie=hO[0],cw.Compare(ie,id)===1?ie:id),$1:h_};case 2:return{$:8,$0:hO[0],$1:f7.Max,$2:hO[1],$3:h_};}}else if(hJ.$1.$==6){_if=hJ.$3;ig=cT["eval"](hI,hJ.$0);ih=cT["eval"](hI,hJ.$2);switch(ig.$==1?ih.$==1?(hP=[ig.$0,ih.$0],0):(hP=[ig,ih],2):ig.$==6?ih.$==6?(hP=[ig.$0,ih.$0],1):(hP=[ig,ih],2):(hP=[ig,ih],2)){case 0:return{$:1,$0:be.toInt(br.moduloFloat(hP[0],hP[1])),$1:_if};case 1:return{$:6,$0:br.moduloFloat(hP[0],hP[1]),$1:_if};case 2:return{$:8,$0:hP[0],$1:f7.Modulo,$2:hP[1],$3:_if};}}else{ii=hJ.$3;ij=cT["eval"](hI,hJ.$0);ik=cT["eval"](hI,hJ.$2);switch(ij.$==1?ik.$==1?(hQ=[ij.$0,ik.$0],0):(hQ=[ij,ik],4):ij.$==6?ik.$==6?(hQ=[ij.$0,ik.$0],1):(hQ=[ij,ik],4):ij.$==4?ik.$==4?(hQ=[ij.$0,ik.$0],2):(hQ=[ij,ik],4):ij.$==0?ik.$==0?(hQ=[ij.$0,ik.$0],3):(hQ=[ij,ik],4):(hQ=[ij,ik],4)){case 0:return{$:1,$0:hQ[0]+hQ[1],$1:ii};case 1:return{$:6,$0:hQ[0]+hQ[1],$1:ii};case 2:return{$:4,$0:hQ[0]||hQ[1],$1:ii};case 3:return{$:0,$0:hQ[0]+hQ[1],$1:ii};case 4:return{$:8,$0:hQ[0],$1:f7.Plus,$2:hQ[1],$3:ii};}}}else if(hJ.$==9){hR=hJ.$1;hS=cT["eval"](hI,hJ.$0);return hS.$==4?{$:4,$0:!hS.$0,$1:hR}:hS.$==1?{$:1,$0:-hS.$0,$1:hR}:hS.$==6?{$:6,$0:-hS.$0,$1:hR}:{$:9,$0:hS,$1:hR};}else if(hJ.$==10)return{$:0,$0:cT.to_string(cT["eval"](hI,hJ.$0)),$1:hJ.$1};else if(hJ.$==11){il=hJ.$0;im=hJ.$2;_in=cT["eval"](hI,hJ.$1);switch(il.$==1?_in.$==1?0:(hT=_in,3):il.$==0?_in.$==6?1:(hT=_in,3):il.$==2?_in.$==6?2:(hT=_in,3):(hT=_in,3)){case 0:return{$:6,$0:_in.$0,$1:im};case 1:return{$:1,$0:be.toInt(_in.$0),$1:im};case 2:return{$:6,$0:hC.sqrt(_in.$0),$1:im};case 3:return{$:11,$0:il,$1:hT,$2:im};}}else return hJ.$==12?{$:12,$0:bX.map(function(io){return cT["eval"](hI,io);},hJ.$0),$1:hJ.$1}:hJ.$==13?(hU=hJ.$1,hV=cT["eval"](hI,hJ.$0),hV.$==1?{$:1,$0:hV.$0,$1:hU}:hV.$==6?{$:6,$0:hC.ceil(hV.$0),$1:hU}:{$:13,$0:hV,$1:hU}):hJ.$==14?(hW=hJ.$1,hX=cT["eval"](hI,hJ.$0),hX.$==1?{$:1,$0:hX.$0,$1:hW}:hX.$==6?{$:6,$0:hC.floor(hX.$0),$1:hW}:{$:14,$0:hX,$1:hW}):hJ;};cT.to_engineValue=function(hI){var hJ;switch(hI.$==1?(hJ=hI.$0,0):hI.$==6?(hJ=hI.$0,1):hI.$==7?(hJ=hI.$0,2):hI.$==8?hI.$1.$==0?(hJ=[hI.$0,hI.$2],3):hI.$1.$==1?(hJ=[hI.$0,hI.$2],4):hI.$1.$==2?(hJ=[hI.$0,hI.$2],5):hI.$1.$==3?(hJ=[hI.$0,hI.$2],6):hI.$1.$==4?(hJ=[hI.$0,hI.$2],7):hI.$1.$==6?(hJ=[hI.$0,hI.$2],8):(hJ=hI,11):hI.$==14?(hJ=hI.$0,9):hI.$==13?(hJ=hI.$0,10):(hJ=hI,11)){case 0:return{$:1,$0:hJ};case 1:return{$:1,$0:hJ};case 2:return{$:0,$0:hJ};case 3:return br.add(cT.to_engineValue(hJ[0]),cT.to_engineValue(hJ[1]));case 4:return br.sub(cT.to_engineValue(hJ[0]),cT.to_engineValue(hJ[1]));case 5:return br.mul(cT.to_engineValue(hJ[0]),cT.to_engineValue(hJ[1]));case 6:return br.div(cT.to_engineValue(hJ[0]),cT.to_engineValue(hJ[1]));case 7:return br.power$1(cT.to_engineValue(hJ[0]),cT.to_engineValue(hJ[1]));case 8:return br.modulo$1(cT.to_engineValue(hJ[0]),cT.to_engineValue(hJ[1]));case 9:return{$:11,$0:cT.to_engineValue(hJ)};case 10:return{$:10,$0:cT.to_engineValue(hJ)};case 11:return be.FailWith("Value cannot be mapped to Term.Prim.t: "+cT.to_string(hJ));}};cT.to_strings=function(hI){return cT.displays(false,hI);};cT.display_function=function(hI){return hI.$==1?"float_of_int":hI.$==2?"sqrt":hI.$==3?"rate":"int_of_float";};cT.display_operator=function(hI){return hI.$==1?"-":hI.$==2?"*":hI.$==3?"/ ":hI.$==4?"**":hI.$==5?"max":hI.$==6?"%":"+";};cT.parse=function(){gV.$cctor();return gV.parse;};cT.free_names=function(hI){return hI.$==7?bX.ofArray([[hI.$0,hI.$1]]):hI.$==8?bX.append(cT.free_names(hI.$0),cT.free_names(hI.$2)):hI.$==9?cT.free_names(hI.$0):hI.$==13?cT.free_names(hI.$0):hI.$==14?cT.free_names(hI.$0):hI.$==10?cT.free_names(hI.$0):hI.$==11?cT.free_names(hI.$1):hI.$==12?bX.collect(cT.free_names,hI.$0):bY.Empty;};cT.inferType=function(hI,hJ){function hK(hO,hP,hQ){hQ[0]=ec.update_range(hO,hP);return[hO];}function hL(hO,hP,hQ,hR){bX.iter(function(hS){hS[0]=ec.update_range(hQ,hR);},hO);return hK(hQ,hR,hP);}function hM(hO,hP){var hQ;switch(hP.$==2?1:hP.$==1?2:hP.$==3?2:hP.$==4?2:hP.$==5?2:hP.$==6?3:0){case 0:return[function(hR){return hR.$==3||(hR.$==6||(hR.$==4||(hR.$==2||(hR.$==1||hR.$==0))));},bX.ofArray([{$:3,$0:hO},{$:6,$0:hO},{$:4,$0:hO},{$:2,$0:hO}])];case 1:return[function(hR){return hR.$==3||(hR.$==6||(hR.$==4||(hR.$==1||hR.$==0)));},bX.ofArray([{$:3,$0:hO},{$:6,$0:hO},{$:4,$0:hO}])];case 2:return[function(hR){return hR.$==3||(hR.$==6||(hR.$==1||hR.$==0));},bX.ofArray([{$:3,$0:hO},{$:6,$0:hO}])];case 3:return[function(hR){return hR.$==3||(hR.$==6||(hR.$==4||(hR.$==2||(hR.$==1||hR.$==0))));},bX.ofArray([{$:3,$0:hO},{$:6,$0:hO},{$:4,$0:hO},{$:2,$0:hO}])];}}function hN(hO){var hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0,h1,h2,h3,h4,h5,h6,h7,h8,h9,h_,h$,ia,ib,ic,id,ie,_if,ig,ih,ii;switch(hO.$==1?(hP=hO.$1,1):hO.$==13?(hP=hO.$1,2):hO.$==14?(hP=hO.$1,3):hO.$==2?4:hO.$==3?4:hO.$==4?(hP=hO.$1,5):hO.$==5?(hP=hO.$1,6):hO.$==6?(hP=hO.$1,7):hO.$==12?(hP=[hO.$1,hO.$0],8):hO.$==7?(hP=[hO.$0,hO.$1],9):hO.$==8?(hP=[hO.$1,hO.$3,hO.$0,hO.$2],10):hO.$==9?(hP=[hO.$1,hO.$0],11):hO.$==10?(hP=[hO.$1,hO.$0],12):hO.$==11?hO.$0.$==1?(hP=[hO.$2,hO.$1],14):hO.$0.$==2?(hP=[hO.$2,hO.$1],15):hO.$0.$==3?16:(hP=[hO.$2,hO.$1],13):(hP=hO.$1,0)){case 0:return[{$:2,$0:hP}];case 1:return[{$:3,$0:hP}];case 2:return[{$:3,$0:hP}];case 3:return[{$:3,$0:hP}];case 4:return be.FailWith("domain exists at type check!");case 5:return[{$:4,$0:hP}];case 6:return[{$:5,$0:hP}];case 7:return[{$:6,$0:hP}];case 8:return[{$:8,$0:bX.map(hN,hP[1]),$1:hP[0]}];case 9:hQ=hP[0];hR=dZ.try_assoc(hQ,hI);return hR==null?fc.type_error(hP[1],{$:0,$0:hQ}):hR.$0;case 10:hS=hP[0];hT=hP[1];hU=hP[2];hV=hP[3];hW=hM(hT,hS);hX=hW[1];hY=hW[0];hZ=hN(hU);h0=hN(hV);return hY(hZ[0])?hY(h0[0])?ec.unify(hT,hZ,h0)?hZ:cT.opError(hV,h0[0],ec.unify_possibilities(hT,hX,hZ[0]),"second",hS):cT.opError(hV,h0[0],hX,"second",hS):cT.opError(hU,hZ[0],hX,"first",hS);case 11:h1=hP[0];h2=hP[1];h3=hN(h2);h4=h3[0];return h4.$==6?h3:h4.$==3?h3:h4.$==4?h3:h4.$==1?h4.$1==null?(h5=h4.$0,hL(h5,h3,{$:1,$0:h5,$1:{$:1,$0:false},$2:bX.ofArray([h1])},h1)):h3:h4.$==0?(h3[0]={$:1,$0:bY.Empty,$1:{$:1,$0:false},$2:bX.ofArray([h1])},h3):fc.type_error(cT.get_range(h2),{$:1,$0:h4,$1:bX.ofArray([{$:3,$0:h1},{$:6,$0:h1},{$:4,$0:h1}]),$2:"argument of negation operator"});case 12:hN(hP[1]);return[{$:2,$0:hP[0]}];case 13:h6=hP[0];h7=hP[1];h8=hN(h7);h9=h8[0];return h9.$==6?[{$:3,$0:h6}]:h9.$==0?(h8[0]={$:6,$0:h6},[{$:3,$0:h6}]):h9.$==1?(hL(h9.$0,h8,{$:6,$0:h6},h6),[{$:3,$0:h6}]):(h_="argument of "+cT.display_function(gp.Float2Int),fc.type_error(cT.get_range(h7),{$:1,$0:h9,$1:bX.ofArray([{$:6,$0:h6}]),$2:h_}));case 14:h$=hP[0];ia=hP[1];ib=hN(ia);ic=ib[0];return ic.$==3?[{$:6,$0:h$}]:ic.$==0?(ib[0]={$:3,$0:h$},[{$:6,$0:h$}]):ic.$==1?(hL(ic.$0,ib,{$:3,$0:h$},h$),[{$:6,$0:h$}]):(id="argument of "+cT.display_function(gp.Int2Float),fc.type_error(cT.get_range(ia),{$:1,$0:ic,$1:bX.ofArray([{$:3,$0:h$}]),$2:id}));case 15:ie=hP[0];_if=hP[1];ig=hN(_if);ih=ig[0];return ih.$==6?ig:ih.$==0?(ig[0]={$:6,$0:ie},ig):ih.$==1?hL(ih.$0,ig,{$:6,$0:ie},ie):(ii="argument of "+cT.display_function(gp.Sqrt),fc.type_error(cT.get_range(_if),{$:1,$0:ih,$1:bX.ofArray([{$:6,$0:ie}]),$2:ii}));case 16:return be.FailWith("rate function not implemented");}}return hN(hJ);};cT.erasePosns=function(hI){return hI.$==1?{$:1,$0:hI.$0,$1:ec.emprange()}:hI.$==2?{$:2,$0:hI.$0,$1:hI.$1,$2:hI.$2,$3:hI.$3,$4:ec.emprange()}:hI.$==3?{$:3,$0:hI.$0,$1:hI.$1,$2:hI.$2,$3:hI.$3,$4:hI.$4,$5:ec.emprange()}:hI.$==4?{$:4,$0:hI.$0,$1:ec.emprange()}:hI.$==5?{$:5,$0:hI.$0,$1:ec.emprange()}:hI.$==6?{$:6,$0:hI.$0,$1:ec.emprange()}:hI.$==7?{$:7,$0:hI.$0,$1:ec.emprange()}:hI.$==8?{$:8,$0:cT.erasePosns(hI.$0),$1:hI.$1,$2:cT.erasePosns(hI.$2),$3:ec.emprange()}:hI.$==9?{$:9,$0:cT.erasePosns(hI.$0),$1:ec.emprange()}:hI.$==10?{$:10,$0:cT.erasePosns(hI.$0),$1:ec.emprange()}:hI.$==11?{$:11,$0:hI.$0,$1:cT.erasePosns(hI.$1),$2:ec.emprange()}:hI.$==12?{$:12,$0:bX.map(cT.erasePosns,hI.$0),$1:ec.emprange()}:hI.$==13?{$:13,$0:cT.erasePosns(hI.$0),$1:ec.emprange()}:hI.$==14?{$:14,$0:cT.erasePosns(hI.$0),$1:ec.emprange()}:{$:0,$0:hI.$0,$1:ec.emprange()};};cT.matching=function(hI,hJ){return hI.$==2?hJ.$==7?hJ.$0==="_":hJ.$==2&&(hI.$0===hJ.$0&&hI.$1===hJ.$1):hI.$==3?hJ.$==7?hJ.$0==="_":hJ.$==3&&(hI.$0===hJ.$0&&hI.$1===hJ.$1):hI.$==0?hJ.$==7?hJ.$0==="_":hJ.$==0&&hI.$0===hJ.$0:hI.$==1?hJ.$==7?hJ.$0==="_":hJ.$==1&&hI.$0===hJ.$0:hI.$==4?hJ.$==7?hJ.$0==="_":hJ.$==4&&cw.Equals(hI.$0,hJ.$0):hI.$==5?hJ.$==7?hJ.$0==="_":hJ.$==5&&hI.$0===hJ.$0:hI.$==6?hJ.$==7?hJ.$0==="_":hJ.$==6&&hI.$0===hJ.$0:hI.$==8?hJ.$==7?hJ.$0==="_":hJ.$==8&&(cT.matching(hI.$0,hJ.$0)&&cT.matching(hI.$2,hJ.$2)&&cw.Equals(hI.$1,hJ.$1)):hI.$==9?hJ.$==7?hJ.$0==="_":hJ.$==9&&cT.matching(hI.$0,hJ.$0):hI.$==13?hJ.$==7?hJ.$0==="_":hJ.$==13&&cT.matching(hI.$0,hJ.$0):hI.$==14?hJ.$==7?hJ.$0==="_":hJ.$==14&&cT.matching(hI.$0,hJ.$0):hI.$==10?hJ.$==7?hJ.$0==="_":hJ.$==10&&cT.matching(hI.$0,hJ.$0):hI.$==11?hJ.$==7?hJ.$0==="_":hJ.$==11&&(cw.Equals(hI.$0,hJ.$0)&&cT.matching(hI.$1,hJ.$1)):hI.$==12?hJ.$==7?hJ.$0==="_":hJ.$==12&&co.fold(function(hK,hL){return hK&&hL;},true,bX.map2(cT.matching,hI.$0,hJ.$0)):hI.$0==="_"||hJ.$==7&&(hJ.$0==="_"||hI.$0===hJ.$0);};cT.varInEnv=function(hI,hJ){var hK,hL,hM,hN;while(true)if(hI.$==1){if(hI.$0.$==1){hK=hI.$1;hL=hI.$0.$0;if(hL===hJ)return true;else hI=hK;}else{hM=hI.$1;hN=hI.$0.$0;if(hN===hJ)return true;else hI=hM;}}else return false;};cT.env_lookup=function(hI,hJ){var hK,hL,hM,hN,hO,hP;while(true)if(hJ.$==1){if(hJ.$0.$==1){hK=hJ.$1;hL=hJ.$0.$0;hM=hJ.$0.$1;if(hI===hL)return hM;else hJ=hK;}else{hN=hJ.$1;hO=hJ.$0.$0;hP=hJ.$0.$1;if(hI===hO)return hP;else hJ=hN;}}else return{$:7,$0:hI,$1:null};};cT.displays=function(hI,hJ){return cT.display(hI,{$:12,$0:hJ,$1:ec.emprange()});};cT.set_range=function(hI,hJ){return hJ.$==1?{$:1,$0:hJ.$0,$1:hI}:hJ.$==2?{$:2,$0:hJ.$0,$1:hJ.$1,$2:hJ.$2,$3:hJ.$3,$4:hI}:hJ.$==3?{$:3,$0:hJ.$0,$1:hJ.$1,$2:hJ.$2,$3:hJ.$3,$4:hJ.$4,$5:hI}:hJ.$==4?{$:4,$0:hJ.$0,$1:hI}:hJ.$==5?{$:5,$0:hJ.$0,$1:hI}:hJ.$==6?{$:6,$0:hJ.$0,$1:hI}:hJ.$==7?{$:7,$0:hJ.$0,$1:hI}:hJ.$==8?{$:8,$0:cT.set_range(hI,hJ.$0),$1:hJ.$1,$2:cT.set_range(hI,hJ.$2),$3:hI}:hJ.$==9?{$:9,$0:cT.set_range(hI,hJ.$0),$1:hI}:hJ.$==14?{$:14,$0:cT.set_range(hI,hJ.$0),$1:hI}:hJ.$==13?{$:13,$0:cT.set_range(hI,hJ.$0),$1:hI}:hJ.$==10?{$:10,$0:cT.set_range(hI,hJ.$0),$1:hI}:hJ.$==11?{$:11,$0:hJ.$0,$1:cT.set_range(hI,hJ.$1),$2:hI}:hJ.$==12?{$:12,$0:bX.map(function(hK){return cT.set_range(hI,hK);},hJ.$0),$1:hI}:{$:0,$0:hJ.$0,$1:hI};};cT.opError=function(hI,hJ,hK,hL,hM){return fc.type_error(cT.get_range(hI),{$:1,$0:hJ,$1:hK,$2:hL+" argument of "+cT.display_operator(hM)});};cT.get_range=function(hI){return hI.$==1?hI.$1:hI.$==2?hI.$4:hI.$==3?hI.$5:hI.$==4?hI.$1:hI.$==5?hI.$1:hI.$==6?hI.$1:hI.$==7?hI.$1:hI.$==8?hI.$3:hI.$==9?hI.$1:hI.$==10?hI.$1:hI.$==11?hI.$2:hI.$==12?hI.$1:hI.$==13?hI.$1:hI.$==14?hI.$1:hI.$1;};cT.parseWithPos=function(hI,hJ,hK,hL,hM){return(cR.op_GreaterGreaterEquals(hI,function(hN){return function(hO){var hP;hP=hO[1];return(cR.preturn(hJ(hK(hN,ec.mkRange(hM,hP)))))([hO[0],hP]);};}))([hL,hM]);};cT.punder=function(){gV.$cctor();return gV.punder;};cT.parseFun=function(hI,hJ,hK){var hL;function hM(hO,hP,hQ){return{$:11,$0:hO,$1:hP,$2:hQ};}function hN(hO,hP){return[hO[0],hO[1],hP];}hL=cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(cR.kw(hI),hK()),function(hO){return cR.preturn([hJ,hO]);});return function(hO){return cT.parseWithPos(hL,function(hP){return hM(hP[0],hP[1],hP[2]);},hN,hO[0],hO[1]);};};cT.parseOp=function(hI,hJ,hK){var hL;function hM(hO,hP,hQ,hR){return{$:8,$0:hO,$1:hP,$2:hQ,$3:hR};}function hN(hO,hP){return[hO[0],hO[1],hO[2],hP];}hL=cR.op_GreaterGreaterEquals(function(hO){return cT.parseTerm(hK,hO[0],hO[1]);},function(hO){return cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(cR.kw(hI),hK()),function(hP){return cR.preturn([hO,hJ,hP]);});});return function(hO){return cT.parseWithPos(hL,function(hP){return hM(hP[0],hP[1],hP[2],hP[3]);},hN,hO[0],hO[1]);};};cT.do_parse=function(){var hI;hI=cR.choice([function(hJ){return cT.parseTerm(cT.do_parse,hJ[0],hJ[1]);},(cT.parseAdd())(cT.do_parse),(cT.parseSub())(cT.do_parse),(cT.parseMul())(cT.do_parse),(cT.parseDiv())(cT.do_parse),(cT.parsePow())(cT.do_parse)]);return function(hJ){return hI([hJ[0],hJ[1]]);};};cT.bind_rate=function(hI,hJ){var hK;hK=cT.to_engineValue(hJ);return hI.$==2?br.mul(hI.$2,hK):hI.$==3?br.mul(hI.$3,hK):be.FailWith("bind_rate - not a domain.");};cT.unbind_rate=function(hI){return hI.$==2?hI.$3:hI.$==3?hI.$4:be.FailWith("unbind_rate - not a domain.");};cT.parseTerm=function(hI,hJ,hK){return(cR.choice([cT.parseString(),cT.parseFloat(),cT.parseInt(),cT.parseBool(),cT.parseChar(),cT.parseUScore(),cT.parseName(),cT.parsePair(hI),(cT.parseIntToFloat())(hI),(cT.parseFloatToInt())(hI),cR.paren(hI())]))([hJ,hK]);};cT.parseAdd=function(){gV.$cctor();return gV.parseAdd;};cT.parseSub=function(){gV.$cctor();return gV.parseSub;};cT.parseMul=function(){gV.$cctor();return gV.parseMul;};cT.parseDiv=function(){gV.$cctor();return gV.parseDiv;};cT.parsePow=function(){gV.$cctor();return gV.parsePow;};cT.parseString=function(){gV.$cctor();return gV.parseString;};cT.parseFloat=function(){gV.$cctor();return gV.parseFloat;};cT.parseInt=function(){gV.$cctor();return gV.parseInt;};cT.parseBool=function(){gV.$cctor();return gV.parseBool;};cT.parseChar=function(){gV.$cctor();return gV.parseChar;};cT.parseUScore=function(){gV.$cctor();return gV.parseUScore;};cT.parseName=function(){gV.$cctor();return gV.parseName;};cT.parsePair=function(hI){var hJ;function hK(hL,hM){return{$:12,$0:hL,$1:hM};}hJ=cR.paren(cR.op_GreaterGreaterEquals(hI(),function(hL){return cR.op_GreaterGreaterDot(cR.kw(","),cR.op_GreaterGreaterEquals(hI(),function(hM){return cR.preturn(bX.ofArray([hL,hM]));}));}));return function(hL){return cT.parseWithPos(hJ,function(hM){return hK(hM[0],hM[1]);},function(hM,hN){var hO;hO=[hM,hN];return hO;},hL[0],hL[1]);};};cT.parseIntToFloat=function(){gV.$cctor();return gV.parseIntToFloat;};cT.parseFloatToInt=function(){gV.$cctor();return gV.parseFloatToInt;};cU.display=function(hI){var hJ,hK,hL,hM,hO;function hN(hP,hQ){return hP+" = "+(hQ.$==2?"\\""+hQ.$0+"\\"":hQ.$==1?cT.to_string(hQ.$0):hQ.$==3?"[ "+cS.concat("; ",hQ.$0[0])+(hQ.$0[1]?"*":""+" ]"):hQ.$0);}if(hI.$==1){hJ="("+cS.concat(", ",eq.toStringList(hI.$0[2]))+")";hK=eb.display(hI.$0[3]);return"def "+hI.$0[0]+hJ+" = "+(hK.indexOf("\\n")!=-1?"\\n  ("+cS.Replace(hK,"\\n","\\n  ")+")":hK)+"\\n"+cU.display(hI.$0[4]);}else if(hI.$==2)return"def "+hI.$0[0]+" = "+cT.to_string(hI.$0[1])+"\\n"+cU.display(hI.$0[2]);else if(hI.$==3)return eb.display(hI.$0);else{hO=hI.$0[0][1];switch(hO.$==1?hO.$0[0]==="bind"?hO.$0[1].$==1?hO.$1.$==1?hO.$1.$0[0]==="unbind"?hO.$1.$0[1].$==1?hO.$1.$1.$==0?(hM=[hO.$0[1].$0,hO.$1.$0[1].$0],1):2:2:2:2:2:hO.$0[0]==="unbind"?hO.$0[1].$==1?hO.$1.$==1?hO.$1.$0[0]==="bind"?hO.$1.$0[1].$==1?hO.$1.$1.$==0?(hM=[hO.$1.$0[1].$0,hO.$0[1].$0],1):2:2:2:2:2:2:0){case 0:hL="";break;case 1:hL=" @ "+cT.to_string(hM[0])+", "+cT.to_string(hM[1]);break;case 2:hL=" = {"+cS.concat("; ",bX.map(function(hP){return hN(hP[0],hP[1]);},hO))+"}";break;}return(hI.$0[1]?"new":"dom")+" "+hI.$0[0][0]+" "+hL+"\\n"+cU.display(hI.$0[2]);}};cU.expand=function(hI,hJ,hK,hL){var hM,hN,hO,hP;function hQ(hR,hS){return{$:0,$0:[[hR,bY.Empty],false,hS]};}hM=bR.getDeclareDomains(hI)?hL:dZ.fold_left(function(hR,hS){return hQ(hS,hR);},hL,dZ.remove_duplicates(function(hR,hS){return hR===hS;},bX.filter(function(hR){return bX.forAll(function(hS){return hR!==hS[0];},hJ);},bX.map(function(hR){return hR[0];},cU.free_names(hL)))));cU.inferTypes(hJ,hM);hN=cU.erasePosns(hM);bX.map(function(hR){return hR[0];},hJ);hO=function(hR,hS,hT,hU,hV,hW){var hX,hY,hZ,h0,h1,h2,h3,h4,h5,h6,h7,h8,h9;while(true)if(hW.$==2){hX=hW.$0[1];hY=hW.$0[2];hZ=hW.$0[0];hU=new bY({$:1,$0:{$:0,$0:hZ,$1:cT["eval"](hU,hX)},$1:hU});hW=hY;}else if(hW.$==1){h0=hW.$0[0];h1=hW.$0[4];h2=hW.$0[3];h3=hW.$0[2];hT=new bY({$:1,$0:{$:0,$0:h0,$1:h3,$2:function(){return false;},$3:h2},$1:hT});hW=h1;}else if(hW.$==3)return[hR,hS,hW.$0,hT,hU,hV];else{h4=hW.$0[0][1];h5=hW.$0[2];h6=hW.$0[0][0];h7=bX.contains(h6,hS)?[hR+1,hR+1,hS]:[hR,0,new bY({$:1,$0:h6,$1:hS})];h8=eb.dom_spec_map(function(h_){return function(h$){return cT["eval"](h_,h$);};}(hU),h4);h9=fb.New(h6,co.tryPick(function(h_){return h_[1].$==2?{$:1,$0:h_[1].$0}:null;},h8),co.tryPick(function(h_){return h_[1].$==3?{$:1,$0:h_[1].$0}:null;},h8));hR=h7[0];hS=h7[2];hU=new bY({$:1,$0:{$:1,$0:h6,$1:eb.eval_system(hI,h6,h7[1],h8)},$1:hU});hV=new bY({$:1,$0:h9,$1:hV});hW=h5;}}(0,bX.map(function(hR){return hR[0];},cU.free_names(hN)),bY.Empty,bY.Empty,bY.Empty,hN);hP=hO[4];return[hO[0],hO[1],hO[2],cU.add_plot_monitors(hP,hK,hO[3]),hP,hO[5]];};cU.free_names=function(hI){var hJ;return hI.$==2?bX.append(cT.free_names(hI.$0[1]),cU.remove_pairlist(bX.ofArray([hI.$0[0]]),cU.free_names(hI.$0[2]))):hI.$==1?(hJ=hI.$0[0],bX.append(cU.remove_pairlist(new bY({$:1,$0:hJ,$1:eq.toStringList(hI.$0[2])}),eb.free_names(hI.$0[3])),cU.remove_pairlist(bX.ofArray([hJ]),cU.free_names(hI.$0[4])))):hI.$==3?eb.free_names(hI.$0):bX.append(bX.collect(function(hK){return hK[1].$==1?cT.free_names(hK[1].$0):bY.Empty;},hI.$0[0][1]),cU.remove_pairlist(bX.ofArray([hI.$0[0][0]]),cU.free_names(hI.$0[2])));};cU.inferTypes=function(hI,hJ){var hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX;while(true)if(hJ.$==2){hK=hJ.$0[1];hL=hJ.$0[2];hM=hJ.$0[0];hN=cT.inferType(hI,hK);hI=new bY({$:1,$0:[hM,hN],$1:hI});hJ=hL;}else if(hJ.$==1){hO=hJ.$0[0];hP=hJ.$0[4];hQ=hJ.$0[3];hR=hJ.$0[2];hS=eq.toTypes(hR);hT=eq.toTypeEnv(hS,hR);eb.inferTypes(null,bX.append(hT,hI),hQ);hI=new bY({$:1,$0:[hO,[{$:9,$0:hS}]],$1:hI});hJ=hP;}else if(hJ.$==3)return eb.inferTypes({$:1,$0:false},hI,hJ.$0);else{hU=hJ.$0[0][1];hV=hJ.$0[2];hW=hJ.$0[0][0];hX=hJ.$0[1];eb.type_check_system(hW,hU,hX,hI);hI=new bY({$:1,$0:[hW,[{$:7,$0:null,$1:ec.emprange()}]],$1:hI});hJ=hV;}};cU.erasePosns=function(hI){return hI.$==2?{$:2,$0:[hI.$0[0],cT.erasePosns(hI.$0[1]),cU.erasePosns(hI.$0[2])]}:hI.$==1?{$:1,$0:[hI.$0[0],ec.emprange(),hI.$0[2],eb.erasePosns(hI.$0[3]),cU.erasePosns(hI.$0[4])]}:hI.$==3?{$:3,$0:eb.erasePosns(hI.$0)}:{$:0,$0:[[hI.$0[0][0],eb.dom_spec_map(cT.erasePosns,hI.$0[0][1])],hI.$0[1],cU.erasePosns(hI.$0[2])]};};cU.add_plot_monitors=function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ,hR,hS;function hT(hV,hW){return dZ.fold_left(function(hX,hY){return hX&&hY;},true,bX.map(function(hX){return cT.varInEnv(hW,hX);},hV));}function hU(hV,hW){var hX,hY,hZ,h0;switch(hV.$==1?hW.$==1?(hX=[hW.$0,hW.$1,hV.$0,hV.$1],1):2:hW.$==0?0:2){case 0:return bY.Empty;case 1:hY=hX[1];hZ=hX[2];h0=hX[3];return hT(hX[0],hP)&&bX.length(hZ)===hQ?new bY({$:1,$0:hZ,$1:hU(h0,hY)}):hU(h0,hY);case 2:return be.FailWith("removeInvalidPats given strings of unequal length");}}return hK.$==1?(hL=hK.$0.$0,(hM=hK.$0.$1,(hN=hK.$0.$3,new bY({$:1,$0:(hO=cU.extract_modules(hL,hJ),co.tryFind(function(hV){return hV.$==0;},hO)==null?(hP=new bY({$:1,$0:{$:0,$0:"_",$1:{$:7,$0:"_",$1:ec.emprange()}},$1:hI}),(hQ=bX.length(hM),(hR=bX.map(function(hV){return hV.$==0?bY.Empty:hV.$0;},hO),(hS=bX.map(function(hV){return bX.map(function(hW){return cT["eval"](hP,hW);},hV);},hU(hR,bX.map(function(hV){return dZ.remove_duplicates(function(hW,hX){return hW===hX;},bX.map(function(hW){return hW[0];},dZ.fold_left(function(hW,hX){return bX.append(cT.free_names(hX),hW);},bY.Empty,hV)));},hR))),{$:0,$0:hL,$1:hM,$2:function(hV){return co.fold(function(hW,hX){return hW||hX;},false,bX.map(function(hW){return co.fold(function(hX,hY){return hX&&hY;},true,bX.map2(cT.matching,hW,hV));},hS));},$3:hN})))):{$:0,$0:hL,$1:hM,$2:function(){return true;},$3:hN}),$1:cU.add_plot_monitors(hI,hJ,hK.$1)})))):bY.Empty;};cU.remove_pairlist=function(hI,hJ){return hJ.$==0?bY.Empty:hI.$==0?hJ:bX.filter(function(hK){return!dZ.contains(hK[0],hI);},hJ);};cU.extract_modules=function(hI,hJ){return hJ.$==1?hJ.$0.$==2?hJ.$0.$0===hI?new bY({$:1,$0:hJ.$0.$1,$1:cU.extract_modules(hI,hJ.$1)}):cU.extract_modules(hI,hJ.$1):be.FailWith("A non-module in module-only list"):bY.Empty;};cV.unify=function(hI){var hJ;hJ=c4.get_id();return function(hK){return cV.unifyInner(hJ,hI,hK);};};cV.unifyInner=function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ,hR,hT,hU,hX,hY,hZ,h0,h1,h2,h3,h5,h6,h7,h8,h9,h_,h$,ia,ib,ic,id,ie,_if,ig,ih,ii,ij,ik,il;function hS(im,_in){return new cW({$:0,$0:im,$1:_in});}function hV(im,_in,io,ip,iq){var ir,is,it,iu;return _in.$==1?(ir=_in.$0,is=_in.$1,it={$:6,$0:bX.append(is,io)},iu=cV.unifyInner(hI,hJ,new bY({$:1,$0:new cW({$:0,$0:im,$1:ir}),$1:new bY({$:1,$0:new cW({$:0,$0:{$:6,$0:ip},$1:it}),$1:hM})})),hV(im,is,new bY({$:1,$0:ir,$1:io}),ip,bX.append(iq,iu))):iq;}function hW(im,_in,io,ip){var iq,ir,is,it;while(true)if(im.$==1){iq=im.$0;ir=im.$1;is=bX.append(io,ir);it=hV(iq,_in,bY.Empty,is,ip);im=ir;io=new bY({$:1,$0:iq,$1:io});ip=it;}else return _in.$==1?ip:cV.unifyInner(hI,hJ,hM);}function h4(im,_in){return new cW({$:0,$0:im,$1:_in});}if(hK.$==1){hM=hK.$1;hN=hK.$0.$0;hO=hK.$0.$1;switch(hN.$==4?hN.$0.$==1?hO.$==5?(hL=[hO.$0,hN.$0.$0,hO.$1,hN.$0.$1],0):hO.$==4?(hL=[hN.$0,hO.$0],4):hO.$==0?hO.$0===-1?hO.$1==="_"?(hL=hN,10):(hL=[hO.$0,hO.$1,hN],14):(hL=[hO.$0,hO.$1,hN],14):15:hO.$==5?hO.$1.$==0?(hL=[hO.$1.$0,hO.$1.$1,hO.$0,hN.$0],2):15:hO.$==4?(hL=[hN.$0,hO.$0],4):hO.$==0?hO.$0===-1?hO.$1==="_"?(hL=hN,10):(hL=[hO.$0,hO.$1,hN],14):(hL=[hO.$0,hO.$1,hN],14):15:hN.$==6?hO.$==6?(hL=[hN.$0,hO.$0],5):hO.$==0?hO.$0===-1?hO.$1==="_"?(hL=hN,10):(hL=[hO.$0,hO.$1,hN],14):(hL=[hO.$0,hO.$1,hN],14):15:hN.$==7?hO.$==7?(hL=[hN.$0,hO.$0],6):hO.$==0?hO.$0===-1?hO.$1==="_"?(hL=hN,10):(hL=[hO.$0,hO.$1,hN],14):(hL=[hO.$0,hO.$1,hN],14):15:hN.$==3?hO.$==3?(hL=[hN.$0,hO.$0,hN.$1,hO.$1],7):hO.$==0?hO.$0===-1?hO.$1==="_"?(hL=hN,10):(hL=[hO.$0,hO.$1,hN],14):(hL=[hO.$0,hO.$1,hN],14):15:hN.$==2?hO.$==2?(hL=[hN.$0,hO.$0],8):hO.$==0?hO.$0===-1?hO.$1==="_"?(hL=hN,10):(hL=[hO.$0,hO.$1,hN],14):(hL=[hO.$0,hO.$1,hN],14):15:hN.$==1?hO.$==1?(hL=[hN.$0,hO.$0],9):hO.$==0?hO.$0===-1?hO.$1==="_"?(hL=hN,10):(hL=[hO.$0,hO.$1,hN],14):(hL=[hO.$0,hO.$1,hN],14):15:hN.$==0?hO.$==0?hO.$0===-1?hO.$1==="_"?(hL=hN,10):hN.$0===-1?hN.$1==="_"?(hL=hO,10):(hL=[hN.$0,hN.$1,hO],11):(hL=[hN.$0,hN.$1,hO],11):hN.$0===-1?hN.$1==="_"?(hL=hO,10):(hL=[hN.$0,hN.$1,hO],11):(hL=[hN.$0,hN.$1,hO],11):hN.$0===-1?hN.$1==="_"?(hL=hO,10):(hL=[hN.$0,hN.$1,hO],11):(hL=[hN.$0,hN.$1,hO],11):hN.$==9?hO.$==0?hO.$0===-1?hO.$1==="_"?(hL=hN,10):(hL=[hO.$0,hO.$1,hN],14):(hL=[hO.$0,hO.$1,hN],14):hO.$==9?(hL=[hN.$0,hO.$0],12):15:hN.$==8?hO.$==0?hO.$0===-1?hO.$1==="_"?(hL=hN,10):(hL=[hO.$0,hO.$1,hN],14):(hL=[hO.$0,hO.$1,hN],14):hO.$==8?(hL=[hN.$0,hO.$0],13):15:hO.$==4?hO.$0.$==1?(hL=[hN.$0,hO.$0.$0,hN.$1,hO.$0.$1],0):hN.$1.$==0?(hL=[hN.$1.$0,hN.$1.$1,hN.$0,hO.$0],2):15:hO.$==5?hN.$1.$==0?(hL=[hN.$1.$0,hN.$1.$1,hN.$0,hO.$0,hO.$1],1):hO.$1.$==0?(hL=[hO.$1.$0,hO.$1.$1,hO.$0,hN.$0,hN.$1],1):(hL=[hN.$0,hO.$0,hN.$1,hO.$1],3):hO.$==0?hO.$0===-1?hO.$1==="_"?(hL=hN,10):(hL=[hO.$0,hO.$1,hN],14):(hL=[hO.$0,hO.$1,hN],14):15){case 0:return cV.unifyInner(hI,hJ,new bY({$:1,$0:new cW({$:0,$0:hL[0],$1:hL[1]}),$1:new bY({$:1,$0:new cW({$:0,$0:hL[2],$1:{$:4,$0:hL[3]}}),$1:hM})}));case 1:return cV.unifyInner(hI,hJ,new bY({$:1,$0:new cW({$:0,$0:hL[2],$1:hL[3]}),$1:new bY({$:1,$0:new cW({$:0,$0:{$:0,$0:hL[0],$1:hL[1]},$1:hL[4]}),$1:hM})}));case 2:hP=hL[3];return hP.$==1?cV.unifyInner(hI,hJ,new bY({$:1,$0:new cW({$:0,$0:hL[2],$1:hP.$0}),$1:new bY({$:1,$0:new cW({$:0,$0:{$:0,$0:hL[0],$1:hL[1]},$1:{$:4,$0:hP.$1}}),$1:hM})})):bY.Empty;case 3:return cV.unifyInner(hI,hJ,new bY({$:1,$0:new cW({$:0,$0:hL[0],$1:hL[1]}),$1:new bY({$:1,$0:new cW({$:0,$0:hL[2],$1:hL[3]}),$1:hM})}));case 4:hQ=hL[0];hR=hL[1];return hQ.get_Length()===hR.get_Length()?cV.unifyInner(hI,hJ,bX.append(bX.map(function(im){return hS(im[0],im[1]);},bX.zip(hQ,hR)),hM)):bY.Empty;case 5:hT=hL[0];hU=hL[1];return hT.get_Length()!==hU.get_Length()?bY.Empty:bX.distinct(hW(hT,hU,bY.Empty,bY.Empty));case 6:hX=hL[0];hY=hL[1];return hX.get_Length()===0&&hY.get_Length()!==0||hY.get_Length()===0&&hX.get_Length()!==0?bY.Empty:hX.$==1?(hZ=hX.$1,h0=hX.$0[1],h1=hX.$0[0],bX.distinct(bX.collect(function(im){return cV.unifyInner(im,hJ,hM);},function(im,_in,io){var ip,iq,ir,is,it;while(true)if(io.$==0)return im;else{ip=io.$1;iq=io.$0[1];ir=io.$0[0];is=cV.unifyInner(hI,hJ,bX.ofArray([new cW({$:0,$0:h0,$1:iq})]));if(is.$==0){_in=new bY({$:1,$0:[ir,iq],$1:_in});io=ip;}else{it=(function(iu){return function(iv){return bX.collect(iu,iv);};}(function(iu,iv,iw){return function(ix){var iy,iz,iA;iy=ix.Apply$9(h1===iu?{$:7,$0:hZ}:{$:7,$0:new bY({$:1,$0:[hC.abs(h1-iu),h0],$1:hZ})},hJ);iz=ix.Apply$9({$:7,$0:bX.append(iv,iw)},hJ);iA=bX.map(function(iB){return new cW({$:0,$0:ix.Apply$9(iB.$0,hJ),$1:ix.Apply$9(iB.$1,hJ)});},hM);return cV.unifyInner(ix,hJ,new bY({$:1,$0:new cW({$:0,$0:iy,$1:iz}),$1:iA}));};}(ir,_in,ip)))(is);im=bX.append(it,im);_in=new bY({$:1,$0:[ir,iq],$1:_in});io=ip;}}}(bY.Empty,bY.Empty,hY)))):cV.unifyInner(hI,hJ,hM);case 7:h2=hL[2];h3=hL[3];return hL[0]!==hL[1]?bY.Empty:h2.get_Length()!==h3.get_Length()?bY.Empty:cV.unifyInner(hI,hJ,bX.append(bX.map(function(im){return h4(im[0],im[1]);},bX.zip(h2,h3)),hM));case 8:return hL[0]===hL[1]?cV.unifyInner(hI,hJ,hM):bY.Empty;case 9:return hL[0]===hL[1]?cV.unifyInner(hI,hJ,hM):bY.Empty;case 10:switch(hL.$==0?hL.$0===-1?hL.$1==="_"?0:(h6=[hL.$0,hL.$1],1):(h6=[hL.$0,hL.$1],1):2){case 0:h5=cV.unifyInner(hI,hJ,hM);break;case 1:h5=(h7=hI.Add$4(new fm({$:0,$0:[h6[0],h6[1]]}),{$:0,$0:-1,$1:"_"},hJ),cV.unifyInner(h7,hJ,bX.map(function(im){return new cW({$:0,$0:h7.Apply$9(im.$0,hJ),$1:h7.Apply$9(im.$1,hJ)});},hM)));break;case 2:h5=cV.unifyInner(hI,hJ,hM);break;}return h5;case 11:h8=hL[0];h9=hL[1];h_=hL[2];return cw.Equals({$:0,$0:h8,$1:h9},h_)?cV.unifyInner(hI,hJ,hM):(new cK.New$1(c6.OfSeq(co.map(fm.ToVar,c3.fvt(hJ,h_))))).Contains([h8,h9])?bY.Empty:(h$=hI.Add$4(new fm({$:0,$0:[h8,h9]}),h_,hJ),cV.unifyInner(h$,hJ,bX.map(function(im){return new cW({$:0,$0:h$.Apply$9(im.$0,hJ),$1:h$.Apply$9(im.$1,hJ)});},hM)));case 12:ic=hL[1];id=hL[0];switch(id.$==0?ic.$==0?(ib=[id.$0,ic.$0,id.$1,ic.$1],1):3:id.$==2?ic.$==2?(ib=[id.$0,ic.$0],2):3:id.$==1?ic.$==1?(ib=[id.$0,ic.$0],2):3:id.$==3?ic.$==3?(ib=[id.$0,ic.$0],2):3:id.$==4?ic.$==4?(ib=[id.$0,ic.$0],2):3:ic.$==5?0:3){case 0:ia=bX.ofArray([c4.get_id()]);break;case 1:ia=(ie=ib[0],_if=ib[1],ig=ib[2],ih=ib[3],ie.get_Length()!==_if.get_Length()||ig.get_Length()!==ih.get_Length()?bY.Empty:bX.collect(function(im){return cV.unifyInner(im,hJ,bX.map(function(_in){return new cW({$:0,$0:im.Apply$9(_in.$0,hJ),$1:im.Apply$9(_in.$1,hJ)});},hM));},bX.choose(function(im){return c4.TryMerge(hI,im,hJ);},(ii=bX.append(bX.zip(ie,_if),bX.zip(ig,ih)),co.fold(function(im,_in){var io,ip;function iq(ir,is){return c4.Compose(ir,is,hJ);}io=_in[0];ip=_in[1];return bX.map(function(ir){return iq(ir[0],ir[1]);},bX.allPairs(im,bX.collect(function(ir){return cV.unifyHoleEntry(hJ,ir.Apply$3(io,hJ),ir.Apply$3(ip,hJ));},im)));},bX.ofArray([c4.get_id()]),ii)))));break;case 2:ia=(ij=ib[0],ik=ib[1],ij.get_Length()!==ik.get_Length()?bY.Empty:bX.collect(function(im){return cV.unifyInner(im,hJ,bX.map(function(_in){return new cW({$:0,$0:im.Apply$9(_in.$0,hJ),$1:im.Apply$9(_in.$1,hJ)});},hM));},bX.choose(function(im){return c4.TryMerge(hI,im,hJ);},(il=bX.zip(ij,ik),co.fold(function(im,_in){var io,ip;function iq(ir,is){return c4.Compose(ir,is,hJ);}io=_in[0];ip=_in[1];return bX.map(function(ir){return iq(ir[0],ir[1]);},bX.allPairs(im,bX.collect(function(ir){return cV.unifyHoleEntry(hJ,ir.Apply$3(io,hJ),ir.Apply$3(ip,hJ));},im)));},bX.ofArray([c4.get_id()]),il)))));break;case 3:ia=bY.Empty;break;}return ia;case 13:return cw.Equals(b$.Canonical(hJ,hL[0]),b$.Canonical(hJ,hL[1]))?cV.unifyInner(hI,hJ,hM):bY.Empty;case 14:return cV.unifyInner(hI,hJ,new bY({$:1,$0:new cW({$:0,$0:{$:0,$0:hL[0],$1:hL[1]},$1:hL[2]}),$1:hM}));case 15:return bY.Empty;}}else return bX.ofArray([hI]);};cV.unifyHoleEntry=function(hI,hJ,hK){var hL,hM,hN;hL=hI.unify([hJ[0],hK[0]]);return hL.$==0?bY.Empty:(hM=cV.unifyLocation(hJ[1],hK[1]),hM==null?bY.Empty:(hN=hM.$0,bX.map(function(hO){return c4.Compose(new c4({$:0,$0:hO}),hN,hI);},hL)));};cV.unifyLocation=function(hI,hJ){var hK;switch(hI.$==1?hI.$0[0]===-1?hI.$0[1]==="_"?1:hJ.$==1?hJ.$0[0]===-1?hJ.$0[1]==="_"?1:(hK=[hJ,hI.$0],2):(hK=[hJ,hI.$0],2):(hK=[hJ,hI.$0],2):hJ.$==1?hJ.$0[0]===-1?hJ.$0[1]==="_"?1:(hK=[hJ,hI.$0],2):(hK=[hJ,hI.$0],2):(hK=[hJ,hI.$0],2):hJ.$==1?hJ.$0[0]===-1?hJ.$0[1]==="_"?1:(hK=[hI,hJ.$0],2):(hK=[hI,hJ.$0],2):(hK=[hI.$0,hJ.$0,hI.$1,hJ.$1],0)){case 0:return cw.Equals([hK[0],hK[2]],[hK[1],hK[3]])?{$:1,$0:c4.get_id()}:null;case 1:return{$:1,$0:c4.get_id()};case 2:return{$:1,$0:c4.Create$2(hK[1],hK[0])};}};cW=cV.TermEquation=hB.Class({},null,cW);cX.to_env=function(hI){return bW.OfArray(ck.ofSeq(bX.map(function(hJ){return[hJ.name,hJ.value];},hI)));};cX.to_string=function(hI){return(function(hJ){return function(hK){return hJ("[\\n  "+cA.toSafe(hK)+";\\n]");};}(a.id))(cS.concat(";\\n  ",bX.map(F.to_string,hI)));};cX.expand_multiples=function(hI,hJ){var hK,hL,hM,hN,hO,hP,hQ,hR,hS;hK=bX.partition(F.is_multiple,hJ);hL=hK[1];hM=hK[0];hN=bX.map(F.getname,hM);hO=[0];hP=bX.unzip(bX.map(function(hT){return fy.add_multiples(hO,hN,hT);},hI));hQ=bX.concat(cX.create_multiples(bX.concat(hP[0]),hM));hR=co.fold(function(hT,hU){return hT.Add(hU.name,bX.ofArray([hU.name]));},co.fold(function(hT,hU){return co.fold(function(hV,hW){var hX,hY;hX=hW[0];hY=hW[1];return hV.ContainsKey(hX.name)?hV.Add(hX.name,bX.append(hV.get_Item(hX.name),bX.ofArray([hY.name]))):hV.Add(hX.name,bX.ofArray([hY.name]));},hT,bX.zip(hM,hU));},new cj.New([]),hQ),hL);hS=bX.concat(hQ);return[hP[1],bX.concat([hL,bX.map(function(hT){return F.create$1(hT.name,hT.value,null);},hM),hS]),hR];};cX.substitute=function(hI,hJ){return bX.map(function(hK){return F.substitute(hI,hK);},hJ);};cX.to_string_inline=function(hI){return cS.concat("; ",bX.map(function(hJ){return(((hB.Curried3(function(hK,hL,hM){return hK(cA.toSafe(hL)+" = "+cA.toSafe(hM));}))(a.id))(hJ.name))(a.String(hJ.value));},hI));};cX.remove=function(hI,hJ){return co.fold(function(hK,hL){return bX.filter(function(hM){return hM.name!==hL;},hK);},hJ,hI);};cX.create_multiples=function(hI,hJ){function hK(hL){return bX.map2(function(hM,hN){var hO;return F.create$1(hN,hM.value,(hO=hM.prior,hO==null?null:{$:1,$0:E.vary(hO.$0)}));},hJ,hL);}return bX.map(function(hL){return bX.map(hK,hL);},hI);};cY.find=function(hI,hJ){var hK;hK=bW.TryFind(hJ,hI);return hK!=null&&hK.$==1?hK.$0:(function(hL){return function(hM){return hL("The environment does not contain: "+cA.toSafe(hM));};}(be.FailWith))(hJ);};cY.to_string=function(hI){return"["+dZ.string_of_list(function(hJ){var hK;return hJ[0]+" = "+(hK=hJ[1],a.String(hK));},"; ",bX.ofSeq(bW.ToSeq(hI)))+"]";};cY.empty=function(){g_.$cctor();return g_.empty;};Z.elements=function(hI){return bX.map(function(hJ){return hJ.element;},hI);};Z.iterm=function(hI,hJ){bX.iter(hI,hJ);};Z.union_all=function(hI,hJ){return dZ.fold_left(function(hK,hL){return Z.union(hI,hK,hL);},Z.empty(),hJ);};Z.map=function(hI,hJ){return bX.map(function(hK){return _0.New(hI(hK.element),hK.multiplicity);},hJ);};Z.is_perm=function(hI,hJ,hK){return Z.is_contained(hI,hJ,hK)&&Z.is_contained(hI,hK,hJ);};Z.empty=function(){fo.$cctor();return fo.empty;};Z.to_map=function(hI){return bW.OfArray(ck.ofSeq(bX.map(function(hJ){return[hJ.element,hJ.multiplicity];},hI)));};Z.to_mlist=a.id;Z.is_empty=function(hI){return hI.$==0;};Z.union=function(hI,hJ,hK){return dZ.fold_left(function(hL,hM){return Z.add(hI,hL,hM);},hJ,hK);};Z.fold_left_m=function(hI,hJ,hK){return dZ.fold_left(hI,hJ,hK);};Z.add=function(hI,hJ,hK){function hL(hM,hN){var hO,hP;return hN.$==1?(hO=hN.$1,(hP=hN.$0,hI(hP.element,hM.element)?new bY({$:1,$0:_0.New(hP.element,hP.multiplicity+hM.multiplicity),$1:hO}):new bY({$:1,$0:hP,$1:hL(hM,hO)}))):bX.ofArray([hM]);}return hL(hK,hJ);};Z.to_string=function(hI,hJ,hK){return dZ.string_of_list(function(hL){return hL.multiplicity===0?"":hL.multiplicity===1?hI(hL.element):a.String(hL.multiplicity)+hI(hL.element);},hJ,hK);};Z.to_list=function(hI){function hJ(hK,hL,hM){var hN;while(true)if(hM===0)return hK;else{hN=hM;hK=new bY({$:1,$0:hL,$1:hK});hM=hN-1;}}return bX.rev(Z.fold_left_m(function(hK,hL){return hJ(hK,hL.element,hL.multiplicity);},bY.Empty,hI));};Z.from_list=function(hI){var hJ;hJ=dD.empty();return Z.rev_map(function(hK){return _0.New(hK,dD.find(hJ,hK));},dZ.fold_left(function(hK,hL){var hM;hM=dD.tryFind(hJ,hL);return hM!=null&&hM.$==1?(dD.add(hJ,hL,hM.$0+1),hK):(dD.add(hJ,hL,1),new bY({$:1,$0:hL,$1:hK}));},bY.Empty,hI));};Z.is_contained=function(hI,hJ,hK){return Z.forall(function(hL){return Z.is_in_mys(hI,hK,hL);},hJ);};Z.collectm=function(hI,hJ){return bX.map(hI,hJ);};Z.size=function(hI){return Z.fold_left_m(function(hJ,hK){return hJ+hK.multiplicity;},0,hI);};Z.nonzero_elements=function(hI){return bX.choose(function(hJ){return hJ.multiplicity===0?null:{$:1,$0:hJ.element};},hI);};Z.difference=function(hI,hJ,hK){return bX.append(Z.mapm(function(hL){return _0.New(hL.element,hL.multiplicity-Z.get_mult(hI,hK,hL.element));},hJ),Z.mapm(function(hL){return _0.New(hL.element,-hL.multiplicity);},Z.filter(function(hL){return Z.get_mult(hI,hJ,hL)===0;},hK)));};Z.get_mult=function(hI,hJ,hK){var hL;hL=co.tryFind(function(hM){return hI(hK,hM.element);},hJ);return hL!=null&&hL.$==1?hL.$0.multiplicity:0;};Z.rev_map=function(hI,hJ){return Z.rev_map_acc(hI,hJ,bY.Empty);};Z.forall=function(hI,hJ){return bX.forAll(hI,hJ);};Z.is_in_mys=function(hI,hJ,hK){var hL;hL=co.tryFind(function(hM){return hI(hK.element,hM.element);},hJ);return hL!=null&&hL.$==1&&hK.multiplicity<=hL.$0.multiplicity;};Z.mapm=function(hI,hJ){return bX.map(hI,hJ);};Z.filter=function(hI,hJ){return bX.filter(function(hK){return Z.on_e(hI,hK);},hJ);};Z.collect=function(hI,hJ){return Z.to_list(Z.map(hI,hJ));};Z.iter=function(hI,hJ){bX.iter(function(hK){Z.on_e(hI,hK);},hJ);};Z.rev_map_acc=function(hI,hJ,hK){var hL,hM;while(true)if(hJ.$==1){hL=hJ.$1;hM=hJ.$0;hJ=hL;hK=new bY({$:1,$0:hI(hM),$1:hK});}else return hK;};Z.on_e=function(hI,hJ){return hI(hJ.element);};Z.parse=function(hI){var hJ,hK;hJ=cR.sepBy((hK=Z.counted(hI),function(hL){return Z.op_DotGreaterGreater(hK,cR.spaces(),hL[0],hL[1]);}),cR.skw("+"));return function(hL){return Z.op_BarGreaterGreater(hJ,Z.from_mlist,hL[0],hL[1]);};};Z.op_BarGreaterGreater=function(hI,hJ,hK,hL){return(cR.op_BarGreaterGreater(hI,hJ))([hK,hL]);};Z.from_mlist=function(hI){return dZ.fold_left(function(hJ,hK){return Z.add(cw.Equals,hJ,hK);},Z.empty(),hI);};Z.op_DotGreaterGreater=function(hI,hJ,hK,hL){return(cR.op_DotGreaterGreater(hI,hJ))([hK,hL]);};Z.counted=function(hI){var hJ,hK;function hL(hO){return _0.New(hO,1);}function hM(hO,hP){return Z.op_PlusGreaterGreaterPlus(cR.pint32(),hI,hO,hP);}function hN(hO,hP){return _0.New(hP,hO);}hJ=function(hO){return Z.op_BarGreaterGreater(hI,hL,hO[0],hO[1]);};hK=function(hO){return Z.op_BarGreaterGreater(function(hP){return hM(hP[0],hP[1]);},function(hP){return hN(hP[0],hP[1]);},hO[0],hO[1]);};return function(hO){return Z.op_LessBarGreater(hJ,hK,hO[0],hO[1]);};};Z.op_LessBarGreater=function(hI,hJ,hK,hL){return(cR.op_LessBarGreater(hI,hJ))([hK,hL]);};Z.op_PlusGreaterGreaterPlus=function(hI,hJ,hK,hL){return(cR.op_PlusGreaterGreaterPlus(hI,hJ))([hK,hL]);};cZ.add_new_species_reactions=function(hI,hJ,hK,hL,hM,hN,hO,hP,hQ){var hR,hS,hT;hR=cZ.new_reactions(hI,hK,hM,hN,hP);hS=bX.append(bX.choose(function(hU){var hV;function hW(hX){return Z.is_perm(function(hY,hZ){return cN.equal(hK,hY,hZ);},hX.reactants,hU.reactants)&&Z.is_perm(function(hY,hZ){return cN.equal(hK,hY,hZ);},hX.products,hU.products);}hV=co.tryFind(hW,hQ);return hV!=null&&hV.$==1?bX.exists(hW,hP)?null:{$:1,$0:hV.$0}:{$:1,$0:hU};},dZ.rev_map(function(hU){return cZ.translate(hJ,hK,hL,hU);},hR)),hP);hT=dZ.collect(cZ.products,hR);return[hS,hT,cZ.new_species_env(hK,hT,hO)];};cZ.new_reactions=function(hI,hJ,hK,hL,hM){var hN,hO,hP,hQ;hN=cN.separate(hL);hO=hN[1];hP=hN[2];hQ=hN[0];return cZ.combine(hJ,bY.Empty,hK.$==0?cZ.new_strand_reactions(hI,hJ,hK.$0,hQ,hO,hP):hK.$==2?cZ.new_origami_reactions(hI,hJ,hK.$0,hQ,hO,hP,hM):hK.$==3?bY.Empty:hK.$==4?be.FailWith("unexpected LogicDSD species"):cZ.new_gate_reactions(hI,hJ,hK.$0,hQ,hO,hP,hM));};cZ.products=function(hI){var hJ;switch(hI.$==1?(hJ=hI.$3,0):hI.$==2?(hJ=hI.$3,0):hI.$==3?(hJ=hI.$1,0):hI.$==5?(hJ=hI.$2,0):hI.$==8?(hJ=hI.$2,0):hI.$==9?(hJ=hI.$2,0):hI.$==4?(hJ=hI.$2,1):hI.$==6?(hJ=hI.$2,1):hI.$==7?(hJ=hI.$2,1):hI.$==10?(hJ=hI.$2,2):hI.$==11?(hJ=hI.$3,2):hI.$==12?(hJ=hI.$2,3):hI.$==13?(hJ=hI.$3,3):hI.$==14?4:hI.$==15?5:hI.$==16?6:hI.$==17?7:(hJ=hI.$2,0)){case 0:return hJ;case 1:return bX.ofArray([new cO({$:1,$0:hJ})]);case 2:return bX.ofArray([new cO({$:2,$0:hJ})]);case 3:return hJ;case 4:return cZ.products(hI.$1);case 5:return bX.ofArray([hI.$2]);case 6:return hI.$4;case 7:return Z.to_list(hI.$0.ma_products);}};cZ.new_species_env=function(hI,hJ,hK){return dZ.fold_right(function(hL,hM){return cN.add_env(hI,"%",hL,hM);},bX.map(function(hL){return[hL,{$:1,$0:1},false,false,null,null];},hJ),hK);};cZ.translate=function(hI,hJ,hK,hL){var hM;hM=cZ.translate_rate(hI,hJ,hK,hL);return _2.create$4(bY.Empty,Z.from_list(cZ.reactants(hL)),null,hM,Z.from_list(cZ.products(hL)));};cZ.combine=function(hI,hJ,hK){return dZ.fold_left(function(hL,hM){return cZ.is_circular(hI,hM)?hL:cZ.is_fast_leak(hM)?bX.exists(function(hN){return!cZ.is_leak(hN)&&cZ.matching_species(hI,hM,hN);},hL)?hL:bX.append(bX.filter(function(hN){return!(cZ.is_leak(hN)&&cZ.matching_species(hI,hM,hN));},hL),bX.ofArray([hM])):cZ.is_slow_leak(hM)?bX.exists(function(hN){return!cZ.is_slow_leak(hN)&&cZ.matching_species(hI,hM,hN);},hL)?hL:bX.append(bX.filter(function(hN){return!(cZ.is_slow_leak(hN)&&cZ.matching_species(hI,hM,hN));},hL),bX.ofArray([hM])):cZ.is_tau(hM)?bX.exists(function(hN){return cZ.is_tau(hN)&&cZ.matching_species(hI,hM,hN);},hL)?hL:bX.append(bX.filter(function(hN){return!(cZ.is_leak(hN)&&cZ.matching_species(hI,hM,hN));},hL),bX.ofArray([hM])):bX.append(bX.filter(function(hN){return!(cZ.is_leak(hN)&&cZ.matching_species(hI,hM,hN));},hL),bX.ofArray([hM]));},hJ,hK);};cZ.new_strand_reactions=function(hI,hJ,hK,hL,hM,hN){var hO,hP,hQ;hO=cZ.pin_reactions_new_strand(hI,hJ,hK);hP=cZ.bind_reactions_new_strand(hI,hJ,hK,hL,hM);hQ=cZ.combine_many(hJ,bX.ofArray([cZ.leak_reactions_new_strand(hI,hJ,hK,hL,hM),hP,hO,cZ.entry_reactions_new_strand(hI,hJ,hK,hN)]));return cZ.fix_reactions(hJ,hL,new bY({$:1,$0:hK,$1:hM}),hN,bY.Empty,hQ);};cZ.new_origami_reactions=function(hI,hJ,hK,hL,hM,hN,hO){var hP,hQ,hR,hS,hT;hP=en.origami_species(hK);hQ=cN.separate(bX.collect(function(hU){return Z.elements(hU.reactants);},bX.filter(function(hU){return cZ.looks_like_origami_reaction(hK,hU);},hO)));hR=dZ.difference(function(hU,hV){return eo.equal(hJ,hU,hV);},hP[0],hQ[0]);hS=dZ.difference(em.equal,hP[1],hQ[1]);hT=cZ.combine_many(hJ,bX.ofArray([cZ.entry_reactions_new_origami(hI,hJ,hK,hM,hL),cZ.origami_unbind_reactions(hI,hJ,hK,hR),cZ.origami_unbind_reactions_expel(hI,hJ,hK,hR),cZ.origami_unbind_open_reactions(hI,hJ,hK,hR),dZ.remove_duplicates(function(hU,hV){return cZ.matching_species(hJ,hU,hV);},cZ.origami_bind_reactions(hI,hJ,hK,hS,hR)),cZ.origami_pin_reactions(hI,hJ,hK),cZ.origami_tau_reactions(hI,hJ,hK),cZ.origami_displacement_reactions(hJ,hK,hR),cZ.origami_displacement_reactions_expel(hJ,hK,hR),cZ.origami_migration_reactions(hJ,hK,hR),cZ.origami_migration_open_reactions(hJ,hK,hR),cZ.origami_pin_migration(hI,hJ,hK),cZ.origami_pin_displacing(hI,hJ,hK),cZ.origami_pin_open(hJ,hK),cZ.origami_cover_reactions(hJ,hK,hR)]));return cZ.fix_reactions(hJ,hL,hM,new bY({$:1,$0:hK,$1:hN}),bY.Empty,hT);};cZ.new_gate_reactions=function(hI,hJ,hK,hL,hM,hN,hO){var hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0,h1,h2,h3;hP=cZ.unbind_reactions(hI,hJ,hK);hQ=cZ.unbind_open_reactions(hI,hJ,hK);hR=cZ.bind_reactions_new_gate(hI,hJ,hK,hL,hM);hS=cZ.pin_reactions_new_gate(hI,hJ,hK);hT=cZ.leak_reactions_new_gate(hI,hJ,hK,hL,hM);hU=cZ.tau_reactions(hI,hJ,hK);hV=cZ.displacement_reactions(hJ,hK);hW=cZ.migration_reactions(hJ,hK);hX=cZ.migration_open_reactions(hJ,hK);hY=cZ.pin_migration_new_gate(hI,hJ,hK);hZ=cZ.pin_displacing_new_gate(hI,hJ,hK);h0=cZ.pin_open_new_gate(hJ,hK);h1=cZ.cover_reactions(hJ,hK);h2=bX.collect(function(h4){return cZ.nick_reactions(hK,h4);},bY.Empty);h3=cZ.combine_many(hJ,bX.ofArray([hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0,h1,cZ.entry_reactions_new_gate(hI,hJ,hK,hN),h2]));return cZ.fix_reactions(hJ,new bY({$:1,$0:hK,$1:hL}),hM,hN,hO,h3);};cZ.reactants=function(hI){var hJ;switch(hI.$==3?(hJ=hI.$0,0):hI.$==4?(hJ=hI.$0,0):hI.$==5?(hJ=hI.$0,0):hI.$==6?(hJ=hI.$0,0):hI.$==7?(hJ=hI.$0,0):hI.$==8?(hJ=hI.$0,0):hI.$==1?(hJ=[hI.$0,hI.$1],1):hI.$==2?(hJ=[hI.$0,hI.$1],1):hI.$==9?2:hI.$==10?(hJ=hI.$0,3):hI.$==12?(hJ=hI.$0,3):hI.$==11?(hJ=[hI.$1,hI.$0],4):hI.$==13?(hJ=[hI.$1,hI.$0],4):hI.$==14?5:hI.$==15?(hJ=hI.$0,6):hI.$==16?(hJ=hI.$0,6):hI.$==17?7:(hJ=hI.$0,0)){case 0:return bX.ofArray([new cO({$:1,$0:hJ})]);case 1:return bX.ofArray([hJ[0],hJ[1]]);case 2:return bX.ofArray([hI.$0]);case 3:return bX.ofArray([new cO({$:2,$0:hJ})]);case 4:return bX.ofArray([new cO({$:2,$0:hJ[1]}),hJ[0]]);case 5:return cZ.reactants(hI.$1);case 6:return bX.ofArray([hJ]);case 7:return Z.to_list(hI.$0.ma_reactants);}};cZ.translate_rate=function(hI,hJ,hK,hL){var hM;hM=cZ.rate(hI,hJ,hK,hL);return hM.$==1?new _1({$:1,$0:hM.$0}):new _1({$:0,$0:hM.$0});};cZ.is_circular=function(hI,hJ){return dZ.is_permutation((hB.Curried3(cN.equal))(hI),cZ.reactants(hJ),cZ.products(hJ));};cZ.is_fast_leak=function(hI){return hI.$==2&&hI.$2;};cZ.is_leak=function(hI){return hI.$==2;};cZ.matching_species=function(hI,hJ,hK){return dZ.is_permutation((hB.Curried3(cN.equal))(hI),cZ.reactants(hJ),cZ.reactants(hK))&&dZ.is_permutation((hB.Curried3(cN.equal))(hI),cZ.products(hJ),cZ.products(hK));};cZ.is_slow_leak=function(hI){return hI.$==2&&!hI.$2;};cZ.is_tau=function(hI){return hI.$==3;};cZ.fix_reactions=function(hI,hJ,hK,hL,hM,hN){var hO;function hP(hQ,hR,hS,hT){return function(hU){var hV,hW;hV=cZ.fix(hI,hR,hS,hT,hU);hW=cN.separate(cZ.species(hV));return[new bY({$:1,$0:hV,$1:hQ}),bX.append(hW[0],hR),bX.append(hW[1],hS),bX.append(hW[2],hT)];};}hO=cN.separate(dZ.collect(function(hQ){return Z.elements(hQ.products);},hM));return bX.rev((dZ.fold_left(function(hQ,hR){return(function(hS){return hP(hS[0],hS[1],hS[2],hS[3]);}(hQ))(hR);},[bY.Empty,bX.append(hJ,hO[0]),bX.append(hK,hO[1]),bX.append(hL,hO[2])],hN))[0]);};cZ.combine_many=function(hI,hJ){return dZ.fold_left(function(hK,hL){return cZ.combine(hI,hK,hL);},bY.Empty,hJ);};cZ.entry_reactions_new_strand=function(hI,hJ,hK,hL){var hM,hN;function hO(hQ,hR){var hS,hT,hU,hV,hW,hX,hY,hZ,h0;hS=hR[1];hT=hR[0];hU=hR[4];hV=hR[2];hW=hR[3];hX=bR.getRules(hJ);return hX=="Finite"||(hX=="Default"?false:hX!="Infinite")?bX.ofArray([cZ.standard_form(hJ,{$:11,$0:hQ,$1:new cO({$:0,$0:hT}),$2:{$:1,$0:new cO({$:0,$0:hT}),$1:new cO({$:0,$0:hS}),$2:hV,$3:bX.ofArray([new cO({$:1,$0:hW})])},$3:hU})]):(hZ=en.standard_form(hJ,hU),(h0=en.fast_reactions(hI,hJ,hZ),h0.$==0?bX.ofArray([cZ.standard_form(hJ,{$:11,$0:hQ,$1:new cO({$:0,$0:hT}),$2:{$:1,$0:new cO({$:0,$0:hT}),$1:new cO({$:0,$0:hS}),$2:hV,$3:bX.ofArray([new cO({$:1,$0:hW})])},$3:hZ})]):bX.map(function(h1){var h2,h3,h4;h2=h1[0];h3=h1[1];h4=h1[2];return h2.$==0&&h3.$==0?cZ.standard_form(hJ,{$:11,$0:hQ,$1:new cO({$:0,$0:hT}),$2:{$:1,$0:new cO({$:0,$0:hT}),$1:new cO({$:0,$0:hS}),$2:hV,$3:bX.ofArray([new cO({$:1,$0:hW})])},$3:h4}):cZ.standard_form(hJ,{$:13,$0:hQ,$1:new cO({$:0,$0:hT}),$2:{$:1,$0:new cO({$:0,$0:hT}),$1:new cO({$:0,$0:hS}),$2:hV,$3:bX.ofArray([new cO({$:1,$0:hW})])},$3:cN.collate(h2,h3,bX.ofArray([h4]))});},h0)));}function hP(hQ,hR){var hS,hT,hU,hV,hW,hX,hY,hZ,h0;hS=hR[1];hT=hR[4];hU=hR[2];hV=hR[3];hW=hR[0];hX=bR.getRules(hJ);return hX=="Finite"||(hX=="Default"?false:hX!="Infinite")?bX.ofArray([cZ.standard_form(hJ,{$:11,$0:hQ,$1:new cO({$:0,$0:hS}),$2:{$:1,$0:new cO({$:1,$0:hW}),$1:new cO({$:0,$0:hS}),$2:hU,$3:bX.ofArray([new cO({$:1,$0:hV})])},$3:hT})]):(hZ=en.standard_form(hJ,hT),(h0=en.fast_reactions(hI,hJ,hZ),h0.$==0?bX.ofArray([cZ.standard_form(hJ,{$:11,$0:hQ,$1:new cO({$:0,$0:hS}),$2:{$:1,$0:new cO({$:1,$0:hW}),$1:new cO({$:0,$0:hS}),$2:hU,$3:bX.ofArray([new cO({$:1,$0:hV})])},$3:hZ})]):bX.map(function(h1){var h2,h3,h4;h2=h1[0];h3=h1[1];h4=h1[2];return h2.$==0&&h3.$==0?cZ.standard_form(hJ,{$:11,$0:hQ,$1:new cO({$:0,$0:hS}),$2:{$:1,$0:new cO({$:1,$0:hW}),$1:new cO({$:0,$0:hS}),$2:hU,$3:bX.ofArray([new cO({$:1,$0:hV})])},$3:h4}):cZ.standard_form(hJ,{$:13,$0:hQ,$1:new cO({$:0,$0:hS}),$2:{$:1,$0:new cO({$:1,$0:hW}),$1:new cO({$:0,$0:hS}),$2:hU,$3:bX.ofArray([new cO({$:1,$0:hV})])},$3:cN.collate(h2,h3,bX.ofArray([h4]))});},h0)));}hM=dZ.collect(function(hQ){return bX.map(function(hR){return[hQ,hR];},en.entry_reactions_ss(hI,hJ,hQ,hK));},hL);hN=dZ.collect(function(hQ){return bX.map(function(hR){return[hQ,hR];},en.entry_reactions_sg(hI,hJ,hQ,hK));},hL);return bX.append(dZ.collect(function(hQ){return hO(hQ[0],hQ[1]);},hM),dZ.collect(function(hQ){return hP(hQ[0],hQ[1]);},hN));};cZ.leak_reactions_new_strand=function(hI,hJ,hK,hL,hM){var hN;function hO(hS,hT,hU,hV,hW){return bX.ofArray([cZ.standard_form(hJ,{$:2,$0:new cO({$:1,$0:hS}),$1:new cO({$:0,$0:hT}),$2:hU,$3:cN.collate(hV,hW,bY.Empty)})]);}function hP(hS,hT,hU,hV,hW){return bX.ofArray([cZ.standard_form(hJ,{$:2,$0:new cO({$:1,$0:hS}),$1:new cO({$:0,$0:hT}),$2:hU,$3:cN.collate(hV,hW,bY.Empty)})]);}function hQ(hS,hT,hU,hV,hW){var hX,hY;hX=bX.map(function(hZ){return eo.standard_form(hJ,hZ);},hV);hY=eo.fast_reactions(hI,hJ,hX);return hY.$==0?bX.ofArray([cZ.standard_form(hJ,{$:2,$0:new cO({$:1,$0:hS}),$1:new cO({$:0,$0:hT}),$2:hU,$3:cN.collate(hX,hW,bY.Empty)})]):bX.map(function(hZ){return cZ.standard_form(hJ,{$:2,$0:new cO({$:1,$0:hS}),$1:new cO({$:0,$0:hT}),$2:hU,$3:cN.collate(hZ[0],bX.append(hW,hZ[1]),bY.Empty)});},hY);}function hR(hS,hT,hU,hV,hW){var hX,hY;hX=bX.map(function(hZ){return eo.standard_form(hJ,hZ);},hV);hY=eo.fast_reactions(hI,hJ,hX);return hY.$==0?bX.ofArray([cZ.standard_form(hJ,{$:2,$0:new cO({$:1,$0:hS}),$1:new cO({$:0,$0:hT}),$2:hU,$3:cN.collate(hX,hW,bY.Empty)})]):bX.map(function(hZ){return cZ.standard_form(hJ,{$:2,$0:new cO({$:1,$0:hS}),$1:new cO({$:0,$0:hT}),$2:hU,$3:cN.collate(hZ[0],bX.append(hW,hZ[1]),bY.Empty)});},hY);}return bR.getLeaks(hJ)?dZ.collect((hN=bR.getRules(hJ),hN=="Finite"?function(hS){return hP(hS[0],hS[1],hS[2],hS[3],hS[4]);}:hN=="Default"?function(hS){return hQ(hS[0],hS[1],hS[2],hS[3],hS[4]);}:hN=="Infinite"?function(hS){return hR(hS[0],hS[1],hS[2],hS[3],hS[4]);}:function(hS){return hO(hS[0],hS[1],hS[2],hS[3],hS[4]);}),dZ.collect(function(hS){return eo.leak_strand_into_gate(hJ,hK,hS);},hL)):bY.Empty;};cZ.bind_reactions_new_strand=function(hI,hJ,hK,hL,hM){var hN;function hO(hQ,hR,hS,hT){var hU,hV,hW,hX;hU=bR.getRules(hJ);return hU=="Finite"||(hU=="Default"?false:hU!="Infinite")?bX.ofArray([cZ.standard_form(hJ,{$:1,$0:new cO({$:1,$0:hQ}),$1:new cO({$:0,$0:hR}),$2:hS,$3:bX.ofArray([new cO({$:1,$0:hT})])})]):(hW=eo.standard_form(hJ,hT),(hX=eo.fast_reactions(hI,hJ,bX.ofArray([hW])),hX.$==0?bX.ofArray([cZ.standard_form(hJ,{$:1,$0:new cO({$:1,$0:hQ}),$1:new cO({$:0,$0:hR}),$2:hS,$3:bX.ofArray([new cO({$:1,$0:hW})])})]):bX.map(function(hY){return cZ.standard_form(hJ,{$:1,$0:new cO({$:1,$0:hQ}),$1:new cO({$:0,$0:hR}),$2:hS,$3:cN.collate(hY[0],hY[1],bY.Empty)});},hX)));}function hP(hQ,hR,hS,hT){var hU,hV,hW,hX;hU=bR.getRules(hJ);return hU=="Finite"||(hU=="Default"?false:hU!="Infinite")?bX.ofArray([cZ.standard_form(hJ,{$:1,$0:new cO({$:0,$0:hQ}),$1:new cO({$:0,$0:hR}),$2:hS,$3:bX.ofArray([new cO({$:1,$0:hT})])})]):(hW=eo.standard_form(hJ,hT),(hX=eo.fast_reactions(hI,hJ,bX.ofArray([hW])),hX.$==0?bX.ofArray([cZ.standard_form(hJ,{$:1,$0:new cO({$:0,$0:hQ}),$1:new cO({$:0,$0:hR}),$2:hS,$3:bX.ofArray([new cO({$:1,$0:hW})])})]):bX.map(function(hY){return cZ.standard_form(hJ,{$:1,$0:new cO({$:0,$0:hQ}),$1:new cO({$:0,$0:hR}),$2:hS,$3:cN.collate(hY[0],hY[1],bY.Empty)});},hX)));}hN=bR.getUnproductive(hJ);return bX.append(dZ.collect(function(hQ){return hO(hQ[0],hQ[1],hQ[2],hQ[3]);},dZ.collect(function(hQ){return eo.stick_strand_to_gate(hI,hN,hK,hQ);},hL)),dZ.collect(function(hQ){return hP(hQ[0],hQ[1],hQ[2],hQ[3]);},dZ.collect(function(hQ){return eo.stick_strand_to_strand(hI,hN,hK,hQ);},hM)));};cZ.pin_reactions_new_strand=function(hI,hJ,hK){function hL(hM,hN,hO){var hP,hQ,hR,hS;hP=bR.getRules(hJ);return hP=="Finite"||(hP=="Default"?false:hP!="Infinite")?bX.ofArray([cZ.standard_form(hJ,{$:9,$0:new cO({$:0,$0:hM}),$1:hN,$2:bX.ofArray([new cO({$:1,$0:hO})])})]):(hR=eo.standard_form(hJ,hO),(hS=eo.fast_reactions(hI,hJ,bX.ofArray([hR])),hS.$==0?bX.ofArray([cZ.standard_form(hJ,{$:9,$0:new cO({$:0,$0:hM}),$1:hN,$2:bX.ofArray([new cO({$:1,$0:hR})])})]):bX.map(function(hT){return cZ.standard_form(hJ,{$:9,$0:new cO({$:0,$0:hM}),$1:hN,$2:cN.collate(hT[0],hT[1],bY.Empty)});},hS)));}return dZ.collect(function(hM){return hL(hM[0],hM[1],hM[2]);},eo.pin_strand(bR.getUnproductive(hJ),hK));};cZ.origami_cover_reactions=function(hI,hJ,hK){var hL,hM;hL=bR.getRules(hI);return(hL=="Default"?false:hL=="Infinite"?false:hL!="Finite")?dZ.collect(function(hN){return bX.map(function(hO){return cZ.standard_form(hI,{$:10,$0:hJ,$1:{$:6,$0:hO[0],$1:hO[1],$2:hO[2]},$2:hO[3]});},en.cover_reactions(hI,hN,hJ));},hK):bY.Empty;};cZ.origami_pin_open=function(hI,hJ){return bR.getPinLeaks(hI)?bX.map(function(hK){return cZ.standard_form(hI,{$:10,$0:hJ,$1:{$:14,$0:hK[0],$1:{$:7,$0:hK[1],$1:hK[2],$2:hK[3]}},$2:hK[4]});},en.close_open_reactions(hI,hJ)):bY.Empty;};cZ.origami_pin_displacing=function(hI,hJ,hK){function hL(hM,hN,hO,hP,hQ,hR){var hS,hT,hU,hV;function hW(hX,hY,hZ){return hP.$==0&&hQ.$==0&&hX.$==0&&hY.$==0?cZ.standard_form(hJ,{$:10,$0:hK,$1:{$:14,$0:hM,$1:{$:5,$0:hN,$1:hO,$2:bX.append(bX.map(function(h0){return new cO({$:0,$0:h0});},hQ),bX.map(function(h0){return new cO({$:1,$0:h0});},hP))}},$2:hZ}):cZ.standard_form(hJ,{$:12,$0:hK,$1:{$:14,$0:hM,$1:{$:5,$0:hN,$1:hO,$2:bX.append(bX.map(function(h0){return new cO({$:0,$0:h0});},hQ),bX.map(function(h0){return new cO({$:1,$0:h0});},hP))}},$2:cN.collate(bX.append(hX,hP),bX.append(hY,hQ),bX.ofArray([hZ]))});}hS=bR.getRules(hJ);return hS=="Finite"||(hS=="Default"?false:hS!="Infinite")?bX.ofArray([hW(bY.Empty,bY.Empty,hR)]):(hU=en.standard_form(hJ,hR),(hV=en.fast_reactions(hI,hJ,hU),hV.$==0?bX.ofArray([hW(bY.Empty,bY.Empty,hU)]):bX.map(function(hX){return hW(hX[0],hX[1],hX[2]);},hV)));}return bR.getPinLeaks(hJ)?dZ.collect(function(hM){return hL(hM[0],hM[1],hM[2],hM[3],hM[4],hM[5]);},en.close_displacing_reactions(hJ,hK)):bY.Empty;};cZ.origami_pin_migration=function(hI,hJ,hK){function hL(hM,hN,hO,hP,hQ){var hR,hS,hT,hU;hR=bR.getRules(hJ);return hR=="Finite"||(hR=="Default"?false:hR!="Infinite")?bX.ofArray([cZ.standard_form(hJ,{$:10,$0:hK,$1:{$:14,$0:hM,$1:{$:4,$0:hN,$1:hO,$2:hP}},$2:hQ})]):(hT=en.standard_form(hJ,hQ),(hU=en.fast_reactions(hI,hJ,hT),hU.$==0?bX.ofArray([cZ.standard_form(hJ,{$:10,$0:hK,$1:{$:14,$0:hM,$1:{$:4,$0:hN,$1:hO,$2:hP}},$2:hT})]):bX.map(function(hV){var hW,hX,hY;hW=hV[0];hX=hV[1];hY=hV[2];return hW.$==0&&hX.$==0?cZ.standard_form(hJ,{$:10,$0:hK,$1:{$:14,$0:hM,$1:{$:4,$0:hN,$1:hO,$2:hP}},$2:hY}):cZ.standard_form(hJ,{$:12,$0:hK,$1:{$:14,$0:hM,$1:{$:4,$0:hN,$1:hO,$2:hP}},$2:cN.collate(hW,hX,bX.ofArray([hY]))});},hU)));}return bR.getPinLeaks(hJ)?dZ.collect(function(hM){return hL(hM[0],hM[1],hM[2],hM[3],hM[4]);},en.close_migration_reactions(hJ,hK)):bY.Empty;};cZ.origami_migration_open_reactions=function(hI,hJ,hK){var hL,hM;hL=bR.getRules(hI);return(hL=="Default"?false:hL=="Infinite"?false:hL!="Finite")?dZ.collect(function(hN){return bX.map(function(hO){return cZ.standard_form(hI,{$:10,$0:hJ,$1:{$:7,$0:hO[0],$1:hO[1],$2:hO[2]},$2:hO[3]});},en.open_migration_reactions(hI,hN,hJ));},hK):bY.Empty;};cZ.origami_migration_reactions=function(hI,hJ,hK){var hL,hM;hL=bR.getRules(hI);return(hL=="Default"?false:hL=="Infinite"?false:hL!="Finite")?dZ.collect(function(hN){return bX.map(function(hO){return cZ.standard_form(hI,{$:10,$0:hJ,$1:{$:4,$0:hO[0],$1:hO[1],$2:hO[2]},$2:hO[3]});},en.migration_reactions(hI,hN,hJ));},hK):bY.Empty;};cZ.origami_displacement_reactions_expel=function(hI,hJ,hK){var hL,hM;hL=bR.getRules(hI);return(hL=="Default"?false:hL=="Infinite"?false:hL!="Finite")?dZ.collect(function(hN){return bX.map(function(hO){return cZ.standard_form(hI,{$:12,$0:hJ,$1:{$:5,$0:hO[0],$1:hO[1],$2:cN.collate(hO[2],hO[3],bY.Empty)},$2:bX.append(bX.ofArray([new cO({$:2,$0:hO[4]})]),bX.append(bX.map(function(hP){return new cO({$:1,$0:hP});},hO[5]),bX.map(function(hP){return new cO({$:0,$0:hP});},hO[6])))});},en.displacement_reactions_expel(hI,hN,hJ));},hK):bY.Empty;};cZ.origami_displacement_reactions=function(hI,hJ,hK){var hL,hM;hL=bR.getRules(hI);return(hL=="Default"?false:hL=="Infinite"?false:hL!="Finite")?dZ.collect(function(hN){return bX.map(function(hO){return cZ.standard_form(hI,{$:10,$0:hJ,$1:{$:5,$0:hO[0],$1:hO[1],$2:cN.collate(hO[2],hO[3],bY.Empty)},$2:hO[4]});},en.displacement_reactions(hI,hN,hJ));},hK):bY.Empty;};cZ.origami_tau_reactions=function(hI,hJ,hK){var hL,hM,hN;hL=(en.origami_species(hK))[0];hM=bR.getRules(hJ);return(hM=="Default"?false:hM=="Infinite"?false:hM!="Detailed")?dZ.collect(function(hO){return bX.map(function(hP){var hQ,hR,hS;hQ=hP[0];hR=hP[1];hS=hP[2];return hQ.$==0&&hR.$==0?cZ.standard_form(hJ,{$:10,$0:hK,$1:{$:3,$0:hO,$1:bY.Empty},$2:hS}):cZ.standard_form(hJ,{$:12,$0:hK,$1:{$:3,$0:hO,$1:bY.Empty},$2:cN.collate(hQ,hR,bX.ofArray([hS]))});},en.fast_reactions(hI,hJ,hK));},hL):bY.Empty;};cZ.origami_pin_reactions=function(hI,hJ,hK){function hL(hN,hO,hP,hQ){var hR,hS,hT,hU;hR=bR.getRules(hJ);return hR=="Finite"||(hR=="Default"?false:hR!="Infinite")?bX.ofArray([cZ.standard_form(hJ,{$:10,$0:hK,$1:{$:9,$0:new cO({$:0,$0:hN}),$1:hO,$2:bX.ofArray([new cO({$:1,$0:hP})])},$2:hQ})]):(hT=en.standard_form(hJ,hQ),(hU=en.fast_reactions(hI,hJ,hT),hU.$==0?bX.ofArray([cZ.standard_form(hJ,{$:10,$0:hK,$1:{$:9,$0:new cO({$:0,$0:hN}),$1:hO,$2:bX.ofArray([new cO({$:1,$0:hP})])},$2:hT})]):bX.map(function(hV){var hW,hX,hY;hW=hV[0];hX=hV[1];hY=hV[2];return hW.$==0&&hX.$==0?cZ.standard_form(hJ,{$:10,$0:hK,$1:{$:9,$0:new cO({$:0,$0:hN}),$1:hO,$2:bX.ofArray([new cO({$:1,$0:hP})])},$2:hY}):cZ.standard_form(hJ,{$:12,$0:hK,$1:{$:9,$0:new cO({$:0,$0:hN}),$1:hO,$2:bX.ofArray([new cO({$:1,$0:hP})])},$2:cN.collate(hW,hX,bX.ofArray([hY]))});},hU)));}function hM(hN,hO,hP,hQ){var hR,hS,hT,hU;hR=bR.getRules(hJ);return hR=="Finite"||(hR=="Default"?false:hR!="Infinite")?bX.ofArray([cZ.standard_form(hJ,{$:10,$0:hK,$1:{$:9,$0:new cO({$:1,$0:hN}),$1:hO,$2:bX.ofArray([new cO({$:1,$0:hP})])},$2:hQ})]):(hT=en.standard_form(hJ,hQ),(hU=en.fast_reactions(hI,hJ,hT),hU.$==0?bX.ofArray([cZ.standard_form(hJ,{$:10,$0:hK,$1:{$:9,$0:new cO({$:1,$0:hN}),$1:hO,$2:bX.ofArray([new cO({$:1,$0:hP})])},$2:hT})]):bX.map(function(hV){var hW,hX,hY;hW=hV[0];hX=hV[1];hY=hV[2];return hW.$==0&&hX.$==0?cZ.standard_form(hJ,{$:10,$0:hK,$1:{$:9,$0:new cO({$:1,$0:hN}),$1:hO,$2:bX.ofArray([new cO({$:1,$0:hP})])},$2:hY}):cZ.standard_form(hJ,{$:12,$0:hK,$1:{$:9,$0:new cO({$:1,$0:hN}),$1:hO,$2:bX.ofArray([new cO({$:1,$0:hP})])},$2:cN.collate(hW,hX,bX.ofArray([hY]))});},hU)));}return bX.append(dZ.collect(function(hN){return hL(hN[0],hN[1],hN[2],hN[3]);},en.pinning_reactions_s(hJ,hK)),dZ.collect(function(hN){return hM(hN[0],hN[1],hN[2],hN[3]);},en.pinning_reactions_g(hJ,hK)));};cZ.origami_bind_reactions=function(hI,hJ,hK,hL,hM){var hN,hO,hP,hQ;function hR(hV,hW,hX,hY,hZ){var h0,h1,h2,h3;h0=bR.getRules(hJ);return h0=="Finite"||(h0=="Default"?false:h0!="Infinite")?bX.ofArray([cZ.standard_form(hJ,{$:10,$0:hK,$1:{$:1,$0:new cO({$:1,$0:hV}),$1:new cO({$:0,$0:hW}),$2:hX,$3:bX.ofArray([new cO({$:1,$0:hY})])},$2:hZ})]):(h2=en.standard_form(hJ,hZ),(h3=en.fast_reactions(hI,hJ,h2),h3.$==0?bX.ofArray([cZ.standard_form(hJ,{$:10,$0:hK,$1:{$:1,$0:new cO({$:1,$0:hV}),$1:new cO({$:0,$0:hW}),$2:hX,$3:bX.ofArray([new cO({$:1,$0:hY})])},$2:h2})]):bX.map(function(h4){var h5,h6,h7;h5=h4[0];h6=h4[1];h7=h4[2];return h5.$==0&&h6.$==0?cZ.standard_form(hJ,{$:10,$0:hK,$1:{$:1,$0:new cO({$:1,$0:hV}),$1:new cO({$:0,$0:hW}),$2:hX,$3:bX.ofArray([new cO({$:1,$0:hY})])},$2:h7}):cZ.standard_form(hJ,{$:12,$0:hK,$1:{$:1,$0:new cO({$:1,$0:hV}),$1:new cO({$:0,$0:hW}),$2:hX,$3:bX.ofArray([new cO({$:1,$0:hY})])},$2:cN.collate(h5,h6,bX.ofArray([h7]))});},h3)));}function hS(hV,hW,hX,hY,hZ){var h0,h1,h2,h3;return bR.getPolymers(hJ)?(h0=bR.getRules(hJ),h0=="Finite"||(h0=="Default"?false:h0!="Infinite")?bX.ofArray([cZ.standard_form(hJ,{$:10,$0:hK,$1:{$:1,$0:new cO({$:1,$0:hV}),$1:new cO({$:1,$0:hW}),$2:hX,$3:bX.ofArray([new cO({$:1,$0:hY})])},$2:hZ})]):(h2=en.standard_form(hJ,hZ),(h3=en.fast_reactions(hI,hJ,h2),h3.$==0?bX.ofArray([cZ.standard_form(hJ,{$:10,$0:hK,$1:{$:1,$0:new cO({$:1,$0:hV}),$1:new cO({$:1,$0:hW}),$2:hX,$3:bX.ofArray([new cO({$:1,$0:hY})])},$2:h2})]):bX.map(function(h4){var h5,h6,h7;h5=h4[0];h6=h4[1];h7=h4[2];return h5.$==0&&h6.$==0?cZ.standard_form(hJ,{$:10,$0:hK,$1:{$:1,$0:new cO({$:1,$0:hV}),$1:new cO({$:1,$0:hW}),$2:hX,$3:bX.ofArray([new cO({$:1,$0:hY})])},$2:h7}):cZ.standard_form(hJ,{$:12,$0:hK,$1:{$:1,$0:new cO({$:1,$0:hV}),$1:new cO({$:1,$0:hW}),$2:hX,$3:bX.ofArray([new cO({$:1,$0:hY})])},$2:cN.collate(h5,h6,bX.ofArray([h7]))});},h3)))):fc.illegal_polymerisation_error(eo.display(hV),eo.display(hW));}function hT(hV,hW,hX,hY,hZ){var h0,h1,h2,h3;h0=bR.getRules(hJ);return h0=="Finite"||(h0=="Default"?false:h0!="Infinite")?bX.ofArray([cZ.standard_form(hJ,{$:10,$0:hK,$1:{$:1,$0:new cO({$:0,$0:hV}),$1:new cO({$:0,$0:hW}),$2:hX,$3:bX.ofArray([new cO({$:1,$0:hY})])},$2:hZ})]):(h2=en.standard_form(hJ,hZ),(h3=en.fast_reactions(hI,hJ,h2),h3.$==0?bX.ofArray([cZ.standard_form(hJ,{$:10,$0:hK,$1:{$:1,$0:new cO({$:0,$0:hV}),$1:new cO({$:0,$0:hW}),$2:hX,$3:bX.ofArray([new cO({$:1,$0:hY})])},$2:h2})]):bX.map(function(h4){var h5,h6,h7;h5=h4[0];h6=h4[1];h7=h4[2];return h5.$==0&&h6.$==0?cZ.standard_form(hJ,{$:10,$0:hK,$1:{$:1,$0:new cO({$:0,$0:hV}),$1:new cO({$:0,$0:hW}),$2:hX,$3:bX.ofArray([new cO({$:1,$0:hY})])},$2:h7}):cZ.standard_form(hJ,{$:12,$0:hK,$1:{$:1,$0:new cO({$:0,$0:hV}),$1:new cO({$:0,$0:hW}),$2:hX,$3:bX.ofArray([new cO({$:1,$0:hY})])},$2:cN.collate(h5,h6,bX.ofArray([h7]))});},h3)));}function hU(hV,hW,hX,hY,hZ){var h0,h1,h2,h3;h0=bR.getRules(hJ);return h0=="Finite"||(h0=="Default"?false:h0!="Infinite")?bX.ofArray([cZ.standard_form(hJ,{$:10,$0:hK,$1:{$:1,$0:new cO({$:1,$0:hV}),$1:new cO({$:0,$0:hW}),$2:hX,$3:bX.ofArray([new cO({$:1,$0:hY})])},$2:hZ})]):(h2=en.standard_form(hJ,hZ),(h3=en.fast_reactions(hI,hJ,h2),h3.$==0?bX.ofArray([cZ.standard_form(hJ,{$:10,$0:hK,$1:{$:1,$0:new cO({$:1,$0:hV}),$1:new cO({$:0,$0:hW}),$2:hX,$3:bX.ofArray([new cO({$:1,$0:hY})])},$2:h2})]):bX.map(function(h4){var h5,h6,h7;h5=h4[0];h6=h4[1];h7=h4[2];return h5.$==0&&h6.$==0?cZ.standard_form(hJ,{$:10,$0:hK,$1:{$:1,$0:new cO({$:1,$0:hV}),$1:new cO({$:0,$0:hW}),$2:hX,$3:bX.ofArray([new cO({$:1,$0:hY})])},$2:h7}):cZ.standard_form(hJ,{$:12,$0:hK,$1:{$:1,$0:new cO({$:1,$0:hV}),$1:new cO({$:0,$0:hW}),$2:hX,$3:bX.ofArray([new cO({$:1,$0:hY})])},$2:cN.collate(h5,h6,bX.ofArray([h7]))});},h3)));}hN=dZ.collect(function(hV){return hR(hV[0],hV[1],hV[2],hV[3],hV[4]);},dZ.collect(function(hV){return en.sticking_reactions_gs(hI,hJ,hK,hV);},hM));hO=dZ.collect(function(hV){return hS(hV[0],hV[1],hV[2],hV[3],hV[4]);},dZ.collect(function(hV){return en.sticking_reactions_gg(hI,hJ,hK,hV);},hM));hP=dZ.collect(function(hV){return hT(hV[0],hV[1],hV[2],hV[3],hV[4]);},dZ.collect(function(hV){return en.sticking_reactions_ss(hI,hJ,hK,hV);},hL));hQ=dZ.collect(function(hV){return hU(hV[0],hV[1],hV[2],hV[3],hV[4]);},dZ.collect(function(hV){return en.sticking_reactions_sg(hI,hJ,hK,hV);},hL));return bX.append(hP,bX.append(hL.$==0||hM.$==0?hQ:dZ.fold_left(function(hV,hW){return dZ.forall(function(hX){return cZ.matching_reactions(hJ,hW,hX);},hN)?hV:new bY({$:1,$0:hW,$1:hV});},bY.Empty,hQ),bX.append(hN,hO)));};cZ.origami_unbind_open_reactions=function(hI,hJ,hK,hL){var hM,hN;function hO(hQ,hR,hS,hT,hU){return cZ.standard_form(hJ,{$:10,$0:hK,$1:{$:8,$0:hQ,$1:hR,$2:cN.collate(hS,hT,bY.Empty)},$2:hU});}function hP(hQ,hR,hS,hT,hU){var hV,hW;hV=en.standard_form(hJ,hU);hW=en.fast_reactions(hI,hJ,hV);return hW.$==0?bX.ofArray([cZ.standard_form(hJ,{$:10,$0:hK,$1:{$:8,$0:hQ,$1:hR,$2:cN.collate(hS,hT,bY.Empty)},$2:hV})]):bX.map(function(hX){var hY,hZ,h0;hY=hX[0];hZ=hX[1];h0=hX[2];return hY.$==0&&hZ.$==0?cZ.standard_form(hJ,{$:10,$0:hK,$1:{$:0,$0:hQ,$1:hR,$2:cN.collate(hS,hT,bY.Empty)},$2:h0}):cZ.standard_form(hJ,{$:12,$0:hK,$1:{$:0,$0:hQ,$1:hR,$2:cN.collate(hS,hT,bY.Empty)},$2:cN.collate(hY,hZ,bX.ofArray([h0]))});},hW);}hM=bR.getRules(hJ);return hM=="Finite"||(hM=="Default"?false:hM!="Infinite")?bX.map(function(hQ){return hO(hQ[0],hQ[1],hQ[2],hQ[3],hQ[4]);},dZ.collect(function(hQ){return en.unbind_open_reactions(hJ,hQ,hK);},hL)):dZ.collect(function(hQ){return hP(hQ[0],hQ[1],hQ[2],hQ[3],hQ[4]);},dZ.collect(function(hQ){return en.unbind_open_reactions(hJ,hQ,hK);},hL));};cZ.origami_unbind_reactions_expel=function(hI,hJ,hK,hL){var hM,hP;function hN(hQ,hR,hS,hT,hU,hV,hW){return cZ.standard_form(hJ,{$:12,$0:hK,$1:{$:0,$0:hQ,$1:hR,$2:cN.collate(hS,hT,bY.Empty)},$2:bX.append(bX.ofArray([new cO({$:2,$0:hU})]),bX.append(bX.map(function(hX){return new cO({$:1,$0:hX});},hV),bX.map(function(hX){return new cO({$:0,$0:hX});},hW)))});}function hO(hQ,hR,hS,hT,hU,hV,hW){var hX;hX=en.fast_reactions(hI,hJ,hU);return hX.$==0?bX.ofArray([cZ.standard_form(hJ,{$:12,$0:hK,$1:{$:0,$0:hQ,$1:hR,$2:cN.collate(hS,hT,bY.Empty)},$2:bX.append(bX.ofArray([new cO({$:2,$0:hU})]),bX.append(bX.map(function(hY){return new cO({$:1,$0:hY});},hV),bX.map(function(hY){return new cO({$:0,$0:hY});},hW)))})]):bX.map(function(hY){return cZ.standard_form(hJ,{$:12,$0:hK,$1:{$:0,$0:hQ,$1:hR,$2:cN.collate(hS,hT,bY.Empty)},$2:cN.collate(bX.append(hV,hY[0]),bX.append(hW,hY[1]),bX.ofArray([hY[2]]))});},hX);}hP=bR.getRules(hJ);switch(hP=="Default"?1:hP=="Infinite"?2:hP=="Finite"?2:0){case 0:return bX.map(function(hQ){return hN(hQ[0],hQ[1],hQ[2],hQ[3],hQ[4],hQ[5],hQ[6]);},dZ.collect(function(hQ){return en.unsticking_reactions_expel(hI,hJ,hQ,hK);},hL));case 1:return dZ.collect(function(hQ){return hO(hQ[0],hQ[1],hQ[2],hQ[3],hQ[4],hQ[5],hQ[6]);},dZ.collect(function(hQ){return en.unsticking_reactions_expel(hI,hJ,hQ,hK);},hL));case 2:return bY.Empty;}};cZ.origami_unbind_reactions=function(hI,hJ,hK,hL){var hM,hP;function hN(hQ,hR,hS,hT,hU){return cZ.standard_form(hJ,{$:10,$0:hK,$1:{$:0,$0:hQ,$1:hR,$2:cN.collate(hS,hT,bY.Empty)},$2:hU});}function hO(hQ,hR,hS,hT,hU){var hV,hW;hV=en.standard_form(hJ,hU);hW=en.fast_reactions(hI,hJ,hV);return hW.$==0?bX.ofArray([cZ.standard_form(hJ,{$:10,$0:hK,$1:{$:0,$0:hQ,$1:hR,$2:cN.collate(hS,hT,bY.Empty)},$2:hV})]):bX.map(function(hX){var hY,hZ,h0;hY=hX[0];hZ=hX[1];h0=hX[2];return hY.$==0&&hZ.$==0?cZ.standard_form(hJ,{$:10,$0:hK,$1:{$:0,$0:hQ,$1:hR,$2:cN.collate(hS,hT,bY.Empty)},$2:h0}):cZ.standard_form(hJ,{$:12,$0:hK,$1:{$:0,$0:hQ,$1:hR,$2:cN.collate(hS,hT,bY.Empty)},$2:cN.collate(hY,hZ,bX.ofArray([h0]))});},hW);}hP=bR.getRules(hJ);switch(hP=="Default"?1:hP=="Infinite"?2:hP=="Finite"?2:0){case 0:return bX.map(function(hQ){return hN(hQ[0],hQ[1],hQ[2],hQ[3],hQ[4]);},dZ.collect(function(hQ){return en.unsticking_reactions(hI,hJ,hQ,hK);},hL));case 1:return dZ.collect(function(hQ){return hO(hQ[0],hQ[1],hQ[2],hQ[3],hQ[4]);},dZ.collect(function(hQ){return en.unsticking_reactions(hI,hJ,hQ,hK);},hL));case 2:return bY.Empty;}};cZ.entry_reactions_new_origami=function(hI,hJ,hK,hL,hM){var hN,hO,hP,hQ;function hR(hV,hW,hX,hY,hZ){var h0,h1,h2,h3;h0=bR.getRules(hJ);return h0=="Finite"||(h0=="Default"?false:h0!="Infinite")?bX.ofArray([cZ.standard_form(hJ,{$:11,$0:hK,$1:new cO({$:1,$0:hV}),$2:{$:1,$0:new cO({$:1,$0:hV}),$1:new cO({$:0,$0:hW}),$2:hX,$3:bX.ofArray([new cO({$:1,$0:hY})])},$3:hZ})]):(h2=en.standard_form(hJ,hZ),(h3=en.fast_reactions(hI,hJ,h2),h3.$==0?bX.ofArray([cZ.standard_form(hJ,{$:11,$0:hK,$1:new cO({$:1,$0:hV}),$2:{$:1,$0:new cO({$:1,$0:hV}),$1:new cO({$:0,$0:hW}),$2:hX,$3:bX.ofArray([new cO({$:1,$0:hY})])},$3:h2})]):bX.map(function(h4){var h5,h6,h7;h5=h4[0];h6=h4[1];h7=h4[2];return h5.$==0&&h6.$==0?cZ.standard_form(hJ,{$:11,$0:hK,$1:new cO({$:1,$0:hV}),$2:{$:1,$0:new cO({$:1,$0:hV}),$1:new cO({$:0,$0:hW}),$2:hX,$3:bX.ofArray([new cO({$:1,$0:hY})])},$3:h7}):cZ.standard_form(hJ,{$:13,$0:hK,$1:new cO({$:1,$0:hV}),$2:{$:1,$0:new cO({$:1,$0:hV}),$1:new cO({$:0,$0:hW}),$2:hX,$3:bX.ofArray([new cO({$:1,$0:hY})])},$3:cN.collate(h5,h6,bX.ofArray([h7]))});},h3)));}function hS(hV,hW,hX,hY,hZ){var h0,h1,h2,h3,h4;return bR.getPolymers(hJ)?(h0={$:1,$0:new cO({$:1,$0:hV}),$1:new cO({$:1,$0:hW}),$2:hX,$3:bX.ofArray([new cO({$:1,$0:hY})])},(h1=bR.getRules(hJ),h1=="Finite"||(h1=="Default"?false:h1!="Infinite")?bX.ofArray([cZ.standard_form(hJ,{$:11,$0:hK,$1:new cO({$:1,$0:hV}),$2:h0,$3:hZ})]):(h3=en.standard_form(hJ,hZ),(h4=en.fast_reactions(hI,hJ,h3),h4.$==0?bX.ofArray([cZ.standard_form(hJ,{$:11,$0:hK,$1:new cO({$:1,$0:hV}),$2:h0,$3:h3})]):bX.map(function(h5){var h6,h7,h8;h6=h5[0];h7=h5[1];h8=h5[2];return h6.$==0&&h7.$==0?cZ.standard_form(hJ,{$:11,$0:hK,$1:new cO({$:1,$0:hV}),$2:h0,$3:h8}):cZ.standard_form(hJ,{$:13,$0:hK,$1:new cO({$:1,$0:hV}),$2:h0,$3:cN.collate(h6,h7,bX.ofArray([h8]))});},h4))))):fc.illegal_polymerisation_error(eo.display(hV),eo.display(hW));}function hT(hV,hW,hX,hY,hZ){var h0,h1,h2,h3,h4;h0={$:1,$0:new cO({$:0,$0:hV}),$1:new cO({$:0,$0:hW}),$2:hX,$3:bX.ofArray([new cO({$:1,$0:hY})])};h1=bR.getRules(hJ);return h1=="Finite"||(h1=="Default"?false:h1!="Infinite")?bX.ofArray([cZ.standard_form(hJ,{$:11,$0:hK,$1:new cO({$:0,$0:hV}),$2:h0,$3:hZ})]):(h3=en.standard_form(hJ,hZ),(h4=en.fast_reactions(hI,hJ,h3),h4.$==0?bX.ofArray([cZ.standard_form(hJ,{$:11,$0:hK,$1:new cO({$:0,$0:hV}),$2:h0,$3:h3})]):bX.map(function(h5){var h6,h7,h8;h6=h5[0];h7=h5[1];h8=h5[2];return h6.$==0&&h7.$==0?cZ.standard_form(hJ,{$:11,$0:hK,$1:new cO({$:0,$0:hV}),$2:h0,$3:h8}):cZ.standard_form(hJ,{$:13,$0:hK,$1:new cO({$:0,$0:hV}),$2:h0,$3:cN.collate(h6,h7,bX.ofArray([h8]))});},h4)));}function hU(hV,hW,hX,hY,hZ){var h0,h1,h2,h3,h4;h0={$:1,$0:new cO({$:1,$0:hV}),$1:new cO({$:0,$0:hW}),$2:hX,$3:bX.ofArray([new cO({$:1,$0:hY})])};h1=bR.getRules(hJ);return h1=="Finite"||(h1=="Default"?false:h1!="Infinite")?bX.ofArray([cZ.standard_form(hJ,{$:11,$0:hK,$1:new cO({$:0,$0:hW}),$2:h0,$3:hZ})]):(h3=en.standard_form(hJ,hZ),(h4=en.fast_reactions(hI,hJ,h3),h4.$==0?bX.ofArray([cZ.standard_form(hJ,{$:11,$0:hK,$1:new cO({$:0,$0:hW}),$2:h0,$3:h3})]):bX.map(function(h5){var h6,h7,h8;h6=h5[0];h7=h5[1];h8=h5[2];return h6.$==0&&h7.$==0?cZ.standard_form(hJ,{$:11,$0:hK,$1:new cO({$:0,$0:hW}),$2:h0,$3:h8}):cZ.standard_form(hJ,{$:13,$0:hK,$1:new cO({$:0,$0:hW}),$2:h0,$3:cN.collate(h6,h7,bX.ofArray([h8]))});},h4)));}hN=dZ.collect(function(hV){return en.entry_reactions_ss(hI,hJ,hK,hV);},hL);hO=dZ.collect(function(hV){return en.entry_reactions_sg(hI,hJ,hK,hV);},hL);hP=dZ.collect(function(hV){return en.entry_reactions_gs(hI,hJ,hK,hV);},hM);hQ=dZ.collect(function(hV){return en.entry_reactions_gg(hI,hJ,hK,hV);},hM);return bX.append(dZ.collect(function(hV){return hT(hV[0],hV[1],hV[2],hV[3],hV[4]);},hN),bX.append(dZ.collect(function(hV){return hU(hV[0],hV[1],hV[2],hV[3],hV[4]);},hO),bX.append(dZ.collect(function(hV){return hR(hV[0],hV[1],hV[2],hV[3],hV[4]);},hP),dZ.collect(function(hV){return hS(hV[0],hV[1],hV[2],hV[3],hV[4]);},hQ))));};cZ.looks_like_origami_reaction=function(hI,hJ){var hK,hL;hK=Z.nonzero_elements(hJ.reactants);return bX.exists((hL=new cO({$:2,$0:hI}),function(hM){return cw.Equals(hL,hM);}),hK);};cZ.entry_reactions_new_gate=function(hI,hJ,hK,hL){var hM,hN;function hO(hQ,hR){var hS,hT,hU,hV,hW,hX,hY,hZ,h0;hS=hR[1];hT=hR[4];hU=hR[2];hV=hR[3];hW=hR[0];hX=bR.getRules(hJ);return hX=="Finite"||(hX=="Default"?false:hX!="Infinite")?bX.ofArray([cZ.standard_form(hJ,{$:11,$0:hQ,$1:new cO({$:1,$0:hW}),$2:{$:1,$0:new cO({$:1,$0:hW}),$1:new cO({$:0,$0:hS}),$2:hU,$3:bX.ofArray([new cO({$:1,$0:hV})])},$3:hT})]):(hZ=en.standard_form(hJ,hT),(h0=en.fast_reactions(hI,hJ,hZ),h0.$==0?bX.ofArray([cZ.standard_form(hJ,{$:11,$0:hQ,$1:new cO({$:1,$0:hW}),$2:{$:1,$0:new cO({$:1,$0:hW}),$1:new cO({$:0,$0:hS}),$2:hU,$3:bX.ofArray([new cO({$:1,$0:hV})])},$3:hZ})]):bX.map(function(h1){var h2,h3,h4;h2=h1[0];h3=h1[1];h4=h1[2];return h2.$==0&&h3.$==0?cZ.standard_form(hJ,{$:11,$0:hQ,$1:new cO({$:1,$0:hW}),$2:{$:1,$0:new cO({$:1,$0:hW}),$1:new cO({$:0,$0:hS}),$2:hU,$3:bX.ofArray([new cO({$:1,$0:hV})])},$3:h4}):cZ.standard_form(hJ,{$:13,$0:hQ,$1:new cO({$:1,$0:hW}),$2:{$:1,$0:new cO({$:1,$0:hW}),$1:new cO({$:0,$0:hS}),$2:hU,$3:bX.ofArray([new cO({$:1,$0:hV})])},$3:cN.collate(h2,h3,bX.ofArray([h4]))});},h0)));}function hP(hQ,hR){var hS,hT,hU,hV,hW,hX,hY,hZ,h0;hS=hR[4];hT=hR[2];hU=hR[1];hV=hR[0];hW=hR[3];return bR.getPolymers(hJ)?(hX=bR.getRules(hJ),hX=="Finite"||(hX=="Default"?false:hX!="Infinite")?bX.ofArray([cZ.standard_form(hJ,{$:11,$0:hQ,$1:new cO({$:1,$0:hV}),$2:{$:1,$0:new cO({$:1,$0:hV}),$1:new cO({$:1,$0:hU}),$2:hT,$3:bX.ofArray([new cO({$:1,$0:hW})])},$3:hS})]):(hZ=en.standard_form(hJ,hS),(h0=en.fast_reactions(hI,hJ,hZ),h0.$==0?bX.ofArray([cZ.standard_form(hJ,{$:11,$0:hQ,$1:new cO({$:1,$0:hV}),$2:{$:1,$0:new cO({$:1,$0:hV}),$1:new cO({$:1,$0:hU}),$2:hT,$3:bX.ofArray([new cO({$:1,$0:hW})])},$3:hZ})]):bX.map(function(h1){var h2,h3,h4;h2=h1[0];h3=h1[1];h4=h1[2];return h2.$==0&&h3.$==0?cZ.standard_form(hJ,{$:11,$0:hQ,$1:new cO({$:1,$0:hV}),$2:{$:1,$0:new cO({$:1,$0:hV}),$1:new cO({$:1,$0:hU}),$2:hT,$3:bX.ofArray([new cO({$:1,$0:hW})])},$3:h4}):cZ.standard_form(hJ,{$:13,$0:hQ,$1:new cO({$:1,$0:hV}),$2:{$:1,$0:new cO({$:1,$0:hV}),$1:new cO({$:1,$0:hU}),$2:hT,$3:bX.ofArray([new cO({$:1,$0:hW})])},$3:cN.collate(h2,h3,bX.ofArray([h4]))});},h0)))):fc.illegal_polymerisation_error(eo.display(hV),eo.display(hU));}hM=dZ.collect(function(hQ){return bX.map(function(hR){return[hQ,hR];},en.entry_reactions_gs(hI,hJ,hQ,hK));},hL);hN=dZ.collect(function(hQ){return bX.map(function(hR){return[hQ,hR];},en.entry_reactions_gg(hI,hJ,hQ,hK));},hL);return bX.append(dZ.collect(function(hQ){return hO(hQ[0],hQ[1]);},hM),dZ.collect(function(hQ){return hP(hQ[0],hQ[1]);},hN));};cZ.nick_reactions=function(hI,hJ){return hJ.$==1?bY.Empty:bX.map(function(hK){return{$:15,$0:new cO({$:1,$0:hI}),$1:hJ,$2:new cO({$:1,$0:hK})};},cZ.nick_gate(hJ.$0,hJ.$1,hI));};cZ.cover_reactions=function(hI,hJ){var hK,hL;hK=bR.getRules(hI);return(hK=="Default"?false:hK=="Infinite"?false:hK!="Finite")?bX.map(function(hM){return cZ.standard_form(hI,{$:6,$0:hM[0],$1:hM[1],$2:hM[2]});},eo.cover_reactions(hJ)):bY.Empty;};cZ.pin_open_new_gate=function(hI,hJ){return bR.getPinLeaks(hI)?bX.map(function(hK){return cZ.standard_form(hI,{$:14,$0:hK[0],$1:{$:7,$0:hK[1],$1:hK[2],$2:hK[3]}});},eo.close_open_reactions(hI,hJ)):bY.Empty;};cZ.pin_displacing_new_gate=function(hI,hJ,hK){function hL(hM,hN,hO,hP,hQ){var hR,hS,hT,hU;hR=bR.getRules(hJ);return hR=="Finite"||(hR=="Default"?false:hR!="Infinite")?bX.ofArray([cZ.standard_form(hJ,{$:14,$0:hM,$1:{$:5,$0:hN,$1:hO,$2:bX.append(bX.map(function(hV){return new cO({$:0,$0:hV});},hQ),bX.map(function(hV){return new cO({$:1,$0:hV});},hP))}})]):(hT=bX.map(function(hV){return eo.standard_form(hJ,hV);},hP),(hU=eo.fast_reactions(hI,hJ,hT),hU.$==0?bX.ofArray([cZ.standard_form(hJ,{$:14,$0:hM,$1:{$:5,$0:hN,$1:hO,$2:bX.append(bX.map(function(hV){return new cO({$:0,$0:hV});},hQ),bX.map(function(hV){return new cO({$:1,$0:hV});},hT))}})]):bX.map(function(hV){return cZ.standard_form(hJ,{$:14,$0:hM,$1:{$:5,$0:hN,$1:hO,$2:cN.collate(hV[0],hV[1],bY.Empty)}});},hU)));}return bR.getPinLeaks(hJ)?dZ.collect(function(hM){return hL(hM[0],hM[1],hM[2],hM[3],hM[4]);},eo.close_displacing_reactions(hJ,hK)):bY.Empty;};cZ.pin_migration_new_gate=function(hI,hJ,hK){function hL(hM,hN,hO,hP){var hQ,hR,hS,hT;hQ=bR.getRules(hJ);return hQ=="Finite"||(hQ=="Default"?false:hQ!="Infinite")?bX.ofArray([cZ.standard_form(hJ,{$:14,$0:hM,$1:{$:4,$0:hN,$1:hO,$2:hP}})]):(hS=eo.standard_form(hJ,hP),(hT=eo.fast_reactions(hI,hJ,bX.ofArray([hS])),hT.$==0?bX.ofArray([cZ.standard_form(hJ,{$:14,$0:hM,$1:{$:4,$0:hN,$1:hO,$2:hS}})]):bX.map(function(hU){return cZ.standard_form(hJ,{$:14,$0:hM,$1:{$:5,$0:hN,$1:hO,$2:cN.collate(hU[0],hU[1],bY.Empty)}});},hT)));}return bR.getPinLeaks(hJ)?dZ.collect(function(hM){return hL(hM[0],hM[1],hM[2],hM[3]);},eo.close_migration_reactions(hJ,hK)):bY.Empty;};cZ.migration_open_reactions=function(hI,hJ){var hK,hL;hK=bR.getRules(hI);return(hK=="Default"?false:hK=="Infinite"?false:hK!="Finite")?bX.map(function(hM){return cZ.standard_form(hI,{$:7,$0:hM[0],$1:hM[1],$2:hM[2]});},eo.open_migration_reactions(hI,hJ)):bY.Empty;};cZ.migration_reactions=function(hI,hJ){var hK,hL;hK=bR.getRules(hI);return(hK=="Default"?false:hK=="Infinite"?false:hK!="Finite")?bX.map(function(hM){return cZ.standard_form(hI,{$:4,$0:hM[0],$1:hM[1],$2:hM[2]});},eo.migration_reactions(hJ)):bY.Empty;};cZ.displacement_reactions=function(hI,hJ){var hK,hL;hK=bR.getRules(hI);return(hK=="Default"?false:hK=="Infinite"?false:hK!="Finite")?bX.map(function(hM){return cZ.standard_form(hI,{$:5,$0:hM[0],$1:hM[1],$2:cN.collate(hM[2],hM[3],bY.Empty)});},eo.displacement_reactions(hI,hJ)):bY.Empty;};cZ.tau_reactions=function(hI,hJ,hK){var hL,hM;hL=bR.getRules(hJ);return(hL=="Default"?false:hL=="Infinite"?false:hL!="Detailed")?bX.map(function(hN){return cZ.standard_form(hJ,{$:3,$0:hK,$1:cN.collate(hN[0],hN[1],bY.Empty)});},eo.fast_reactions(hI,hJ,bX.ofArray([hK]))):bY.Empty;};cZ.leak_reactions_new_gate=function(hI,hJ,hK,hL,hM){var hN,hO;function hP(hX,hY,hZ,h0,h1){return bX.ofArray([cZ.standard_form(hJ,{$:2,$0:new cO({$:1,$0:hX}),$1:new cO({$:0,$0:hY}),$2:hZ,$3:cN.collate(h0,h1,bY.Empty)})]);}function hQ(hX,hY,hZ,h0,h1){return bX.ofArray([cZ.standard_form(hJ,{$:2,$0:new cO({$:1,$0:hX}),$1:new cO({$:0,$0:hY}),$2:hZ,$3:cN.collate(h0,h1,bY.Empty)})]);}function hR(hX,hY,hZ,h0,h1){var h2,h3;h2=bX.map(function(h4){return eo.standard_form(hJ,h4);},h0);h3=eo.fast_reactions(hI,hJ,h2);return h3.$==0?bX.ofArray([cZ.standard_form(hJ,{$:2,$0:new cO({$:1,$0:hX}),$1:new cO({$:0,$0:hY}),$2:hZ,$3:cN.collate(h2,h1,bY.Empty)})]):bX.map(function(h4){return cZ.standard_form(hJ,{$:2,$0:new cO({$:1,$0:hX}),$1:new cO({$:0,$0:hY}),$2:hZ,$3:cN.collate(h4[0],bX.append(h1,h4[1]),bY.Empty)});},h3);}function hS(hX,hY,hZ,h0,h1){var h2,h3;h2=bX.map(function(h4){return eo.standard_form(hJ,h4);},h0);h3=eo.fast_reactions(hI,hJ,h2);return h3.$==0?bX.ofArray([cZ.standard_form(hJ,{$:2,$0:new cO({$:1,$0:hX}),$1:new cO({$:0,$0:hY}),$2:hZ,$3:cN.collate(h2,h1,bY.Empty)})]):bX.map(function(h4){return cZ.standard_form(hJ,{$:2,$0:new cO({$:1,$0:hX}),$1:new cO({$:0,$0:hY}),$2:hZ,$3:cN.collate(h4[0],bX.append(h1,h4[1]),bY.Empty)});},h3);}function hT(hX,hY,hZ,h0,h1){return bX.ofArray([cZ.standard_form(hJ,{$:2,$0:new cO({$:1,$0:hX}),$1:new cO({$:1,$0:hY}),$2:hZ,$3:cN.collate(h0,h1,bY.Empty)})]);}function hU(hX,hY,hZ,h0,h1){return bX.ofArray([cZ.standard_form(hJ,{$:2,$0:new cO({$:1,$0:hX}),$1:new cO({$:1,$0:hY}),$2:hZ,$3:cN.collate(h0,h1,bY.Empty)})]);}function hV(hX,hY,hZ,h0,h1){var h2,h3;h2=bX.map(function(h4){return eo.standard_form(hJ,h4);},h0);h3=eo.fast_reactions(hI,hJ,h2);return h3.$==0?bX.ofArray([cZ.standard_form(hJ,{$:2,$0:new cO({$:1,$0:hX}),$1:new cO({$:1,$0:hY}),$2:hZ,$3:cN.collate(h2,h1,bY.Empty)})]):bX.map(function(h4){return cZ.standard_form(hJ,{$:2,$0:new cO({$:1,$0:hX}),$1:new cO({$:1,$0:hY}),$2:hZ,$3:cN.collate(h4[0],bX.append(h1,h4[1]),bY.Empty)});},h3);}function hW(hX,hY,hZ,h0,h1){var h2,h3;h2=bX.map(function(h4){return eo.standard_form(hJ,h4);},h0);h3=eo.fast_reactions(hI,hJ,h2);return h3.$==0?bX.ofArray([cZ.standard_form(hJ,{$:2,$0:new cO({$:1,$0:hX}),$1:new cO({$:1,$0:hY}),$2:hZ,$3:cN.collate(h2,h1,bY.Empty)})]):bX.map(function(h4){return cZ.standard_form(hJ,{$:2,$0:new cO({$:1,$0:hX}),$1:new cO({$:1,$0:hY}),$2:hZ,$3:cN.collate(h4[0],bX.append(h1,h4[1]),bY.Empty)});},h3);}return bR.getLeaks(hJ)?bX.append(dZ.collect((hN=bR.getRules(hJ),hN=="Finite"?function(hX){return hQ(hX[0],hX[1],hX[2],hX[3],hX[4]);}:hN=="Default"?function(hX){return hR(hX[0],hX[1],hX[2],hX[3],hX[4]);}:hN=="Infinite"?function(hX){return hS(hX[0],hX[1],hX[2],hX[3],hX[4]);}:function(hX){return hP(hX[0],hX[1],hX[2],hX[3],hX[4]);}),dZ.collect(function(hX){return eo.leak_strand_into_gate(hJ,hX,hK);},hM)),bR.getPolymers(hJ)?dZ.collect((hO=bR.getRules(hJ),hO=="Finite"?function(hX){return hU(hX[0],hX[1],hX[2],hX[3],hX[4]);}:hO=="Default"?function(hX){return hV(hX[0],hX[1],hX[2],hX[3],hX[4]);}:hO=="Infinite"?function(hX){return hW(hX[0],hX[1],hX[2],hX[3],hX[4]);}:function(hX){return hT(hX[0],hX[1],hX[2],hX[3],hX[4]);}),dZ.collect(function(hX){return eo.leak_gate_into_gate(hJ,hK,hX);},new bY({$:1,$0:hK,$1:hL}))):bY.Empty):bY.Empty;};cZ.pin_reactions_new_gate=function(hI,hJ,hK){function hL(hM,hN,hO){var hP,hQ,hR,hS;hP=bR.getRules(hJ);return hP=="Finite"||(hP=="Default"?false:hP!="Infinite")?bX.ofArray([cZ.standard_form(hJ,{$:9,$0:new cO({$:1,$0:hM}),$1:hN,$2:bX.ofArray([new cO({$:1,$0:hO})])})]):(hR=eo.standard_form(hJ,hO),(hS=eo.fast_reactions(hI,hJ,bX.ofArray([hR])),hS.$==0?bX.ofArray([cZ.standard_form(hJ,{$:9,$0:new cO({$:1,$0:hM}),$1:hN,$2:bX.ofArray([new cO({$:1,$0:hR})])})]):bX.map(function(hT){return cZ.standard_form(hJ,{$:9,$0:new cO({$:1,$0:hM}),$1:hN,$2:cN.collate(hT[0],hT[1],bY.Empty)});},hS)));}return dZ.collect(function(hM){return hL(hM[0],hM[1],hM[2]);},eo.pin_gate(bR.getUnproductive(hJ),hK));};cZ.bind_reactions_new_gate=function(hI,hJ,hK,hL,hM){function hN(hP,hQ,hR,hS){var hT,hU,hV,hW;hT=bR.getRules(hJ);return hT=="Finite"||(hT=="Default"?false:hT!="Infinite")?bX.ofArray([cZ.standard_form(hJ,{$:1,$0:new cO({$:1,$0:hP}),$1:new cO({$:0,$0:hQ}),$2:hR,$3:bX.ofArray([new cO({$:1,$0:hS})])})]):(hV=eo.standard_form(hJ,hS),(hW=eo.fast_reactions(hI,hJ,bX.ofArray([hV])),hW.$==0?bX.ofArray([cZ.standard_form(hJ,{$:1,$0:new cO({$:1,$0:hP}),$1:new cO({$:0,$0:hQ}),$2:hR,$3:bX.ofArray([new cO({$:1,$0:hV})])})]):bX.map(function(hX){return cZ.standard_form(hJ,{$:1,$0:new cO({$:1,$0:hP}),$1:new cO({$:0,$0:hQ}),$2:hR,$3:cN.collate(hX[0],hX[1],bY.Empty)});},hW)));}function hO(hP,hQ,hR,hS){var hT,hU,hV,hW;return bR.getPolymers(hJ)?(hT=bR.getRules(hJ),hT=="Finite"||(hT=="Default"?false:hT!="Infinite")?bX.ofArray([cZ.standard_form(hJ,{$:1,$0:new cO({$:1,$0:hP}),$1:new cO({$:1,$0:hQ}),$2:hR,$3:bX.ofArray([new cO({$:1,$0:hS})])})]):(hV=eo.standard_form(hJ,hS),(hW=eo.fast_reactions(hI,hJ,bX.ofArray([hV])),hW.$==0?bX.ofArray([cZ.standard_form(hJ,{$:1,$0:new cO({$:1,$0:hP}),$1:new cO({$:1,$0:hQ}),$2:hR,$3:bX.ofArray([new cO({$:1,$0:hV})])})]):bX.map(function(hX){return cZ.standard_form(hJ,{$:1,$0:new cO({$:1,$0:hP}),$1:new cO({$:1,$0:hQ}),$2:hR,$3:cN.collate(hX[0],hX[1],bY.Empty)});},hW)))):fc.illegal_polymerisation_error(eo.display(hP),eo.display(hQ));}return bX.append(dZ.collect(function(hP){return hN(hP[0],hP[1],hP[2],hP[3]);},dZ.collect(function(hP){return eo.stick_strand_to_gate(hI,bR.getUnproductive(hJ),hP,hK);},hM)),dZ.collect(function(hP){return hO(hP[0],hP[1],hP[2],hP[3]);},dZ.collect(function(hP){return eo.stick_gate_to_gate(hI,hJ,hK,hP);},new bY({$:1,$0:hK,$1:hL}))));};cZ.unbind_open_reactions=function(hI,hJ,hK){var hL;function hM(hO,hP,hQ,hR){return cZ.standard_form(hJ,{$:8,$0:hO,$1:hP,$2:cN.collate(hQ,hR,bY.Empty)});}function hN(hO,hP,hQ,hR){var hS,hT;hS=bX.map(function(hU){return eo.standard_form(hJ,hU);},hQ);hT=eo.fast_reactions(hI,hJ,hS);return hT.$==0?bX.ofArray([cZ.standard_form(hJ,{$:8,$0:hO,$1:hP,$2:cN.collate(hS,hR,bY.Empty)})]):bX.map(function(hU){return cZ.standard_form(hJ,{$:0,$0:hO,$1:hP,$2:cN.collate(hU[0],hU[1],bY.Empty)});},hT);}hL=bR.getRules(hJ);return hL=="Detailed"?bX.map(function(hO){return hM(hO[0],hO[1],hO[2],hO[3]);},eo.unbind_open_reactions(hJ,hK)):hL=="Default"?dZ.collect(function(hO){return hN(hO[0],hO[1],hO[2],hO[3]);},eo.unbind_open_reactions(hJ,hK)):bY.Empty;};cZ.unbind_reactions=function(hI,hJ,hK){var hL,hO;function hM(hP,hQ,hR,hS){return cZ.standard_form(hJ,{$:0,$0:hP,$1:hQ,$2:cN.collate(hR,hS,bY.Empty)});}function hN(hP,hQ,hR,hS){var hT,hU;hT=bX.map(function(hV){return eo.standard_form(hJ,hV);},hR);hU=eo.fast_reactions(hI,hJ,hT);return hU.$==0?bX.ofArray([cZ.standard_form(hJ,{$:0,$0:hP,$1:hQ,$2:cN.collate(hT,hS,bY.Empty)})]):bX.map(function(hV){return cZ.standard_form(hJ,{$:0,$0:hP,$1:hQ,$2:cN.collate(hV[0],bX.append(hS,hV[1]),bY.Empty)});},hU);}hO=bR.getRules(hJ);switch(hO=="Default"?1:hO=="Infinite"?2:hO=="Finite"?2:0){case 0:return bX.map(function(hP){return hM(hP[0],hP[1],hP[2],hP[3]);},eo.unsticking_reactions(hI,hJ,hK));case 1:return dZ.collect(function(hP){return hN(hP[0],hP[1],hP[2],hP[3]);},eo.unsticking_reactions(hI,hJ,hK));case 2:return bY.Empty;}};cZ.rate=function(hI,hJ,hK,hL){var hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ;switch(hL.$==8?(hM=[hL.$1,hL.$2,hL.$0],0):hL.$==1?1:hL.$==9?2:hL.$==2?3:hL.$==3?4:hL.$==5?5:hL.$==4?(hM=[hL.$2,hL.$0,hL.$1],6):hL.$==7?(hM=[hL.$2,hL.$0,hL.$1],6):hL.$==6?7:hL.$==10?(hM=hL.$1,8):hL.$==11?(hM=hL.$2,8):hL.$==12?(hM=hL.$1,8):hL.$==13?(hM=hL.$2,8):hL.$==14?9:hL.$==15?10:hL.$==16?11:hL.$==17?12:(hM=[hL.$1,hL.$2,hL.$0],0)){case 0:hN=hM[0];return bR.getSequenceRates(hJ)?(hO=g6.energyExpression_minus(g6.getGateEnergy(hJ,hK,hM[2]),bX.reduce(g6.energyExpression_plus,bX.map(function(h0){return g6.getSpeciesEnergy(hJ,hK,h0);},hM[1]))),{$:0,$0:g6.unbindRateExpression(g6.tempCintoK(bR.getTemperature(hJ)),br.div(eg.bind_rate(hN),{$:1,$0:hC.pow(10,hI.units.concentration.$0)}),hO)}):{$:0,$0:eg.unbind_rate(hN)};case 1:hP=hL.$2;return bR.getSequenceRates(hJ)&&cw.Equals(bR.getRules(hJ),"Infinite")?(hQ=g6.getSpeciesEnergy(hJ,hK,hL.$0),hR=g6.getSpeciesEnergy(hJ,hK,hL.$1),hS=bX.reduce(g6.energyExpression_plus,bX.map(function(h0){return g6.getSpeciesEnergy(hJ,hK,h0);},hL.$3)),hT=g6.energyExpression_lmul(0,g6.energyExpression_minus(g6.energyExpression_plus(hQ,hR),hS)),{$:0,$0:g6.unbindRateExpression(g6.tempCintoK(bR.getTemperature(hJ)),eg.bind_rate(hP),hT)}):{$:0,$0:eg.bind_rate(hP)};case 2:return{$:0,$0:eg.bind_rate(hL.$1)};case 3:return{$:0,$0:hL.$2?bR.get_leak_rate_l(hJ):bR.get_leak_rate_w(hJ)};case 4:return{$:0,$0:bR.get_tau_rate(hJ)};case 5:return bR.getSequenceRates(hJ)?{$:0,$0:cZ.displacementRateSequence(hJ,hK,hL.$0,hL.$1,hL.$2)}:{$:0,$0:cZ.migrationRate(hJ,hL.$1)};case 6:return bR.getSequenceRates(hJ)?{$:0,$0:cZ.migrationRateSequence(hJ,hK,hM[1],hM[2],hM[0])}:{$:0,$0:cZ.migrationRate(hJ,hM[2])};case 7:hU=eg.length(bR.get_toehold_length(hJ),bR.get_specificity_length(hJ),hL.$1);return{$:0,$0:br.div(bR.get_elementary_migration_rate(hJ),{$:1,$0:hU*hU})};case 8:return cZ.rate(hI,hJ,ef.empty(),hM);case 9:hV=bR.get_pinleak_rate(hJ);return hV==null?(hW=bR.get_toehold_length(hJ),hX=bR.get_specificity_length(hJ),hY=10000/co.sumBy(function(h0){return eg.length(hW,hX,h0);},hL.$0),hZ=cZ.rate(hI,hJ,hK,hL.$1),hZ.$==1?{$:1,$0:{$:2,$0:bX.ofArray([{$:1,$0:hY},hZ.$0])}}:{$:0,$0:br.mul({$:1,$0:hY},hZ.$0)}):{$:0,$0:hV.$0};case 10:return{$:0,$0:{$:1,$0:1}};case 11:return{$:0,$0:{$:1,$0:1/hL.$2+1/hL.$3}};case 12:return hL.$0.ma_rate;}};cZ.map_mass_action_reaction=function(hI,hJ){return fd.New(Z.map(hI,hJ.ma_reactants),Z.map(hI,hJ.ma_products),Z.map(hI,hJ.ma_catalysts),cZ.map_crn_rate(hI,hJ.ma_rate),dZ.option_map2(function(hK){return cZ.map_crn_rate(hI,hK);},hJ.ma_reverseRate));};cZ.fix=function(hI,hJ,hK,hL,hM){var hN,hO,hP;function hQ(hV){var hW;hW=eo.rotate(hI,hV);return bX.contains(hW,hP)?hW:hV;}function hR(hV){var hW;hW=em.rotate(hV);return bX.contains(hW,hO)?hW:hV;}function hS(hV){return bX.sort(en.origami_map(hR,hQ,hV));}function hT(hV){return hV.$==1?new cO({$:1,$0:hQ(hV.$0)}):hV.$==2?new cO({$:2,$0:hS(hV.$0)}):hV.$==3?new cO({$:3,$0:hV.$0}):hV.$==4?be.FailWith("unexpected LogicDSD species"):new cO({$:0,$0:hR(hV.$0)});}function hU(hV){return bX.map(hT,hV);}hN=dZ.fold_left(function(hV,hW){return(function(hX){var hY,hZ;hY=hX[0];hZ=hX[1];return function(h0){var h1;h1=en.origami_species(h0);return[bX.append(h1[0],hY),bX.append(h1[1],hZ)];};}(hV))(hW);},[hJ,hK],hL);hO=hN[1];hP=hN[0];return hM.$==1?{$:1,$0:hT(hM.$0),$1:hT(hM.$1),$2:hM.$2,$3:hU(hM.$3)}:hM.$==2?{$:2,$0:hT(hM.$0),$1:hT(hM.$1),$2:hM.$2,$3:hU(hM.$3)}:hM.$==3?{$:3,$0:hQ(hM.$0),$1:hU(hM.$1)}:hM.$==4?{$:4,$0:hQ(hM.$0),$1:hM.$1,$2:hQ(hM.$2)}:hM.$==5?{$:5,$0:hQ(hM.$0),$1:hM.$1,$2:hU(hM.$2)}:hM.$==6?{$:6,$0:hQ(hM.$0),$1:hM.$1,$2:hQ(hM.$2)}:hM.$==7?{$:7,$0:hQ(hM.$0),$1:hM.$1,$2:hQ(hM.$2)}:hM.$==8?{$:8,$0:hQ(hM.$0),$1:hM.$1,$2:hU(hM.$2)}:hM.$==9?{$:9,$0:hT(hM.$0),$1:hM.$1,$2:hU(hM.$2)}:hM.$==10?{$:10,$0:hS(hM.$0),$1:cZ.fix(hI,hP,hO,hL,hM.$1),$2:hS(hM.$2)}:hM.$==11?{$:11,$0:hS(hM.$0),$1:hT(hM.$1),$2:cZ.fix(hI,hP,hO,hL,hM.$2),$3:hS(hM.$3)}:hM.$==12?{$:12,$0:hS(hM.$0),$1:cZ.fix(hI,hP,hO,hL,hM.$1),$2:hU(hM.$2)}:hM.$==13?{$:13,$0:hS(hM.$0),$1:hT(hM.$1),$2:cZ.fix(hI,hP,hO,hL,hM.$2),$3:hU(hM.$3)}:hM.$==14?{$:14,$0:hM.$0,$1:cZ.fix(hI,hP,hO,hL,hM.$1)}:hM.$==15?{$:15,$0:hT(hM.$0),$1:hM.$1,$2:hT(hM.$2)}:hM.$==16?{$:16,$0:hT(hM.$0),$1:hM.$1,$2:hM.$2,$3:hM.$3,$4:hU(hM.$4)}:hM.$==17?{$:17,$0:cZ.map_mass_action_reaction(hT,hM.$0)}:{$:0,$0:hQ(hM.$0),$1:hM.$1,$2:hU(hM.$2)};};cZ.species=function(hI){return bX.append(cZ.reactants(hI),cZ.products(hI));};cZ.standard_form=function(hI,hJ){function hK(hO){return eo.standard_form(hI,hO);}function hL(hO){return en.standard_form(hI,hO);}function hM(hO){return cN.standard_form(hI,hO);}function hN(hO){return bX.map(hM,hO);}return hJ.$==1?{$:1,$0:hM(hJ.$0),$1:hM(hJ.$1),$2:hJ.$2,$3:hN(hJ.$3)}:hJ.$==2?{$:2,$0:hM(hJ.$0),$1:hM(hJ.$1),$2:hJ.$2,$3:hN(hJ.$3)}:hJ.$==3?{$:3,$0:hK(hJ.$0),$1:hN(hJ.$1)}:hJ.$==5?{$:5,$0:hK(hJ.$0),$1:hJ.$1,$2:hN(hJ.$2)}:hJ.$==4?{$:4,$0:hK(hJ.$0),$1:hJ.$1,$2:hK(hJ.$2)}:hJ.$==6?{$:6,$0:hK(hJ.$0),$1:hJ.$1,$2:hK(hJ.$2)}:hJ.$==7?{$:7,$0:hK(hJ.$0),$1:hJ.$1,$2:hK(hJ.$2)}:hJ.$==8?{$:8,$0:hK(hJ.$0),$1:hJ.$1,$2:hN(hJ.$2)}:hJ.$==9?{$:9,$0:hM(hJ.$0),$1:hJ.$1,$2:hN(hJ.$2)}:hJ.$==10?{$:10,$0:hL(hJ.$0),$1:cZ.standard_form(hI,hJ.$1),$2:hL(hJ.$2)}:hJ.$==11?{$:11,$0:hL(hJ.$0),$1:hM(hJ.$1),$2:cZ.standard_form(hI,hJ.$2),$3:hL(hJ.$3)}:hJ.$==12?{$:12,$0:hL(hJ.$0),$1:cZ.standard_form(hI,hJ.$1),$2:hN(hJ.$2)}:hJ.$==13?{$:13,$0:hL(hJ.$0),$1:hM(hJ.$1),$2:cZ.standard_form(hI,hJ.$2),$3:hN(hJ.$3)}:hJ.$==14?{$:14,$0:hJ.$0,$1:cZ.standard_form(hI,hJ.$1)}:hJ.$==15?{$:15,$0:hM(hJ.$0),$1:hJ.$1,$2:hM(hJ.$2)}:hJ.$==16?{$:16,$0:hM(hJ.$0),$1:hJ.$1,$2:hJ.$2,$3:hJ.$3,$4:hN(hJ.$4)}:hJ.$==17?{$:17,$0:cZ.map_mass_action_reaction(hM,hJ.$0)}:{$:0,$0:hK(hJ.$0),$1:hJ.$1,$2:hN(hJ.$2)};};cZ.matching_reactions=function(hI,hJ,hK){var hL;switch(hJ.$==3?hK.$==3?0:4:hJ.$==4?hK.$==4?0:4:hJ.$==5?hK.$==5?0:4:hJ.$==6?hK.$==6?0:4:hJ.$==7?hK.$==7?0:4:hJ.$==8?hK.$==8?0:4:hJ.$==1?hK.$==1?0:4:hJ.$==2?hK.$==2?0:4:hJ.$==9?hK.$==9?0:4:hJ.$==17?hK.$==17?0:4:hJ.$==10?hK.$==10?(hL=[hJ.$1,hK.$1],1):4:hJ.$==12?hK.$==12?(hL=[hJ.$1,hK.$1],1):4:hJ.$==11?hK.$==11?(hL=[hJ.$2,hK.$2],1):4:hJ.$==13?hK.$==13?(hL=[hJ.$2,hK.$2],1):4:hJ.$==15?hK.$==15?(hL=[hJ.$1,hK.$1],2):4:hJ.$==16?hK.$==16?(hL=[hJ.$1,hK.$1],2):4:hJ.$==14?hK.$==14?(hL=[hJ.$0,hK.$0,hJ.$1,hK.$1],3):4:hK.$==0?0:4){case 0:return cZ.matching_species(hI,hJ,hK);case 1:return cZ.matching_reactions(hI,hL[0],hL[1]);case 2:return cw.Equals(hL[0],hL[1])&&cZ.matching_species(hI,hJ,hK);case 3:return cw.Equals(hL[0],hL[1])&&cZ.matching_species(hI,hL[2],hL[3]);case 4:return false;}};cZ.nick_gate=function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0,h1;hL=bY.Empty;hM=bY.Empty;hN=bY.Empty;hO=hK;while(true)if(hO.$==1){if(hO.$0.$==1){if(hO.$0.$0.$==0){hP=hO.$0.$0.$0[0];hQ=hO.$0.$0.$0[1];hR=hO.$0.$0.$0[3];hS=hO.$0.$0.$0[4];hT=hO.$0.$1;hU=hO.$1;hV=hO.$0.$0.$0[2];hW=cZ.find_nicks(hI,hJ,hV);hX=function(h2,h3,h4,h5,h6,h7,h8,h9){return function(h_){var h$,ia;h$=h_[0];ia=h_[1];return h_[2]?bX.append(bX.rev(h2),bX.append(bX.ofArray([bX.append(bX.rev(h3),new bY({$:1,$0:new ej({$:0,$0:[h4,h5,h$,bY.Empty,bY.Empty]}),$1:new bY({$:1,$0:new ej({$:0,$0:[bY.Empty,bY.Empty,ia,h6,h7]}),$1:h8})}))]),h9)):bX.append(bX.rev(new bY({$:1,$0:new bY({$:1,$0:new ej({$:0,$0:[h4,h5,h$,bY.Empty,bY.Empty]}),$1:bX.rev(h3)}),$1:h2})),new bY({$:1,$0:new bY({$:1,$0:new ej({$:0,$0:[bY.Empty,bY.Empty,ia,h6,h7]}),$1:h8}),$1:h9}));};}(hM,hN,hP,hQ,hR,hS,hT,hU);hL=bX.append(bX.map(hX,hW),hL);hN=new bY({$:1,$0:new ej({$:0,$0:[hP,hQ,hV,hR,hS]}),$1:hN});hO=new bY({$:1,$0:hT,$1:hU});}else{hY=hO.$0.$0;hZ=hO.$0.$1;h0=hO.$1;hN=new bY({$:1,$0:hY,$1:hN});hO=new bY({$:1,$0:hZ,$1:h0});}}else{h1=hO.$1;hM=new bY({$:1,$0:hN,$1:hM});hN=bY.Empty;hO=h1;}}else return hL;};cZ.displacementRateSequence=function(hI,hJ,hK,hL,hM){return cZ.migrationSequenceRate(hI,g6.getGateEnergy(hI,hJ,hK),hL,bX.reduce(g6.energyExpression_plus,bX.map(function(hN){return g6.getSpeciesEnergy(hI,hJ,hN);},hM)));};cZ.migrationRate=function(hI,hJ){var hK;hK=cZ.domainLength(hI,hJ);return br.div(bR.get_elementary_migration_rate(hI),{$:1,$0:hK*hK});};cZ.migrationRateSequence=function(hI,hJ,hK,hL,hM){return cZ.migrationSequenceRate(hI,g6.getGateEnergy(hI,hJ,hK),hL,g6.getGateEnergy(hI,hJ,hM));};cZ.map_crn_rate=function(hI,hJ){return hJ.$==1?{$:1,$0:br.map(function(hK){return bq.map(hI,hK);},hJ.$0)}:{$:0,$0:hJ.$0};};cZ.find_nicks=function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ,hR,hS;hL=bY.Empty;hM=bY.Empty;hN=hK;while(true)if(hN.$==1){if(hN.$1.$==1){hO=hN.$0;hP=hN.$1.$0;hQ=hN.$1.$1;hR=cw.Equals(hO,hI)&&cw.Equals(hP,hJ)?bX.ofArray([[bX.rev(new bY({$:1,$0:hO,$1:hM})),new bY({$:1,$0:hP,$1:hQ}),true]]):bY.Empty;hS=eg.are_complements(hO,hJ)&&eg.are_complements(hP,hI)?bX.ofArray([[bX.rev(new bY({$:1,$0:hO,$1:hM})),new bY({$:1,$0:hP,$1:hQ}),true]]):bY.Empty;hL=bX.append(hR,bX.append(hS,hL));hM=new bY({$:1,$0:hO,$1:hM});hN=new bY({$:1,$0:hP,$1:hQ});}else return hL;}else return hL;};cZ.migrationSequenceRate=function(hI,hJ,hK,hL){var hM;hM=g6.energyExpression_lmul(0.5,g6.energyExpression_minus(hJ,hL));return g6.unbindRateExpression(g6.tempCintoK(bR.getTemperature(hI)),cZ.baseMigrationRateSequence(hI,hK),hM);};cZ.domainLength=function(hI,hJ){var hK,hL;hK=bR.get_toehold_length(hI);hL=bR.get_specificity_length(hI);return dZ.fold_left(function(hM,hN){return hM+eg.length(hK,hL,hN);},0,hJ);};cZ.baseMigrationRateSequence=function(hI,hJ){var hK;hK=cZ.domainLength(hI,hJ);return br.mul(bR.get_elementary_migration_rate(hI),{$:1,$0:cZ.scaleFunction(20)/cZ.scaleFunction(hK)});};cZ.scaleFunction=function(hI){return 30*hI+(hI-1)*hI;};b5.engine=function(){et.$cctor();return et.engine;};b5.toDsdComplexes=function(hI){var hJ,hK,hN,hO,hP,hQ,hR;hJ=bY.Empty;hK=bX.map(function(hS){return hM(hS[0],hS[1]);},bX.ofSeq(bW.ToSeq(hI.$0)));function hL(hS,hT,hU){var hW,hX,hY,hZ;function hV(h0,h1){return[h0,h1];}while(true){hW=(function(h0){return function(h1){return bX.partition(h0,h1);};}(function(h0){return function(h1){var h2;return!(h2=h1[0],c5.Filter(function(h3){return h2.Contains(h3);},h0)).get_IsEmpty();};}(hT)))(hU);hX=hW[0];if(hX.$==0)return[{$:0,$0:bW.OfArray(ck.ofSeq((function(h0){return function(h1){return bX.mapi(function(h2,h3){return(h0(h2))(h3);},h1);};}(function(h0){return function(h1){return hV(h0,h1);};}))(hS)))},hU];else{hY=bX.append(hS,(function(h0){return function(h1){return bX.map(h0,h1);};}(function(h0){return h0[1];}))(hX));hZ=new cK.New$1(c6.OfSeq(co.concat(new bY({$:1,$0:hT,$1:(function(h0){return function(h1){return bX.map(h0,h1);};}(function(h0){return h0[0];}))(hX)}))));hS=hY;hT=hZ;hU=hW[1];}}}function hM(hS,hT){return[new cK.New$1(c6.OfSeq(co.concat(bX.map(cf.GetBonds,hT)))),hT];}while(true)if(hK.$==1){hN=hK.$0[1];hO=hK.$1;hP=hK.$0[0];hQ=hL(bX.ofArray([hN]),hP,hO);hR=new bY({$:1,$0:hQ[0],$1:hJ});hJ=hR;hK=hQ[1];}else return hJ;};b5.logicDsdComposeProcesses=function(hI,hJ,hK){var hL,hM;hL=hI?(hM=b$.Fold(function(hN,hO){return hO.$==0?hO.$0.$==1?hO.$0.$1.$==0?hN<=hO.$0.$1.$0?hN+1:hN:hN:hN:hN;},0,hJ),b$.Map(function(hN){return hN.$==0?hN.$0.$==1?hN.$0.$1.$==0?new cf({$:0,$0:new ce({$:1,$0:hN.$0.$0,$1:new b6({$:0,$0:hM+hN.$0.$1.$0})})}):hN:hN:hN;},hK)):hK;return b$.OfList(bX.append(b$.ToList(hJ),b$.ToList(hL)));};b5.fvSiteT=function(hI){var hJ,hK;return hI.$==1?(hJ=hI.$0,cw.Equals(hJ,[-1,"_"])?new cK.New$1(null):(hK=new fm({$:2,$0:hJ,$1:hI}),(new cK.New$1(null)).Add(hK))):hI.$0.$==0?b5.fvDomain(hI.$0.$0):new cK.New$1(c6.OfSeq(co.append(b5.fvDomain(hI.$0.$0),b5.fvBond(hI.$0.$1))));};b5.dsdRefresh=function(hI){var hJ;hJ=b5.engine();return function(hK){return b5.refreshSiteT(hJ,hI,hK);};};b5.dsdResolveGoal=function(hI,hJ){var hK;hK=b5.engine();return function(hL){return b5.resolveDsdGoal(hK,hI,hJ,hL);};};b5.dsdDisambiguateVars=function(hI){return b5.disambiguateVars(b5.engine(),hI);};b5.dsdApplySubVar=function(hI){var hJ;hJ=b5.engine();return function(hK){return b5.dsdSubApply2(hJ,hI,hK);};};b5.dsdCompose=function(hI){return function(hJ){return b5.composer(hI,hJ);};};b5.dsdApplySub=function(hI){var hJ;hJ=b5.engine();return function(hK){return b5.dsdSubApply(hJ,hI,hK);};};b5.dsdUnify=function(hI,hJ){return b5.unifySite(b5.engine(),hI,hJ);};b5.dsdToCanonicalFormProcess=function(hI){return b5.dsdCanonicalForm(b5.engine(),hI);};b5.dsdCanonicalSite=function(hI){return cf.Canonical(b5.engine(),hI);};b5.dsdCompare=function(hI){var hJ;hJ=b5.engine();return function(hK){return cf.Compare(hJ,cw.Compare,hI,hK);};};b5.printer=function(hI){return hI.$==1?b6.ToString(hI.$0):cd.ToString(hI.$0);};b5.psite=function(hI,hJ,hK){var hL,hM;function hN(hO,hP){var hQ,hR,hS;return(cR.choice([cR.braces((hQ=cR.choice([cR.op_BarGreaterGreater((hR=b5.psite(hI,hJ,hK),(hS=b5.engine().domainKeywords,function(hT){return f4.pterm(hR,hI,hJ,hS,hT[0],hT[1]);})),function(hT){return{$:2,$0:hT};}),cR.preturn(cb.NoTag)]),function(hT){return hQ([hT[0],hT[1]]);})),cR.preturn(hK?cb.NoTag:cb.AnyTag)]))([hO,hP]);}return cR.op_BarGreaterGreater(cR.op_DotGreaterGreaterDot(cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(cR.plookAhead(cR.op_GreaterGreaterDot(f4.pname(),(hL=cR.choice([cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(cR.kw("("),cR.failParser("")),function(){return be.FailWith("asdasdasd");}),cR.preturn()]),function(hO){return hL([hO[0],hO[1]]);}))),f4.pname()),function(hO){var hP,hQ,hR;return hO==="_"||fw.IsUpper(hO[0])?(hP=hO==="_"?[-1,"_"]:hJ(hO),cR.op_BarGreaterGreater(function(hS){return hN(hS[0],hS[1]);},function(hS){return new cd({$:1,$0:hP,$1:hS});})):(hQ=cR.choice([cR.op_GreaterGreaterDot(cR.kw("^"),(hR=cR.choice([cR.op_BarGreaterGreater(cR.op_GreaterGreaterDot(cR.kw("*"),function(hS){return hN(hS[0],hS[1]);}),function(hS){return new cd({$:0,$0:cc.Create$1(hO,true,true,hS)});}),cR.op_BarGreaterGreater(function(hS){return hN(hS[0],hS[1]);},function(hS){return new cd({$:0,$0:cc.Create$1(hO,false,true,hS)});})]),function(hS){return hR([hS[0],hS[1]]);})),cR.op_BarGreaterGreater(cR.op_GreaterGreaterDot(cR.kw("*"),function(hS){return hN(hS[0],hS[1]);}),function(hS){return new cd({$:0,$0:cc.Create$1(hO,true,false,hS)});}),cR.op_BarGreaterGreater(function(hS){return hN(hS[0],hS[1]);},function(hS){return new cd({$:0,$0:cc.Create$1(hO,false,false,hS)});})]),function(hS){return hQ([hS[0],hS[1]]);});}),(hM=cR.choice([cR.op_BarGreaterGreater(cR.op_GreaterGreaterDot(cR.kw("!"),b5.pbond(hJ)),function(hO){return{$:1,$0:hO};}),cR.preturn(null)]),function(hO){return hM([hO[0],hO[1]]);})),function(hO){var hP,hQ,hR;hP=hO[0];hQ=hO[1];return hQ!=null&&hQ.$==1?new cf({$:0,$0:new ce({$:1,$0:hP,$1:hQ.$0})}):(hR=new cf({$:0,$0:new ce({$:0,$0:hP})}),hP.$==1?hP.$1.$===1?new cf({$:1,$0:hP.$0}):hR:hR);});};b5.to_concrete_process=function(hI){function hJ(hK){return hK[1];}return bX.map(function(hK){return b5.to_concrete_strand(hJ(hK));},bX.ofSeq(bW.ToSeq(hI.$0)));};b5.fvDomain=function(hI){var hJ,hK,hL,hM,hN;return hI.$==1?(hJ=hI.$0,(hK=hI.$1,new cK.New$1(c6.OfSeq(co.append(hK.$==1||hK.$!=2?new cK.New$1(null):c3.fvt((hM=ew.get_empty(),ew.New(hM.toString,hM.toStringTempVar,hM.compare,hM.cast,hM.toCanonicalForm,hM.toCanonicalFormProcess,hM.unify,hM.underscore,hM.applyAll,hM.applySub,hM.applySubVar,b5.fvSiteT,hM.refresh,hM.disambiguateVars,hM.ComposeProcesses,hM.resolveGoal,hM.domainKeywords)),hK.$0),cw.Equals(hJ,[-1,"_"])?new cK.New$1(null):(hN=new fm({$:3,$0:hJ,$1:{$:0,$0:hI}}),(new cK.New$1(null)).Add(hN))))))):new cK.New$1(null);};b5.fvBond=function(hI){var hJ,hK;switch(hI.$==1?hI.$0[0]===-1?hI.$0[1]==="_"?1:(hJ=hI.$0,2):(hJ=hI.$0,2):0){case 0:return new cK.New$1(null);case 1:return new cK.New$1(null);case 2:hK=new fm({$:3,$0:hJ,$1:{$:1,$0:hI}});return(new cK.New$1(null)).Add(hK);}};b5.refreshSiteT=function(hI,hJ,hK){var hL;switch(hK.$==1?hK.$0[0]===-1?hK.$0[1]==="_"?1:(hL=hK.$0[1],2):(hL=hK.$0[1],2):(hL=hK.$0,0)){case 0:return new cf({$:0,$0:b5.refreshSite(hI,hJ,hL)});case 1:return new cf({$:1,$0:[-1,"_"]});case 2:return new cf({$:1,$0:[hJ(hL),hL]});}};b5.resolveDsdGoal=function(hI,hJ,hK,hL){var hM,hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,h2,h3,h4,h5,h6,h7,h8,h9,h_,h$,ia,ib,ic,id;function hN(ie){return ie.$0;}function hO(ie,_if,ig){return ig.$==0?null:{$:1,$0:co.fold(function(ih,ii){var ij;ij=c4.Update(_if,ii,ie);return new bY({$:1,$0:[hN(ii),hN(ij)],$1:ih});},bY.Empty,ig)};}hP=new cg({$:0,$0:hJ,$1:hK});function hZ(ie){return ie[1];}function h0(ie){return{$:9,$0:new b_({$:1,$0:bX.ofArray([[ie,{$:1,$0:[-1,"_"]}]])})};}function h1(ie){return{$:4,$0:ie};}switch(hP.$0==="toComplexes"?hP.$1.$==1?hP.$1.$0.$==8?hP.$1.$1.$==1?hP.$1.$1.$1.$==0?(hM=[hP.$1.$1.$0,hP.$1.$0.$0],0):12:12:12:12:hP.$0==="fromComplexes"?hP.$1.$==1?hP.$1.$1.$==1?hP.$1.$1.$1.$==0?(hM=[hP.$1.$1.$0,hP.$1.$0],1):12:12:12:hP.$0==="toList"?hP.$1.$==1?hP.$1.$0.$==8?hP.$1.$1.$==1?hP.$1.$1.$1.$==0?(hM=[hP.$1.$1.$0,hP.$1.$0.$0.$0],2):12:12:12:12:hP.$0==="toDomains"?hP.$1.$==1?hP.$1.$0.$==8?hP.$1.$1.$==1?hP.$1.$1.$1.$==0?(hM=[hP.$1.$1.$0,hP.$1.$0.$0.$0],3):12:12:12:12:hP.$0==="toSites"?hP.$1.$==1?hP.$1.$0.$==8?hP.$1.$1.$==1?hP.$1.$1.$1.$==0?(hM=[hP.$1.$1.$0,hP.$1.$0.$0.$0],4):12:12:12:12:hP.$0==="compl"?hP.$1.$==1?hP.$1.$0.$==9?hP.$1.$0.$0.$==1?hP.$1.$0.$0.$0.$==1?hP.$1.$0.$0.$0.$0[0].$==0?hP.$1.$0.$0.$0.$0[0].$0.$==0?hP.$1.$0.$0.$0.$0[0].$0.$0.$==0?hP.$1.$0.$0.$0.$1.$==0?hP.$1.$1.$==1?hP.$1.$1.$0.$==9?hP.$1.$1.$0.$0.$==1?hP.$1.$1.$0.$0.$0.$==1?hP.$1.$1.$0.$0.$0.$0[0].$==0?hP.$1.$1.$0.$0.$0.$0[0].$0.$==0?hP.$1.$1.$0.$0.$0.$0[0].$0.$0.$==0?hP.$1.$1.$0.$0.$0.$1.$==0?hP.$1.$1.$1.$==0?(hM=[hP.$1.$0.$0.$0.$0[0].$0.$0.$0,hP.$1.$1.$0.$0.$0.$0[0].$0.$0.$0],5):12:hP.$1.$1.$1.$==0?(hM=[hP.$1.$0.$0.$0.$0[0].$0.$0.$0,hP.$1.$1.$0,hP.$1.$0.$0.$0.$0[1]],6):12:hP.$1.$1.$1.$==0?(hM=[hP.$1.$0.$0.$0.$0[0].$0.$0.$0,hP.$1.$1.$0,hP.$1.$0.$0.$0.$0[1]],6):12:hP.$1.$1.$1.$==0?(hM=[hP.$1.$0.$0.$0.$0[0].$0.$0.$0,hP.$1.$1.$0,hP.$1.$0.$0.$0.$0[1]],6):12:hP.$1.$1.$1.$==0?(hM=[hP.$1.$0.$0.$0.$0[0].$0.$0.$0,hP.$1.$1.$0,hP.$1.$0.$0.$0.$0[1]],6):12:hP.$1.$1.$1.$==0?(hM=[hP.$1.$0.$0.$0.$0[0].$0.$0.$0,hP.$1.$1.$0,hP.$1.$0.$0.$0.$0[1]],6):12:hP.$1.$1.$1.$==0?(hM=[hP.$1.$0.$0.$0.$0[0].$0.$0.$0,hP.$1.$1.$0,hP.$1.$0.$0.$0.$0[1]],6):12:hP.$1.$1.$1.$==0?(hM=[hP.$1.$0.$0.$0.$0[0].$0.$0.$0,hP.$1.$1.$0,hP.$1.$0.$0.$0.$0[1]],6):12:12:hP.$1.$1.$==1?hP.$1.$1.$0.$==9?hP.$1.$1.$0.$0.$==1?hP.$1.$1.$0.$0.$0.$==1?hP.$1.$1.$0.$0.$0.$0[0].$==0?hP.$1.$1.$0.$0.$0.$0[0].$0.$==0?hP.$1.$1.$0.$0.$0.$0[0].$0.$0.$==0?hP.$1.$1.$0.$0.$0.$1.$==0?hP.$1.$1.$1.$==0?(hM=[hP.$1.$1.$0.$0.$0.$0[0].$0.$0.$0,hP.$1.$0,hP.$1.$1.$0.$0.$0.$0[1]],6):12:12:12:12:12:12:12:12:12:hP.$1.$1.$==1?hP.$1.$1.$0.$==9?hP.$1.$1.$0.$0.$==1?hP.$1.$1.$0.$0.$0.$==1?hP.$1.$1.$0.$0.$0.$0[0].$==0?hP.$1.$1.$0.$0.$0.$0[0].$0.$==0?hP.$1.$1.$0.$0.$0.$0[0].$0.$0.$==0?hP.$1.$1.$0.$0.$0.$1.$==0?hP.$1.$1.$1.$==0?(hM=[hP.$1.$1.$0.$0.$0.$0[0].$0.$0.$0,hP.$1.$0,hP.$1.$1.$0.$0.$0.$0[1]],6):12:12:12:12:12:12:12:12:12:hP.$1.$1.$==1?hP.$1.$1.$0.$==9?hP.$1.$1.$0.$0.$==1?hP.$1.$1.$0.$0.$0.$==1?hP.$1.$1.$0.$0.$0.$0[0].$==0?hP.$1.$1.$0.$0.$0.$0[0].$0.$==0?hP.$1.$1.$0.$0.$0.$0[0].$0.$0.$==0?hP.$1.$1.$0.$0.$0.$1.$==0?hP.$1.$1.$1.$==0?(hM=[hP.$1.$1.$0.$0.$0.$0[0].$0.$0.$0,hP.$1.$0,hP.$1.$1.$0.$0.$0.$0[1]],6):12:12:12:12:12:12:12:12:12:hP.$1.$1.$==1?hP.$1.$1.$0.$==9?hP.$1.$1.$0.$0.$==1?hP.$1.$1.$0.$0.$0.$==1?hP.$1.$1.$0.$0.$0.$0[0].$==0?hP.$1.$1.$0.$0.$0.$0[0].$0.$==0?hP.$1.$1.$0.$0.$0.$0[0].$0.$0.$==0?hP.$1.$1.$0.$0.$0.$1.$==0?hP.$1.$1.$1.$==0?(hM=[hP.$1.$1.$0.$0.$0.$0[0].$0.$0.$0,hP.$1.$0,hP.$1.$1.$0.$0.$0.$0[1]],6):12:12:12:12:12:12:12:12:12:hP.$1.$1.$==1?hP.$1.$1.$0.$==9?hP.$1.$1.$0.$0.$==1?hP.$1.$1.$0.$0.$0.$==1?hP.$1.$1.$0.$0.$0.$0[0].$==0?hP.$1.$1.$0.$0.$0.$0[0].$0.$==0?hP.$1.$1.$0.$0.$0.$0[0].$0.$0.$==0?hP.$1.$1.$0.$0.$0.$1.$==0?hP.$1.$1.$1.$==0?(hM=[hP.$1.$1.$0.$0.$0.$0[0].$0.$0.$0,hP.$1.$0,hP.$1.$1.$0.$0.$0.$0[1]],6):12:12:12:12:12:12:12:12:12:hP.$1.$1.$==1?hP.$1.$1.$0.$==9?hP.$1.$1.$0.$0.$==1?hP.$1.$1.$0.$0.$0.$==1?hP.$1.$1.$0.$0.$0.$0[0].$==0?hP.$1.$1.$0.$0.$0.$0[0].$0.$==0?hP.$1.$1.$0.$0.$0.$0[0].$0.$0.$==0?hP.$1.$1.$0.$0.$0.$1.$==0?hP.$1.$1.$1.$==0?(hM=[hP.$1.$1.$0.$0.$0.$0[0].$0.$0.$0,hP.$1.$0,hP.$1.$1.$0.$0.$0.$0[1]],6):12:12:12:12:12:12:12:12:12:hP.$1.$1.$==1?hP.$1.$1.$0.$==9?hP.$1.$1.$0.$0.$==1?hP.$1.$1.$0.$0.$0.$==1?hP.$1.$1.$0.$0.$0.$0[0].$==0?hP.$1.$1.$0.$0.$0.$0[0].$0.$==0?hP.$1.$1.$0.$0.$0.$0[0].$0.$0.$==0?hP.$1.$1.$0.$0.$0.$1.$==0?hP.$1.$1.$1.$==0?(hM=[hP.$1.$1.$0.$0.$0.$0[0].$0.$0.$0,hP.$1.$0,hP.$1.$1.$0.$0.$0.$0[1]],6):12:12:12:12:12:12:12:12:12:12:hP.$0==="freshBond"?hP.$1.$==1?hP.$1.$1.$==1?hP.$1.$1.$0.$==4?hP.$1.$1.$1.$==0?(hM=[hP.$1.$0,hP.$1.$1.$0.$0],7):12:hP.$1.$1.$0.$==8?hP.$1.$1.$1.$==0?hP.$1.$0.$==0?(hM=[hP.$1.$0.$0,hP.$1.$1.$0.$0,hP.$1.$0.$1],8):hP.$1.$0.$==9?hP.$1.$0.$0.$==1?hP.$1.$0.$0.$0.$==1?hP.$1.$0.$0.$0.$0[0].$==0?hP.$1.$0.$0.$0.$0[0].$0.$==1?hP.$1.$0.$0.$0.$0[0].$0.$1.$==1?hP.$1.$0.$0.$0.$1.$==0?(hM=[hP.$1.$0.$0.$0.$0[0].$0.$1.$0[0],hP.$1.$1.$0.$0,hP.$1.$0.$0.$0.$0[0].$0.$1.$0[1]],8):12:12:12:12:12:12:12:12:12:12:12:hP.$0==="complementary"?hP.$1.$==1?hP.$1.$0.$==9?hP.$1.$0.$0.$==1?hP.$1.$0.$0.$0.$==1?hP.$1.$0.$0.$0.$0[0].$==0?hP.$1.$0.$0.$0.$0[0].$0.$==1?hP.$1.$0.$0.$0.$0[0].$0.$0.$==0?hP.$1.$0.$0.$0.$1.$==0?hP.$1.$1.$==0?(hM=hP.$1.$0.$0.$0.$0[0].$0.$0.$0,9):12:12:12:hP.$1.$0.$0.$0.$0[0].$0.$0.$==0?hP.$1.$0.$0.$0.$1.$==0?hP.$1.$1.$==0?(hM=hP.$1.$0.$0.$0.$0[0].$0.$0.$0,9):12:12:12:12:12:12:12:12:hP.$0==="toehold"?hP.$1.$==1?hP.$1.$0.$==9?hP.$1.$0.$0.$==1?hP.$1.$0.$0.$0.$==1?hP.$1.$0.$0.$0.$0[0].$==0?hP.$1.$0.$0.$0.$0[0].$0.$==1?hP.$1.$0.$0.$0.$0[0].$0.$0.$==0?hP.$1.$0.$0.$0.$1.$==0?hP.$1.$1.$==0?(hM=hP.$1.$0.$0.$0.$0[0].$0.$0.$0,10):12:12:12:hP.$1.$0.$0.$0.$0[0].$0.$0.$==0?hP.$1.$0.$0.$0.$1.$==0?hP.$1.$1.$==0?(hM=hP.$1.$0.$0.$0.$0[0].$0.$0.$0,10):12:12:12:12:12:12:12:12:hP.$0==="unbound"?hP.$1.$==1?hP.$1.$0.$==9?hP.$1.$0.$0.$==1?hP.$1.$0.$0.$0.$==1?hP.$1.$0.$0.$0.$0[0].$==0?hP.$1.$0.$0.$0.$0[0].$0.$==0?hP.$1.$0.$0.$0.$0[0].$0.$0.$==0?hP.$1.$0.$0.$0.$1.$==0?hP.$1.$1.$==0?11:12:12:12:12:12:12:12:12:12:12){case 0:hQ={$:4,$0:bX.map(function(ie){return{$:8,$0:ie};},b5.toDsdComplexes(hM[1]))};hR=(cV.unify(hI))(bX.ofArray([new cW({$:0,$0:hQ,$1:hM[0]})]));return hO(hI,new c4({$:0,$0:hL}),hR);case 1:hS=ca.FlattenList(hM[1]);return hS.$==1?null:(hT=co.fold(function(ie,_if){return ie!=null&&ie.$==1?_if.$==8?{$:1,$0:(hI.ComposeProcesses(ie.$0))(_if.$0)}:null:null;},{$:1,$0:b$.OfList(bY.Empty)},hS.$0),hT!=null&&hT.$==1?(hU=(cV.unify(hI))(bX.ofArray([new cW({$:0,$0:{$:8,$0:hT.$0},$1:hM[0]})])),hO(hI,new c4({$:0,$0:hL}),hU)):null);case 2:hV=bX.map((hW=(hX=function(ie){return bX.map(h0,ie);},function(ie){return hX(hZ(ie));}),function(ie){return h1(hW(ie));}),bX.ofSeq(bW.ToSeq(hM[1])));hY=(cV.unify(hI))(bX.ofArray([new cW({$:0,$0:hM[0],$1:{$:4,$0:hV}})]));return hO(hI,new c4({$:0,$0:hL}),hY);case 3:h2=bX.distinct(bX.map(function(ie){return ie.$==0?ie.$0.$==0?{$:9,$0:new b_({$:1,$0:bX.ofArray([[ie,{$:1,$0:[-1,"_"]}]])})}:{$:9,$0:new b_({$:1,$0:bX.ofArray([[new cf({$:0,$0:new ce({$:0,$0:ie.$0.$0})}),{$:1,$0:[-1,"_"]}]])})}:{$:9,$0:new b_({$:1,$0:bX.ofArray([[ie,{$:1,$0:[-1,"_"]}]])})};},bX.collect(function(ie){return ie[1];},bX.ofSeq(bW.ToSeq(hM[1])))));h3=(cV.unify(hI))(bX.ofArray([new cW({$:0,$0:hM[0],$1:{$:4,$0:h2}})]));return hO(hI,new c4({$:0,$0:hL}),h3);case 4:h4=bX.map(function(ie){return{$:9,$0:new b_({$:1,$0:bX.ofArray([[ie,{$:1,$0:[-1,"_"]}]])})};},bX.distinct(bX.collect(function(ie){return ie[1];},bX.ofSeq(bW.ToSeq(hM[1])))));h5=(cV.unify(hI))(bX.ofArray([new cW({$:0,$0:hM[0],$1:{$:4,$0:h4}})]));return hO(hI,new c4({$:0,$0:hL}),h5);case 5:h6=hM[0];h7=hM[1];return cw.Equals(h6.isComplementary,!h7.isComplementary)&&h6.name===h7.name&&cw.Equals(h6.isToehold,h7.isToehold)?{$:1,$0:bX.ofArray([[hN(c4.get_id()),hL]])}:null;case 6:h8=hM[0];h9=(cV.unify(hI))(bX.ofArray([new cW({$:0,$0:hM[1],$1:{$:9,$0:new b_({$:1,$0:bX.ofArray([[new cf({$:0,$0:new ce({$:0,$0:new cd({$:0,$0:cc.New(h8.name,!h8.isComplementary,h8.isToehold,cb.NoTag)})})}),hM[2]]])})}})]));return hO(hI,new c4({$:0,$0:hL}),h9);case 7:h_=c2.Flatten(hI,{$:4,$0:hM[1]});return h_==null?null:b5.resolveDsdGoal(hI,"freshBond",bX.ofArray([hM[0],{$:8,$0:h_.$0}]),hL);case 8:h$=hM[0];ia=hM[2];ib=b$.Fold(function(ie,_if){var ig;return _if.$==0?_if.$0.$==1?_if.$0.$1.$==0?(ig=_if.$0.$1.$0,ie<=ig?ig+1:ie):ie:ie:ie;},0,hM[1]);ic=c4.Create([h$,ia],{$:1,$0:new b6({$:0,$0:ib})});id=(new c4({$:0,$0:hL})).Add$2([h$,ia],{$:1,$0:new b6({$:0,$0:ib})},hI);return{$:1,$0:bX.ofArray([[hN(ic),hN(id)]])};case 9:return hM.isComplementary?{$:1,$0:bX.ofArray([[hN(c4.get_id()),hL]])}:null;case 10:return hM.isToehold?{$:1,$0:bX.ofArray([[hN(c4.get_id()),hL]])}:null;case 11:return{$:1,$0:bX.ofArray([[hN(c4.get_id()),hL]])};case 12:return null;}};b5.disambiguateVars=function(hI,hJ){function hK(hV,hW,hX){var hY,hZ,h0,h1,h2,h3;return hV.ContainsKey(hW)?hV.Add(hW,(hY=hV.get_Item(hW),(hZ=hY[4],(h0=hY[3],(h1=hY[2],(h2=hY[1],(h3=hY[0],hX.$==1?[h3,true,h1,h0,hZ]:hX.$==2?[h3,h2,true,h0,hZ]:hX.$==3?[h3,h2,h1,true,hZ]:hX.$==4?[h3,h2,h1,h0,true]:[true,h2,h1,h0,hZ]))))))):hV.Add(hW,hX.$==1?[false,true,false,false,false]:hX.$==2?[false,false,true,false,false]:hX.$==3?[false,false,false,true,false]:hX.$==4?[false,false,false,false,true]:[true,false,false,false,false]);}function hL(hV,hW,hX){while(true)switch(hV){case 0:return hX.$==0?hW:hK(hW,hX.$0,{$:4,$0:hX});case 1:return hX.$==0?hW:hK(hW,[hX.$0[0],hX.$0[1]],{$:1,$0:hX});}}function hM(hV,hW){var hX,hY;return hW.$==0?(hX=hW.$0.tag,hX.$==1?hV:hX.$==2?hT(hV,hX.$0):hV):(hY=hW.$1,hY.$==1?hK(hV,hW.$0,{$:3,$0:hW}):hY.$==2?hT(hK(hV,hW.$0,{$:3,$0:hW}),hY.$0):hK(hV,hW.$0,{$:3,$0:hW}));}function hN(hV,hW){return hL(0,hV,hW);}function hO(hV,hW){return hL(1,hV,hW);}function hP(hV,hW){return hW.$==0?hW.$0.$==1?hN(hM(hV,hW.$0.$0),hW.$0.$1):hM(hV,hW.$0.$0):hK(hV,hW.$0,{$:2,$0:hW});}function hQ(hV,hW){return hO(hP(hV,hW[0]),hW[1]);}function hR(hV,hW){return hW.$==5?hV:hW.$==4?co.fold(hQ,hV,hW.$0):hW.$==3?co.fold(hQ,hV,hW.$0):hW.$==0?co.fold(hQ,co.fold(hQ,hV,hW.$0),hW.$1):hW.$==2?co.fold(hQ,hV,hW.$0):co.fold(hQ,hV,hW.$0);}function hS(hV,hW){return co.fold(function(hX,hY){return co.fold(hP,hX,hY);},hV,bX.map(function(hX){return hX[1];},bX.ofSeq(bW.ToSeq(hW.$0))));}function hT(hV,hW){var hX,hY,hZ;switch(hW.$==1?1:hW.$==2?1:hW.$==3?(hX=hW.$1,2):hW.$==4?(hX=hW.$0,2):hW.$==5?3:hW.$==8?4:hW.$==9?5:hW.$==7?6:hW.$==6?7:0){case 0:hY=[hW.$0,hW.$1];return hV.ContainsKey(hY)?hV.Add(hY,(hZ=hV.get_Item(hY),[true,hZ[1],hZ[2],hZ[3],hZ[4]])):hV.Add(hY,[true,false,false,false,false]);case 1:return hV;case 2:return co.fold(hT,hV,hX);case 3:return hT(hT(hV,hW.$0),hW.$1);case 4:return hS(hV,hW.$0);case 5:return hR(hV,hW.$0);case 6:return be.FailWith("Multisets not supported in Logic DSD yet");case 7:return be.FailWith("CRNs not supported in Logic DSD yet");}}function hU(hV,hW){return co.fold(hT,hV,hW.$1);}return bW.Fold(function(hV,hW,hX){var hY,hZ,h0,h1,h2,h3,h4,h5,h6;function h7(h8,h9,h_,h$){function ia(id,ie){return ie.$==1?cb.AnyTag:ie.$==2?{$:2,$0:id(ie.$0)}:cb.NoTag;}function ib(id){var ie,_if,ig,ih;return id.$==1?h_!=null&&h_.$==1?cw.Equals(h8,id.$0)?h_.$0:id:id:id.$0.$==1?id.$0.$0.$==1?(ie=id.$0.$0.$1,ie.$===0?id:new cf({$:0,$0:new ce({$:1,$0:new cd({$:1,$0:id.$0.$0.$0,$1:ia(function(ii){return h7(h8,h9,h_,ii);},ie)}),$1:id.$0.$1})})):(_if=id.$0.$0.$0,new cf({$:0,$0:new ce({$:1,$0:new cd({$:0,$0:cc.New(_if.name,_if.isComplementary,_if.isToehold,ia(function(ii){return h7(h8,h9,h_,ii);},_if.tag))}),$1:id.$0.$1})})):id.$0.$0.$==1?(ig=id.$0.$0.$1,ig.$===0?id:new cf({$:0,$0:new ce({$:0,$0:new cd({$:1,$0:id.$0.$0.$0,$1:ia(function(ii){return h7(h8,h9,h_,ii);},ig)})})})):(ih=id.$0.$0.$0,new cf({$:0,$0:new ce({$:0,$0:new cd({$:0,$0:cc.New(ih.name,ih.isComplementary,ih.isToehold,ia(function(ii){return h7(h8,h9,h_,ii);},ih.tag))})})}));}function ic(id,ie){return[ib(id),ie];}return h$.$==1?h$:h$.$==2?h$:h$.$==3?{$:3,$0:h$.$0,$1:bX.map(function(id){return h7(h8,h9,h_,id);},h$.$1)}:h$.$==4?{$:4,$0:bX.map(function(id){return h7(h8,h9,h_,id);},h$.$0)}:h$.$==5?{$:5,$0:h7(h8,h9,h_,h$.$0),$1:h7(h8,h9,h_,h$.$1)}:h$.$==8?{$:8,$0:b$.Map(ib,h$.$0)}:h$.$==9?{$:9,$0:b_.Map(function(id){return ic(id[0],id[1]);},h$.$0)}:h$.$==7?be.FailWith("Multisets not supported in Logic DSD yet"):h$.$==6?be.FailWith("CRNs not supported in Logic DSD yet"):cw.Equals(h8,[h$.$0,h$.$1])?h9:h$;}return cw.Equals(hW,[-1,"_"])?hV:(hX[0]?hX[1]?(hY=[hX[4],hX[3],hX[1],hX[2],hX[0]],false):hX[2]?(hY=[hX[4],hX[3],hX[1],hX[2],hX[0]],false):hX[3]?(hY=[hX[4],hX[3],hX[1],hX[2],hX[0]],false):hX[4]?(hY=[hX[4],hX[3],hX[1],hX[2],hX[0]],false):true:hX[1]?hX[2]?(hY=[hX[4],hX[3],hX[1],hX[2],hX[0]],false):hX[3]?(hY=[hX[4],hX[3],hX[1],hX[2],hX[0]],false):hX[4]?(hY=[hX[4],hX[3],hX[1],hX[2],hX[0]],false):true:hX[2]?hX[3]?(hY=[hX[4],hX[3],hX[1],hX[2],hX[0]],false):hX[4]?(hY=[hX[4],hX[3],hX[1],hX[2],hX[0]],false):true:hX[3]?hX[4]?(hY=[hX[4],hX[3],hX[1],hX[2],hX[0]],false):true:hX[4]||true)?hV:(hZ=hY[0],(h0=hY[1],(h1=hY[3],(h2=hY[4],hZ?h2?be.FailWith((((hB.Curried3(function(h8,h9,h_){return h8("Operation unsupported: cannot use bond variable \\""+cA.toSafe(h9)+"\\" alone as a term (it must be used in a pattern, e.g. D!"+cA.toSafe(h_)+")");}))(a.id))(hW[1]))(hW[1])):be.FailWith((((hB.Curried3(function(h8,h9,h_){return h8("Cannot unify bond variable \\""+cA.toSafe(h9)+"\\" with a "+cA.toSafe(h_)+" variable");}))(a.id))(hW[1]))(h0?"domain":h1?"site":"location")):hY[2]?h1||h0||hZ?be.FailWith((((hB.Curried3(function(h8,h9,h_){return h8("Cannot unify location variable \\""+cA.toSafe(h9)+"\\" with a "+cA.toSafe(h_)+" variable");}))(a.id))(hW[1]))(h0?"domain":h1?"site":"bond")):!h2?hV:c4.Create$3(hW,{$:9,$0:new b_({$:1,$0:bX.ofArray([[new cf({$:1,$0:[-1,"_"]}),{$:1,$0:hW}]])})}).Add$1(hW,{$:1,$0:{$:1,$0:hW}},hI).Apply(hV,hI):h0?(h3=new cf({$:0,$0:new ce({$:0,$0:new cd({$:1,$0:hW,$1:cb.AnyTag})})}),(h4={$:9,$0:new b_({$:1,$0:bX.ofArray([[h3,{$:1,$0:[-1,"_"]}]])})},ci.Map((h5={$:1,$0:h3},function(h8){return h7(hW,h4,h5,h8);}),hV))):(h6={$:9,$0:new b_({$:1,$0:bX.ofArray([[new cf({$:1,$0:hW}),{$:1,$0:[-1,"_"]}]])})},ci.Map(function(h8){return h7(hW,h6,null,h8);},hV))))));},hJ,co.fold(function(hV,hW){return hW.$==1?hU(hV,hW.$0):hU(hV,hW.$0);},co.fold(hT,new cj.New([]),hJ.head.$1),hJ.body));};b5.dsdSubApply2=function(hI,hJ,hK){return hK.$==1?{$:1,$0:b5.bondApply(hI,hJ,hK.$0)}:{$:0,$0:b5.domApply(false,hI,hJ,hK.$0)};};b5.composer=function(hI,hJ){return b5.dsdSubApply(b5.engine(),hI,{$:0,$0:hJ});};b5.dsdSubApply=function(hI,hJ,hK){var hL;return hK.$==1?(hL=hK.$0,hL.$==1?new cf({$:0,$0:new ce({$:1,$0:new cd({$:1,$0:[-1,"_"],$1:cb.AnyTag}),$1:b5.bondApply(hI,hJ,hL.$0)})}):new cf({$:0,$0:new ce({$:0,$0:b5.domApply(true,hI,hJ,hL.$0)})})):b5.siteApply(hI,hJ,hK.$0);};b5.unifySite=function(hI,hJ,hK){var hL,hM,hN,hO;switch(hJ.$==0?hK.$==0?hK.$0.$==1?hJ.$0.$==1?(hL=[hJ.$0.$0,hK.$0.$0,hJ.$0.$1,hK.$0.$1],3):4:hJ.$0.$==0?(hL=[hJ.$0.$0,hK.$0.$0],2):4:hK.$0[0]===-1?hK.$0[1]==="_"?0:(hL=[hJ,hK.$0],1):(hL=[hJ,hK.$0],1):hJ.$0[0]===-1?hJ.$0[1]==="_"?0:hK.$==1?hK.$0[0]===-1?hK.$0[1]==="_"?0:(hL=[hK,hJ.$0],1):(hL=[hK,hJ.$0],1):(hL=[hK,hJ.$0],1):hK.$==1?hK.$0[0]===-1?hK.$0[1]==="_"?0:(hL=[hK,hJ.$0],1):(hL=[hK,hJ.$0],1):(hL=[hK,hJ.$0],1)){case 0:return bX.ofArray([b5.deSub(c4.get_id())]);case 1:return bX.ofArray([b5.deSub(c4.Create$1(hL[1],hL[0]))]);case 2:return b5.unifyDomain(hI,hL[0],hL[1]);case 3:hM=b5.unifyDomain(hI,hL[0],hL[1]);return hM.$==0?bY.Empty:(hN=b5.unifyBond(hL[2],hL[3]),hN==null?bY.Empty:(hO=hN.$0,bX.map(function(hP){return b5.deSub(c4.Compose(new c4({$:0,$0:hP}),hO,hI));},hM)));case 4:return bY.Empty;}};b5.dsdCanonicalForm=function(hI,hJ){var hK,hL,hM,hN;function hO(){var hQ,hR;hQ=[0];hR=[new cj.New([])];return function(hS){return cf.Map(function(hT){var hU,hV;return hT.$==0?(hU=hT.$0,hR[0].ContainsKey(hU)?new b6({$:0,$0:hR[0].get_Item(hU)}):(hV=hQ[0],(hQ[0]=hV+1,hR[0]=hR[0].Add(hU,hV),new b6({$:0,$0:hV})))):hT;},hS);};}function hP(hQ,hR){return b8.EQ();}hK=hO();return b$.OfList(bX.rev(co.fold(function(hQ,hR){return new bY({$:1,$0:bX.map(hK,hR),$1:hQ});},bY.Empty,bX.concat(function(hQ){var hR,hS,hX,hY,hZ,h0,h1;function hT(h2,h3,h4){function h5(h6,h7){return function(h8){return[((h2(h7))(h6))(h8),h7+1];};}return(co.fold(function(h6,h7){return(function(h8){return h5(h8[0],h8[1]);}(h6))(h7);},[h3,0],h4))[0];}function hU(h2,h3){return cw.Equals(h2,h3)?b8.EQ():cw.Compare(h2,h3)===-1?b8.LT():b8.GT();}function hV(h2){return h2.$==0;}function hW(h2){return!h2;}while(true){hX=(hR=ck.ofSeq(bW.ToSeq(hT((hB.Curried(function(h2,h3,h4,h5){return((h2(hB.Curried3(function(h6,h7,h8){return((h2(hB.Curried3(function(h9,h_,h$){var ia,ib;return h$.$==0?h$.$0.$==1?h$.$0.$1.$==0?(ia=h$.$0.$1.$0,ib=[h3,h6,h9],h_.ContainsKey(ia)?h_.Add(ia,h_.get_Item(ia).Add(ib)):h_.Add(ia,(new cK.New$1(null)).Add(ib))):h_:h_:h_;})))(h7))(h8);})))(h4))(h5);},4))(hB.Curried3(hT)),new cj.New([]),hQ))),ck.sortInPlaceBy(function(h2){return h2[0];},hR),ck.map(function(h2){return h2[1];},hR));hY=function(h2){return function(h3){return bX.rev(((h2(hB.Curried3(function(h4,h5,h6){return h6.$==0?h6.$0.$==1?h6.$0.$1.$==0?new bY({$:1,$0:[h4,h6.$0.$1.$0],$1:h5}):h5:h5:h5;})))(bY.Empty))(h3));};}(hB.Curried3(hT));hZ=hT(function(h2,h3,h4,h5){return hB.Curried3(function(h6,h7,h8){return h7==null?((h2(hB.Curried3(function(h9,h_,h$){var ia,ib,ic;return h_==null?(ia=h3(h$),ib=((h2(function(id){return function(ie){var _if,ig,ih;_if=ie[0];ig=ie[1];ih=ie[2];return function(ii){var ij,ik;return id===h9?[_if,new bY({$:1,$0:ii,$1:ig}),ih]:(ij=(ik=bX.zip(ia,h3(ii)),co.fold(function(il,im){var _in,io,ip,iq,ir,is,it,iu,iv,iw,ix,iy,iz;_in=im[0];io=im[1];ip=_in[1];return il!==b8.EQ()?il:(iq=ck.get(h4,ip).Remove([h6,h9,_in[0]]),ir=ck.get(h4,io[1]).Remove([h6,id,io[0]]),ir.get_Count()!==iq.get_Count()?(h5(ir.get_Count()))(iq.get_Count()):ir.get_Count()===0?b8.EQ():ir.get_Count()>1?be.FailWith((function(iA){return function(iB){return iA("Bond "+a.String(iB)+" cannot occur more than twice in a strand");};}(a.id))(ip)):(is=bX.head(bX.ofSeq(ir)),it=is[1],iu=is[2],iv=is[0],iw=bX.head(bX.ofSeq(iq)),ix=iw[1],iy=iw[2],iz=iw[0],iv!==iz?(h5(iv))(iz):it!==ix?(h5(it))(ix):iu!==iy?(h5(iu))(iy):b8.EQ()));},b8.EQ(),ik)),ij===-1?[new bY({$:1,$0:ii,$1:_if}),ig,ih]:ij===0?[_if,new bY({$:1,$0:ii,$1:ig}),ih]:ij===1?[_if,ig,new bY({$:1,$0:ii,$1:ih})]:be.FailWith(""));};};}))([bY.Empty,bY.Empty,bY.Empty]))(h8),(ib[0].$==0?ib[2].$==0||(ic=[ib[1],ib[2],ib[0]],false):(ic=[ib[1],ib[2],ib[0]],false))?null:{$:1,$0:[h6,ic[2],ic[0],ic[1]]}):h_;})))(null))(h8):h7;});}(hB.Curried3(hT),hY,hX,function(h2){return function(h3){return hU(h2,h3);};}),null,hQ);if(hZ!=null&&hZ.$==1){h0=hZ.$0[0];h1=bX.append(bX.ofSeq(co.take(h0,hQ)),bX.append((hS=bX.ofArray([hZ.$0[1],hZ.$0[2],hZ.$0[3]]),(function(h2){return function(h3){return bX.filter(h2,h3);};}(function(h2){return hW(hV(h2));}))(hS)),bX.skip(h0+1,hQ)));hQ=h1;}else return hQ;}}((hL=hO(),bX.rev(function(hQ,hR){var hS,hT,hU,hV;while(true)if(hR.$==1){hS=hR.$1;hT=hR.$0;if(hQ.$==0){hQ=bX.ofArray([bX.ofArray([hT])]);hR=hS;}else{hU=bX.compareWith(function(hW,hX){function hY(hZ,h0){return b8.EQ();}return((function(hZ,h0){return hB.Curried(cf.Compare,2,[hZ,function(h1,h2){return(h0(h1))(h2);}]);}(hI,function(hZ){return function(h0){return hY(hZ,h0);};}))(hW))(hX);},hT,bX.head(bX.head(hQ)));if(hU===0){hV=new bY({$:1,$0:new bY({$:1,$0:hT,$1:bX.head(hQ)}),$1:bX.tail(hQ)});hQ=hV;hR=hS;}else{hQ=new bY({$:1,$0:bX.ofArray([hT]),$1:hQ});hR=hS;}}}else return(function(hW){return function(hX){return bX.map(hW,hX);};}(function(hW){return function(hX){return bX.sortWith(function(hY,hZ){return(hW(hY))(hZ);},hX);};}(function(hW){function hX(hY,hZ){return cf.Compare(hI,cw.Compare,hY,hZ);}return function(hY){return bX.compareWith(hX,hW,hY);};})))(hQ);}(bY.Empty,(hM=(hN=hB.Curried(cf.Compare,2,[hI,hP]),(hB.Curried3(bX.compareWith))(function(hQ,hR){return(hN(hQ))(hR);})),bX.sortWith(function(hQ,hR){return(hM(hQ))(hR);},co.fold(function(hQ,hR){return new bY({$:1,$0:bX.map(hL,hR),$1:hQ});},bY.Empty,b$.ToList(hJ))))))))))));};b5.pbond=function(hI){var hJ;function hK(hL){return new b6({$:1,$0:hL});}hJ=cR.choice([cR.op_BarGreaterGreater(f4.pname(),function(hL){return hK(hI(hL));}),cR.op_BarGreaterGreater(cR.op_DotGreaterGreater(cR.pint32(),cR.spaces()),function(hL){return new b6({$:0,$0:hL});})]);return function(hL){return hJ([hL[0],hL[1]]);};};b5.to_concrete_strand=function(hI){return bX.map(b5.to_concrete_site,hI);};b5.refreshSite=function(hI,hJ,hK){return hK.$==0?new ce({$:0,$0:b5.refreshDomainT(hI,hJ,hK.$0)}):new ce({$:1,$0:b5.refreshDomainT(hI,hJ,hK.$0),$1:b5.refreshBond(hJ,hK.$1)});};b5.bondApply=function(hI,hJ,hK){var hL;function hM(hN,hO){return((((hB.Curried(function(hP,hQ,hR,hS){return hP("Cannot substitute "+cA.toSafe(hQ)+" "+cA.toSafe(hR)+" in bond "+cA.toSafe(hS));},4))(be.FailWith))(hN))(hO))(b6.ToString(hK));}return hK.$==0?hK:(hL=hJ.TryFind(hK.$0),hL==null?hK:hL.$0.$==0?hM("site",ca.ToStringWith(hI,hL.$0.$0)):hL.$0.$==1?hM("location",b9.ToString(hL.$0.$0)):hL.$0.$==2?hM("site",hI.toString(hL.$0.$0)):hL.$0.$0.$==0?hM("domain",cd.ToString(hL.$0.$0.$0)):hL.$0.$0.$0);};b5.domApply=function(hI,hJ,hK,hL){var hM,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0;function hN(h1){var h2,h4;function h3(h5,h6){return((((hB.Curried(function(h7,h8,h9,h_){return h7("Cannot substitute "+cA.toSafe(h8)+" "+cA.toSafe(h9)+" in domain "+cA.toSafe(h_));},4))(be.FailWith))(h5))(h6))(h1[1]);}h4=hK.TryFind(h1);switch(h4==null?6:h4.$0.$==0?(h2=h4.$0.$0,1):h4.$0.$==1?(h2=h4.$0.$0,2):h4.$0.$==2?h4.$0.$0.$==0?h4.$0.$0.$0.$==0?(h2=h4.$0.$0.$0.$0,3):(h2=h4.$0.$0,4):(h2=h4.$0.$0,4):h4.$0.$0.$==1?(h2=h4.$0.$0.$0,5):(h2=h4.$0.$0.$0,0)){case 0:return h2;case 1:return h3("site",ca.ToStringWith(hJ,h2));case 2:return h3("location",b9.ToString(h2));case 3:return hI?h2:h3("site",hJ.toString(new cf({$:0,$0:new ce({$:0,$0:h2})})));case 4:return h3("site",cf.ToString(h2));case 5:return h3("bond",b6.ToString(h2));case 6:return new cd({$:1,$0:h1,$1:cb.AnyTag});}}switch(hL.$==0?(hM=hL.$0,3):hL.$0[0]===-1?hL.$0[1]==="_"?hL.$1.$==0?0:hL.$1.$==2?(hM=hL.$1.$0,1):0:(hM=[hL.$1,hL.$0],2):(hM=[hL.$1,hL.$0],2)){case 0:return hL;case 1:return new cd({$:1,$0:[-1,"_"],$1:{$:2,$0:c4.Apply(new c4({$:0,$0:hK}),hM,hJ)}});case 2:hO=hM[0];hP=hM[1];return hO.$==0?(hQ=hN(hP),hQ.$==0?(hR=hQ.$0,hR.tag.$===0?new cd({$:0,$0:hR}):be.FailWith(((((hB.Curried(function(h1,h2,h3,h4){return h1("Tag mismatch: cannot substitute "+cA.toSafe(h2)+" in "+cA.toSafe(h3)+"{} with "+cA.toSafe(h4));},4))(a.id))(b8.printVar(hP[0],hP[1])))(b8.printVar(hP[0],hP[1])))(cc.ToString(hR)))):hQ.$1.$==1?new cd({$:1,$0:hQ.$0,$1:cb.NoTag}):hQ.$1.$==2?(hS=hQ.$0,be.FailWith((((((hB.Curried(function(h1,h2,h3,h4,h5){return h1("Tag mismatch: cannot substitute "+cA.toSafe(h2)+" in "+cA.toSafe(h3)+"{} with "+cA.toSafe(h4)+"{"+cA.toSafe(h5)+"}");},5))(a.id))(b8.printVar(hP[0],hP[1])))(b8.printVar(hP[0],hP[1])))(b8.printVar(hS[0],hS[1])))(ca.ToStringWith(hJ,hQ.$1.$0)))):new cd({$:1,$0:hQ.$0,$1:cb.NoTag})):hO.$==2?(hT=hO.$0,hU=hN(hP),hU.$==0?(hV=hU.$0,hW=hV.tag,hW.$==1?new cd({$:0,$0:cc.New(hV.name,hV.isComplementary,hV.isToehold,{$:2,$0:hT})}):hW.$==2?(hX=hW.$0,cw.Equals(c4.Apply(new c4({$:0,$0:hK}),hT,hJ),hX)?new cd({$:0,$0:cc.New(hV.name,hV.isComplementary,hV.isToehold,{$:2,$0:hX})}):be.FailWith(((((hB.Curried(function(h1,h2,h3,h4){return h1("Cannot substitute "+cA.toSafe(h2)+" in "+cA.toSafe(h3)+" with "+cA.toSafe(h4));},4))(a.id))(b8.printVar(hP[0],hP[1])))(cc.ToString(hV)))(cc.ToString(hV)))):be.FailWith("")):hU.$1.$==0?(hY=hU.$0,be.FailWith((((((hB.Curried(function(h1,h2,h3,h4,h5){return h1("Tag mismatch: cannot substitute "+cA.toSafe(h2)+" in "+cA.toSafe(h3)+"{"+cA.toSafe(h4)+"} with "+cA.toSafe(h5)+"{}");},5))(a.id))(b8.printVar(hP[0],hP[1])))(b8.printVar(hP[0],hP[1])))(ca.ToString(hT)))(b8.printVar(hY[0],hY[1])))):hU.$1.$==2?(hZ=hU.$1.$0,cw.Equals(c4.Apply(new c4({$:0,$0:hK}),hT,hJ),hZ)?new cd({$:1,$0:hU.$0,$1:{$:2,$0:hZ}}):be.FailWith(((((hB.Curried(function(h1,h2,h3,h4){return h1("Cannot substitute "+cA.toSafe(h2)+" in "+cA.toSafe(h3)+" with "+cA.toSafe(h4));},4))(a.id))(b8.printVar(hP[0],hP[1])))(cd.ToString(hL)))(hP[1]))):new cd({$:1,$0:hU.$0,$1:{$:2,$0:hT}})):hN(hP);case 3:h0=hM.tag;return h0.$==1?hL:h0.$==2?new cd({$:0,$0:cc.New(hM.name,hM.isComplementary,hM.isToehold,{$:2,$0:c4.Apply(new c4({$:0,$0:hK}),h0.$0,hJ)})}):hL;}};b5.siteApply=function(hI,hJ,hK){var hL,hN,hO,hP;function hM(hQ,hR,hS){return((((hB.Curried(function(hT,hU,hV,hW){return hT("Cannot substitute site variable "+cA.toSafe(hU)+" with "+cA.toSafe(hV)+" "+cA.toSafe(hW));},4))(be.FailWith))(hQ[1]))(hR))(hS);}switch(hK.$==0?hK.$0.$==1?(hL=[hK.$0.$0,hK.$0.$1],4):hK.$0.$0.$==1?(hL=[hK.$0.$0.$1,hK.$0.$0.$0],2):(hL=hK.$0.$0,3):hK.$0[0]===-1?hK.$0[1]==="_"?0:(hL=hK.$0,1):(hL=hK.$0,1)){case 0:return hK;case 1:hN=hJ.TryFind(hL);return hN!=null&&hN.$==1?hN.$0.$==0?hM(hL,"term",ca.ToStringWith(hI,hN.$0.$0)):hN.$0.$==1?hM(hL,"location",b9.ToString(hN.$0.$0)):hN.$0.$==3?hN.$0.$0.$==1?new cf({$:0,$0:new ce({$:1,$0:new cd({$:1,$0:[-1,""],$1:cb.AnyTag}),$1:hN.$0.$0.$0})}):new cf({$:0,$0:new ce({$:0,$0:hN.$0.$0.$0})}):hN.$0.$0:hK;case 2:hO=hL[1];return new cf({$:0,$0:new ce({$:0,$0:b5.domApply((hP=hJ.TryFind(hO),hP!=null&&hP.$==1&&(hP.$0.$==2&&(hP.$0.$0.$==0&&hP.$0.$0.$0.$==0))),hI,hJ,new cd({$:1,$0:hO,$1:hL[0]}))})});case 3:return new cf({$:0,$0:new ce({$:0,$0:b5.domApply(false,hI,hJ,hL)})});case 4:return new cf({$:0,$0:new ce({$:1,$0:b5.domApply(false,hI,hJ,hL[0]),$1:b5.bondApply(hI,hJ,hL[1])})});}};b5.deSub=function(hI){return hI.$0;};b5.unifyDomain=function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ,hR,hS,hT;switch(hJ.$==0?hK.$==0?(hL=[hJ.$0,hK.$0],4):hK.$0[0]===-1?hK.$0[1]==="_"?(hL=[hK.$1,hJ],0):hK.$1.$==1?(hL=[hJ,hK.$0],1):(hL=[hJ.$0,hK.$1,hK.$0],3):hK.$1.$==1?(hL=[hJ,hK.$0],1):(hL=[hJ.$0,hK.$1,hK.$0],3):hJ.$0[0]===-1?hJ.$0[1]==="_"?(hL=[hJ.$1,hK],0):hK.$==0?hJ.$1.$==1?(hL=[hK,hJ.$0],1):(hL=[hK.$0,hJ.$1,hJ.$0],3):hK.$0[0]===-1?hK.$0[1]==="_"?(hL=[hK.$1,hJ],0):hJ.$1.$==1?(hL=[hK,hJ.$0],1):hK.$1.$==1?(hL=[hJ,hK.$0],1):(hL=[hJ.$1,hK.$1,hJ.$0,hK.$0],2):hJ.$1.$==1?(hL=[hK,hJ.$0],1):hK.$1.$==1?(hL=[hJ,hK.$0],1):(hL=[hJ.$1,hK.$1,hJ.$0,hK.$0],2):hK.$==0?hJ.$1.$==1?(hL=[hK,hJ.$0],1):(hL=[hK.$0,hJ.$1,hJ.$0],3):hK.$0[0]===-1?hK.$0[1]==="_"?(hL=[hK.$1,hJ],0):hJ.$1.$==1?(hL=[hK,hJ.$0],1):hK.$1.$==1?(hL=[hJ,hK.$0],1):(hL=[hJ.$1,hK.$1,hJ.$0,hK.$0],2):hJ.$1.$==1?(hL=[hK,hJ.$0],1):hK.$1.$==1?(hL=[hJ,hK.$0],1):(hL=[hJ.$1,hK.$1,hJ.$0,hK.$0],2)){case 0:hM=hL[0];hN=hL[1];return hN.$==0?b5.unifyTag(hI,hM,hN.$0.tag):b5.unifyTag(hI,hM,hN.$1);case 1:return bX.ofArray([b5.deSub(c4.Create(hL[1],{$:0,$0:hL[0]}))]);case 2:hO=hL[1];hP=c4.Create(hL[2],{$:0,$0:new cd({$:1,$0:hL[3],$1:hO})});return bX.map(function(hU){return b5.deSub(c4.Compose(hP,new c4({$:0,$0:hU}),hI));},b5.unifyTag(hI,hL[0],hO));case 3:hQ=hL[0];hR=c4.Create(hL[2],{$:0,$0:new cd({$:0,$0:hQ})});return bX.map(function(hU){return b5.deSub(c4.Compose(hR,new c4({$:0,$0:hU}),hI));},b5.unifyTag(hI,hL[1],hQ.tag));case 4:hS=hL[0];hT=hL[1];return hS.name===hT.name&&cw.Equals(hS.isComplementary,hT.isComplementary)&&cw.Equals(hS.isToehold,hT.isToehold)?b5.unifyTag(hI,hS.tag,hT.tag):bY.Empty;}};b5.unifyBond=function(hI,hJ){var hK;switch(hI.$==0?hJ.$==0?(hK=[hI.$0,hJ.$0],2):hJ.$0[0]===-1?hJ.$0[1]==="_"?0:(hK=[hI,hJ.$0],1):(hK=[hI,hJ.$0],1):hI.$0[0]===-1?hI.$0[1]==="_"?0:hJ.$==1?hJ.$0[0]===-1?hJ.$0[1]==="_"?0:(hK=[hJ,hI.$0],1):(hK=[hJ,hI.$0],1):(hK=[hJ,hI.$0],1):hJ.$==1?hJ.$0[0]===-1?hJ.$0[1]==="_"?0:(hK=[hJ,hI.$0],1):(hK=[hJ,hI.$0],1):(hK=[hJ,hI.$0],1)){case 0:return{$:1,$0:c4.get_id()};case 1:return{$:1,$0:c4.Create(hK[1],{$:1,$0:hK[0]})};case 2:return hK[0]===hK[1]?{$:1,$0:c4.get_id()}:null;}};b5.to_concrete_site=function(hI){var hJ;return hI.$==1?be.FailWith((function(hK){return function(hL){return hK("Cannot create concrete site from "+cA.toSafe(hL)+", which is a variable.");};}(a.id))(hI.$0[1])):(hJ=hI.$0,hJ.$==0?new hr({$:1,$0:b5.to_concrete_domain(hJ.$0)}):new hr({$:0,$0:b5.to_concrete_domain(hJ.$0),$1:b5.to_concrete_bond(hJ.$1)}));};b5.refreshDomainT=function(hI,hJ,hK){var hL,hM,hN;switch(hK.$==0?(hL=hK.$0,2):hK.$0[0]===-1?hK.$0[1]==="_"?(hL=hK.$1,0):(hL=[hK.$1,hK.$0[1]],1):(hL=[hK.$1,hK.$0[1]],1)){case 0:return new cd({$:1,$0:[-1,"_"],$1:b5.refreshTag(hI,hJ,hL)});case 1:hM=hL[1];hN=b5.refreshTag(hI,hJ,hL[0]);return new cd({$:1,$0:[hJ(hM),hM],$1:hN});case 2:return new cd({$:0,$0:b5.refreshDomain(hI,hJ,hL)});}};b5.refreshBond=function(hI,hJ){var hK;switch(hJ.$==1?hJ.$0[0]===-1?hJ.$0[1]==="_"?1:(hK=hJ.$0[1],2):(hK=hJ.$0[1],2):(hK=hJ.$0,0)){case 0:return new b6({$:0,$0:hK});case 1:return new b6({$:1,$0:[-1,"_"]});case 2:return new b6({$:1,$0:[hI(hK),hK]});}};b5.unifyTag=function(hI,hJ,hK){var hL;switch(hJ.$==1?0:hJ.$==2?hK.$==2?(hL=[hJ.$0,hK.$0],1):hK.$==0?2:0:hK.$==1?0:hK.$==2?2:0){case 0:return bX.ofArray([b5.deSub(c4.get_id())]);case 1:return bX.map(b5.deSub,(cV.unify(hI))(bX.ofArray([new cW({$:0,$0:hL[0],$1:hL[1]})])));case 2:return bY.Empty;}};b5.to_concrete_domain=function(hI){var hJ,hK;return hI.$==1?be.FailWith((function(hL){return function(hM){return hL("Cannot create concrete domain from "+cA.toSafe(hM)+", which is a variable.");};}(a.id))(hI.$0[1])):(hJ=hI.$0,gd.New(hJ.name,hJ.isComplementary,hJ.isToehold,(hK=hJ.tag,hK.$==1?g0.AnyTagC:hK.$==2?{$:2,$0:ca.ToString(hK.$0)}:g0.NoTagC)));};b5.to_concrete_bond=function(hI){return hI.$==1?be.FailWith((function(hJ){return function(hK){return hJ("Cannot create concrete bond from "+cA.toSafe(hK)+", which is a variable.");};}(a.id))(hI.$0[1])):hI.$0;};b5.refreshTag=function(hI,hJ,hK){return hK.$==1?cb.AnyTag:hK.$==2?{$:2,$0:ca.refresh(hI,hJ,hK.$0)}:cb.NoTag;};b5.refreshDomain=function(hI,hJ,hK){return hK.tag.$===0||hK.tag.$===1?hK:cc.New(hK.name,hK.isComplementary,hK.isToehold,b5.refreshTag(hI,hJ,hK.tag));};c0.resolveAll=function(hI,hJ,hK){var hL;hL=[c3.fvl(hK,hI).get_Count()+1];return c0.resolveInner(bX.ofArray([eu.Create(bX.ofArray([hI]),hK)]),hK,hL,hJ,bY.Empty,ev.AllAnswers);};c0.resolveInner=function(hI,hJ,hK,hL,hM,hN){var hO,hP,hQ,hR,hS,hT,hU;function hV(hW){var hX,hY,hZ,h0,h1,h2;function h3(h4,h5,h6,h7){return eu.Create$2(h5,bX.append(h6,bX.map(function(h8){return c0.applyL(hJ,h4,h8);},h1)),ci.Create(c0.applyP(hJ,h4,h7.head)));}hX=hW.goals;return hX.$==0?bY.Empty:hX.$0.$==1?(hY=hX.$0.$0,c3.fvp(hJ,hY).get_IsEmpty()?(hZ=c0.resolveInner(bX.ofArray([eu.Create(bX.ofArray([new ch({$:0,$0:hY})]),hJ)]),hJ,hK,hL,bY.Empty,ev.SingleAnswer),hZ!=null&&hZ.$==1)?bY.Empty:bX.map(function(h4){return eu.Create$2(h4[0],h4[1],h4[2]);},bX.ofArray([[hW.solution,hX.$1,ci.Create(new cg({$:0,$0:(function(h4){return function(h5){return h4("not("+cA.toSafe(h5)+")");};}(a.id))(hY.get_String()),$1:bY.Empty}))]])):bY.Empty):(h0=hX.$0.$0,(h1=hX.$1,hN.$===1&&c3.fvp(hJ,h0).get_IsEmpty()?c0.resolveInner(bX.ofArray([eu.Create(bX.ofArray([new ch({$:0,$0:h0})]),hJ)]),hJ,hK,hL,bY.Empty,ev.SingleAnswer)==null?bY.Empty:bX.ofArray([eu.Create$2(hW.solution,h1,ci.Create(new cg({$:0,$0:(function(h4){return function(h5){return h4("not("+cA.toSafe(h5)+")");};}(a.id))(h0.get_String()),$1:bY.Empty})))]):(h2=c0.resolveGoal(hL,hW.solution,hJ,hK,h0),h2==null?bY.Empty:bX.map(function(h4){return h3(h4[0],h4[1],h4[2],h4[3]);},h2.$0))));}return hI.$==0?null:hN.$==1?(hO=bX.head(hI),(hP=bX.tail(hI),(hQ=bX.partition(function(hW){return hW.goals.$==0;},hV(hO)),(hR=hQ[1],(hS=bX.append(hM,bX.map(function(hW){return hW.solution;},hQ[0])),hR.$==0&&hP.$==0?hS.$==0?null:{$:1,$0:hS}:c0.resolveInner(bX.append(hR,hP),hJ,hK,hL,hS,hN)))))):(hT=bX.collect(hV,hI),(hU=co.tryFind(function(hW){return hW.goals.$==0;},hT),hU==null?cw.Equals(hT,hI)?null:c0.resolveInner(hT,hJ,hK,hL,bY.Empty,hN):{$:1,$0:bX.ofArray([hU.$0.solution])}));};c0.resolveGoal=function(hI,hJ,hK,hL,hM){var hN,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0,h1,h2,h4,h5,h6,h7,h8,h9,h_,h$,ia,ib,ic,id,ie,_if,ig,ih,ii,ij,ik,il,im,_in,io,ip,iq,ir,is,it,iu,iv,iw,ix,iy,iz,iA,iB,iN,iO,iP,iQ,iR,iS,iT,iU,iV,iW,iX,iY,iZ,i0,i1,i2,i3,i4,i5,i6,i7,i8,i9,i_,i$,ja,jb,jd,je,jf,jg,jh,ji,jj,jk,jl,jm,jn,jo,jp,jq,jr,js,jt,ju,jw,jx,jy,jz,jA,jB,jC,jD,jE,jF,jG;function hO(jH,jI,jJ,jK){return jK.$==0?null:{$:1,$0:co.fold(function(jL,jM){return new bY({$:1,$0:[jM,c4.Update(jI,jM,jH),eu.get_OK(),jJ],$1:jL});},bY.Empty,jK)};}function hP(jH,jI){return[new c4({$:0,$0:jH}),new c4({$:0,$0:jI}),eu.get_OK(),ci.Create(new cg({$:0,$0:"custom",$1:bY.Empty}))];}hQ=(hK.resolveGoal([hM.$0,hM.$1]))(hJ.$0);function h3(jH,jI){var jJ;jJ=c4.Compose(jH,c4.Create$3([hX,hY],jI),hK);return[jJ,c4.Update(hJ,jJ,hK),eu.get_OK(),ci.Create(new cg({$:0,$0:"is ctx",$1:bY.Empty}))];}function iC(jH,jI){return bX.map(function(jJ){return[jH,jJ];},jI);}function iD(jH,jI){return bX.ofArray([jH,jI]);}function iE(jH,jI){return[jI,jH];}function iF(jH,jI){return[jH,gy.New(iq.get_Item(jI),-1,-1,false)];}function iG(jH,jI){return[iq.get_Item(jH),iq.get_Item(jI)];}function iH(jH,jI){return bX.map(function(jJ){return[ir.get_Item(jJ),jH];},jI);}function iI(jH,jI){return bX.ofArray([jH,jI]);}function iJ(jH,jI){return{$:4,$0:bX.ofSeq(co.map(function(jJ){return{$:8,$0:jJ};},jI))};}function iK(jH){return{$:4,$0:jH};}function iL(jH,jI){return[jH,bX.distinct(bX.map(function(jJ){return iu.get_Item(jJ);},jI))];}function iM(jH,jI){var jJ,jK;jJ=co.distinct(co.concat(co.map(function(jL){return iz.get_Item(jL);},jI)));jK=co.length(jJ);return jK===1?co.head(jJ)===jH:jK===0;}function jc(jH){return bX.rev(co.fold(function(jI,jJ){var jK;jK=ca.FlattenList(jJ);return jK.$==0?bX.append(bX.rev(jK.$0),jI):be.FailWith((function(jL){return function(jM){return jL("Cannot concat indeterminate list "+cA.toSafe(jM)+" ");};}(a.id))(ca.ToString(jJ)));},bY.Empty,jH));}function jv(jH,jI){return function(jJ){return bX.collect(function(jK){return(cV.unify(hK))(bX.ofArray([new cW({$:0,$0:jK,$1:jJ})]));},bX.map(function(jK){return jI.Apply$9(jK,hK);},jq)).$==0?[jH,c4.Update(jI,hJ,hK)]:[new bY({$:1,$0:jJ,$1:jH}),c4.Update(jI,hJ,hK)];};}if(hQ==null)switch(hM.$0==="is"?hM.$1.$==1?hM.$1.$0.$==0?hM.$1.$1.$==1?hM.$1.$1.$0.$==3?hM.$1.$1.$0.$0==="|"?hM.$1.$1.$1.$==1?hM.$1.$1.$1.$0.$==5?hM.$1.$1.$1.$1.$==0?(hN=[hM.$1.$1.$0,hM.$1.$0,hM.$1.$1.$1.$0.$0,hM.$1.$1.$1.$0.$1],1):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1.$1.$0.$1,hM.$1.$0.$0,hM.$1.$0.$1],0):hM.$1.$1.$0.$0==="_ctx"?hM.$1.$1.$1.$==0?(hN=[hM.$1.$1.$0,hM.$1.$0.$0,hM.$1.$0.$1],7):hM.$1.$1.$1.$0.$==5?hM.$1.$1.$1.$1.$==0?(hN=[hM.$1.$1.$0,hM.$1.$0,hM.$1.$1.$1.$0.$0,hM.$1.$1.$1.$0.$1],1):(hN=[hM.$1,hM.$0],27):hM.$1.$1.$1.$1.$==0?hM.$1.$1.$0.$1.$==1?hM.$1.$1.$0.$1.$0.$==8?hM.$1.$1.$0.$1.$1.$==1?hM.$1.$1.$0.$1.$1.$1.$==0?(hN=[hM.$1.$1.$0.$1.$0.$0.$0,hM.$1.$1.$0.$1.$1.$0,hM.$1.$0,hM.$1.$1.$1.$0],4):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):hM.$1.$1.$1.$==0?(hN=[hM.$1.$1.$0,hM.$1.$0.$0,hM.$1.$0.$1],7):hM.$1.$1.$1.$0.$==5?hM.$1.$1.$1.$1.$==0?(hN=[hM.$1.$1.$0,hM.$1.$0,hM.$1.$1.$1.$0.$0,hM.$1.$1.$1.$0.$1],1):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):hM.$1.$1.$0.$==0?hM.$1.$1.$1.$==0?(hN=[hM.$1.$1.$0,hM.$1.$0.$0,hM.$1.$0.$1],7):hM.$1.$1.$1.$0.$==5?hM.$1.$1.$1.$1.$==0?(hN=[hM.$1.$1.$0,hM.$1.$0,hM.$1.$1.$1.$0.$0,hM.$1.$1.$1.$0.$1],1):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):hM.$1.$1.$1.$==0?(hN=[hM.$1.$1.$0,hM.$1.$0.$0,hM.$1.$0.$1],7):hM.$1.$1.$1.$0.$==5?hM.$1.$1.$1.$1.$==0?(hN=[hM.$1.$1.$0,hM.$1.$0,hM.$1.$1.$1.$0.$0,hM.$1.$1.$1.$0.$1],1):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):hM.$1.$0.$==4?hM.$1.$1.$==1?hM.$1.$1.$1.$==0?hM.$1.$1.$0.$==0?(hN=[hM.$1.$0,hM.$1.$1.$0.$0,hM.$1.$1.$0.$1],7):(hN=[hM.$1,hM.$0],27):hM.$1.$1.$1.$0.$==5?hM.$1.$1.$1.$1.$==0?(hN=[hM.$1.$1.$0,hM.$1.$0,hM.$1.$1.$1.$0.$0,hM.$1.$1.$1.$0.$1],1):(hN=[hM.$1,hM.$0],27):hM.$1.$1.$1.$1.$==0?(hN=[hM.$1.$1.$0,hM.$1.$0.$0,hM.$1.$1.$1.$0],2):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):hM.$1.$0.$==8?hM.$1.$1.$==1?hM.$1.$1.$1.$==0?hM.$1.$1.$0.$==0?(hN=[hM.$1.$0,hM.$1.$1.$0.$0,hM.$1.$1.$0.$1],7):(hN=[hM.$1,hM.$0],27):hM.$1.$1.$1.$0.$==5?hM.$1.$1.$1.$1.$==0?(hN=[hM.$1.$1.$0,hM.$1.$0,hM.$1.$1.$1.$0.$0,hM.$1.$1.$1.$0.$1],1):(hN=[hM.$1,hM.$0],27):hM.$1.$1.$1.$1.$==0?hM.$1.$1.$0.$==0?(hN=[hM.$1.$1.$0.$0,hM.$1.$0.$0,hM.$1.$1.$1.$0,hM.$1.$1.$0.$1],3):hM.$1.$1.$0.$==3?hM.$1.$1.$0.$0==="_ctx"?hM.$1.$1.$0.$1.$==1?hM.$1.$1.$0.$1.$0.$==8?hM.$1.$1.$0.$1.$1.$==1?hM.$1.$1.$0.$1.$1.$1.$==0?(hN=[hM.$1.$1.$0.$1.$0.$0.$0,hM.$1.$1.$0.$1.$1.$0,hM.$1.$0,hM.$1.$1.$1.$0],4):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):hM.$1.$1.$==1?hM.$1.$1.$1.$==0?hM.$1.$1.$0.$==0?(hN=[hM.$1.$0,hM.$1.$1.$0.$0,hM.$1.$1.$0.$1],7):(hN=[hM.$1,hM.$0],27):hM.$1.$1.$1.$0.$==5?hM.$1.$1.$1.$1.$==0?(hN=[hM.$1.$1.$0,hM.$1.$0,hM.$1.$1.$1.$0.$0,hM.$1.$1.$1.$0.$1],1):(hN=[hM.$1,hM.$0],27):hM.$1.$1.$1.$1.$==0?hM.$1.$1.$0.$==3?hM.$1.$1.$0.$0==="_ctx"?hM.$1.$1.$0.$1.$==1?hM.$1.$1.$0.$1.$0.$==8?hM.$1.$1.$0.$1.$1.$==1?hM.$1.$1.$0.$1.$1.$1.$==0?(hN=[hM.$1.$1.$0.$1.$0.$0.$0,hM.$1.$1.$0.$1.$1.$0,hM.$1.$0,hM.$1.$1.$1.$0],4):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):hM.$0==="length"?hM.$1.$==1?hM.$1.$1.$==1?hM.$1.$1.$1.$==0?(hN=[hM.$1.$0,hM.$1.$1.$0],5):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):hM.$0==="tscc"?hM.$1.$==1?hM.$1.$1.$==1?hM.$1.$1.$1.$==0?(hN=[hM.$1.$0,hM.$1.$1.$0],6):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):hM.$0==="scc"?hM.$1.$==1?hM.$1.$1.$==1?hM.$1.$1.$1.$==0?(hN=[hM.$1.$0,hM.$1.$1.$0],6):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):hM.$0==="<"?hM.$1.$==1?hM.$1.$1.$==1?hM.$1.$1.$1.$==0?(hN=[hM.$1.$0,hM.$1.$1.$0],8):9:9:9:hM.$0==="<="?hM.$1.$==1?hM.$1.$1.$==1?hM.$1.$1.$1.$==0?(hN=[hM.$1.$0,hM.$1.$1.$0],10):11:11:11:hM.$0===">"?hM.$1.$==1?hM.$1.$1.$==1?hM.$1.$1.$1.$==0?(hN=[hM.$1.$0,hM.$1.$1.$0],12):13:13:13:hM.$0===">="?hM.$1.$==1?hM.$1.$1.$==1?hM.$1.$1.$1.$==0?(hN=[hM.$1.$0,hM.$1.$1.$0],14):15:15:15:hM.$0==="="?hM.$1.$==1?hM.$1.$1.$==1?hM.$1.$1.$1.$==0?(hN=[hM.$1.$0,hM.$1.$1.$0],16):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):hM.$0==="member"?hM.$1.$==1?hM.$1.$1.$==1?hM.$1.$1.$1.$==0?(hN=[hM.$1.$0,hM.$1.$1.$0],17):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):hM.$0==="contains"?hM.$1.$==1?hM.$1.$1.$==1?hM.$1.$1.$1.$==0?(hN=[hM.$1.$0,hM.$1.$1.$0],18):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):hM.$0==="reverse"?hM.$1.$==1?hM.$1.$1.$==1?hM.$1.$1.$1.$==0?(hN=[hM.$1.$0,hM.$1.$1.$0],19):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):hM.$0==="append"?hM.$1.$==1?hM.$1.$1.$==1?hM.$1.$1.$1.$==1?hM.$1.$1.$1.$1.$==0?(hN=[hM.$1.$0,hM.$1.$1.$0,hM.$1.$1.$1.$0],20):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):hM.$0==="concat"?hM.$1.$==1?hM.$1.$1.$==1?hM.$1.$1.$1.$==0?(hN=[hM.$1.$0,hM.$1.$1.$0],21):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):hM.$0==="sort"?hM.$1.$==1?hM.$1.$1.$==1?hM.$1.$1.$1.$==0?(hN=[hM.$1.$0,hM.$1.$1.$0],22):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):hM.$0==="distinct"?hM.$1.$==1?hM.$1.$1.$==1?hM.$1.$1.$1.$==0?(hN=[hM.$1.$0,hM.$1.$1.$0],23):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):hM.$0==="difference"?hM.$1.$==1?hM.$1.$1.$==1?hM.$1.$1.$1.$==1?hM.$1.$1.$1.$1.$==0?(hN=[hM.$1.$0,hM.$1.$1.$0,hM.$1.$1.$1.$0],24):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):hM.$0==="intersection"?hM.$1.$==1?hM.$1.$1.$==1?hM.$1.$1.$1.$==1?hM.$1.$1.$1.$1.$==0?(hN=[hM.$1.$0,hM.$1.$1.$0,hM.$1.$1.$1.$0],25):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):hM.$0==="findAll"?hM.$1.$==1?hM.$1.$1.$==1?hM.$1.$1.$0.$==3?hM.$1.$1.$1.$==1?hM.$1.$1.$1.$0.$==0?hM.$1.$1.$1.$1.$==0?(hN=[hM.$1.$1.$0.$1,hM.$1.$1.$0.$0,hM.$1.$0,hM.$1.$1.$1.$0.$0,hM.$1.$1.$1.$0.$1],26):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27):(hN=[hM.$1,hM.$0],27)){case 0:hR=hN[0];hS=bX.choose(function(jH){return c2.Flatten(hK,jH);},hR);return hS.get_Length()!==hR.get_Length()?null:(hT=c4.Create$3([hN[1],hN[2]],{$:8,$0:(hU=hK.ComposeProcesses,co.fold(function(jH,jI){return(hU(jH))(jI);},b$.OfList(bY.Empty),hS))}),{$:1,$0:bX.ofArray([[hT,c4.Update(hJ,hT,hK),eu.get_OK(),ci.Create(new cg({$:0,$0:"is",$1:bY.Empty}))]])});case 1:hV=ca.FlattenList({$:5,$0:hN[2],$1:hN[3]});return hV.$==0?c0.resolveGoal(hI,hJ,hK,hL,new cg({$:0,$0:"is",$1:bX.ofArray([hN[1],hN[0],{$:4,$0:hV.$0}])})):null;case 2:hW=c2.Flatten(hK,{$:4,$0:hN[1]});return hW==null?null:c0.resolveGoal(hI,hJ,hK,hL,new cg({$:0,$0:"is",$1:bX.ofArray([{$:8,$0:hW.$0},hN[0],hN[2]])}));case 3:hX=hN[0];hY=hN[3];hZ=ca.FlattenList(hN[2]);return hZ.$==0?(h0=hZ.$0,h1=bX.choose(function(jH){return jH.$==9?{$:1,$0:jH.$0}:null;},h0),h1.get_Length()!==h0.get_Length()?null:(h2=c2.FindContexts(hN[1],h1,hK),h2!=null&&h2.$==1?{$:1,$0:bX.map(function(jH){return h3(jH[0],jH[1]);},bX.distinct(h2.$0))}:null)):null;case 4:h6=hN[1];h7=hN[2];h8=ca.FlattenList(hN[3]);if(h8.$==0){h9=h8.$0;switch(h6.$==0?h6.$0===-1?h6.$1==="_"?0:(h5=[h6.$0,h6.$1],1):(h5=[h6.$0,h6.$1],1):h6.$==4?(h5=h6.$0,2):3){case 0:h4={$:1,$0:bX.ofArray([[c4.get_id(),hJ,eu.get_OK(),ci.Create(new cg({$:0,$0:"is ctx",$1:bY.Empty}))]])};break;case 1:h4=(h_=h5[0],h$=h5[1],ia=bX.map(function(){return{$:0,$0:c0.freshID(hL),$1:"_X"};},h9),{$:1,$0:bX.ofArray([[c4.Create$3([h_,h$],{$:4,$0:ia}),hJ.Add$4(new fm({$:0,$0:[h_,h$]}),{$:4,$0:ia},hK),eu.get_OK(),ci.Create(new cg({$:0,$0:"is ctx",$1:bY.Empty}))]])});break;case 2:id=c2.Flatten(hK,{$:3,$0:"_ctx",$1:bX.ofArray([{$:8,$0:{$:0,$0:hN[0]}},{$:4,$0:h5},{$:4,$0:h9}])});if(id!=null&&id.$==1){ie=id.$0;switch(h7.$==0?h7.$0===-1?h7.$1==="_"?0:(ic=[h7.$0,h7.$1],1):(ic=[h7.$0,h7.$1],1):h7.$==8?(ic=h7.$0,2):3){case 0:ib={$:1,$0:bX.ofArray([[c4.get_id(),hJ,eu.get_OK(),ci.Create(new cg({$:0,$0:"is ctx",$1:bY.Empty}))]])};break;case 1:ib=(_if=ic[0],ig=ic[1],{$:1,$0:bX.ofArray([[c4.Create$3([_if,ig],{$:8,$0:ie}),hJ.Add$4(new fm({$:0,$0:[_if,ig]}),{$:8,$0:ie},hK),eu.get_OK(),ci.Create(new cg({$:0,$0:"is ctx",$1:bY.Empty}))]])});break;case 2:ib=cw.Equals(hK.toCanonicalFormProcess(ie),hK.toCanonicalFormProcess(ic))?{$:1,$0:bX.ofArray([[c4.get_id(),hJ,eu.get_OK(),ci.Create(new cg({$:0,$0:"is ctx",$1:bY.Empty}))]])}:null;break;case 3:ib=null;break;}}else ib=null;h4=ib;break;case 3:h4=null;break;}}else h4=null;return h4;case 5:ih=ca.FlattenList(hN[0]);return ih.$==1?null:(ii=(cV.unify(hK))(bX.ofArray([new cW({$:0,$0:{$:2,$0:ih.$0.get_Length()},$1:hN[1]})])),hO(hK,hJ,ci.Create(new cg({$:0,$0:"length",$1:bY.Empty})),ii));case 6:ij=hN[1];ik=ca.FlattenList(hN[0]);return ik.$==1?null:(il=co.fold(function(jH,jI){var jJ,jK,jL;return jH==null?null:jI.$==4&&(jI.$0.$==1&&(jI.$0.$0.$==8&&(jI.$0.$1.$==1&&(jI.$0.$1.$1.$==0&&(jJ=[jI.$0.$0.$0,jI.$0.$1.$0],true)))))?(jK=jJ[1],jK.$==4?(jL=co.fold(function(jM,jN){return jM!=null&&jM.$==1?jN.$==8?{$:1,$0:new bY({$:1,$0:jN.$0,$1:jM.$0})}:null:null;},{$:1,$0:bY.Empty},jK.$0),jL==null?null:{$:1,$0:new bY({$:1,$0:[jJ[0],jL.$0],$1:jH.$0})}):null):null;},{$:1,$0:bY.Empty},ik.$0),il!=null&&il.$==1?(im=il.$0,_in=bX.concat(bX.map(function(jH){return iC(jH[0],jH[1]);},im)),io=bX.distinct(bX.collect(function(jH){return iD(jH[0],jH[1]);},_in)),ip=bX.indexed(io),iq=bW.OfArray(ck.ofSeq(bX.map(function(jH){return iE(jH[0],jH[1]);},ip))),ir=bW.OfArray(ck.ofSeq(ip)),is=bW.OfArray(ck.ofSeq(bX.map(function(jH){return iF(jH[0],jH[1]);},ip))),it=bX.map(function(jH){return iG(jH[0],jH[1]);},_in),iu=bW.OfArray(ck.ofSeq(bX.collect(function(jH){return iH(jH[0],jH[1]);},bX.indexed(c0.tarjan(bX.map(function(jH){return is.get_Item(jH);},bX.distinct(bX.collect(function(jH){return iI(jH[0],jH[1]);},it))),it))))),iv=(iw=(ix=function(jH){return co.map(function(jI){return iJ(jI[0],jI[1]);},jH);},function(jH){return bX.ofSeq(ix(jH));}),function(jH){return iK(iw(jH));}),iy=co.groupBy(function(jH){return iu.get_Item(jH);},io),hM.get_Name()==="tscc"?(iz=bW.OfArray(ck.ofSeq(bX.map(function(jH){return iL(jH[0],jH[1]);},im))),iA=(cV.unify(hK))(bX.ofArray([new cW({$:0,$0:iv(co.filter(function(jH){return iM(jH[0],jH[1]);},iy)),$1:ij})])),hO(hK,hJ,ci.Create(new cg({$:0,$0:"tscc",$1:bY.Empty})),iA)):(iB=(cV.unify(hK))(bX.ofArray([new cW({$:0,$0:iv(iy),$1:ij})])),hO(hK,hJ,ci.Create(new cg({$:0,$0:"scc",$1:bY.Empty})),iB))):null);case 7:iN=hN[1];iO=hN[2];iP=c0["eval"](hK,hN[0]);return iP==null?null:(iQ=iP.$0,{$:1,$0:bX.ofArray([[c4.Create$3([iN,iO],{$:2,$0:iQ}),hJ.Add$4(new fm({$:0,$0:[iN,iO]}),{$:2,$0:iQ},hK),eu.get_OK(),ci.Create(new cg({$:0,$0:"is",$1:bY.Empty}))]])});case 8:iR=c0["eval"](hK,hN[0]);return iR==null?null:(iS=c0["eval"](hK,hN[1]),iS==null?null:iR.$0<iS.$0?{$:1,$0:bX.ofArray([[c4.get_id(),hJ,eu.get_OK(),ci.Create(new cg({$:0,$0:"<",$1:bY.Empty}))]])}:null);case 9:return be.FailWith((function(jH){return function(jI){return jH("unsupported arithmetic operation \\""+cA.toSafe(jI)+"\\"");};}(a.id))(hM.get_String()));case 10:iT=c0["eval"](hK,hN[0]);return iT==null?null:(iU=c0["eval"](hK,hN[1]),iU==null?null:iT.$0<=iU.$0?{$:1,$0:bX.ofArray([[c4.get_id(),hJ,eu.get_OK(),ci.Create(new cg({$:0,$0:"<=",$1:bY.Empty}))]])}:null);case 11:return be.FailWith((function(jH){return function(jI){return jH("unsupported arithmetic operation \\""+cA.toSafe(jI)+"\\"");};}(a.id))(hM.get_String()));case 12:iV=c0["eval"](hK,hN[0]);return iV==null?null:(iW=c0["eval"](hK,hN[1]),iW==null?null:iV.$0>iW.$0?{$:1,$0:bX.ofArray([[c4.get_id(),hJ,eu.get_OK(),ci.Create(new cg({$:0,$0:">",$1:bY.Empty}))]])}:null);case 13:return be.FailWith((function(jH){return function(jI){return jH("unsupported arithmetic operation \\""+cA.toSafe(jI)+"\\"");};}(a.id))(hM.get_String()));case 14:iX=c0["eval"](hK,hN[0]);return iX==null?null:(iY=c0["eval"](hK,hN[1]),iY==null?null:iX.$0>=iY.$0?{$:1,$0:bX.ofArray([[c4.get_id(),hJ,eu.get_OK(),ci.Create(new cg({$:0,$0:">=",$1:bY.Empty}))]])}:null);case 15:return be.FailWith((function(jH){return function(jI){return jH("unsupported arithmetic operation \\""+cA.toSafe(jI)+"\\"");};}(a.id))(hM.get_String()));case 16:iZ=(cV.unify(hK))(bX.ofArray([new cW({$:0,$0:hN[0],$1:hN[1]})]));return hO(hK,hJ,ci.Create(new cg({$:0,$0:"=",$1:bY.Empty})),iZ);case 17:i0=hN[0];i1=ca.FlattenList(hN[1]);return i1.$==0?{$:1,$0:bX.map(function(jH){return[c4.get_id(),hJ,bX.ofArray([new ch({$:0,$0:new cg({$:0,$0:"=",$1:bX.ofArray([i0,jH])})})]),ci.Create(new cg({$:0,$0:"member",$1:bY.Empty}))];},i1.$0)}:null;case 18:i2=ca.FlattenList(hN[1]);return i2.$==0?bX.contains(hN[0],i2.$0)?{$:1,$0:bX.ofArray([[c4.get_id(),hJ,eu.get_OK(),ci.Create(new cg({$:0,$0:"contains",$1:bY.Empty}))]])}:null:null;case 19:i3=ca.FlattenList(hN[0]);return i3.$==1?null:(i4=(cV.unify(hK))(bX.ofArray([new cW({$:0,$0:{$:4,$0:bX.rev(i3.$0)},$1:hN[1]})])),hO(hK,hJ,ci.Create(new cg({$:0,$0:"reverse",$1:bY.Empty})),i4));case 20:i5=ca.FlattenList(hN[0]);i6=ca.FlattenList(hN[1]);return i5.$==0&&(i6.$==0&&(i7=[i5.$0,i6.$0],true))?(i8=bX.append(i7[0],i7[1]),i9=(cV.unify(hK))(bX.ofArray([new cW({$:0,$0:{$:4,$0:i8},$1:hN[2]})])),hO(hK,hJ,ci.Create(new cg({$:0,$0:"append",$1:bY.Empty})),i9)):null;case 21:i_=hN[1];i$=ca.FlattenList(hN[0]);return i$.$==1?(ja=(cV.unify(hK))(bX.ofArray([new cW({$:0,$0:i_,$1:{$:5,$0:{$:4,$0:jc(i$.$0[0])},$1:i$.$0[1]}})])),hO(hK,hJ,ci.Create(new cg({$:0,$0:"concat",$1:bY.Empty})),ja)):(jb=(cV.unify(hK))(bX.ofArray([new cW({$:0,$0:i_,$1:{$:4,$0:jc(i$.$0)}})])),hO(hK,hJ,ci.Create(new cg({$:0,$0:"concat",$1:bY.Empty})),jb));case 22:jd=ca.FlattenList(hN[0]);return jd.$==1?null:(je=(cV.unify(hK))(bX.ofArray([new cW({$:0,$0:{$:4,$0:bX.sort(jd.$0)},$1:hN[1]})])),hO(hK,hJ,ci.Create(new cg({$:0,$0:"reverse",$1:bY.Empty})),je));case 23:jf=ca.FlattenList(hN[0]);return jf.$==1?null:(jg=(cV.unify(hK))(bX.ofArray([new cW({$:0,$0:{$:4,$0:bX.distinct(jf.$0)},$1:hN[1]})])),hO(hK,hJ,ci.Create(new cg({$:0,$0:"reverse",$1:bY.Empty})),jg));case 24:jh=ca.FlattenList(hN[0]);ji=ca.FlattenList(hN[1]);return jh.$==0&&(ji.$==0&&(jj=[jh.$0,ji.$0],true))?(jk=jj[1],jl=bX.filter(function(jH){return!bX.contains(jH,jk);},jj[0]),jm=(cV.unify(hK))(bX.ofArray([new cW({$:0,$0:{$:4,$0:jl},$1:hN[2]})])),hO(hK,hJ,ci.Create(new cg({$:0,$0:"reverse",$1:bY.Empty})),jm)):null;case 25:jn=ca.FlattenList(hN[0]);jo=ca.FlattenList(hN[1]);return jn.$==0&&(jo.$==0&&(jp=[jn.$0,jo.$0],true))?(jq=jp[1],jr=(js=co.fold(function(jH,jI){return(function(jJ){return jv(jJ[0],jJ[1]);}(jH))(jI);},[bY.Empty,c4.get_id()],jp[0]),[{$:4,$0:bX.map(function(jH){return hJ.Apply$9(jH,hK);},bX.rev(js[0]))},js[1]]),jt=jr[1],ju=(cV.unify(hK))(bX.ofArray([new cW({$:0,$0:hN[2],$1:jr[0]})])),ju.$==0?null:{$:1,$0:bX.map(function(jH){return[c4.Compose(jt,jH,hK),c4.Update(c4.Update(hJ,jt,hK),jH,hK),eu.get_OK(),ci.Create(new cg({$:0,$0:"intersection",$1:bY.Empty}))];},ju)}):null;case 26:jw=hN[2];jx=hN[3];jy=hN[4];jz=c0.resolveInner(bX.ofArray([eu.Create(bX.ofArray([new ch({$:0,$0:new cg({$:0,$0:hN[1],$1:hN[0]})})]),hK)]),hK,hL,hI,bY.Empty,ev.AllAnswers);return jz==null?(jA=(cV.unify(hK))(bX.ofArray([new cW({$:0,$0:{$:4,$0:bY.Empty},$1:{$:0,$0:jx,$1:jy}})])),hO(hK,hJ,ci.Create(new cg({$:0,$0:"reverse",$1:bY.Empty})),jA)):(jB={$:4,$0:bX.distinct(bX.map(function(jH){return jH.Apply$9(jw,hK);},jz.$0))},jC=(cV.unify(hK))(bX.ofArray([new cW({$:0,$0:jB,$1:{$:0,$0:jx,$1:jy}})])),hO(hK,hJ,ci.Create(new cg({$:0,$0:"reverse",$1:bY.Empty})),jC));case 27:jD=hN[0];jE=hN[1];jF=[jE,jD.get_Length()];return!hI.ContainsKey(jF)?null:(jG=bX.concat(bX.choose(function(jH){var jI,jJ,jK,jL,jM,jN;function jO(jR){return b8.cachedIdProvider(hL,jK,jR);}function jP(jR){return jR[0];}function jQ(jR,jS){return new cW({$:0,$0:jR,$1:jS});}jI=jH.head;jJ=jI.$1;return jI.$0===jE&&jJ.get_Length()===jD.get_Length()?(jK=b8.emptyIdCache(),jL=function(jR){return jP(jO(jR));},jM=bX.map(function(jR){return jQ(jR[0],jR[1]);},bX.zip(jD,bX.map(function(jR){return ca.refresh(hK,jL,jR);},jJ))),jN=(cV.unify(hK))(jM),jN.$==0?null:{$:1,$0:co.fold(function(jR,jS){function jT(jV){return ch.refresh(hK,jL,jV);}function jU(jV){return c0.applyG(hK,jS,jV);}return new bY({$:1,$0:[jS,c4.Update(hJ,jS,hK),bX.map(function(jV){return jU(jT(jV));},jH.body),jH],$1:jR});},bY.Empty,jN)}):null;},bX.ofSeq(hI.get_Item(jF)))),jG.$==0?null:{$:1,$0:jG});}else return{$:1,$0:bX.map(function(jH){return hP(jH[0],jH[1]);},hQ.$0)};};c0.applyP=function(hI,hJ,hK){return new cg({$:0,$0:hK.$0,$1:bX.map(function(hL){return hJ.Apply$9(hL,hI);},hK.$1)});};c0.applyL=function(hI,hJ,hK){return hK.$==1?new ch({$:1,$0:c0.applyP(hI,hJ,hK.$0)}):new ch({$:0,$0:c0.applyP(hI,hJ,hK.$0)});};c0.freshID=function(hI){var hJ;hJ=hI[0];hI[0]=hJ+1;return hJ;};c0.tarjan=function(hI,hJ){var hL,hM,hN,hO,hP,hQ,hR,hS;function hK(hT){var hU,hV,hW,hX,hY,hZ,h0,h1,h2,h3,h4,h5,h6,h7,h8,h9,h_,h$;hU=gy.New(ck.get(hO,hT).n,hL[0],hL[0],true);ck.set(hO,hT,hU);hL[0]=hL[0]+1;hM[0]=new bY({$:1,$0:hT,$1:hM[0]});hV=bX.filter(function(ia){return ia[0]===hT;},hJ);hW=df.Get(hV);try{while(hW.MoveNext()){hX=hW.Current();hY=hX[1];hZ=hX[0];ck.get(hO,hY).index===-1?(hK(hY),ck.set(hO,hZ,(h0=ck.get(hO,hZ),gy.New(h0.n,h0.index,(h1=ck.get(hO,hZ).lowlink,(h2=ck.get(hO,hY).lowlink,cw.Compare(h1,h2)===-1?h1:h2)),h0.onStack)))):ck.get(hO,hY).onStack?ck.set(hO,hZ,(h3=ck.get(hO,hZ),gy.New(h3.n,h3.index,(h4=ck.get(hO,hZ).lowlink,(h5=ck.get(hO,hY).index,cw.Compare(h4,h5)===-1?h4:h5)),h3.onStack))):void 0;}}finally{if(typeof hW=="object"&&"Dispose"in hW)hW.Dispose();}if(ck.get(hO,hT).lowlink===ck.get(hO,hT).index){h6=[bY.Empty];h7=[-1];while(h7[0]===-1||!cw.Equals(ck.get(hO,h7[0]),ck.get(hO,hT))){h8=(h9=hM[0],h9.$==0?be.FailWith("Unexpected error in SCC computation."):[h9.$0,h9.$1]);h_=h8[0];hM[0]=h8[1];ck.set(hO,h_,(h$=ck.get(hO,h_),gy.New(h$.n,h$.index,h$.lowlink,false)));h7[0]=h_;h6[0]=new bY({$:1,$0:h7[0],$1:h6[0]});}hN[0]=new bY({$:1,$0:h6[0],$1:hN[0]});}else void 0;}hL=[0];hM=[bY.Empty];hN=[bY.Empty];hO=ck.ofSeq(hI);hP=co.length(hI);hQ=bX.ofSeq(be.range(0,hP-1));hR=df.Get(hQ);try{while(hR.MoveNext()){hS=hR.Current();ck.get(hO,hS).index===-1?hK(hS):void 0;}}finally{if(typeof hR=="object"&&"Dispose"in hR)hR.Dispose();}return hN[0];};c0["eval"]=function(hI,hJ){var hK,hL,hM,hN,hO,hP,hQ,hR;function hS(hT,hU){return bX.append(hT,bX.ofArray([hU]));}return hJ.$==2?{$:1,$0:hJ.$0}:hJ.$==1?null:hJ.$==3?(hK=hJ.$1,(hL=hJ.$0,ca.IsExpression(hJ)?(hM=ca.ToExpression(hJ),{$:1,$0:br["eval"](function(){var hT;hT=br.to_string(function(hU){return ca.ToStringWith(hI,hU);},hM);return(function(hU){return function(hV){return hU("Cannot evaluate expression "+cA.toSafe(hV));};}(be.FailWith))(hT);},hM)}):hL==="length"?hK.$==1&&(hK.$0.$==4&&(hK.$1.$==0&&(hN=hK.$0.$0,true)))?{$:1,$0:hN.get_Length()}:null:(hO=(hP=(hB.Curried3(c0.optionMap2))(hS),co.fold(function(hT,hU){return(hP(hT))(hU);},{$:1,$0:bY.Empty},bX.map(function(hT){return c0["eval"](hI,hT);},hK))),hO!=null&&hO.$==1?(hQ=hO.$0,hL==="+"?{$:1,$0:co.sum(hQ)}:hL==="*"?{$:1,$0:co.fold(function(hT,hU){return hT*hU;},1,hQ)}:hL==="-"?hQ.$==1&&(hQ.$1.$==1&&(hQ.$1.$1.$==0&&(hR=[hQ.$0,hQ.$1.$0],true)))?{$:1,$0:hR[0]-hR[1]}:null:null):null))):hJ.$==4?null:hJ.$==5?null:hJ.$==9?null:hJ.$==8?null:hJ.$==7?null:hJ.$==6?null:null;};c0.applyG=function(hI,hJ,hK){return hK.$==1?new ch({$:1,$0:c0.applyP(hI,hJ,hK.$0)}):new ch({$:0,$0:c0.applyP(hI,hJ,hK.$0)});};c0.optionMap2=function(hI,hJ,hK){return hJ==null?null:hK==null?null:{$:1,$0:hI(hJ.$0,hK.$0)};};c2.Flatten=function(hI,hJ){function hK(hL){var hM,hN;switch(hL.$==8?(hM=hL.$0,0):hL.$==4?(hM=hL.$0,1):hL.$==3?hL.$0==="|"?(hM=hL.$1,1):hL.$0==="_ctx"?hL.$1.$==1?hL.$1.$0.$==3?hL.$1.$0.$0==="_ctx"?hL.$1.$0.$1.$==1?hL.$1.$0.$1.$0.$==8?hL.$1.$0.$1.$1.$==1?hL.$1.$0.$1.$1.$0.$==4?hL.$1.$0.$1.$1.$1.$==0?hL.$1.$1.$==1?hL.$1.$1.$0.$==4?hL.$1.$1.$1.$==0?(hM=[hL.$1.$0.$1.$1.$0.$0,hL.$1.$0.$1.$0.$0.$0,hL.$1.$1.$0.$0],2):3:3:3:3:3:3:3:3:3:hL.$1.$0.$==8?hL.$1.$1.$==1?hL.$1.$1.$0.$==4?hL.$1.$1.$1.$==1?hL.$1.$1.$1.$0.$==4?hL.$1.$1.$1.$1.$==0?(hM=[hL.$1.$1.$0.$0,hL.$1.$0.$0.$0,hL.$1.$1.$1.$0.$0],2):3:3:3:3:3:3:3:3:3){case 0:return{$:1,$0:hM};case 1:return co.fold(function(hO,hP){var hQ,hR;hQ=hK(hP);return hO!=null&&hO.$==1&&(hQ!=null&&hQ.$==1&&(hR=[hO.$0,hQ.$0],true))?{$:1,$0:(hI.ComposeProcesses(hR[0]))(hR[1])}:null;},{$:1,$0:b$.OfList(bY.Empty)},hM);case 2:hN=hM[1];return{$:1,$0:{$:0,$0:co.fold(function(hO,hP){var hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0,h1,h2,h3,h4,h5,h6,h7,h8,h9,h_,h$,ia,ib,ic,id,ie,_if,ig,ih,ii,ij,ik;function il(io){return bX.max(bX.map(function(ip){return ip[0];},bX.ofSeq(bW.ToSeq(io))))+1;}function im(io){var ip;ip=(bX.head(io))[1];return ip.$==0?ip.$0:be.FailWith("Unexpected error in context finding");}function _in(io){var ip;ip=(bX.head(io))[1];return ip.$==0?ip.$1:be.FailWith("Unexpected error in context finding");}hQ=hP[0];hR=hP[1];return hQ.$==0?be.FailWith((function(io){return function(ip){return io("Insufficiently instantiated variable \\""+cA.toSafe(ip)+"\\"");};}(a.id))(ca.ToString(hQ))):hQ.$==9?hQ.$0.$==2?(hS=im(hQ.$0.$0),hR.$==5?hO.Remove(hS):hR.$==2?hO.Add(hS,bX.map(function(io){return io[0];},hR.$0)):be.FailWith("Mismatching context hole substitution.")):hQ.$0.$==1?(hT=hQ.$0.$0,hU=im(hT),hV=_in(hT),hW=hV+hT.get_Length(),hR.$==1?hO.Add(hU,(hX=hO.get_Item(hU),hY=bX.map(function(io){return io[0];},hR.$0),bX.append(bX.ofSeq(co.take(hV,hX)),bX.append(hY,bX.skip(hW,hX))))):hR.$==0?(hZ=hO.get_Item(hU),h0=bX.append(bX.ofSeq(co.take(hV,hZ)),bX.map(function(io){return io[0];},hR.$0)),h1=bX.append(bX.map(function(io){return io[0];},hR.$1),bX.skip(hW,hZ)),h2=hO.Add(hU,h0),h2.Add(il(h2),h1)):be.FailWith("Mismatching context hole substitution.")):hQ.$0.$==0?(h3=hQ.$0.$0,h4=hQ.$0.$1,h5=im(h3),h6=im(h4),h7=_in(h3),h8=h4.get_Length(),hR.$==0?(h9=hO.get_Item(h5),h_=hO.get_Item(h6),h$=bX.append(bX.ofSeq(co.take(h7,h9)),bX.map(function(io){return io[0];},hR.$0)),ia=bX.append(bX.map(function(io){return io[0];},hR.$1),bX.ofSeq(co.take(h8,h_))),hO.Add(h5,h$).Add(h6,ia)):hR.$==1?(ib=hO.get_Item(h5),ic=hO.get_Item(h6),id=bX.append(bX.ofSeq(co.take(h7,ib)),bX.append(bX.map(function(io){return io[0];},hR.$0),bX.ofSeq(co.take(h8,ic)))),hO.Remove(h6).Add(h5,id)):be.FailWith("Mismatching context hole substitution.")):hQ.$0.$==3?(ie=hQ.$0.$0,_if=im(ie),ig=_in(ie),hR.$==3?hO.Add(_if,bX.append(bX.ofSeq(co.take(ig,hO.get_Item(_if))),bX.map(function(io){return io[0];},hR.$0))):be.FailWith("Mismatching context hole substitution.")):hQ.$0.$==4?(ih=hQ.$0.$0,ii=im(ih),hR.$==4?(ij=hO.get_Item(ii),ik=ih.get_Length(),hO.Add(ii,bX.append(bX.map(function(io){return io[0];},hR.$0),bX.skip(ik,ij)))):be.FailWith("Mismatching context hole substitution.")):hR.$==5?hO:hR.$==2?hO.Add(il(hO),bX.map(function(io){return io[0];},hR.$0)):be.FailWith("Mismatching context hole substitution."):be.FailWith((((hB.Curried3(function(io,ip,iq){return io("Unexpected term \\""+cA.toSafe(ip)+"\\" in process \\""+cA.toSafe(iq)+"\\"");}))(a.id))(ca.ToString(hQ)))(b$.ToString({$:0,$0:hN})));},hN,bX.zip(hM[0],bX.map(function(hO){return hO.$==9?hO.$0:be.FailWith("Unexpected term in context patterns.");},hM[2])))}};case 3:return null;}}return hK(hJ);};c2.FindContexts=function(hI,hJ,hK){var hL,hM;function hN(hO,hP){return[hO,{$:3,$0:"_ctx",$1:bX.ofArray([{$:8,$0:{$:0,$0:hL}},{$:4,$0:bX.map(function(hQ){return{$:9,$0:hO.Apply$4(hQ,hK)};},hP)}])}];}hL=hI.$0;hM=co.fold(function(hO,hP){var hQ,hR,hS,hT,hU;function hV(hX,hY){return[hX,hX.Apply$4(hY,hK)];}function hW(hX,hY){return[hX,bX.ofArray([hY])];}return hO!=null&&hO.$==1?(hQ=hO.$0,(hR=bY.Empty,(hS=new cK.New$1(c6.OfSeq(co.map(function(hX){return hV(hX[0],hX[1]);},bW.Fold(function(hX,hY,hZ){var h0,h1,h2,h3,h4,h5,h6,h7,h8,h9,h_,h$,ia,ib,ic,id,ie,_if;function ig(ii,ij){return bX.mapi(function(ik,il){return[il[0],{$:0,$0:hY,$1:ii+ik}];},ij);}function ih(ii,ij){return[ii,new b_({$:1,$0:ig(ij,h1)})];}h0=bX.mapi(function(ii,ij){return[ij,{$:0,$0:hY,$1:ii}];},hZ);return hP.$==1?(h1=hP.$0,(h2=c1.findAllMatches(hK,h0,h1),h2.get_IsEmpty()?hX:new cK.New$1(c6.OfSeq(co.append(hX,new cK.New$1(c6.OfSeq(co.map(function(ii){return ih(ii[0],ii[1]);},h2)))))))):hP.$==2?(h3=hP.$0,co.fold(function(ii,ij){return h3.get_Length()===h0.get_Length()?ii.Add([ij,ij.Apply$4(new b_({$:2,$0:ig(0,h3)}),hK)]):ii;},hX,c1.patternMatches(hK,h0,h3,c4.get_id()))):hP.$==4?(h4=hP.$0,co.fold(function(ii,ij){return ii.Add([ij,new b_({$:4,$0:ig(0,h4)})]);},hX,c1.patternMatches(hK,h0,h4,c4.get_id()))):hP.$==3?(h5=hP.$0,(h6=h0.get_Length()-h5.get_Length(),h6<0?hX:co.fold(function(ii,ij){return ii.Add([ij,new b_({$:3,$0:ig(h6,h5)})]);},hX,c1.patternMatches(hK,bX.skip(h6,h0),h5,c4.get_id())))):hP.$==0?(h7=hP.$0,(h8=hP.$1,(h9=h0.get_Length()-h7.get_Length(),(h_=h9<0?bY.Empty:c1.patternMatches(hK,bX.skip(h9,h0),h7,c4.get_id()),(h$=c1.patternMatches(hK,h0,h8,c4.get_id()),(ia=ig(h9,h7),(ib=ig(0,h8),(ic=new b_({$:0,$0:ia,$1:hR}),(id=new b_({$:0,$0:hR,$1:ib}),h_.$==0?h$.$==0?hX:new cK.New$1(c6.OfSeq(co.append(hX,new cK.New$1(c6.OfSeq(bX.map(function(ii){return[ii,id];},h$)))))):h$.$==0?new cK.New$1(c6.OfSeq(co.append(hX,new cK.New$1(c6.OfSeq(bX.map(function(ii){return[ii,ic];},h_)))))):(ie=new cK.New$1(c6.OfSeq(bX.map(function(ii){return[ii,ic];},h_))),(_if=new cK.New$1(c6.OfSeq(bX.map(function(ii){return[ii,id];},h$))),new cK.New$1(c6.OfSeq(co.append(new cK.New$1(c6.OfSeq(co.append(hX,ie))),_if)))))))))))))):hX.Add([c4.get_id(),b_.Nihil]);},new cK.New$1(null),hL)))),(hT=hP.$==0?co.fold(function(hX,hY){return co.fold(function(hZ,h0){var h1,h2,h3,h4,h5,h6,h7,h8,h9;function h_(h$){var ia;ia=(h$.get_Item(0))[1];return ia.$==0?ia.$0:be.FailWith("Unexpected error in context finding");}return hY[1].$==0&&(h0[1].$==0&&(h1=[hY[1].$1,h0[1].$1,hY[0],h0[0],hY[1].$0,h0[1].$0],true))?(h2=h1[4],(h3=h1[5],(h4=cw.Equals(h2,hR),(h5=cw.Equals(h3,hR),h4&&h5||!h4&&!h5?hZ:(h6=c4.TryMerge(h1[2],h1[3],hK),h6!=null&&h6.$==1?(h7=h4?[h3,h1[0]]:[h2,h1[1]],(h8=h7[0],(h9=h7[1],h_(h8)===h_(h9)?hZ:hZ.Add([h6.$0,new b_({$:0,$0:h8,$1:h9})])))):hZ))))):be.FailWith("Unexpected patterns in nicking pattern matching");},hX,hS.Remove(hY));},new cK.New$1(null),hS):hS,hT.get_IsEmpty()?null:(hU=hQ.get_IsEmpty()?new cK.New$1(c6.OfSeq(co.map(function(hX){return hW(hX[0],hX[1]);},hS))):co.fold(function(hX,hY){var hZ,h0;hZ=hY[0];h0=hY[1];return co.fold(function(h1,h2){var h3,h4;function h5(h7){return h3.Overlaps(h7);}function h6(h7){return!h7;}h3=h2[1];return bX.forAll(function(h7){return h6(h5(h7));},h0)?(h4=c4.TryMerge(hZ,h2[0],hK),h4==null?h1:h1.Add([h4.$0,bX.append(h0,bX.ofArray([h3]))])):h1;},hX,hT);},new cK.New$1(null),hQ),hU.get_IsEmpty()?null:{$:1,$0:hU}))))):null;},{$:1,$0:new cK.New$1(null)},hJ);return hM!=null&&hM.$==1?{$:1,$0:bX.map(function(hO){return hN(hO[0],hO[1]);},bX.ofSeq(hM.$0))}:null;};c4=c3.Substitution=hB.Class({Apply$1:function(hI,hJ){return hI.$==0?new ch({$:0,$0:this.Apply$2(hI.$0,hJ)}):new ch({$:1,$0:this.Apply$2(hI.$0,hJ)});},Apply$2:function(hI,hJ){var hK;hK=this;return new cg({$:0,$0:hI.$0,$1:bX.map(function(hL){return hK.Apply$9(hL,hJ);},hI.$1)});},Apply$9:function(hI,hJ){return c4.Apply(this,hI,hJ);},Add$4:function(hI,hJ,hK){return hI.$==0?c4.Compose(this,c4.Create$3(hI.$0,hJ),hK):be.FailWith((((hB.Curried3(function(hL,hM,hN){return hL("Substitution extension failed: cannot extend "+cA.toSafe(hM)+" with "+cA.toSafe(hN));}))(a.id))(this.String(hK)))(hI.get_String()));},Apply$3:function(hI,hJ){return[c4.Apply$5(this,hI[0],hJ),c4.Apply$3(this,hI[1])];},Add$1:function(hI,hJ,hK){return c4.Compose(this,hJ.$==1?c4.Create$2(hI,hJ.$0):hJ.$==2?c4.Create$1(hI,hJ.$0):hJ.$==3?c4.Create(hI,hJ.$0):c4.Create$3(hI,hJ.$0),hK);},Add$3:function(hI,hJ,hK){return hI.$==1?c4.Compose(this,c4.Create$2(hI.$0,hJ),hK):be.FailWith((((hB.Curried3(function(hL,hM,hN){return hL("Substitution extension failed: cannot extend "+cA.toSafe(hM)+" with "+cA.toSafe(hN));}))(a.id))(this.String(hK)))(hI.get_String()));},String:function(hI){function hJ(hK,hL){var hM;hM=hL.$==1?b9.ToString(hL.$0):hL.$==2?hI.toString(hL.$0):hL.$==3?hI.toStringTempVar(hL.$0):ca.ToStringWith(hI,hL.$0);return(((hB.Curried3(function(hN,hO,hP){return hN(cA.toSafe(hO)+" -> "+cA.toSafe(hP));}))(a.id))(b8.printVar(hK[0],hK[1])))(hM);}return cS.concat("; ",bX.map(function(hK){return hJ(hK[0],hK[1]);},bX.ofSeq(bW.ToSeq(this.$0))));},Apply$8:function(hI){return c4.Apply$3(this,hI);},Add:function(hI){return new c4({$:0,$0:c3.mapUnion(this.$0,hI.$0)});},Add$2:function(hI,hJ,hK){return c4.Compose(this,c4.Create(hI,hJ),hK);},Apply:function(hI,hJ){var hK;hK=this;return ci.Create$1(this.Apply$2(hI.head,hJ),bX.map(function(hL){return hK.Apply$1(hL,hJ);},hI.body));},Apply$5:function(hI,hJ){return hI.$==1?{$:1,$0:this.Apply$8(hI.$0)}:hI.$==2?{$:2,$0:this.Apply$7(hI.$0,hJ)}:hI.$==3?{$:3,$0:this.Apply$6(hI.$0,hJ)}:{$:0,$0:this.Apply$9(hI.$0,hJ)};},Apply$4:function(hI,hJ){return c4.Apply$1(this,hI,hJ);},Apply$7:function(hI,hJ){return c4.Apply$5(this,hI,hJ);},Apply$6:function(hI,hJ){return c4.Apply$4(this,hI,hJ);}},null,c4);c4.get_id=function(){return new c4({$:0,$0:new cj.New([])});};c4.TryMerge=function(hI,hJ,hK){return bW.Fold(function(hL,hM,hN){var hO,hP;return hL!=null&&hL.$==1?(hO=hL.$0.$0,(hP=hO.TryFind(hM),hP==null?{$:1,$0:(new c4({$:0,$0:hO})).Add$1(hM,hN,hK)}:cw.Equals(hN,hP.$0)?{$:1,$0:new c4({$:0,$0:hO})}:null)):null;},{$:1,$0:new c4({$:0,$0:hI.$0})},hJ.$0);};c4.Compose=function(hI,hJ,hK){var hL;hL=hJ.$0;return(new c4({$:0,$0:bW.Map(function(hM,hN){return hN.$==1?{$:1,$0:(new c4({$:0,$0:hL})).Apply$8(hN.$0)}:hN.$==2?{$:2,$0:(hK.applySub(hL))(hN.$0)}:hN.$==3?{$:3,$0:(hK.applySubVar(hL))(hN.$0)}:{$:0,$0:(new c4({$:0,$0:hL})).Apply$9(hN.$0,hK)};},hI.$0)})).Add(new c4({$:0,$0:hL}));};c4.Apply=function(hI,hJ,hK){var hL,hM,hN,hO;hM=hI.$0;hN=new c4({$:0,$0:hM});function hP(hQ,hR){return[hQ,hN.Apply$9(hR,hK)];}switch(hJ.$==1?2:hJ.$==2?3:hJ.$==3?(hL=[hJ.$0,hJ.$1],4):hJ.$==4?(hL=hJ.$0,5):hJ.$==5?(hL=[hJ.$0,hJ.$1],6):hJ.$==9?(hL=hJ.$0,7):hJ.$==8?(hL=hJ.$0,8):hJ.$==6?(hL=hJ.$0,9):hJ.$==7?(hL=hJ.$0,10):hJ.$0===-1?hJ.$1==="_"?0:(hL=[hJ.$0,hJ.$1],1):(hL=[hJ.$0,hJ.$1],1)){case 0:return hJ;case 1:hO=hM.TryFind([hL[0],hL[1]]);return hO==null?hJ:hO.$0.$==1?{$:9,$0:new b_({$:1,$0:bX.ofArray([[hK.underscore(),hO.$0.$0]])})}:hO.$0.$==2?{$:9,$0:new b_({$:1,$0:bX.ofArray([[(hK.applyAll(hM))({$:0,$0:hO.$0.$0}),{$:1,$0:[-1,"_"]}]])})}:hO.$0.$==3?{$:9,$0:new b_({$:1,$0:bX.ofArray([[hK.cast((hK.applySubVar(hM))(hO.$0.$0)),{$:1,$0:[-1,"_"]}]])})}:hO.$0.$0;case 2:return hJ;case 3:return hJ;case 4:return{$:3,$0:hL[0],$1:bX.map(function(hQ){return hN.Apply$9(hQ,hK);},hL[1])};case 5:return{$:4,$0:bX.map(function(hQ){return hN.Apply$9(hQ,hK);},hL)};case 6:return{$:5,$0:hN.Apply$9(hL[0],hK),$1:hN.Apply$9(hL[1],hK)};case 7:return{$:9,$0:c4.Apply$1(hN,hL,hK)};case 8:return{$:8,$0:b$.Map(function(hQ){return c4.Apply$5(hN,hQ,hK);},hL)};case 9:return{$:6,$0:bX.distinct(bX.map(function(hQ){return hN.Apply$9(hQ,hK);},hL))};case 10:return{$:7,$0:bX.map(function(hQ){return hP(hQ[0],hQ[1]);},hL)};}};c4.Create$3=function(hI,hJ){return new c4({$:0,$0:bW.OfArray(ck.ofSeq(bX.ofArray([[hI,{$:0,$0:hJ}]])))});};c4.Apply$5=function(hI,hJ,hK){return(hK.applyAll(hI.$0))({$:0,$0:hJ});};c4.Apply$3=function(hI,hJ){var hK,hL;switch(hJ.$==0?2:hJ.$0[0]===-1?hJ.$0[1]==="_"?0:(hK=hJ.$0,1):(hK=hJ.$0,1)){case 0:return{$:1,$0:[-1,"_"]};case 1:hL=hI.$0.TryFind(hK);return hL==null?hJ:hL.$0.$==0?hJ:hL.$0.$==2?hJ:hL.$0.$==3?hJ:hL.$0.$0;case 2:return hJ;}};c4.Update=function(hI,hJ,hK){return new c4({$:0,$0:bW.Map(function(hL,hM){return hJ.Apply$5(hM,hK);},hI.$0)});};c4.Create$2=function(hI,hJ){return new c4({$:0,$0:bW.OfArray(ck.ofSeq(bX.ofArray([[hI,{$:1,$0:hJ}]])))});};c4.Create$1=function(hI,hJ){return new c4({$:0,$0:bW.OfArray(ck.ofSeq(bX.ofArray([[hI,{$:2,$0:hJ}]])))});};c4.Create=function(hI,hJ){return new c4({$:0,$0:bW.OfArray(ck.ofSeq(bX.ofArray([[hI,{$:3,$0:hJ}]])))});};c4.Apply$1=function(hI,hJ,hK){var hL;function hM(hN,hO){return[(hK.applyAll(hL))({$:0,$0:hN}),c4.Apply$3(new c4({$:0,$0:hL}),hO)];}hL=hI.$0;return b_.Map(function(hN){return hM(hN[0],hN[1]);},hJ);};c4.Apply$4=function(hI,hJ,hK){return(hK.applySubVar(hI.$0))(hJ);};c5.Filter=function(hI,hJ){var hK;return new cK.New$1((hK=ck.ofSeq(co.filter(hI,hJ)),c6.Build(hK,0,hK.length-1)));};c7.New=function(hI,hJ,hK,hL,hM){return{Node:hI,Left:hJ,Right:hK,Height:hL,Count:hM};};c8=bV.Pair=hB.Class({Equals:function(hI){return cw.Equals(this.Key,hI.Key);},GetHashCode:function(){return cw.Hash(this.Key);},CompareTo0:function(hI){return cw.Compare(this.Key,hI.Key);}},null,c8);c8.New=function(hI,hJ){return new c8({Key:hI,Value:hJ});};c_.NewFromSeq=function(hI){var hJ,hK,hL;hJ={};hK=df.Get(hI);try{while(hK.MoveNext()){hL=hK.Current();hJ[hL[0]]=hL[1];}}finally{if(typeof hK=="object"&&"Dispose"in hK)hK.Dispose();}return hJ;};c$.GetFieldValues=function(hI){var hJ,hK;hJ=[];for(var hL in hI)hJ.push(hI[hL]);return hJ;};c$.GetFields=function(hI){var hJ,hK;hJ=[];for(var hL in hI)hJ.push([hL,hI[hL]]);return hJ;};ck.get=function(hI,hJ){ck.checkBounds(hI,hJ);return hI[hJ];};ck.set=function(hI,hJ,hK){ck.checkBounds(hI,hJ);hI[hJ]=hK;};ck.length=function(hI){return hI.dims===2?hI.length*hI.length:hI.length;};ck.checkBounds=function(hI,hJ){if(hJ<0||hJ>=hI.length)be.FailWith("Index was outside the bounds of the array.");};ck.sub=function(hI,hJ,hK){ck.checkRange(hI,hJ,hK);return hI.slice(hJ,hJ+hK);};ck.checkRange=function(hI,hJ,hK){if(hK<0||hJ<0||hI.length<hJ+hK)be.FailWith("Index was outside the bounds of the array.");};ck.set2D=function(hI,hJ,hK,hL){ck.checkBounds2D(hI,hJ,hK);hI[hJ][hK]=hL;};ck.zeroCreate2D=function(hI,hJ){var hK;hK=ck.init(hI,function(){return ck.create(hJ,null);});hK.dims=2;return hK;};ck.checkBounds2D=function(hI,hJ,hK){if(hJ<0||hK<0||hJ>=hI.length||hK>=(hI.length?hI[0].length:0))throw new he.New();};ck.get2D=function(hI,hJ,hK){ck.checkBounds2D(hI,hJ,hK);return hI[hJ][hK];};dc=cR.Exception=hB.Class({},db,dc);dc.New=hB.Ctor(function(hI,hJ){this.message=hI;da.setPrototypeOf(this,dc.prototype);this.errors=hJ;},dc);dd.New=function(hI,hJ,hK){return{row:hI,column:hJ,text:hK};};de.to_xml=function(hI){var hJ;hJ=ez.init(de.preamble());de.xml_of_model(hJ,1,hI);ez.append(hJ,de.postamble());return ez.value(hJ);};de.preamble=function(){fr.$cctor();return fr.preamble;};de.xml_of_model=function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ;ez.append(hI,de.tagopen(hJ,"model",bX.ofArray([["id",de.oMap(de.string_of_SId,hK.id)],["name",de.oMap(de.string_of_SBMLString,hK.name)]])));ez.append(hI,de.newline());de.xml_of_elmtlist(hI,hJ+1,(hL=hJ+2,function(hR){de.xml_of_unitDefinition(hI,hL,hR);}),"listOfUnitDefinitions",hK.listOfUnitDefinitions);de.xml_of_elmtlist(hI,hJ+1,(hM=hJ+2,function(hR){de.xml_of_compartment(hI,hM,hR);}),"listOfCompartments",hK.listOfCompartments);de.xml_of_elmtlist(hI,hJ+1,(hN=hJ+2,function(hR){de.xml_of_species(hI,hN,hR);}),"listOfSpecies",hK.listOfSpecies);de.xml_of_elmtlist(hI,hJ+1,(hO=hJ+2,function(hR){de.xml_of_parameter(hI,hO,hR);}),"listOfParameters",hK.listOfParameters);de.xml_of_elmtlist(hI,hJ+1,(hP=hJ+2,function(hR){de.xml_of_initialAssignment(hI,hP,hR);}),"listOfInitialAssignments",hK.listOfInitialAssignments);de.xml_of_elmtlist(hI,hJ+1,(hQ=hJ+2,function(hR){de.xml_of_reaction(hI,hQ,hR);}),"listOfReactions",hK.listOfReactions);ez.append(hI,de.tagclose(hJ,"model"));ez.append(hI,de.newline());};de.postamble=function(){fr.$cctor();return fr.postamble;};de.tagopen=function(hI,hJ,hK){return de.indent(hI,"<"+hJ+de.string_of_params(hK)+">");};de.oMap=function(hI,hJ){return hJ!=null&&hJ.$==1?{$:1,$0:hI(hJ.$0)}:null;};de.string_of_SId=function(hI){return hI.$0;};de.string_of_SBMLString=function(hI){return hI.$0;};de.newline=function(){fr.$cctor();return fr.newline;};de.xml_of_elmtlist=function(hI,hJ,hK,hL,hM){if(hM.$==0);else{ez.append(hI,de.tagopen(hJ,hL,bY.Empty));ez.append(hI,de.newline());bX.iter(function(hN){hK(hN);ez.append(hI,de.newline());},hM);ez.append(hI,de.tagclose(hJ,hL));ez.append(hI,de.newline());}};de.xml_of_unitDefinition=function(hI,hJ,hK){var hL;ez.append(hI,de.tagopen(hJ,"unitDefinition",bX.ofArray([["id",{$:1,$0:de.string_of_UnitSId(hK.id)}],["name",de.oMap(de.string_of_SBMLString,hK.name)]])));ez.append(hI,de.newline());de.xml_of_elmtlist(hI,hJ+1,(hL=hJ+2,function(hM){de.xml_of_sbmlUnit(hI,hL,hM);}),"listOfUnits",hK.listOfUnits);ez.append(hI,de.tagclose(hJ,"unitDefinition"));};de.xml_of_compartment=function(hI,hJ,hK){ez.append(hI,de.tagsingle(hJ,"compartment",bX.ofArray([["id",{$:1,$0:de.string_of_SId(hK.id)}],["name",de.oMap(de.string_of_SBMLString,hK.name)],["compartmentType",de.oMap(de.string_of_SId,hK.compartmentType)],["spatialDimensions",de.oMap(a.String,hK.spatialDimensions)],["size",de.oMap(a.String,hK.size)],["units",de.oMap(de.string_of_UnitSId,hK.units)],["outside",de.oMap(de.string_of_SId,hK.outside)],["constant",de.oMap(de.string_of_bool,hK.constant)]])));};de.xml_of_species=function(hI,hJ,hK){ez.append(hI,de.tagsingle(hJ,"species",bX.ofArray([["id",{$:1,$0:de.string_of_SId(hK.id)}],["name",de.oMap(de.string_of_SBMLString,hK.name)],["speciesType",de.oMap(de.string_of_SId,hK.speciesType)],["compartment",{$:1,$0:de.string_of_SId(hK.compartment)}],["initialAmount",de.oMap(a.String,hK.initialAmount)],["initialConcentration",de.oMap(a.String,hK.initialConcentration)],["substanceUnits",de.oMap(de.string_of_UnitSId,hK.substanceUnits)],["hasOnlySubstanceUnits",de.oMap(de.string_of_bool,hK.hasOnlySubstanceUnits)],["boundaryCondition",de.oMap(de.string_of_bool,hK.boundaryCondition)],["charge",de.oMap(a.String,hK.charge)],["constant",de.oMap(de.string_of_bool,hK.constant)]])));};de.xml_of_parameter=function(hI,hJ,hK){ez.append(hI,de.tagsingle(hJ,"parameter",bX.ofArray([["id",{$:1,$0:de.string_of_SId(hK.id)}],["name",de.oMap(de.string_of_SBMLString,hK.name)],["value",de.oMap(a.String,hK.value)],["units",de.oMap(de.string_of_UnitSId,hK.units)],["constant",de.oMap(de.string_of_bool,hK.constant)]])));};de.xml_of_initialAssignment=function(hI,hJ,hK){ez.append(hI,de.tagopen(hJ,"initialAssignment",bX.ofArray([["symbol",{$:1,$0:de.string_of_SId(hK.symbol)}]])));ez.append(hI,de.newline());de.xml_of_MathML(hI,hJ+1,hK.math);ez.append(hI,de.newline());ez.append(hI,de.tagclose(hJ,"initialAssignment"));};de.xml_of_reaction=function(hI,hJ,hK){var hL,hM,hN;ez.append(hI,de.tagopen(hJ,"reaction",bX.ofArray([["id",{$:1,$0:de.string_of_SId(hK.id)}],["name",de.oMap(de.string_of_SBMLString,hK.name)],["reversible",de.oMap(de.string_of_bool,hK.reversible)],["fast",de.oMap(de.string_of_bool,hK.fast)]])));ez.append(hI,de.newline());de.xml_of_elmtlist(hI,hJ+1,(hL=hJ+2,function(hO){de.xml_of_speciesReference(hI,hL,hO);}),"listOfReactants",hK.listOfReactants);de.xml_of_elmtlist(hI,hJ+1,(hM=hJ+2,function(hO){de.xml_of_speciesReference(hI,hM,hO);}),"listOfProducts",hK.listOfProducts);hN=hK.kineticLaw;hN!=null&&hN.$==1?(de.xml_of_kineticLaw(hI,hJ+1,hN.$0),ez.append(hI,de.newline())):void 0;ez.append(hI,de.tagclose(hJ,"reaction"));};de.tagclose=function(hI,hJ){return de.indent(hI,"</"+hJ+">");};de.mkSId=function(hI){de.testId(hI);return{$:0,$0:hI};};de.mkString=function(hI){return{$:0,$0:de.stringMap(function(hJ){return hJ==="<"?de.openAngle():hJ===">"?de.closeAngle():hJ;},hI)};};de.mkUnitSId=function(hI){de.testId(hI);return{$:0,$0:hI};};de.create_sbmlUnit=function(hI){return gG.New(hI,null,null,null,null);};de.u_set_scale=function(hI,hJ){return gG.New(hJ.kind,hJ.exponent,{$:1,$0:hI},hJ.multiplier,hJ.offset);};de.create_parameter=function(hI){return gD.New(hI,null,null,null,null);};de.p_set_value=function(hI,hJ){return gD.New(hJ.id,hJ.name,{$:1,$0:hI},hJ.units,hJ.constant);};de.p_set_units=function(hI,hJ){return gD.New(hJ.id,hJ.name,hJ.value,{$:1,$0:hI},hJ.constant);};de.create_speciesReference=function(hI){return gH.New(null,null,hI,null);};de.sr_set_stoichiometry=function(hI,hJ){return gH.New(hJ.id,hJ.name,hJ.species,{$:1,$0:hI});};de.empty_model=function(){fr.$cctor();return fr.empty_model;};de.model_add_compartment=function(hI,hJ){return fs.New(hJ.id,hJ.name,hJ.listOfUnitDefinitions,bX.append(hJ.listOfCompartments,bX.ofArray([hI])),hJ.listOfSpecies,hJ.listOfParameters,hJ.listOfInitialAssignments,hJ.listOfReactions);};de.model_set_species=function(hI,hJ){return fs.New(hJ.id,hJ.name,hJ.listOfUnitDefinitions,hJ.listOfCompartments,hI,hJ.listOfParameters,hJ.listOfInitialAssignments,hJ.listOfReactions);};de.model_set_reactions=function(hI,hJ){return fs.New(hJ.id,hJ.name,hJ.listOfUnitDefinitions,hJ.listOfCompartments,hJ.listOfSpecies,hJ.listOfParameters,hJ.listOfInitialAssignments,hI);};de.create_reaction=function(hI){return gF.New(hI,null,null,null,bY.Empty,bY.Empty,null);};de.r_set_reactants=function(hI,hJ){return gF.New(hJ.id,hJ.name,hJ.reversible,hJ.fast,hI,hJ.listOfProducts,hJ.kineticLaw);};de.r_set_products=function(hI,hJ){return gF.New(hJ.id,hJ.name,hJ.reversible,hJ.fast,hJ.listOfReactants,hI,hJ.kineticLaw);};de.r_set_reversible=function(hI,hJ){return gF.New(hJ.id,hJ.name,{$:1,$0:hI},hJ.fast,hJ.listOfReactants,hJ.listOfProducts,hJ.kineticLaw);};de.r_set_kineticLaw=function(hI,hJ){return gF.New(hJ.id,hJ.name,hJ.reversible,hJ.fast,hJ.listOfReactants,hJ.listOfProducts,{$:1,$0:hI});};de.create_kineticLaw=function(hI){return gI.New(hI,bY.Empty);};de.kl_add_parameter=function(hI,hJ){return gI.New(hJ.math,bX.append(hJ.listOfParameters,bX.ofArray([hI])));};de.create_species=function(hI,hJ){return gC.New(hI,null,null,hJ,null,null,null,null,null,null,null);};de.sp_set_name=function(hI,hJ){return gC.New(hJ.id,{$:1,$0:hI},hJ.speciesType,hJ.compartment,hJ.initialAmount,hJ.initialConcentration,hJ.substanceUnits,hJ.hasOnlySubstanceUnits,hJ.boundaryCondition,hJ.charge,hJ.constant);};de.sp_set_initialConcentration=function(hI,hJ){return gC.New(hJ.id,hJ.name,hJ.speciesType,hJ.compartment,hJ.initialAmount,{$:1,$0:hI},hJ.substanceUnits,hJ.hasOnlySubstanceUnits,hJ.boundaryCondition,hJ.charge,hJ.constant);};de.sp_set_constant=function(hI,hJ){return gC.New(hJ.id,hJ.name,hJ.speciesType,hJ.compartment,hJ.initialAmount,hJ.initialConcentration,hJ.substanceUnits,hJ.hasOnlySubstanceUnits,hJ.boundaryCondition,hJ.charge,{$:1,$0:hI});};de.sp_set_boundaryCondition=function(hI,hJ){return gC.New(hJ.id,hJ.name,hJ.speciesType,hJ.compartment,hJ.initialAmount,hJ.initialConcentration,hJ.substanceUnits,hJ.hasOnlySubstanceUnits,{$:1,$0:hI},hJ.charge,hJ.constant);};de.model_add_initialAssignment=function(hI,hJ){return fs.New(hJ.id,hJ.name,hJ.listOfUnitDefinitions,hJ.listOfCompartments,hJ.listOfSpecies,hJ.listOfParameters,bX.append(hJ.listOfInitialAssignments,bX.ofArray([hI])),hJ.listOfReactions);};de.create_initialAssignment=function(hI,hJ){return gE.New(hI,hJ);};de.model_add_parameter=function(hI,hJ){return fs.New(hJ.id,hJ.name,hJ.listOfUnitDefinitions,hJ.listOfCompartments,hJ.listOfSpecies,bX.append(hJ.listOfParameters,bX.ofArray([hI])),hJ.listOfInitialAssignments,hJ.listOfReactions);};de.create_compartment=function(hI){return gB.New(hI,null,null,null,null,null,null,null);};de.cmt_set_size=function(hI,hJ){return gB.New(hJ.id,hJ.name,hJ.compartmentType,hJ.spatialDimensions,{$:1,$0:hI},hJ.units,hJ.outside,hJ.constant);};de.model_add_unitDefinition=function(hI,hJ){return fs.New(hJ.id,hJ.name,bX.append(hJ.listOfUnitDefinitions,bX.ofArray([hI])),hJ.listOfCompartments,hJ.listOfSpecies,hJ.listOfParameters,hJ.listOfInitialAssignments,hJ.listOfReactions);};de.create_unitDefinition=function(hI,hJ){return gA.New(hI,null,hJ);};de.u_set_exponent=function(hI,hJ){return gG.New(hJ.kind,{$:1,$0:hI},hJ.scale,hJ.multiplier,hJ.offset);};de.u_set_multiplier=function(hI,hJ){return gG.New(hJ.kind,hJ.exponent,hJ.scale,{$:1,$0:hI},hJ.offset);};de.space=function(){fr.$cctor();return fr.space;};de.xmltag=function(hI){return"<?xml"+de.string_of_params(hI)+"?>";};de.indent=function(hI,hJ){function hK(hL){return hL===0?hJ:de.indent_string()+hK(hL-1);}return hI<0?be.FailWith("Sbml.indent: negative indentation"):hK(hI);};de.string_of_params=function(hI){function hJ(hK,hL){return hL!=null&&hL.$==1?de.space()+hK+de.equals()+de.quote(hL.$0):de.empty();}return hI.$==0?de.empty():bX.reduce(function(hK,hL){return hK+de.empty()+hL;},bX.map(function(hK){return hJ(hK[0],hK[1]);},hI));};de.string_of_UnitSId=function(hI){return hI.$0;};de.xml_of_sbmlUnit=function(hI,hJ,hK){ez.append(hI,de.tagsingle(hJ,"unit",bX.ofArray([["kind",{$:1,$0:de.string_of_unitKind(hK.kind)}],["exponent",de.oMap(a.String,hK.exponent)],["scale",de.oMap(a.String,hK.scale)],["multiplier",de.oMap(a.String,hK.multiplier)],["offset",de.oMap(a.String,hK.offset)]])));};de.tagsingle=function(hI,hJ,hK){return de.indent(hI,"<"+hJ+de.string_of_params(hK)+"/>");};de.string_of_bool=function(hI){return hI?"true":"false";};de.xml_of_MathML=function(hI,hJ,hK){ez.append(hI,de.tagopen(hJ,"math",bX.ofArray([["xmlns",{$:1,$0:"http://www.w3.org/1998/Math/MathML"}]])));ez.append(hI,de.newline());de.xml_of_mathExpr(hI,hJ+1,hK);ez.append(hI,de.newline());ez.append(hI,de.tagclose(hJ,"math"));};de.xml_of_speciesReference=function(hI,hJ,hK){ez.append(hI,de.tagsingle(hJ,"speciesReference",bX.ofArray([["id",de.oMap(de.string_of_SId,hK.id)],["name",de.oMap(de.string_of_SBMLString,hK.name)],["species",{$:1,$0:de.string_of_SId(hK.species)}],["stoichiometry",de.oMap(a.String,hK.stoichiometry)]])));};de.xml_of_kineticLaw=function(hI,hJ,hK){var hL;ez.append(hI,de.tagopen(hJ,"kineticLaw",bY.Empty));ez.append(hI,de.newline());de.xml_of_MathML(hI,hJ+1,hK.math);ez.append(hI,de.newline());de.xml_of_elmtlist(hI,hJ+1,(hL=hJ+2,function(hM){de.xml_of_parameter(hI,hL,hM);}),"listOfParameters",hK.listOfParameters);ez.append(hI,de.tagclose(hJ,"kineticLaw"));};de.testId=function(hI){de.stringIteri(function(hJ,hK){if(hJ===0){if(!(de.isLetter(hK)||de.isUnderscore(hK)))throw g8.New(hI);else return null;}else if(!(de.isLetter(hK)||de.isUnderscore(hK)||de.isDigit(hK)))throw g8.New(hI);else return null;},hI);};de.stringMap=function(hI,hJ){var hK;hK=[""];cS.iter(function(hL){hK[0]=hK[0]+hI(hL);},hJ);return hK[0];};de.openAngle=function(){fr.$cctor();return fr.openAngle;};de.closeAngle=function(){fr.$cctor();return fr.closeAngle;};de.indent_string=function(){fr.$cctor();return fr.indent_string;};de.empty=function(){fr.$cctor();return fr.empty;};de.equals=function(){fr.$cctor();return fr.equals;};de.quote=function(hI){return de.quotemark()+hI+de.quotemark();};de.string_of_unitKind=function(hI){return hI.$==1?"becqerel":hI.$==2?"candela":hI.$==3?"coulomb":hI.$==4?"dimensionless":hI.$==5?"farad":hI.$==6?"gram":hI.$==7?"gray":hI.$==8?"henry":hI.$==9?"hertz":hI.$==10?"item":hI.$==11?"joule":hI.$==12?"katal":hI.$==13?"kelvin":hI.$==14?"kilogram":hI.$==15?"litre":hI.$==16?"lumen":hI.$==17?"lux":hI.$==18?"metre":hI.$==19?"mole":hI.$==20?"newton":hI.$==21?"ohm":hI.$==22?"pascal":hI.$==23?"radian":hI.$==24?"second":hI.$==25?"siemens":hI.$==26?"sievert":hI.$==27?"steradians":hI.$==28?"tesla":hI.$==29?"volt":hI.$==30?"watt":hI.$==31?"weber":"ampere";};de.xml_of_mathExpr=function(hI,hJ,hK){var hL,hM,hN,hO;if(hK.$==1){ez.append(hI,de.tagopen(hJ,"apply",bY.Empty));ez.append(hI,de.newline());ez.append(hI,de.tagsimple(hJ+1,de.string_of_bOp(hK.$0)));ez.append(hI,de.newline());de.xml_of_mathExpr(hI,hJ+1,hK.$1);ez.append(hI,de.newline());de.xml_of_mathExpr(hI,hJ+1,hK.$2);ez.append(hI,de.newline());ez.append(hI,de.tagclose(hJ,"apply"));}else if(hK.$==2){ez.append(hI,de.tagopen(hJ,"apply",bY.Empty));ez.append(hI,de.newline());ez.append(hI,de.tagsimple(hJ+1,de.string_of_nOp(hK.$0)));ez.append(hI,de.newline());bX.iter(function(hP){de.xml_of_mathExpr(hI,hJ+1,hP);ez.append(hI,de.newline());},hK.$1);ez.append(hI,de.tagclose(hJ,"apply"));}else if(hK.$==3){hL=hK.$1;hM=hK.$0;hN=hL!=null&&hL.$==1?bX.ofArray([["units",{$:1,$0:de.string_of_UnitSId(hL.$0)}]]):bY.Empty;hM.$==1?(ez.append(hI,de.tagopen(hJ,"cn",new bY({$:1,$0:["type",{$:1,$0:"real"}],$1:hN}))),ez.append(hI,a.String(hM.$0)),ez.append(hI,de.tagclose(0,"cn"))):hM.$==2?ez.append(hI,de.tagsimple(hJ,de.string_of_bool(hM.$0))):hM.$==3?ez.append(hI,de.tagsimple(hJ,"notanumber")):hM.$==4?ez.append(hI,de.tagsimple(hJ,"pi")):hM.$==5?ez.append(hI,de.tagsimple(hJ,"infinity")):hM.$==6?ez.append(hI,de.tagsimple(hJ,"exponentiale")):(ez.append(hI,de.tagopen(hJ,"cn",new bY({$:1,$0:["type",{$:1,$0:"integer"}],$1:hN}))),ez.append(hI,a.String(hM.$0)),ez.append(hI,de.tagclose(0,"cn")));}else if(hK.$==4){ez.append(hI,de.tagopen(hJ,"ci",bY.Empty));ez.append(hI,de.string_of_SId(hK.$0));ez.append(hI,de.tagclose(0,"ci"));}else{hO=hK.$0;(function(hP){var hQ,hR,hS,hT;while(true){if(hP.$==30){if(hQ=hP.$0,hQ!=null&&hQ.$==1){hR=hP.$0.$0;ez.append(hI,de.tagopen(hJ,de.string_of_uOp(hO),bY.Empty));ez.append(hI,de.newline());return de.xml_of_qualifier(hI,hJ+1,{$:0,$0:hR});}else hP={$:30,$0:{$:1,$0:{$:3,$0:{$:0,$0:2},$1:null}}};}else if(hP.$==31){if(hS=hP.$0,hS!=null&&hS.$==1){hT=hP.$0.$0;ez.append(hI,de.tagopen(hJ,de.string_of_uOp(hO),bY.Empty));ez.append(hI,de.newline());return de.xml_of_qualifier(hI,hJ+1,{$:1,$0:hT});}else hP={$:31,$0:{$:1,$0:{$:3,$0:{$:0,$0:10},$1:null}}};}else return ez.append(hI,de.tagopen(hJ,de.string_of_uOp(hP),bY.Empty));}}(hO));ez.append(hI,de.newline());de.xml_of_mathExpr(hI,hJ+1,hK.$1);ez.append(hI,de.tagclose(hJ,de.string_of_uOp(hO)));ez.append(hI,de.newline());}};de.stringIteri=function(hI,hJ){var hK,hL;for(hK=0,hL=cS.length(hJ)-1;hK<=hL;hK++)hI(hK,hJ[hK]);};de.isLetter=function(hI){return"a"<=hI&&hI<="z"||"A"<=hI&&hI<="Z";};de.isUnderscore=function(hI){return hI==="_";};de.isDigit=function(hI){return"0"<=hI&&hI<="9";};de.quotemark=function(){fr.$cctor();return fr.quotemark;};de.tagsimple=function(hI,hJ){return de.tagsingle(hI,hJ,bY.Empty);};de.string_of_bOp=function(hI){return hI.$==1?"divide":hI.$==2?"power":hI.$==3?"minus":hI.$==4?"max":hI.$==5?"mod":"neq";};de.string_of_nOp=function(hI){return hI.$==1?"or":hI.$==2?"xor":hI.$==3?"plus":hI.$==4?"times":hI.$==5?"eq":hI.$==6?"leq":hI.$==7?"lt":hI.$==8?"geq":hI.$==9?"gt":"and";};de.string_of_uOp=function(hI){return hI.$==1?"minus":hI.$==2?"abs":hI.$==3?"exp":hI.$==4?"ln":hI.$==5?"floor":hI.$==32?"ceiling":hI.$==33?"factorial":hI.$==30?"root":hI.$==31?"log":hI.$==6?"sin":hI.$==7?"cos":hI.$==8?"tan":hI.$==9?"sec":hI.$==10?"csc":hI.$==11?"cot":hI.$==12?"arcsin":hI.$==13?"arccos":hI.$==14?"arctan":hI.$==15?"arcsec":hI.$==16?"arccsc":hI.$==17?"arccot":hI.$==18?"sinh":hI.$==19?"cosh":hI.$==20?"tanh":hI.$==21?"sech":hI.$==22?"csch":hI.$==23?"coth":hI.$==24?"arcsinh":hI.$==25?"arccosh":hI.$==26?"arctanh":hI.$==27?"arcsech":hI.$==28?"arccsch":hI.$==29?"arccoth":"not";};de.xml_of_qualifier=function(hI,hJ,hK){var hL,hM;if(hK.$==1){hL="logbase";ez.append(hI,de.tagopen(hJ,hL,bY.Empty));ez.append(hI,de.newline());de.xml_of_mathExpr(hI,hJ+1,hK.$0);ez.append(hI,de.newline());ez.append(hI,de.tagclose(hJ,hL));}else{hM="degree";ez.append(hI,de.tagopen(hJ,hM,bY.Empty));ez.append(hI,de.newline());de.xml_of_mathExpr(hI,hJ+1,hK.$0);ez.append(hI,de.newline());ez.append(hI,de.tagclose(hJ,hM));}};df.Get=function(hI){return hI instanceof a.Array?df.ArrayEnumerator(hI):cw.Equals(typeof hI,"string")?df.StringEnumerator(hI):hI.GetEnumerator();};df.ArrayEnumerator=function(hI){return new ex.New(0,null,function(hJ){var hK;hK=hJ.s;return hK<ck.length(hI)&&(hJ.c=ck.get(hI,hK),hJ.s=hK+1,true);},void 0);};df.StringEnumerator=function(hI){return new ex.New(0,null,function(hJ){var hK;hK=hJ.s;return hK<hI.length&&(hJ.c=hI[hK],hJ.s=hK+1,true);},void 0);};df.Get0=function(hI){return hI instanceof a.Array?df.ArrayEnumerator(hI):cw.Equals(typeof hI,"string")?df.StringEnumerator(hI):"GetEnumerator0"in hI?hI.GetEnumerator0():hI.GetEnumerator();};dg.structured_tabbed=function(hI,hJ,hK){return dg.arbitrary_tabbed(hI,dg.to_tab_items(hJ,hK));};dg.structured_tabbed_embedded=function(hI,hJ){return dg.make_embedded(dg.arbitrary_tabbed_content(hI,dg.to_tab_items(hI,hJ)));};dg.arbitrary_tabbed=function(hI,hJ){return dg.make_page(hI,dg.arbitrary_tabbed_content("top_tabs",hJ));};dg.arbitrary_tabbed_content=function(hI,hJ){var hK,hL;function hM(hN,hO){return(((((hB.Curried(function(hP,hQ,hR,hS,hT){return hP("<div id=\\""+cA.toSafe(hQ)+cA.toSafe(hR)+"\\" class=\\"tabcontent cliplot "+cA.toSafe(hS)+"\\">\\n\\u0009"+cA.toSafe(hT)+"\\n</div>");},5))(a.id))(hI))(dg.to_identifier(hN)))(hI))(hO);}hK="<ul class=\\"tab cliplot\\">"+cS.concat("\\n",bX.mapi(function(hN,hO){var hP;hP=hO[0];return((((((hB.Curried(function(hQ,hR,hS,hT,hU,hV){return hQ("\\u0009<li class=\\"cliplot\\"><a href=\\"javascript:void(0)\\" class=\\"tablinks cliplot "+cA.toSafe(hR)+"\\" onclick=\\"openTab(event, \'"+cA.toSafe(hS)+"\', \'"+cA.toSafe(hT)+"\')\\""+cA.toSafe(hU)+">"+cA.toSafe(hV)+"</a></li>");},6))(a.id))(hI))(hI))(dg.to_identifier(hP)))(hN===0?" id=\\"cliplot_defaultOpen\\"":""))(hP);},hJ))+"\\n</ul>";hL=cS.concat("\\n",bX.map(function(hN){return hM(hN[0],hN[1]);},hJ));return(((hB.Curried3(function(hN,hO,hP){return hN(cA.toSafe(hO)+" "+cA.toSafe(hP));}))(a.id))(hK))(hL);};dg.make_embedded=function(hI){return((((hB.Curried(function(hJ,hK,hL,hM){return hJ("<div class=\\"cliplot\\">"+cA.toSafe(hK)+" "+cA.toSafe(hL)+" "+cA.toSafe(hM)+"</div>");},4))(a.id))(dg.local_styles()))(hI))(dg.unified_scripts());};dg.plot_comparisons=function(hI,hJ,hK,hL,hM){function hN(hO,hP){var hQ,hR;hQ=bX.mapi(function(hS){return hO.instance.settings.plotcolours.get_Length()>hS?dg.colour_of_string(0.6,hO.instance.settings.plotcolours.get_Item(hS)):[eK.Grey(),eK.Black()];},hO.table.columns);return eJ.setVisibleRegion({$:0,$0:0},eJ.setTitle(ck.head(cS.SplitChars(bX.head(hP.columns).name,["("],0)),eJ.setYlabel(hM,eJ.setXlabel(hL,(hR=bX.zip3(hO.table.columns,hP.columns,hQ),co.fold(function(hS,hT){var hU,hV;hU=hT[2];hV=dg.plot_comparison(hO.table.times,hT[0],hP.times,hT[1],hU[0],hU[1],hK);return eJ.addMarkers(hV[0],eJ.addPolyline(hV[1],hS));},eJ.Empty(),hR))))));}return(((hB.Curried3(bX.map2))(hN))(hI))(hJ);};dg.plot_correlation=function(hI,hJ){var hK,hL,hM,hN,hO,hP,hQ,hR;hK=bX.length(hJ);hL=ck.mapi(function(hS,hT){return ck.mapi(function(hU,hV){return hS<=hU?a.NaN:hV;},hT);},hI);hM=eP.init(hK,hK,function(hS,hT){return ck.get(ck.get(hL,hK-hT-1),hS);});hN=bX.ofArray([[-1,"#0000AA"],[-0.8,"#2222AA"],[-0.6,"#4444AA"],[-0.4,"#6666AA"],[-0.2,"#8888AA"],[0,"#AAAAAA"],[0.2,"#AA8888"],[0.4,"#AA6666"],[0.6,"#AA4444"],[0.8,"#AA2222"],[1,"#AA0000"]]);hO={$:0,$0:cS.Join(",",ck.ofSeq(bX.mapi(function(hS,hT){var hU,hV;hU=hT[0];hV=hT[1];return hS===0?(((hB.Curried3(function(hW,hX,hY){return hW(hX.toFixed(6)+"="+cA.toSafe(hY));}))(a.id))(hU))(hV):hS===bX.length(hN)-1?(((hB.Curried3(function(hW,hX,hY){return hW(cA.toSafe(hX)+"="+hY.toFixed(6));}))(a.id))(hV))(hU):((((hB.Curried(function(hW,hX,hY,hZ){return hW(cA.toSafe(hX)+"="+hY.toFixed(6)+"="+cA.toSafe(hZ));},4))(a.id))(hV))(hU))(hV);},hN)))};hP=ck.init(hK+1,a.id);hQ=ck.init(hK+1,a.id);hR=eJ.createLabelledAxis(hQ,bX.rev(hJ));return eJ.addHeatmap(eO.setName(null,eO.setPalette(hO,eO.createHeatmap(hP,hP,hM))),eL.New(hK*25+50+30+60,hK*25+30+50,"Correlation in the joint posterior samples",eJ.Empty().Xlabel,eJ.createTiltedLabelledAxis(hQ,hJ,90),eJ.Empty().Ylabel,hR,eJ.Empty().GridLines,eJ.Empty().Plots,eM.Visible,eJ.Empty().IsNavigationEnabled,false,{$:0,$0:0},eJ.Empty().TooltipDelay));};dg.plot_variation=function(hI,hJ,hK){var hL,hM,hN;function hO(hQ,hR){return hR.get_Length();}function hP(hQ,hR){return function(hS){var hT,hU,hV,hW,hX,hY;hT=hS[1];hU=hT.get_Length();hV=bX.unzip(bX.sortBy(function(hZ){return hZ[0];},bX.map2(function(hZ,h0){return[hZ,ck.average(hI.get_Item(h0))];},hT,hK.GetSlice({$:1,$0:hQ},{$:1,$0:hQ+hU-1}))));hW=hV[1];hX=ck.init(hW.get_Length(),function(hZ){return hZ+1;});return[hQ+hU,new bY({$:1,$0:eJ.setVisibleRegion({$:0,$0:0},eJ.setYlabel("Parameter value",eJ.setTitle(hS[0],(hY=eJ.addMarkers(eQ.setShape(eR.Circle,eQ.createMarkers(hX,hW)),eJ.Empty()),eJ.setXaxis(eJ.setLabelsVisibility(true,eJ.createTiltedLabelledAxis(hX,hV[0],90)),hY))))),$1:hR})];};}hL=(hM=120+25*bX.max(bX.map(function(hQ){return hO(hQ[0],hQ[1]);},hJ)),(hN=400,cw.Compare(hM,hN)===1?hM:hN));return[(co.fold(function(hQ,hR){return(function(hS){return hP(hS[0],hS[1]);}(hQ))(hR);},[0,bY.Empty],hJ))[1],hL];};dg.plot_trace=function(hI,hJ,hK){return eJ.setVisibleRegion({$:0,$0:1},eJ.setTitle(hK,eJ.setYlabel("Parameter values",eJ.setXlabel("Sample",eJ.addPolyline(eS.setThickness(2,eS.createPolyline(ck.ofSeq(hI),ck.ofSeq(hJ))),eJ.Empty())))));};dg.plot_marginal=function(hI,hJ,hK){return eJ.setVisibleRegion({$:0,$0:0},eJ.setTitle(hJ,eJ.setYlabel("Frequency",eJ.setXlabel(hK?"Log10(value)":"value",eJ.addHistogram(eT.setBinCount(30,eT.createHistogram(hK?ck.map(function(hL){return hC.log(hL)/hC.log(10);},hI):hI)),eJ.Empty())))));};dg.to_tab_items=function(hI,hJ){var hK,hL,hM;hK="<ul class=\\"tab tab2 cliplot\\">\\n\\u0009"+cS.concat("\\n",bX.init(hJ.comparisons.get_Length(),function(hN){return(((((hB.Curried(function(hO,hP,hQ,hR,hS){return hO("\\u0009\\u0009<li><a href=\\"javascript:void(0)\\" class=\\"complinks cliplot "+cA.toSafe(hP)+"\\" onclick=\\"openComparison(event, \'"+cA.toSafe(hQ)+"\', \'cliplot_comparison_"+a.String(hR)+"\')\\">Comparison "+a.String(hS)+"</a></li>");},5))(a.id))(hI))(hI))(hN+1))(hN+1);}))+"\\n\\u0009</ul>";hL=((hB.Curried(function(hN,hO,hP,hQ,hR){return hN("\\u0009<div id=\\""+cA.toSafe(hO)+"cliplot_comparison_"+a.String(hP)+"\\" class=\\"compcontent cliplot "+cA.toSafe(hQ)+"\\">\\n\\u0009\\u0009"+cA.toSafe(hR)+"\\n</div>");},5))(a.id))(hI);hM=cS.concat("\\n",bX.mapi(function(hN,hO){return((hL(hN+1))(hI))(hO[1]);},hJ.comparisons));return bX.append(bX.ofArray([["Model",hJ.model],["Comparisons",(((hB.Curried3(function(hN,hO,hP){return hN(cA.toSafe(hO)+"\\n"+cA.toSafe(hP));}))(a.id))(hK))(hM)],["Posterior marginals",hJ.posterior],["Correlation",hJ.correlation],["MCMC traces",hJ.traces],["Parameter summary",hJ.psummary]]),hJ.variations);};dg.make_page=function(hI,hJ){return(((((hB.Curried(function(hK,hL,hM,hN,hO){return hK("<!DOCTYPE html><html>"+cA.toSafe(hL)+" "+cA.toSafe(hM)+"<body><h2 class=\\"cliplot\\">"+cA.toSafe(hN)+"</h2>"+cA.toSafe(hO)+"</body></html>");},5))(a.id))(dg.page_header_scripts()))(dg.local_styles()))(hI))(hJ);};dg.to_identifier=function(hI){return(function(hJ){return function(hK){return hJ("cliplot_"+cA.toSafe(hK));};}(a.id))(cS.map(function(hJ){return fw.IsLetterOrDigit(hJ)?hJ:"_";},hI));};dg.local_styles=function(){fx.$cctor();return fx.local_styles;};dg.unified_scripts=function(){fx.$cctor();return fx.unified_scripts;};dg.plot_comparison=function(hI,hJ,hK,hL,hM,hN,hO){var hP,hQ;function hR(hT,hU){return hT<hQ;}function hS(hT,hU){return hT<hQ;}hP=hO==null?[[hK,hL.values],[hI,hJ.values]]:(hQ=hO.$0,[bX.unzip(bX.filter(function(hT){return hR(hT[0],hT[1]);},bX.zip(hK,hL.values))),bX.unzip(bX.filter(function(hT){return hS(hT[0],hT[1]);},bX.zip(hI,hJ.values)))]);return[eQ.setSize(3,eQ.setFillColour(hN,eQ.createMarkers(ck.ofList(hP[0][0]),ck.ofList(hP[0][1])))),eS.setThickness(2,eS.setStrokeColour(hM,eS.createPolyline(ck.ofList(hP[1][0]),ck.ofList(hP[1][1]))))];};dg.colour_of_string=function(hI,hJ){var hK,hL;hK=eK.parse(hJ);return hK==null?[eK.Gray(),eK.Black()]:(hL=hK.$0,[hL,dg.darken_colour(hI,hL)]);};dg.page_header_scripts=function(){fx.$cctor();return fx.page_header_scripts;};dg.darken_colour=function(hI,hJ){function hK(hL){return be.toInt(hL*hI)%256;}return hJ.$==0?hJ:{$:1,$0:gN.New(hK(hJ.$0.R),hK(hJ.$0.G),hK(hJ.$0.B))};};dg.activate_idd_script=function(){fx.$cctor();return fx.activate_idd_script;};dg.cdn_scripts=function(){fx.$cctor();return fx.cdn_scripts;};dg.prepare_idd_script=function(){fx.$cctor();return fx.prepare_idd_script;};dg.footer_scripts_idd=function(){fx.$cctor();return fx.footer_scripts_idd;};dh=d.Ode=hB.Class({to_oslo:function(){return this.to_oslo_abstract().evaluate();},to_sundials:function(){return this.to_sundials_abstract().evaluate();},to_lna:function(hI){var hJ,hK,hL,hM,hN;hJ=dh.get_matrices(this.initials,this.reactions);hK=hJ[0];hL=e7.create(this.name,this.settings,hJ[1],hJ[2],dh.get_rates(hK,this.reactions,!cw.Equals(this.settings.simulation.kinetics,"Deterministic")),hK,this.initials);hM=cX.to_env(this.settings.parameters);hN=ck.map(function(hO){return br["eval"](function(hP){return cY.find(hM,hP);},hO.value);},ck.ofList(this.initials));return cC.initialise(hL.evaluate(),hL.matrix,hN,hI);},to_oslo_abstract:function(){var hI,hJ;hI=dh.get_matrices(this.initials,this.reactions);hJ=hI[0];return e7.create(this.name,this.settings,hI[1],hI[2],dh.get_rates(hJ,this.reactions,cw.Equals(this.settings.simulation.kinetics,"Stochastic")),hJ,this.initials);},to_sundials_abstract:function(){return e9.create(bW.OfArray(ck.mapi(function(hI,hJ){return[hJ.species,hI];},ck.ofSeq(co.distinctBy(function(hI){return hI.species;},this.initials)))),this.reactions,this.initials,this.settings);},prune:function(hI){var hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW;function hX(h3){var h4;h4=br.simplify(br.substitute(hI,h3));return h4.$==1?h4.$0!==0:true;}function hY(h3,h4){return bX.forAll(function(h5){return bX.contains(h5,h3);},Z.elements(h4.reactants));}function hZ(h3,h4){return function(h5){var h6,h7,h8;h6=bX.partition(function(h9){return hY(h5,h9);},h4);h7=h6[0];return h7.$==0?[h3,h5]:(h8=bX.filter(function(h9){return!bX.contains(h9,h5);},bX.collect(function(h9){return Z.elements(h9.products);},h7)),(function(h9){return hZ(h9[0],h9[1]);}([bX.append(h7,h3),h6[1]]))(bX.distinct(bX.append(h8,h5))));};}function h0(h3){return h3.$==1?{$:1,$0:h3.$0}:null;}function h1(h3){return h3[1];}function h2(h3){return cL.all_species(hO,h3);}hJ=bX.filter(function(h3){return hX(h3.value);},this.initials);hK=bX.map(function(h3){return h3.species;},hJ);hL=(function(h3){return hZ(h3[0],h3[1]);}([bY.Empty,bX.collect(function(h3){var h4;h4=h3.normalise();return h4[1]==null?bX.ofArray([h4[0]]):bX.ofArray([h4[0],h4[1].$0]);},this.reactions)]))(hK);hM=hL[1];hN=hL[0];hO=this.settings.all_used_rates((hP=function(h3){return bX.choose(h0,h3);},function(h3){return hP(br.mentions(h3));}),hN);hQ=bW.OfArray(ck.ofSeq(bX.map(function(h3){return[{$:2,$0:h3},{$:1,$0:0}];},bX.ofSeq(cK.op_Subtraction(new cK.New$1(c6.OfSeq(bX.collect(function(h3){return h2(h1(h3));},bX.ofSeq(bW.ToSeq(hO))))),new cK.New$1(c6.OfSeq(hM)))))));hR=bW.Map(function(h3,h4){return br.substitute(hQ,h4);},hO);hS=bW.OfArray(ck.ofSeq(bX.map(function(h3){return[{$:2,$0:h3},{$:1,$0:0}];},bX.ofSeq(cK.op_Subtraction(new cK.New$1(c6.OfSeq(bX.collect(function(h3){return cL.all_species(hO,h3);},this.settings.simulation.plots))),new cK.New$1(c6.OfSeq(hM)))))));hT=(hU=this.settings,Y.New((hV=this.settings.simulation,bx.New(hV.name,hV.initial,hV["final"],hV.points,bX.map(function(h3){return br.substitute(hS,h3);},this.settings.simulation.plots),hV.plotcolours,hV.seed,hV.kinetics,hV.times,hV.prune,hV.multicore,hV.data,hV.sweeps)),hU.simulations,hU.stochastic,hU.deterministic,hU.spatial,hU.inference,hU.moment_closure,hU.synthesis,hU.data,hU.units,hU.simulator,hU.parameters,hU.sweeps,hR,hU.plot,hU.quiet));hW=bX.map(function(h3){return h3.species;},hJ);return dh.New(this.name,hT,hN,bX.rev(dZ.fold_left(function(h3,h4){return bX.exists(function(h5){return cw.Equals(h4,h5);},hW)?h3:new bY({$:1,$0:_8.create$4(false,{$:1,$0:0},h4,null,null),$1:h3});},bX.rev(hJ),hM)));},substitute:function(hI){return dh.New(this.name,this.settings.substitute(hI),this.reactions,this.initials);},simulate_instance:function(hI,hJ){try{return bz.create(hJ,hI(this.substitute(hJ.environment)));}catch(hK){return be.FailWith(a.String(hK));}}},null,dh);dh.list_to_inference=function(hI,hJ){var hK;function hL(hM,hN){var hO,hP;hO=hM?hN:dh.update_times(bY.Empty,hN);hP=hI.simulator;return hP=="Oslo"?hO.to_oslo().simulate():hP=="Sundials"?dh.simulate_sundials(hO):(function(hQ){return function(hR){return hQ("Invalid simulator type for inference: "+u.p(hR));};}(be.FailWith))(hI.simulator);}hK=dh.list_to_inference_method(hI,hJ);return hI.inference.partial_evaluation?dh.list_inference_dependencies(hI,hK[0],hK[1],function(hM){return function(hN){return hL(hM,hN);};},hK[3],hK[4],hK[2],hK[5]):dh.list_inference_full(hI,hK[0],hK[1],function(hM){return function(hN){return hL(hM,hN);};},hK[3],hK[4],hK[2],hK[5]);};dh.update_times=function(hI,hJ){return dh.New(hJ.name,hJ.settings.update_times(hI),hJ.reactions,hJ.initials);};dh.simulate_sundials=function(hI){var hJ,hK;try{return hI.to_sundials().simulate();}catch(hL){if(hL instanceof dU){throw dS.ode_solver_error((hK=cX.to_string_inline(hI.settings.parameters),(((hB.Curried3(function(hM,hN,hO){return hM(cA.toSafe(hN)+"\\n\\nParameters: "+cA.toSafe(hO));}))(a.id))(hL.message))(hK)));}else throw hL;return hJ;}};dh.list_to_inference_method=function(hI,hJ){var hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0,h1;function h2(h4,h5){return bX.map(function(h6){return dh.New(h4.name,h4.settings.update_simulation(h6.settings),h4.reactions,h4.initials);},h5);}function h3(h4,h5){return h4.prune(dZ.update_map(h1,h5));}hK=hI.to_inference_runs(bX.map(function(h4){return h4.settings;},hJ));hL=hK[2];hM=hK[3];hN=hK[0];hO=cX.to_env((bX.partition(F.variable,hN))[1]);hP=bX.map(function(h4){return bX.map(function(h5){return h5.inline_env(hO);},h4);},hL);hQ=cX.remove(bX.collect(fy.get_variables,hP),hN);hR=bX.zip(hP,hM);hS=bX.collect(function(h4){return bX.map(function(h5){return h5.plots;},h4);},hM);hT=bX.map(function(h4){var h5;return dh.New(h4.name,(h5=h4.settings,Y.New(h5.simulation,h5.simulations,h5.stochastic,h5.deterministic,h5.spatial,h5.inference,h5.moment_closure,h5.synthesis,h5.data,h5.units,h5.simulator,hN,h5.sweeps,h5.rates,h5.plot,h5.quiet)),h4.reactions,h4.initials);},hJ);hU=cX.to_env(hQ);hV=bX.map2(function(h4,h5){return dh.generate_instances(hU,h4.name,h5[0],h5[1]);},hT,hR);hW=bX.concat((((hB.Curried3(bX.map2))(h2))(hT))(hV));hX=bX.concat(hV);hY=bX.concat(hL);hZ=hI.simulation.prune?(h0=bX.collect(function(h4){return bX.map(function(h5){return bW.OfArray(ck.ofSeq(bX.zip(h4.get_merge().variables,h5)));},h4.get_merge().values);},hY),(h1=bW.Map(function(h4,h5){return{$:1,$0:h5};},hO),(((hB.Curried3(bX.map2))(h3))(hW))(h0))):hW;return[hS,bX.concat(hK[1]),hQ,hZ,hX,hY];};dh.list_inference_dependencies=function(hI,hJ,hK,hL,hM,hN,hO,hP){var hQ;hQ=bX.indexed(fy.get_variable_dependencies(hP));return cp.create_with_dependencies(hI.inference,function(hR,hS,hT){var hU,hV,hW,hX,hY;function hZ(h0,h1){return bX.contains(h0,hY);}hU=bX.map2(function(h0,h1){return h0.update_environment(h1);},hN,bX.map(function(h0){return h0[1];},fy["eval"](hS,hP)));hV=bX.map(function(h0){return h0.substitute(hS);},hM);hW=bX.indexed(bX.zip(hU,hV));hX=hT.$==0?[hU,hV]:(hY=hT.$0,bX.unzip(bX.map(function(h0){return h0[1];},bX.filter(function(h0){return hZ(h0[0],h0[1]);},hW))));return dh.list_simulate_instances(hI.simulation.multicore,hL(hR),hX[0],hX[1]);},hJ,hK,hO,bX.map(function(hR){var hS;function hT(hU,hV){return bX.contains(hR.name,hV);}hS=bX.filter(function(hU){return hT(hU[0],hU[1]);},hQ);return hS.$==0?eD.All:{$:1,$0:bX.sort(bX.map(function(hU){return hU[0];},hS))};},hO));};dh.list_inference_full=function(hI,hJ,hK,hL,hM,hN,hO,hP){return cp.create(hI.inference,function(hQ,hR){var hS,hT;hS=bX.map2(function(hU,hV){return hU.update_environment(hV);},hN,bX.map(function(hU){return hU[1];},fy["eval"](hR,hP)));hT=bX.map(function(hU){return hU.substitute(hR);},hM);return dh.list_simulate_instances(hI.simulation.multicore,hL(hQ),hS,hT);},hJ,hK,hO);};dh.create=function(hI,hJ,hK,hL){return dh.New(hI,hL,hJ,hK);};dh.get_matrices=function(hI,hJ){var hK,hL,hM,hN,hO,hP,hQ;hK=ck.ofList(bX.distinctBy(function(hR){return hR.species;},hI));hL=bW.OfArray(ck.mapi(function(hR,hS){return[hS.species,hR];},hK));hM=bX.length(hJ);hN=hK.length;hO=ck.init(hN,function(){return ck.create(hM,0);});for(hP=0,hQ=hN-1;hP<=hQ;hP++)(function(hR){return bX.iteri(function(hS,hT){return ck.set(ck.get(hO,hR),hS,hT.getStoich(ck.get(hK,hR).constant,ck.get(hK,hR).species));},hJ);}(hP));return[hL,hO,ck.ofList(bX.map(function(hR){return Z.collectm(function(hS){return[hL.get_Item(hS.element),hS.multiplicity];},hR.reactants);},hJ))];};dh.get_rates=function(hI,hJ,hK){var hL,hM;function hN(hO){var hP;hP=bW.TryFind(hO,hI);return hP==null?(function(hQ){return function(hR){return hQ("Missing species: "+cA.prettyPrint(hR)+" in rate");};}(be.FailWith))(hO.name):hP.$0;}hL=(hM=function(hO){return bq.map(hN,hO);},function(hO){return br.map(hM,hO);});return ck.ofList(bX.map(function(hO){return hO.rate.map(hK?function(hP){return hO.deterministic_to_stochastic(hP);}:a.id,hL);},hJ));};dh.to_matlab=function(hI){var hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0,h1;function h2(h8){ez.append(hX,h8);}function h3(h8){return br["eval"](hK,h8);}function h4(h8){return"sol.(\'"+bG.to_string(h8)+"\')";}function h5(h8){var h9,h_;h9=bX.map(function(h$){return[h$,bG.to_string(h$)];},bX.rev(Z.elements(h8.reactants)));h_=h8.rate;return h_.$==1?br.to_string(function(h$){return bq.to_matlab(bG.to_string,hM,h$);},h_.$0):br.to_string(a.id,co.fold(function(h$,ia){var ib;ib={$:1,$0:h8.numInReactants(ia[0])};return br.mul(h$,br.power$1(br.from_string(cR.name(),ia[1]),ib));},h_.$0,h9));}function h6(h8){return"d"+h8;}function h7(h8,h9,h_){var h$;h$=(dZ.fold_left(function(ia,ib){return(function(ic){var id,ie;id=ic[0];ie=ic[1];return function(_if){var ig,ih;ig=co.nth(h8,h9);ih=_if[1].getStoich(ig.constant,ig.species);return ih===0?[id,ie]:[id+(ih>0?ie?" ":" + ":ie?" -":" - ")+(hC.abs(ih)===1?"":a.String(hC.abs(ih))+"*")+"r_"+a.String(_if[0]),false];};}(ia))(ib);},["",true],h_))[0];return h$===""?"0.0":h$;}hJ=dZ.newline();hK=(hL=cX.to_env(hI.settings.parameters),function(h8){return cY.find(hL,h8);});hM="t";hN="dxdt";hO="x__";hP="odes";hQ="tstart";hR="species";hS="sol";hT="i";hU="n";hV="tfinal";hW="plots";hX=ez.empty();hY=!(hI.settings.simulation.plots.$==0);h2("function "+hS+" = "+"crn_export"+"()"+hJ+hJ);h2(hQ+" = "+a.String(hI.settings.simulation.initial)+"; % Initial time"+hJ);h2(hV+" = "+a.String(hI.settings.simulation["final"])+"; % Final time"+hJ);h2(hR+" = {"+dZ.string_of_list(function(h8){return"\'"+h8.species.name+"\'";},",",hI.initials)+"}; % The list of all species"+hJ);hY?h2(hW+" = {"+dZ.string_of_list(function(h8){return"\'"+br.to_string(function(h9){return bq.to_matlab(bG.to_string,"time",h9);},h8)+"\'";},",",hI.settings.simulation.plots)+"};"+hJ):void 0;h2(hU+" = length("+hR+");"+hJ+hJ);h2("% Write out the parameters");bX.iter(function(h8){h2(hJ+"p."+h8.name+" = "+a.String(h8.value)+";");},hI.settings.parameters);h2(hJ+hJ);hZ=bX.map(function(h8){return _8["eval"](h3,h8);},hI.initials);h2("% Assign initial conditions"+hJ);h2("x0 = zeros("+hU+",1);");bX.iteri(function(h8,h9){return h9.value!==0?h2(hJ+"x0("+a.String(h8+1)+") = "+a.String(h9.value)+";"+"\\u0009\\u0009"+"% "+h9.species.name):null;},hZ);h2(hJ+hJ);h0=hI.settings.parameters.$==0?"":",p";h2("% Solve the ODEs"+hJ);h2("["+hM+","+hO+"] = "+"ode15s"+"(@"+hP+",["+hQ+" "+hV+"],x0,[]"+h0+");"+hJ+hJ);h2("% Write out a solution structure to be returned by the function"+hJ);h2("for "+hT+" = 1:"+hU+hJ);h2("  "+hS+".("+hR+"{"+hT+"}) = "+hO+"(:,"+hT+");"+hJ);h2("end"+hJ+hJ);hY?(h2("% Apply plot expressions"+hJ),h2("plotsValues = zeros(length("+hO+"),"+a.String(bX.length(hI.settings.simulation.plots))+");"),bX.iteri(function(h8,h9){return h2(hJ+"plotsValues(:,"+a.String(h8+1)+") = "+cS.Replace(cS.Replace(cS.Replace(br.to_string(function(h_){return bq.to_matlab(h4,"time",h_);},h9),"*",".*"),"/","./"),"^",".^")+";");},hI.settings.simulation.plots),h2(hJ+hJ)):void 0;h2("% Produce a plot"+hJ);h2("figure;"+hJ);h1=hY?["plotsValues",hW]:[hO,hR];h2("plot("+hM+", "+h1[0]+")"+hJ);h2("xlabel(\'Time\')"+hJ);h2("ylabel(\'Concentration\')"+hJ);h2("box off"+hJ);h2("legend("+h1[1]+",\'box\',\'off\')");h2(hJ+hJ+"return"+hJ+hJ+"%%%"+hJ+hJ);h2("function "+hN+" = "+hP+"("+hM+","+hO+h0+")"+hJ+hJ);!(hI.settings.parameters.$==0)?(h2("% Write out the parameters"),bX.iter(function(h8){h2(hJ+h8.name+" = p."+h8.name+";");},hI.settings.parameters),h2(hJ+hJ)):void 0;h2("% Assign states");bX.iteri(function(h8,h9){return h2(hJ+h9.species.name+" = "+hO+"("+a.String(h8+1)+")"+";");},hZ);h2(hJ+hJ);!hI.settings.rates.get_IsEmpty()?(h2("% Define rate expressions"),bW.Iterate(function(h8,h9){return h2(hJ+h8+" = "+br.to_string(function(h_){return bq.to_matlab(bG.to_string,hM,h_);},h9)+";");},hI.settings.rates),h2(hJ+hJ)):void 0;h2("% Define reaction propensities");bX.iteri(function(h8,h9){return h2(hJ+"r_"+a.String(h8)+" = "+h5(h9)+";");},hI.reactions);h2(hJ+hJ);h2("% Assign derivatives");bX.iteri(function(h8,h9){return h2(hJ+h6(h9.species.name)+" = "+h7(h8,hZ,bX.indexed(hI.reactions))+";");},hI.initials);h2(hJ+hJ);h2(hN+" = ["+dZ.string_of_list(function(h8){return h6(h8.species.name);},";",hI.initials)+"];"+hJ+hJ);h2("return");return a.String(hX);};dh.generate_instances=function(hI,hJ,hK,hL){var hN,hO,hP,hQ;function hM(hR,hS,hT,hU){return function(hV){return by.create$5(hJ,hR,hS,hT,hV,hU);};}hN=fy.eval_label(hI,hK);hO=bX.length(hL);hP=bX.length(hN);if(hO!==hP){hQ=bX.head(hN);throw new dT.New(((((hB.Curried(function(hR,hS,hT,hU){return hR("Number of sweep items in "+cA.toSafe(hS)+" ("+a.String(hT)+") not compatible with number of data columns ("+a.String(hU)+")");},4))(a.id))(hQ[0]))(hP))(hO));}else return bX.map2(function(hR,hS){return(function(hT){return hM(hT[0],hT[1],hT[2],hT[3]);}(hR))(hS);},hN,hL);};dh.list_simulate_instances=function(hI,hJ,hK,hL){return hI?be.FailWith("Can\'t use Async in JavaScript (directive simulation {multicore=True})"):bX.map2(function(hM,hN){return hN.simulate_instance(hJ,hM);},hK,hL);};dh.New=function(hI,hJ,hK,hL){return new dh({name:hI,settings:hJ,reactions:hK,initials:hL});};di.New=function(hI,hJ,hK,hL){return{iteration:hI,state:hJ,mlesims:hK,summary:hL};};dj.New=function(hI,hJ,hK,hL){return{values:hI,logLikelihood:hJ,logPrior:hK,iteration:hL};};dl.New=function(hI,hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS){return{space:hI,state:hJ,thinningSkippedCount:hK,chain:hL,burnin:hM,randGen:hN,innovationGens:hO,mle:hP,priors:hQ,indexes:hR,accepted:hS};};dm.New=function(hI,hJ,hK,hL,hM,hN,hO,hP,hQ,hR){return{space:hI,state:hJ,thinningSkippedCount:hK,chain:hL,stats:hM,randGen:hN,innovationGens:hO,mle:hP,priors:hQ,indexes:hR};};cp.run_mcmc_seq=function(hI,hJ){var hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU;hK=-1.79769313486232E+308;hL=bY.Empty;hM=null;hN=hI.$==1?(hO=hI.$0,[eC.run_seq(hO.likefn,hO.parameters,hO.dependencies,hO.options),hO.parameters,hO.options,hO.numData,function(hV){return(hO.simfn(hV))(eD.All);}]):(hP=hI.$0,[dk.run_seq(hP.likefn,hP.parameters,hP.options),hP.parameters,hP.options,hP.numData,hP.simfn]);hQ=hN[0];hR=hN[4];hS=hN[1];hT=hN[2];hU=hN[3];return co.delay(function(){var hV;hV=0;return co.append(co.collect(function(hW){var hX,hY,hZ,h0,h1,h2;hZ=eE.stringOfSummary(hW,hT,hU);hM={$:1,$0:hW};h0=hW.$==1?hW.$0.mle:hW.$0.mle;try{hY=(h1=h0.logLikelihood>hK?(hR(false))(h0.values):hL,hK=h0.logLikelihood,hL=h1,h1);}catch(h3){if(h3 instanceof dU)h2=hL;else throw h3;hY=h2;}hV=hV+1;return[di.New(hV,hW,hY,hZ)];},hQ),co.delay(function(){var hW;return hM!=null&&hM.$==1&&(hM.$0.$==1&&(hW=hM.$0.$0,true))?(hJ(cp.convert_sampling(hR(true),hL,hS,hT,hU,hW)),[]):(be.FailWith("inference did not return a sampling"),[]);}));});};cp.convert_sampling=function(hI,hJ,hK,hL,hM,hN){var hO,hP,hQ,hR;hO=cp.getSummary(hL,hM,hN);hP=bW.OfArray(ck.ofSeq(bX.choose(function(hS){return hS.isFixed()?{$:1,$0:[hS.name,hS.initValue.$0]}:null;},hK)));hQ=cp.analyse_chain(hN);hR=bX.choose(function(hS){try{return{$:1,$0:hI(hS.values)};}catch(hT){return null;}},bX.rev(hN.chain));return cq.New(hQ[2],hQ[0],hQ[3],hP,hQ[1],hJ,hR.$===0?bY.Empty:bX.mapi(function(hS,hT){return bz.New(hT.instance,O.qsummary(bX.map(function(hU){return hU.get_Item(hS).table;},hR)));},bX.head(hR)),hO);};cp.create_with_dependencies=function(hI,hJ,hK,hL,hM,hN){var hO,hP,hQ,hR,hS,hT;function hU(hX){return co.findIndex(function(hY){return cw.Equals(hX,hY);},hO);}function hV(hX,hY,hZ){return hJ(hX,cp.env_of_aa(hZ,new cj.New([])),hY);}function hW(hX,hY){var hZ,h0;hZ=cp.penalties(hO.get_Length(),hI,hY);try{return hX.$==0?bX.mapi2(function(h1,h2,h3){return O.likelihood(bX.map(function(h4){return hZ.get_Item(h4);},hP.get_Item(h1)),h2,h3);},bX.map(bz.to_table,hV(true,hX,hY)),hL):bX.map2(function(h1,h2){return O.likelihood(bX.map(function(h3){return hZ.get_Item(h3);},hP.get_Item(h2)),h1,hL.get_Item(h2));},bX.map(bz.to_table,hV(true,hX,hY)),hX.$0);}catch(h1){if(h1 instanceof dU)h0=(hT=hT+1,bX.init(hL.get_Length(),function(){return -1.79769313486232E+308;}));else if(h1 instanceof dT)h0=be.FailWith(h1.message);else throw h1;return h0;}}hO=bX.distinct(bX.concat(hK));hP=bX.map(function(hX){return bX.map(hU,hX);},hK);hQ=cp.generate_sigmas(hI.noise_parameter,hO);hR=(hS=hI.noise_parameter,hS=="Random"?bX.ofArray([eD.All]):hS=="Multiple"?bX.replicate(hQ.get_Length(),eD.All):bY.Empty);hT=0;return{$:1,$0:dn.New(function(hX){return function(hY){return hW(hX,hY);};},hB.Curried3(hV),bX.append(hQ,cp.fb_parameters(hM)),bX.append(hR,hN),cp.options(hI),cp.num_datapoints(hL))};};cp.create=function(hI,hJ,hK,hL,hM){var hN,hO,hP,hQ;function hR(hT){return co.findIndex(function(hU){return cw.Equals(hT,hU);},hN);}function hS(hT,hU){return hJ(hT,cp.env_of_aa(hU,new cj.New([])));}hN=bX.distinct(bX.concat(hK));hO=bX.map(function(hT){return bX.map(hR,hT);},hK);hP=cp.generate_sigmas(hI.noise_parameter,hN);hQ=0;return{$:0,$0:_do.New(function(hT){var hU,hV;hU=cp.penalties(hN.get_Length(),hI,hT);try{return co.sum(bX.mapi2(function(hW,hX,hY){return O.likelihood(bX.map(function(hZ){return hU.get_Item(hZ);},hO.get_Item(hW)),hX,hY);},bX.map(bz.to_table,hS(true,hT)),hL));}catch(hW){if(hW instanceof dU)hV=(hQ=hQ+1,-1.79769313486232E+308);else if(hW instanceof dT)hV=be.FailWith(hW.message);else throw hW;return hV;}},function(hT){return function(hU){return hS(hT,hU);};},bX.append(hP,cp.fb_parameters(hM)),cp.options(hI),cp.num_datapoints(hL))};};cp.analyse_chain=function(hI){var hJ,hK,hL;hJ=bX.map(dp.fromFilzbach,bX.ofArray(eE.getSummary(hI)));hK=bX.map(cp.evToMap,bX.rev(hI.chain));hL=bX.map(cp.evToMap,bX.rev(hI.burnin));return[hK,cp.evToMap(hI.mle),hJ,hL];};cp.getSummary=function(hI,hJ,hK){var hL;hL=eE.informationCriteria(hK,hJ);return dq.New(hI.seed,hI.burninLen,hI.sampleLen,hI.thinning,hK.mle.logLikelihood,hL.AIC,hL.BIC,hL.DIC,hJ);};cp.generate_sigmas=function(hI,hJ){var hK;return hI=="Random"?bX.ofArray([cp.variable_sigma("sigma")]):hI=="Multiple"?bX.init(hJ.get_Length(),function(hL){return cp.variable_sigma((function(hM){return function(hN){return hM("sigma_"+a.String(hN));};}(a.id))(hL));}):(hK=hI.$0,bX.ofArray([cs.New("sigma",bi.New(bh.Fixed,hK,hK),{$:1,$0:hK},null,false)]));};cp.env_of_aa=function(hI,hJ){return ck.fold(function(hK,hL){return hK.Add(hL,hI.Item(hL));},hJ,hI.get_Names());};cp.fb_parameters=function(hI){return bX.map(F.to_filzbach,hI);};cp.options=function(hI){return eF.New(hI.burnin,hI.samples,hI.thin,hI.seed,hI.print_console,hI.print_summary);};cp.num_datapoints=function(hI){return co.sumBy(function(hJ){return co.sumBy(function(hK){return hK.values.get_Length();},hJ.columns);},hI);};cp.penalties=function(hI,hJ,hK){var hL,hM;return hJ.noise_parameter=="Multiple"?bX.init(hI,function(hN){var hO,hP;hO=hJ.noise_model;hP=hK.Item((function(hQ){return function(hR){return hQ("sigma_"+a.String(hR));};}(a.id))(hN));return hB.Curried(cp.penalty,2,[hO,hP]);}):bX.replicate(hI,(hL=hJ.noise_model,(hM=hK.Item("sigma"),hB.Curried(cp.penalty,2,[hL,hM]))));};cp.evToMap=function(hI){return bW.FoldBack(function(hJ,hK,hL){return hL.Add(hJ,hK);},bW.OfArray([["Iteration",hI.iteration],["logLikelihood",hI.logLikelihood],["logPrior",hI.logPrior]]),hI.values.ToMap());};cp.variable_sigma=function(hI){return cs.New(hI,bi.New(bh.Log,1E-06,1000000),null,null,true);};cp.penalty=function(hI,hJ,hK,hL){if(a.isNaN(hL))return 0;else if(hI=="Proportional"){if(hK<=0){(function(hM){return hM("Cannot evaluate a proportional-error noise model for non-positive simulation values.");}(function(hM){hE.log(hM);}));throw dS.negative_simulation();}else return dt.log_of_normal_density(hL,hK,hC.sqrt(hK)*hJ);}else return dt.log_of_normal_density(hL,hK,hJ);};dn.New=function(hI,hJ,hK,hL,hM,hN){return{likefn:hI,simfn:hJ,parameters:hK,dependencies:hL,options:hM,numData:hN};};_do.New=function(hI,hJ,hK,hL,hM){return{likefn:hI,simfn:hJ,parameters:hK,options:hL,numData:hM};};dp=d.ParameterSummary=hB.Class({toNormalDist:function(){return new C({$:1,$0:A.New(this.mean,hC.sqrt(this.variance))});},toLogNormalDist:function(){var hI;hI=1+this.variance/this.mean/this.mean;return new C({$:2,$0:z.New(hC.log(this.mean/hC.sqrt(hI)),hC.log(hI))});},toTruncatedNormalDist:function(){return new C({$:3,$0:y.New(this.mean,hC.sqrt(this.variance),this.lb,this.ub)});}},null,dp);dp.get_defaults=function(){return dp.New("",0,0,0,0,0,0,0,0,0,0,"Real");};dp.fromFilzbach=function(hI){return dp.New(hI.name,hI.mle,hI.summary.mean,hI.summary.variance,hI.qsummary.median,hI.range.lb,hI.range.ub,hI.qsummary.lb68,hI.qsummary.ub68,hI.qsummary.lb95,hI.qsummary.ub95,hI.range.pType.$==1?"Log":"Real");};dp.New=function(hI,hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT){return new dp({name:hI,mle:hJ,mean:hK,variance:hL,median:hM,lb:hN,ub:hO,l68:hP,u68:hQ,l95:hR,u95:hS,ptype:hT});};dq=cp.McmcSummary=hB.Class({},null,dq);dq.New=function(hI,hJ,hK,hL,hM,hN,hO,hP,hQ){return new dq({seed:hI,burnin:hJ,samples:hK,thin:hL,mle:hM,aic:hN,bic:hO,dic:hP,numData:hQ});};dr.New=function(hI,hJ,hK,hL,hM,hN,hO){return{model:hI,comparisons:hJ,correlations:hK,keys:hL,parameters:hM,marginals:hN,multiple_paras:hO};};ds.New=function(hI,hJ,hK,hL,hM){return{sim:hI,dat:hJ,name:hK,xlabel:hL,ylabel:hM};};dt.correlation_pearson=function(hI){var hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV;hK=hI.length;hL=ck.get(hI,0).length;hM=ck.unzip(ck.map(function(hW){var hX;hX=ck.average(hW);return[hX,hC.sqrt(ck.sum(ck.map(function(hY){return(hY-hX)*(hY-hX);},hW)))];},hI));hN=hM[0];hO=hM[1];hJ=ck.init(hK,function(){return ck.create(hK,0);});for(hP=0,hQ=hK-1;hP<=hQ;hP++){ck.set(ck.get(hJ,hP),hP,1);for(hR=hP+1,hS=hK-1;hR<=hS;hR++){hT=ck.fold2(function(hW,hX,hY){return hW+hX*hY;},0,ck.get(hI,hP),ck.get(hI,hR));ck.set(ck.get(hJ,hP),hR,(hT-hL*ck.get(hN,hP)*ck.get(hN,hR))/ck.get(hO,hP)/ck.get(hO,hR));}for(hU=0,hV=hP-1;hU<=hV;hU++)ck.set(ck.get(hJ,hP),hU,ck.get(ck.get(hJ,hU),hP));}return hJ;};dt.online_meanvar=function(hI,hJ,hK,hL){var hM;hM=hI+(hK-hI)/hL;return[hM,hJ+((hK-hI)*(hK-hM)-hJ)/hL];};dt.log_of_normal_density=function(hI,hJ,hK){var hL,hM;hL=hC.sqrt(2*3.14159265358979);hM=(hI-hJ)/hK;return -0.5*hM*hM-hC.log(hK*hL);};du.New=function(hI,hJ,hK,hL,hM,hN,hO){return{model:hI,comparisons:hJ,posterior:hK,correlation:hL,traces:hM,psummary:hN,variations:hO};};dw.ofChart=function(hI){return eG.toString(eH.toHtmlStructure(hI));};dw.ofSubplots=function(hI){return eG.toString(eI.subplotsToHtmlStructure(hI));};dx=cp.Summary=hB.Class({},null,dx);dx.New=function(hI,hJ){return new dx({mcmc:hI,parameters:hJ});};dz=dy.AssociativeArray=hB.Class({Item:function(hI){return ck.get(this.objects,this.map.Item(hI));},get_Names:function(){return this.map.get_Keys();},ToArray:function(){return ck.ofSeq(this.objects);},get__dataArray:function(){return this.objects;},Item$1:function(hI){return ck.get(this.objects,hI);},get__namesMap:function(){return this.map;},ToMap:function(){return bW.OfArray(ck.zip(this.get_Names(),this.ToArray()));},CopyWithNewValues:function(hI){return new dz.New(this.map,hI);}},b1,dz);dz.ofSeq=function(hI){return dz.ofArray(ck.ofSeq(hI));};dz.ofArray=function(hI){var hJ,hK;hJ=ck.length(hI);hK=ck.init(hJ,function(hL){return ck.get(hI,hL).get_Data();});return new dz.New(new eU.New(ck.init(hJ,function(hL){return ck.get(hI,hL).get_Name();})),hK);};dz.New=hB.Ctor(function(hI,hJ){b1.New.call(this);this.map=hI;this.objects=hJ;},dz);dA.empty=function(){return eW.New(new cj.New([]));};dA.toSeq=function(hI){return bW.ToSeq(hI.map);};dA.find=function(hI,hJ){return hI.map.get_Item(hJ);};dA.add=function(hI,hJ,hK){hI.map=hI.map.Add(hJ,hK);};dA.containsKey=function(hI,hJ){return hI.map.ContainsKey(hJ);};dA.count=function(hI){return hI.map.get_Count();};dA.keys=function(hI){return co.map(function(hJ){return a.id(hJ[0],hJ[1]);},bW.ToSeq(hI.map));};dB=d.Ctmc=hB.Class({statespace_for_CME_integration:function(hI,hJ){var hK,hL,hM,hN,hO;function hP(hQ,hR){var hS;hS=bW.TryFind(hR,hQ);return hS==null?0:hS.$0;}hK=dA.count(this.graph);hL=dN.zeros(hK,hJ);hM=new a.Float64Array(hK);hN=bW.OfArray(ck.ofSeq(co.mapi(function(hQ,hR){return[hR,hQ];},dA.keys(this.graph))));hM[hN.get_Item(this.initial_state)]=1;hO=new d4.New(hK,hK);co.iteri(function(hQ,hR){var hT,hU,hV,hW,hX,hY,hZ,h0,h1;function hS(h2,h3){var h4;h4=ck.findIndex(function(h5){return h2===h5;},hU);ck.set(hW,h4,ck.get(hW,h4)+h3);}hT=co.sortBy(function(h2){return h2[0];},co.map(function(h2){return[hN.get_Item(h2.target),br["eval"](function(h3){return cY.find(hI,h3);},h2.propensity)];},hR[1]));hU=ck.ofSeq(co.distinct(co.map(function(h2){return h2[0];},hT)));hV=ck.length(hU);hW=ck.init(hV,function(){return 0;});co.iter(function(h2){return hS(h2[0],h2[1]);},hT);hX=ck.sum(hW);hY=hX===0?new f3.New$1(hW,hU,hV):new f3.New$1([-hX].concat(hW),[hQ].concat(hU),1+hV);hO.set_Item(hQ,hY);for(hZ=0,h0=hJ-1;hZ<=h0;hZ++){h1=+hP(hR[0],hZ);(ck.get(hL.MatrixData,hQ))[hZ]=h1;}},dA.toSeq(this.graph));return[hO,hL,hM];},statespace_for_CME_sundials:function(hI,hJ){var hK,hL,hM,hN,hO,hP,hQ,hR;function hS(hT,hU){var hV;hV=bW.TryFind(hU,hT);return hV==null?0:hV.$0;}hK=dA.count(this.graph);hL=dN.zeros(hK,hJ);hM=bW.OfArray(ck.ofSeq(co.mapi(function(hT,hU){return[hU,hT];},dA.keys(this.graph))));hN=hM.get_Item(this.initial_state);hO=ck.init(hK,function(hT){return hT===hN?1:0;});hP=ck.unzip3(ck.ofSeq(co.mapi(function(hT,hU){var hV,hW,hX,hY,hZ,h0,h1;hV=ck.ofSeq(co.sortBy(function(h2){return h2[0];},co.map(function(h2){return[hM.get_Item(h2.target),br["eval"](function(h3){return cY.find(hI,h3);},h2.propensity)];},hU[1])));hW=ck.unzip(hV);hX=hW[0];hY=ck.create(hX.length,hT);for(hZ=0,h0=hJ-1;hZ<=h0;hZ++){h1=+hS(hU[0],hZ);(ck.get(hL.MatrixData,hT))[hZ]=h1;}return[hX,hY,hW[1]];},dA.toSeq(this.graph))));hQ=hP[2];hR=ck.map(ck.sum,hQ);return[[ck.concat(hQ),ck.concat(hP[0]),ck.concat(hP[1]),hR],hL,hO];}},null,dB);dB.calculate_reaction_prop=function(hI,hJ,hK,hL){var hM,hP,hQ,hR,hS,hT;function hN(hU){var hV;hV=bW.TryFind(hU,hJ);return hV!=null&&hV.$==1?hV.$0:0;}function hO(hU){return hU.$==2?{$:1,$0:hN(hU.$0)}:hU.$==3?be.FailWith("Unexpected [time] in CTMC rate"):hU.$==1?br.expand(hO,hL.get_Item(hU.$0)):{$:0,$0:hU.$0};}hP=hK.rate;if(hP.$==1)return br.expand(hO,hP.$0);else{hQ=hP.$0;hR=Z.to_mlist(hK.reactants);switch(hR.$==1?hR.$0.multiplicity===1?hR.$1.$==1?hR.$1.$0.multiplicity===1?hR.$1.$1.$==0?(hM=[hR.$0.element,hR.$1.$0.element],4):(hM=hR,5):(hM=hR,5):(hM=hR.$0.element,1):hR.$0.multiplicity===2?hR.$1.$==0?(hM=hR.$0.element,2):(hM=hR,5):hR.$0.multiplicity===3?hR.$1.$==0?(hM=hR.$0.element,3):(hM=hR,5):(hM=hR,5):0){case 0:return hQ;case 1:return{$:2,$0:bX.ofArray([hQ,{$:1,$0:hN(hM)}])};case 2:hS={$:1,$0:hN(hM)};return{$:2,$0:bX.ofArray([hQ,hS,{$:6,$0:bu.New(hS,{$:1,$0:1})},{$:1,$0:0.5}])};case 3:hT={$:1,$0:hN(hM)};return{$:3,$0:bw.New({$:2,$0:bX.ofArray([hQ,hT,{$:6,$0:bu.New(hT,{$:1,$0:1})},{$:6,$0:bu.New(hT,{$:1,$0:2})}])},{$:1,$0:6})};case 4:return{$:2,$0:bX.ofArray([hQ,{$:1,$0:hN(hM[0])},{$:1,$0:hN(hM[1])}])};case 5:return dZ.fold_left(function(hU,hV){return{$:2,$0:bX.ofArray([hU,{$:1,$0:dZ.binom(be.toInt(hN(hV.element)),hV.multiplicity)}])};},hQ,hM);}}};dB.nonzero_prop=function(hI,hJ){return!cw.Equals(br.simplify(hJ),{$:1,$0:0});};dB.get_all_product_species=function(hI){return bX.collect(dB.get_product_species,hI);};dB.get_product_species=function(hI){return Z.elements(hI.products);};dB.New=function(hI,hJ){return new dB({graph:hI,initial_state:hJ});};dC.New=function(hI,hJ){return{target:hI,propensity:hJ};};dD.ofMap=function(hI){var hJ;hJ=dD.empty();bW.Iterate(function(hK,hL){return dD.add(hJ,hK,hL);},hI);return hJ;};dD.count=function(hI){return hI.count;};dD.iter=function(hI,hJ){var hK,hL;hK=df.Get(hJ);try{while(hK.MoveNext()){hL=hK.Current();hI(hL.K,hL.V);}}finally{if(typeof hK=="object"&&"Dispose"in hK)hK.Dispose();}};dD.find=function(hI,hJ){return hI.get_Item(hJ);};dD.empty=function(){return new ct.New$5();};dD.add=function(hI,hJ,hK){hI.set_Item(hJ,hK);};dD.tryFind=function(hI,hJ){return hI.ContainsKey(hJ)?{$:1,$0:hI.get_Item(hJ)}:null;};dD.to_list=function(hI){return dD.fold(function(hJ,hK,hL){return new bY({$:1,$0:[hJ,hK],$1:hL});},hI,bY.Empty);};dD.map=function(hI,hJ){var hK;hK=dD.empty();dD.iter(function(hL,hM){return dD.add(hK,hL,hI(hM));},hJ);return hK;};dD.map_key=function(hI,hJ){var hK;hK=dD.empty();dD.iter(function(hL,hM){return dD.add(hK,hI(hL),hM);},hJ);return hK;};dD.copy=function(hI){var hJ;hJ=dD.empty();dD.iter(function(hK,hL){return dD.add(hJ,hK,hL);},hI);return hJ;};dD.fold=function(hI,hJ,hK){var hL,hM,hN;hL=hK;hM=df.Get(hJ);try{while(hM.MoveNext()){hN=hM.Current();hL=hI(hN.K,hN.V,hL);}}finally{if(typeof hM=="object"&&"Dispose"in hM)hM.Dispose();}return hL;};c6.Add=function(hI,hJ){return c6.Put(function(hK,hL){return hL;},hI,hJ);};c6.Contains=function(hI,hJ){return!((c6.Lookup(hI,hJ))[0]==null);};c6.OfSeq=function(hI){var hJ;hJ=ck.ofSeq(co.distinct(hI));ck.sortInPlace(hJ);return c6.Build(hJ,0,hJ.length-1);};c6.TryFind=function(hI,hJ){var hK;hK=(c6.Lookup(hI,hJ))[0];return hK==null?null:{$:1,$0:hK.Node};};c6.Enumerate=function(hI,hJ){function hK(hL,hM){var hN;while(true)if(hL==null)return hM.$==1?{$:1,$0:[hM.$0[0],[hM.$0[1],hM.$1]]}:null;else if(hI){hN=hL;hL=hN.Right;hM=new bY({$:1,$0:[hN.Node,hN.Left],$1:hM});}else{hN=hL;hL=hN.Left;hM=new bY({$:1,$0:[hN.Node,hN.Right],$1:hM});}}return co.unfold(function(hL){return hK(hL[0],hL[1]);},[hJ,bY.Empty]);};c6.Put=function(hI,hJ,hK){var hL,hM;hL=c6.Lookup(hJ,hK);hM=hL[0];return hM==null?c6.Rebuild(hL[1],c6.Branch(hJ,null,null)):c6.Rebuild(hL[1],c6.Branch(hI(hM.Node,hJ),hM.Left,hM.Right));};c6.Remove=function(hI,hJ){var hK,hL,hM,hN;hK=c6.Lookup(hI,hJ);hL=hK[0];hM=hK[1];return hL==null?hJ:hL.Right==null?c6.Rebuild(hM,hL.Left):hL.Left==null?c6.Rebuild(hM,hL.Right):c6.Rebuild(hM,(hN=ck.ofSeq(co.append(c6.Enumerate(false,hL.Left),c6.Enumerate(false,hL.Right))),c6.Build(hN,0,hN.length-1)));};c6.Build=function(hI,hJ,hK){var hL,hM,hN;return hK-hJ+1<=0?null:(hL=(hJ+hK)/2>>0,(hM=c6.Build(hI,hJ,hL-1),(hN=c6.Build(hI,hL+1,hK),c6.Branch(ck.get(hI,hL),hM,hN))));};c6.Lookup=function(hI,hJ){var hK,hL,hM,hN;hK=[];hL=hJ;hM=true;while(hM)if(hL==null)hM=false;else{hN=cw.Compare(hI,hL.Node);hN===0?hM=false:hN===1?(hK.unshift([true,hL.Node,hL.Left]),hL=hL.Right):(hK.unshift([false,hL.Node,hL.Right]),hL=hL.Left);}return[hL,hK];};c6.Rebuild=function(hI,hJ){var hK,hM,hN,hO,hP,hQ,hR,hS,hT,hU;function hL(hV){return hV==null?0:hV.Height;}hK=hJ;for(hM=0,hN=ck.length(hI)-1;hM<=hN;hM++){hK=(hO=ck.get(hI,hM),hO[0]?(hP=hO[1],(hQ=hO[2],hL(hK)>hL(hQ)+1?hL(hK.Left)===hL(hK.Right)+1?(hR=hK.Left,c6.Branch(hR.Node,c6.Branch(hP,hQ,hR.Left),c6.Branch(hK.Node,hR.Right,hK.Right))):c6.Branch(hK.Node,c6.Branch(hP,hQ,hK.Left),hK.Right):c6.Branch(hP,hQ,hK))):(hS=hO[1],(hT=hO[2],hL(hK)>hL(hT)+1?hL(hK.Right)===hL(hK.Left)+1?(hU=hK.Right,c6.Branch(hU.Node,c6.Branch(hK.Node,hK.Left,hU.Left),c6.Branch(hS,hU.Right,hT))):c6.Branch(hK.Node,hK.Left,c6.Branch(hS,hK.Right,hT)):c6.Branch(hS,hK,hT))));}return hK;};c6.Branch=function(hI,hJ,hK){var hL,hM;return c7.New(hI,hJ,hK,1+(hL=hJ==null?0:hJ.Height,(hM=hK==null?0:hK.Height,cw.Compare(hL,hM)===1?hL:hM)),1+(hJ==null?0:hJ.Count)+(hK==null?0:hK.Count));};co.insufficient=function(){return be.FailWith("The input sequence has an insufficient number of elements.");};ck.countBy=function(hI,hJ){var hK,hL,hM,hN,hO;hK=new ct.New$5();hL=[];for(hM=0,hN=ck.length(hJ)-1;hM<=hN;hM++){hO=hI(hJ[hM]);hK.ContainsKey(hO)?hK.set_Item(hO,hK.get_Item(hO)+1):(hL.push(hO),hK.Add(hO,1));}ck.mapInPlace(function(hP){return[hP,hK.get_Item(hP)];},hL);return hL;};ck.groupBy=function(hI,hJ){var hK,hL,hM,hN,hO,hP;hK=new ct.New$5();hL=[];for(hM=0,hN=ck.length(hJ)-1;hM<=hN;hM++){hO=hJ[hM];hP=hI(hO);hK.ContainsKey(hP)?hK.get_Item(hP).push(hO):(hL.push(hP),hK.Add(hP,[hO]));}ck.mapInPlace(function(hQ){return[hQ,hK.get_Item(hQ)];},hL);return hL;};ck.mapInPlace=function(hI,hJ){var hK,hL;for(hK=0,hL=hJ.length-1;hK<=hL;hK++)hJ[hK]=hI(hJ[hK]);};bX.skip=function(hI,hJ){var hK,hL,hM;hK=hJ;for(hL=1,hM=hI;hL<=hM;hL++)if(hK.$==0)be.FailWith("Input list too short.");else hK=hK.$1;return hK;};ck.mapiInPlace=function(hI,hJ){var hK,hL;for(hK=0,hL=hJ.length-1;hK<=hL;hK++)hJ[hK]=hI(hK,hJ[hK]);return hJ;};co.nonNegative=function(){return be.FailWith("The input must be non-negative.");};ck.mapFold=function(hI,hJ,hK){var hL,hM,hN,hO,hP;hM=new a.Array(hK.length);hL=hJ;for(hN=0,hO=hK.length-1;hN<=hO;hN++){hP=hI(hL,hK[hN]);hM[hN]=hP[0];hL=hP[1];}return[hM,hL];};ck.contains=function(hI,hJ){var hK,hL,hM,hN;hK=true;hL=0;hN=ck.length(hJ);while(hK&&hL<hN)if(cw.Equals(hJ[hL],hI))hK=false;else hL=hL+1;return!hK;};ck.tryFindIndexBack=function(hI,hJ){var hK,hL;hK=null;hL=hJ.length-1;while(hL>=0&&hK==null){hI(ck.get(hJ,hL))?hK={$:1,$0:hL}:void 0;hL=hL-1;}return hK;};ck.mapFoldBack=function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ,hR,hS;hN=new a.Array(hJ.length);hL=hK;hO=hJ.length;for(hP=1,hQ=hO;hP<=hQ;hP++){hR=hO-hP;hS=hI(hJ[hR],hL);hN[hR]=hS[0];hL=hS[1];}return[hN,hL];};co.tryHead=function(hI){var hJ;hJ=df.Get(hI);try{return hJ.MoveNext()?{$:1,$0:hJ.Current()}:null;}finally{if(typeof hJ=="object"&&"Dispose"in hJ)hJ.Dispose();}};dE.New=function(hI,hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0,h1,h2){return{simulation:hI,stochastic:hJ,rates:hK,parameters:hL,random:hM,sidDict:hN,spDict:hO,rxDict:hP,plotDict:hQ,mustPlotAll:hR,printSpecies:hS,equalsSpecies:hT,matchesSpecies:hU,now:hV,stepsDone:hW,nextPrintTime:hX,events:hY,totalProp:hZ,nextSID:h0,nextRID:h1,dataPoints:h2};};dF.New=function(hI,hJ,hK,hL,hM,hN){return{id:hI,payload:hJ,population:hK,isExplored:hL,isConstant:hM,deps:hN};};dG.create=function(hI,hJ){return new dL.New(ck.create(hI,hJ));};dG.toArray=function(hI){return ck.init(hI.get_Length(),function(hJ){return dG.get(hI,hJ);});};dG.get=function(hI,hJ){return hI.get_Item(hJ);};dH.simulate_callback=function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ,hR;function hS(hT,hU,hV,hW){return function(hX){var hY,hZ,h0,h1,h2;hY=hX.time;hZ=dH.EuclideanNorm(dK.toArray((hQ(hT))(hV)))<=0?(hJ(bJ.New(hT,(hK.grab_data(hT))(hV))),hJ(bJ.New(hY,(hK.grab_data(hY))(hV))),[hY,hV,hM.stepsdone+1]):hL.stiff?dH.runSolver(e0.New(e1.init(hT,hV,hQ,(h0=e1.defaults(),e3.New(h0.InitialStepSize,hL.abstolerance,hL.reltolerance,h0.MaxStep,h0.MinStep,h0.MaxScale,h0.MinScale,h0.NumberOfIterations,h0.Jacobian))),a.id,e1.advance,null,function(h3){return h3.t;},function(h3){return h3.x;}),hT,hU,hY,hV,hM.stepsdone,function(h3,h4){return(hK.grab_data(h3))(h4);},hO,hI,hJ):dH.runSolver(e0.New(e4.init(hT,hV,hQ,(h1=e4.defaults(),e6.New(h1.InitialStepSize,hL.abstolerance,hL.reltolerance,h1.MaxStep,0.0001))),a.id,e4.advance,{$:1,$0:function(h3){return function(h4){return e4.add_interpolate(h3,h4);};}},function(h3){return h3.t;},function(h3){return h3.x;}),hT,hU,hY,hV,hM.stepsdone,function(h3,h4){return(hK.grab_data(h3))(h4);},hO,hI,hJ);h2=hZ[0];return[h2,h2+hO,dH.applyPertubation(hX.target,hZ[1],hN),hW];};}hL=hK.settings;hM=hK.simulator;hN=hM.populations;hO=hM.settings.get_print_interval();hP=bX.filter(function(hT){var hU;return hT.time>=hM.currenttime&&(hU=hT.target,hU.$==0?ck.exists(function(hV){return hV!==0;},hU.$0.get_get_pop_array()):true);},hM.events);hQ=hK.f;hR=co.fold(function(hT,hU){return(function(hV){return hS(hV[0],hV[1],hV[2],hV[3]);}(hT))(hU);},[hM.currenttime,hM.nextprinttime,hK.concs,hM.stepsdone],hP);return dI.New(hK.name,cF.New(hM.settings,hM.populations,hM.events,hR[0],hR[1],hR[3]),hK.grab_data,hK.interpolator,hK.settings,hK.f,hR[2]);};dH.create=function(hI,hJ,hK,hL,hM,hN,hO){return dI.New(hI,hJ,hK,hL,hM,hO,hN);};dH.EuclideanNorm=function(hI){return hC.sqrt(co.sumBy(function(hJ){return hJ*hJ;},hI));};dH.runSolver=function(hI,hJ,hK,hL,hM,hN,hO,hP,hQ,hR){var hS,hT,hU,hV,hW,hX,hY,hZ,h0;hS=true;hT=hJ;hU=hK;h0=[hM];hW=hN;hX=hI.init;hY=hI.init;hZ=true;while(hZ)(function(){var h1;hX=hY;hY=hI.advance(hX);return co.fold(function(h2,h3){var h4,h5,h6,h7,h8,h9,h_;return!hZ?null:(h4=hI.get_x(h3),h5=hI.get_time(h3),a.isNaN(h4[0])?dS.ode_solver_error("Solver produced bad solution. Try altering tolerances."):void 0,h6=U.shouldStop(hL,h5,hW,hQ,null)?[hL,dH.Lerp(hL,hT,h0[0],h5,h4)]:[h5,h4],h7=h6[0],hT===hL?(h8=0.99999999,hR(bJ.New(h8*hL+(1-h8)*(hT-hP),hO(hT,h0[0])))):void 0,h9=U.shouldPrint(hL,h7,hU,null,hS,hT)?(hR(bJ.New(hT,hO(hT,h0[0]))),h_=h7+hP,cw.Compare(h_,hL)===-1?h_:hL):hU,hQ[0]||hT===hL?(hZ=false,void(hT=h7)):(hS=false,hT=h7,hU=h9,h0[0]=h6[1],void(hW=hW+1)));},null,(h1=hI.refine,h1==null?bX.ofArray([hY]):bX.append((h1.$0(hX))(hY),bX.ofArray([hY]))));}());return[hT,h0[0],hW];};dH.applyPertubation=function(hI,hJ,hK){var hL;return hI=="OutputPoint"?hJ:(hL=bW.OfArray(ck.ofSeq(bX.map(function(hM){var hN;return[(hN=hK.tryFind_index(hM.species),hN==null?be.FailWith("Unknown species in event"):hN.$0),hM.value];},hI.$0.get_get_pop_info_list()))),dK.ofArray(ck.mapi(function(hM,hN){var hO;hO=bW.TryFind(hM,hL);return hO==null?hN:hN+hO.$0;},dK.toArray(hJ))));};dH.Lerp=function(hI,hJ,hK,hL,hM){return dK.scale(1/(hL-hJ),dK.add(dK.scale(hL-hI,hK),dK.scale(hI-hJ,hM)));};dI.New=function(hI,hJ,hK,hL,hM,hN,hO){return{name:hI,simulator:hJ,grab_data:hK,interpolator:hL,settings:hM,f:hN,concs:hO};};dK.toArray=function(hI){return a.Array.prototype.slice.call(hI);};dK.ofArray=function(hI){return new a.Float64Array(hI);};dK.add=function(hI,hJ){var hK,hL,hM,hN;dK.checkSize(hI,hJ);hK=hI.length;hL=new a.Float64Array(hK);for(hM=0,hN=hK-1;hM<=hN;hM++)hL[hM]=hI[hM]+hJ[hM];return hL;};dK.dot=function(hI,hJ){var hK,hL,hM;dK.checkSize(hI,hJ);hK=0;for(hL=0,hM=hI.length-1;hL<=hM;hL++)hK=hK+hI[hL]*hJ[hL];return hK;};dK.map=function(hI,hJ){var hK;hK=dK.copy(hJ);dK.update(hI,hK);return hK;};dK.sum=function(hI){var hJ,hK,hL;hJ=0;for(hK=0,hL=hI.length-1;hK<=hL;hK++)hJ=hJ+hI[hK];return hJ;};dK.map2=function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ;dK.checkSize(hJ,hK);hL=hJ.length;hM=new a.Float64Array(hL);for(hN=0,hO=hL-1;hN<=hO;hN++){hM[hN]=(hP=hJ[hN],(hQ=hK[hN],(hI(hP))(hQ)));}return hM;};dK.max=function(hI){var hJ,hK,hL,hM;hJ=0;for(hK=0,hL=hI.length-1;hK<=hL;hK++){hJ=(hM=hI[hK],cw.Compare(hJ,hM)===1?hJ:hM);}return hJ;};dK.scale=function(hI,hJ){var hK,hL,hM;hK=dK.copy(hJ);for(hL=0,hM=hK.length-1;hL<=hM;hL++)hK[hL]=hI*hK[hL];return hK;};dK.subtract=function(hI,hJ){var hK,hL,hM,hN;dK.checkSize(hI,hJ);hK=hI.length;hL=new a.Float64Array(hK);for(hM=0,hN=hK-1;hM<=hN;hM++)hL[hM]=hI[hM]-hJ[hM];return hL;};dK.copy=function(hI){var hJ;hJ=new a.Float64Array(hI.length);hJ.set(hI);return hJ;};dK.mapi2=function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ;dK.checkSize(hJ,hK);hL=hJ.length;hM=new a.Float64Array(hL);for(hN=0,hO=hL-1;hN<=hO;hN++){hM[hN]=(hP=hJ[hN],(hQ=hK[hN],((hI(hN))(hP))(hQ)));}return hM;};dK.checkSize=function(hI,hJ){if(hI.length!==hJ.length)be.FailWith("Vector dimensions do not match");};dK.update=function(hI,hJ){var hK,hL;for(hK=0,hL=hJ.length-1;hK<=hL;hK++)hJ[hK]=hI(hJ[hK]);};dK.setScaled=function(hI,hJ){var hK,hL,hM;hK=hJ.length;for(hL=0,hM=hK-1;hL<=hM;hL++)hJ[hL]=hI*hJ[hL];};dK.setAddedScaled=function(hI,hJ,hK){var hL,hM,hN;dK.checkSize(hI,hJ);hL=hI.length;for(hM=0,hN=hL-1;hM<=hN;hM++)hI[hM]=hI[hM]+hK*hJ[hM];};dL=d.VectorFS=hB.Class({set_Item:function(hI,hJ){ck.set(this.values,hI,hJ);},ToArray:function(){return dG.toArray(this);},get_Length:function(){return ck.length(this.values);},get_Item:function(hI){return ck.get(this.values,hI);}},b1,dL);dL.New=hB.Ctor(function(hI){b1.New.call(this);this.values=hI;},dL);dM=d.Lambda=hB.Class({get_key:function(){return this.$0;},Equals:function(hI){return hI instanceof dM&&this===hI;},GetHashCode:function(){return cw.Hash(this);}},null,dM);dN.matrMultVec=function(hI,hJ){var hK;hK=new a.Float64Array(dN.numRows(hI));dN.matrMultVecStore(hI,hJ,hK);return dK.ofArray(hK);};dN.ofArray=function(hI){return d0.New(ck.map(dK.ofArray,hI));};dN.matrMultMatr=function(hI,hJ){var hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW;hK=dN.numRows(hI);hL=dN.numCols(hI);hM=dN.numCols(hJ);hL!==dN.numRows(hJ)?be.FailWith("Matrix dimensions do not match"):null;hN=dN.zeros(hK,hM);for(hO=0,hP=hK-1;hO<=hP;hO++){hQ=hI.get_Item(hO);hR=hN.get_Item(hO);for(hS=0,hT=hM-1;hS<=hT;hS++){hU=0;for(hV=0,hW=hL-1;hV<=hW;hV++)hU=hU+hQ[hV]*(ck.get(hJ.MatrixData,hV))[hS];hR[hS]=hU;}}return hN;};dN.add=function(hI,hJ){dN.sameSizeCheck(hI,hJ);return d0.New(ck.map2(dK.add,hI.MatrixData,hJ.MatrixData));};dN.numRows=function(hI){return ck.length(hI.MatrixData);};dN.matrMultVecStore=function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ,hR;for(hL=0,hM=dN.numRows(hI)-1;hL<=hM;hL++){hN=0;hP=hI.get_Item(hL);for(hQ=0,hR=dN.numCols(hI)-1;hQ<=hR;hQ++)hN=hN+hP[hQ]*hJ[hQ];ck.set(hK,hL,hN);}};dN.numCols=function(hI){return ck.get(hI.MatrixData,0).length;};dN.zeros=function(hI,hJ){return d0.New(ck.init(hI,function(){return new a.Float64Array(hJ);}));};dN.sameSizeCheck=function(hI,hJ){var hK,hL;hK=dN.numRows(hI);hL=dN.numCols(hI);hK!==dN.numRows(hJ)||hL!==dN.numCols(hJ)?be.FailWith("Matrix dimensions do not match"):void 0;};dN.toArray=function(hI){return ck.init(dN.numRows(hI),function(hJ){return dK.toArray(dN.copyRow(hI,hJ));});};dN.copyCol=function(hI,hJ){var hK,hL,hM,hN;hK=dN.numRows(hI);hL=new a.Float64Array(hK);for(hM=0,hN=hK-1;hM<=hN;hM++)hL[hM]=(ck.get(hI.MatrixData,hM))[hJ];return hL;};dN.ofRows=function(hI){return d0.New(ck.map(dK.copy,hI));};dN.matrMultScal=function(hI,hJ){return dN.scalMultMatr(hJ,hI);};dN.copyRow=function(hI,hJ){return dK.copy(hI.get_Item(hJ));};dN.copy=function(hI){return d0.New(ck.map(dK.copy,hI.MatrixData));};dN.scalMultMatr=function(hI,hJ){return d0.New(ck.map(function(hK){return dK.scale(hI,hK);},hJ.MatrixData));};dN.subtract=function(hI,hJ){dN.sameSizeCheck(hI,hJ);return d0.New(ck.map2(dK.subtract,hI.MatrixData,hJ.MatrixData));};dN.identity=function(hI,hJ){var hK,hL,hM,hN,hO;hK=dN.zeros(hI,hJ);for(hL=0,hM=(hN=hI-1,(hO=hJ-1,cw.Compare(hN,hO)===-1?hN:hO));hL<=hM;hL++)(ck.get(hK.MatrixData,hL))[hL]=1;return hK;};dN.vectorProduct=function(hI,hJ){var hK,hL,hM,hN,hO,hP,hQ,hR;hK=hI.length;hL=hJ.length;hM=dN.zeros(hK,hL);for(hN=0,hO=hK-1;hN<=hO;hN++){for(hP=0,hQ=hL-1;hP<=hQ;hP++){hR=hI[hN]*hJ[hP];(ck.get(hM.MatrixData,hN))[hP]=hR;}}return hM;};dP=dO.Random=hB.Class({NextDouble:function(){var hI;hI=this.rng[0].Microsoft_Research_Filzbach_Lib_IRng$NextDouble();this.rng[0]=hI[1];return hI[0];},Next$1:function(){var hI;hI=this.rng[0].Microsoft_Research_Filzbach_Lib_IRng$NextInt32();this.rng[0]=hI[1];return be.toInt(hI[0]);}},b1,dP);dP.New$1=hB.Ctor(function(hI){b1.New.call(this);this.rng=[new e8.New(hI)];},dP);dP.New=hB.Ctor(function(){var hI;dP.New$1.call(this,hC.abs(be.toInt((hI=hF.now(),hI*10000))));},dP);dQ=d.Event=hB.Class({},null,dQ);dQ.create=function(hI,hJ){return dQ.New(hJ,{$:0,$0:hI});};dQ.New=function(hI,hJ){return new dQ({time:hI,target:hJ});};dR.New=function(hI,hJ,hK){return{reaction:hI,propensity:hJ,dependencies:hK};};dT=dS.EngineException=hB.Class({},db,dT);dT.New=hB.Ctor(function(hI){this.message=hI;da.setPrototypeOf(this,dT.prototype);},dT);dU=dS.SimulatorErrorException=hB.Class({},dT,dU);dU.New=hB.Ctor(function(hI){dT.New.call(this,"Simulator error: "+hI);},dU);dV.New=function(hI,hJ,hK,hL,hM){return{id:hI,payload:hJ,reacts:hK,prods:hL,prop:hM};};dW.New=function(hI,hJ){return{x:hI,y:hJ};};dX.New=function(hI,hJ){return{box_group:hI,box_dim:hJ};};dY.New=function(hI,hJ,hK,hL,hM,hN){return{name:hI,content:hJ,anchors:hK,debug_anchors:hL,sub_groups:hM,offset:hN};};dZ.fold_left=function(hI,hJ,hK){return co.fold(hI,hJ,hK);};dZ.trd3=function(hI,hJ,hK){return hK;};dZ.snd3=function(hI,hJ,hK){return hJ;};dZ.fst3=a.id;dZ.option_map2=function(hI,hJ){return dZ.option_map(function(hK){return{$:1,$0:hI(hK)};},null,hJ);};dZ.rev_map=function(hI,hJ){var hK,hL,hM,hN;hK=bY.Empty;hL=hJ;while(true)if(hL.$==1){hM=hL.$1;hN=hL.$0;hK=new bY({$:1,$0:hI(hN),$1:hK});hL=hM;}else return hK;};dZ.remove_duplicates=function(hI,hJ){return bX.rev(function(hK,hL){var hM,hN;while(true)if(hK.$==1){hM=hK.$1;hN=hK.$0;if(bX.exists(function(hO){return function(hP){return hI(hO,hP);};}(hN),hL))hK=hM;else{hK=hM;hL=new bY({$:1,$0:hN,$1:hL});}}else return hL;}(hJ,bY.Empty));};dZ.collect=function(hI,hJ){return bX.collect(hI,hJ);};dZ.string_of_list=function(hI,hJ,hK){var hL,hM,hN,hO;hL="";hM=hK;while(true)if(hM.$==1){if(hM.$1.$==0)return hL+hI(hM.$0);else{hN=hM.$0;hO=hM.$1;hL=hL+hI(hN)+hJ;hM=hO;}}else return hL;};dZ.fold_right=function(hI,hJ,hK){return bX.foldBack(hI,hJ,hK);};dZ.binom=function(hI,hJ){return be.toInt(co.fold(function(hK,hL){return hC.trunc(hK*(hI-hL+1)/hL);},1,bX.ofSeq(be.range(1,hJ))));};dZ.option_map=function(hI,hJ,hK){return hK!=null&&hK.$==1?hI(hK.$0):hJ;};dZ.forall2=function(hI,hJ,hK){return bX.length(hJ)===bX.length(hK)&&bX.forall2(hI,hJ,hK);};dZ.id=a.id;dZ.display_float=function(hI){var hJ;return hI===a.Infinity?"Infinity":hI===a.NaN?"NaN":a.isNaN(hI)?"NaN":(hJ=a.String(hI),hJ.indexOf(".")!=-1||hJ.indexOf("e")!=-1||hJ.indexOf("E")!=-1?hJ:hJ+".0");};dZ.emit_record=function(hI,hJ,hK){var hL;function hM(hN,hO){return hO(hK)===hO(hI)?null:{$:1,$0:(((hB.Curried3(function(hP,hQ,hR){return hP(cA.toSafe(hQ)+"="+cA.toSafe(hR));}))(a.id))(hN))(hO(hK))};}hL=cS.concat("; ",bX.choose(function(hN){return hM(hN[0],hN[1]);},hJ));return(function(hN){return function(hO){return hN("{"+cA.toSafe(hO)+"}");};}(a.id))(hL);};dZ.fac=function(hI){return dZ.fold_left(function(hJ,hK){return hJ*hK;},1,bX.ofSeq(be.range(2,hI)));};dZ.update_map=function(hI,hJ){return bW.Fold(function(hK,hL,hM){return hK.Add(hL,hM);},bW.Fold(function(hK,hL,hM){return hK.Add(hL,hM);},new cj.New(bY.Empty),hI),hJ);};dZ.disjoint=function(hI,hJ,hK){return dZ.forall(function(hL){return!bX.exists(function(hM){return hI(hL,hM);},hK);},hJ);};dZ.union=function(hI,hJ,hK){var hL,hM,hN,hO;hL=bX.rev(hJ);hM=dZ.remove_duplicates(hI,hK);while(true)if(hL.$==1){hN=hL.$1;hO=hL.$0;hL=hN;hM=dZ.maybecons(hI,hO,hM);}else return hM;};dZ.try_assoc=function(hI,hJ){function hK(hL,hM){return cw.Equals(hL,hI)?{$:1,$0:hM}:null;}return co.tryPick(function(hL){return hK(hL[0],hL[1]);},hJ);};dZ.contains=function(hI,hJ){var hK,hL;while(true)if(hJ.$==1){hK=hJ.$1;hL=hJ.$0;if(cw.Equals(hI,hL))return true;else hJ=hK;}else return false;};dZ.find_duplicate=function(hI,hJ){var hK,hL;while(true)if(hJ.$==1){hK=hJ.$1;hL=hJ.$0;if(bX.exists(function(hM,hN){return function(hO){return(hM(hN))(hO);};}(hI,hL),hK))return{$:1,$0:hL};else hJ=hK;}else return null;};dZ.difference=function(hI,hJ,hK){var hL,hM,hN,hO;hL=bY.Empty;hM=hJ;while(true)if(hM.$==1){hN=hM.$1;hO=hM.$0;if(bX.exists(function(hP){return function(hQ){return hI(hP,hQ);};}(hO),hK))hM=hN;else{hL=bX.append(hL,bX.ofArray([hO]));hM=hN;}}else return hL;};dZ.newline=function(){g9.$cctor();return g9.newline;};dZ.forall=function(hI,hJ){return bX.forAll(hI,hJ);};dZ.maybecons=function(hI,hJ,hK){return bX.exists(function(hL){return hI(hJ,hL);},hK)?hK:new bY({$:1,$0:hJ,$1:hK});};dZ.map_pairs=function(hI,hJ){var hK;return hJ.$==1?hJ.$1.$==1?(hK=hI([hJ.$0,hJ.$1.$0]),new bY({$:1,$0:hK[0],$1:dZ.map_pairs(hI,new bY({$:1,$0:hK[1],$1:hJ.$1.$1}))})):bX.ofArray([hJ.$0]):bY.Empty;};dZ.glue=function(hI,hJ){return hI.$==1?hJ.$==1?hI.$1.$==0?new bY({$:1,$0:bX.append(hI.$0,hJ.$0),$1:hJ.$1}):new bY({$:1,$0:hI.$0,$1:dZ.glue(hI.$1,new bY({$:1,$0:hJ.$0,$1:hJ.$1}))}):hI:hJ;};dZ.separate=function(hI){return hI.$==1?hI.$1.$==0?bX.ofArray([bX.ofArray([hI.$0])]):new bY({$:1,$0:bX.ofArray([hI.$0]),$1:dZ.separate(hI.$1)}):bX.ofArray([bY.Empty]);};dZ.tuple_to_string=function(hI){return hI.$==1?hI.$1.$==0?hI.$0:"("+cS.concat(",",hI)+")":"";};dZ.is_permutation=function(hI,hJ,hK){return bX.length(hJ)===bX.length(hK)&&function(hL,hM){var hN,hO,hP;while(true){hN=hL;hO=hM;if(hN.$==1){if(hO.$==1){hP=dZ.remove_first(hI,hN.$0,hM);hL=hN.$1;hM=hP;}else return false;}else return hO.$==0;}}(hJ,hK);};dZ.intersection=function(hI,hJ,hK){return bX.filter(function(hL){return bX.exists(function(hM){return hI(hM,hL);},hJ);},hK);};dZ.string_of_char=a.id;dZ.paren=function(hI){return"("+hI+")";};dZ.remove_first=function(hI,hJ,hK){var hL,hM;return hK.$==1?(hL=hK.$1,(hM=hK.$0,(hI(hJ))(hM)?hL:new bY({$:1,$0:hM,$1:dZ.remove_first(hI,hJ,hL)}))):bY.Empty;};dZ.collect_union=function(hI,hJ,hK){return dZ.fold_left(function(hL,hM){return dZ.union(hI,hL,hJ(hM));},bY.Empty,hK);};dZ.collect_contextual=function(hI,hJ){var hK,hL,hM,hN,hO;hK=bY.Empty;hL=bY.Empty;hM=hJ;while(true)if(hM.$==1){hN=hM.$0;hO=hM.$1;hK=bX.append(hK,hI(hL,hN,hO));hL=bX.append(hL,bX.ofArray([hN]));hM=hO;}else return hK;};dZ.get_last_element=function(hI){var hJ,hK,hL,hM;hJ=hI;hK=bY.Empty;while(true)if(hJ.$==1){if(hJ.$1.$==0)return{$:1,$0:[hK,hJ.$0]};else{hL=hJ.$0;hM=hJ.$1;hJ=hM;hK=bX.append(hK,bX.ofArray([hL]));}}else return null;};dZ.default_leak_rate_l=function(){g9.$cctor();return g9.default_leak_rate_l;};dZ.default_toehold_unbind_rate=function(){g9.$cctor();return g9.default_toehold_unbind_rate;};dZ.map_last=function(hI,hJ){return hJ.$==1?hJ.$1.$==0?bX.ofArray([hI(hJ.$0)]):new bY({$:1,$0:hJ.$0,$1:dZ.map_last(hI,hJ.$1)}):bY.Empty;};dZ.map_first=function(hI,hJ){return hJ.$==1?new bY({$:1,$0:hI(hJ.$0),$1:hJ.$1}):bY.Empty;};dZ.unoption=function(hI){return hI!=null&&hI.$==1?hI.$0:be.FailWith("unoption");};dZ.split_around_sublist=function(hI,hJ){var hK,hL,hM,hO,hP,hQ;hK=bY.Empty;hL=bY.Empty;hM=hJ;function hN(hR,hS){var hT,hU;while(true){hT=hR;hU=hS;if(hT.$==1){if(hU.$==1){if(cw.Equals(hT.$0,hU.$0)){hR=hT.$1;hS=hU.$1;}else return null;}else return null;}else return{$:1,$0:hU};}}while(true)if(hM.$==1){hO=hM.$1;hP=hM.$0;hQ=hN(hI,hM);if(hQ==null){hL=bX.append(hL,bX.ofArray([hP]));hM=hO;}else{hK=bX.append(hK,bX.ofArray([[hL,hQ.$0]]));hL=bX.append(hL,bX.ofArray([hP]));hM=hO;}}else return hK;};dZ.is_last=function(hI,hJ){var hK;hK=dZ.get_last_element(hJ);return hK!=null&&hK.$==1&&cw.Equals(hI,hK.$0[1]);};dZ.is_first=function(hI,hJ){return hJ.$==1&&cw.Equals(hI,hJ.$0);};dZ.option_or=function(hI){var hJ;while(true)if(hI.$==1){if(hI.$0==null){hJ=hI.$1;hI=hJ;}else return{$:1,$0:hI.$0.$0};}else return null;};d0=dJ.Matrix=hB.Class({get_Item:function(hI){return ck.get(this.MatrixData,hI);}},null,d0);d0.New=function(hI){return new d0({MatrixData:hI});};d1.array=function(hI,hJ,hK){return hJ==null?hK!=null&&hK.$==1?hI.slice(0,hK.$0+1):[]:hK==null?hI.slice(hJ.$0):hI.slice(hJ.$0,hK.$0+1);};d2.alreadyAdded=function(){return be.FailWith("An item with the same key has already been added.");};d2.notPresent=function(){return be.FailWith("The given key was not present in the dictionary.");};d2.equals=function(hI){return function(hJ,hK){return hI.CEquals(hJ,hK);};};d2.getHashCode=function(hI,hJ){return hI.CGetHashCode(hJ);};d4=d3.SparseMatrix=hB.Class({times$2:function(hI){var hJ,hK,hL,hM,hN,hO;hJ=ck.create(this.rows,0);for(hK=0,hL=this.rows-1;hK<=hL;hK++)if(cw.Equals(ck.get(this.indices,hK).length==0,false)){hM=0;for(hN=0,hO=ck.get(this.count,hK)-1;hN<=hO;hN++)hM=hM+ck.get(ck.get(this.items,hK),hN)*ck.get(hI,ck.get(ck.get(this.indices,hK),hN));ck.set(hJ,hK,hM);}return hJ;},timesRight:function(hI){var hJ,hK,hL,hM,hN,hO,hP,hQ,hR;hJ=ck.create(this.cols,0);for(hK=0,hL=this.rows-1;hK<=hL;hK++){hM=ck.get(this.indices,hK);hN=ck.get(hI,hK);hO=ck.get(this.items,hK);for(hP=0,hQ=ck.length(hM)-1;hP<=hQ;hP++){hR=ck.get(hM,hP);ck.set(hJ,hR,ck.get(hJ,hR)+hN*ck.get(hO,hP));}}return hJ;},set_Item:function(hI,hJ){ck.set(this.indices,hI,hJ.get_Indices());ck.set(this.items,hI,hJ.get_Items());ck.set(this.count,hI,hJ.get_Length());},minus:function(hI){var hJ,hK,hL,hM;hJ=new d4.New(this.rows,this.cols);for(hK=0,hL=this.rows-1;hK<=hL;hK++){hM=this.get_Item(hK).minus(hI.get_Item(hK));hJ.set_Items$1(hK,hM.get_Items());hJ.set_Indices$1(hK,hM.get_Indices());hJ.set_CountElem(hK,hM.get_Count());}return hJ;},times$1:function(hI){var hJ,hK,hL,hM,hN;hJ=new d4.New(this.rows,this.cols);for(hK=0,hL=this.rows-1;hK<=hL;hK++)if(cw.Equals(ck.get(this.indices,hK).length==0,false)){hJ.set_Indices$1(hK,ck.create(ck.get(this.count,hK),0));hJ.set_Items$1(hK,ck.create(ck.get(this.count,hK),0));for(hM=0,hN=ck.get(this.count,hK)-1;hM<=hN;hM++){hJ.set_Indices(hK,hM,ck.get(ck.get(this.indices,hK),hM));hJ.set_Items(hK,hM,hI*ck.get(ck.get(this.items,hK),hM));}hJ.set_CountElem(hK,ck.get(this.count,hK));}return hJ;},get_Item:function(hI){return new f3.New$1(ck.get(this.items,hI),ck.get(this.indices,hI),this.cols);},set_Items$1:function(hI,hJ){ck.set(this.items,hI,hJ);},set_Indices$1:function(hI,hJ){ck.set(this.indices,hI,hJ);},set_CountElem:function(hI,hJ){ck.set(this.count,hI,hJ);},set_Indices:function(hI,hJ,hK){ck.set(ck.get(this.indices,hI),hJ,hK);},set_Items:function(hI,hJ,hK){ck.set(ck.get(this.items,hI),hJ,hK);},get_RowDimension:function(){return this.rows;},get_Items:function(hI,hJ){return ck.get(ck.get(this.items,hI),hJ);},ScaleRow:function(hI,hJ,hK,hL){var hM,hN;for(hM=0,hN=ck.get(this.count,hI)-1;hM<=hN;hM++)if(ck.get(ck.get(this.indices,hI),hM)>=hJ&&ck.get(ck.get(this.indices,hI),hM)<=hK)ck.set(ck.get(this.items,hI),hM,ck.get(ck.get(this.items,hI),hM)*hL);},SwitchRows:function(hI,hJ){var hK,hL,hM;hK=ck.get(this.items,hI);hL=ck.get(this.indices,hI);hM=ck.get(this.count,hI);ck.set(this.items,hI,ck.get(this.items,hJ));ck.set(this.indices,hI,ck.get(this.indices,hJ));ck.set(this.count,hI,ck.get(this.count,hJ));ck.set(this.items,hJ,hK);ck.set(this.indices,hJ,hL);ck.set(this.count,hJ,hM);},get_Item$1:function(hI,hJ){var hK,hL,hM;return hI<0||hJ<0||hI>=this.rows||hJ>=this.cols?be.FailWith("Element index is out of range"):cw.Equals(ck.get(this.indices,hI),null)?0:(hK=(hL=ck.tryFindIndex(function(hN){return hN===hJ;},d1.array(ck.get(this.indices,hI),{$:1,$0:0},{$:1,$0:ck.get(this.count,hI)-1})),hL==null?ck.forall(function(hN){return hN<hJ;},d1.array(ck.get(this.indices,hI),{$:1,$0:0},{$:1,$0:ck.get(this.count,hI)-1}))?~ck.get(this.count,hI):(hM=ck.tryFindIndex(function(hN){return hN>hJ;},d1.array(ck.get(this.indices,hI),{$:1,$0:0},{$:1,$0:ck.get(this.count,hI)-1})),hM==null?-1:~hM.$0):hL.$0),hK<0?0:ck.get(ck.get(this.items,hI),hK));},set_Item$1:function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ;if(hI<0||hJ<0||hI>=this.rows||hJ>=this.cols)be.FailWith("Element index is out of range");else if(ck.get(this.indices,hI).length==0||ck.get(this.indices,hI).length<1){ck.set(this.indices,hI,ck.create(1,0));ck.set(this.items,hI,ck.create(1,0));ck.set(ck.get(this.indices,hI),0,hJ);ck.set(ck.get(this.items,hI),0,hK);ck.set(this.count,hI,1);}else{hN=(hL=ck.tryFindIndex(function(h0){return h0===hJ;},d1.array(ck.get(this.indices,hI),{$:1,$0:0},{$:1,$0:ck.get(this.count,hI)-1})),hL==null?ck.forall(function(h0){return h0<hJ;},d1.array(ck.get(this.indices,hI),{$:1,$0:0},{$:1,$0:ck.get(this.count,hI)-1}))?~ck.get(this.count,hI):(hM=ck.tryFindIndex(function(h0){return h0>hJ;},d1.array(ck.get(this.indices,hI),{$:1,$0:0},{$:1,$0:ck.get(this.count,hI)-1})),hM==null?-1:~hM.$0):hL.$0);if(hN>=0)ck.set(ck.get(this.items,hI),hN,hK);else{hO=~hN;if(ck.get(this.count,hI)>=ck.length(ck.get(this.items,hI))){hP=hC.min(16,this.cols-ck.length(this.items));hQ=ck.create(this.indices.length+hP,0);hR=ck.create(this.items.length+hP,0);for(hS=0,hT=hO-1;hS<=hT;hS++)ck.set(hQ,hS,ck.get(ck.get(this.indices,hI),hS));for(hU=0,hV=hO-1;hU<=hV;hU++)ck.set(hR,hU,ck.get(ck.get(this.items,hI),hU));for(hW=0,hX=ck.get(this.count,hI)-hO-1;hW<=hX;hW++){ck.set(hQ,ck.get(this.count,hI)-hW,ck.get(ck.get(this.indices,hI),ck.get(this.count,hI)-hW-1));ck.set(hR,ck.get(this.count,hI)-hW,ck.get(ck.get(this.items,hI),ck.get(this.count,hI)-hW-1));}ck.set(this.items,hI,hR);ck.set(this.indices,hI,hQ);}else{for(hY=0,hZ=ck.get(this.count,hI)-hO-1;hY<=hZ;hY++){ck.set(ck.get(this.indices,hI),ck.get(this.count,hI)-hY,ck.get(ck.get(this.indices,hI),ck.get(this.count,hI)-hY-1));ck.set(ck.get(this.items,hI),ck.get(this.count,hI)-hY,ck.get(ck.get(this.items,hI),ck.get(this.count,hI)-hY-1));}}ck.set(this.count,hI,ck.get(this.count,hI)+1);ck.set(ck.get(this.indices,hI),hO,hJ);ck.set(ck.get(this.items,hI),hO,hK);}}}},b1,d4);d4.New$1=hB.Ctor(function(hI,hJ,hK,hL,hM){b1.New.call(this);this.rows=hI;this.cols=hJ;this.items=hK;this.indices=hL;this.count=hM;},d4);d4.New=hB.Ctor(function(hI,hJ){d4.New$1.call(this,hI,hJ,ck.init(hI,function(){return[];}),ck.init(hI,function(){return[];}),ck.create(hI,0));},d4);d6.neumann_solve=function(hI,hJ,hK,hL,hM){var hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW;hN=hL.numspecies;hO=hL.nx;hP=hL.dt;hQ=(hL.xmax-hL.xmin)/(hL.nx-1);hR=ck.map(function(hX){return hX*hP/(hQ*hQ);},hL.D);hS=ck.init(hN,function(hX){return ck.concat([[0],ck.create(hO-1,ck.get(hR,hX))]);});hT=ck.init(hN,function(hX){return ck.concat([[2-ck.get(hR,hX)],ck.create(hO-2,2-2*ck.get(hR,hX)),[2-ck.get(hR,hX)]]);});hU=ck.init(hN,function(hX){return ck.concat([ck.create(hO-1,ck.get(hR,hX)),[0]]);});hV=ck.init(hN,function(hX){var hY,hZ,h0,h1,h2,h3,h4,h5;hY=ck.get(hR,hX);hZ=-hY;h0=2+2*hY;h1=-hY;h2=hM===1?[ck.create(hO,hZ),ck.concat([[2+hY],ck.create(hO-2,h0),[2+hY]]),ck.create(hO,h1)]:hM===2?[ck.concat([[-hY*2/3],ck.create(hO-1,hZ)]),ck.concat([[2+hY*2/3],ck.create(hO-2,h0),[2+hY*2/3]]),ck.concat([ck.create(hO-1,h1),[-hY*2/3]])]:(function(h6){return function(h7){return h6("No order "+a.String(h7)+" approximation defined for zero-flux 1d solver");};}(be.FailWith))(hM);h3=h2[2];h4=h2[1];h5=h2[0];return function(h6){return e$.TridiagonalAlgorithm(h5,h4,h3,h6);};});hW=ck.length(hL.plotlocs);return d6.solver(hI,hJ,hK,hO,hN,hR,hV,hS,hT,hU,function(hX){return ck.init(hO,function(hY){return ck.init(hW,function(hZ){return ck.get(ck.get(hX,ck.get(hL.plotlocs,hZ)),hY);});});},hL);};d6.periodic_solve=function(hI,hJ,hK,hL){var hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV;hM=hL.numspecies;hN=hL.nx-1;hO=hL.dt;hP=(hL.xmax-hL.xmin)/(hL.nx-1);hQ=ck.map(function(hW){return hW*hO/(hP*hP);},hL.D);hR=ck.init(hM,function(hW){var hX,hY,hZ,h0,h1,h2,h3,h4,h5,h6,h7;hX=ck.get(hQ,hW);hY=-hX;hZ=2*(1+hX);h0=-hX;h1=ck.create(hN,hY);h2=ck.concat([[2*hZ],ck.create(hN-2,hZ),[hZ+hY*h0/hZ]]);h3=ck.create(hN,h0);h4=-hZ;h5=ck.concat([[h4],ck.create(hN-2,0),[h0]]);h6=ck.concat([[1],ck.create(hN-2,0),[hY/h4]]);h7=e$.TridiagonalAlgorithm(h1,h2,h3,h5);return function(h8){return e$.ApplySMInvertMatrix(h1,h2,h3,h8,h6,h7);};});hS=ck.init(hM,function(hW){return ck.create(hN,ck.get(hQ,hW));});hT=ck.init(hM,function(hW){return ck.create(hN,2*(1-ck.get(hQ,hW)));});hU=ck.init(hM,function(hW){return ck.create(hN,ck.get(hQ,hW));});hV=ck.length(hL.plotlocs);return d6.solver(hI,hJ,hK,hN,hM,hQ,hR,hS,hT,hU,function(hW){return ck.init(hL.nx,function(hX){return ck.init(hV,function(hY){return hX<hN?ck.get(ck.get(hW,ck.get(hL.plotlocs,hY)),hX):ck.get(ck.get(hW,ck.get(hL.plotlocs,hY)),0);});});},hL);};d6.solver=function(hI,hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT){var hU,hV,hW,hX,hY,hZ,h0,h1,h2,h3;hU=hI;hV=ck.init(hM,function(){return ck.create(hL,0);});hW=ck.init(hM,function(){return ck.create(hL,0);});hX=ck.create(hM,0);hY=ck.create(hL,0);hZ=hT.dt;for(h0=0,h1=hM-1;h0<=h1;h0++){for(h2=0,h3=hL-1;h2<=h3;h2++)ck.set(ck.get(hV,h0),h2,ck.get(ck.get(hJ,h2),h0));}return co.delay(function(){return co.append([d7.New(hU,hS(hV))],co.delay(function(){return co.append(co.enumWhile(function(){return hU<hT.tmax;},co.delay(function(){return co.append(co.collect(function(){hU=hU+hZ;return co.append(co.collect(function(h4){return co.append(co.collect(function(h5){ck.set(hX,h5,ck.get(ck.get(hV,h5),h4));return[];},be.range(0,hM-1)),co.delay(function(){var h5;h5=hK(hU,hX);return co.collect(function(h6){ck.set(ck.get(hW,h6),h4,ck.get(h5,h6)*hZ);return[];},be.range(0,hM-1));}));},be.range(0,hL-1)),co.delay(function(){return co.collect(function(h4){return ck.get(hN,h4)>0?co.append(co.collect(function(h5){var h6,h7;h6=ck.get(ck.get(hV,h4),(h5-1+hL)%hL);h7=ck.get(ck.get(hV,h4),(h5+1)%hL);ck.set(hY,h5,ck.get(ck.get(hP,h4),h5)*h6+ck.get(ck.get(hQ,h4),h5)*ck.get(ck.get(hV,h4),h5)+ck.get(ck.get(hR,h4),h5)*h7+2*ck.get(ck.get(hW,h4),h5));return[];},be.range(0,hL-1)),co.delay(function(){ck.set(hV,h4,(ck.get(hO,h4))(hY));return[];})):(ck.set(hV,h4,ck.map2(function(h5,h6){return h5+h6;},ck.get(hV,h4),ck.get(hW,h4))),[]);},be.range(0,hM-1));}));},be.range(0,hT.thin-1)),co.delay(function(){return[d7.New(hU,hS(hV))];}));})),co.delay(function(){return[];}));}));});};d7.New=function(hI,hJ){return{t:hI,u:hJ};};d9.New=function(hI,hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS){return{numspecies:hI,thin:hJ,nx:hK,xmin:hL,xmax:hM,ymin:hN,ymax:hO,tmax:hP,dt:hQ,D:hR,plotlocs:hS};};d_.neumann_solve=function(hI,hJ,hK,hL){var hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV;hM=hL.numspecies;hN=hL.nx;hO=hL.dt*0.5;hP=(hL.xmax-hL.xmin)/(hL.nx-1);hQ=ck.map(function(hW){return hW*hO/(hP*hP);},hL.D);hR=ck.init(hM,function(hW){return ck.concat([[0],ck.create(hN-1,ck.get(hQ,hW))]);});hS=ck.init(hM,function(hW){return ck.concat([[1-ck.get(hQ,hW)],ck.create(hN-2,1-2*ck.get(hQ,hW)),[1-ck.get(hQ,hW)]]);});hT=ck.init(hM,function(hW){return ck.concat([ck.create(hN-1,ck.get(hQ,hW)),[0]]);});hU=ck.init(hM,function(hW){var hX,hY,hZ,h0;hX=ck.get(hQ,hW);hY=ck.create(hN,-hX);hZ=ck.concat([[1+hX],ck.create(hN-2,1+2*hX),[1+hX]]);h0=ck.create(hN,-hX);return function(h1){return e$.TridiagonalAlgorithm(hY,hZ,h0,h1);};});hV=ck.length(hL.plotlocs);return d_.solver(hI,hJ,hK,hN,hM,hQ,hU,hR,hS,hT,function(hW){return ck.init(hN,function(hX){return ck.init(hN,function(hY){return ck.init(hV,function(hZ){return ck.get(ck.get(ck.get(hW,ck.get(hL.plotlocs,hZ)),hX),hY);});});});},hL);};d_.periodic_solve=function(hI,hJ,hK,hL){var hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV;hM=hL.numspecies;hN=hL.nx;hO=hL.dt*0.5;hP=(hL.xmax-hL.xmin)/(hL.nx-1);hQ=ck.map(function(hW){return hW*hO/(hP*hP);},hL.D);hR=ck.init(hM,function(hW){return ck.create(hN-1,ck.get(hQ,hW));});hS=ck.init(hM,function(hW){return ck.create(hN-1,1-2*ck.get(hQ,hW));});hT=ck.init(hM,function(hW){return ck.create(hN-1,ck.get(hQ,hW));});hU=ck.init(hM,function(hW){var hX,hY,hZ,h0,h1,h2,h3,h4,h5,h6,h7;hX=ck.get(hQ,hW);hY=-hX;hZ=1+2*hX;h0=-hX;h1=ck.create(hN-1,hY);h2=ck.concat([[2*hZ],ck.create(hN-3,hZ),[hZ+hY*h0/hZ]]);h3=ck.create(hN-1,h0);h4=-hZ;h5=ck.concat([[h4],ck.create(hN-3,0),[h0]]);h6=ck.concat([[1],ck.create(hN-3,0),[hY/h4]]);h7=e$.TridiagonalAlgorithm(h1,h2,h3,h5);return function(h8){return e$.ApplySMInvertMatrix(h1,h2,h3,h8,h6,h7);};});hV=ck.length(hL.plotlocs);return d_.solver(hI,hJ,hK,hN-1,hM,hQ,hU,hR,hS,hT,function(hW){return ck.init(hN,function(hX){var hY;hY=hX<hN-1?hX:0;return ck.init(hN,function(hZ){var h0;h0=hZ<hN-1?hZ:0;return ck.init(hV,function(h1){return ck.get(ck.get(ck.get(hW,ck.get(hL.plotlocs,h1)),hY),h0);});});});},hL);};d_.solver=function(hI,hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT){var hU,hV,hW,hX,hY,hZ,h0,h1,h2,h3,h4,h5,h6,h7;hX=hT.dt*0.5;hU=hI;hY=ck.init(hM,function(){return ck.init(hL,function(){return ck.create(hL,0);});});hZ=ck.create(hM,0);h0=ck.create(hM,null);for(h1=0,h2=hM-1;h1<=h2;h1++){h3=ck.init(hL,function(){return ck.create(hL,0);});for(h4=0,h5=hL-1;h4<=h5;h4++){for(h6=0,h7=hL-1;h6<=h7;h6++)ck.set(ck.get(h3,h4),h6,ck.get(ck.get(ck.get(hJ,h4),h6),h1));}ck.set(h0,h1,h3);}hW=ck.init(hM,function(){return ck.create(hL,0);});return co.delay(function(){return co.append([d$.New(hU,hS(h0))],co.delay(function(){return co.enumWhile(function(){return hU<hT.tmax;},co.delay(function(){return co.append(co.collect(function(){hU=hU+hT.dt;return co.append(co.collect(function(h8){return co.append(co.collect(function(h9){return co.append(co.collect(function(h_){ck.set(hZ,h_,ck.get(ck.get(ck.get(h0,h_),h9),h8));return[];},be.range(0,hM-1)),co.delay(function(){var h_;h_=hK(hU,hZ);return co.collect(function(h$){var ia,ib;return ck.get(hN,h$)>0?(ia=ck.get(ck.get(ck.get(h0,h$),h9),(h8-1+hL)%hL),ib=ck.get(ck.get(ck.get(h0,h$),h9),(h8+1)%hL),ck.set(ck.get(hW,h$),h9,ck.get(ck.get(hP,h$),h8)*ia+ck.get(ck.get(hQ,h$),h8)*ck.get(hZ,h$)+ck.get(ck.get(hR,h$),h8)*ib+hX*ck.get(h_,h$)),[]):(ck.set(ck.get(ck.get(hY,h$),h9),h8,ck.get(hZ,h$)+hX*ck.get(h_,h$)),[]);},be.range(0,hM-1));}));},be.range(0,hL-1)),co.delay(function(){return co.collect(function(h9){var h_;return ck.get(hN,h9)>0?(h_=(ck.get(hO,h9))(ck.get(hW,h9)),co.collect(function(h$){ck.set(ck.get(ck.get(hY,h9),h$),h8,ck.get(h_,h$));return[];},be.range(0,hL-1))):[];},be.range(0,hM-1));}));},be.range(0,hL-1)),co.delay(function(){return co.collect(function(h8){return co.append(co.collect(function(h9){return co.append(co.collect(function(h_){ck.set(hZ,h_,ck.get(ck.get(ck.get(hY,h_),h8),h9));return[];},be.range(0,hM-1)),co.delay(function(){var h_;h_=hK(hU,hZ);return co.collect(function(h$){var ia,ib;return ck.get(hN,h$)>0?(ia=ck.get(ck.get(ck.get(hY,h$),(h8-1+hL)%hL),h9),ib=ck.get(ck.get(ck.get(hY,h$),(h8+1)%hL),h9),ck.set(ck.get(hW,h$),h9,ck.get(ck.get(hP,h$),h8)*ia+ck.get(ck.get(hQ,h$),h8)*ck.get(hZ,h$)+ck.get(ck.get(hR,h$),h8)*ib+hX*ck.get(h_,h$)),[]):(ck.set(ck.get(ck.get(h0,h$),h8),h9,ck.get(hZ,h$)+hX*ck.get(h_,h$)),[]);},be.range(0,hM-1));}));},be.range(0,hL-1)),co.delay(function(){return co.collect(function(h9){return ck.get(hN,h9)>0?(ck.set(ck.get(h0,h9),h8,(ck.get(hO,h9))(ck.get(hW,h9))),[]):[];},be.range(0,hM-1));}));},be.range(0,hL-1));}));},be.range(0,hT.thin-1)),co.delay(function(){return[d$.New(hU,hS(h0))];}));}));}));});};d$.New=function(hI,hJ){return{t:hI,u:hJ};};ea.parser=function(){fa.$cctor();return fa.parser;};ea.parse_molecule_dots=function(){fa.$cctor();return fa.parse_molecule_dots;};ea.to_species=function(hI,hJ,hK){return hK.$==1?new cO({$:0,$0:{$:1,$0:bX.map(function(hL){return ea.map_site(hI,hJ,hL);},hK.$0)}}):hK.$==2?new cO({$:1,$0:ea.to_gate(hI,hJ,hK.$0)}):hK.$==3?new cO({$:4,$0:hK.$0}):new cO({$:0,$0:{$:0,$0:bX.map(function(hL){return ea.map_site(hI,hJ,hL);},hK.$0)}});};ea.map_site=function(hI,hJ,hK){var hL,hM;return hK.$==1?(hL=bX.map(function(hN){return[hN,1];},hK.$0.tags),{$:1,$0:{$:7,$0:"tether",$1:ea.to_range(hI,hJ)},$1:false,$2:{$:1,$0:[hL,0]}}):(hM=hK.$0,hM.domain.toehold?{$:0,$0:{$:7,$0:hM.domain.name,$1:ea.to_range(hI,hJ)},$1:hM.doc,$2:hM.domain.complemented,$3:null}:{$:1,$0:{$:7,$0:hM.domain.name,$1:ea.to_range(hI,hJ)},$1:hM.domain.complemented,$2:null});};ea.to_gate=function(hI,hJ,hK){var hL,hM,hN,hO;return hK.$==1?(hL=ea.to_gate(hI,hJ,hK.$0),(hM=ea.to_gate(hI,hJ,hK.$1),(hN=bX.rev(hL),hN.$==1&&(hM.$==1&&(hO=[hM.$0,hN.$1,hN.$0,hM.$1],true))?bX.append(bX.rev(hO[1]),new bY({$:1,$0:bX.append(hO[2],hO[0]),$1:hO[3]})):be.FailWith("malformed gate")))):hK.$==2?bX.append(ea.to_gate(hI,hJ,hK.$0),ea.to_gate(hI,hJ,hK.$1)):bX.ofArray([bX.ofArray([ea.to_segment(hI,hJ,hK.$0)])]);};ea.parse_name=function(){fa.$cctor();return fa.parse_name;};ea.parse_parameters=function(hI,hJ){return(ea.tuple(ea.do_parse_param()))([hI,hJ]);};ea.to_range=function(hI,hJ){var hK;hK=[hI,hJ];return{$:1,$0:[hK,hK]};};ea.restriction=function(){fa.$cctor();return fa.restriction;};ea.int_name=function(){fa.$cctor();return fa.int_name;};ea.record=function(){fa.$cctor();return fa.record;};ea.seq1=function(hI){return cR.sepBy1(hI,cR.spaces());};ea.to_syntax=function(hI){return hI.$==0?{$:3,$0:new fl({$:5,$0:bY.Empty})}:hI.$0.$==1?{$:1,$0:[hI.$0.$0[0],hI.$0.$0[1],hI.$0.$0[2],hI.$0.$0[3],ea.to_syntax(hI.$1)]}:hI.$0.$==2?{$:2,$0:[hI.$0.$0[0],hI.$0.$0[1],ea.to_syntax(hI.$1)]}:hI.$0.$==3?hI.$1.$==0?{$:3,$0:hI.$0.$0}:be.FailWith("Multiple processes"):{$:0,$0:[hI.$0.$0[0],hI.$0.$0[1],ea.to_syntax(hI.$1)]};};ea.pname=function(hI){return cR.op_LessQmarkGreater(cR.many1Satisfy(function(hJ){return cR.isLetter(hJ)||cR.isDigit(hJ)||hJ==="_"||hJ==="\'"||hI&&hJ===".";}),"an identifier");};ea.map_value=function(hI,hJ,hK){var hL,hM,hN;switch(hK.$==1?(hL=hK.$0,0):hK.$==0?(hL=hK.$0,1):hK.$==5?hK.$0.$==1?(hL=[hK.$0.$0,hK.$0.$1],2):10:hK.$==6?(hL=[hK.$0.sub1,hK.$0.sub2],3):hK.$==2?hK.$0.$==1?(hL=[hK.$0.$0,hK.$0.$1],4):10:hK.$==3?(hL=[hK.$0.div1,hK.$0.div2],5):hK.$==4?(hL=[hK.$0.base_,hK.$0.exponent],6):hK.$==9?(hL=[hK.$0.div,hK.$0.modulo],7):hK.$==10?(hL=hK.$0,8):hK.$==11?(hL=hK.$0,9):10){case 0:return{$:6,$0:hL,$1:ea.to_range(hI,hJ)};case 1:return{$:7,$0:hL,$1:ea.to_range(hI,hJ)};case 2:hM=bX.map(function(hO){return ea.map_value(hI,hJ,hO);},hL[1]);return co.fold(function(hO,hP){return ea.op_plus(hI,hJ,hO,hP);},ea.map_value(hI,hJ,hL[0]),hM);case 3:return ea.op_minus(hI,hJ,ea.map_value(hI,hJ,hL[0]),ea.map_value(hI,hJ,hL[1]));case 4:hN=bX.map(function(hO){return ea.map_value(hI,hJ,hO);},hL[1]);return co.fold(function(hO,hP){return ea.op_mul(hI,hJ,hO,hP);},ea.map_value(hI,hJ,hL[0]),hN);case 5:return ea.op_div(hI,hJ,ea.map_value(hI,hJ,hL[0]),ea.map_value(hI,hJ,hL[1]));case 6:return ea.op_power(hI,hJ,ea.map_value(hI,hJ,hL[0]),ea.map_value(hI,hJ,hL[1]));case 7:return ea.op_modulo(hI,hJ,ea.map_value(hI,hJ,hL[0]),ea.map_value(hI,hJ,hL[1]));case 8:return{$:13,$0:ea.map_value(hI,hJ,hL),$1:ea.to_range(hI,hJ)};case 9:return{$:14,$0:ea.map_value(hI,hJ,hL),$1:ea.to_range(hI,hJ)};case 10:return be.FailWith("unsupported expression");}};ea.pValue=function(){fa.$cctor();return fa.pValue;};ea.do_parse_molecule=function(hI,hJ,hK,hL){var hM,hN,hO,hP,hQ,hR;hM=ea.strand_gate(ea.parse_site(hL,ea.pname(hK)),hI,hJ);hN=hM[0];hO=hM[1];hP=(hQ=b8.makeProvider(),cR.op_BarGreaterGreater(cR.sqBrackets(f4.psystem(b5.psite(b5.engine(),hQ,true))),function(hS){return{$:3,$0:hS};}));return cR.op_GreaterGreaterEquals(cR.plookAheadWith((hR=cR.choice([cR.pTry(cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(cR.kw("["),cR.kw("<")),function(){return cR.preturn(true);})),cR.preturn(false)]),function(hS){return hR([hS[0],hS[1]]);})),function(hS){return hS?hP:cR.op_LessBarGreater(cR.attempt(hO),hN);});};ea.op_AmpGreater=function(hI,hJ){return cR.op_GreaterGreaterDot(cR.kw(hI),hJ);};ea.parse_value=function(){fa.$cctor();return fa.parse_value;};ea.parse_string=function(){fa.$cctor();return fa.parse_string;};ea.after=function(hI,hJ){return cR.op_BarGreaterGreater(cR.op_DotGreaterGreaterDot(hI,cR.opt(cR.pstring(hJ))),function(hK){return hK[1]==null?[hK[0],false]:[hK[0],true];});};ea.subdomain=function(){fa.$cctor();return fa.subdomain;};ea.binding=function(){fa.$cctor();return fa.binding;};ea.parse_value_orig=function(){fa.$cctor();return fa.parse_value_orig;};ea.parse_proc=function(hI,hJ){var hK,hL;hK=bq.parse(ea.parse_species(false));return(cR.choice(bX.ofArray([cR.op_BarGreaterGreater(ea.op_AmpGreater("new",cR.op_PlusGreaterGreaterPlus(ea.restriction(),function(hM){return ea.parse_proc(hM[0],hM[1]);})),function(hM){return new fl({$:6,$0:hM[0],$1:hM[1]});}),cR.pTry(cR.op_LessQmarkGreater(cR.op_BarTwiddleGreater(cR.op_GreaterGreaterDot(cR.opt(cR.kw("rxn")),_2.parse(ea.parse_species(false),br.parse(ea.parse_name()),br.parse(hK),{$:1,$0:1})),function(hM,hN){return(function(hO){function hP(hR){return ea.to_dsd_reaction(hO,hR);}function hQ(hR){return new fl({$:7,$0:hR});}return function(hR){return hQ(hP(hR));};}(hM))(hN);}),"a reaction")),cR.pTry(cR.op_BarTwiddleGreater(ea.op_AmpGreater("constant",ea.parse_species(false)),function(hM,hN){return new fl({$:0,$0:{$:1,$0:1,$1:ea.to_range(hM[0],hM[1])},$1:true,$2:hN,$3:null,$4:null});})),cR.pTry(cR.op_GreaterGreaterEquals(cR.op_DotGreaterGreater(ea.parse_species(false),(hL=cR.choice([cR.kw("with"),cR.kw("=")]),function(hM){return hL([hM[0],hM[1]]);})),function(hM){return cR.op_BarTwiddleGreater(cR.record(new fl({$:0,$0:{$:1,$0:0,$1:null},$1:false,$2:hM,$3:null,$4:null}),bX.ofArray([["spatial",cR.op_BarGreaterGreater(_3.parser(),function(hN){return function(hO){return hO.$==0?new fl({$:0,$0:hO.$0,$1:hO.$1,$2:hO.$2,$3:hO.$3,$4:{$:1,$0:hN}}):be.FailWith("Unexpected initial");};})],["time",cR.op_BarGreaterGreater(cT.parse(),function(hN){return function(hO){return hO.$==0?new fl({$:0,$0:hO.$0,$1:hO.$1,$2:hO.$2,$3:{$:1,$0:hN},$4:hO.$4}):be.FailWith("Unexpected initial");};})],["value",cR.op_BarGreaterGreater(cT.parse(),function(hN){return function(hO){return hO.$==0?new fl({$:0,$0:hN,$1:hO.$1,$2:hO.$2,$3:hO.$3,$4:hO.$4}):be.FailWith("Unexpected initial");};})],["constant",cR.op_BarGreaterGreater(cR.op_DotGreaterGreater(cR.pbool(),cR.spaces()),function(hN){return function(hO){return hO.$==0?new fl({$:0,$0:hO.$0,$1:hN,$2:hO.$2,$3:hO.$3,$4:hO.$4}):be.FailWith("Unexpected initial");};})]])),function(hN,hO){var hP;return hO.$==0?(hP=hO.$3,new fl({$:0,$0:hO.$0,$1:hO.$1,$2:hO.$2,$3:hP==null?null:{$:1,$0:cT.set_range(ea.to_range(hN[0],hN[1]),hP.$0)},$4:hO.$4})):be.FailWith("Unexpected initial");});})),cR.pTry(cR.op_LessQmarkGreater(cR.op_BarTwiddleGreater(cR.op_PlusGreaterGreaterPlus(ea.before("constant",ea.parse_value()),cR.op_GreaterGreaterDot(cR.op_LessBarGreater(cR.op_LessBarGreater(cR.kw("*"),cR.kw("of")),cR.preturn("")),ea.before("constant",ea.parse_species(false)))),function(hM,hN){var hO,hP;hO=hN[0];hP=hN[1];return new fl({$:0,$0:hO[1],$1:hO[0]||hP[0],$2:hP[1],$3:null,$4:null});}),"species initial")),cR.op_LessQmarkGreater(cR.pTry(ea.parse_species(false)),"a species"),cR.op_BarGreaterGreater(cR.paren(ea.sep_by_bars(function(hM){return ea.parse_proc(hM[0],hM[1]);})),function(hM){return new fl({$:5,$0:hM});})])))([hI,hJ]);};ea.parse_values=function(hI,hJ){return(ea.tuple(cR.op_LessBarGreater(ea.parse_value(),cR.op_BarTwiddleGreater(function(hK){return ea.parse_values(hK[0],hK[1]);},function(hK,hL){return{$:12,$0:hL,$1:ea.to_range(hK[0],hK[1])};}))))([hI,hJ]);};ea.parse_molecule=function(){fa.$cctor();return fa.parse_molecule;};ea.speciesParser=function(){fa.$cctor();return fa.speciesParser;};ea.plotParser=function(){fa.$cctor();return fa.plotParser;};ea.dsdDirectivesParser=function(){fa.$cctor();return fa.dsdDirectivesParser;};ea.dsdCfg=function(hI,hJ){return[hI,co.fold(function(hK,hL){return(function(hM){var hN,hO;hN=hM[0];hO=hM[1];return function(hP){return ea.updateCfg(hN,hO,hP);};}(hK))(hL);},[Y.get_defaults(),bR.default_options()],hJ)];};ea.parse_ds=function(){fa.$cctor();return fa.parse_ds;};ea.to_segment=function(hI,hJ,hK){var hL,hM,hN,hO;hL=[hI,hJ];return hK.$==1?(hM=hK.$0,new ej({$:0,$0:[(function(hP){return ea.to_domains(hP[0],hP[1]);}(hL))(hM.lower_left),(function(hP){return ea.to_domains(hP[0],hP[1]);}(hL))(hM.upper_left),(function(hP){return ea.to_domains(hP[0],hP[1]);}(hL))(hM.middle),(function(hP){return ea.to_domains(hP[0],hP[1]);}(hL))(hM.upper_right),(function(hP){return ea.to_domains(hP[0],hP[1]);}(hL))(hM.lower_right)]})):hK.$==2?(hN=hK.$0,new ej({$:1,$0:[(function(hP){return ea.to_domains(hP[0],hP[1]);}(hL))(hN.lower_left),(function(hP){return ea.to_domains(hP[0],hP[1]);}(hL))(hN.upper_left),(function(hP){return ea.to_domains(hP[0],hP[1]);}(hL))(hN.middle),(function(hP){return ea.to_domains(hP[0],hP[1]);}(hL))(hN.loop),fi.Right]})):(hO=hK.$0,new ej({$:1,$0:[(function(hP){return ea.to_domains(hP[0],hP[1]);}(hL))(hO.lower_right),(function(hP){return ea.to_domains(hP[0],hP[1]);}(hL))(hO.upper_right),(function(hP){return ea.to_domains(hP[0],hP[1]);}(hL))(hO.middle),(function(hP){return ea.to_domains(hP[0],hP[1]);}(hL))(hO.loop),fi.Left]}));};ea.at_time=function(){fa.$cctor();return fa.at_time;};ea.sep_by_bars=function(hI){return cR.sepBy1(hI,cR.skw("|"));};ea.tuple=function(hI){return cR.paren(cR.sepBy(hI,cR.skw(",")));};ea.do_parse_param=function(){fa.$cctor();return fa.do_parse_param;};ea.before=function(hI,hJ){return cR.op_BarGreaterGreater(cR.op_DotGreaterGreaterDot(cR.opt(cR.kw(hI)),hJ),function(hK){return hK[0]==null?[false,hK[1]]:[true,hK[1]];});};ea.op_plus=function(hI,hJ,hK,hL){return{$:8,$0:hK,$1:f7.Plus,$2:hL,$3:ea.to_range(hI,hJ)};};ea.op_minus=function(hI,hJ,hK,hL){return{$:8,$0:hK,$1:f7.Minus,$2:hL,$3:ea.to_range(hI,hJ)};};ea.op_mul=function(hI,hJ,hK,hL){return{$:8,$0:hK,$1:f7.Mul,$2:hL,$3:ea.to_range(hI,hJ)};};ea.op_div=function(hI,hJ,hK,hL){return{$:8,$0:hK,$1:f7.Div,$2:hL,$3:ea.to_range(hI,hJ)};};ea.op_power=function(hI,hJ,hK,hL){return{$:8,$0:hK,$1:f7.Power,$2:hL,$3:ea.to_range(hI,hJ)};};ea.op_modulo=function(hI,hJ,hK,hL){return{$:8,$0:hK,$1:f7.Modulo,$2:hL,$3:ea.to_range(hI,hJ)};};ea.parse_site=function(hI,hJ){var hK;hK=cR.op_GreaterGreaterEquals(ea.after(cR.op_PlusGreaterGreaterPlus(hJ,cR.opt(cR.op_GreaterGreaterDot(cR.kw("^"),function(hL){return ea.parse_doc(hL[0],hL[1]);}))),"*"),function(hL){var hM,hN;hM=hL[0];hN=hL[1];return function(hO){var hP,hQ,hR,hS;hP=hO[0];hQ=hO[1];hR=hM[0];hS=hM[1];return hR==="_"&&!hI?(cR.failParser("domain name \\"_\\" not allowed"))([hP,hQ]):(cR.preturn(ea.mk_site(hQ[0],hQ[1],ea.mk_domain([hR,hS!=null],hN),hS)))([hP,hQ]);};});return cR.op_LessBarGreater(cR.op_DotGreaterGreater(cR.op_BarTwiddleGreater(ea.op_AmpGreater("tether",cR.paren(cR.sepBy1(cR.op_PlusGreaterGreater(cR.op_LessBarGreater(hJ,cR.op_BarGreaterGreater(cR.pint32(),a.String)),cR.spaces()),cR.skw(",")))),function(hL,hM){return(function(hN){var hO,hP;hO=hN[0];hP=hN[1];return function(hQ){return ea.mk_tether(hO,hP,hQ);};}(hL))(hM);}),cR.spaces()),cR.pTry(cR.op_DotGreaterGreater(hK,cR.spaces())));};ea.strand_gate=function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW;hL=cR.many1(hI);hM=(cR.bracket("<",">"))(hL);hN=(cR.bracket("{","}"))(hL);hO=(cR.bracket("[","]"))(hL);hP=(cR.bracket("<","}"))(hL);hQ=(cR.bracket("{",">"))(hL);hR=(hS=cR.choice([cR.op_DotGreaterGreaterDot(hM,cR.op_LessBarGreater(hN,cR.preturn(bY.Empty))),cR.op_GreaterGreaterEquals(cR.op_DotGreaterGreaterDot(hN,cR.op_LessBarGreater(hM,cR.preturn(bY.Empty))),function(hX){return cR.preturn([hX[1],hX[0]]);}),cR.preturn([bY.Empty,bY.Empty])]),function(hX){return hS([hX[0],hX[1]]);});hT=ea.alternatives(bX.ofArray([cR.pipe3(hP,hO,hR,function(hX,hY,hZ){return ea.mk_hpl(hX,hY,hZ[0],hZ[1]);}),cR.pipe3(hR,hO,hQ,function(hX,hY,hZ){return((function(h0){var h1,h2;h1=h0[0];h2=h0[1];return hB.Curried(ea.mk_hpr,2,[h1,h2]);}(hX))(hY))(hZ);}),cR.pipe3(hR,hO,hR,function(hX,hY,hZ){return((function(h0){var h1,h2;h1=h0[0];h2=h0[1];return function(h3){return function(h4){return ea.mk_m(h1,h2,h3,h4[0],h4[1]);};};}(hX))(hY))(hZ);})]));hU=cR.op_BarGreaterGreater(hJ,hB.Curried3(function(hX,hY,hZ){return{$:2,$0:hY,$1:hZ};}));hV=cR.op_BarGreaterGreater(hK,hB.Curried3(function(hX,hY,hZ){return{$:1,$0:hY,$1:hZ};}));hW=cR.op_BarGreaterGreater(cR.chainl1(hT,cR.op_LessBarGreater(cR.attempt(hU),hV)),function(hX){return{$:2,$0:hX};});return[cR.op_LessBarGreater(cR.op_BarGreaterGreater(hM,function(hX){return{$:0,$0:hX};}),cR.op_BarGreaterGreater(hN,function(hX){return{$:1,$0:hX};})),hW];};ea.parse_species=function(hI){var hJ,hK;hJ=cR.choice(bX.ofArray([cR.op_BarGreaterGreater(cR.op_PlusGreaterGreaterPlus((hK=ea.sep_by_bars(ea.parse_ground_species(hI)),(cR.bracket("[[","]]"))(hK)),ea.at_time()),function(hL){return new fl({$:3,$0:hL[0],$1:hL[1]});}),ea.parse_ground_species(hI)]));return function(hL){return hJ([hL[0],hL[1]]);};};ea.to_dsd_reaction=function(hI,hJ){var hK,hL;return fd.New(hJ.reactants,hJ.products,hJ.catalysts,(ea.map_rate(hI))(hJ.rate),(hK=ea.map_rate(hI),(hL=hJ.reverse,hL==null?null:{$:1,$0:hK(hL.$0)})));};ea.updateCfg=function(hI,hJ,hK){return hK.$==1?[hI,co.fold(bR.update_options,hJ,hK.$0)]:[hI.from_directive(hK.$0),hJ];};ea.to_domains=function(hI,hJ){function hK(hL){return ea.map_site(hI,hJ,hL);}return function(hL){return bX.map(hK,hL);};};ea.mk_hpr=function(hI,hJ,hK,hL){return{$:0,$0:{$:2,$0:gY.New(hL,hK,hI,hJ)}};};ea.mk_m=function(hI,hJ,hK,hL,hM){return{$:0,$0:{$:1,$0:gX.New(hI,hJ,hK,hL,hM)}};};ea.mk_hpl=function(hI,hJ,hK,hL){return{$:0,$0:{$:0,$0:gZ.New(hI,hJ,hK,hL)}};};ea.mk_tether=function(hI,hJ,hK){return{$:1,$0:f_.New(hK,[hI,hJ])};};ea.mk_domain=function(hI,hJ){return f$.New(hI[0],hJ,hI[1]);};ea.mk_site=function(hI,hJ,hK,hL){return{$:0,$0:ga.New(hK,hL==null?ea.to_float(hI,hJ,1):hL.$0)};};ea.parse_doc=function(hI,hJ){var hK,hL;function hM(hN,hO){return ea.to_float(hN,hO,1);}hK=[hI,hJ];return(cR.choice([cR.pTry(cR.op_GreaterGreaterDot(cR.pint32(),(hL=cR.choice([cR.op_GreaterGreaterDot(cR.kw("."),cR.failParser("")),function(){return{$:0,$0:hM.apply(null,hK[1]),$1:hK};}]),function(hN){return hL([hN[0],hN[1]]);}))),cR.op_BarTwiddleGreater(cR.pfloat(),function(hN,hO){return(function(hP){var hQ,hR;hQ=hP[0];hR=hP[1];return function(hS){return ea.to_float(hQ,hR,hS);};}(hN))(hO);}),cR.paren(ea.parse_value()),cR.op_BarTwiddleGreater(cR.preturn(),function(hN){return hM.apply(null,hN);})]))([hK[0],hK[1]]);};ea.alternatives=function(hI){var hJ,hK,hL;hJ=bX.rev(bX.map(cR.pTry,hI));return hJ.$==1?(hK=cR.choice(bX.rev(new bY({$:1,$0:hJ.$0,$1:bX.map(cR.attempt,hJ.$1)}))),function(hM){return hK([hM[0],hM[1]]);}):(hL=cR.choice([]),function(hM){return hL([hM[0],hM[1]]);});};ea.parse_ground_species=function(hI){var hJ;hJ=cR.choice(bX.ofArray([cR.op_BarGreaterGreater(cR.op_DotGreaterGreaterDot(cR.op_DotGreaterGreaterDot(ea.parse_name(),function(hK){return ea.parse_values(hK[0],hK[1]);}),ea.at_time()),function(hK){var hL;hL=hK[0];return new fl({$:4,$0:hL[0],$1:null,$2:hL[1],$3:hK[1]});}),cR.op_BarTwiddleGreater(cR.op_DotGreaterGreaterDot((ea.parse_molecule())(hI),ea.at_time()),function(hK,hL){return(function(hM){var hN,hO;hN=hM[0];hO=hM[1];return function(hP){return ea.to_process(hN,hO,hP[0],hP[1]);};}(hK))(hL);})]));return function(hK){return hJ([hK[0],hK[1]]);};};ea.map_rate=function(hI){return function(hJ){return hJ.$==1?{$:1,$0:hJ.$0}:{$:0,$0:hJ.$0};};};ea.to_float=function(hI,hJ,hK){return{$:6,$0:hK,$1:ea.to_range(hI,hJ)};};ea.to_process=function(hI,hJ,hK,hL){return hK.$==1?ea.starting_at(hL,function(hM,hN){return new fl({$:1,$0:hM,$1:hN});},{$:1,$0:bX.map(function(hM){return ea.map_site(hI,hJ,hM);},hK.$0)}):hK.$==2?ea.starting_at(hL,function(hM,hN){return new fl({$:2,$0:hM,$1:hN});},ea.to_gate(hI,hJ,hK.$0)):hK.$==3?new fl({$:8,$0:hK.$0,$1:hL}):ea.starting_at(hL,function(hM,hN){return new fl({$:1,$0:hM,$1:hN});},{$:0,$0:bX.map(function(hM){return ea.map_site(hI,hJ,hM);},hK.$0)});};ea.starting_at=function(hI,hJ,hK){return hJ(hK,hI);};eb.eval_to_species=function(hI,hJ,hK,hL,hM){var hN,hO;function hP(hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0){var h1,h2,h3,h4,h5,h6,h7,h8;function h9(_if,ig){return[hQ,cN.add_env(hI,hY,[ig,hT,hU,hX,hZ==null?_if==null?null:{$:1,$0:cT.to_engineValue(cT["eval"](hR,_if.$0))}:{$:1,$0:cT.to_engineValue(cT["eval"](hR,hZ.$0))},h0],hV),hW];}function h_(_if){var ig,ih,ii;function ij(ik){dD.add(ig,ik,null);}ig=dD.empty();cu.iter(function(ik,il){return bX.iter(function(im){return ij(im[0]);},il);},hV[0]);ih=cN.rotate(hI,_if);return(ii=dD.tryFind(ig,ih),ii!=null&&ii.$==1)?ih:_if;}function h$(_if){return _if.$==0?{$:0,$0:_if.$0}:_if.$==1?{$:1,$0:_if.$0}:be.FailWith("Invalid origami content");}function ia(_if,ig,ih,ii,ij,ik){return h$(_if);}function ib(_if){return bX.map(function(ig){return h_(cN.standard_form(hI,ig[0]));},cu.fold(function(ig,ih,ii){return bX.append(ii,ig);},bY.Empty,(hP(hQ,hR,_if,hT,hU,hN,bY.Empty,hX,hY,hZ,h0))[1][0]));}function ic(_if){var ig;function ih(ii,ij){return cN.equal(hI,ii,ij);}ig=Z.map(ib,_if);return Z.fold_left_m(function(ii,ij){var ik;ik=ij.multiplicity;return dZ.fold_left(function(il,im){return Z.add(ih,il,im);},ii,bX.map(function(il){return _0.New(il,ik);},ij.element));},Z.empty(),ig);}function id(_if){var ig,ih;return _if.$==0?(ig=_if.$0,(ih=co.tryFind(function(ii){return ii.$==0&&ii.$0===ig;},hR),ih!=null&&ih.$==1?ih.$0.$==0?cT.to_engineValue(ih.$0.$1):{$:0,$0:ig}:{$:0,$0:ig})):_if.$==5?{$:5,$0:bX.map(id,_if.$0)}:_if.$==6?br.sub(id(_if.$0.sub1),id(_if.$0.sub2)):_if.$==2?{$:2,$0:bX.map(id,_if.$0)}:_if.$==3?br.div(id(_if.$0.div1),id(_if.$0.div2)):_if.$==4?br.power$1(id(_if.$0.base_),id(_if.$0.exponent)):_if.$==10?{$:10,$0:id(_if.$0)}:_if.$==11?{$:11,$0:id(_if.$0)}:_if;}function ie(_if){return _if.$==1?new _1({$:1,$0:br.expand(function(ig){function ih(ij){return{$:2,$0:ij};}function ii(ij){return{$:0,$0:ij};}return ig.$==0?{$:0,$0:{$:0,$0:ig.$0}}:ig.$==3?{$:0,$0:bq.Time}:ig.$==1?{$:0,$0:{$:1,$0:ig.$0}}:{$:5,$0:bX.map(function(ij){return ii(ih(ij));},ib(ig.$0))};},_if.$0)}):new _1({$:0,$0:id(_if.$0)});}return hS.$==1?h9(hS.$1,h_(new cO({$:0,$0:em.standard_form(em["eval"](hR,hS.$0))}))):hS.$==2?h9(hS.$1,new cO({$:1,$0:eo.standard_form(hI,eo["eval"](hR,hS.$0))})):hS.$==8?h9(hS.$1,new cO({$:4,$0:hS.$0})):hS.$==3?h9(hS.$1,new cO({$:2,$0:en.standard_form(hI,bX.map(function(_if){return ia(_if[0],_if[1],_if[2],_if[3],_if[4],_if[5]);},cu.fold(function(_if,ig,ih){return bX.append(ih,_if);},bY.Empty,(dZ.fold_left(function(_if,ig){return(function(ih){var ii,ij,ik;ii=ih[0];ij=ih[1];ik=ih[2];return function(il){return hP(ii,hR,il,hT,hU,ij,ik,hX,hY,hO,h0);};}(_if))(ig);},[hQ,hN,bY.Empty],hS.$0))[1][0])))})):hS.$==5?dZ.fold_left(function(_if,ig){return(function(ih){var ii,ij,ik;ii=ih[0];ij=ih[1];ik=ih[2];return function(il){return hP(ii,hR,il,hT,hU,ij,ik,hX,hY,hZ,h0);};}(_if))(ig);},[hQ,hV,hW],hS.$0):hS.$==6?(h1=hS.$0[0],(h2=eb.dom_spec_map(function(_if){return cT["eval"](hR,_if);},hS.$0[1]),(h3=hQ[0],(h4=hQ[1],(h5=bX.contains(h1,h3)?[h3,h4+1,h4+1]:[new bY({$:1,$0:h1,$1:h3}),h4,0],hP([h5[0],h5[1]],new bY({$:1,$0:{$:1,$0:h1,$1:eb.eval_system(hI,h1,h5[2],h2)},$1:hR}),hS.$1,hT,hU,hV,hW,hX,hY,hZ,h0)))))):hS.$==4?(h6=hS.$0,(h7=function(_if,ig,ih,ii,ij){var ik,il,im,_in;while(true){il=bX.map(function(io){return function(ip){return cT["eval"](io,ip);};}(ii),ih);im=eb.lookup(_if,hK);if(im==null)return fc.type_error(ig,{$:10,$0:h6,$1:cT.to_strings(il)});else if(im.$0.$3.$==4){_in=im.$0.$2(il);_if=im.$0.$3.$0;ig=im.$0.$3.$1;ih=im.$0.$3.$2;ii=eb.extend_env(im.$0.$1,il,ii);ij=_in||ij;}else{ik=im.$0.$2(il);return[im.$0.$3,eb.extend_env(im.$0.$1,il,ii),ik||ij];}}}(h6,hS.$1,hS.$2,hR,hX),hP(hQ,h7[1],h7[0],hT,hU,hV,hW,h7[2],h6,hS.$3,h0))):hS.$==7?(h8=hS.$0,[hQ,hV,new bY({$:1,$0:_2.create$4(ic(h8.ma_catalysts),ic(h8.ma_reactants),dZ.option_map2(ie,h8.ma_reverseRate),ie(h8.ma_rate),ic(h8.ma_products)),$1:hW})]):hP(hQ,hR,hS.$2,br.mul(hT,cT.to_engineValue(cT["eval"](hR,hS.$0))),hU||hS.$1,hV,hW,hX,hY,hS.$3,hS.$4);}hN=cN.empty_env(0);hO=null;return hP([hJ[0],hJ[1]],hL,hM,{$:1,$0:1},false,hN,bY.Empty,false,"%",hO,null);};eb.display=function(hI){var hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT;function hU(hY){return hY==null?"":" @ "+cT.to_string(hY.$0);}function hV(hY,hZ){return hZ.$==0?hY+" = "+hZ.$0:hZ.$==2?hY+" = \\""+hZ.$0+"\\"":hZ.$==3?hZ.$0[1]?hY+" = \\"^("+dZ.string_of_list(dZ.id,",",hZ.$0[0])+")\\"":hY+" = \\"("+dZ.string_of_list(dZ.id,",",hZ.$0[0])+")\\"":hY+" = "+cT.to_string(hZ.$0);}function hW(hY){var hZ;switch(hY.$==1?hY.$1.$==1?hY.$1.$0[0]==="unbind"?hY.$1.$0[1].$==1?hY.$1.$1.$==0?hY.$0[0]==="bind"?hY.$0[1].$==1?(hZ=[hY.$0[1].$0,hY.$1.$0[1].$0],2):3:3:3:3:hY.$1.$0[0]==="bind"?hY.$1.$0[1].$==1?hY.$1.$1.$==0?hY.$0[0]==="unbind"?hY.$0[1].$==1?(hZ=[hY.$1.$0[1].$0,hY.$0[1].$0],2):3:3:3:3:3:(hZ=hY.$0,1):0){case 0:return"";case 1:return hV.apply(null,hZ);case 2:return" @ "+cT.to_string(hZ[0])+", "+cT.to_string(hZ[1]);case 3:return"{"+cS.concat("; ",bX.map(function(h0){return hV(h0[0],h0[1]);},hY))+"}";}}function hX(hY){return hY.$==1?"["+br.to_string(function(hZ){return bq.to_string(eb.display,hZ);},hY.$0)+"]":"{"+br.to_string(a.id,hY.$0)+"}";}return hI.$==1?em.display(hI.$0)+hU(hI.$1):hI.$==2?eo.display(hI.$0)+hU(hI.$1):hI.$==8?(((hB.Curried3(function(hY,hZ,h0){return hY("["+cA.toSafe(hZ)+"] "+cA.toSafe(h0));}))(a.id))(b$.ToStringWith(b5.engine(),hI.$0)))(hU(hI.$1)):hI.$==3?"[[ "+cS.concat(" | ",bX.map(eb.display,hI.$0))+"]]"+hU(hI.$1):hI.$==4?hI.$0+cT.to_strings(hI.$2)+hU(hI.$3):hI.$==5?hI.$0.$==0?"()":"( "+eb.displays(hI.$0)+")":hI.$==6?(hJ=hI.$0[1],"new "+hI.$0[0]+(hJ.$==0?"":hW(hJ))+"\\n"+eb.display(hI.$1)):hI.$==7?(hK=hI.$0,(hL=hK.ma_catalysts.$==0?"":Z.to_string(eb.display," + ",hK.ma_catalysts)+" ~ ",(hM=Z.to_string(eb.display," + ",hK.ma_reactants),(hN=Z.to_string(eb.display," + ",hK.ma_products),"rxn "+hL+hM+(hO=hK.ma_reverseRate,hO!=null&&hO.$==1?" <->"+hX(hK.ma_rate)+hX(hO.$0):" ->"+hX(hK.ma_rate))+" "+hN)))):(hP=hI.$1,(hQ=hI.$0,(hR=hI.$2,(hS=hI.$4,(hT=hI.$3,hS!=null&&hS.$==1?eb.display(hR)+" with {"+cS.concat("; ",bX.ofArray(["value = "+cT.to_string(hQ),"constant = "+(hP?"true":"false"),"spatial = "+_3.to_string(hS.$0)]))+(hT==null?"":"; time = "+cT.to_string(hT.$0))+"}":(hP?"constant ":"")+cT.to_string(hQ)+" * "+eb.display(hR)+hU(hT))))));};eb.dom_spec_map=function(hI,hJ){return bX.map(function(hK){return hK[1].$==1?[hK[0],{$:1,$0:hI(hK[1].$0)}]:hK;},hJ);};eb.eval_system=function(hI,hJ,hK,hL){var hM,hN,hO,hP,hQ,hR,hS,hT,hU;hM=(hN=dZ.try_assoc("bind",hL),hN!=null&&hN.$==1&&(hN.$0.$==1&&(hO=hN.$0.$0,true))?cT.to_engineValue(hO):{$:1,$0:bR.get_toehold_bind_rate(hI)});hP=(hQ=dZ.try_assoc("unbind",hL),hQ!=null&&hQ.$==1&&(hQ.$0.$==1&&(hR=hQ.$0.$0,true))?cT.to_engineValue(hR):{$:1,$0:bR.get_toehold_unbind_rate(hI)});hS=(hT=dZ.try_assoc("seq",hL),hT!=null&&hT.$==1&&(hT.$0.$==0&&(hU=hT.$0.$0,true))?{$:1,$0:hU}:null);return hS==null?{$:2,$0:hJ,$1:hK,$2:hM,$3:hP,$4:ec.emprange()}:{$:3,$0:hJ,$1:hK,$2:hS.$0,$3:hM,$4:hP,$5:ec.emprange()};};eb.lookup=function(hI,hJ){var hK,hL,hM,hN,hO;while(true)if(hJ.$==1){hK=hJ.$0.$0;hL=hJ.$0.$3;hM=hJ.$0.$1;hN=hJ.$0.$2;hO=hJ.$1;if(hI===hK)return{$:1,$0:{$:0,$0:hK,$1:hM,$2:hN,$3:hL}};else hJ=hO;}else return null;};eb.extend_env=function(hI,hJ,hK){var hL;switch(hI.$==1?hI.$0.$==1?hJ.$==0?5:hJ.$0.$==12?(hL=[hI.$1,hI.$0.$0,hJ.$0.$0,hJ.$1],2):3:hJ.$==0?5:(hL=[hI.$1,hJ.$0,hJ.$1,hI.$0.$0],1):hJ.$==1?4:0){case 0:return hK;case 1:return new bY({$:1,$0:{$:0,$0:hL[3],$1:hL[1]},$1:eb.extend_env(hL[0],hL[2],hK)});case 2:return eb.extend_env(hL[1],hL[2],eb.extend_env(hL[0],hL[3],hK));case 3:return be.FailWith("Pattern parameter not given tuple");case 4:return be.FailWith("More values than parameters given to a module instance");case 5:return be.FailWith("More parameters than values given to a module instance");}};eb.displays=function(hI){return hI.$==1?hI.$1.$==0?eb.display(hI.$0):eb.display(hI.$0)+"\\n| "+eb.displays(hI.$1):"";};eb.free_names=function(hI){var hJ,hK;function hL(hN){return hN==null?bY.Empty:cT.free_names(hN.$0);}function hM(hN){var hO;return hN.$==0&&(hN.$0.$==0?hN.$0.$0.$==0&&(hO=hN.$0.$0.$0,true):hN.$0.$0.$==0&&(hO=hN.$0.$0.$0,true))?[hO.name,null]:be.FailWith("Unexpected uninstantiated Logic DSD process.");}return hI.$==1?bX.append(em.free_names(hI.$0),hL(hI.$1)):hI.$==2?bX.append(eo.free_names(hI.$0),hL(hI.$1)):hI.$==3?bX.append(bX.collect(eb.free_names,hI.$0),hL(hI.$1)):hI.$==5?bX.collect(eb.free_names,hI.$0):hI.$==6?(hJ=hI.$0[0],bX.append(bX.collect(function(hN){return hN[1].$==1?cT.free_names(hN[1].$0):bY.Empty;},hI.$0[1]),bX.filter(function(hN){return hN[0]!==hJ;},eb.free_names(hI.$1)))):hI.$==4?bX.append(hL(hI.$3),bX.collect(cT.free_names,hI.$2)):hI.$==7?(hK=hI.$0,bX.concat(bX.append(Z.collect(eb.free_names,hK.ma_reactants),bX.append(Z.collect(eb.free_names,hK.ma_products),Z.collect(eb.free_names,hK.ma_catalysts))))):hI.$==8?bX.distinct(bX.collect(function(hN){return bX.map(hM,hN);},b$.ToList(hI.$0))):bX.append(cT.free_names(hI.$0),bX.append(eb.free_names(hI.$2),hL(hI.$3)));};eb.inferTypes=function(hI,hJ,hK){function hL(hN,hO){var hP,hQ;return hO==null?null:(hP=hO.$0,(hQ=(cT.inferType(hN,hP))[0],hQ.$==3?null:hQ.$==6?null:hQ.$==0?null:fc.type_error(cT.get_range(hP),{$:1,$0:hQ,$1:bX.ofArray([{$:3,$0:ec.emprange()},{$:6,$0:ec.emprange()}]),$2:"time of a species"})));}function hM(hN,hO,hP){var hQ,hR,hS,hT,hU,hV,hW,hX,hY,h0,h1,h2,h3,h4,h5;function hZ(h6){Z.iter(function(h7){return hM(hN,hO,h7);},h6);}if(hP.$==1){em.inferType(hN,hO,hP.$0);return hL(hO,hP.$1);}else if(hP.$==2){eo.inferType(hN,hO,hP.$0);return hL(hO,hP.$1);}else if(hP.$==3){bX.iter((hQ={$:1,$0:true},function(h6){return hM(hQ,hO,h6);}),hP.$0);return hL(hO,hP.$1);}else if(hP.$==5)return bX.iter(function(h6){return hM(hN,hO,h6);},hP.$0);else if(hP.$==6){hR=hP.$0[0];eb.type_check_system(hR,hP.$0[1],false,hO);return hM(hN,new bY({$:1,$0:[hR,[gW.BottomT]],$1:hO}),hP.$1);}else if(hP.$==4){hS=hP.$0;hT=hP.$1;hU=cT.inferType(hO,{$:7,$0:hS,$1:hT});hV=bX.map(function(h6){return cT.inferType(hO,h6);},hP.$2);hW=hU[0];hW.$==9?eq.check_parameter_types(hO,hS,hT,hW.$0,hV):fc.type_error(hT,{$:1,$0:hW,$1:bX.ofArray([{$:9,$0:hV}]),$2:"module name "+hS});return hL(hO,hP.$3);}else if(hP.$==7){hX=hP.$0;hZ(hX.ma_reactants);hZ(hX.ma_products);return hZ(hX.ma_catalysts);}else if(hP.$==8)return null;else{h0=hP.$2;h1=hP.$0;h2=cT.inferType(hO,h1);h3=h2[0];switch(h3.$==3?0:h3.$==6?0:h3.$==1?(h4=h3.$1,h4!=null&&h4.$==1?h3.$1.$0?0:(hY=h3.$0,2):(hY=h3.$0,2)):h3.$==0?1:(hY=h3,3)){case 0:return hM(hN,hO,h0);case 1:h2[0]={$:1,$0:bY.Empty,$1:{$:1,$0:true},$2:bX.ofArray([cT.get_range(h1)])};return hM(hN,hO,h0);case 2:h5={$:1,$0:hY,$1:{$:1,$0:true},$2:bX.ofArray([cT.get_range(h1)])};bX.iter(function(h6){h6[0]=h5;},hY);h2[0]=h5;return hM(hN,hO,h0);case 3:return fc.type_error(cT.get_range(h1),{$:1,$0:hY,$1:bX.ofArray([{$:3,$0:ec.emprange()},{$:6,$0:ec.emprange()}]),$2:"population of a species"});}}}hM(hI,hJ,hK);};eb.type_check_system=function(hI,hJ,hK,hL){eb.system_checker(function(hM,hN){var hO,hP,hQ;hO=cT.inferType(hL,hM);hP=hO[0];return hP.$==6||(hP.$==0?(hO[0]={$:6,$0:cT.get_range(hM)},true):hP.$==1?(hQ={$:6,$0:cT.get_range(hM)},(bX.iter(function(hR){hR[0]=hQ;},hP.$0),hO[0]=hQ,true)):fc.type_error(cT.get_range(hM),{$:1,$0:hP,$1:bX.ofArray([{$:6,$0:ec.emprange()}]),$2:hN}));},hI,hJ,hK,hL);};eb.erasePosns=function(hI){return hI.$==1?new fl({$:1,$0:em.erasePosns(hI.$0),$1:hI.$1}):hI.$==2?new fl({$:2,$0:eo.erasePosns(hI.$0),$1:hI.$1}):hI.$==3?new fl({$:3,$0:bX.map(eb.erasePosns,hI.$0),$1:hI.$1}):hI.$==4?new fl({$:4,$0:hI.$0,$1:ec.emprange(),$2:bX.map(cT.erasePosns,hI.$2),$3:hI.$3}):hI.$==5?new fl({$:5,$0:bX.map(eb.erasePosns,hI.$0)}):hI.$==6?new fl({$:6,$0:[hI.$0[0],bX.map(function(hJ){return hJ[1].$==0?[hJ[0],{$:0,$0:hJ[1].$0,$1:ec.emprange()}]:hJ[1].$==2?[hJ[0],{$:2,$0:hJ[1].$0,$1:ec.emprange()}]:hJ[1].$==3?[hJ[0],{$:3,$0:hJ[1].$0,$1:ec.emprange()}]:[hJ[0],{$:1,$0:cT.erasePosns(hJ[1].$0)}];},hI.$0[1])],$1:eb.erasePosns(hI.$1)}):hI.$==7?new fl({$:7,$0:cZ.map_mass_action_reaction(eb.erasePosns,hI.$0)}):hI.$==8?new fl({$:8,$0:hI.$0,$1:hI.$1}):new fl({$:0,$0:hI.$0,$1:hI.$1,$2:eb.erasePosns(hI.$2),$3:hI.$3,$4:hI.$4});};eb.from_species=function(hI,hJ){return hJ.$==0?new fl({$:1,$0:hJ.$0,$1:hI}):hJ.$==2?new fl({$:3,$0:bX.map(eb.from_content,hJ.$0),$1:hI}):hJ.$==3?be.FailWith("Unknown species "+hJ.$0+" cannot be converted to process"):hJ.$==4?new fl({$:8,$0:hJ.$0,$1:hI}):new fl({$:2,$0:hJ.$0,$1:hI});};eb.system_checker=function(hI,hJ,hK,hL,hM){function hN(hP,hQ){var hR,hS,hT;switch(hP[0]==="seq"?hP[1].$==0?hQ[0]==null?(hR=[hQ[1],hQ[3],hQ[4],hP[1].$1,hP[1].$0,hQ[2]],1):(hR=hP[1].$1,0):(hR=hP[0],10):hP[0]==="bind"?hP[1].$==1?hQ[1]==null?(hR=[hQ[3],hQ[4],hQ[0],hQ[2],hP[1].$0],3):(hR=hP[1].$0,2):(hR=hP[0],10):hP[0]==="unbind"?hP[1].$==1?hQ[2]==null?(hR=[hQ[1],hQ[3],hQ[4],hQ[0],hP[1].$0],5):(hR=hP[1].$0,4):(hR=hP[0],10):hP[0]==="colour"?hP[1].$==2?hQ[3]==null?(hR=[hQ[1],hP[1].$0,hQ[4],hQ[0],hQ[2]],7):(hR=hP[1].$1,6):(hR=hP[0],10):hP[0]==="subdomains"?hP[1].$==3?hQ[4]==null?(hR=[hQ[1],hQ[3],hP[1].$0,hQ[0],hQ[2]],9):(hR=hP[1].$1,8):(hR=hP[0],10):(hR=hP[0],10)){case 0:return fc.type_error(hR,{$:7,$0:hJ,$1:"seq"});case 1:return!hL?[{$:1,$0:{$:0,$0:hR[4],$1:hR[3]}},hR[0],hR[5],hR[1],hR[2]]:fc.type_error(hR[3],{$:8,$0:hJ});case 2:return fc.type_error(cT.get_range(hR),{$:7,$0:hJ,$1:"bind"});case 3:hS=hR[4];return hI(hS,"binding rate")?[hR[2],{$:1,$0:hS},hR[3],hR[0],hR[1]]:be.FailWith("");case 4:return fc.type_error(cT.get_range(hR),{$:7,$0:hJ,$1:"bind"});case 5:hT=hR[4];return hI(hT,"unbinding rate")?[hR[3],hR[0],{$:1,$0:hT},hR[1],hR[2]]:be.FailWith("");case 6:return fc.type_error(hR,{$:7,$0:hJ,$1:"colour"});case 7:return[hR[3],hR[0],hR[4],{$:1,$0:hR[1]},hR[2]];case 8:return fc.type_error(hR,{$:7,$0:hJ,$1:"subdomains"});case 9:return[hR[3],hR[0],hR[4],hR[1],{$:1,$0:hR[2]}];case 10:return fc.type_error(ec.emprange(),{$:9,$0:hJ,$1:hR});}}function hO(hP){return hP.$==1?hN(hP.$0,hO(hP.$1)):[null,null,null,null,null];}return hO(hK);};eb.from_content=function(hI){return hI.$==0?new fl({$:1,$0:hI.$0,$1:null}):new fl({$:2,$0:hI.$0,$1:null});};ec.bindings_to_env=function(hI){return bX.map(function(hJ){return[hJ[0],[{$:6,$0:null}]];},hI);};ec.emprange=function(){f9.$cctor();return f9.emprange;};ec.getBeginPos=function(hI){var hJ,hK;while(true){if(hI.$==1){hJ=hI.$2;return hJ.$==0?null:bX.head(hJ);}else if(hI.$==2)return hI.$0;else if(hI.$==3)return hI.$0;else if(hI.$==4)return hI.$0;else if(hI.$==5)return hI.$0;else if(hI.$==6)return hI.$0;else if(hI.$==7)return hI.$1;else if(hI.$==8)return hI.$1;else if(hI.$==9){hK=hI.$0;if(hK.$==0)return null;else hI=(bX.head(hK))[0];}else return null;}};ec.update_range=function(hI,hJ){return hI.$==1?{$:1,$0:hI.$0,$1:hI.$1,$2:bX.ofArray([hJ])}:hI.$==2?{$:2,$0:hJ}:hI.$==3?{$:3,$0:hJ}:hI.$==4?{$:4,$0:hJ}:hI.$==5?{$:5,$0:hJ}:hI.$==6?{$:6,$0:hJ}:hI.$==7?{$:7,$0:hI.$0,$1:hJ}:hI.$==8?{$:8,$0:hI.$0,$1:hJ}:hI.$==9?{$:9,$0:hI.$0}:gW.BottomT;};ec.unify=function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ,hR,hS;if(hJ===hK)return true;else{hM=hJ[0];hN=hK[0];switch(hM.$==0?(hL=hN,0):hM.$==1?hN.$==0?(hL=hM,1):hN.$==1?(hL=[hM.$1,hN.$1,hM.$0,hN.$0],2):(hL=[hM.$1,hN,hM.$0],3):hM.$==8?hN.$==0?(hL=hM,1):hN.$==1?(hL=[hN.$1,hM,hN.$0],3):hN.$==8?(hL=[hM.$0,hN.$0],4):6:hM.$==9?hN.$==0?(hL=hM,1):hN.$==1?(hL=[hN.$1,hM,hN.$0],3):hN.$==9?(hL=[hM.$0,hN.$0],5):6:hN.$==0?(hL=hM,1):hN.$==1?(hL=[hN.$1,hM,hN.$0],3):6){case 0:hJ[0]=ec.update_range(hL,hI);return true;case 1:hK[0]=ec.update_range(hL,hI);return true;case 2:hO=ec.merge_cat(hL[0],hL[1]);hP=dZ.union(cw.Equals,hL[2],hL[3]);hQ={$:1,$0:hP,$1:hO,$2:bX.ofArray([hI])};bX.iter(function(hT){hT[0]=hQ;},hP);return true;case 3:hR=hL[1];return ec.in_cat(hL[0],hR)&&(hS=ec.update_range(hR,hI),bX.iter(function(hT){hT[0]=hS;},hL[2]),true);case 4:return dZ.forall2(function(hT,hU){return ec.unify(hI,hT,hU);},hL[0],hL[1]);case 5:return dZ.forall2(function(hT,hU){return ec.unify(hI,hT,hU);},hL[0],hL[1]);case 6:return ec.equal(hJ,hK);}}};ec.unify_possibilities=function(hI,hJ,hK){return hK.$==0?hJ:hK.$==1?hK.$1==null?hJ:hK.$1.$0?dZ.intersection(cw.Equals,hJ,bX.ofArray([{$:3,$0:hI},{$:6,$0:hI}])):dZ.intersection(cw.Equals,hJ,bX.ofArray([{$:3,$0:hI},{$:6,$0:hI},{$:4,$0:hI}])):bX.ofArray([hK]);};ec.merge_cat=function(hI,hJ){return hI==null?hJ==null?null:{$:1,$0:hJ.$0}:hJ==null?{$:1,$0:hI.$0}:{$:1,$0:hI.$0||hJ.$0};};ec.in_cat=function(hI,hJ){return hI==null||(hI.$0&&ec.is_numeric(hJ)||ec.is_num_or_bool(hJ));};ec.equal=function(hI,hJ){var hK,hL;return hI===hJ||(hK=hI[0],(hL=hJ[0],hK.$==1?hL.$==1&&(cw.Equals(hK.$1,hL.$1)&&dZ.forall2(ec.equal,hK.$0,hL.$0)):hK.$==2?hL.$==2:hK.$==3?hL.$==3:hK.$==4?hL.$==4:hK.$==5?hL.$==5:hK.$==6?hL.$==6:hK.$==7?hL.$==7&&cw.Equals(hK.$0,hL.$0):hK.$==8?hL.$==8&&dZ.forall2(ec.equal,hK.$0,hL.$0):hK.$==9?hL.$==9&&dZ.forall2(ec.equal,hK.$0,hL.$0):hL.$==0));};ec.is_numeric=function(hI){var hJ;return hI.$==3||(hI.$==6||hI.$==1&&((hJ=hI.$1,hJ!=null&&hJ.$==1)&&hI.$1.$0));};ec.is_num_or_bool=function(hI){var hJ;return hI.$==3||(hI.$==6||(hI.$==4||hI.$==1&&(hJ=hI.$1,hJ!=null&&hJ.$==1)));};ec.format_range=function(hI,hJ){return ec.posLine(hI[0],hI[1])===ec.posLine(hJ[0],hJ[1])&&ec.posCol(hI[0],hI[1])===ec.posCol(hJ[0],hJ[1])?ec.format_pos(hI[0],hI[1]):ec.posLine(hI[0],hI[1])===ec.posLine(hJ[0],hJ[1])&&ec.posCol(hI[0],hI[1])!==ec.posCol(hJ[0],hJ[1])?ec.format_pos(hI[0],hI[1])+" - "+a.String(ec.posCol(hJ[0],hJ[1])):ec.format_pos(hI[0],hI[1])+" - "+ec.format_pos(hJ[0],hJ[1]);};ec.rangeBegin=function(hI){return(dZ.unoption(hI))[0];};ec.rangeEnd=function(hI){return(dZ.unoption(hI))[1];};ec.mkRange=function(hI,hJ){return{$:1,$0:[hI,hJ]};};ec.posLine=function(hI,hJ){return[hI,hJ][0];};ec.posCol=function(hI,hJ){return[hI,hJ][1];};ec.format_pos=function(hI,hJ){return"Line "+a.String(ec.posLine(hI,hJ)+1)+", char "+a.String(ec.posCol(hI,hJ));};ec.type_to_string=function(hI){var hJ;return hI.$==1?"unknown":hI.$==2?"string":hI.$==3?"int":hI.$==4?"bool":hI.$==5?"char":hI.$==6?"float":hI.$==7?(hJ=hI.$0,hJ!=null&&hJ.$==1)?hI.$0.$0?"normal domain":"toehold domain":"domain":hI.$==8?dZ.string_of_list(ec.type_to_string," * ",bX.map(function(hK){return hK[0];},hI.$0)):hI.$==9?dZ.string_of_list(ec.type_to_string,", ",bX.map(function(hK){return hK[0];},hI.$0)):"unknown";};ec.types_to_string=function(hI){return dZ.string_of_list(ec.type_to_string," or ",hI);};ed.fromSeq=function(hI){var hJ;hJ=ck.ofSeq(co.delay(function(){return co.collect(function(hK){return[c8.New(hK[0],hK[1])];},co.distinctBy(function(hK){return hK[0];},hI));}));ck.sortInPlace(hJ);return c6.Build(hJ,0,hJ.length-1);};ee.species_to_svg_circles=function(hI,hJ){var hK,hL,hM,hN;return hJ.$==0?(hK=ee.into_view(ee.collapse_circle(ee.from_strand(hJ.$0))),ee.circle_to_svg(hI,1,hK[0],hK[1],hK[2])):hJ.$==1?(hL=ee.into_view(ee.collapse_circle(ee.from_gate(hJ.$0))),ee.circle_to_svg(hI,1,hL[0],hL[1],hL[2])):hJ.$==2?ee.arrange_origami(hI,hJ.$0):hJ.$==4?(hM=ee.into_view(ee.collapse_circle(ee.from_logic_dsd(hJ.$0))),ee.circle_to_svg(hI,1,hM[0],hM[1],hM[2])):(hN=hJ.$0,cB.to_string_normalise(true,hI,cB.emerge_groups(bX.ofArray([dY.New(hN,{$:1,$0:hN},bY.Empty,false,bY.Empty,null)]))));};ee.from_strand=function(hI){return ee.make_base_circle(ck.ofList(new bY({$:1,$0:gb.Hole,$1:hI.$==1?bX.rev(ee.from_domains(hI.$0)):ee.from_domains(hI.$0)})),[]);};ee.collapse_circle=function(hI){var hJ;function hK(hL,hM,hN){return[hL,hM,ee.collapse_circle(hN)];}return ck.length(hI.edges)===0?gc.New(hI.center,hI.angle,hI.radius,hI.ports,bX.map(function(hL){return hK(hL[0],hL[1],hL[2]);},hI.children),hI.edges):ee.collapse_circle((hJ=ck.get(hI.edges,0),ee.circle_split(hJ[0],hJ[1],hI)));};ee.into_view=function(hI){var hJ,hK,hL,hM,hN,hO;function hP(hQ,hR){var hS,hT;hS=hR[0];hT=hR[1];return function(hU){var hV;function hW(h0,h1){return[h0*hC.cos(hQ)-h1*hC.sin(hQ),h0*hC.sin(hQ)+h1*hC.cos(hQ)];}function hX(h0,h1){return[h0+hS,h1+hT];}function hY(h0){return hW(h0[0],h0[1]);}function hZ(h0){return hX(h0[0],h0[1]);}hV=function(h0){return hZ(hY(h0));};return co.delay(function(){var h0,h1,h2;h0=hV(hU.center);h1=h0[1];h2=h0[0];return co.append([[h2+hU.radius*2,h1+hU.radius*2]],co.delay(function(){return co.append([[h2-hU.radius*2,h1-hU.radius*2]],co.delay(function(){function h3(h4,h5,h6){return(hP(hU.angle+hQ,[h2,h1]))(h6);}return co.collect(function(h4){return h3(h4[0],h4[1],h4[2]);},hU.children);}));}));});};}hJ=(hP(0,[0,0]))(hI);hK=co.min(co.map(function(hQ){return hQ[0];},hJ));hL=co.max(co.map(function(hQ){return hQ[0];},hJ));hM=co.min(co.map(function(hQ){return hQ[1];},hJ));hN=co.max(co.map(function(hQ){return hQ[1];},hJ));hO=hI.center;return[gc.New([hO[0]-hK+ee.pad(),hO[1]-hM+ee.pad()],hI.angle,hI.radius,hI.ports,hI.children,hI.edges),hL-hK+2*ee.pad(),hN-hM+2*ee.pad()];};ee.circle_to_svg=function(hI,hJ,hK,hL,hM){var hN;function hO(hQ){var hR;return(hQ.$==0?(hR=hQ.$0,false):hQ.$==1?(hR=hQ.$0,false):true)?"":hR.isToehold?(function(hS){return function(hT){return hS("svgdsd dom_"+cA.toSafe(hT));};}(a.id))(hR.name):"";}function hP(hQ,hR){var hS,hT;hS=hR[0];hT=hR[1];return function(hU){var hV,hW,hX,hY,hZ;function h0(h$,ia){return[h$*hC.cos(hQ)-ia*hC.sin(hQ),h$*hC.sin(hQ)+ia*hC.cos(hQ)];}function h1(h$,ia){return[h$+hS,ia+hT];}function h2(h$){return h0(h$[0],h$[1]);}function h3(h$){return h1(h$[0],h$[1]);}function h4(h$){var ia,ib;ia=hU.center;ib=hW*h$+hU.angle;return hX([ia[0]+hU.radius*hC.cos(ib),ia[1]+hU.radius*hC.sin(ib)]);}function h5(h$,ia,ib){var ic,id,ie;ic=h4(h$);id=h4(ia);ie=(hW*0.5*(h$+ia)+hU.angle+hQ)*360/ee.twopi();return(((((((((hB.Curried(function(_if,ig,ih,ii,ij,ik,il,im,_in){return _if("<path class=\\""+cA.toSafe(ig)+"\\" d=\\"M "+ih.toFixed(6)+","+ii.toFixed(6)+" A "+ij.toFixed(6)+","+ik.toFixed(6)+" "+il.toFixed(6)+" 0, 1 "+im.toFixed(6)+", "+_in.toFixed(6)+"\\"/>");},9))(a.id))(hO(ib)))(ic[0]))(ic[1]))(hU.radius))(hU.radius))(ie))(id[0]))(id[1]);}function h6(h$,ia){return h5(h$-0.5,h$+0.5,ia);}function h7(h$,ia){var ib,ic,id,ie;ib=h4(h$);ic=ib[1];id=ib[0];ie=90+(hW*h$+hU.angle+hQ)*360/ee.twopi();return((((((((hB.Curried(function(_if,ig,ih,ii,ij,ik,il,im){return _if("<text class=\\""+cA.toSafe(ig)+"\\" x=\\""+ih.toFixed(6)+"\\" y=\\""+ii.toFixed(6)+"\\" transform=\\"rotate("+ij.toFixed(6)+" "+ik.toFixed(6)+","+il.toFixed(6)+")\\" dy=\\"-4\\">"+cA.toSafe(im)+"</text>");},8))(a.id))(hO(ia)))(id))(ic))(ie))(id))(ic))(ia.get_text());}function h8(h$,ia,ib,ic){var id,ie,_if,ig,ih,ii,ij,ik,il,im,_in,io,ip,iq,ir,is,it,iu,iv,iw,ix,iy,iz,iA,iB,iC,iD,iE,iF,iG,iH,iI,iJ,iK,iL,iM,iN,iO;return ib.$==2?(id=ia.$==1?1-ee.overhang_to_hole():0.5,(ie=ic.$==1?1-ee.overhang_to_hole():0.5,(_if=3,(ig=hY?hW*(h$-1)+hU.angle+hQ+0.5*ee.pi():hW*(h$-id)+hU.angle+hQ,(ih=hY?h4(h$-1+hC.asin(hZ/hU.radius)/hW):h4(h$-id),(ii=ih[1],(ij=ih[0],(ik=ij-_if*hC.cos(ig),(il=ii-_if*hC.sin(ig),(im=ij+_if*hC.cos(ig),(_in=ii+_if*hC.sin(ig),(io=ij+3*_if*hC.cos(ig+0.5*ee.pi()),(ip=ii+3*_if*hC.sin(ig+0.5*ee.pi()),(iq=((((((((hB.Curried(function(iP,iQ,iR,iS,iT,iU,iV,iW){return iP("<path class=\\""+cA.toSafe(iQ)+"\\" d=\\"M "+iR.toFixed(6)+","+iS.toFixed(6)+" L "+iT.toFixed(6)+","+iU.toFixed(6)+" L "+iV.toFixed(6)+", "+iW.toFixed(6)+" z\\"/>");},8))(a.id))(hO(ia)))(ik))(il))(im))(_in))(io))(ip),(ir=hY?hW*(h$+1)+hU.angle+hQ-0.5*ee.pi():hW*(h$+ie)+hU.angle+hQ,(is=hY?h4(h$+1-hC.asin(hZ/hU.radius)/hW):h4(h$+ie),(it=is[1],(iu=is[0],(iv=iu-_if*hC.cos(ir),(iw=it-_if*hC.sin(ir),(ix=iu+_if*hC.cos(ir),(iy=it+_if*hC.sin(ir),(iz=((((((hB.Curried(function(iP,iQ,iR,iS,iT,iU){return iP("<path class=\\""+cA.toSafe(iQ)+"\\" d=\\"M "+iR.toFixed(6)+","+iS.toFixed(6)+" L "+iT.toFixed(6)+","+iU.toFixed(6)+"\\"/>");},6))(a.id))(hO(ic)))(iv))(iw))(ix))(iy),(((hB.Curried3(function(iP,iQ,iR){return iP(cA.toSafe(iQ)+"\\n"+cA.toSafe(iR));}))(a.id))(iq))(iz)))))))))))))))))))))))):ib.$==1?(iA=ic.$==2?ee.overhang_to_hole():0.5,(iB=ia.$==2?ee.overhang_to_hole():0.5,(iC=hC.asin(hZ/hU.radius)/hW,(iD=h4(h$-iC),(iE=iD[1],(iF=iD[0],(iG=h4(h$+iC),(iH=iG[1],(iI=iG[0],(iJ=hW*h$+hU.angle+hQ,(iK=3.7+ee.xing_side_length(ib),(iL=iF+0.5*iK*hC.cos(iJ),(iM=iE+0.5*iK*hC.sin(iJ),(iN=iI+0.5*iK*hC.cos(iJ),(iO=iH+0.5*iK*hC.sin(iJ),cS.concat("\\n",bX.ofArray([h5(h$-iB,h$-iC,ib),h5(h$+iC,h$+iA,ib),((((((hB.Curried(function(iP,iQ,iR,iS,iT,iU){return iP("<path class=\\""+cA.toSafe(iQ)+"\\" d=\\"M "+iR.toFixed(6)+","+iS.toFixed(6)+" L "+iT.toFixed(6)+","+iU.toFixed(6)+"\\"/>");},6))(a.id))(hO(ib)))(iF))(iE))(iL))(iM),((((((hB.Curried(function(iP,iQ,iR,iS,iT,iU){return iP("<path class=\\""+cA.toSafe(iQ)+"\\" d=\\"M "+iR.toFixed(6)+","+iS.toFixed(6)+" L "+iT.toFixed(6)+","+iU.toFixed(6)+"\\"/>");},6))(a.id))(hO(ib)))(iI))(iH))(iN))(iO)]))))))))))))))))):(((hB.Curried3(function(iP,iQ,iR){return iP(cA.toSafe(iQ)+"\\n"+cA.toSafe(iR));}))(a.id))(h6(h$,ib)))(h7(h$,ib));}function h9(h$,ia){var ib,ic;ib=h4(h$);ic=h4(ia);return(((((hB.Curried(function(id,ie,_if,ig,ih){return id("<path class=\\"circle_edge\\" d=\\"M "+ie.toFixed(6)+","+_if.toFixed(6)+" L "+ig.toFixed(6)+","+ih.toFixed(6)+"\\"/>");},5))(a.id))(ib[0]))(ib[1]))(ic[0]))(ic[1]);}function h_(h$,ia,ib){var ic,id,ie,_if,ig;ic=h4(h$);id=ic[1];ie=ic[0];_if=(hW*h$+hU.angle+hQ)*360/ee.twopi();ig=ee.xing_side_length(ia)/4;return cS.concat("\\n",bX.ofArray([(((((((((hB.Curried(function(ih,ii,ij,ik,il,im,_in,io,ip){return ih("<text class=\\""+cA.toSafe(ii)+"\\" x=\\""+ij.toFixed(6)+"\\" y=\\""+ik.toFixed(6)+"\\" transform=\\"rotate("+il.toFixed(6)+" "+im.toFixed(6)+","+_in.toFixed(6)+")\\" dx=\\""+io.toFixed(6)+"\\" dy=\\"-8\\">"+cA.toSafe(ip)+"</text>");},9))(a.id))(hO(ia)))(ie))(id))(_if))(ie))(id))(ig))(ia.get_text()),(((((((((hB.Curried(function(ih,ii,ij,ik,il,im,_in,io,ip){return ih("<text class=\\""+cA.toSafe(ii)+"\\" x=\\""+ij.toFixed(6)+"\\" y=\\""+ik.toFixed(6)+"\\" transform=\\"rotate("+il.toFixed(6)+" "+im.toFixed(6)+","+_in.toFixed(6)+")\\" dx=\\"-"+io.toFixed(6)+"\\" dy=\\"-8\\">"+cA.toSafe(ip)+"</text>");},9))(a.id))(hO(ia)))(ie))(id))(_if+180))(ie))(id))(ig))(ia.get_compl().get_text()),(hP(hU.angle+hQ,hX(hU.center)))(ib)]));}hV=ck.length(hU.ports);hW=ee.twopi()/hV;hX=function(h$){return h3(h2(h$));};hY=!ee.circle_has_overhangs(hU.ports);hZ=4;return cS.concat("\\n",ck.concat([ck.mapi(function(h$,ia){return h8(h$,ck.get(hU.ports,h$===0?ck.length(hU.ports)-1:h$-1),ia,ck.get(hU.ports,h$===ck.length(hU.ports)-1?0:h$+1));},hU.ports),ck.map(function(h$){return h9(h$[0],h$[1]);},hU.edges),ck.ofList(bX.map(function(h$){return h_(h$[0],h$[1],h$[2]);},hU.children))]));};}hN=(hP(0,[0,0]))(hK);return((((((hB.Curried(function(hQ,hR,hS,hT,hU,hV){return hQ("<svg xmlns=\\"http://www.w3.org/2000/svg\\" width=\\""+hR.toFixed(6)+"\\" height=\\""+hS.toFixed(6)+"\\">\\n<style>"+cA.toSafe(hT)+"</style>\\n<g transform=\\"scale("+hU.toFixed(6)+")\\">\\n"+cA.toSafe(hV)+"\\n</g>\\n</svg>");},6))(a.id))(hL*hJ))(hM*hJ))(hI))(hJ))(hN);};ee.from_gate=function(hI){var hJ;function hK(hL){return co.fold(function(hM,hN){var hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX;function hY(h0,h1){return[h0<hO?h0:h0+hW,h1<hO?h1:h1+hW];}function hZ(h0,h1){return[h0+hX,h1+hX];}hO=ck.findIndexBack(function(h0){return h0.$===2;},hM.ports);hP=bX.splitAt(hO,bX.ofArray(hM.ports));hQ=hP[0];hR=bX.splitAt(ck.findIndexBack(function(h0){return h0.$===2;},hN.ports),bX.ofArray(hN.ports));hS=hR[0];hT=hR[1];hU=bX.append(hQ,bX.append(hS,bX.append(hT,bX.tail(hP[1]))));hV=ck.concat([(hW=hS.get_Length()+hT.get_Length()-1,ck.map(function(h0){return hY(h0[0],h0[1]);},hM.edges)),(hX=hQ.get_Length(),ck.map(function(h0){return hZ(h0[0],h0[1]);},hN.edges))]);return ee.make_base_circle(ck.ofList(hU),hV);},bX.head(hL),bX.tail(hL));}hJ=bX.map(function(hL){return hK(bX.map(ee.from_segment,hL));},hI);return co.fold(function(hL,hM){var hN,hO,hP,hQ,hR,hS,hT;function hU(hW,hX){return[hW<hN?hW+hQ.get_Length():hW-hP.get_Length(),hX<hN?hX+hQ.get_Length():hX-hP.get_Length()];}function hV(hW,hX){return[hW+hT,hX+hT];}hN=ck.findIndexBack(function(hW){return hW.$===2;},hL.ports);hO=bX.splitAt(hN,bX.ofArray(hL.ports));hP=hO[0];hQ=hO[1];hR=bX.append(hQ,bX.append(hP,bX.tail(bX.ofArray(hM.ports))));hS=ck.concat([ck.map(function(hW){return hU(hW[0],hW[1]);},hL.edges),(hT=ck.length(hL.ports)-1,ck.map(function(hW){return hV(hW[0],hW[1]);},hM.edges))]);return ee.make_base_circle(ck.ofList(hR),hS);},bX.head(hJ),bX.tail(hJ));};ee.arrange_origami=function(hI,hJ){var hK,hL,hM,hN,hO,hP;function hQ(hR,hS,hT){return dX.New(dY.New("",{$:1,$0:ee.circle_to_svg("",1,hR,hS,hT)},bY.Empty,false,bY.Empty,null),dW.New(hS,hT));}hK=dW.New(16,16);hL=cB.stackv(hK,10,bX.map(function(hR){return hQ(hR[0],hR[1],hR[2]);},bX.map(ee.into_view,bX.map(ee.collapse_circle,bX.map(function(hR){return hR.$==1?ee.from_gate(hR.$0):ee.from_strand(hR.$0);},hJ)))));hM="";hN=cS.length(hM)*8/2;hO=dW.New(2,2);return cB.to_string_normalise(false,hI,cB.emerge_groups(bX.ofArray([(hP=hL.box_group,dY.New(hP.name,{$:0,$0:bX.ofArray([fZ.New({$:1,$0:"svgdsd origami-border"},cB.rounded_box(hO,cB.translate_point_by(cB.scale_by(-1,hO),hL.box_dim),32),{$:1,$0:f0.New(hM,cB.translate_point_by(dW.New(-hN,0),cB.sub(hL.box_dim,hK)),{$:1,$0:"svgdsd"},cB.default_letter_width(),cB.translate_point_by(dW.New(-hN,0),cB.sub(hL.box_dim,hK)))})])},hP.anchors,hP.debug_anchors,hP.sub_groups,hP.offset))])));};ee.from_logic_dsd=function(hI){var hJ,hK,hL,hM,hN;function hO(hP,hQ){return hQ;}hJ=b5.to_concrete_process(hI);hK=(hL=bX.mapi(function(hP,hQ){return[hP,hQ];},hJ),co.fold(function(hP,hQ){var hR;hR=hQ[0];return co.fold(function(hS,hT){var hU,hV,hW,hX;hU=hT[0];hV=hT[1];return hV.$==0?(hW=hV.$1,(hX=bW.TryFind(hW,hS),hX!=null&&hX.$==1?hS.Add(hW,[hX.$0[0],ge.New(hR,hU)]):hS.Add(hW,[ge.New(hR,hU),ge.New(0,0)]))):hS;},hP,bX.mapi(function(hS,hT){return[hS,hT];},hQ[1]));},new cj.New([]),hL));hM=(hN=ee.find_perm(ck.ofList(hJ),new cK.New$1(c6.OfSeq(co.map(function(hP){return hO(hP[0],hP[1]);},bW.ToSeq(hK))))),hN==null?be.FailWith("Cannot visualize pseudoknot"):[hN.$0[0],hN.$0[1]]);return ee.make_base_circle(ck.ofList(bX.rev(ck.fold(function(hP,hQ){return bX.append(new bY({$:1,$0:gb.Hole,$1:bX.rev(bX.map(function(hR){return new gb({$:0,$0:hR});},bX.map(function(hR){return hR.$==1?hR.$0:hR.$0;},hQ)))}),hP);},bY.Empty,hM[0]))),hM[1]);};ee.make_base_circle=function(hI,hJ){return gc.New([0,0],0,ee.circle_radius(hI),hI,bY.Empty,hJ);};ee.from_domains=function(hI){return bX.map(function(hJ){return new gb({$:0,$0:gd.New(eg.get_name(eg.unstar(hJ)),eg.is_complemented(hJ),eg.is_toehold(hJ),g0.NoTagC)});},hI);};ee.circle_split=function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0,h1,h2,h3,h4,h5,h6,h7,h8;function h9(_in){return _in<hN?_in:_in-hN+hM;}function h_(_in){return _in<hN?_in:_in+hN-hM;}function h$(_in){return _in+hN+1;}function ia(_in){return _in-hN-1;}function ib(_in){return _in.$==0?new gb({$:1,$0:_in.$0}):be.FailWith("");}function ic(_in){return _in<hN||_in>hM;}function id(_in,io,ip){return ic(_in);}function ie(_in,io){return hB.Curried3(function(ip,iq,ir){var is,it,iu;is=ee.xing_side_length(ck.get(ip,iq));it=iq/_in*ee.twopi();iu=io+0.5*is+ir[1];return[[iu*hC.cos(it),iu*hC.sin(it)],it- -ee.twopi()/ir[0]+ee.pi()];});}function _if(_in,io){var ip;ip=(((function(iq){return ie(iq[0],iq[1]);}([hP,hU]))(hR))(_in))([ck.length(io.ports),io.radius]);return gc.New(ip[0],ip[1],io.radius,io.ports,io.children,io.edges);}function ig(_in,io,ip){return[h_(_in),io,_if(h_(_in),ip)];}function ih(_in,io){var ip;ip=(((function(iq){return ie(iq[0],iq[1]);}([hQ,hV]))(hS))(_in))([ck.length(io.ports),io.radius]);return gc.New(ip[0],ip[1],io.radius,io.ports,io.children,io.edges);}function ii(_in,io,ip){return[ia(_in),io,ih(ia(_in),ip)];}function ij(_in){return _in[0];}function ik(_in,io){return[h_(_in),h_(io)];}function il(_in,io){return[ia(_in),ia(io)];}function im(_in,io){return!cw.Equals(ee.sort_e(_in,io),[hN,hM]);}hL=ee.sort_e(hI,hJ);hM=hL[1];hN=hL[0];hO=ck.length(hK.ports);hP=hO-(hM-hN);hQ=hM-hN;hR=ck.init(hP,function(_in){return _in===hN?ib(ck.get(hK.ports,h9(_in))):ck.get(hK.ports,h9(_in));});hS=ck.init(hQ,function(_in){return _in===hQ-1?ib(ck.get(hK.ports,h$(_in))):ck.get(hK.ports,h$(_in));});hT=bX.partition(function(_in){return id(_in[0],_in[1],_in[2]);},hK.children);hU=ee.circle_radius(hR);hV=ee.circle_radius(hS);hW=bX.map(function(_in){return ig(_in[0],_in[1],_in[2]);},hT[0]);hX=(((function(_in){return ie(_in[0],_in[1]);}([hP,hU]))(hR))(hN))([hQ,hV]);hY=bX.map(function(_in){return ii(_in[0],_in[1],_in[2]);},hT[1]);hZ=ck.partition(function(_in){return ic(ij(_in));},hK.edges);h0=ck.map(function(_in){return ik(_in[0],_in[1]);},hZ[0]);h1=gc.New(hX[0],hX[1],hV,hS,hY,ck.map(function(_in){return il(_in[0],_in[1]);},ck.filter(function(_in){return im(_in[0],_in[1]);},hZ[1])));h2=-ee.twopi()/hO;h3=-ee.twopi()/hP;h4=hK.angle+h2-h3;h5=hK.radius*hC.cos(hK.angle+h2);h6=hK.radius*hC.sin(hK.angle+h2);h7=hU*hC.cos(h4+h3);h8=hU*hC.sin(h4+h3);return gc.New([hK.center[0]+h5-h7,hK.center[1]+h6-h8],h4,hU,hR,new bY({$:1,$0:[hN,ck.get(hK.ports,hN),h1],$1:hW}),h0);};ee.pad=function(){g1.$cctor();return g1.pad;};ee.twopi=function(){g1.$cctor();return g1.twopi;};ee.circle_has_overhangs=function(hI){return ck.exists(function(hJ){return hJ.$==0;},hI);};ee.xing_side_length=function(hI){var hJ,hK,hL;return(hI.$==1?(hJ=hI.$0,false):hI.$==0?(hJ=hI.$0,false):true)?ee.min_side_length():(hK=hJ.name.length*ee.xing_length_per_char(),(hL=ee.min_side_length(),cw.Compare(hK,hL)===1?hK:hL));};ee.overhang_to_hole=function(){g1.$cctor();return g1.overhang_to_hole;};ee.pi=function(){g1.$cctor();return g1.pi;};ee.from_segment=function(hI){var hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX;return hI.$==1?(hJ=hI.$0[2],(hK=hI.$0[1],(hL=hI.$0[0],(hM=hI.$0[3],hI.$0[4].$==1?(hN=new bY({$:1,$0:gb.Hole,$1:ee.from_domains(bX.append(hK,bX.append(hJ,bX.append(bX.rev(hM),bX.append(bX.rev(bX.map(eg.complement,hJ)),bX.rev(hL))))))}),(hO=bX.map(function(hY){return[hY+hK.get_Length(),hN.get_Length()-hY-hL.get_Length()];},bX.ofSeq(be.range(1,hJ.get_Length()))),ee.make_base_circle(ck.ofList(hN),ck.ofList(hO)))):(hP=new bY({$:1,$0:gb.Hole,$1:ee.from_domains(bX.append(bX.rev(hL),bX.append(bX.rev(bX.map(eg.complement,hJ)),bX.append(bX.rev(hM),bX.append(hJ,hK)))))}),(hQ=bX.map(function(hY){return[hY+hL.get_Length(),hP.get_Length()-hY-hK.get_Length()];},bX.ofSeq(be.range(1,hJ.get_Length()))),ee.make_base_circle(ck.ofList(hP),ck.ofList(hQ)))))))):(hR=hI.$0[2],(hS=hI.$0[1],(hT=hI.$0[0],(hU=ee.from_domains(bX.append(hS,bX.append(hR,hI.$0[3]))),(hV=bX.rev(ee.from_domains(bX.append(hT,bX.append(bX.map(eg.complement,hR),hI.$0[4])))),(hW=bX.append(new bY({$:1,$0:gb.Hole,$1:hU}),new bY({$:1,$0:gb.Hole,$1:hV})),(hX=bX.map(function(hY){return[hY+hS.get_Length(),hW.get_Length()-hY-hT.get_Length()];},bX.ofSeq(be.range(1,hR.get_Length()))),ee.make_base_circle(ck.ofList(hW),ck.ofList(hX)))))))));};ee.find_perm=function(hI,hJ){function hK(hO,hP){function hQ(hR,hS){return co.delay(function(){var hT,hU;return hS.$==1?(hT=hS.$1,(hU=hS.$0,co.append([bX.append(bX.rev(hR),bX.append(bX.ofArray([hO]),hS))],co.delay(function(){return hQ(new bY({$:1,$0:hU,$1:hR}),hT);})))):[bX.append(hP,bX.ofArray([hO]))];});}return hQ(bY.Empty,hP);}function hL(hO){var hP;return hO.$==1?co.collect((hP=hO.$0,function(hQ){return hK(hP,hQ);}),hL(hO.$1)):[bY.Empty];}function hM(hO,hP){return function(hQ){var hR,hS;hR=hQ[0];hS=hQ[1];return cw.Compare(hO,hR)===1&&cw.Compare(hO,hS)===-1&&(cw.Compare(hP,hS)===1||cw.Compare(hP,hR)===-1)||cw.Compare(hP,hR)===1&&cw.Compare(hP,hS)===-1&&(cw.Compare(hO,hS)===1||cw.Compare(hO,hR)===-1);};}function hN(hO,hP){return co.forall(function(hQ){return co.forall(function(hR){return!((function(hS){return hM(hS[0],hS[1]);}(hQ))(hR)||(function(hS){return hM(hS[0],hS[1]);}(hR))(hQ));},hP);},hP);}return co.tryFind(function(hO){return hN(hO[0],hO[1]);},co.map(function(hO){return ee.reorderBy(hO,hI,hJ);},co.map(function(hO){return ck.ofList(new bY({$:1,$0:0,$1:hO}));},hL(bX.ofSeq(be.range(1,ck.length(hI)-1))))));};ee.circle_radius=function(hI){var hJ;return!cw.Equals(hI,null)&&hI.length===2&&(ck.get(hI,0).$==1&&ck.get(hI,1).$==1)?4:0.5*(ee.min_side_length()*ck.length(hI))/ee.twopi()*(ee.circle_has_overhangs(hI)?1:0.4);};ee.sort_e=function(hI,hJ){return[cw.Compare(hI,hJ)===-1?hI:hJ,cw.Compare(hI,hJ)===1?hI:hJ];};ee.min_side_length=function(){g1.$cctor();return g1.min_side_length;};ee.xing_length_per_char=function(){g1.$cctor();return g1.xing_length_per_char;};ee.reorderBy=function(hI,hJ,hK){var hL;function hM(hN,hO){return[ge.New(ck.get(hI,hN.strand),hN.site),ge.New(ck.get(hI,hO.strand),hO.site)];}hL=ck.create(ck.length(hJ),null);ck.iteri(function(hN,hO){return ck.set(hL,hO,ck.get(hJ,hN));},hI);return[hL,ee.get_edges(hL,new cK.New$1(c6.OfSeq(co.map(function(hN){return hM(hN[0],hN[1]);},hK))))];};ee.get_edges=function(hI,hJ){var hK;function hL(hP,hQ){return ck.get(hK,hP)+hQ;}function hM(hP,hQ){return[hL.apply(null,hP),hL.apply(null,hQ)];}function hN(hP,hQ){return function(hR){return hR[0]-hP;};}function hO(hP,hQ){return[[hP.strand,hP.site],[hQ.strand,hQ.site]];}hK=ck.init(ck.length(hI),function(hP){return hP===0?0:hP+ck.sum(ck.map(function(hQ){return hQ.get_Length();},d1.array(hI,{$:1,$0:0},{$:1,$0:hP-1})));});return ck.sortWith(function(hP,hQ){return(function(hR){return hN(hR[0],hR[1]);}(hP))(hQ);},ck.ofSeq(co.map(function(hP){return ee.sort_e(hP[0],hP[1]);},co.map(function(hP){return hM(hP[0],hP[1]);},ck.map(function(hP){return hO(hP[0],hP[1]);},ck.ofSeq(hJ))))));};ef.empty=function(){ff.$cctor();return ff.empty;};ef.add_domains=function(hI,hJ){return dZ.fold_left(ef.add_domain,hI,hJ);};ef.initialise_mapping=function(hI){var hJ,hK,hL;hJ=ef.split_sequences(bR.getToeholdsText(hI));hK=ef.split_sequences(bR.getSpecificitiesText(hI));return bR.getCheckDNA(hI)?(bX.iter(function(hM){if(hM.length>=10)fc.dna_toe_error(hM);},hJ),bX.iter(function(hM){if(hM.length<10)fc.dna_spec_error(hM);},hK),hL=dZ.find_duplicate(function(hM){return function(hN){return hM===hN;};},bX.append(hJ,hK)),hL!=null&&hL.$==1?fc.dna_dup_error(hL.$0):el.New(hJ,hK,bY.Empty)):el.New(hJ,hK,bY.Empty);};ef.get_domain=function(hI,hJ){var hK,hL;hK=function(hM,hN){var hO,hP,hQ;while(true)if(hN.$==1){hO=hN.$0[1];hP=hN.$1;hQ=hN.$0[0];if(eg.equal(hM,hQ))return{$:1,$0:hO};else hN=hP;}else return null;}(eg.unstar(hJ),hI.assigned);return hK!=null&&hK.$==1?(hL=hK.$0,hL!=null&&hL.$==1)?{$:1,$0:{$:1,$0:eg.is_complemented(hJ)?bX.rev(ef.complement(hK.$0.$0)):hK.$0.$0}}:{$:1,$0:null}:null;};ef.parse_sequence=function(hI){return bX.ofArray(ck.map(function(hJ){return hJ==="A"?fh.Adenine:hJ==="C"?fh.Cytosine:hJ==="G"?fh.Guanine:hJ==="T"?fh.Thymine:fc.dna_char_error(hJ);},cS.ToCharArray(hI)));};ef.add_domain=function(hI,hJ){var hK;hK=eg.unstar(hJ);return ef.get_domain(hI,hK)==null?hK.$==1?hK.$0.$==3?el.New(hI.toeholds,hI.specificities,new bY({$:1,$0:[hK,{$:1,$0:bX.head(ef.parse_sequences(hK.$0.$2))}],$1:hI.assigned})):ef.assign_next_specificity(hK,hI):hK.$0.$==3?el.New(hI.toeholds,hI.specificities,new bY({$:1,$0:[hK,{$:1,$0:bX.head(ef.parse_sequences(hK.$0.$2))}],$1:hI.assigned})):ef.assign_next_toehold(hK,hI):hI;};ef.split_sequences=function(hI){return bX.filter(function(hJ){return hJ.length>0;},bX.map(cS.Trim,bX.ofArray(cS.SplitChars(hI,["\\r","\\n"],0))));};ef.complement=function(hI){return bX.map(ef.complement_dnabase,hI);};ef.parse_sequences=function(hI){return bX.map(ef.parse_sequence,ef.split_sequences(hI));};ef.assign_next_specificity=function(hI,hJ){var hK;hK=hJ.specificities;return hK.$==1?el.New(hJ.toeholds,hK.$1,new bY({$:1,$0:[hI,{$:1,$0:ef.parse_sequence(hK.$0)}],$1:hJ.assigned})):el.New(hJ.toeholds,hJ.specificities,new bY({$:1,$0:[hI,null],$1:hJ.assigned}));};ef.assign_next_toehold=function(hI,hJ){var hK;hK=hJ.toeholds;return hK.$==1?el.New(hK.$1,hJ.specificities,new bY({$:1,$0:[hI,{$:1,$0:ef.parse_sequence(hK.$0)}],$1:hJ.assigned})):el.New(hJ.toeholds,hJ.specificities,new bY({$:1,$0:[hI,null],$1:hJ.assigned}));};ef.string_of_sequence=function(hI){return dZ.string_of_list(ef.string_of_dnabase,"",hI);};ef.complement_dnabase=function(hI){return hI.$==1?fh.Cytosine:hI.$==2?fh.Guanine:hI.$==3?fh.Adenine:fh.Thymine;};ef.string_of_dnabase=function(hI){return hI.$==1?"G":hI.$==2?"C":hI.$==3?"T":"A";};eg.is_toehold=function(hI){return hI.$==0;};eg.get_name=function(hI){var hJ,hK;hJ=eg.get_value(hI);return(hJ.$==2?(hK=hJ.$0,true):hJ.$==3&&(hK=hJ.$0,true))?hK+(eg.is_complemented(hI)?"*":""):cT.to_string(hJ);};eg.get_sequence=function(hI){var hJ;hJ=eg.get_value(hI);return hJ.$==2?"":hJ.$==3?hJ.$2:"";};eg.is_complemented=function(hI){return hI.$==1?hI.$1:hI.$2;};eg.is_tethered=function(hI){var hJ,hK;return hI.$==1?(hJ=hI.$2,hJ!=null&&hJ.$==1):(hK=hI.$3,hK!=null&&hK.$==1);};eg.display_picture=function(hI,hJ){var hK;switch(hI.$==0?(hK=[hI.$2,hI.$3,hI.$1,hI.$0],1):hI.$0.$==2?hI.$0.$0==="tether"?hI.$1?(hK=[hI.$1,hI.$2,hI.$0],2):(hK=hI.$2,0):(hK=[hI.$1,hI.$2,hI.$0],2):(hK=[hI.$1,hI.$2,hI.$0],2)){case 0:return eg.display_tether(hK);case 1:return(hJ&&hK[1]!=null?"!":"")+cT.to_string(hK[3])+(hK[0]?"*"+eg.display_doc_picture(hK[2]):"");case 2:return(hJ&&hK[1]!=null?"!":"")+cT.to_string(hK[2])+(hK[0]?"*":"");}};eg.free_names=function(hI){return hI.$==1?cT.free_names(hI.$0):bX.append(cT.free_names(hI.$1),cT.free_names(hI.$0));};eg.matches_list=function(hI,hJ){return dZ.forall2(eg.matches,hI,hJ);};eg.display_sequence=function(hI){return hI.$==1?hI.$1.$==0?eg.display(hI.$0):eg.display(hI.$0)+" "+eg.display_sequence(hI.$1):"_";};eg.eval_sequence=function(hI,hJ){return bX.map(function(hK){return eg["eval"](hI,hK);},hJ);};eg.display=function(hI){var hJ;switch(hI.$==0?(hJ=[hI.$2,hI.$1,hI.$3,hI.$0],1):hI.$0.$==7?hI.$0.$0==="tether"?hI.$1?(hJ=[hI.$1,hI.$2,hI.$0],2):(hJ=hI.$2,0):(hJ=[hI.$1,hI.$2,hI.$0],2):hI.$0.$==2?hI.$0.$0==="tether"?hI.$1?(hJ=[hI.$1,hI.$2,hI.$0],2):(hJ=hI.$2,0):(hJ=[hI.$1,hI.$2,hI.$0],2):(hJ=[hI.$1,hI.$2,hI.$0],2)){case 0:return"tether"+eg.display_tether(hJ);case 1:return eg.display_tether(hJ[2])+cT.to_string(hJ[3])+"^"+eg.display_doc(hJ[1])+(hJ[0]?"*":"");case 2:return eg.display_tether(hJ[1])+cT.to_string(hJ[2])+(hJ[0]?"*":"");}};eg.unstar=function(hI){return hI.$==1?{$:1,$0:hI.$0,$1:false,$2:hI.$2}:{$:0,$0:hI.$0,$1:hI.$1,$2:false,$3:hI.$3};};eg.star=function(hI){return hI.$==1?{$:1,$0:hI.$0,$1:true,$2:hI.$2}:{$:0,$0:hI.$0,$1:hI.$1,$2:true,$3:hI.$3};};eg.complement=function(hI){return hI.$==1?{$:1,$0:hI.$0,$1:!hI.$1,$2:hI.$2}:{$:0,$0:hI.$0,$1:hI.$1,$2:!hI.$2,$3:hI.$3};};eg.erasePosns=function(hI){return hI.$==1?{$:1,$0:cT.erasePosns(hI.$0),$1:hI.$1,$2:hI.$2}:{$:0,$0:cT.erasePosns(hI.$0),$1:cT.erasePosns(hI.$1),$2:hI.$2,$3:hI.$3};};eg.get_value=function(hI){return hI.$==1?hI.$0:hI.$0;};eg.equal=function(hI,hJ){return hI.$==1?hJ.$==1&&(cw.Equals(hI.$0,hJ.$0)&&cw.Equals(hI.$1,hJ.$1)):hJ.$==0&&(cw.Equals(hI.$0,hJ.$0)&&cw.Equals(hI.$1,hJ.$1)&&cw.Equals(hI.$2,hJ.$2));};eg.display_tether=function(hI){return hI!=null&&hI.$==1?"("+cS.concat(", ",bX.map(function(hJ){return eg.display_tag(hJ[0],hJ[1]);},hI.$0[0]))+")":"";};eg.display_doc_picture=function(hI){var hJ;switch(hI.$==6?hI.$0===1?0:(hJ=hI,2):hI.$==1?hI.$0===1?1:(hJ=hI,2):(hJ=hI,2)){case 0:return"";case 1:return"";case 2:return cT.to_string(hJ);}};eg.to_string=function(hI){var hJ;return(hJ=eg.get_value(hI),hJ.$==2?hJ.$0:hJ.$==3?hJ.$0:cT.to_string(hJ))+(eg.is_complemented(hI)?"*":"");};eg.matches=function(hI,hJ){var hK;switch(hI.$==0?hI.$0.$==7?hJ.$==0?hJ.$0.$==2?(hK=[hI.$2,hJ.$2,hI.$0.$0,hJ.$0.$0],1):hJ.$0.$==3?(hK=[hI.$2,hJ.$2,hI.$0.$0,hJ.$0.$0],1):4:4:hI.$0.$==2?hI.$0.$1===-1?hJ.$==0?hJ.$0.$==2?(hK=[hI.$2,hJ.$2,hI.$0.$0,hJ.$0.$0],2):4:4:hJ.$==0?hJ.$0.$==2?(hK=[hI.$2,hJ.$2,hI.$0.$1,hJ.$0.$1,hI.$0.$0,hJ.$0.$0],3):4:4:hI.$0.$==3?hI.$0.$1===-1?hJ.$==0?hJ.$0.$==3?(hK=[hI.$2,hJ.$2,hI.$0.$0,hJ.$0.$0],2):4:4:hJ.$==0?hJ.$0.$==3?(hK=[hI.$2,hJ.$2,hI.$0.$1,hJ.$0.$1,hI.$0.$0,hJ.$0.$0],3):4:4:4:hI.$0.$==7?hI.$0.$0==="_"?0:hJ.$==1?hJ.$0.$==2?(hK=[hI.$1,hJ.$1,hI.$0.$0,hJ.$0.$0],1):hJ.$0.$==3?(hK=[hI.$1,hJ.$1,hI.$0.$0,hJ.$0.$0],1):4:4:hI.$0.$==2?hI.$0.$1===-1?hJ.$==1?hJ.$0.$==2?(hK=[hI.$1,hJ.$1,hI.$0.$0,hJ.$0.$0],2):4:4:hJ.$==1?hJ.$0.$==2?(hK=[hI.$1,hJ.$1,hI.$0.$1,hJ.$0.$1,hI.$0.$0,hJ.$0.$0],3):4:4:hI.$0.$==3?hI.$0.$1===-1?hJ.$==1?hJ.$0.$==3?(hK=[hI.$1,hJ.$1,hI.$0.$0,hJ.$0.$0],2):4:4:hJ.$==1?hJ.$0.$==3?(hK=[hI.$1,hJ.$1,hI.$0.$1,hJ.$0.$1,hI.$0.$0,hJ.$0.$0],3):4:4:4){case 0:return true;case 1:return hK[2]===hK[3]&&cw.Equals(hK[0],hK[1]);case 2:return hK[2]===hK[3]&&cw.Equals(hK[0],hK[1]);case 3:return hK[4]===hK[5]&&hK[2]===hK[3]&&cw.Equals(hK[0],hK[1]);case 4:return false;}};eg["eval"]=function(hI,hJ){return hJ.$==1?{$:1,$0:cT["eval"](hI,hJ.$0),$1:hJ.$1,$2:eg.eval_tether(hI,hJ.$2)}:{$:0,$0:cT["eval"](hI,hJ.$0),$1:cT["eval"](hI,hJ.$1),$2:hJ.$2,$3:eg.eval_tether(hI,hJ.$3)};};eg.display_doc=function(hI){var hJ;switch(hI.$==6?hI.$0===1?0:(hJ=hI,2):hI.$==1?hI.$0===1?1:(hJ=hI,2):(hJ=hI,2)){case 0:return"";case 1:return"";case 2:return"("+cT.to_string(hJ)+")";}};eg.display_tag=function(hI,hJ){return hJ===1?hI:"("+hI+","+dZ.display_float(hJ)+")";};eg.bind_rate=function(hI){return hI.$==1?cT.bind_rate(hI.$0,{$:6,$0:1,$1:null}):cT.bind_rate(hI.$0,hI.$1);};eg.unbind_rate=function(hI){return hI.$==1?cT.unbind_rate(hI.$0):cT.unbind_rate(hI.$0);};eg.length=function(hI,hJ,hK){var hL;switch(hK.$==1?hK.$0.$==3?(hL=hK.$0.$2,0):2:hK.$0.$==3?(hL=hK.$0.$2,0):1){case 0:return cS.length(hL);case 1:return hI;case 2:return hJ;}};eg.inferType=function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ;hK.$==0?eg.inferType_doc(hJ,hK.$1):void 0;hM=hK.$==1?hK.$0:hK.$0;if(hI!=null&&hI.$==1&&!hI.$0&&eg.is_tethered(hK))fc.type_error(cT.get_range(hM),{$:6,$0:eg.display(hK)});else{hN=cT.inferType(hJ,hM);hO=hN[0];switch(hO.$==7?hO.$0==null?hK.$==0?2:1:hO.$0.$0?hK.$==0?(hL=hO.$1,4):0:hK.$==1?(hL=hO.$1,3):0:hO.$==0?hK.$==0?2:1:hK.$==0?(hL=hO,6):(hL=hO,5)){case 0:null;break;case 1:hN[0]={$:7,$0:{$:1,$0:true},$1:cT.get_range(hM)};break;case 2:hN[0]={$:7,$0:{$:1,$0:false},$1:cT.get_range(hM)};break;case 3:fc.type_error(cT.get_range(hM),{$:4,$0:hL,$1:false});break;case 4:fc.type_error(cT.get_range(hM),{$:4,$0:hL,$1:true});break;case 5:hP="domain "+eg.display(hK);fc.type_error(cT.get_range(hM),{$:1,$0:hL,$1:bX.ofArray([{$:7,$0:{$:1,$0:true},$1:ec.emprange()}]),$2:hP});break;case 6:hQ="domain "+eg.display(hK);fc.type_error(cT.get_range(hM),{$:1,$0:hL,$1:bX.ofArray([{$:7,$0:{$:1,$0:false},$1:ec.emprange()}]),$2:hQ});break;}}};eg.eval_tether=function(hI,hJ){function hK(hL,hM){return eg.eval_tag(hI,hL,hM);}return hJ!=null&&hJ.$==1?{$:1,$0:[bX.map(function(hL){return hK(hL[0],hL[1]);},hJ.$0[0]),hJ.$0[1]]}:null;};eg.display_length=function(hI){var hJ,hK;switch(hI.$==0?(hK=[hI.$2,hI.$3,hI.$1,hI.$0],1):hI.$0.$==2?hI.$0.$0==="tether"?hI.$1?(hK=[hI.$1,hI.$2,hI.$0],2):(hK=hI.$2,0):(hK=[hI.$1,hI.$2,hI.$0],2):(hK=[hI.$1,hI.$2,hI.$0],2)){case 0:hJ=eg.display_tether(hK);break;case 1:hJ=(hK[1]!=null?"!":"")+cT.to_string(hK[3])+eg.display_doc_picture(hK[2]);break;case 2:hJ=(hK[1]!=null?"!":"")+cT.to_string(hK[2]);break;}return cS.length(hJ);};eg.inferType_doc=function(hI,hJ){var hK,hL,hM;hK=cT.inferType(hI,hJ);hL=hK[0];hL.$==6?void 0:hL.$==0?hK[0]={$:6,$0:cT.get_range(hJ)}:(hM="degree of complementarity "+cT.to_string(hJ),fc.type_error(cT.get_range(hJ),{$:1,$0:hL,$1:bX.ofArray([{$:6,$0:ec.emprange()}]),$2:hM}));};eg.eval_tag=function(hI,hJ,hK){var hL;hL=cT["eval"](hI,{$:7,$0:hJ,$1:ec.emprange()});return hL.$==2?[hL.$0,hK]:[hJ,hK];};eg.unstick_keep_doc_list=function(hI){return bX.unzip(bX.map(eg.unstick_keep_doc,hI));};eg.matching_toeholds=function(hI,hJ,hK){var hL,hM,hN,hO,hR,hS,hT,hU,hV,hW,hX,hY;hL=bY.Empty;hM=bY.Empty;hN=bY.Empty;hO=hJ;function hP(hZ,h0){var h1,h2,h3,h4,h5,h6,h7;h1=bY.Empty;h2=[hZ,h0];while(true){if(h2[0].$==1){if(h2[1].$==1){h4=h2[1].$0;h5=h2[1].$1;h6=h2[0].$0;h7=h2[0].$1;if(eg.are_complements(h6,h4)&&eg.tags_in_common(h4,h6)){h1=new bY({$:1,$0:h4,$1:h1});h2=[h7,h5];}else return bY.Empty;}else return bY.Empty;}else{h3=h2[1];return bX.ofArray([[bX.rev(h1),h3]]);}}}function hQ(hZ,h0){var h1,h2,h3,h4,h5,h6,h7,h8,h9;h1=bY.Empty;h2=bY.Empty;h3=hK;while(true)if(h3.$==1){if(h3.$0.$==0){h4=h3.$0;h5=h3.$1;h6=hP(h0,h3);h7=bX.map(function(h_){return function(h$){var ia,ib,ic;ia=h$[0];ib=ia.$==1&&(ia.$1.$==0&&(ic=ia.$0,true))?[ic,null]:[eg.complement(hZ),{$:1,$0:ia}];return[bX.rev(h_),ib,h$[1]];};}(h2),h6);h1=bX.append(h1,h7);h2=new bY({$:1,$0:h4,$1:h2});h3=h5;}else{h8=h3.$0;h9=h3.$1;h2=new bY({$:1,$0:h8,$1:h2});h3=h9;}}else return h1;}while(true){hR=function(hZ,h0){return hB.Curried3(function(h1,h2,h3){var h4,h5;h4=h3[0];h5=h3[1];return function(h6){return bX.map(function(h7){var h8,h9,h_;h8=h7[1];h9=h8[0];h_=eg.tags_in_common_list(bX.ofArray([h9,h4]));return[[bX.append(hZ,h1),[eg.set_tags(h_,h4),h5],bX.append(h2,h0)],[h7[0],[eg.set_tags(h_,h9),h8[1]],h7[2]]];},h6);};});}(hN,hO);hS=function(hZ){return function(h0){var h1,h2,h3,h4,h5,h6;return(h0[1].$==1?h0[1].$1.$==0?(h1=[h0[1].$0,h0[2],h0[0]],true):(h1=[h0[2],h0[0],h0[1]],false):(h1=[h0[2],h0[0],h0[1]],false))?(h2=h1[0],(((hZ(h1[2]))(h1[1]))([h2,null]))(hQ(h2,bX.ofArray([h2])))):(h3=h1[2],h4=dZ.option_or(bX.map(function(h7){return dD.tryFind(hI,h7);},bX.ofArray([bX.map(eg.get_name,h3),bX.map(eg.get_name,dZ.rev_map(eg.complement,h3))]))),h4!=null&&h4.$==1?(h5=h4.$0,h6=hQ(h5,h3),h6.$==0?bY.Empty:(((hZ(h1[1]))(h1[0]))([h5,{$:1,$0:h3}]))(h6)):bY.Empty);};}(hR);if(hO.$==1){if(hO.$0.$==1){hT=hO.$0;hU=hO.$1;hV=bX.rev(hM);hW=bX.append(eg.search_sublists_ctx(hS,hV),hL);hL=hW;hM=bY.Empty;hN=bX.append(hN,bX.append(hV,bX.ofArray([hT])));hO=hU;}else{hX=hO.$0;hY=hO.$1;hM=new bY({$:1,$0:hX,$1:hM});hO=hY;}}else return bX.append(eg.search_sublists_ctx(hS,bX.rev(hM)),hL);}};eg.are_complements=function(hI,hJ){return hI.$==1?hJ.$==1&&(cw.Equals(hI.$0,hJ.$0)&&cw.Equals(!hI.$1,hJ.$1)):hJ.$==0&&(cw.Equals(hI.$0,hJ.$0)&&cw.Equals(!hI.$2,hJ.$2));};eg.stick=function(hI,hJ){var hK;function hL(hM,hN){var hO,hP;return hM==null?hN!=null&&hN.$==1?{$:1,$0:hN.$0}:null:hN==null?{$:1,$0:hM.$0}:(hO=hN.$0[1],{$:1,$0:[hM.$0[0],(hP=hM.$0[1],cw.Compare(hP,hO)===-1?hP:hO)]});}return hI.$==1?hJ.$==1?eg.update_tether(hI,hL(hI.$2,hJ.$2)):hI:hJ.$==0?(hK=hI.$3,eg.update_tether(hJ.$2?{$:0,$0:hI.$0,$1:hJ.$1,$2:hI.$2,$3:hK}:hI,hL(hK,hJ.$3))):hI;};eg.internal_complements=function(hI){function hJ(hL,hM,hN,hO){var hP,hQ;return hO.$==1?hO.$0.$==0?(hP=hO.$1,(hQ=hO.$0,eg.are_complements(hM,hQ)?new bY({$:1,$0:[bX.rev(hL),hM,bX.rev(hN),hQ,hP],$1:hJ(hL,hM,new bY({$:1,$0:hQ,$1:hN}),hP)}):hJ(hL,hM,new bY({$:1,$0:hQ,$1:hN}),hP))):hJ(hL,hM,new bY({$:1,$0:hO.$0,$1:hN}),hO.$1):bY.Empty;}function hK(hL,hM){var hN,hO;return hL.$==1?hL.$0.$==0?(hN=hL.$1,(hO=hL.$0,new bY({$:1,$0:[hM,hO,hN],$1:hK(hN,new bY({$:1,$0:hO,$1:hM}))}))):hK(hL.$1,new bY({$:1,$0:hL.$0,$1:hM})):bY.Empty;}return dZ.fold_left(function(hL,hM){return bX.append(hM,hL);},bY.Empty,bX.map(function(hL){return hJ(hL[0],hL[1],bY.Empty,hL[2]);},hK(hI,bY.Empty)));};eg.unstick=function(hI){var hJ,hK,hL;return hI.$==1?[hI,eg.complement(hI)]:(hJ=hI.$3,(hK=hI.$0,(hL=hI.$2,hL?[hI,{$:0,$0:hK,$1:{$:6,$0:1,$1:null},$2:!hL,$3:hJ}]:[{$:0,$0:hK,$1:{$:6,$0:1,$1:null},$2:hL,$3:hJ},{$:0,$0:hK,$1:hI.$1,$2:!hL,$3:hJ}])));};eg.unstick_list=function(hI){return bX.unzip(bX.map(eg.unstick,hI));};eg.unstick_keep_doc=function(hI){var hJ,hK,hL,hM;return hI.$==1?[hI,eg.complement(hI)]:(hJ=hI.$3,(hK=hI.$1,(hL=hI.$0,(hM=hI.$2,hM?[hI,{$:0,$0:hL,$1:hK,$2:!hM,$3:hJ}]:[{$:0,$0:hL,$1:hK,$2:hM,$3:hJ},{$:0,$0:hL,$1:hK,$2:!hM,$3:hJ}]))));};eg.get_tags=function(hI){var hJ,hK,hL;return(hI.$==1?(hK=hI.$2,hK!=null&&hK.$==1)&&(hJ=hI.$2.$0[0],true):(hL=hI.$3,hL!=null&&hL.$==1)&&(hJ=hI.$3.$0[0],true))?{$:1,$0:hJ}:null;};eg.localize_bind_rate=function(hI,hJ){var hK;switch(hI.$==1?hI.$0.$==2?(hK=[hI.$0.$4,hI.$1,hI.$2,hI.$0.$1,hI.$0.$2,hI.$0.$0,hI.$0.$3],2):hI.$0.$==3?(hK=[hI.$0.$5,hI.$1,hI.$2,hI.$0.$1,hI.$0.$3,hI.$0.$0,hI.$0.$2,hI.$0.$4],3):4:hI.$0.$==2?(hK=[hI.$0.$4,hI.$2,hI.$3,hI.$1,hI.$0.$1,hI.$0.$2,hI.$0.$0,hI.$0.$3],0):hI.$0.$==3?(hK=[hI.$0.$5,hI.$2,hI.$3,hI.$1,hI.$0.$1,hI.$0.$3,hI.$0.$0,hI.$0.$2,hI.$0.$4],1):4){case 0:return{$:0,$0:{$:2,$0:hK[6],$1:hK[4],$2:br.mul(hJ,hK[5]),$3:hK[7],$4:hK[0]},$1:hK[3],$2:hK[1],$3:hK[2]};case 1:return{$:0,$0:{$:3,$0:hK[6],$1:hK[4],$2:hK[7],$3:br.mul(hJ,hK[5]),$4:hK[8],$5:hK[0]},$1:hK[3],$2:hK[1],$3:hK[2]};case 2:return{$:1,$0:{$:2,$0:hK[5],$1:hK[3],$2:br.mul(hJ,hK[4]),$3:hK[6],$4:hK[0]},$1:hK[1],$2:hK[2]};case 3:return{$:1,$0:{$:3,$0:hK[5],$1:hK[3],$2:hK[6],$3:br.mul(hJ,hK[4]),$4:hK[7],$5:hK[0]},$1:hK[1],$2:hK[2]};case 4:return be.FailWith("expected domain value");}};eg.set_tags_list=function(hI,hJ){return bX.map(function(hK){return eg.set_tags(hI,hK);},hJ);};eg.search_sublists_ctx=function(hI,hJ){var hK,hL,hM,hN;hK=eg.get_sublists_ctx(hJ);while(true)if(hK.$==1){hL=hK.$1;hM=hK.$0;hN=bX.collect(hI,hM);if(hN.$==0)hK=hL;else return hN;}else return bY.Empty;};eg.tags_in_common_list=function(hI){return hI.$==1?hI.$1.$==0?eg.get_tags(hI.$0):eg.tags_intersect(eg.get_tags(hI.$0),eg.tags_in_common_list(hI.$1)):null;};eg.set_tags=function(hI,hJ){return hJ.$==1?hJ.$2==null?hI!=null&&hI.$==1?{$:1,$0:hJ.$0,$1:hJ.$1,$2:{$:1,$0:[hI.$0,-2]}}:hJ:hJ.$2.$0[1]===-2?hI!=null&&hI.$==1?{$:1,$0:hJ.$0,$1:hJ.$1,$2:{$:1,$0:[hI.$0,-2]}}:{$:1,$0:hJ.$0,$1:hJ.$1,$2:null}:hJ:hJ.$3==null?hI!=null&&hI.$==1?{$:0,$0:hJ.$0,$1:hJ.$1,$2:hJ.$2,$3:{$:1,$0:[hI.$0,-2]}}:hJ:hJ.$3.$0[1]===-2?hI!=null&&hI.$==1?{$:0,$0:hJ.$0,$1:hJ.$1,$2:hJ.$2,$3:{$:1,$0:[hI.$0,-2]}}:{$:0,$0:hJ.$0,$1:hJ.$1,$2:hJ.$2,$3:null}:hJ;};eg.tags_in_common=function(hI,hJ){return!cw.Equals(eg.tags_in_common_list(bX.ofArray([hI,hJ])),{$:1,$0:bY.Empty});};eg.update_tether=function(hI,hJ){return hI.$==1?{$:1,$0:hI.$0,$1:hI.$1,$2:hJ}:{$:0,$0:hI.$0,$1:hI.$1,$2:hI.$2,$3:hJ};};eg.all_tags_list=function(hI){return eg.all_gotten_tags_list(eg.get_tags,hI);};eg.all_tethered_tags_list=function(hI){return eg.all_gotten_tags_list(eg.get_tethered_tags,hI);};eg.add_tags_list=function(hI,hJ){return bX.map(function(hK){return eg.add_tags(hI,hK);},hJ);};eg.get_sublists_ctx=function(hI){var hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW;hJ=ck.ofList(hI);hK=hJ.length;hL=[bY.Empty];for(hM=1,hN=hK;hM<=hN;hM++){hU=[bY.Empty];for(hV=0,hW=hK-hM;hV<=hW;hV++)hU[0]=new bY({$:1,$0:[ck.sub(hJ,0,hV),ck.sub(hJ,hV,hM),ck.sub(hJ,hV+hM,hK-hM-hV)],$1:hU[0]});hT=dZ.rev_map(function(hX){return[bX.ofArray(hX[0]),bX.ofArray(hX[1]),bX.ofArray(hX[2])];},hU[0]);hR={$:1,$0:hT,$1:hL[0]};hP=new bY(hR);hL[0]=hP;}return hL[0];};eg.tags_intersect=function(hI,hJ){var hK;return hI!=null&&hI.$==1&&(hJ!=null&&hJ.$==1&&(hK=[hI.$0,hJ.$0],true))?{$:1,$0:dZ.intersection(cw.Equals,hK[0],hK[1])}:null;};eg.all_gotten_tags_list=function(hI,hJ){return dZ.fold_left(function(hK,hL){var hM,hN;hN=hI(hL);switch(hK==null?hN!=null&&hN.$==1?(hM=hN.$0,1):2:hN==null?(hM=hK.$0,1):(hM=[hK.$0,hN.$0],0)){case 0:return{$:1,$0:dZ.union(cw.Equals,hM[0],hM[1])};case 1:return{$:1,$0:hM};case 2:return null;}},null,hJ);};eg.get_tethered_tags=function(hI){var hJ,hK,hL;return(hI.$==1?(hK=hI.$2,hK!=null&&hK.$==1)&&(hI.$2.$0[1]>=0&&(hJ=[hI.$2.$0[1],hI.$2.$0[0]],true)):(hL=hI.$3,hL!=null&&hL.$==1)&&(hI.$3.$0[1]>=0&&(hJ=[hI.$3.$0[1],hI.$3.$0[0]],true)))?{$:1,$0:hJ[1]}:null;};eg.add_tags=function(hI,hJ){var hK,hL;return hI!=null&&hI.$==1?hJ.$==1?(hK=hJ.$2,hK!=null&&hK.$==1)?hJ.$2.$0[1]===-2?{$:1,$0:hJ.$0,$1:hJ.$1,$2:{$:1,$0:[dZ.union(cw.Equals,hJ.$2.$0[0],hI.$0),-2]}}:hJ:{$:1,$0:hJ.$0,$1:hJ.$1,$2:{$:1,$0:[hI.$0,-2]}}:(hL=hJ.$3,hL!=null&&hL.$==1)?hJ.$3.$0[1]===-2?{$:0,$0:hJ.$0,$1:hJ.$1,$2:hJ.$2,$3:{$:1,$0:[dZ.union(cw.Equals,hJ.$3.$0[0],hI.$0),-2]}}:hJ:{$:0,$0:hJ.$0,$1:hJ.$1,$2:hJ.$2,$3:{$:1,$0:[hI.$0,-2]}}:hJ;};eh=cM.DDomain=hB.Class({toString:function(){var hI;return this.name+(this.toehold?"^":"")+(this.complemented?"*":"")+(hI=this.pseudoknot,hI==null?"":"!"+a.String(hI.$0));},GetComplemented:function(){return eh.New(this.name,bX.rev(ef.complement(this.nucleotides)),this.toehold,!this.complemented,this.tether,this.pseudoknot);}},null,eh);eh.New=function(hI,hJ,hK,hL,hM,hN){return new eh({name:hI,nucleotides:hJ,toehold:hK,complemented:hL,tether:hM,pseudoknot:hN});};ej=ei.t=hB.Class({},null,ej);ek=bV.HashSet=hB.Class({get_Count:function(){return this.count;},Contains:function(hI){var hJ;hJ=this.data[this.hash(hI)];return hJ==null?false:this.arrContains(hI,hJ);},Add:function(hI){return this.add(hI);},arrContains:function(hI,hJ){var hK,hL,hM,hN;hK=true;hL=0;hN=hJ.length;while(hK&&hL<hN)if(this.equals.apply(null,[hJ[hL],hI]))hK=false;else hL=hL+1;return!hK;},add:function(hI){var hJ,hK;hJ=this.hash(hI);hK=this.data[hJ];return hK==null?(this.data[hJ]=[hI],this.count=this.count+1,true):this.arrContains(hI,hK)?false:(hK.push(hI),this.count=this.count+1,true);},GetEnumerator:function(){return df.Get(g7.concat(this.data));},GetEnumerator0:function(){return df.Get(g7.concat(this.data));}},b1,ek);ek.New$3=hB.Ctor(function(){ek.New$4.call(this,[],cw.Equals,cw.Hash);},ek);ek.New$4=hB.Ctor(function(hI,hJ,hK){var hL;b1.New.call(this);this.equals=hJ;this.hash=hK;this.data=[];this.count=0;hL=df.Get(hI);try{while(hL.MoveNext())this.add(hL.Current());}finally{if(typeof hL=="object"&&"Dispose"in hL)hL.Dispose();}},ek);el.New=function(hI,hJ,hK){return{toeholds:hI,specificities:hJ,assigned:hK};};em.free_names=function(hI){var hJ;hI.$==1?hJ=hI.$0:hJ=hI.$0;return bX.collect(eg.free_names,hJ);};em.matches=function(hI,hJ){function hK(hL,hM){var hN;return(hL.$==1?hM.$==1&&(hN=[hL.$0,hM.$0],true):hM.$==0&&(hN=[hL.$0,hM.$0],true))&&eg.matches_list(hN[0],hN[1]);}return hK(hI,hJ)||hK(hI,em.rotate(hJ));};em.equal=function(hI,hJ){return cw.Equals(hI,hJ)||cw.Equals(hI,em.rotate(hJ));};em.display=function(hI){return hI.$==1?"{"+eg.display_sequence(hI.$0)+"}":"<"+eg.display_sequence(hI.$0)+">";};em.standard_form=function(hI){return hI.$==1?hI:hI;};em["eval"]=function(hI,hJ){return hJ.$==1?{$:1,$0:eg.eval_sequence(hI,hJ.$0)}:{$:0,$0:eg.eval_sequence(hI,hJ.$0)};};em.erasePosns=function(hI){return hI.$==1?{$:1,$0:bX.map(eg.erasePosns,hI.$0)}:{$:0,$0:bX.map(eg.erasePosns,hI.$0)};};em.domains=function(hI){return hI.$==1?hI.$0:hI.$0;};em.rotate=function(hI){return em.reverse(em.mirror(hI));};em.reverse=function(hI){return hI.$==1?{$:1,$0:bX.rev(hI.$0)}:{$:0,$0:bX.rev(hI.$0)};};em.mirror=function(hI){return hI.$==1?{$:0,$0:hI.$0}:{$:1,$0:hI.$0};};em.inferType=function(hI,hJ,hK){var hL;hK.$==1?hL=hK.$0:hL=hK.$0;bX.iter(function(hM){eg.inferType(hI,hJ,hM);},hL);};em.exposed_nontoeholds=function(hI){return bX.filter(function(hJ){return!eg.is_toehold(hJ);},em.domains(hI));};em.is_upper=function(hI){return hI.$!=1;};em.append=function(hI,hJ){var hK;switch(hI.$==0?hJ.$==0?(hK=[hI.$0,hJ.$0],1):2:hJ.$==1?(hK=[hI.$0,hJ.$0],0):2){case 0:return{$:1,$0:bX.append(hK[0],hK[1])};case 1:return{$:0,$0:bX.append(hK[0],hK[1])};case 2:return be.FailWith("Strand.append: cannot join a lower and an upper strand");}};em.annotate_tag_sets=function(hI){return hI.$==1?{$:1,$0:eg.set_tags_list(em.get_tags(hI),hI.$0)}:{$:0,$0:eg.set_tags_list(em.get_tags(hI),hI.$0)};};em.mk_upper=function(hI){return{$:0,$0:bX.map(function(hJ){return hJ.$==0?{$:0,$0:hJ.$0,$1:{$:6,$0:1,$1:null},$2:hJ.$2,$3:hJ.$3}:hJ;},hI)};};em.get_tags=function(hI){return eg.all_tags_list(em.domains(hI));};em.tethered_domains=function(hI){var hJ;hI.$==1?hJ=hI.$0:hJ=hI.$0;return bX.filter(eg.is_tethered,hJ);};en.free_names=function(hI){return en.origami_collect(em.free_names,eo.free_names,hI);};en.matches=function(hI,hJ,hK){return bX.length(hJ)===bX.length(hK)&&bX.forall2(function(hL,hM){return hL.$==1?hM.$==1&&eo.matches(hI,hL.$0,hM.$0):hM.$==0&&em.matches(hL.$0,hM.$0);},hJ,hK);};en.equal=function(hI,hJ,hK){return bX.length(hJ)===bX.length(hK)&&bX.forall2(function(hL,hM){return hL.$==1?hM.$==1&&eo.equal(hI,hL.$0,hM.$0):hM.$==0&&em.equal(hL.$0,hM.$0);},hJ,hK);};en.display=function(hI){return"[[ "+dZ.string_of_list(dZ.id,"\\n | ",en.origami_collect(function(hJ){return bX.ofArray([em.display(hJ)]);},function(hJ){return bX.ofArray([eo.display(hJ)]);},hI))+" ]]";};en.standard_form=function(hI,hJ){return bX.sort(en.origami_map(em.standard_form,function(hK){return eo.standard_form(hI,hK);},hJ));};en["eval"]=function(hI,hJ){return en.origami_map(function(hK){return em["eval"](hI,hK);},function(hK){return eo["eval"](hI,hK);},hJ);};en.erasePosns=function(hI){return en.origami_map(em.erasePosns,eo.erasePosns,hI);};en.domains=function(hI){return en.origami_collect(em.domains,eo.domains,hI);};en.origami_collect=function(hI,hJ,hK){return dZ.collect(function(hL){return hL.$==1?hJ(hL.$0):hI(hL.$0);},hK);};en.rotate=function(hI,hJ){return en.origami_map(em.rotate,function(hK){return eo.rotate(hI,hK);},hJ);};en.origami_map=function(hI,hJ,hK){return bX.map(function(hL){return hL.$==1?{$:1,$0:hJ(hL.$0)}:{$:0,$0:hI(hL.$0)};},hK);};en.origami_species=function(hI){var hJ;hJ=en.separate_species(hI);return[hJ[1],hJ[0]];};en.exposed_nontoeholds=function(hI){return en.origami_collect(em.exposed_nontoeholds,eo.exposed_nontoeholds,hI);};en.separate_species=function(hI){var hJ;hJ=function(hK,hL,hM){var hN,hO,hP,hQ;while(true)if(hM.$==1){if(hM.$0.$==1){hN=hM.$0.$0;hO=hM.$1;hL=new bY({$:1,$0:hN,$1:hL});hM=hO;}else{hP=hM.$0.$0;hQ=hM.$1;hK=new bY({$:1,$0:hP,$1:hK});hM=hQ;}}else return[hK,hL];}(bY.Empty,bY.Empty,hI);return[bX.rev(hJ[0]),bX.rev(hJ[1])];};en.entry_reactions_sg=function(hI,hJ,hK,hL){return en.sticking_reactions_strand_gate(hI,hJ,hK,function(hM,hN){return bX.map(function(hO){return[hL,hO];},hN);});};en.entry_reactions_ss=function(hI,hJ,hK,hL){return en.sticking_reactions_strand_strand(hI,hJ,hK,function(hM){return bX.map(function(hN){return[hL,hN];},hM);});};en.fast_reactions=function(hI,hJ,hK){function hL(hO,hP,hQ,hR){return function(hS){return dZ.is_permutation((hB.Curried3(eo.equal))(hJ),hO,hS[0])&&dZ.is_permutation(function(hT){return function(hU){return em.equal(hT,hU);};},hP,hS[1])&&dZ.is_permutation((hB.Curried3(en.equal))(hJ),dZ.union(function(hT,hU){return en.equal(hJ,hT,hU);},bX.ofArray([hR]),hQ),dZ.union(function(hT,hU){return en.equal(hJ,hT,hU);},bX.ofArray([hS[3]]),hS[2]));};}function hM(hO,hP){var hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0,h1,h2,h3,h4,h5,h6,h7,h8,h9,h_,h$,ia,ib,ic,id,ie;ia=en.separate_species(hO);ib=ia[1];hS=bX.map(function(_if){return[bY.Empty,bY.Empty,hP,_if[4]];},dZ.collect(function(_if){return en.displacement_reactions(hJ,_if,hO);},ib));hW=bX.map(function(_if){return[bX.map(function(ig){return eo.standard_form(hJ,ig);},_if[5]),_if[6],hP,_if[4]];},dZ.collect(function(_if){return en.displacement_reactions_expel(hJ,_if,hO);},ib));h0=bX.map(function(_if){return[bY.Empty,bY.Empty,hP,_if[3]];},dZ.collect(function(_if){return en.open_migration_reactions(hJ,_if,hO);},ib));ic=bR.getRules(hJ);switch(ic=="Finite"?0:ic=="Default"?1:ic=="Detailed"?2:0){case 0:h2=bX.map(function(_if){return[bY.Empty,bY.Empty,hP,_if[4]];},dZ.collect(function(_if){return en.unsticking_reactions(hI,hJ,_if,hO);},ib));break;case 1:h2=bY.Empty;break;case 2:h2=be.FailWith("Origami.fast_reactions shouldn\'t be called in single step mode");break;}id=bR.getRules(hJ);switch(id=="Finite"?0:id=="Default"?1:id=="Detailed"?2:0){case 0:h6=bX.map(function(_if){return[bX.map(function(ig){return eo.standard_form(hJ,ig);},_if[5]),_if[6],hP,_if[4]];},dZ.collect(function(_if){return en.unsticking_reactions_expel(hI,hJ,_if,hO);},ib));break;case 1:h6=bY.Empty;break;case 2:h6=be.FailWith("Origami.fast_reactions shouldn\'t be called in single step mode");break;}ie=bR.getRules(hJ);switch(ie=="Finite"?0:ie=="Default"?1:ie=="Detailed"?2:0){case 0:h_=bX.map(function(_if){return[bY.Empty,bY.Empty,hP,_if[4]];},dZ.collect(function(_if){return en.unbind_open_reactions(hJ,_if,hO);},ib));break;case 1:h_=bY.Empty;break;case 2:h_=be.FailWith("Origami.fast_reactions shouldn\'t be called in single step");break;}h9=dZ.union(function(_if,ig){return(function(ih){return hL(ih[0],ih[1],ih[2],ih[3]);}(_if))(ig);},h_,bX.map(function(_if){return[bY.Empty,bY.Empty,hP,_if[3]];},dZ.collect(function(_if){return en.cover_reactions(hJ,_if,hO);},ib)));h5=dZ.union(function(_if,ig){return(function(ih){return hL(ih[0],ih[1],ih[2],ih[3]);}(_if))(ig);},h6,h9);h1=dZ.union(function(_if,ig){return(function(ih){return hL(ih[0],ih[1],ih[2],ih[3]);}(_if))(ig);},h2,h5);hX=dZ.union(function(_if,ig){return(function(ih){return hL(ih[0],ih[1],ih[2],ih[3]);}(_if))(ig);},h0,h1);hT=dZ.union(function(_if,ig){return(function(ih){return hL(ih[0],ih[1],ih[2],ih[3]);}(_if))(ig);},hW,hX);return dZ.union(function(_if,ig){return(function(ih){return hL(ih[0],ih[1],ih[2],ih[3]);}(_if))(ig);},hS,hT);}function hN(hO,hP,hQ,hR){var hS;function hT(hU,hV,hW,hX){return[bX.append(hU,hO),bX.append(hV,hP),hW,hX];}hS=hM(en.standard_form(hJ,hR),new bY({$:1,$0:hR,$1:hQ}));return hS.$==0?bX.ofArray([[hO,hP,hQ,hR]]):dZ.collect_union(function(hU,hV){return(function(hW){return hL(hW[0],hW[1],hW[2],hW[3]);}(hU))(hV);},function(hU){return hN(hU[0],hU[1],hU[2],hU[3]);},bX.map(function(hU){return hT(hU[0],hU[1],hU[2],hU[3]);},hS));}return bX.map(function(hO){return[hO[0],hO[1],hO[3]];},hN(bY.Empty,bY.Empty,bY.Empty,hK));};en.cover_reactions=function(hI,hJ,hK){return en.interior_reactions(hI,hK,eo.cover_reactions(hJ));};en.close_open_reactions=function(hI,hJ){var hK,hL,hM;function hN(hO,hP,hQ,hR){return[hO,hP,hQ,hR,en.construct_origami(hL,new bY({$:1,$0:hR,$1:((en.remove_gate(hI))(hP))(hM)}))];}hK=en.separate_species(hJ);hL=hK[0];hM=hK[1];return bX.map(function(hO){return hN(hO[0],hO[1],hO[2],hO[3]);},dZ.collect(function(hO){return eo.close_open_reactions(hI,hO);},hM));};en.close_displacing_reactions=function(hI,hJ){var hK,hL,hM;function hN(hO,hP,hQ,hR,hS){var hT,hU,hV;hT=((en.remove_gate(hI))(hP))(hM);hU=bX.partition(en.is_strand_free(),hS);hV=bX.partition(en.is_gate_free(),hR);return[hO,hP,hQ,hV[0],hU[0],en.construct_origami(bX.append(hU[1],hL),bX.append(hV[1],hT))];}hK=en.separate_species(hJ);hL=hK[0];hM=hK[1];return bX.map(function(hO){return hN(hO[0],hO[1],hO[2],hO[3],hO[4]);},dZ.collect(function(hO){return eo.close_displacing_reactions(hI,hO);},hM));};en.close_migration_reactions=function(hI,hJ){var hK,hL,hM;function hN(hO,hP,hQ,hR){return[hO,hP,hQ,hR,en.construct_origami(hL,new bY({$:1,$0:hR,$1:((en.remove_gate(hI))(hP))(hM)}))];}hK=en.separate_species(hJ);hL=hK[0];hM=hK[1];return bX.map(function(hO){return hN(hO[0],hO[1],hO[2],hO[3]);},dZ.collect(function(hO){return eo.close_migration_reactions(hI,hO);},hM));};en.open_migration_reactions=function(hI,hJ,hK){return en.interior_reactions(hI,hK,eo.open_migration_reactions(hI,hJ));};en.migration_reactions=function(hI,hJ,hK){return en.interior_reactions(hI,hK,eo.migration_reactions(hJ));};en.displacement_reactions_expel=function(hI,hJ,hK){return en.separating_reactions_expel(hI,hK,eo.displacement_reactions(hI,hJ));};en.displacement_reactions=function(hI,hJ,hK){return en.separating_reactions(hI,hK,eo.displacement_reactions(hI,hJ));};en.pinning_reactions_g=function(hI,hJ){var hK,hL,hM;function hN(hO,hP,hQ){return[hO,hP,hQ,en.construct_origami(hL,new bY({$:1,$0:hQ,$1:((en.remove_gate(hI))(hO))(hM)}))];}hK=en.separate_species(hJ);hL=hK[0];hM=hK[1];return bX.map(function(hO){return hN(hO[0],hO[1],hO[2]);},dZ.collect(function(hO){return eo.pin_gate(bR.getUnproductive(hI),hO);},hM));};en.pinning_reactions_s=function(hI,hJ){var hK,hL,hM;function hN(hO,hP,hQ){return[hO,hP,hQ,en.construct_origami(((en.remove_strand())(hO))(hL),new bY({$:1,$0:hQ,$1:hM}))];}hK=en.separate_species(hJ);hL=hK[0];hM=hK[1];return bX.map(function(hO){return hN(hO[0],hO[1],hO[2]);},dZ.collect(function(hO){return eo.pin_strand(bR.getUnproductive(hI),hO);},hL));};en.sticking_reactions_gs=function(hI,hJ,hK,hL){return en.sticking_reactions_strand_gate(hI,hJ,hK,function(hM){return bX.map(function(hN){return[hN,hL];},hM);});};en.sticking_reactions_sg=function(hI,hJ,hK,hL){return en.sticking_reactions_strand_gate(hI,hJ,hK,function(hM,hN){return bX.map(function(hO){return[hL,hO];},hN);});};en.sticking_reactions_ss=function(hI,hJ,hK,hL){return en.sticking_reactions_strand_strand(hI,hJ,hK,function(hM){return bX.choose(function(hN){return em.equal(hL,hN)?null:{$:1,$0:[hL,hN]};},hM);});};en.sticking_reactions_gg=function(hI,hJ,hK,hL){return en.sticking_reactions_gate_gate(hI,hJ,hK,function(hM,hN){return bX.choose(function(hO){return eo.equal(hJ,hL,hO)?null:{$:1,$0:[hL,hO]};},hN);});};en.unbind_open_reactions=function(hI,hJ,hK){return en.separating_reactions(hI,hK,eo.unbind_open_reactions(hI,hJ));};en.unsticking_reactions_expel=function(hI,hJ,hK,hL){return en.separating_reactions_expel(hJ,hL,eo.unsticking_reactions(hI,hJ,hK));};en.unsticking_reactions=function(hI,hJ,hK,hL){return en.separating_reactions(hJ,hL,eo.unsticking_reactions(hI,hJ,hK));};en.entry_reactions_gg=function(hI,hJ,hK,hL){return en.sticking_reactions_gate_gate(hI,hJ,hK,function(hM,hN){return bX.map(function(hO){return[hL,hO];},hN);});};en.entry_reactions_gs=function(hI,hJ,hK,hL){return en.sticking_reactions_strand_gate(hI,hJ,hK,function(hM){return bX.map(function(hN){return[hN,hL];},hM);});};en.sticking_reactions_strand_gate=function(hI,hJ,hK,hL){var hM,hN,hO;function hP(hR,hS){return bX.map(function(hT){return[hS,hR,en.localize_bind_rate_from_tags(hJ,hT[2]),eo.unannotate_tag_sets(hT[3])];},eo.stick_strand_to_gate(hI,bR.getUnproductive(hJ),em.annotate_tag_sets(hR),eo.annotate_tag_sets(hS)));}function hQ(hR,hS,hT,hU){return[hR,hS,hT,hU,en.construct_origami(((en.remove_strand())(hS))(hN),new bY({$:1,$0:hU,$1:((en.remove_gate(hJ))(hR))(hO)}))];}hM=en.separate_species(hK);hN=hM[0];hO=hM[1];return bX.map(function(hR){return hQ(hR[0],hR[1],hR[2],hR[3]);},bX.collect(function(hR){return hP(hR[0],hR[1]);},hL(hN,hO)));};en.sticking_reactions_strand_strand=function(hI,hJ,hK,hL){var hM,hN,hO;function hP(hR,hS){return bX.map(function(hT){return[hR,hS,en.localize_bind_rate_from_tags(hJ,hT[2]),eo.unannotate_tag_sets(hT[3])];},eo.stick_strand_to_strand(hI,bR.getUnproductive(hJ),em.annotate_tag_sets(hR),em.annotate_tag_sets(hS)));}function hQ(hR,hS,hT,hU){var hV;return[hR,hS,hT,hU,en.construct_origami((hV=((en.remove_strand())(hR))(hN),((en.remove_strand())(hS))(hV)),new bY({$:1,$0:hU,$1:hO}))];}hM=en.separate_species(hK);hN=hM[0];hO=hM[1];return bX.map(function(hR){return hQ(hR[0],hR[1],hR[2],hR[3]);},bX.collect(function(hR){return hP(hR[0],hR[1]);},hL(hN,hO)));};en.interior_reactions=function(hI,hJ,hK){var hL,hM,hN;function hO(hP,hQ,hR){return[hP,hQ,hR,en.construct_origami(hM,new bY({$:1,$0:hR,$1:((en.remove_gate(hI))(hP))(hN)}))];}hL=en.separate_species(hJ);hM=hL[0];hN=hL[1];return bX.map(function(hP){return hO(hP[0],hP[1],hP[2]);},hK);};en.construct_origami=function(hI,hJ){return bX.append(bX.map(function(hK){return{$:0,$0:hK};},hI),bX.map(function(hK){return{$:1,$0:hK};},hJ));};en.remove_gate=function(hI){function hJ(hK,hL){return eo.equal(hI,hK,hL);}return(hB.Curried3(dZ.remove_first))(function(hK){return function(hL){return hJ(hK,hL);};});};en.is_strand_free=function(){hs.$cctor();return hs.is_strand_free;};en.is_gate_free=function(){hs.$cctor();return hs.is_gate_free;};en.separating_reactions_expel=function(hI,hJ,hK){function hL(hM,hN,hO,hP){var hQ,hR,hS,hT;hQ=en.separate_species(hJ);hR=((en.remove_gate(hI))(hM))(hQ[1]);hS=bX.partition(en.is_strand_free(),hP);hT=bX.partition(en.is_gate_free(),hO);return[hM,hN,hO,hP,en.construct_origami(bX.append(hS[1],hQ[0]),bX.append(hT[1],hR)),hT[0],hS[0]];}return bX.map(function(hM){return hL(hM[0],hM[1],hM[2],hM[3]);},bX.filter(function(hM){return en.is_reaction_expelling(hM[0],hM[1],hM[2],hM[3]);},hK));};en.separating_reactions=function(hI,hJ,hK){function hL(hN,hO,hP,hQ){var hR,hS;hR=en.separate_species(hJ);hS=((en.remove_gate(hI))(hN))(hR[1]);return[hN,hO,hP,hQ,en.construct_origami(bX.append(hQ,hR[0]),bX.append(hP,hS))];}function hM(hN){return!hN;}return bX.map(function(hN){return hL(hN[0],hN[1],hN[2],hN[3]);},bX.filter(function(hN){return hM(en.is_reaction_expelling.apply(null,hN));},hK));};en.remove_strand=function(){hs.$cctor();return hs.remove_strand;};en.sticking_reactions_gate_gate=function(hI,hJ,hK,hL){var hM,hN,hO;function hP(hR,hS){return bX.map(function(hT){return[hR,hS,en.localize_bind_rate_from_tags(hJ,hT[2]),eo.unannotate_tag_sets(hT[3])];},eo.stick_gate_to_gate(hI,hJ,eo.annotate_tag_sets(hR),eo.annotate_tag_sets(hS)));}function hQ(hR,hS,hT,hU){var hV;return[hR,hS,hT,hU,en.construct_origami(hN,new bY({$:1,$0:hU,$1:(hV=((en.remove_gate(hJ))(hR))(hO),((en.remove_gate(hJ))(hS))(hV))}))];}hM=en.separate_species(hK);hN=hM[0];hO=hM[1];return bX.map(function(hR){return hQ(hR[0],hR[1],hR[2],hR[3]);},bX.collect(function(hR){return hP(hR[0],hR[1]);},hL(hN,hO)));};en.localize_bind_rate_from_tags=function(hI,hJ){var hK;function hL(hM,hN){return bR.get_local_concentration(hI,hM);}hK=eg.get_tags(hJ);return hK!=null&&hK.$==1?eg.localize_bind_rate(hJ,dZ.fold_left(br.add,{$:1,$0:0},bX.map(function(hM){return hL(hM[0],hM[1]);},hK.$0))):hJ;};en.is_reaction_expelling=function(hI,hJ,hK,hL){return bX.exists(en.is_gate_free(),hK)||bX.exists(en.is_strand_free(),hL);};eo.free_names=function(hI){return dZ.collect(function(hJ){return dZ.collect(ei.free_names,hJ);},hI);};eo.matches=function(hI,hJ,hK){function hL(hM,hN){return dZ.forall2(function(hO,hP){return dZ.forall2(ei.matches,hO,hP);},hM,hN);}return hL(hJ,hK)||hL(hJ,eo.rotate(hI,hK));};eo.equal=function(hI,hJ,hK){return cw.Equals(hJ,hK)||cw.Equals(hJ,eo.rotate(hI,hK));};eo.display=function(hI){function hJ(hK){return dZ.string_of_list(ei.display,":",hK);}return dZ.string_of_list(hJ,"::",hI);};eo.standard_form=function(hI,hJ){var hK,hL;hK=bR.getRules(hI);return(hK=="Finite"?false:hK=="Default"?false:hK!="Infinite")?eo.normalise(hJ):eo.normalise(eo.migrate_right_all(hJ));};eo["eval"]=function(hI,hJ){function hK(hL){return ei["eval"](hI,hL);}return bX.map(function(hL){return bX.map(hK,hL);},hJ);};eo.erasePosns=function(hI){return bX.map(function(hJ){return bX.map(ei.erasePosns,hJ);},hI);};eo.domains=function(hI){return dZ.collect(function(hJ){return dZ.collect(ei.domains,hJ);},hI);};eo.rotate=function(hI,hJ){return eo.standard_form(hI,eo.reverse(eo.mirror(hJ)));};eo.normalise=function(hI){return eo.mirror(bX.map(function(hJ){return dZ.map_pairs(function(hK){return eo.normalise_pair(hK[0],hK[1]);},hJ);},eo.mirror(bX.map(function(hJ){return dZ.map_pairs(function(hK){return eo.normalise_pair(hK[0],hK[1]);},hJ);},hI))));};eo.migrate_right_all=function(hI){function hJ(hK){var hL;while(true){hL=dZ.map_pairs(function(hM){return ei.migrate_right_simple(hM[0],hM[1]);},hK);if(cw.Equals(hK,hL))return hK;else hK=hL;}}return eo.mirror(bX.map(hJ,eo.mirror(bX.map(hJ,hI))));};eo.reverse=function(hI){return bX.map(function(hJ){return bX.map(ei.reverse,bX.rev(hJ));},bX.rev(hI));};eo.mirror=function(hI){return hI.$==1?dZ.glue(dZ.separate(bX.map(ei.mirror,hI.$0)),eo.mirror(hI.$1)):bY.Empty;};eo.inferType=function(hI,hJ,hK){function hL(hM){ei.inferType(hI,hJ,hM);}bX.iter(function(hM){bX.iter(hL,hM);},hK);};eo.normalise_pair=function(hI,hJ){var hK;switch(hI.$==1?hI.$0[4].$==0?hJ.$==1?hJ.$0[4].$==1?(hK=[hI.$0[3],hJ.$0[3],hJ.$0[0],hJ.$0[1],hI.$0[0],hI.$0[1],hI.$0[2],hJ.$0[2]],3):(hK=[hI,hJ],4):(hK=[hI.$0[3],hJ.$0[0],hJ.$0[1],hI.$0[0],hJ.$0[4],hI.$0[1],hJ.$0[3],hI.$0[2],hJ.$0[2]],2):(hK=[hI,hJ],4):hJ.$==1?hJ.$0[4].$==1?(hK=[hJ.$0[3],hI.$0[0],hJ.$0[0],hI.$0[1],hJ.$0[1],hI.$0[4],hI.$0[3],hI.$0[2],hJ.$0[2]],1):(hK=[hI,hJ],4):(hK=[hI.$0[0],hJ.$0[0],hI.$0[1],hJ.$0[1],hI.$0[4],hJ.$0[4],hI.$0[3],hJ.$0[3],hI.$0[2],hJ.$0[2]],0)){case 0:return[new ej({$:0,$0:[hK[0],hK[2],hK[8],hK[6],bX.append(hK[4],hK[1])]}),new ej({$:0,$0:[bY.Empty,hK[3],hK[9],hK[7],hK[5]]})];case 1:return[new ej({$:0,$0:[hK[1],hK[3],hK[7],hK[6],bX.append(hK[5],hK[2])]}),new ej({$:1,$0:[bY.Empty,hK[4],hK[8],hK[0],fi.Right]})];case 2:return[new ej({$:1,$0:[bX.append(hK[3],hK[1]),hK[5],hK[7],hK[0],fi.Left]}),new ej({$:0,$0:[bY.Empty,hK[2],hK[8],hK[6],hK[4]]})];case 3:return[new ej({$:1,$0:[bX.append(hK[4],hK[2]),hK[5],hK[6],hK[0],fi.Left]}),new ej({$:1,$0:[bY.Empty,hK[3],hK[7],hK[1],fi.Right]})];case 4:return be.FailWith("Illegally constructed pair of segments "+ei.display(hK[0])+" and "+ei.display(hK[1]));}};eo.exposed_nontoeholds=function(hI){return dZ.collect(function(hJ){return dZ.collect(ei.exposed_nontoeholds,hJ);},hI);};eo.last_segment=function(hI){return bX.last(bX.last(hI));};eo.first_segment=function(hI){return bX.head(bX.head(hI));};eo.leak_strand_into_gate=function(hI,hJ,hK){function hL(hO,hP,hQ,hR,hS,hT){function hU(hV,hW,hX){var hY,hZ,h0;h0=eo.ejected(hR,hP,hW,hS,hT);switch(h0[0].$==0?h0[1].$==1?h0[1].$1.$==0?(hZ=h0[1].$0,1):2:2:h0[0].$1.$==0?h0[1].$==0?(hZ=h0[0].$0,0):2:2){case 0:hY=[bX.ofArray([bX.ofArray([bX.append(hP,bX.append(bX.ofArray([hV]),hS))]),hZ]),bY.Empty];break;case 1:hY=[bX.ofArray([bX.append(hR,bX.append(bX.ofArray([bX.append(hP,bX.append(bX.ofArray([hV]),hS))]),hT))]),bX.ofArray([hZ])];break;case 2:hY=be.FailWith("Gate.leak_strand_into_gate: ejection not a single gate or strand");break;}return[hX,hY[0],hY[1]];}return bX.map(function(hV){return hU(hV[0],hV[1],hV[2]);},ei.leak_sg(hQ,hO));}function hM(hO,hP,hQ,hR,hS,hT){var hU,hV,hW,hX,hY,hZ,h0;while(true){if(hS.$==1){if(hS.$1.$==1){hW=hS.$0;hX=hS.$1.$0;hY=hS.$1.$1;hZ=(hU=bR.getRules(hI),(hU=="Infinite"?false:hU=="Finite"?false:hU!="Default")?[hW,hX]:ei.migrate_left_simple(hW,hX));h0=hL(hO,hQ,hZ[0],hR,new bY({$:1,$0:hZ[1],$1:hY}),hT);hP=bX.append(hP,h0);hQ=bX.append(hQ,bX.ofArray([hW]));hS=new bY({$:1,$0:hX,$1:hY});}else return bX.append(hP,hL(hO,hQ,hS.$0,hR,bY.Empty,hT));}else return be.FailWith("Gate.leak_reactions: empty gate");}}function hN(hO){return hO.$==1?bX.map(function(hP){return[hK,hO,hP[0],bX.map(eo.mirror,hP[1]),bX.map(em.mirror,hP[2])];},dZ.collect_contextual(function(hP,hQ,hR){var hS,hT,hU;return(((hS=em.mirror(hO),(hT=bY.Empty,(hU=bY.Empty,hB.Curried(hM,3,[hS,hT,hU]))))(hP))(hQ))(hR);},eo.mirror(hK))):bX.map(function(hP){return[hK,hO,hP[0],hP[1],hP[2]];},dZ.collect_contextual(function(hP,hQ,hR){var hS,hT;return(((hS=bY.Empty,(hT=bY.Empty,hB.Curried(hM,3,[hO,hS,hT])))(hP))(hQ))(hR);},hK));}return bX.filter(function(hO){return!cw.Equals([hO[3],hO[4]],[bX.ofArray([hO[0]]),bX.ofArray([hO[1]])]);},bX.append(hN(hJ),hN(em.rotate(hJ))));};eo.fast_reactions=function(hI,hJ,hK){var hL;function hM(hP,hQ){return function(hR){return dZ.is_permutation((hB.Curried3(eo.equal))(hJ),hP,hR[0])&&dZ.is_permutation(function(hS){return function(hT){return em.equal(hS,hT);};},hQ,hR[1]);};}function hN(hP){var hQ,hR,hS,hT,hU,hV,hW,hX,hY;hU=eo.displacement_reactions(hJ,hP);hV=bX.map(function(hZ){return[bX.map(function(h0){return eo.standard_form(hJ,h0);},hZ[2]),hZ[3]];},hU);hW=bX.map(function(hZ){return[bX.ofArray([eo.standard_form(hJ,hZ[2])]),bY.Empty];},eo.open_migration_reactions(hJ,hP));hX=bR.getRules(hJ);switch(hX=="Finite"?0:hX=="Default"?1:hX=="Detailed"?2:0){case 0:hQ=bX.map(function(hZ){return[bX.map(function(h0){return eo.standard_form(hJ,h0);},hZ[2]),hZ[3]];},eo.unsticking_reactions(hI,hJ,hP));break;case 1:hQ=bY.Empty;break;case 2:hQ=be.FailWith("Gate.fast_reactions shouldn\'t be called in single step mode");break;}hY=bR.getRules(hJ);switch(hY=="Finite"?0:hY=="Default"?1:hY=="Detailed"?2:0){case 0:hS=bX.map(function(hZ){return[bX.map(function(h0){return eo.standard_form(hJ,h0);},hZ[2]),hZ[3]];},eo.unbind_open_reactions(hJ,hP));break;case 1:hS=bY.Empty;break;case 2:hS=be.FailWith("Gate.fast_reactions shouldn\'t be called in single step");break;}return dZ.union(function(hZ,h0){return(function(h1){return hM(h1[0],h1[1]);}(hZ))(h0);},hS,dZ.union(function(hZ,h0){return(function(h1){return hM(h1[0],h1[1]);}(hZ))(h0);},hW,dZ.union(function(hZ,h0){return(function(h1){return hM(h1[0],h1[1]);}(hZ))(h0);},hV,dZ.union(function(hZ,h0){return(function(h1){return hM(h1[0],h1[1]);}(hZ))(h0);},hQ,bX.map(function(hZ){return[bX.ofArray([hZ[2]]),bY.Empty];},eo.cover_reactions(hP))))));}function hO(hP,hQ){var hR,hS,hT;function hU(hV,hW,hX){return function(hY){var hZ;hZ=hN(hY);return hZ.$==0?[hV,new bY({$:1,$0:hY,$1:hW}),hX]:[bX.append(hZ,hV),hW,true];};}hR=bX.map(function(hV){return eo.standard_form(hJ,hV);},hP);hS=dZ.fold_left(function(hV,hW){return(function(hX){return hU(hX[0],hX[1],hX[2]);}(hV))(hW);},[bY.Empty,bY.Empty,false],hR);hT=hS[1];return hS[2]?dZ.collect_union(function(hV,hW){return(function(hX){return hM(hX[0],hX[1]);}(hV))(hW);},function(hV){return hO(hV[0],hV[1]);},bX.map(function(hV){return[bX.append(hT,hV[0]),bX.append(hQ,hV[1])];},hS[0])):bX.ofArray([[hR,hQ]]);}hL=hO(hK,bY.Empty);return cw.Equals(hL,bX.ofArray([[hK,bY.Empty]]))?bY.Empty:hL;};eo.stick_strand_to_gate=function(hI,hJ,hK,hL){function hM(hP,hQ,hR,hS,hT,hU){var hW,hX,hY,hZ,h0;function hV(h1,h2,h3,h4,h5){return h3.$==0&&h2.$!==0&&!h1||h4.$==0&&h5.$!==0&&h1;}while(true){if(hT.$==1){hW=hT.$1;hX=hT.$0;hY=function(h1,h2){return hB.Curried3(function(h3,h4,h5){var h6,h7,h8,h9,h_,h$,ia,ib,ic,id,ie,_if,ig;return hJ||(h6=h5?h1.$==1?(h7=eo.unnormalise_pair(h3,h4),h8=eo.normalise_pair(h7[1],h1.$0),[{$:1,$0:h7[0]},h8[0],{$:1,$0:h8[1]}]):(h9=eo.unnormalise_pair(h3,h4),[{$:1,$0:h9[0]},h9[1],null]):(h_=dZ.get_last_element(h2),h_!=null&&h_.$==1?(h$=eo.normalise_pair(h3,h4),ia=eo.unnormalise_pair(h_.$0[1],h$[0]),[{$:1,$0:ia[0]},ia[1],{$:1,$0:h$[1]}]):(ib=eo.normalise_pair(h3,h4),[null,ib[0],{$:1,$0:ib[1]}])),ic=h6[1],id=h6[2],ie=h6[0],ie!=null&&ie.$==1&&(_if=ie.$0,ei.migrate_left(_if,ic)!=null||ei.displace_left(_if,ic)!=null||ei.migrate_open_left(_if,ic)!=null)||id!=null&&id.$==1&&(ig=id.$0,ei.migrate_right(ic,ig)!=null||ei.displace_right(ic,ig)!=null||ei.migrate_open_right(ic,ig)!=null)||ei.cover_left(ic)!=null||ei.cover_right(ic)!=null);});}(hW,hR);hZ=function(h1,h2,h3,h4,h5,h6){return function(h7){var h8,h9,h_,h$;h8=h7[0];h9=h7[1];h_=h7[2];h$=h7[3];return(h_[1]||((h1(h8))(h9))(h$))&&!((((h2(h$))(h3))(h4))(h5))(h6)?bX.ofArray([[h_[0],bX.append(h3,bX.append(bX.ofArray([bX.append(h4,bX.append(bX.ofArray([h8,h9]),h5))]),h6))]]):bY.Empty;};}(hY,hB.Curried(hV,5),hS,hR,hW,hU);h0=dZ.collect(hZ,ei.stick_sg(hI,hX,hP));hQ=bX.append(hQ,h0);hR=bX.append(hR,bX.ofArray([hX]));hT=hW;}else return hQ;}}function hN(hP,hQ){return bX.map(function(hR){return[hP,hQ,hR[0],hR[1]];},dZ.collect_contextual(function(hR,hS,hT){var hU,hV;return(((hU=bY.Empty,(hV=bY.Empty,hB.Curried(hM,3,[hQ,hU,hV])))(hR))(hS))(hT);},hP));}function hO(hP,hQ){return bX.map(function(hR){return[hP,hQ,hR[0],eo.mirror(hR[1])];},dZ.collect_contextual(function(hR,hS,hT){var hU,hV,hW;return(((hU=em.mirror(hQ),(hV=bY.Empty,(hW=bY.Empty,hB.Curried(hM,3,[hU,hV,hW]))))(hR))(hS))(hT);},eo.mirror(hP)));}return bX.append(bX.append(hN(hL,hK),hO(hL,hK)),bX.append(hN(hL,em.rotate(hK)),hO(hL,em.rotate(hK))));};eo.stick_strand_to_strand=function(hI,hJ,hK,hL){function hM(hO){return hJ||(ei.cover_left(hO)!=null||ei.cover_right(hO)!=null);}function hN(hO,hP){function hQ(hR,hS){return hS[1]||hM(hR)?bX.ofArray([[hO,hP,hS[0],bX.ofArray([bX.ofArray([hR])])]]):bY.Empty;}return dZ.collect(function(hR){return hQ(hR[0],hR[1]);},ei.stick_ss(hI,hO,hP));}return bX.append(hN(hK,hL),hN(hK,em.rotate(hL)));};eo.pin_strand=function(hI,hJ){function hK(hM){return hI||(ei.cover_left(hM)!=null||ei.cover_right(hM)!=null);}function hL(hM,hN){return hN[1]||hK(hM)?bX.ofArray([[hJ,hN[0],bX.ofArray([bX.ofArray([hM])])]]):bY.Empty;}return dZ.collect(function(hM){return hL(hM[0],hM[1]);},ei.pin_strand(hJ));};eo.cover_reactions=function(hI){function hJ(hK,hL,hM,hN,hO,hP){var hQ,hR,hS,hT;while(true){if(hO.$==1){hR=hO.$1;hS=hO.$0;hT=(hQ=hK(hS),hQ==null?bY.Empty:bX.ofArray([[hQ.$0[1],bX.append(hN,bX.append(bX.ofArray([bX.append(hM,bX.append(bX.ofArray([hQ.$0[0]]),hR))]),hP))]]));hL=bX.append(hL,hT);hM=bX.append(hM,bX.ofArray([hS]));hO=hR;}else return hL;}}return bX.append(bX.map(function(hK){return[hI,hK[0],eo.normalise(hK[1])];},dZ.collect_contextual(function(hK,hL,hM){var hN,hO;return(((hN=bY.Empty,(hO=bY.Empty,hB.Curried(hJ,3,[ei.cover_left,hN,hO])))(hK))(hL))(hM);},eo.unnormalise(hI))),bX.map(function(hK){return[hI,hK[0],hK[1]];},dZ.collect_contextual(function(hK,hL,hM){var hN,hO;return(((hN=bY.Empty,(hO=bY.Empty,hB.Curried(hJ,3,[ei.cover_right,hN,hO])))(hK))(hL))(hM);},hI)));};eo.close_open_reactions=function(hI,hJ){function hK(hO){var hP;function hQ(hR,hS,hT){return[hR,bX.ofArray([bX.ofArray([hS])]),hT];}return hO.$==1&&(hO.$0.$==1&&(hO.$0.$1.$==0&&(hO.$1.$==0&&(hP=hO.$0.$0,true))))?bX.map(function(hR){return hQ(hR[0],hR[1],hR[2]);},ei.close_lower_left_open(hP)):bY.Empty;}function hL(hO){function hP(hQ,hR,hS){return[hQ,eo.mirror(hR),hS];}return bX.append(hK(hO),bX.map(function(hQ){return hP(hQ[0],hQ[1],hQ[2]);},hK(eo.mirror(hO))));}function hM(hO,hP,hQ){return[hO,hJ,hQ,hP];}function hN(hO,hP,hQ){return[hO,hJ,hQ,eo.rotate(hI,hP)];}return bX.append(bX.map(function(hO){return hM(hO[0],hO[1],hO[2]);},hL(hJ)),bX.map(function(hO){return hN(hO[0],hO[1],hO[2]);},hL(eo.rotate(hI,hJ))));};eo.close_displacing_reactions=function(hI,hJ){function hK(hO){var hP,hQ,hR,hS,hT;function hU(hW,hX,hY,hZ){var h0;h0=eo.ejected(bY.Empty,bY.Empty,hY,new bY({$:1,$0:hX,$1:new bY({$:1,$0:hS,$1:hP})}),hQ);return h0[0].$==0?[hW,hZ,bX.ofArray([new bY({$:1,$0:new bY({$:1,$0:hX,$1:new bY({$:1,$0:hS,$1:hP})}),$1:hQ})]),h0[1]]:[hW,hZ,new bY({$:1,$0:bX.ofArray([bX.ofArray([hX])]),$1:h0[0]}),h0[1]];}function hV(hW,hX,hY,hZ){var h0;h0=eo.ejected(bY.Empty,bY.Empty,hY,bX.ofArray([hX]),hT);return h0[0].$==0?[hW,hZ,bX.ofArray([new bY({$:1,$0:bX.ofArray([hX]),$1:hT})]),h0[1]]:[hW,hZ,new bY({$:1,$0:bX.ofArray([bX.ofArray([hX])]),$1:h0[0]}),h0[1]];}return hO.$==1?hO.$0.$==1?hO.$0.$1.$==1?(hP=hO.$0.$1.$1,(hQ=hO.$1,(hR=eo.normalise_pair(hO.$0.$0,hO.$0.$1.$0),(hS=hR[1],bX.map(function(hW){return hU(hW[0],hW[1],hW[2],hW[3]);},ei.close_lower_left_displace(hR[0])))))):(hT=hO.$1,bX.map(function(hW){return hV(hW[0],hW[1],hW[2],hW[3]);},ei.close_lower_left_displace(hO.$0.$0))):bY.Empty:bY.Empty;}function hL(hO){function hP(hQ,hR,hS,hT){return[hQ,hR,bX.map(eo.mirror,hS),bX.map(em.mirror,hT)];}return bX.append(hK(hO),bX.map(function(hQ){return hP(hQ[0],hQ[1],hQ[2],hQ[3]);},hK(eo.mirror(hO))));}function hM(hO,hP,hQ,hR){return[hO,hJ,hP,hQ,hR];}function hN(hO,hP,hQ,hR){return[hO,hJ,hP,bX.map(function(hS){return eo.rotate(hI,hS);},hQ),bX.map(em.rotate,hR)];}return bX.append(bX.map(function(hO){return hM(hO[0],hO[1],hO[2],hO[3]);},hL(hJ)),bX.map(function(hO){return hN(hO[0],hO[1],hO[2],hO[3]);},hL(eo.rotate(hI,hJ))));};eo.close_migration_reactions=function(hI,hJ){function hK(hO){var hP,hQ,hR,hS,hT;function hU(hW,hX,hY,hZ){return[hW,hZ,new bY({$:1,$0:new bY({$:1,$0:hX,$1:new bY({$:1,$0:hY,$1:new bY({$:1,$0:hS,$1:hP})})}),$1:hQ})];}function hV(hW,hX,hY,hZ){return[hW,hZ,new bY({$:1,$0:bX.ofArray([hX,hY]),$1:hT})];}return hO.$==1?hO.$0.$==1?hO.$0.$1.$==1?(hP=hO.$0.$1.$1,(hQ=hO.$1,(hR=eo.normalise_pair(hO.$0.$0,hO.$0.$1.$0),(hS=hR[1],bX.map(function(hW){return hU(hW[0],hW[1],hW[2],hW[3]);},ei.close_lower_left_migrate(hR[0])))))):(hT=hO.$1,bX.map(function(hW){return hV(hW[0],hW[1],hW[2],hW[3]);},ei.close_lower_left_migrate(hO.$0.$0))):bY.Empty:bY.Empty;}function hL(hO){function hP(hQ,hR,hS){return[hQ,hR,eo.mirror(hS)];}return bX.append(hK(hO),bX.map(function(hQ){return hP(hQ[0],hQ[1],hQ[2]);},hK(eo.mirror(hO))));}function hM(hO,hP,hQ){return[hO,hJ,hP,hQ];}function hN(hO,hP,hQ){return[hO,hJ,hP,eo.rotate(hI,hQ)];}return bX.append(bX.map(function(hO){return hM(hO[0],hO[1],hO[2]);},hL(hJ)),bX.map(function(hO){return hN(hO[0],hO[1],hO[2]);},hL(eo.rotate(hI,hJ))));};eo.open_migration_reactions=function(hI,hJ){function hK(hL,hM,hN,hO,hP){var hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0,h1;while(true){if(hO.$==1){if(hO.$1.$==1){hW=hO.$0;hX=hO.$1.$0;hY=hO.$1.$1;hZ=(hQ=ei.migrate_open_left(hW,hX),hQ==null?bY.Empty:bX.ofArray([[hQ.$0[1],bX.append(hN,bX.append(bX.ofArray([bX.append(hM,bX.append(bX.ofArray([hQ.$0[0]]),hY))]),hP))]]));h0=(hR=bR.getRules(hI),(hR=="Infinite"?false:hR=="Finite"?false:hR!="Default")?[hX,hY]:(hT=eo.migrate_left_all(bX.ofArray([new bY({$:1,$0:hX,$1:hY})])),hT.$==1&&(hT.$0.$==1&&(hT.$1.$==0&&(hU=[hT.$0.$0,hT.$0.$1],true)))?[hU[0],hU[1]]:be.FailWith("Gate.open_migration_reactions: migrate_left_all should return singleton list")));h1=(hV=ei.migrate_open_right(hW,h0[0]),hV==null?bY.Empty:bX.ofArray([[hV.$0[1],bX.append(hN,bX.append(bX.ofArray([bX.append(hM,bX.append(bX.ofArray([hV.$0[0]]),h0[1]))]),hP))]]));hL=bX.append(hL,bX.append(hZ,h1));hM=bX.append(hM,bX.ofArray([hW]));hO=new bY({$:1,$0:hX,$1:hY});}else return hL;}else return hL;}}return bX.append(bX.map(function(hL){return[hJ,hL[0],hL[1]];},dZ.collect_contextual(function(hL,hM,hN){var hO,hP;return(((hO=bY.Empty,(hP=bY.Empty,hB.Curried(hK,3,[hO,hP])))(hL))(hM))(hN);},hJ)),bX.map(function(hL){return[hJ,hL[0],eo.mirror(hL[1])];},dZ.collect_contextual(function(hL,hM,hN){var hO,hP;return(((hO=bY.Empty,(hP=bY.Empty,hB.Curried(hK,3,[hO,hP])))(hL))(hM))(hN);},eo.mirror(hJ))));};eo.migration_reactions=function(hI){function hJ(hK,hL,hM,hN,hO){var hP,hQ,hR,hS,hT,hU,hV;while(true){if(hN.$==1){if(hN.$1.$==1){hR=hN.$0;hS=hN.$1.$0;hT=hN.$1.$1;hU=(hP=ei.migrate_left(hR,hS),hP!=null&&hP.$==1?bX.ofArray([[hP.$0[2],bX.append(hM,bX.append(bX.ofArray([bX.append(hL,bX.append(bX.ofArray([hP.$0[0],hP.$0[1]]),hT))]),hO))]]):bY.Empty);hV=(hQ=ei.migrate_right(hR,hS),hQ!=null&&hQ.$==1?bX.ofArray([[hQ.$0[2],bX.append(hM,bX.append(bX.ofArray([bX.append(hL,bX.append(bX.ofArray([hQ.$0[0],hQ.$0[1]]),hT))]),hO))]]):bY.Empty);hK=bX.append(hK,bX.append(hU,hV));hL=bX.append(hL,bX.ofArray([hR]));hN=new bY({$:1,$0:hS,$1:hT});}else return hK;}else return hK;}}return bX.append(bX.map(function(hK){return[hI,hK[0],hK[1]];},dZ.collect_contextual(function(hK,hL,hM){var hN,hO;return(((hN=bY.Empty,(hO=bY.Empty,hB.Curried(hJ,3,[hN,hO])))(hK))(hL))(hM);},hI)),bX.map(function(hK){return[hI,hK[0],eo.mirror(hK[1])];},dZ.collect_contextual(function(hK,hL,hM){var hN,hO;return(((hN=bY.Empty,(hO=bY.Empty,hB.Curried(hJ,3,[hN,hO])))(hK))(hL))(hM);},eo.mirror(hI))));};eo.displacement_reactions=function(hI,hJ){function hK(hL,hM,hN,hO,hP){var hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0,h1,h2,h3,h4,h5,h6,h7,h8,h9,h_;while(true){if(hO.$==1){if(hO.$1.$==1){hY=hO.$0;hZ=hO.$1.$0;h0=hO.$1.$1;h1=ei.displace_left(hY,hZ);if(h1==null)hQ=bY.Empty;else{h2=h1.$0[2];h3=h1.$0[0];h4=eo.ejected(hN,hM,h1.$0[1],bY.Empty,bY.Empty);switch(h4[0].$==0?h4[1].$==1?h4[1].$1.$==0?(hR=h4[1].$0,1):2:2:h4[0].$1.$==0?h4[1].$==0?(hR=h4[0].$0,0):2:2){case 0:hQ=bX.ofArray([[h2,bX.ofArray([bX.append(bX.ofArray([bX.append(bX.ofArray([h3]),h0)]),hP),hR]),bY.Empty]]);break;case 1:hQ=bX.ofArray([[h2,bX.ofArray([bX.append(hN,bX.append(bX.ofArray([bX.append(hM,bX.append(bX.ofArray([h3]),h0))]),hP))]),bX.ofArray([hR])]]);break;case 2:hQ=be.FailWith("Gate.displacement_reactions: leftward ejection not a single gate or strand");break;}}h5=(hS=bR.getRules(hI),(hS=="Infinite"?false:hS=="Finite"?false:hS!="Default")?[hZ,h0]:(hU=eo.migrate_left_all(bX.ofArray([new bY({$:1,$0:hZ,$1:h0})])),hU.$==1&&(hU.$0.$==1&&(hU.$1.$==0&&(hV=[hU.$0.$0,hU.$0.$1],true)))?[hV[0],hV[1]]:be.FailWith("Gate.displacement_reactions: migrate_left_all should return singleton list")));h6=h5[1];h7=ei.displace_right(hY,h5[0]);if(h7==null)hW=bY.Empty;else{h8=h7.$0[2];h9=h7.$0[0];h_=eo.ejected(bY.Empty,bY.Empty,h7.$0[1],h6,hP);switch(h_[0].$==0?h_[1].$==1?h_[1].$1.$==0?(hX=h_[1].$0,1):2:2:h_[0].$1.$==0?h_[1].$==0?(hX=h_[0].$0,0):2:2){case 0:hW=bX.ofArray([[h8,bX.ofArray([bX.append(hN,bX.ofArray([bX.append(hM,bX.ofArray([h9]))])),hX]),bY.Empty]]);break;case 1:hW=bX.ofArray([[h8,bX.ofArray([bX.append(hN,bX.append(bX.ofArray([bX.append(hM,bX.append(bX.ofArray([h9]),h6))]),hP))]),bX.ofArray([hX])]]);break;case 2:hW=be.FailWith("Gate.displacement_reactions: rightward ejection not a single gate or strand");break;}}hL=bX.append(hL,bX.append(hQ,hW));hM=bX.append(hM,bX.ofArray([hY]));hO=new bY({$:1,$0:hZ,$1:h0});}else return hL;}else return hL;}}return bX.append(bX.map(function(hL){return[hJ,hL[0],hL[1],hL[2]];},dZ.collect_contextual(function(hL,hM,hN){var hO,hP;return(((hO=bY.Empty,(hP=bY.Empty,hB.Curried(hK,3,[hO,hP])))(hL))(hM))(hN);},hJ)),bX.map(function(hL){return[hJ,hL[0],bX.map(eo.mirror,hL[1]),bX.map(em.mirror,hL[2])];},dZ.collect_contextual(function(hL,hM,hN){var hO,hP;return(((hO=bY.Empty,(hP=bY.Empty,hB.Curried(hK,3,[hO,hP])))(hL))(hM))(hN);},eo.mirror(hJ))));};eo.leak_gate_into_gate=function(hI,hJ,hK){return bY.Empty;};eo.pin_gate=function(hI,hJ){function hK(hL,hM,hN,hO,hP){var hQ,hR,hS,hT,hU;while(true)if(hO.$==1){hQ=hO.$1;hR=hO.$0;hS=function(hV,hW,hX,hY){return hB.Curried3(function(hZ,h0,h1){var h2,h3,h4,h5,h6,h7,h8,h9,h_,h$,ia,ib;return hI&&h1&&hV.$==0&&hW.$==0||hI&&!h1&&hX.$==0&&hY.$==0||(h2=h1?hW.$==0&&hV.$==0?(h4=eo.unnormalise_pair(hZ,h0),[{$:1,$0:h4[0]},{$:1,$0:h4[1]},null]):[null,null,null]:hX.$==0&&hY.$==0?(h6=eo.normalise_pair(hZ,h0),[null,{$:1,$0:h6[0]},{$:1,$0:h6[1]}]):[null,null,null],h7=h2[0],h8=h2[1],h9=h2[2],h7!=null&&h7.$==1?h8!=null&&h8.$==1&&(h9==null&&(h_=h7.$0,h$=h8.$0,ei.migrate_left(h_,h$)!=null||ei.displace_left(h_,h$)!=null||ei.migrate_open_left(h_,h$)!=null)):h8!=null&&h8.$==1?h9!=null&&h9.$==1&&(ia=h9.$0,ib=h8.$0,ei.migrate_right(ib,ia)!=null||ei.displace_right(ib,ia)!=null||ei.migrate_open_right(ib,ia)!=null):h9==null&&false);});}(hP,hQ,hM,hN);hT=function(hV,hW,hX,hY,hZ){return function(h0){var h1,h2,h3;h1=h0[0];h2=h0[1];h3=h0[2];return h3[1]||((hV(h1))(h2))(h0[3])?bX.ofArray([[h3[0],bX.append(hW,bX.append(bX.ofArray([bX.append(hX,bX.append(bX.ofArray([h1,h2]),hY))]),hZ))]]):bY.Empty;};}(hS,hN,hM,hQ,hP);hU=dZ.collect(hT,ei.pin_segment(hR));hL=bX.append(hL,hU);hM=bX.append(hM,bX.ofArray([hR]));hO=hQ;}else return hL;}return bX.append(bX.map(function(hL){return[hJ,hL[0],eo.mirror(hL[1])];},dZ.collect_contextual(function(hL,hM,hN){var hO,hP;return(((hO=bY.Empty,(hP=bY.Empty,hB.Curried(hK,3,[hO,hP])))(hL))(hM))(hN);},eo.mirror(hJ))),bX.map(function(hL){return[hJ,hL[0],hL[1]];},dZ.collect_contextual(function(hL,hM,hN){var hO,hP;return(((hO=bY.Empty,(hP=bY.Empty,hB.Curried(hK,3,[hO,hP])))(hL))(hM))(hN);},hJ)));};eo.stick_gate_to_gate=function(hI,hJ,hK,hL){var hM;function hN(hQ,hR,hS,hT){return hM||((hT?ei.migrate_left(ei.mirror(hQ),ei.mirror(hR))!=null||ei.displace_left(ei.mirror(hQ),ei.mirror(hR))!=null||ei.migrate_open_left(ei.mirror(hQ),ei.mirror(hR))!=null:ei.displace_left(hQ,hR)!=null||ei.migrate_left(hQ,hR)!=null||ei.migrate_open_left(ei.mirror(hQ),ei.mirror(hR))!=null)||(hT?ei.displace_right(hR,hS)!=null||ei.migrate_right(hR,hS)!=null||ei.migrate_open_right(hR,hS)!=null:ei.migrate_right(ei.mirror(hR),ei.mirror(hS))!=null||ei.displace_right(ei.mirror(hR),ei.mirror(hS))!=null||ei.migrate_open_right(ei.mirror(hR),ei.mirror(hS))!=null)||ei.cover_left(hR)!=null||ei.cover_right(hR)!=null);}function hO(hQ,hR){var hS,hT,hU,hV,hW,hX,hY,hZ,h0;hS=(hT=dZ.get_last_element(hQ),hT==null?be.FailWith("Gate.stick_gate_to_gate: gl is empty"):(hU=dZ.get_last_element(hT.$0[1]),hU==null?be.FailWith("Gate.stick_gate_to_gate: cslc is empty"):[hT.$0[0],hU.$0[0],hU.$0[1]]));hV=hS[0];hW=hS[1];hX=hR.$==0?be.FailWith("Gate.stick_gate_to_gate: gr is empty"):(hY=hR.$0,hY.$==0?be.FailWith("Gate.stick_gate_to_gate: ccsr is empty"):[hY.$0,hY.$1,hR.$1]);hZ=hX[2];h0=hX[1];return dZ.collect(function(h1){var h2,h3,h4,h5,h6;h2=h1[0];h3=h1[1];h4=h1[2];h5=h1[3];h6=h1[4];return h5[1]||hN(h2,h3,h4,h6)?bX.ofArray([[hQ,hR,h5[0],h6?bX.append(hV,bX.append(bX.ofArray([bX.append(hW,bX.ofArray([h2]))]),bX.append(bX.ofArray([new bY({$:1,$0:h3,$1:new bY({$:1,$0:h4,$1:h0})})]),hZ))):bX.append(hV,bX.append(bX.ofArray([bX.append(hW,bX.ofArray([h2,h3]))]),bX.append(bX.ofArray([new bY({$:1,$0:h4,$1:h0})]),hZ)))]]):bY.Empty;},ei.stick_gg(hI,hS[2],hX[0]));}function hP(hQ,hR){function hS(hT,hU,hV,hW){return[hU,hT,hV,hW];}return bX.map(function(hT){return hS(hT[0],hT[1],hT[2],hT[3]);},hO(hQ,hR));}hM=bR.getUnproductive(hJ);return bX.append(bX.append(hO(hK,hL),hP(hL,hK)),bX.append(hO(hK,eo.rotate(hJ,hL)),hP(eo.rotate(hJ,hL),hK)));};eo.unbind_open_reactions=function(hI,hJ){var hK;function hL(hR,hS){var hT;hT=ei.migrate_left(hR,hS);return hT==null?null:{$:1,$0:[hT.$0[0],hT.$0[1]]};}function hM(hR,hS){var hT;hT=ei.migrate_left(ei.mirror(hR),ei.mirror(hS));return hT==null?null:{$:1,$0:[ei.mirror(hT.$0[0]),ei.mirror(hT.$0[1])]};}function hN(hR,hS){var hT,hU;hT=ei.unbind_open_gg_lcon(hR,hS);return hT==null?hK?(hU=hL(hR,hS),hU==null?null:ei.unbind_open_gg_lcon(hU.$0[0],hU.$0[1])):null:{$:1,$0:hT.$0};}function hO(hR,hS){var hT,hU;hT=ei.unbind_open_gg_ucon(hR,hS);return hT==null?hK?(hU=hM(hR,hS),hU==null?null:ei.unbind_open_gg_ucon(hU.$0[0],hU.$0[1])):null:{$:1,$0:hT.$0};}function hP(hR){var hS,hT,hU,hV,hW;switch(hR.$==1?hR.$0.$==1?hR.$0.$1.$==1?(hS=[hR.$0.$0,hR.$1,hR.$0.$1.$0,hR.$0.$1.$1],3):hR.$1.$==1?hR.$1.$0.$==1?hR.$1.$0.$1.$==0?(hS=[hR.$0.$0,hR.$1.$1,hR.$1.$0.$0],1):(hS=[hR.$0.$0,hR.$1.$1,hR.$1.$0.$0,hR.$1.$0.$1],2):4:(hS=hR.$0.$0,0):4:4){case 0:hT=ei.unbind_open_down(hS);return hT!=null&&hT.$==1?bX.ofArray([[hJ,hT.$0[1],bY.Empty,bX.ofArray([hT.$0[0]])]]):bY.Empty;case 1:hU=hO(hS[0],hS[2]);return hU!=null&&hU.$==1?bX.ofArray([[hJ,hU.$0[1],bX.ofArray([new bY({$:1,$0:bX.ofArray([hU.$0[0]]),$1:hS[1]})]),bY.Empty]]):bY.Empty;case 2:hV=hO(hS[0],hS[2]);return hV!=null&&hV.$==1?bX.ofArray([[hJ,hV.$0[1],bX.ofArray([new bY({$:1,$0:new bY({$:1,$0:hV.$0[0],$1:hS[3]}),$1:hS[1]})]),bY.Empty]]):bY.Empty;case 3:hW=hN(hS[0],hS[2]);return hW!=null&&hW.$==1?bX.ofArray([[hJ,hW.$0[1],bX.ofArray([new bY({$:1,$0:new bY({$:1,$0:hW.$0[0],$1:hS[3]}),$1:hS[1]})]),bY.Empty]]):bY.Empty;case 4:return bY.Empty;}}function hQ(hR,hS,hT,hU){return[hR,hS,bX.map(function(hV){return eo.rotate(hI,hV);},hT),bX.map(em.rotate,hU)];}hK=bR.getRules(hI)!="Detailed";return bX.append(hP(hJ),bX.map(function(hR){return hQ(hR[0],hR[1],hR[2],hR[3]);},hP(eo.rotate(hI,hJ))));};eo.unsticking_reactions=function(hI,hJ,hK){function hL(hM,hN,hO,hP,hQ){var hR,hS,hU,hV,hW,hX,hY;function hT(hZ,h0,h1,h2,h3){var h4,h5,h6;h4=ei.unstick(hI,h1);return h4==null?bY.Empty:(h5=eo.ejected(hZ,h0,h4.$0[0],h2,h3),(h6=eo.ejected(hZ,h0,h4.$0[1],h2,h3),bX.ofArray([[hK,h4.$0[2],bX.append(h5[0],h6[0]),bX.append(h5[1],h6[1])]])));}while(true){if(hP.$==1){hU=hP.$1;hV=hP.$0;hW=hT(hO,hN,hV,hU,hQ);if(hW.$==0){if(bR.getRules(hJ)=="Detailed"){hN=bX.append(hN,bX.ofArray([hV]));hP=hU;}else{hX=(hR=eo.migrate_left_all(new bY({$:1,$0:new bY({$:1,$0:hV,$1:hU}),$1:hQ})),hR.$==1&&(hR.$0.$==1&&(hS=[hR.$0.$0,hR.$0.$1,hR.$1],true))?[hS[0],hS[1],hS[2]]:be.FailWith("Gate.displacement_reactions: migrate_left_all should return a non-empty list with a non-empty head"));hY=hT(hO,hN,hX[0],hX[1],hX[2]);if(hY.$==0){hN=bX.append(hN,bX.ofArray([hV]));hP=hU;}else{hM=bX.append(hM,hY);hN=bX.append(hN,bX.ofArray([hV]));hP=hU;}}}else{hM=bX.append(hM,hW);hN=bX.append(hN,bX.ofArray([hV]));hP=hU;}}else return hM;}}return dZ.collect_contextual(function(hM,hN,hO){var hP,hQ;return(((hP=bY.Empty,(hQ=bY.Empty,hB.Curried(hL,3,[hP,hQ])))(hM))(hN))(hO);},hK);};eo.join=function(hI,hJ,hK){return hJ?bX.append(hI,hK):dZ.glue(hI,hK);};eo.append_strand_to_gate=function(hI,hJ){return dZ.map_last(function(hK){return eo.append_strand_to_segments(hK,hJ);},hI);};eo.cons_strand_to_gate=function(hI,hJ){return dZ.map_first(function(hK){return eo.cons_strand_to_segments(hI,hK);},hJ);};eo.ejected=function(hI,hJ,hK,hL,hM){var hN,hO,hP;hN=hK.$==1?[hJ.$==0?bY.Empty:bX.append(hI,bX.ofArray([hJ])),hL.$==0?bY.Empty:new bY({$:1,$0:hL,$1:hM})]:[hJ.$==0?hI:bY.Empty,hL.$==0?hM:bY.Empty];hO=hN[0];hP=hN[1];return hO.$==0?hP.$==0?[bY.Empty,bX.ofArray([hK])]:[bX.ofArray([eo.cons_strand_to_gate(hK,hP)]),bY.Empty]:hP.$==0?[bX.ofArray([eo.append_strand_to_gate(hO,hK)]),bY.Empty]:[bX.ofArray([eo.join(hO,em.is_upper(hK),eo.cons_strand_to_gate(hK,hP))]),bY.Empty];};eo.unnormalise_pair=function(hI,hJ){var hK;switch(hI.$==1?hI.$0[4].$==0?hJ.$==1?hJ.$0[4].$==1?(hK=[hI.$0[3],hJ.$0[3],hJ.$0[0],hJ.$0[1],hI.$0[0],hI.$0[1],hI.$0[2],hJ.$0[2]],3):4:(hK=[hI.$0[3],hJ.$0[0],hJ.$0[1],hI.$0[0],hJ.$0[4],hI.$0[1],hJ.$0[3],hI.$0[2],hJ.$0[2]],2):4:hJ.$==1?hJ.$0[4].$==1?(hK=[hJ.$0[3],hI.$0[0],hJ.$0[0],hI.$0[1],hJ.$0[1],hI.$0[4],hI.$0[3],hI.$0[2],hJ.$0[2]],1):4:(hK=[hI.$0[0],hJ.$0[0],hI.$0[1],hJ.$0[1],hI.$0[4],hJ.$0[4],hI.$0[3],hJ.$0[3],hI.$0[2],hJ.$0[2]],0)){case 0:return[new ej({$:0,$0:[hK[0],hK[2],hK[8],hK[6],bY.Empty]}),new ej({$:0,$0:[bX.append(hK[4],hK[1]),hK[3],hK[9],hK[7],hK[5]]})];case 1:return[new ej({$:0,$0:[hK[1],hK[3],hK[7],hK[6],bY.Empty]}),new ej({$:1,$0:[bX.append(hK[5],hK[2]),hK[4],hK[8],hK[0],fi.Right]})];case 2:return[new ej({$:1,$0:[bY.Empty,hK[5],hK[7],hK[0],fi.Left]}),new ej({$:0,$0:[bX.append(hK[3],hK[1]),hK[2],hK[8],hK[6],hK[4]]})];case 3:return[new ej({$:1,$0:[bY.Empty,hK[5],hK[6],hK[0],fi.Left]}),new ej({$:1,$0:[bX.append(hK[4],hK[2]),hK[3],hK[7],hK[1],fi.Right]})];case 4:return be.FailWith("Illegally constructed pair of segments");}};eo.unnormalise=function(hI){return eo.mirror(bX.map(function(hJ){return dZ.map_pairs(function(hK){return eo.unnormalise_pair(hK[0],hK[1]);},hJ);},eo.mirror(bX.map(function(hJ){return dZ.map_pairs(function(hK){return eo.unnormalise_pair(hK[0],hK[1]);},hJ);},hI))));};eo.migrate_left_all=function(hI){return eo.reverse(eo.migrate_right_all(eo.reverse(hI)));};eo.append_strand_to_segments=function(hI,hJ){return dZ.map_last(function(hK){var hL,hM,hN,hO,hP,hQ,hR;return hK.$==1?hK.$0[4].$==0?(hL=hK.$0[3],(hM=hK.$0[0],(hN=hK.$0[1],(hO=hK.$0[2],hJ.$==0?new ej({$:1,$0:[hM,bX.append(hN,hJ.$0),hO,hL,fi.Left]}):new ej({$:1,$0:[bX.append(hM,hJ.$0),hN,hO,hL,fi.Left]}))))):be.FailWith("A right hairpin must be the last element in a gate"):(hP=hK.$0[0],(hQ=hK.$0[1],(hR=hK.$0[4],hJ.$==0?new ej({$:0,$0:[hP,hQ,hK.$0[2],bX.append(hK.$0[3],hJ.$0),hR]}):new ej({$:0,$0:[hP,hQ,hK.$0[2],hK.$0[3],bX.append(hR,hJ.$0)]}))));},hI);};eo.cons_strand_to_segments=function(hI,hJ){return dZ.map_first(function(hK){var hL,hM,hN,hO,hP,hQ,hR,hS,hT;return hK.$==1?hK.$0[4].$==1?(hL=hK.$0[3],(hM=hK.$0[0],(hN=hK.$0[1],(hO=hK.$0[2],hI.$==0?new ej({$:1,$0:[hM,bX.append(hI.$0,hN),hO,hL,fi.Right]}):new ej({$:1,$0:[bX.append(hI.$0,hM),hN,hO,hL,fi.Right]}))))):be.FailWith("A left hairpin must be the first element in a gate"):(hP=hK.$0[0],(hQ=hK.$0[1],(hR=hK.$0[4],(hS=hK.$0[3],(hT=hK.$0[2],hI.$==0?new ej({$:0,$0:[hP,bX.append(hI.$0,hQ),hT,hS,hR]}):new ej({$:0,$0:[bX.append(hI.$0,hP),hQ,hT,hS,hR]}))))));},hJ);};eo.unannotate_tag_sets=function(hI){return eo.map(function(hJ){return ei.set_tags(hJ,null);},hI);};eo.annotate_tag_sets=function(hI){return(eo.rev_fold(function(hJ,hK){var hL,hM,hN,hO;hL=ei.tethered_tag_sets(hK);hM=hL[1];hN=hL[0];hO=hM==null?hJ:hM;return[hN==null?hO:hN,ei.add_tags(hK,hO)];},null,(eo.rev_fold(function(hJ,hK){var hL,hM,hN,hO;hL=ei.tag_sets(hK);hM=hL[1];hN=hL[0];hO=hN==null?hJ:hN;return[hM==null?hO:hM,ei.set_tags(hK,hO)];},null,hI))[1]))[1];};eo.map=function(hI,hJ){return(eo.rev_fold(function(hK,hL){return[null,hL];},null,(eo.rev_fold(function(hK,hL){return[null,hI(hL)];},null,hJ))[1]))[1];};eo.rev_fold=function(hI,hJ,hK){function hL(hM,hN){return function(hO){var hP;function hQ(hR,hS){return function(hT){var hU;return hT.$==1?(hU=hI(hR,hT.$0),(function(hV){return hQ(hV[0],hV[1]);}([hU[0],new bY({$:1,$0:hU[1],$1:hS})]))(hT.$1)):[hR,hS];};}return hO.$==1?(hP=(function(hR){return hQ(hR[0],hR[1]);}([hM,bY.Empty]))(hO.$0),(function(hR){return hL(hR[0],hR[1]);}([hP[0],new bY({$:1,$0:hP[1],$1:hN})]))(hO.$1)):[hM,hN];};}return(function(hM){return hL(hM[0],hM[1]);}([hJ,bY.Empty]))(hK);};eo.tethered_domains=function(hI){return dZ.collect(function(hJ){return dZ.collect(ei.tethered_domains,hJ);},hI);};ep.species_to_svg_mode=function(hI,hJ,hK){return ep.melt(hI,hJ,hK);};ep.species_style=function(hI,hJ){return ep.style(dD.to_list(ep.dom_map(hI,hJ)));};ep.melt=function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ,hR,hS,hW;function hT(hX){return cB.emerge_groups(bX.ofArray([ep.halfseg_to_svg(ep.melt_strand(hI,hJ,true,hX))]));}function hU(hX){return ep.melt_gate(hI,hJ,hX);}function hV(hX){return bX.map(ep.halfseg_to_svg,hX);}hW=(hL=function(hX){return hV(hU(hX));},function(hX){return cB.emerge_groups(hL(hX));});if(hK.$==0)return hT(hK.$0);else if(hK.$==1)return hW(hK.$0);else if(hK.$==2){hM=en.origami_species(hK.$0);hN=(hO=bX.append(bX.map(hT,hM[1]),bX.map(hW,hM[0])),cB.stackv(ep.origami_sep(),ep.species_skip(),hO));hP="";hQ=cS.length(hP)*ep.letterwidth()/2;hR=dW.New(2,2);return dX.New((hS=hN.box_group,dY.New(hS.name,{$:0,$0:bX.ofArray([fZ.New({$:1,$0:ep.baseClass()+" origami-border"},cB.rounded_box(hR,cB.translate_point_by(cB.scale_by(-1,hR),hN.box_dim),ep.origami_round()),{$:1,$0:f0.New(hP,cB.translate_point_by(dW.New(-hQ,0),cB.sub(hN.box_dim,ep.origami_sep())),{$:1,$0:ep.baseClass()},cB.default_letter_width(),cB.translate_point_by(dW.New(0-hQ,0),cB.sub(hN.box_dim,ep.origami_sep())))})])},hS.anchors,hS.debug_anchors,hS.sub_groups,hS.offset)),hN.box_dim);}else throw new db("The visualisation of complex and unknown species is not yet implemented");};ep.style=function(hI){var hJ;function hK(hL,hM){return"path."+ep.baseClass()+"."+hL+" { stroke: "+hM+" } text."+ep.baseClass()+"."+hL+" { fill: "+hM+" }";}hJ=dZ.string_of_list(function(hL){return hK(hL[0],hL[1]);}," ",hI);return"g { fill: none; } path."+ep.baseClass()+" { stroke: silver; stroke-width: "+cB.display_float(ep.linewidth())+"; stroke-linejoin: round; } text."+ep.baseClass()+" { fill: black; stroke-width: 0; font-family: Verdana,Arial,sans-serif; font-size: "+a.String(be.toInt(ep.fontsize()))+"px; text-anchor: middle; } text.fixedwidth { font-family:Lucida Console,monospace }"+" "+hJ+" "+("path."+ep.baseClass()+".tether-pin { stroke : black }");};ep.dom_map=function(hI,hJ){var hK,hL,hM,hN;function hO(hP){return eg.to_string(eg.unstar(hP));}hK=(bX.unzip(dD.to_list(hI)))[1];hL=bX.filter(function(hP){return!bX.exists(function(hQ){return hP===hQ;},hK);},ep.palette());hM=[0];hN=dD.empty();bX.iter(function(hP){var hQ,hR,hS,hT;hQ=ep.dom_id(hP);(hR=dD.tryFind(hN,hQ),hR!=null&&hR.$==1)?void 0:dD.add(hN,hQ,(hS=dD.tryFind(hI,hO(hP)),hS!=null&&hS.$==1?hS.$0:(hT=hL.get_Item(hM[0]),(hM[0]=(hM[0]+1)%hL.get_Length(),hT))));},dZ.remove_duplicates(cw.Equals,bX.filter(eg.is_toehold,bX.collect(cN.domains,hJ))));return hN;};ep.melt_strand=function(hI,hJ,hK,hL){var hM;return g2.New(null,ep.add_arrow(em.is_upper(hL),(hM=em.domains(hL),ep.melt_dom_list(hI,hJ,hK,em.is_upper(hL),true,cB.origo(),hM))),null);};ep.halfseg_to_svg=function(hI){var hJ,hK;return dY.New("",{$:0,$0:bX.append((hJ=hI.left_overhang,hJ!=null&&hJ.$==1?hJ.$0.strand:bY.Empty),bX.append(hI.middle.strand,(hK=hI.right_overhang,hK!=null&&hK.$==1?hK.$0.strand:bY.Empty)))},bY.Empty,false,bY.Empty,null);};ep.melt_gate=function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX;function hY(h0,h1){function h2(h3,h4){return function(h5){var h6;h6=ep.connect_lower(hI,h3,h5);return[h6[0],bX.append(h6[1],h4)];};}return dZ.fold_left(function(h3,h4){return(function(h5){return h2(h5[0],h5[1]);}(h3))(h4);},h0,bX.map(function(h3){return ep.melt_segment(hI,hJ,h3);},h1));}function hZ(h0,h1){return function(h2){var h3;return h2.$==1?(h3=ep.connect_upper(hI,h0,ep.melt_segment(hI,hJ,h2.$0)),hY([h3[0],bX.append(h3[1],h1)],h2.$1)):[h0,h1];};}hL=(hM=eo.first_segment(hK),(hM.$==1?hM.$0[4].$==1&&(hN=[hM.$0[0],hM.$0[1]],true):(hN=[hM.$0[0],hM.$0[1]],true))&&(hN[0].$!==0&&hN[1].$!==0));hO=(hP=eo.last_segment(hK),(hP.$==1?hP.$0[4].$==0&&(hQ=[hP.$0[0],hP.$0[1]],true):(hQ=[hP.$0[4],hP.$0[3]],true))&&(hQ[0].$!==0&&hQ[1].$!==0));return hK.$==1?hK.$0.$==1?(hR=dZ.fold_left(function(h0,h1){return(function(h2){return hZ(h2[0],h2[1]);}(h0))(h1);},hY([(hS=(hT=ep.melt_segment(hI,hJ,hK.$0.$0),hT.$==2?{$:2,$0:ep.add_seg_arrow(false,hT.$0)}:hT.$==0?{$:0,$0:hT.$0,$1:ep.add_seg_arrow(false,hT.$1)}:hT),hL?hS.$==2?{$:2,$0:ep.bend_upper_right_hp(ep.bend_lower_left(hS.$0))}:hS.$==0?{$:0,$0:ep.bend_upper_left(hS.$0),$1:ep.bend_lower_left(hS.$1)}:hS:hS),bY.Empty],hK.$0.$1),hK.$1),(hU=hR[1],(hV=(hW=(hX=hR[0],hX.$==2?hX:hX.$==0?{$:0,$0:ep.add_seg_arrow(true,hX.$0),$1:hX.$1}:{$:1,$0:ep.add_seg_arrow_hp(hX.$0)}),hO?hW.$==2?hW:hW.$==0?{$:0,$0:ep.bend_upper_right(hW.$0),$1:ep.bend_lower_right(hW.$1)}:{$:1,$0:ep.bend_upper_left_hp(ep.bend_lower_right(hW.$0))}:hW),hV.$==2?new bY({$:1,$0:hV.$0,$1:hU}):hV.$==0?new bY({$:1,$0:hV.$0,$1:new bY({$:1,$0:hV.$1,$1:hU})}):new bY({$:1,$0:hV.$0,$1:hU})))):ep.melt_gate(hI,hJ,hK.$1):bY.Empty;};ep.origami_sep=function(){g4.$cctor();return g4.origami_sep;};ep.species_skip=function(){g4.$cctor();return g4.species_skip;};ep.letterwidth=function(){g4.$cctor();return g4.letterwidth;};ep.baseClass=function(){g4.$cctor();return g4.baseClass;};ep.origami_round=function(){g4.$cctor();return g4.origami_round;};ep.linewidth=function(){g4.$cctor();return g4.linewidth;};ep.fontsize=function(){g4.$cctor();return g4.fontsize;};ep.palette=function(){g4.$cctor();return g4.palette;};ep.dom_id=function(hI){return"dom_"+ep.dom_name(hI);};ep.melt_dom_list=function(hI,hJ,hK,hL,hM,hN,hO){var hP,hQ;hP=ep.spin(hI,hL,hM,hN,ep.dom_list_to_svg(hI,hJ,hI=="Condensed"?hL?{$:1,$0:hi.UpperInner}:hK?{$:1,$0:hi.LowerInner}:null:hI=="Nucleotides"?hL?{$:1,$0:hi.UpperInner}:{$:1,$0:hi.LowerInner}:hL?{$:1,$0:hi.UpperOuter}:{$:1,$0:hi.LowerOuter},(hL?dZ.id:bX.rev)(hO)));return g3.New((hQ=hP.content,hQ.$==1?bY.Empty:hQ.$0),cB.get_anchor_point("start",hP),cB.get_anchor_point("end",hP),cB.origo());};ep.add_arrow=function(hI,hJ){var hK,hL,hM,hN;hK=hI?ep.arrow_vector():cB.rotate_point_around(cB.origo(),180,ep.arrow_vector());hL=bX.rev(hJ.strand);return hL.$==1?(hM=hL.$0,(hN=bX.rev(hM.commands),hN.$==1?hN.$0.$==1?g3.New(bX.rev(new bY({$:1,$0:fZ.New(hM.path_class,bX.append(hM.commands,bX.ofArray([{$:1,$0:cB.translate_point_by(hK,hN.$0.$0)}])),hM.path_label),$1:hL.$1})),hJ.start_anchor,hJ.end_anchor,hJ.east_anchor):hJ:hJ)):hJ;};ep.connect_lower=function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0,h1,h2,h3,h4,h5,h6,h7,h8,h9,h_,h$,ia,ib,ic,id,ie,_if,ig,ih,ii,ij,ik,il,im,_in,io;switch(hJ.$==1?hK.$==2?0:hK.$==0?(hL=[hJ.$0,hK.$1,hK.$0],1):4:hJ.$==0?hK.$==2?(hL=[hJ.$1,hK.$0,hJ.$0],2):hK.$==0?(hL=[hJ.$1,hK.$1,hJ.$0,hK.$0],3):4:4){case 0:return be.FailWith("circular DNA");case 1:hM=hL[0];hN=hL[1];hO=hL[2];hP=(hQ=hM.left_overhang,hR=hO.left_overhang,hQ!=null&&hQ.$==1&&(hR!=null&&hR.$==1&&(hM.right_overhang==null&&(hN.left_overhang==null&&(hS=[hQ.$0,hR.$0],true))))?[g2.New({$:1,$0:ep.strut_start(ep.cross_gap(),false,hS[0])},hM.middle,hM.right_overhang),g2.New({$:1,$0:ep.strut_end(ep.cross_gap(),true,hS[1])},hO.middle,hO.right_overhang)]:[hM,hO]);hT=hP[1];hU=hP[0];hV=cw.Equals(hI,"Complement")?hU:(hW=hU.left_overhang,hW!=null&&hW.$==1?g2.New({$:1,$0:ep.strut_start(ep.inlabel_gap(),false,hW.$0)},hU.middle,hU.right_overhang):hU);hX=cw.Equals(hI,"Complement")?hT:(hY=hT.left_overhang,hY!=null&&hY.$==1?g2.New({$:1,$0:ep.strut_end(ep.inlabel_gap(),true,hY.$0)},hT.middle,hT.right_overhang):hT);hZ=ep.op_AmpMinusMinus(hN,ep.bend_upper_left_hp(ep.add_seg_arrow_hp(hV)));return[{$:0,$0:ep.op_GreaterMinusMinus(ep.bend_upper_left(hX),hZ),$1:hZ},bY.Empty];case 2:h0=hL[0];h1=hL[1];h2=hL[2];h3=(h4=h2.right_overhang,h5=h1.right_overhang,h4!=null&&h4.$==1&&(h5!=null&&h5.$==1&&(h0.right_overhang==null&&(h1.left_overhang==null&&(h6=[h5.$0,h4.$0],true))))?[g2.New(h2.left_overhang,h2.middle,{$:1,$0:ep.strut_start(ep.cross_gap(),false,h6[1])}),g2.New(h1.left_overhang,h1.middle,{$:1,$0:ep.strut_end(ep.cross_gap(),true,h6[0])})]:[h2,h1]);h7=h3[0];h8=h3[1];h9=cw.Equals(hI,"Complement")?h7:(h_=h7.right_overhang,h_!=null&&h_.$==1?g2.New(h7.left_overhang,h7.middle,{$:1,$0:ep.strut_start(ep.inlabel_gap(),false,h_.$0)}):h7);return[{$:2,$0:ep.op_AmpMinusMinus(ep.bend_upper_right_hp(cw.Equals(hI,"Complement")?h8:(h$=h8.right_overhang,h$!=null&&h$.$==1?g2.New(h8.left_overhang,h8.middle,{$:1,$0:ep.strut_end(ep.inlabel_gap(),true,h$.$0)}):h8)),h0)},bX.ofArray([ep.bend_upper_right(ep.add_seg_arrow(true,h9))])];case 3:ia=hL[0];ib=hL[1];ic=hL[2];id=hL[3];ie=(_if=ic.right_overhang,ig=id.left_overhang,_if!=null&&_if.$==1&&(ig!=null&&ig.$==1&&(ia.right_overhang==null&&(ib.left_overhang==null&&(ih=[_if.$0,ig.$0],true))))?[g2.New(ic.left_overhang,ic.middle,{$:1,$0:ep.strut_start(ep.cross_gap(),false,ih[0])}),g2.New({$:1,$0:ep.strut_end(ep.cross_gap(),true,ih[1])},id.middle,id.right_overhang)]:[ic,id]);ii=ie[1];ij=ie[0];ik=cw.Equals(hI,"Complement")?ij:(il=ij.right_overhang,il!=null&&il.$==1?g2.New(ij.left_overhang,ij.middle,{$:1,$0:ep.strut_start(ep.inlabel_gap(),false,il.$0)}):ij);im=cw.Equals(hI,"Complement")?ii:(_in=ii.left_overhang,_in!=null&&_in.$==1?g2.New({$:1,$0:ep.strut_end(ep.inlabel_gap(),true,_in.$0)},ii.middle,ii.right_overhang):ii);io=ep.op_AmpMinusMinus(ib,ia);return[{$:0,$0:ep.op_GreaterMinusMinus(ep.bend_upper_left(im),io),$1:io},bX.ofArray([ep.bend_upper_right(ep.add_seg_arrow(true,ik))])];case 4:return be.FailWith("malformed species");}};ep.melt_segment=function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX;return hK.$==1?hK.$0[4].$==1?(hL=ep.melt_shared(hI,hJ,hK.$0[2]),(hM=hL[0],(hN=ep.melt_dom_list_o(hI,hJ,true,false,false,cB.origo(),hK.$0[0]),(hO=ep.melt_dom_list_o(hI,hJ,true,true,true,cB.origo(),hK.$0[1]),{$:2,$0:g2.New(hN,ep.op_MinusAt(ep.op_MinusAt(hM,ep.melt_dom_list_hp(hI,hJ,true,hM.end_anchor,hK.$0[3])),hL[1]),hO)})))):(hP=ep.melt_shared(hI,hJ,hK.$0[2]),(hQ=hP[0],(hR=ep.melt_dom_list_hp(hI,hJ,false,cB.origo(),hK.$0[3]),(hS=ep.melt_dom_list_o(hI,hJ,true,false,true,hQ.end_anchor,hK.$0[0]),{$:1,$0:g2.New(ep.melt_dom_list_o(hI,hJ,true,true,false,hQ.end_anchor,hK.$0[1]),ep.op_MinusAt(ep.op_MinusAt(hP[1],hR),hQ),hS)})))):(hT=ep.melt_shared(hI,hJ,hK.$0[2]),(hU=hT[0],(hV=ep.melt_dom_list_o(hI,hJ,true,false,false,cB.origo(),hK.$0[0]),(hW=ep.melt_dom_list_o(hI,hJ,true,true,true,cB.origo(),hK.$0[1]),(hX=ep.melt_dom_list_o(hI,hJ,true,false,true,hU.end_anchor,hK.$0[4]),{$:0,$0:g2.New(hW,hU,ep.melt_dom_list_o(hI,hJ,true,true,false,hU.end_anchor,hK.$0[3])),$1:g2.New(hV,hT[1],hX)})))));};ep.bend_upper_right=function(hI){var hJ;return g2.New(hI.left_overhang,hI.middle,dZ.option_map2((hJ=-ep.bend_angle(),function(hK){return ep.bend_start(true,hJ,hK);}),hI.right_overhang));};ep.bend_lower_right=function(hI){return g2.New(hI.left_overhang,hI.middle,dZ.option_map2(function(hJ){return ep.bend_end(false,ep.bend_angle(),hJ);},hI.right_overhang));};ep.bend_upper_left_hp=function(hI){var hJ;return g2.New(dZ.option_map2((hJ=-ep.bend_angle(),function(hK){return ep.bend_start(true,hJ,hK);}),hI.left_overhang),hI.middle,hI.right_overhang);};ep.bend_lower_left=function(hI){var hJ;return g2.New(dZ.option_map2((hJ=-ep.bend_angle(),function(hK){return ep.bend_start(false,hJ,hK);}),hI.left_overhang),hI.middle,hI.right_overhang);};ep.bend_upper_right_hp=function(hI){return g2.New(hI.left_overhang,hI.middle,dZ.option_map2(function(hJ){return ep.bend_end(true,ep.bend_angle(),hJ);},hI.right_overhang));};ep.bend_upper_left=function(hI){return g2.New(dZ.option_map2(function(hJ){return ep.bend_end(true,ep.bend_angle(),hJ);},hI.left_overhang),hI.middle,hI.right_overhang);};ep.add_seg_arrow=function(hI,hJ){var hK,hL;function hM(hN){return ep.add_arrow(hI,hN);}return hI?(hK=hJ.right_overhang,hK!=null&&hK.$==1?g2.New(hJ.left_overhang,hJ.middle,{$:1,$0:hM(hK.$0)}):g2.New(hJ.left_overhang,hM(hJ.middle),hJ.right_overhang)):(hL=hJ.left_overhang,hL!=null&&hL.$==1?g2.New({$:1,$0:hM(hL.$0)},hJ.middle,hJ.right_overhang):g2.New(hJ.left_overhang,hM(hJ.middle),hJ.right_overhang));};ep.add_seg_arrow_hp=function(hI){var hJ;function hK(hL){return ep.add_arrow(true,hL);}hJ=hI.left_overhang;return hJ!=null&&hJ.$==1?g2.New({$:1,$0:hK(hJ.$0)},hI.middle,hI.right_overhang):g2.New(hI.left_overhang,hK(hI.middle),hI.right_overhang);};ep.connect_upper=function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0,h1,h2,h3,h4,h5,h6,h7,h8,h9,h_,h$,ia,ib,ic,id,ie,_if,ig,ih,ii,ij,ik,il,im,_in,io;switch(hJ.$==1?hK.$==2?0:hK.$==0?(hL=[hJ.$0,hK.$1,hK.$0],1):4:hJ.$==0?hK.$==2?(hL=[hJ.$1,hK.$0,hJ.$0],2):hK.$==0?(hL=[hJ.$1,hK.$1,hJ.$0,hK.$0],3):4:4){case 0:return be.FailWith("circular DNA");case 1:hM=hL[0];hN=hL[1];hO=hL[2];hP=(hQ=hM.right_overhang,hR=hN.left_overhang,hQ!=null&&hQ.$==1&&(hR!=null&&hR.$==1&&(hM.left_overhang==null&&(hO.left_overhang==null&&(hS=[hQ.$0,hR.$0],true))))?[g2.New(hM.left_overhang,hM.middle,{$:1,$0:ep.strut_end(ep.cross_gap(),false,hS[0])}),g2.New({$:1,$0:ep.strut_start(ep.cross_gap(),true,hS[1])},hN.middle,hN.right_overhang)]:[hM,hN]);hT=hP[1];hU=hP[0];hV=cw.Equals(hI,"Complement")?hU:(hW=hU.right_overhang,hW!=null&&hW.$==1?g2.New(hU.left_overhang,hU.middle,{$:1,$0:ep.strut_end(ep.inlabel_gap(),false,hW.$0)}):hU);hX=cw.Equals(hI,"Complement")?hT:(hY=hT.left_overhang,hY!=null&&hY.$==1?g2.New({$:1,$0:ep.strut_start(ep.inlabel_gap(),true,hY.$0)},hT.middle,hT.right_overhang):hT);hZ=ep.op_MinusMinusAmp(ep.bend_lower_right(hV),hO);return[{$:0,$0:hZ,$1:ep.op_GreaterMinusMinus(ep.bend_lower_left(ep.add_seg_arrow(false,hX)),hZ)},bY.Empty];case 2:h0=hL[0];h1=hL[1];h2=hL[2];h3=(h4=h0.right_overhang,h5=h1.left_overhang,h4!=null&&h4.$==1&&(h5!=null&&h5.$==1&&(h2.right_overhang==null&&(h1.right_overhang==null&&(h6=[h4.$0,h5.$0],true))))?[g2.New(h0.left_overhang,h0.middle,{$:1,$0:ep.strut_end(ep.cross_gap(),false,h6[0])}),g2.New({$:1,$0:ep.strut_start(ep.cross_gap(),true,h6[1])},h1.middle,h1.right_overhang)]:[h0,h1]);h7=h3[1];h8=h3[0];h9=cw.Equals(hI,"Complement")?h8:(h_=h8.right_overhang,h_!=null&&h_.$==1?g2.New(h8.left_overhang,h8.middle,{$:1,$0:ep.strut_end(ep.inlabel_gap(),false,h_.$0)}):h8);return[{$:2,$0:ep.op_AtMinusMinus(h2,ep.bend_lower_left(ep.add_seg_arrow(false,cw.Equals(hI,"Complement")?h7:(h$=h7.left_overhang,h$!=null&&h$.$==1?g2.New({$:1,$0:ep.strut_start(ep.inlabel_gap(),true,h$.$0)},h7.middle,h7.right_overhang):h7))))},bX.ofArray([ep.bend_lower_right(h9)])];case 3:ia=hL[0];ib=hL[1];ic=hL[2];id=hL[3];ie=(_if=ia.right_overhang,ig=ib.left_overhang,_if!=null&&_if.$==1&&(ig!=null&&ig.$==1&&(ic.right_overhang==null&&(id.left_overhang==null&&(ih=[_if.$0,ig.$0],true))))?[g2.New(ia.left_overhang,ia.middle,{$:1,$0:ep.strut_end(ep.cross_gap(),false,ih[0])}),g2.New({$:1,$0:ep.strut_start(ep.cross_gap(),true,ih[1])},ib.middle,ib.right_overhang)]:[ia,ib]);ii=ie[1];ij=ie[0];ik=cw.Equals(hI,"Complement")?ij:(il=ij.right_overhang,il!=null&&il.$==1?g2.New(ij.left_overhang,ij.middle,{$:1,$0:ep.strut_end(ep.inlabel_gap(),false,il.$0)}):ij);im=cw.Equals(hI,"Complement")?ii:(_in=ii.left_overhang,_in!=null&&_in.$==1?g2.New({$:1,$0:ep.strut_start(ep.inlabel_gap(),true,_in.$0)},ii.middle,ii.right_overhang):ii);io=ep.op_MinusMinusAt(ic,id);return[{$:0,$0:io,$1:ep.op_GreaterMinusMinus(ep.bend_lower_left(ep.add_seg_arrow(false,im)),io)},bX.ofArray([ep.bend_lower_right(ik)])];case 4:return be.FailWith("malformed species");}};ep.dom_name=function(hI){return eg.to_string(eg.unstar(hI));};ep.dom_list_to_svg=function(hI,hJ,hK,hL){var hM;function hN(hO,hP){var hQ,hR,hS,hT,hU,hV,hW,hX;return hK==null?null:(hQ=hK.$0,(hR={$:1,$0:ep.baseClass()+" "+ep.dom_id(hP)+(cw.Equals(hI,"Nucleotides")?" fixedwidth":"")},(hS=dW.New(hO,hI=="Condensed"?hQ.$==1||(hQ.$==2?false:hQ.$!=3)?ep.label_sep_condensed_upper():ep.label_sep_condensed_lower():hI=="Nucleotides"?hQ.$==1||(hQ.$==2?false:hQ.$!=3)?ep.label_sep_nucleotides_upper():ep.label_sep_nucleotides_lower():-ep.label_sep_complement()),{$:1,$0:f0.New(hI=="Nucleotides"?ef.string_of_sequence((hV=ef.get_domain(hJ,hP),hV!=null&&hV.$==1&&((hX=hV.$0,hX!=null&&hX.$==1)&&(hW=hV.$0.$0,true))?hW:bY.Empty)):ep.dom_string(hP),hS,hR,cB.default_letter_width(),cB.translate_point_by(dW.New(10,0),hS))})));}hM=dZ.fold_left(function(hO,hP){return(function(hQ){var hR,hS;hR=hQ[0];hS=hQ[1];return function(hT){var hU,hV,hW,hX,hY;hU={$:1,$0:ep.baseClass()+" "+ep.dom_id(hT)};return eg.is_tethered(hT)?(hV=cB.translate_point_by(dW.New(ep.len_dom(hI,hJ,hT),0),hS),(hW=dW.New((hV.x+hS.x)/2,0),(hX=fZ.New(hU,bX.ofArray([{$:0,$0:hS},{$:1,$0:hW}]),hN((hV.x+hS.x)/2,hT)),[new bY({$:1,$0:fZ.New(hU,bX.ofArray([{$:0,$0:hW},{$:1,$0:hV}]),null),$1:new bY({$:1,$0:fZ.New({$:1,$0:ep.baseClass()+" tether-pin"},bX.ofArray([{$:0,$0:cB.translate_point_by(dW.New(0,3),hW)},{$:2,$0:cB.translate_point_by(dW.New(0,-3),hW),$1:go.New(3,3,true,false,0)},{$:2,$0:cB.translate_point_by(dW.New(0,3),hW),$1:go.New(3,3,true,false,0)}]),null),$1:new bY({$:1,$0:hX,$1:hR})})}),hV]))):(hY=cB.translate_point_by(dW.New(ep.len_dom(hI,hJ,hT),0),hS),[new bY({$:1,$0:fZ.New(hU,bX.ofArray([{$:0,$0:hS},{$:1,$0:hY}]),hN((hY.x+hS.x)/2,hT)),$1:hR}),hY]);};}(hO))(hP);},[bY.Empty,cB.origo()],hL);return dY.New("",{$:0,$0:bX.rev(hM[0])},bX.ofArray([e_.New("start",cB.origo()),e_.New("end",hM[1])]),false,bY.Empty,null);};ep.spin=function(hI,hJ,hK,hL,hM){var hN,hO,hP;hN=hI=="Condensed"?ep.segment_sep_condensed():hI=="Nucleotides"?ep.segment_sep_nucleotides():ep.segment_sep_complement();hO=(hP=hK?cB.attach_group_to(hM,"start",hJ?hM:cB.rotate_group_around_anchor("start",180,hM),"end"):hJ?hM:cB.rotate_group_around_anchor("start",180,hM),((cB.translate_group_by())(hL))(hP));return hJ?hO:((cB.translate_group_by())(hN))(hO);};ep.arrow_vector=function(){g4.$cctor();return g4.arrow_vector;};ep.strut_start=function(hI,hJ,hK){var hL,hM,hN,hO;hL=hJ?[dW.New(hI,0),dW.New(0-hI,0)]:[dW.New(0-hI,0),dW.New(hI,0)];hM=hL[0];hN=(hO=ep.extend_start(hM,hK),((ep.translate_strand_by())(hL[1]))(hO));return hJ?g3.New(hN.strand,hN.start_anchor,hN.end_anchor,cB.translate_point_by(hM,hN.east_anchor)):hN;};ep.cross_gap=function(){g4.$cctor();return g4.cross_gap;};ep.strut_end=function(hI,hJ,hK){var hL,hM,hN,hO;hL=hJ?[dW.New(hI,0),dW.New(0-hI,0)]:[dW.New(0-hI,0),dW.New(hI,0)];hM=hL[0];hN=(hO=ep.extend_end(hM,hK),((ep.translate_strand_by())(hL[1]))(hO));return hJ?g3.New(hN.strand,hN.start_anchor,hN.end_anchor,cB.translate_point_by(hM,hN.east_anchor)):hN;};ep.op_AmpMinusMinus=function(hI,hJ){var hK,hL,hM;hK=ep.extend_left_end(false,hI);hL=ep.extend_right_start(false,hJ);hM=ep.op_AmpMinus(hK.middle,ep.op_AmpDivide(hK.left_overhang,ep.op_AmpDivide(hL.right_overhang,hL.middle)));return g2.New(hL.left_overhang,hM,ep.op_GreaterDivide(hK.right_overhang,hM));};ep.op_GreaterMinusMinus=function(hI,hJ){function hK(hL){return ep.op_GreaterMinus(hL,hJ.middle);}return g2.New(dZ.option_map2(hK,hI.left_overhang),hK(hI.middle),dZ.option_map2(hK,hI.right_overhang));};ep.inlabel_gap=function(){g4.$cctor();return g4.inlabel_gap;};ep.melt_shared=function(hI,hJ,hK){var hL;hL=eg.unstick_keep_doc_list(hK);return[ep.melt_dom_list(hI,hJ,false,true,false,cB.origo(),hL[0]),ep.melt_dom_list(hI,hJ,false,false,true,cB.origo(),hL[1])];};ep.op_MinusAt=function(hI,hJ){var hK;hK=cB.sub(hI.end_anchor,hJ.start_anchor);return g3.New(bX.append(hI.strand,bX.map((cB.translate_path_by())(hK),hJ.strand)),hI.start_anchor,cB.translate_point_by(hK,hJ.end_anchor),cB.translate_point_by(hK,hJ.east_anchor));};ep.melt_dom_list_hp=function(hI,hJ,hK,hL,hM){var hN,hO;hN=ep.spin(hI,hK,hK,hL,ep.dom_list_to_hp_svg(hI,hJ,hM));return g3.New((hO=hN.content,hO.$==1?bY.Empty:hO.$0),cB.get_anchor_point("start",hN),cB.get_anchor_point("end",hN),cB.origo());};ep.melt_dom_list_o=function(hI,hJ,hK,hL,hM,hN,hO){return hO.$==0?null:{$:1,$0:ep.melt_dom_list(hI,hJ,hK,hL,hM,hN,hO)};};ep.bend_start=function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ,hR,hS,hT;hL=(hM=cB.rotate_path_command_around(hK.start_anchor,hJ),function(hU){return bX.map(hM,hU);});hN=(hO=cB.rotate_path_around(hK.start_anchor,hJ),function(hU){return bX.map(hO,hU);});return g3.New((hP=hK.strand,hP.$==1?(hQ=hP.$0,(hR=hQ.commands,hR.$==1&&(hR.$0.$==0&&(hS=[hR.$1,hR.$0,hR.$0.$0],true))?new bY({$:1,$0:fZ.New(hQ.path_class,new bY({$:1,$0:hS[1],$1:new bY({$:1,$0:{$:1,$0:cB.translate_point_by(hI?dW.New(1,0):dW.New(-1,0),hS[2])},$1:hL(hS[0])})}),(hT=hQ.path_label,hT!=null&&hT.$==1?{$:1,$0:(cB.rotate_label_around(hK.start_anchor,hJ))(hT.$0)}:null)),$1:hN(hP.$1)}):hN(hK.strand))):hN(hK.strand)),hK.start_anchor,cB.rotate_point_around(hK.start_anchor,hJ,hK.end_anchor),hK.east_anchor);};ep.bend_angle=function(){g4.$cctor();return g4.bend_angle;};ep.bend_end=function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ,hR,hS,hT;hL=(hM=cB.rotate_path_command_around(hK.end_anchor,hJ),function(hU){return bX.map(hM,hU);});hN=(hO=cB.rotate_path_around(hK.end_anchor,hJ),function(hU){return bX.map(hO,hU);});return g3.New((hP=bX.rev(hK.strand),hP.$==1?(hQ=hP.$0,(hR=bX.rev(hQ.commands),hR.$==1&&(hR.$0.$==1&&(hS=[hR.$1,hR.$0,hR.$0.$0],true))?bX.rev(new bY({$:1,$0:fZ.New(hQ.path_class,bX.rev(new bY({$:1,$0:hS[1],$1:new bY({$:1,$0:{$:1,$0:cB.translate_point_by(hI?dW.New(-1,0):dW.New(1,0),hS[2])},$1:hL(hS[0])})})),(hT=hQ.path_label,hT!=null&&hT.$==1?{$:1,$0:(cB.rotate_label_around(hK.end_anchor,hJ))(hT.$0)}:null)),$1:hN(hP.$1)})):hN(hK.strand))):hN(hK.strand)),cB.rotate_point_around(hK.end_anchor,hJ,hK.start_anchor),hK.end_anchor,hK.east_anchor);};ep.op_MinusMinusAmp=function(hI,hJ){var hK,hL,hM;hK=ep.extend_left_end(true,hI);hL=ep.extend_left_start(true,hJ);hM=ep.op_MinusAt(ep.op_DivideAt(ep.op_DivideAt(hK.middle,hK.left_overhang),hL.left_overhang),hL.middle);return g2.New(hK.right_overhang,hM,ep.op_GreaterDivide(hL.right_overhang,hM));};ep.op_AtMinusMinus=function(hI,hJ){var hK,hL,hM;hK=ep.extend_right_end(true,hI);hL=ep.extend_right_start(true,hJ);hM=ep.op_MinusAt(ep.op_DivideAt(ep.op_DivideAt(hK.middle,hK.right_overhang),hL.right_overhang),hL.middle);return g2.New(ep.op_GreaterDivide(hL.left_overhang,hM),hM,hK.left_overhang);};ep.op_MinusMinusAt=function(hI,hJ){var hK,hL,hM;hK=ep.extend_right_end(true,hI);hL=ep.extend_left_start(true,hJ);hM=ep.op_MinusAt(ep.op_DivideAt(ep.op_DivideAt(hK.middle,hK.right_overhang),hL.left_overhang),hL.middle);return g2.New(hK.left_overhang,hM,ep.op_GreaterDivide(hL.right_overhang,hM));};ep.segment_sep_condensed=function(){g4.$cctor();return g4.segment_sep_condensed;};ep.transform_strand_by=function(hI,hJ){return g3.New(bX.map(function(hK){return cB.transform_path_by(hI,hK);},hJ.strand),hI(hJ.start_anchor),hI(hJ.end_anchor),hI(hJ.east_anchor));};ep.dom_string=function(hI){return eg.display_picture(hI,true);};ep.label_sep_condensed_upper=function(){g4.$cctor();return g4.label_sep_condensed_upper;};ep.label_sep_condensed_lower=function(){g4.$cctor();return g4.label_sep_condensed_lower;};ep.label_sep_nucleotides_upper=function(){g4.$cctor();return g4.label_sep_nucleotides_upper;};ep.label_sep_nucleotides_lower=function(){g4.$cctor();return g4.label_sep_nucleotides_lower;};ep.label_sep_complement=function(){g4.$cctor();return g4.label_sep_complement;};ep.len_dom=function(hI,hJ,hK){return(cw.Equals(hI,"Nucleotides")?function(hL){return ep.len_dom_seq(hJ,hL);}:ep.len_dom_name())(hK)+ep.dom_pad(hK);};ep.segment_sep_nucleotides=function(){g4.$cctor();return g4.segment_sep_nucleotides;};ep.segment_sep_complement=function(){g4.$cctor();return g4.segment_sep_complement;};ep.extend_start=function(hI,hJ){var hK,hL,hM,hN;function hO(hP){return cB.translate_point_by(hI,hP);}return g3.New((hK=hJ.strand,hK.$==1?(hL=hK.$0,(hM=hL.commands,hM.$==1&&(hM.$0.$==0&&(hN=[hM.$1,hM.$0.$0],true))?new bY({$:1,$0:fZ.New(hL.path_class,new bY({$:1,$0:{$:0,$0:hO(hN[1])},$1:hN[0]}),hL.path_label),$1:hK.$1}):hJ.strand)):hJ.strand),hO(hJ.start_anchor),hJ.end_anchor,hJ.east_anchor);};ep.translate_strand_by=function(){g4.$cctor();return g4.translate_strand_by;};ep.extend_end=function(hI,hJ){var hK,hL,hM,hN;function hO(hP){return cB.translate_point_by(hI,hP);}return g3.New((hK=bX.rev(hJ.strand),hK.$==1?(hL=hK.$0,(hM=bX.rev(hL.commands),hM.$==1&&(hM.$0.$==1&&(hN=[hM.$1,hM.$0.$0],true))?bX.rev(new bY({$:1,$0:fZ.New(hL.path_class,bX.rev(new bY({$:1,$0:{$:1,$0:hO(hN[1])},$1:hN[0]})),hL.path_label),$1:hK.$1})):hJ.strand)):hJ.strand),hJ.start_anchor,hO(hJ.end_anchor),hJ.east_anchor);};ep.extend_left_end=function(hI,hJ){var hK,hL;function hM(hN){return ep.extend_end(hK,hN);}hK=hI?dW.New(ep.segment_skip(),0):dW.New(-ep.segment_skip(),0);hL=hJ.left_overhang;return hL!=null&&hL.$==1?g2.New({$:1,$0:hM(hL.$0)},hJ.middle,hJ.right_overhang):g2.New(hJ.left_overhang,hM(hJ.middle),hJ.right_overhang);};ep.extend_right_start=function(hI,hJ){var hK,hL;function hM(hN){return ep.extend_start(hK,hN);}hK=hI?dW.New(-ep.segment_skip(),0):dW.New(ep.segment_skip(),0);hL=hJ.right_overhang;return hL!=null&&hL.$==1?g2.New(hJ.left_overhang,hJ.middle,{$:1,$0:hM(hL.$0)}):g2.New(hJ.left_overhang,hM(hJ.middle),hJ.right_overhang);};ep.op_AmpMinus=function(hI,hJ){var hK;hK=cB.sub(hJ.start_anchor,hI.end_anchor);return g3.New(bX.append(bX.map((cB.translate_path_by())(hK),hI.strand),hJ.strand),cB.translate_point_by(hK,hI.start_anchor),hJ.end_anchor,cB.translate_point_by(hK,hI.east_anchor));};ep.op_AmpDivide=function(hI,hJ){return hI!=null&&hI.$==1?ep.op_AmpMinus(hI.$0,hJ):hJ;};ep.op_GreaterDivide=function(hI,hJ){return hI!=null&&hI.$==1?{$:1,$0:ep.op_GreaterMinus(hI.$0,hJ)}:null;};ep.op_GreaterMinus=function(hI,hJ){return((ep.translate_strand_by())(cB.sub(hJ.east_anchor,hI.east_anchor)))(hI);};ep.dom_list_to_hp_svg=function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0;function h1(h4,h5){var h6,h7,h8,h9,h_,h$;h6=(ep.len_dom_name())(h5)/2+ep.label_sep_complement();h7=(h8=cB.rotate_point_around(cB.origo(),h4-90,hP),cB.scale_to(ep.baseline_height(),h8));h9=cB.translate_point_by(h7,cB.rotate_point_around(hP,h4,dW.New(-h6*hP.x/hR,-h6*hP.y/hR)));h_=cB.translate_point_by(h7,cB.rotate_point_around(hP,h4,dW.New((-h6-10)*hP.x/hR,(-h6-10)*hP.y/hR)));h$={$:1,$0:ep.baseClass()+" "+ep.dom_id(h5)+(cw.Equals(hI,"Nucleotides")?" fixedwidth":"")};return{$:1,$0:f0.New(ep.dom_string(h5),h9,h$,cB.default_letter_width(),h_)};}function h2(h4,h5,h6){var h7,h8,h9,h_,h$;h7=-ep.label_sep_nucleotides_upper()+ep.baseline_height();h8=(h9=cB.rotate_point_around(cB.origo(),h4,hP),cB.scale_to(ep.baseline_height(),h9));h_=cB.translate_point_by(h8,cB.rotate_point_around(hP,h4,dW.New(-h7*hP.x/hR,-h7*hP.y/hR)));h$=cB.rotate_point_around(h_,90,cB.translate_point_by(h8,cB.rotate_point_around(hP,h4,dW.New((-h7-10)*hP.x/hR,(-h7-10)*hP.y/hR))));return{$:1,$0:f0.New(h6,h_,{$:1,$0:ep.baseClass()+" "+ep.dom_id(h5)+(cw.Equals(hI,"Nucleotides")?" fixedwidth":"")},cB.default_letter_width(),h$)};}function h3(h4){return go.New(hR,hR,h4>180,true,0);}hL=hI=="Condensed"?ep.segment_sep_condensed():hI=="Nucleotides"?ep.segment_sep_nucleotides():ep.segment_sep_complement();hM=ep.dom_list_to_svg(hI,hJ,{$:1,$0:hi.LowerInner},hK);hN=cw.Equals(hI,"Nucleotides")?4:1;hO=hN*cB.get_anchor_point("end",hM).x;hP=dW.New(6.9282-1+hO/(3*ep.letterwidth()),hL.y/2);hQ=360-cB.dir(hP)*360/cB.pi();hR=cB.norm(hP);return dY.New("",{$:0,$0:(hS=bX.rev((hT=(hU=(dZ.fold_left(function(h4,h5){return(function(h6){var h7,h8,h9;h7=h6[0];h8=h6[1];h9=h6[2];return function(h_){var h$,ia,ib,ic,id,ie,_if,ig,ih,ii,ij,ik;function il(_in,io,ip){var iq,ir,is;iq=id*hQ;ir=iq+ip;is=cB.rotate_point_around(hP,ir,cB.origo());return[new bY({$:1,$0:fZ.New({$:1,$0:ep.baseClass()+" "+ep.dom_id(h_)},bX.ofArray([{$:0,$0:io},{$:2,$0:is,$1:h3(iq)}]),null),$1:_in}),is,ir];}function im(_in,io,ip){return function(iq){var ir,is,it;ir=ie*hQ;is=ir+ip;it=cB.rotate_point_around(hP,is,cB.origo());return[new bY({$:1,$0:fZ.New({$:1,$0:ep.baseClass()+" "+ep.dom_id(h_)},bX.ofArray([{$:0,$0:io},{$:2,$0:it,$1:h3(ir)}]),h2((is+ip)/2,h_,iq)),$1:_in}),it,is];};}return hI=="Nucleotides"?(h$=cS.ToCharArray((ia=ef.get_domain(hJ,h_),ia!=null&&ia.$==1?(ib=ia.$0,ib!=null&&ib.$==1)?ef.string_of_sequence(ia.$0.$0):"":"")),(ic=hN*ep.len_dom(hI,hJ,h_)/hO,(id=20/hO,(ie=(ic-2*id)/h$.length,(_if=il(h7,h8,h9),(ig=ck.fold(function(_in,io){return(function(ip){return im(ip[0],ip[1],ip[2]);}(_in))(io);},[_if[0],_if[1],_if[2]],h$),(ih=il(ig[0],ig[1],ig[2]),[ih[0],ih[1],ih[2]]))))))):(ii=ep.len_dom(hI,hJ,h_)/hO*hQ,(ij=ii+h9,(ik=cB.rotate_point_around(hP,ij,cB.origo()),[new bY({$:1,$0:fZ.New({$:1,$0:ep.baseClass()+" "+ep.dom_id(h_)},bX.ofArray([{$:0,$0:h8},{$:2,$0:ik,$1:h3(ii)}]),h1((ij+h9)/2,h_)),$1:h7}),ik,ij])));};}(h4))(h5);},[bY.Empty,cB.origo(),0],bX.rev(hK)))[0],bX.map((cB.translate_path_by())(dW.New(1,0)),hU)),hT.$==1?(hV=hT.$0,new bY({$:1,$0:fZ.New(hV.path_class,bX.append(hV.commands,bX.ofArray([{$:1,$0:hL}])),hV.path_label),$1:hT.$1})):bY.Empty)),hS.$==1?(hW=hS.$1,(hX=hS.$0,(hY=hX.commands,hY.$==1&&(hY.$0.$==0&&(hZ=[hY.$1,hY.$0.$0],true))?(h0=hZ[1],new bY({$:1,$0:fZ.New(hX.path_class,new bY({$:1,$0:{$:0,$0:cB.translate_point_by(dW.New(-1,0),h0)},$1:new bY({$:1,$0:{$:1,$0:h0},$1:hZ[0]})}),hX.path_label),$1:hW})):new bY({$:1,$0:hX,$1:hW})))):bY.Empty)},bX.ofArray([e_.New("start",cB.origo()),e_.New("end",hL)]),false,bY.Empty,null);};ep.extend_left_start=function(hI,hJ){var hK,hL;function hM(hN){return ep.extend_start(hK,hN);}hK=hI?dW.New(-ep.segment_skip(),0):dW.New(ep.segment_skip(),0);hL=hJ.left_overhang;return hL!=null&&hL.$==1?g2.New({$:1,$0:hM(hL.$0)},hJ.middle,hJ.right_overhang):g2.New(hJ.left_overhang,hM(hJ.middle),hJ.right_overhang);};ep.op_DivideAt=function(hI,hJ){return hJ!=null&&hJ.$==1?ep.op_MinusAt(hI,hJ.$0):hI;};ep.extend_right_end=function(hI,hJ){var hK,hL;function hM(hN){return ep.extend_end(hK,hN);}hK=hI?dW.New(ep.segment_skip(),0):dW.New(-ep.segment_skip(),0);hL=hJ.right_overhang;return hL!=null&&hL.$==1?g2.New(hJ.left_overhang,hJ.middle,{$:1,$0:hM(hL.$0)}):g2.New(hJ.left_overhang,hM(hJ.middle),hJ.right_overhang);};ep.len_dom_seq=function(hI,hJ){var hK,hL,hM,hN;hK=bX.length((hL=ef.get_domain(hI,hJ),hL!=null&&hL.$==1&&((hN=hL.$0,hN!=null&&hN.$==1)&&(hM=hL.$0.$0,true))?hM:bY.Empty));return ep.letterwidth()*hK;};ep.len_dom_name=function(){g4.$cctor();return g4.len_dom_name;};ep.dom_pad=function(hI){return(eg.is_toehold(hI)?ep.toehold_pad():ep.normal_pad())*ep.letterwidth();};ep.segment_skip=function(){g4.$cctor();return g4.segment_skip;};ep.baseline_height=function(){g4.$cctor();return g4.baseline_height;};ep.toehold_pad=function(){g4.$cctor();return g4.toehold_pad;};ep.normal_pad=function(){g4.$cctor();return g4.normal_pad;};eq.toStringList=function(hI){return hI.$==1?hI.$0.$==1?bX.append(bX.ofArray(["("+cS.concat(", ",eq.toStringList(hI.$0.$0))+")"]),eq.toStringList(hI.$1)):new bY({$:1,$0:hI.$0.$0,$1:eq.toStringList(hI.$1)}):bY.Empty;};eq.toTypes=function(hI){return hI.$==1?hI.$0.$==1?new bY({$:1,$0:[{$:8,$0:eq.toTypes(hI.$0.$0),$1:ec.emprange()}],$1:eq.toTypes(hI.$1)}):new bY({$:1,$0:[gW.BottomT],$1:eq.toTypes(hI.$1)}):bY.Empty;};eq.toTypeEnv=function(hI,hJ){var hK,hL;switch(hJ.$==1?hJ.$0.$==1?hI.$==1?(hK=[hJ.$1,hJ.$0.$0,hI.$0,hI.$1],2):3:hI.$==1?(hK=[hJ.$1,hI.$0,hI.$1,hJ.$0.$0],1):3:hI.$==0?0:3){case 0:return bY.Empty;case 1:return new bY({$:1,$0:[hK[3],hK[1]],$1:eq.toTypeEnv(hK[2],hK[0])});case 2:hL=hK[2][0];return hL.$==8?bX.append(eq.toTypeEnv(hL.$0,hK[1]),eq.toTypeEnv(hK[3],hK[0])):be.FailWith("Typecheck failed");case 3:return be.FailWith("toTypeEnv not given lists of equal length");}};eq.check_parameter_types=function(hI,hJ,hK,hL,hM){function hN(hP,hQ){var hR,hS,hT,hU,hV,hW,hX,hY,hZ;if(ec.equal(hP,hQ))return null;else{hS=hP[0];hT=hQ[0];switch(hS.$==0?0:hS.$==1?hT.$==0?(hR=hS,1):hT.$==1?(hR=[hS.$1,hT.$1,hS.$2,hT.$2,hS.$0,hT.$0],2):hT.$==3?hS.$1==null?4:(hR=[hS.$1.$0,hT,hS.$2,hS.$0],3):hT.$==6?hS.$1==null?4:(hR=[hS.$1.$0,hT,hS.$2,hS.$0],3):hT.$==4?hS.$1==null?4:(hR=[hS.$1.$0,hT,hS.$2,hS.$0],3):hT.$==2?hS.$1==null?4:(hR=[hS.$1.$0,hT,hS.$2,hS.$0],3):(hU=hS.$1,hU!=null&&hU.$==1?(hR=[hS.$1.$0,hT,hS.$2,hS.$0],3):(hR=[hT,hS],7)):hS.$==7?hT.$==0?(hR=hS,1):hT.$==7?hT.$0==null?(hV=hS.$0,hV!=null&&hV.$==1?(hR=hS.$0.$0,5):(hR=[hT,hS],7)):(hR=[hT,hS],7):(hR=[hT,hS],7):hS.$==8?hT.$==0?(hR=hS,1):hT.$==8?(hR=[hT.$0,hS.$0],6):(hR=[hT,hS],7):hT.$==0?(hR=hS,1):(hR=[hT,hS],7)){case 0:return null;case 1:{hQ[0]=hR;return;}break;case 2:hW=hR[5];hQ[0]={$:1,$0:hW,$1:hR[0],$2:hR[3]};return bX.iter(function(h0){h0[0]=hQ[0];},hW);case 3:hX=hR[1];return hR[0]&&ec.is_numeric(hX)||ec.is_num_or_bool(hX)?null:fc.type_error(hK,{$:1,$0:hQ[0],$1:bX.ofArray([hP[0]]),$2:" parameters "});case 4:return null;case 5:{hQ[0]={$:7,$0:{$:1,$0:hR},$1:hK};return;}break;case 6:hY=hR[0];hZ=hR[1];return bX.length(hZ)===bX.length(hY)?bX.iter2(hN,hZ,hY):fc.type_error(hK,{$:3,$0:hJ,$1:bX.length(hY),$2:bX.length(hZ)});case 7:return fc.type_error(hK,{$:1,$0:hR[0],$1:bX.ofArray([hR[1]]),$2:" parameters "});}}}function hO(hP,hQ){var hR;switch(hP.$==1?hQ.$==1?(hR=[hQ.$0,hQ.$1,hP.$0,hP.$1],1):2:hQ.$==0?0:2){case 0:null;break;case 1:hN(hR[2],hR[0]);hO(hR[3],hR[1]);break;case 2:be.FailWith("length check failed");break;}}bX.length(hL)===bX.length(hM)?hO(hL,hM):fc.type_error(hK,{$:2,$0:hJ,$1:bX.length(hM),$2:bX.length(hL)});};er.$cctor=function(){er.$cctor=a.ignore;er.empty_meta=cQ.New(ef.initialise_mapping(bR.default_options()),cN.empty_env(0),dD.empty(),dD.empty());er.cle=b5.engine();er["cle\'"]=ew.New(bT.cle().toString,bT.cle().toStringTempVar,bT.cle().compare,bT.cle().cast,bT.cle().toCanonicalForm,bT.cle().toCanonicalFormProcess,bT.cle().unify,bT.cle().underscore,bT.cle().applyAll,bT.cle().applySub,bT.cle().applySubVar,bT.cle().fvs,bT.cle().refresh,bT.cle().disambiguateVars,(hB.Curried3(b5.logicDsdComposeProcesses))(true),bT.cle().resolveGoal,bT.cle().domainKeywords);};es.Time={$:1};es.map=function(hI,hJ){return hJ.$==1?es.Time:{$:0,$0:hI(hJ.$0)};};b8.printVar=function(hI,hJ){return hI>=0?(((hB.Curried3(function(hK,hL,hM){return hK(cA.toSafe(hL)+"("+a.String(hM)+")");}))(a.id))(hJ))(hI):hJ;};b8.makeProvider=function(){return(b8.newIdProvider())(b8.emptyIdCache());};b8.cachedIdProvider=function(hI,hJ,hK){var hL;return hJ[0].ContainsKey(hK)?[hJ[0].get_Item(hK),hK]:(hL=hI[0],(hI[0]=hL+1,hJ[0]=hJ[0].Add(hK,hL),[hL,hK]));};b8.emptyIdCache=function(){return[new cj.New([])];};b8.newIdProvider=function(){var hI;hI=[0];return(hB.Curried3(b8.cachedIdProvider))(hI);};b8.idProvider=function(){var hI;hI=[new cj.New([])];return(b8.newIdProvider())(hI);};b8.toProgram=function(hI){var hJ,hK,hM,hN,hO,hP,hQ;function hL(hR,hS){var hT;hT=[hS.head.get_Name(),hS.head.get_Args().get_Length()];return hR.ContainsKey(hT)?hR.Add(hT,hR.get_Item(hT).Add(hS)):hR.Add(hT,(new cK.New$1(null)).Add(hS));}hM=(hJ=(hK=new cj.New([]),function(hR){return co.fold(hL,hK,hR);}),function(hR){return bW.ToSeq(hJ(hR));});hN=hM(hI);hO=new ct.New$5();hP=df.Get(hN);try{while(hP.MoveNext()){hQ=hP.Current();hO.Add(hQ[0],hQ[1]);}}finally{if(typeof hP=="object"&&"Dispose"in hP)hP.Dispose();}return hO;};b8.EQ=function(){hk.$cctor();return hk.EQ;};b8.LT=function(){hk.$cctor();return hk.LT;};b8.GT=function(){hk.$cctor();return hk.GT;};et.$cctor=function(){et.$cctor=a.ignore;et.engine=ew.New(cf.ToString,b5.printer,b5.dsdCompare,function(hI){return hI.$==1?new cf({$:0,$0:new ce({$:1,$0:new cd({$:1,$0:[-1,"_"],$1:cb.AnyTag}),$1:hI.$0})}):new cf({$:0,$0:new ce({$:0,$0:hI.$0})});},b5.dsdCanonicalSite,b5.dsdToCanonicalFormProcess,function(hI){return b5.dsdUnify(hI[0],hI[1]);},function(){return new cf({$:1,$0:[-1,"_"]});},b5.dsdApplySub,b5.dsdCompose,b5.dsdApplySubVar,b5.fvSiteT,b5.dsdRefresh,b5.dsdDisambiguateVars,(hB.Curried3(b5.logicDsdComposeProcesses))(false),function(hI){return b5.dsdResolveGoal(hI[0],hI[1]);},bX.ofArray(["!","{","@"]));};eu=c0.Goal=hB.Class({},null,eu);eu.Create=function(hI,hJ){var hK,hL;hK=(hL=new cK.New$1(c6.OfSeq(co.concat(bX.map(function(hM){return c3.fvl(hJ,hM);},hI)))),co.fold(function(hM,hN){var hO;return hN.$==2?hM.Add$1(hN.$0,{$:2,$0:hN.$1},hJ):hN.$==3?hM.Add$1(hN.$0,{$:3,$0:hN.$1},hJ):hN.$==1?hM.Add$3(hN,{$:1,$0:hN.$0},hJ):hM.Add$4(hN,(hO=hN.$0,{$:0,$0:hO[0],$1:hO[1]}),hJ);},c4.get_id(),hL));return eu.New(hI,ci.Create(new cg({$:0,$0:"",$1:bY.Empty})),hK);};eu.Create$2=function(hI,hJ,hK){return eu.New(hJ,hK,hI);};eu.get_OK=function(){return bY.Empty;};eu.New=function(hI,hJ,hK){return new eu({goals:hI,rule:hJ,solution:hK});};ev.AllAnswers={$:1};ev.SingleAnswer={$:0};c3.fvl=function(hI,hJ){return hJ.$==1?c3.fvp(hI,hJ.$0):c3.fvp(hI,hJ.$0);};c3.fvt=function(hI,hJ){var hK,hL,hM,hN;switch(hJ.$==1?2:hJ.$==2?3:hJ.$==3?(hK=hJ.$1,4):hJ.$==4?(hK=hJ.$0,5):hJ.$==5?(hK=[hJ.$0,hJ.$1],6):hJ.$==9?(hK=hJ.$0,7):hJ.$==8?(hK=hJ.$0,8):hJ.$==6?(hK=hJ.$0,9):hJ.$==7?(hK=hJ.$0,10):hJ.$0===-1?hJ.$1==="_"?0:(hK=[hJ.$0,hJ.$1],1):(hK=[hJ.$0,hJ.$1],1)){case 0:return new cK.New$1(null);case 1:hL=new fm({$:0,$0:[hK[0],hK[1]]});return(new cK.New$1(null)).Add(hL);case 2:return new cK.New$1(null);case 3:return new cK.New$1(null);case 4:return(c3.unionFold(function(hO){return c3.fvt(hI,hO);}))(hK);case 5:return(c3.unionFold(function(hO){return c3.fvt(hI,hO);}))(hK);case 6:hM=bX.ofArray([hK[0],hK[1]]);return(c3.unionFold(function(hO){return c3.fvt(hI,hO);}))(hM);case 7:return c3.fvPattern(hI,hK);case 8:return c3.fvSystem(hI,hK);case 9:return(c3.unionFold(function(hO){return c3.fvt(hI,hO);}))(hK);case 10:hN=bX.map(function(hO){return hO[1];},hK);return(c3.unionFold(function(hO){return c3.fvt(hI,hO);}))(hN);}};c3.fvp=function(hI,hJ){return(c3.unionFold(function(hK){return c3.fvt(hI,hK);}))(hJ.$1);};c3.unionFold=function(hI){var hJ;function hK(hL,hM){return new cK.New$1(c6.OfSeq(co.append(hL,hI(hM))));}hJ=new cK.New$1(null);return function(hL){return co.fold(hK,hJ,hL);};};c3.fvPattern=function(hI,hJ){function hK(hL,hM){var hN;hN=hI.fvs(hL);return new cK.New$1(c6.OfSeq(co.append(c3.fvLocation(hM),hN)));}return hJ.$==0?new cK.New$1(c6.OfSeq(co.append((c3.unionFold(function(hL){return hK(hL[0],hL[1]);}))(hJ.$0),(c3.unionFold(function(hL){return hK(hL[0],hL[1]);}))(hJ.$1)))):hJ.$==2?(c3.unionFold(function(hL){return hK(hL[0],hL[1]);}))(hJ.$0):hJ.$==3?(c3.unionFold(function(hL){return hK(hL[0],hL[1]);}))(hJ.$0):hJ.$==4?(c3.unionFold(function(hL){return hK(hL[0],hL[1]);}))(hJ.$0):hJ.$==5?new cK.New$1(null):(c3.unionFold(function(hL){return hK(hL[0],hL[1]);}))(hJ.$0);};c3.fvSystem=function(hI,hJ){var hK,hL;function hM(hN){return hN[1];}return new cK.New$1(c6.OfSeq(co.concat((hK=bX.ofSeq(bW.ToSeq(hJ.$0)),bX.map((hL=c3.unionFold(hI.fvs),function(hN){return hL(hM(hN));}),hK)))));};c3.fvLocation=function(hI){var hJ,hK;switch(hI.$==1?hI.$0[0]===-1?hI.$0[1]==="_"?1:(hJ=hI.$0,2):(hJ=hI.$0,2):0){case 0:return new cK.New$1(null);case 1:return new cK.New$1(null);case 2:hK=new fm({$:1,$0:hJ});return(new cK.New$1(null)).Add(hK);}};c3.mapUnion=function(hI,hJ){return co.fold(function(hK,hL){var hM;hM=be.KeyValue(hL);return hK.Add(hM[0],hM[1]);},hI,hJ);};ew.get_empty=function(){return ew.New(function(hI){var hJ;hJ=hI;return a.String(hJ);},function(hI){var hJ;hJ=hI;return a.String(hJ);},function(){return function(){return be.FailWith("Internal error (CLE)");};},function(){return be.FailWith("Internal error (CLE)");},a.id,a.id,function(){return be.FailWith("Internal error (CLE)");},function(){return be.FailWith("Internal error (CLE)");},function(){return function(){return be.FailWith("Internal error (CLE)");};},function(){return function(){return be.FailWith("Internal error (CLE)");};},function(){return function(){return be.FailWith("Internal error (CLE)");};},function(){return be.FailWith("Internal error (CLE)");},function(){return be.FailWith("Internal error (CLE)");},function(){return be.FailWith("Internal error (CLE)");},function(){return function(){return be.FailWith("Internal error (CLE)");};},function(){return function(){return be.FailWith("Internal error (CLE)");};},bY.Empty);};ew.New=function(hI,hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY){return{toString:hI,toStringTempVar:hJ,compare:hK,cast:hL,toCanonicalForm:hM,toCanonicalFormProcess:hN,unify:hO,underscore:hP,applyAll:hQ,applySub:hR,applySubVar:hS,fvs:hT,refresh:hU,disambiguateVars:hV,ComposeProcesses:hW,resolveGoal:hX,domainKeywords:hY};};ex=df.T=hB.Class({MoveNext:function(){return this.n(this);},Current:function(){return this.c;},Dispose:function(){if(this.d)this.d(this);}},b1,ex);ex.New=hB.Ctor(function(hI,hJ,hK,hL){b1.New.call(this);this.s=hI;this.c=hJ;this.n=hK;this.d=hL;},ex);ey.$cctor=function(){var hI,hJ;ey.$cctor=a.ignore;ey.defaultIGraph=cv.New(null,new cj.New([]),new cj.New([]),false);ey.pid=cR.op_DotGreaterGreater(cR.name(),cR.spaces());ey.plocation=cR.op_GreaterGreaterEquals(m.pid(),function(hK){var hL;hL=cR.choice([cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(cR.pchar("."),m.pid()),function(hM){return cR.preturn(new n({$:1,$0:[hK,hM]}));}),cR.preturn(new n({$:0,$0:hK}))]);return function(hM){return hL([hM[0],hM[1]]);};});ey.pparameter=cR.op_GreaterGreaterEquals(m.pid(),function(hK){var hL,hM;hL=cR.choice([cR.op_GreaterGreaterDot(cR.kw("="),(hM=cR.choice([cR.op_GreaterGreaterDot(cR.kw("Fixed"),cR.preturn([hK,hK,"Fixed2"])),cR.op_GreaterGreaterDot(cR.kw("Normal"),cR.preturn([hK,hK,"Normal"])),cR.op_GreaterGreaterDot(cR.kw("LogNormal"),cR.preturn([hK,hK,"LogNormal"])),cR.op_GreaterGreaterDot(cR.kw("TruncatedNormal"),cR.preturn([hK,hK,"TruncatedNormal"]))]),function(hN){return hM([hN[0],hN[1]]);})),cR.preturn([hK,hK,"TruncatedNormal"])]);return function(hN){return hL([hN[0],hN[1]]);};});ey.parseTask=(hI=cR.op_GreaterGreaterDot(cR.pTry(cR.op_GreaterGreaterDot(cR.kw("directive"),cR.kw("task"))),cR.record(l.New(null,1,1,1),bX.ofArray([["task",cR.op_BarGreaterGreater((hJ=cR.choice([cR.op_GreaterGreaterDot(cR.kw("infer"),cR.preturn("Infer")),cR.op_GreaterGreaterDot(cR.kw("simulate"),cR.preturn("Simulate")),cR.op_GreaterGreaterDot(cR.kw("parse"),cR.preturn("Parse"))]),function(hK){return hJ([hK[0],hK[1]]);}),function(hK){return function(hL){return l.New({$:1,$0:hK},hL.copies,hL.copy_id,hL.nodes);};})],["copies",cR.op_BarGreaterGreater(cR.pint32(),function(hK){return function(hL){return l.New(hL.task_type,hK,hL.copy_id,hL.nodes);};})],["copy_id",cR.op_BarGreaterGreater(cR.pint32(),function(hK){return function(hL){return l.New(hL.task_type,hL.copies,hK,hL.nodes);};})],["nodes",cR.op_BarGreaterGreater(cR.pint32(),function(hK){return function(hL){return l.New(hL.task_type,hL.copies,hL.copy_id,hK);};})]]))),cR.op_GreaterGreaterDot(cR.spaces(),cR.opt(hI)));ey.parse=cR.op_GreaterGreaterEquals(cR.op_DotGreaterGreaterDot(m.parseTask(),cm.get_parse()),function(hK){var hL,hM,hN;hL=hK[0];hM=hK[1];hN=cR.choice([m.pinferenceGraph(hL,hM,bW.OfArray(ck.ofSeq(bX.map(function(hO){return[hO.name,hO];},hM.systems)))),cR.preturn(cv.New(hL,bW.OfArray(ck.ofSeq(bX.ofArray([[hM.top.name,hM]]))),new cj.New([]),false))]);return function(hO){return hN([hO[0],hO[1]]);};});ey.from_string=function(hK){return cR.from_string(m.parse(),hK);};};ez.init=function(hI){return new fq.New$1(hI);};ez.append=function(hI,hJ){hI.Append(hJ);};ez.value=function(hI){return a.String(hI);};ez.empty=function(){return new fq.New();};eB=eA.NormalGenerator=hB.Class({get_Sigma:function(){return this.stdev;},get_Mean:function(){return this.mean;},nextDouble:function(hI){var hJ,hK,hL,hM,hN;hJ=this.state.rnorm_phase?[this.state.rnorm_2*this.state.rnorm_f,(hK=this.state,fz.New(false,hK.rnorm_2,hK.rnorm_f)),hI]:(hL=function(hO,hP){var hQ,hR,hS,hT,hU,hV;while(true){hQ=hP.Microsoft_Research_Filzbach_Lib_IRng$NextDouble();hR=hQ[1].Microsoft_Research_Filzbach_Lib_IRng$NextDouble();hS=hR[1];hT=hQ[0]*2-1;hU=hR[0]*2-1;hV=hT*hT+hU*hU;if(hV<1)return[hV,hT,fz.New(hO.rnorm_phase,hU,hO.rnorm_f),hS];else{hO=fz.New(hO.rnorm_phase,hU,hO.rnorm_f);hP=hS;}}}(this.state,hI),(hM=hL[0],(hN=hC.sqrt(-2*hC.log(hM)/hM),[hL[1]*hN,fz.New(true,hL[2].rnorm_2,hN),hL[3]])));return[hJ[0]*this.stdev+this.mean,new eB.New$1(hJ[1],this.mean,this.stdev),hJ[2]];}},b1,eB);eB.New=hB.Ctor(function(hI,hJ){eB.New$1.call(this,fz.New(false,0,0),hI,hJ);},eB);eB.New$1=hB.Ctor(function(hI,hJ,hK){b1.New.call(this);this.state=hI;this.mean=hJ;this.stdev=hK;},eB);eC.run_seq=function(hI,hJ,hK,hL){var hM,hN,hO,hP,hQ,hR,hS;function hT(hU,hV,hW){var hX,hY,hZ;hX=hU.$==1?(hY=eC.sampleStep(hI,hN,hL,hV,hW,hU.$0),[{$:1,$0:hY[0]},hY[1]]):hV>=hL.burninLen?[{$:1,$0:dk.samplingInit(hU.$0)},hW]:(hZ=eC.burninStep(hI,hN,hL,hV,hW,hU.$0),[{$:0,$0:hZ[0]},hZ[1]]);return[hX[0],hV+1,hX[1]];}hM=eC.paramsInit(hK,dk.paramsCheck(hJ));hN=hM[1];hO=hM[0];hP=hI(eD.All);hQ=dk.paramsInit(hO,new e8.New(hL.seed));hR=hQ[0];hS=hP(hR);return co.map(function(hU){return eA.fst3(hU[0],hU[1],hU[2]);},dk.step_to_seq(function(hU){return hT(hU[0],hU[1],hU[2]);},[{$:0,$0:dk.burninInit(function(hU){return co.sum(hP(hU));},hO,hR,hM[2],hQ[1])},1,hS],hL.burninLen+hL.sampleLen));};eC.paramsInit=function(hI,hJ){var hK,hL,hM,hN;function hO(hQ,hR){return hQ.isFixed();}function hP(hQ,hR){return new gK.New(hQ.name,hQ.range);}hK=bX.partition(function(hQ){return hO(hQ[0],hQ[1]);},bX.zip(hJ,hI));hL=hK[1];hM=dz.ofSeq(bX.map(function(hQ){return hP(hQ[0],hQ[1]);},hL));hN=bX.map(function(hQ){return hQ[1];},hL);return[bX.map(function(hQ){return hQ[0];},bX.append(hL,hK[0])),hN,hM];};eC.sampleStep=function(hI,hJ,hK,hL,hM,hN){var hO,hP,hQ,hR,hS,hT,hU;hO=eC.evaluateAcceptance(hI,hJ,hL,hM,hN.space,hN.priors,hN.state,hN.innovationGens,hN.indexes,hN.randGen);hP=hO[0];hQ=hP.$==0?(hR=hP.$0,[hR,hR.logLikelihood>hN.mle.logLikelihood?hR:hN.mle,hO[2],hN.accepted+1]):[(hS=hN.state,dj.New(hS.values,hS.logLikelihood,hS.logPrior,hL)),hN.mle,hM,hN.accepted];hT=hQ[0];hU=dl.New(hN.space,hT,hN.thinningSkippedCount,hN.chain,hN.burnin,hO[1],hO[3],hQ[1],hN.priors,hN.indexes,hQ[3]);return[hU.thinningSkippedCount===hK.thinning-1?dl.New(hU.space,hU.state,0,new bY({$:1,$0:hT,$1:hU.chain}),hU.burnin,hU.randGen,hU.innovationGens,hU.mle,hU.priors,hU.indexes,hU.accepted):dl.New(hU.space,hU.state,hU.thinningSkippedCount+1,hU.chain,hU.burnin,hU.randGen,hU.innovationGens,hU.mle,hU.priors,hU.indexes,hU.accepted),hQ[2],hO[5]];};eC.burninStep=function(hI,hJ,hK,hL,hM,hN){var hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY;function hZ(h1,h2){return h2?bo.New(h1.accepted+1,h1.altered+1):h1;}function h0(h1,h2){return h2?bo.New(h1.accepted,h1.altered+1):h1;}hO=eC.evaluateAcceptance(hI,hJ,hL,hM,hN.space,hN.priors,hN.state,hN.innovationGens,hN.indexes,hN.randGen);hP=hO[4];hQ=hO[0];hR=hQ.$==0?(hS=hQ.$0,[hS,hS.logLikelihood>hN.mle.logLikelihood?hS:hN.mle,hO[2],(((hB.Curried3(ck.map2))(hZ))(hN.stats))(hP)]):[(hT=hN.state,dj.New(hT.values,hT.logLikelihood,hT.logPrior,hL)),hN.mle,hM,(((hB.Curried3(ck.map2))(h0))(hN.stats))(hP)];hU=hR[0];hV=hR[3];hW=ck.choose(a.id,ck.mapi(function(h1,h2){return h2.altered===20?{$:1,$0:h1}:null;},hV));hX=dk.correctInnovationGens(hW,hN.space,hN.stats,hN.innovationGens);hY=dm.New(hN.space,hU,hN.thinningSkippedCount,hN.chain,ck.mapi(function(h1,h2){return ck.contains(h1,hW)?bo.New(0,0):h2;},hV),hO[1],hX,hR[1],hN.priors,hN.indexes);return[hY.thinningSkippedCount===hK.thinning-1?dm.New(hY.space,hY.state,0,new bY({$:1,$0:hU,$1:hY.chain}),hY.stats,hY.randGen,hY.innovationGens,hY.mle,hY.priors,hY.indexes):dm.New(hY.space,hY.state,hY.thinningSkippedCount+1,hY.chain,hY.stats,hY.randGen,hY.innovationGens,hY.mle,hY.priors,hY.indexes),hR[2],hO[5]];};eC.evaluateAcceptance=function(hI,hJ,hK,hL,hM,hN,hO,hP,hQ,hR){var hS,hT,hU,hV,hW,hX,hY,hZ;hS=dk.proposeValues(hM,hO,hR,hP);hT=hS[3];hU=hS[0];hV=hS[2];hW=hS[1];hX=dk.isStateOutOfRange(hW,hU,hM,hQ);return hX?[g$.Rejected,hT,hL,hV,hW,hX]:(hY=eC.partial_logLikelihoods(hW,hJ,hI,hL,hU),(hZ=dk.acceptProposedValues(hK,co.sum(hY),dk.lglkPriors(hU,hN),hU,hO,hT),[hZ[0],hZ[1],hY,hV,hW,hX]));};eC.partial_logLikelihoods=function(hI,hJ,hK,hL,hM){var hN,hO,hP;hN=bX.map(function(hQ){return hQ[1];},bX.filter(function(hQ){return hQ[0];},bX.zip(bX.ofArray(hI),hJ)));return bX.contains(eD.All,hN)?(hK(eD.All))(hM):(hO=bX.sort(bX.distinct(co.fold(function(hQ,hR){return hR.$==0?be.FailWith("Can\'t be possible"):bX.append(hR.$0,hQ);},bY.Empty,hN))),(hP=(hK({$:1,$0:hO}))(hM),bX.mapi(function(hQ,hR){var hS;hS=co.tryFindIndex(function(hT){return hT===hQ;},hO);return hS==null?hR:hP.get_Item(hS.$0);},hL)));};eD.All={$:0};dk.run_seq=function(hI,hJ,hK){var hL,hM,hN;function hO(hP,hQ){var hR,hS,hT;return[hP.$==1?{$:1,$0:(hR=dk.sampleStep(hI,hK,hQ,hP.$0),eA.fst3(hR[0],hR[1],hR[2]))}:hQ>=hK.burninLen?{$:1,$0:(hS=dk.sampleStep(hI,hK,hQ,dk.samplingInit(hP.$0)),eA.fst3(hS[0],hS[1],hS[2]))}:{$:0,$0:(hT=dk.burninStep(hI,hK,hQ,hP.$0),eA.fst3(hT[0],hT[1],hT[2]))},hQ+1];}hL=dk.paramsSetup(dk.paramsCheck(hJ));hM=hL[0];hN=dk.paramsInit(hM,new e8.New(hK.seed));return co.map(function(hP){return hP[0];},dk.step_to_seq(function(hP){return hO(hP[0],hP[1]);},[{$:0,$0:dk.burninInit(hI,hM,hN[0],hL[1],hN[1])},0],hK.burninLen+hK.sampleLen));};dk.paramsCheck=function(hI){bX.iter(function(hJ){var hK,hL;hK=hJ.initValue;hK==null?void 0:(hL=hK.$0,hL>hJ.range.ub||hL<hJ.range.lb?((((hB.Curried(function(hM,hN,hO,hP){return hM("The initial value of parameter "+cA.toSafe(hN)+" is outside the specified bounds ("+hO.toFixed(6)+","+hP.toFixed(6)+")");},4))(be.FailWith))(hJ.name))(hJ.range.lb))(hJ.range.ub):void 0);},hI);bX.exists(function(hJ){return hJ.isFixed()&&hJ.initValue==null;},hI)?be.FailWith("All fixed parameters must have initial value"):void 0;bX.exists(function(hJ){return hJ.range.lb>hJ.range.ub;},hI)?be.FailWith("One of the parameter definitions contains upper bound lower than lower bound"):void 0;bX.exists(function(hJ){return!hJ.isReal()&&hJ.range.lb<0;},hI)?be.FailWith("One of the log-scale parameter definitions contains negative lower bound"):void 0;return bX.map(function(hJ){var hK;return hJ.range.pType.$===1&&hJ.range.lb===0?cs.New(hJ.name,(hK=hJ.range,bi.New(hK.pType,4.94065645841247E-324,hK.ub)),hJ.initValue,hJ.prior,hJ.summary):hJ;},hI);};dk.paramsInit=function(hI,hJ){var hK,hL;function hM(hN,hO,hP){var hQ;return hN==null?(hQ=hP.Microsoft_Research_Filzbach_Lib_IRng$NextDouble(),[hO.lb+hQ[0]*(hO.ub-hO.lb),hQ[1]]):[hN.$0,hP];}hK=ck.ofList(bX.skip(1,bX.scan(function(hN,hO){var hP;hP=hM(hO.initValue,hO.range,hN[1]);return[new gK.New(hO.name,hP[0]),hP[1]];},[new gK.New("dummy",0),hJ],hI)));hL=ck.map(function(hN){return hN[0];},hK);ck.length(hK)!==hI.get_Length()?be.FailWith("unexpected scan behaviour"):void 0;return[dz.ofArray(hL),(ck.get(hK,ck.length(hK)-1))[1]];};dk.step_to_seq=function(hI,hJ,hK){function hL(hM,hN){var hO;return hN<=0?null:(hO=hI(hM),{$:1,$0:[hO,[hO,hN-1]]});}return co.unfold(function(hM){return hL(hM[0],hM[1]);},[hJ,hK]);};dk.burninInit=function(hI,hJ,hK,hL,hM){var hN,hO,hP;function hQ(hR){var hS;hS=hR.pType;return hS.$==1?0.5*(hC.log(hR.ub)-hC.log(hR.lb)):hS.$==2?be.FailWith("Must not be called. Innovation generator is not needed for fixed parameter"):0.5*(hR.ub-hR.lb);}hN=bW.OfArray(ck.ofSeq(ck.mapi(function(hR,hS){return[hR,new eB.New(0,hQ(hS))];},hL.get__dataArray())));hO=ck.ofList(bX.map(function(hR){return hR.prior;},hJ));hP=dj.New(hK,hI(hK),dk.lglkPriors(hK,hO),0);return dm.New(hL,hP,0,bY.Empty,ck.map(function(){return bo.New(0,0);},hL.get__dataArray()),hM,hN,hP,hO,ck.init(hN.get_Count(),a.id));};dk.samplingInit=function(hI){return dl.New(hI.space,hI.state,0,bY.Empty,hI.chain,hI.randGen,hI.innovationGens,hI.mle,hI.priors,hI.indexes,0);};dk.paramsSetup=function(hI){var hJ,hK,hL;hJ=bX.partition(function(hM){return hM.isFixed();},hI);hK=hJ[1];hL=dz.ofSeq(bX.map(function(hM){return new gK.New(hM.name,hM.range);},hK));return[bX.append(hK,hJ[0]),hL];};dk.sampleStep=function(hI,hJ,hK,hL){var hM,hN,hO,hP,hQ,hR,hS,hT,hU;hM=dk.evaluateAcceptance(hI,hK,hL.space,hL.priors,hL.state,hL.innovationGens,hL.indexes,hL.randGen);hN=hM[4];hO=hM[0];hP=hO.$==0?(hQ=hO.$0,[hQ,hQ.logLikelihood>hL.mle.logLikelihood?hQ:hL.mle,hL.accepted+1]):[(hR=hL.state,dj.New(hR.values,hR.logLikelihood,hR.logPrior,hK)),hL.mle,hL.accepted];hS=hP[0];hT=hP[1];hU=dl.New(hL.space,hS,hL.thinningSkippedCount,hL.chain,hL.burnin,hM[1],hM[2],hT,hL.priors,hL.indexes,hP[2]);return hU.thinningSkippedCount===hJ.thinning-1?[dl.New(hU.space,hU.state,0,new bY({$:1,$0:hS,$1:hU.chain}),hU.burnin,hU.randGen,hU.innovationGens,hU.mle,hU.priors,hU.indexes,hU.accepted),hT.logLikelihood,hN]:[dl.New(hU.space,hU.state,hU.thinningSkippedCount+1,hU.chain,hU.burnin,hU.randGen,hU.innovationGens,hU.mle,hU.priors,hU.indexes,hU.accepted),hT.logLikelihood,hN];};dk.burninStep=function(hI,hJ,hK,hL){var hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY;function hZ(h1,h2){return h2?bo.New(h1.accepted+1,h1.altered+1):h1;}function h0(h1,h2){return h2?bo.New(h1.accepted,h1.altered+1):h1;}hM=dk.evaluateAcceptance(hI,hK,hL.space,hL.priors,hL.state,hL.innovationGens,hL.indexes,hL.randGen);hN=hM[4];hO=hM[3];hP=hM[0];hQ=hP.$==0?(hR=hP.$0,[hR,hR.logLikelihood>hL.mle.logLikelihood?hR:hL.mle,(((hB.Curried3(ck.map2))(hZ))(hL.stats))(hO)]):[(hS=hL.state,dj.New(hS.values,hS.logLikelihood,hS.logPrior,hK)),hL.mle,(((hB.Curried3(ck.map2))(h0))(hL.stats))(hO)];hT=hQ[0];hU=hQ[1];hV=hQ[2];hW=ck.choose(a.id,ck.mapi(function(h1,h2){return h2.altered===20?{$:1,$0:h1}:null;},hV));hX=dk.correctInnovationGens(hW,hL.space,hL.stats,hL.innovationGens);hY=dm.New(hL.space,hT,hL.thinningSkippedCount,hL.chain,ck.mapi(function(h1,h2){return ck.exists(function(h3){return h1===h3;},hW)?bo.New(0,0):h2;},hV),hM[1],hX,hU,hL.priors,hL.indexes);return hY.thinningSkippedCount===hJ.thinning-1?[dm.New(hY.space,hY.state,0,new bY({$:1,$0:hT,$1:hY.chain}),hY.stats,hY.randGen,hY.innovationGens,hY.mle,hY.priors,hY.indexes),hU.logLikelihood,hN]:[dm.New(hY.space,hY.state,hY.thinningSkippedCount+1,hY.chain,hY.stats,hY.randGen,hY.innovationGens,hY.mle,hY.priors,hY.indexes),hU.logLikelihood,hN];};dk.lglkPriors=function(hI,hJ){var hK;function hL(hM,hN){var hO,hP,hQ;return hM==null?0:hM.$0.$==1?(hO=hM.$0.$0,eA.logOfNormPDF(hO.mu,hO.sigma,hC.log(hN))-hC.log(hN)):hM.$0.$==2?(hP=hM.$0.$0,eA.logOfNormPDF(hP.mean,hP.stdev,hN)-hC.log(hP.denominator)):(hQ=hM.$0.$0,eA.logOfNormPDF(hQ.mean,hQ.stdev,hN));}return ck.sum((hK=hI.ToArray(),(((hB.Curried3(ck.map2))(hL))(hJ))(hK)));};dk.correctInnovationGens=function(hI,hJ,hK,hL){function hM(hN,hO,hP){var hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ;hQ=(hR=hP<5?hN.get_Sigma()*0.8:hP>5?hN.get_Sigma()*1.2:hN.get_Sigma(),(hS=hO.pType,hS.$==1?(hT=(hU=10,cw.Compare(hR,hU)===-1?hR:hU),(hV=0.01,cw.Compare(hT,hV)===1?hT:hV)):hS.$==2?be.FailWith("Update of fixed value"):(hW=hO.ub-hO.lb,(hX=0.001*hW,(hY=(hZ=0.5*hW,cw.Compare(hR,hZ)===-1?hR:hZ),cw.Compare(hY,hX)===1?hY:hX)))));return new eB.New(hN.get_Mean(),hQ);}return bW.Map(function(hN,hO){return ck.exists(function(hP){return hN===hP;},hI)?hM(hO,hJ.Item$1(hN),ck.get(hK,hN).accepted):hO;},hL);};dk.evaluateAcceptance=function(hI,hJ,hK,hL,hM,hN,hO,hP){var hQ,hR,hS,hT,hU,hV,hW;hQ=dk.proposeValues(hK,hM,hP,hN);hR=hQ[3];hS=hQ[0];hT=hQ[2];hU=hQ[1];hV=dk.isStateOutOfRange(hU,hS,hK,hO);return hV?[g$.Rejected,hR,hT,hU,hV]:(hW=dk.acceptProposedValues(hJ,hI(hS),dk.lglkPriors(hS,hL),hS,hM,hR),[hW[0],hW[1],hT,hU,hV]);};dk.proposeValues=function(hI,hJ,hK,hL){var hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0,h1,h2,h3,h4,h5;function h6(h8,h9,h_,h$){var ia,ib;ia=h_.nextDouble(h$);ib=ia[0];return[h8.$==1?h9*hC.exp(ib):h8.$==2?be.FailWith("Proposing to update fixed value"):h9+ib,ia[1],ia[2]];}function h7(h8){var h9,h_,h$;h9=function(ia,ib,ic){var id,ie,_if;while(true){id=ib.Microsoft_Research_Filzbach_Lib_IRng$NextDouble();ie=id[1];_if=id[0];if(ic===1)return[new bY({$:1,$0:_if,$1:ia}),ie];else{ia=new bY({$:1,$0:_if,$1:ia});ib=ie;ic=ic-1;}}}(bY.Empty,h8,hO);h_=h9[1];h$=ck.ofList(h9[0]);return ck.exists(function(ia){return ia<h0;},h$)?[ck.map(function(ia){return ia<h0;},h$),h_]:h7(h_);}hM=hJ.values;hN=hJ.values.get__dataArray();hO=ck.length(hI.get__dataArray());return hO===0?[hM,[],hL,hK]:(hP=ck.sub(hN,hO,ck.length(hN)-hO),(hQ=(hR=hK.Microsoft_Research_Filzbach_Lib_IRng$NextDouble(),(hS=hR[1].Microsoft_Research_Filzbach_Lib_IRng$NextDouble(),(hT=hS[1],(hU=hS[0],hR[0]<0.67?(hV=ck.create(hO,null),(hW=hT.Microsoft_Research_Filzbach_Lib_IRng$NextDouble(),(hX=hW[1].Microsoft_Research_Filzbach_Lib_IRng$NextDouble(),(hY=be.toInt(hC.floor(hU*hO)),(hY>0&&hW[0]<0.5?ck.set(hV,hY-1,true):void 0,ck.set(hV,hY,true),hY<hO-1&&hX[0]<0.5?ck.set(hV,hY+1,true):void 0,[hV,hX[1]]))))):(hZ=3/hO,(h0=(h1=hZ*hC.exp(4*(hU-0.5)),h1<0.1*hZ?0.1*hZ:h1>0.99?0.99:h1),h7(hT))))))),(h2=hQ[0],(h3=ck.ofSeq(co.skip(1,co.scan(function(h8,h9){var h_,h$,ia,ib;h_=h8[1];h$=h8[3];ia=h8[2];ib=h9?h6(hI.Item$1(h$).pType,hM.Item$1(h$),ia.get_Item(h$),h_):[ck.get(hN,h$),ia.get_Item(h$),h_];return[ib[0],ib[2],ia.Add(h$,ib[1]),h$+1];},[0,hQ[1],hL,0],h2))),(h4=ck.map(a.fst,h3).concat(hP),(h5=ck.get(h3,ck.length(h3)-1),[hM.CopyWithNewValues(h4),h2,h5[2],h5[1]]))))));};dk.isStateOutOfRange=function(hI,hJ,hK,hL){function hM(hN){var hO,hP;hO=hJ.Item$1(hN);hP=hK.Item$1(hN);return hO<hP.lb||hO>hP.ub;}return ck.exists2(function(hN,hO){return hN&&hM(hO);},hI,hL);};dk.acceptProposedValues=function(hI,hJ,hK,hL,hM,hN){var hO,hP,hQ,hR,hS;hO=(hP=hK+hJ,(hQ=hM.logLikelihood+hM.logPrior,(hR=hN.Microsoft_Research_Filzbach_Lib_IRng$NextDouble(),(hS=hR[1],hP>hQ?[true,hS]:[hP-hQ>hC.log(hR[0]),hS]))));return[hO[0]?{$:0,$0:dj.New(hL,hJ,hK,hI)}:g$.Rejected,hO[1]];};eE.stringOfSummary=function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ,hR;hL="\\u0009";hM="\\r\\n";return hI.$==1?(hN=hI.$0,(hO=eE.getSummary(hN),(hP=hN.mle.values,(hQ=eE.informationCriteria(hN,hK),cS.concat(hM,ck.concat([["Params"+hL+a.String(hO.length),"Free_params"+hL+a.String(ck.filter(function(hS){return hS.range.pType.$!==2;},hO).length),"Burnin"+hL+a.String(hJ.burninLen),"Samples"+hL+a.String(hJ.sampleLen),"Max loglikelihood"+hL+a.String(hN.mle.logLikelihood),"AIC"+hL+a.String(hQ.AIC),"BIC"+hL+a.String(hQ.BIC),"DIC"+hL+a.String(hQ.DIC)],[" ",cS.concat(hL,["Name","Type","Lower Bound","Upper Bound","MLE","Posterior mean","Posterior variance","Posterior l95","Posterior l68","Posterior median","Posterior u68","Posterior u95"])],ck.map(function(hS){return cS.concat(hL,new bY({$:1,$0:hS.name,$1:new bY({$:1,$0:eE.stringOfRange(hS.range.pType),$1:bX.map(a.String,bX.ofArray([hS.range.lb,hS.range.ub,hP.Item(hS.name),hS.summary.mean,hS.summary.variance,hS.qsummary.lb95,hS.qsummary.lb68,hS.qsummary.median,hS.qsummary.ub68,hS.qsummary.ub95]))})}));},hO)])))))):(hR=hI.$0,cS.concat(hM,ck.concat([["Phase: Burn-In"],["Params"+hL+a.String(hR.space.get_Names().length),"Free_params"+hL+a.String(ck.filter(function(hS){return hS.pType.$!==2;},hR.space.ToArray()).length),"Burnin"+hL+a.String(hJ.burninLen),"Samples"+hL+a.String(hJ.sampleLen),"Max loglikelihood"+hL+a.String(hR.mle.logLikelihood)]])));};eE.getSummary=function(hI){var hJ;hJ=eE.extractBayesTable(hI);return ck.length(hJ.get_ColumnNames())<=1?[]:ck.ofSeq(co.delay(function(){return co.map(function(hK){return eE.getParameterSummary(hJ,hI,hK);},co.skip(1,hJ.get_ColumnNames()));}));};eE.informationCriteria=function(hI,hJ){var hK,hL,hM;hK=hI.mle.logLikelihood;hL=ck.length(hI.space.get__dataArray());return fD.New(-2*hK+2*hL,-2*hK+hC.log(hJ)*hL,(hM=eE.extractBayesTable(hI),hM.get_ColumnCount()===0?a.NaN:-1*(-2*hK)+2*ck.average(ck.map(function(hN){return -2*hN;},hM.GetColumn("logLikelihood")))));};eE.stringOfRange=function(hI){return hI.$==1?"log":hI.$==2?"fixed":"real";};eE.extractBayesTable=function(hI){var hJ,hK;hJ=ck.ofSeq(co.map(function(hL){return[hL.logLikelihood].concat(hL.values.get__dataArray());},hI.chain));return ck.length(hJ)===0?new gL.New([],new eU.New([])):(hK=new eU.New(ck.ofSeq(co.delay(function(){return co.append(["logLikelihood"],co.delay(function(){return hI.space.get__namesMap().get_Keys();}));}))),new gL.New(ck.init(ck.length(hI.space.get__namesMap().get_Keys())+1,function(hL){return ck.init(ck.length(hJ),function(hM){return ck.get(ck.get(hJ,hM),hL);});}),hK));};eE.getParameterSummary=function(hI,hJ,hK){var hL,hM;hL=hI.GetColumn(hK);hM=hJ.space.get__namesMap().Item(hK);return fA.New(hK,hJ.mle.values.Item(hK),eE.summary(hL),eE.qsummary(hL),hJ.space.Item$1(hM));};eE.qsummary=function(hI){var hJ,hK;function hL(hM){var hN,hO;hN=hM*(hK+1/3)-2/3;return hN<=0?ck.get(hJ,0):hN>=hK-1?ck.get(hJ,hK-1):(hO=hC.floor(hN),ck.get(hJ,be.toInt(hO))*(1-hN+hO)+ck.get(hJ,be.toInt(hO)+1)*(hN-hO));}hJ=ck.ofSeq(co.filter(function(hM){return!(a.isNaN(hM)||hC.abs(hM)===a.Infinity);},hI));ck.sortInPlace(hJ);hK=ck.length(hJ);return hK<1?fC.New(a.NaN,a.NaN,a.NaN,a.NaN,a.NaN,a.NaN,a.NaN):fC.New(ck.get(hJ,0),hL(0.025),hL(0.16),hL(0.5),hL(0.84),hL(0.975),ck.get(hJ,hK-1));};eE.summary=function(hI){var hJ;hJ=co.fold(function(hK,hL){var hM,hN,hO,hP,hQ;return a.isNaN(hL)||hC.abs(hL)===a.Infinity?hK:(hM=hL-hK.mean,(hN=hK.count+1,(hO=hK.mean+hM/hN,fB.New(hN,(hP=hK.min,cw.Compare(hL,hP)===-1?hL:hP),(hQ=hK.max,cw.Compare(hL,hQ)===1?hL:hQ),hO,hK.variance+hM*(hL-hO)))));},fB.New(0,Infinity,-Infinity,0,0),hI);return hJ.count<2?hJ:fB.New(hJ.count,hJ.min,hJ.max,hJ.mean,hJ.variance/(hJ.count-1));};eF.New=function(hI,hJ,hK,hL,hM,hN){return{burninLen:hI,sampleLen:hJ,thinning:hK,seed:hL,print_console:hM,print_summary:hN};};eG.toString=function(hI){var hJ,hK,hL;return hI.$==1?(hJ=hI.$0,(hK=bX.length(hJ.Attributes)===0?"":" "+cS.Join(" ",ck.ofSeq(co.map(function(hM){return(((hB.Curried3(function(hN,hO,hP){return hN(cA.toSafe(hO)+"=\\""+cA.toSafe(hP)+"\\"");}))(a.id))(hM.Key.$0))(hM.Value.$0);},hJ.Attributes))),(hL=cS.Join("\\n",ck.ofSeq(co.map(eG.toString,co.rev(hJ.Children)))),(((hB.Curried3(function(hM,hN,hO){return hM("<div"+cA.toSafe(hN)+">"+cA.toSafe(hO)+"</div>");}))(a.id))(hK))(hL)))):hI.$==2?(function(hM){return function(hN){return hM("<table class=\'idd-subplots-table\'>"+cA.toSafe(hN)+"</table>");};}(a.id))(cS.Join("\\n",ck.ofSeq(co.map(function(hM){return(function(hN){return function(hO){return hN("<tr>"+cA.toSafe(hO)+"</tr>");};}(a.id))(cS.Join("",ck.ofSeq(co.map(function(hN){return(function(hO){return function(hP){return hO("<td>"+cA.toSafe(hP)+"</td>");};}(a.id))(eG.toString(hN.$0));},co.rev(hM.$0)))));},co.rev(hI.$0.$0))))):hI.$==3?"":hI.$0.$0;};eG.createDiv=function(){return fE.New(bY.Empty,bY.Empty);};eG.addDiv=function(hI,hJ){return fE.New(hJ.Attributes,new bY({$:1,$0:{$:1,$0:hI},$1:hJ.Children}));};eG.addText=function(hI,hJ){return fE.New(hJ.Attributes,new bY({$:1,$0:{$:0,$0:eG.guardText(hI)},$1:hJ.Children}));};eG.addAttribute=function(hI,hJ,hK){return fE.New(new bY({$:1,$0:fF.New(eG.guardAttrName(hI),eG.guardAttrValue(hJ)),$1:hK.Attributes}),hK.Children);};eG.addTable=function(hI,hJ){return fE.New(hJ.Attributes,new bY({$:1,$0:{$:2,$0:hI},$1:hJ.Children}));};eG.guardText=function(hI){return{$:0,$0:cS.Replace(cS.Replace(hI,">","&gt;"),"<","&lt;")};};eG.guardAttrName=function(hI){var hJ;hJ=["-"];if(ck.exists(function(hK){return!(fw.IsLetterOrDigit(hK)||ck.contains(hK,hJ));},cS.ToCharArray(hI)))throw new fY.New$2((((hB.Curried3(function(hK,hL,hM){return hK("the string must contain only letters, digits or "+cA.printArray(cA.prettyPrint,hL)+", but "+cA.toSafe(hM)+" was passed");}))(a.id))(hJ))(hI));else null;return{$:0,$0:hI};};eG.guardAttrValue=function(hI){return{$:0,$0:cS.Replace(cS.Replace(hI,"\\\\","\\\\\\\\"),"\\"","\\\\\\"")};};eH.toHtmlStructure=function(hI){var hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0;hJ=eG.createDiv();hK=eH.addVisibleRegionInfo(hI.VisibleRegion,bW.OfArray(ck.ofSeq(bX.ofArray([["class","fsharp-idd"],["data-idd-plot","figure"],["style",(((hB.Curried3(function(h1,h2,h3){return h1("width: "+a.String(h2)+"px; height: "+a.String(h3)+"px;");}))(a.id))(hI.Width))(hI.Height)]]))),new cj.New([]));hL=eH.axisToHtmlStructure(hI.Yaxis,fG.Left);hM=hL==null?[hJ,null]:[eG.addDiv(hL.$0[0],hJ),{$:1,$0:hL.$0[1]}];hN=hM[0];hO=hI.Ylabel!==null?eG.addDiv(eH.vertAxisLabelToHtmlStructue(hI.Ylabel,fG.Left),hN):hN;hP=eH.axisToHtmlStructure(hI.Xaxis,fG.Bottom);hQ=hP==null?[hO,null]:[eG.addDiv(hP.$0[0],hO),{$:1,$0:hP.$0[1]}];hR=hQ[0];hS=hI.Xlabel!==null?eG.addDiv(eH.horAxisLabelToHtmlStructure(hI.Xlabel,fG.Bottom),hR):hR;hT=!hI.IsTooltipPlotCoordsEnabled?hK[1].Add("isLegendVisible",eH.getEffectiveLegendvisibility(hI.IsLegendEnabled,hI.Plots)?"true":"false").Add("suppress-tooltip-coords","true"):hK[1].Add("isLegendVisible",eH.getEffectiveLegendvisibility(hI.IsLegendEnabled,hI.Plots)?"true":"false");hU=hK[0].Add("data-idd-navigation-enabled",hI.IsNavigationEnabled?"true":"false");hV=eH.gridLinesToHtmlStructure(hI.GridLines,hQ[1],hM[1],hI.Title!==null?(hW=eG.addText(hI.Title,eG.createDiv()),eG.addDiv(eH.addAttributes((new cj.New([])).Add("class","idd-title").Add("data-idd-placement","top"),hW),hS)):hS);hX=(hY=hI.TooltipDelay,hY==null?hT:hT.Add("tooltipDelay",(function(h1){return function(h2){return h1(h2.toFixed(6));};}(a.id))(hY.$0)));hZ=co.fold(function(h1,h2){return eG.addDiv(h2,h1);},hV,co.map(eH.plotToDiv,hI.Plots));h0=eH.createStyleAttributes(hX);return{$:1,$0:eH.addAttributes(hU.Add(h0[0],h0[1]),hZ)};};eH.addVisibleRegionInfo=function(hI,hJ,hK){return hI.$==1?[hJ.Add("data-idd-visible-region",(((((hB.Curried(function(hL,hM,hN,hO,hP){return hL(hM.toFixed(6)+" "+hN.toFixed(6)+" "+hO.toFixed(6)+" "+hP.toFixed(6));},5))(a.id))(hI.$0))(hI.$2))(hI.$1))(hI.$3)),hK]:[hJ,hK.Add("padding",(function(hL){return function(hM){return hL(a.String(hM));};}(a.id))(hI.$0))];};eH.axisToHtmlStructure=function(hI,hJ){var hK,hL,hM,hN,hO,hP,hQ,hR,hS;return hI.$==1?(hK=hC.floor((new hF()).valueOf()*hC.random()).toString(),{$:1,$0:[hI.$0?eG.addAttribute("data-idd-scientific-notation","true",eG.addAttribute("style","position: relative;",(hL=eG.addAttribute("data-idd-axis","numeric",eG.addAttribute("id",hK,eG.createDiv())),eG.addAttribute("data-idd-placement",eH.placementToStr(hJ),hL)))):eG.addAttribute("style","position: relative;",(hL=eG.addAttribute("data-idd-axis","numeric",eG.addAttribute("id",hK,eG.createDiv())),eG.addAttribute("data-idd-placement",eH.placementToStr(hJ),hL))),hK]}):hI.$==2?(hM=hI.$0,(hN=hC.floor((new hF()).valueOf()*hC.random()).toString(),(hO=(hP=eG.addAttribute("data-idd-datasource","InteractiveDataDisplay.readBase64",eG.addAttribute("data-idd-style",hM.Angle===0?"":"rotate: true; rotateAngle: "+(function(hT){return function(hU){return hT(hU.toFixed(6)+";");};}(a.id))(hM.Angle),eG.addAttribute("style","position: relative;",(hQ=eG.addAttribute("data-idd-axis","labels",eG.addAttribute("id",hN,eG.createDiv())),eG.addAttribute("data-idd-placement",eH.placementToStr(hJ),hQ))))),eG.addText((hR=ck.ofSeq(hM.Ticks),(hS=ck.ofSeq(hM.Labels).map(a.btoa).join(","),(((hB.Curried3(function(hT,hU,hV){return hT("ticks float64.1D "+cA.toSafe(hU)+"\\nlabels string.1D "+cA.toSafe(hV));}))(a.id))(a.btoa((new a.Uint8Array(hG.from(hR).buffer)).reduce(function(hT,hU){return hT+hH.fromCharCode(hU);},""))))(hS))),hP)),{$:1,$0:[hM.ForceLabelsVisibility?eG.addAttribute("data-idd-force-labels-visibility","true",hM.Angle===0?hO:eG.addAttribute("data-idd-style","rotate: true; rotateAngle: "+(function(hT){return function(hU){return hT(hU.toFixed(6)+";");};}(a.id))(hM.Angle),hO)):hM.Angle===0?hO:eG.addAttribute("data-idd-style","rotate: true; rotateAngle: "+(function(hT){return function(hU){return hT(hU.toFixed(6)+";");};}(a.id))(hM.Angle),hO),hN]}))):null;};eH.vertAxisLabelToHtmlStructue=function(hI,hJ){var hK,hL;hK=hJ.$==3||(hJ.$==0?false:hJ.$!=1)?eH.placementToStr(hJ):be.FailWith("wrong placement");return eG.addDiv(eG.addText(hI,eG.addAttribute("class","idd-verticalTitle-inner",eG.createDiv())),eG.addAttribute("data-idd-placement",hK,eG.addAttribute("class","idd-verticalTitle",eG.createDiv())));};eH.horAxisLabelToHtmlStructure=function(hI,hJ){var hK;return eG.addText(hI,eG.addAttribute("data-idd-placement",hJ.$==3||(hJ.$==0?false:hJ.$!=1)?be.FailWith("wrong placement"):eH.placementToStr(hJ),eG.addAttribute("class","idd-horizontalTitle",eG.createDiv())));};eH.createStyleAttributes=function(hI){return["data-idd-style",bW.Fold(function(hJ,hK,hL){return hJ+hK+": "+hL+"; ";},"",hI)];};eH.addAttributes=function(hI,hJ){return bW.Fold(function(hK,hL,hM){return eG.addAttribute(hL,hM,hK);},hJ,hI);};eH.plotToDiv=function(hI){return hI.$==1?eH.markersToDiv(hI.$0):hI.$==2?eH.barchartToDiv(hI.$0):hI.$==3?eH.histogramToDiv(hI.$0):hI.$==4?eH.heatmapToDiv(hI.$0):eH.polylineToDiv(hI.$0);};eH.gridLinesToHtmlStructure=function(hI,hJ,hK,hL){var hM,hN,hO;return hI.$==0?hL:(hM=hI.$0,eG.addDiv(hK==null?hJ==null?(hN=bX.ofArray([(function(hP){return function(hQ){return hP("thickness: "+hQ.toFixed(1)+"px");};}(a.id))(hI.$1)]),eG.addAttribute("data-idd-style",cS.Join("; ",ck.ofSeq(hM.$==0?hN:(hO=hM.$0,new bY({$:1,$0:((((hB.Curried(function(hP,hQ,hR,hS){return hP("stroke: rgb("+hH(hQ)+","+hH(hR)+","+hH(hS)+")");},4))(a.id))(hO.R))(hO.G))(hO.B),$1:hN})))),eG.addAttribute("data-idd-placement","center",eG.addAttribute("data-idd-plot","grid",eG.createDiv())))):eG.addAttribute("data-idd-xaxis",hJ.$0,(hN=bX.ofArray([(function(hP){return function(hQ){return hP("thickness: "+hQ.toFixed(1)+"px");};}(a.id))(hI.$1)]),eG.addAttribute("data-idd-style",cS.Join("; ",ck.ofSeq(hM.$==0?hN:(hO=hM.$0,new bY({$:1,$0:((((hB.Curried(function(hP,hQ,hR,hS){return hP("stroke: rgb("+hH(hQ)+","+hH(hR)+","+hH(hS)+")");},4))(a.id))(hO.R))(hO.G))(hO.B),$1:hN})))),eG.addAttribute("data-idd-placement","center",eG.addAttribute("data-idd-plot","grid",eG.createDiv()))))):eG.addAttribute("data-idd-yaxis",hK.$0,hJ==null?(hN=bX.ofArray([(function(hP){return function(hQ){return hP("thickness: "+hQ.toFixed(1)+"px");};}(a.id))(hI.$1)]),eG.addAttribute("data-idd-style",cS.Join("; ",ck.ofSeq(hM.$==0?hN:(hO=hM.$0,new bY({$:1,$0:((((hB.Curried(function(hP,hQ,hR,hS){return hP("stroke: rgb("+hH(hQ)+","+hH(hR)+","+hH(hS)+")");},4))(a.id))(hO.R))(hO.G))(hO.B),$1:hN})))),eG.addAttribute("data-idd-placement","center",eG.addAttribute("data-idd-plot","grid",eG.createDiv())))):eG.addAttribute("data-idd-xaxis",hJ.$0,(hN=bX.ofArray([(function(hP){return function(hQ){return hP("thickness: "+hQ.toFixed(1)+"px");};}(a.id))(hI.$1)]),eG.addAttribute("data-idd-style",cS.Join("; ",ck.ofSeq(hM.$==0?hN:(hO=hM.$0,new bY({$:1,$0:((((hB.Curried(function(hP,hQ,hR,hS){return hP("stroke: rgb("+hH(hQ)+","+hH(hR)+","+hH(hS)+")");},4))(a.id))(hO.R))(hO.G))(hO.B),$1:hN})))),eG.addAttribute("data-idd-placement","center",eG.addAttribute("data-idd-plot","grid",eG.createDiv())))))),hL));};eH.getEffectiveLegendvisibility=function(hI,hJ){return hI.$==2?false:hI.$==1?bX.exists(function(hK){return hK.$==1?hK.$0.Name!==null:hK.$==2?hK.$0.Name!==null:hK.$==3?hK.$0.Name!==null:hK.$==4?hK.$0.Name!==null:hK.$0.Name!==null;},hJ):true;};eH.placementToStr=function(hI){return hI.$==0?"bottom":hI.$==2?"left":hI.$==3?"right":"top";};eH.markersToDiv=function(hI){var hJ,hK,hL,hM,hN,hO,hP,hQ,hR;hJ=bX.ofArray([(function(hS){return function(hT){return hS("size: "+hT.toFixed(1));};}(a.id))(hI.Size)]);hK=(hL=hI.FillColour,hL.$==0?hJ:(hM=hL.$0,new bY({$:1,$0:((((hB.Curried(function(hS,hT,hU,hV){return hS("color: rgb("+hH(hT)+","+hH(hU)+","+hH(hV)+")");},4))(a.id))(hM.R))(hM.G))(hM.B),$1:hJ})));hN=(hO=hI.BorderColour,hO.$==0?hK:(hP=hO.$0,new bY({$:1,$0:((((hB.Curried(function(hS,hT,hU,hV){return hS("border: rgb("+hH(hT)+","+hH(hU)+","+hH(hV)+")");},4))(a.id))(hP.R))(hP.G))(hP.B),$1:hK})));return cS.IsNullOrEmpty(hI.Name)?(hQ=eG.addAttribute("data-idd-datasource","InteractiveDataDisplay.readBase64",eG.addAttribute("data-idd-style",cS.Join("; ",ck.ofSeq(new bY({$:1,$0:(function(hS){return function(hT){return hS("shape: "+cA.toSafe(hT));};}(a.id))((hR=hI.Shape,hR.$==1?"circle":hR.$==3?"cross":hR.$==2?"diamond":hR.$==4?"triangle":"box")),$1:hN}))),eG.addAttribute("data-idd-plot","markers",eG.createDiv()))),eG.addText(eH.getXYDataDom(hI.X,hI.Y),hQ)):eG.addAttribute("data-idd-name",hI.Name,(hQ=eG.addAttribute("data-idd-datasource","InteractiveDataDisplay.readBase64",eG.addAttribute("data-idd-style",cS.Join("; ",ck.ofSeq(new bY({$:1,$0:(function(hS){return function(hT){return hS("shape: "+cA.toSafe(hT));};}(a.id))((hR=hI.Shape,hR.$==1?"circle":hR.$==3?"cross":hR.$==2?"diamond":hR.$==4?"triangle":"box")),$1:hN}))),eG.addAttribute("data-idd-plot","markers",eG.createDiv()))),eG.addText(eH.getXYDataDom(hI.X,hI.Y),hQ)));};eH.barchartToDiv=function(hI){var hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU;hJ=bX.ofArray([(function(hV){return function(hW){return hV("barWidth: "+hW.toFixed(6));};}(a.id))(hI.BarWidth)]);hK=(hL=hI.FillColour,hL.$==0?hJ:(hM=hL.$0,new bY({$:1,$0:((((hB.Curried(function(hV,hW,hX,hY){return hV("color: rgb("+hH(hW)+","+hH(hX)+","+hH(hY)+")");},4))(a.id))(hM.R))(hM.G))(hM.B),$1:hJ})));hN=(hO=hI.BorderColour,hO.$==0?hK:(hP=hO.$0,new bY({$:1,$0:((((hB.Curried(function(hV,hW,hX,hY){return hV("border: rgb("+hH(hW)+","+hH(hX)+","+hH(hY)+")");},4))(a.id))(hP.R))(hP.G))(hP.B),$1:hK})));hQ=(hR=hI.Shadow,hR.$==0?hN:(hS=hR.$0,hS.$==0?new bY({$:1,$0:"shadow: grey",$1:hN}):(hT=hS.$0,new bY({$:1,$0:((((hB.Curried(function(hV,hW,hX,hY){return hV("shadow: rgb("+hH(hW)+","+hH(hX)+","+hH(hY)+")");},4))(a.id))(hT.R))(hT.G))(hT.B),$1:hN}))));return cS.IsNullOrEmpty(hI.Name)?(hU=eG.addAttribute("data-idd-datasource","InteractiveDataDisplay.readBase64",eG.addAttribute("data-idd-style",cS.Join("; ",ck.ofSeq(new bY({$:1,$0:function(hV){return hV("shape: bars");}(a.id),$1:hQ}))),eG.addAttribute("data-idd-plot","markers",eG.createDiv()))),eG.addText(eH.getXYDataDom(hI.BarCenters,hI.BarHeights),hU)):eG.addAttribute("data-idd-name",hI.Name,(hU=eG.addAttribute("data-idd-datasource","InteractiveDataDisplay.readBase64",eG.addAttribute("data-idd-style",cS.Join("; ",ck.ofSeq(new bY({$:1,$0:function(hV){return hV("shape: bars");}(a.id),$1:hQ}))),eG.addAttribute("data-idd-plot","markers",eG.createDiv()))),eG.addText(eH.getXYDataDom(hI.BarCenters,hI.BarHeights),hU)));};eH.histogramToDiv=function(hI){var hJ;return eH.barchartToDiv((hJ=hb.buildHistogram(hI.Samples,hI.BinCount),gP.New(hI.Name,ck.ofList(hJ.BinCentres),ck.ofSeq(co.map(a.id,hJ.BinCounters)),hJ.BinWidth,hI.Colour,hI.Colour,hd.WithoutShadow)));};eH.heatmapToDiv=function(hI){var hJ,hK,hL,hM,hN,hO,hP;hJ=bX.ofArray([(function(hQ){return function(hR){return hQ("opacity: "+hR.toFixed(6));};}(a.id))(hI.Opacity)]);return cS.IsNullOrEmpty(hI.Name)?(hK=eG.addAttribute("data-idd-datasource","InteractiveDataDisplay.readBase64",eG.addAttribute("data-idd-style",cS.Join("; ",ck.ofSeq((hL=hI.Palette,hL.$==1?hJ:new bY({$:1,$0:(function(hQ){return function(hR){return hQ("colorPalette: "+cA.toSafe(hR));};}(a.id))(hL.$0),$1:hJ})))),eG.addAttribute("data-idd-plot","heatmap",eG.createDiv()))),eG.addText((hM=hI.Data,(hN=hM.length,(hO=hM.length?hM[0].length:0,(hP=ck.ofSeq(co.delay(function(){return co.collect(function(hQ){return co.map(function(hR){return ck.get2D(hM,hQ,hR);},be.range(0,hO-1));},be.range(0,hN-1));})),(((((hB.Curried(function(hQ,hR,hS,hT,hU){return hQ("x float64.1D "+cA.toSafe(hR)+"\\ny float64.1D "+cA.toSafe(hS)+"\\nvalues float64.2D "+hH(hT)+" "+cA.toSafe(hU));},5))(a.id))(a.btoa((new a.Uint8Array(hG.from(ck.ofSeq(hI.X)).buffer)).reduce(function(hQ,hR){return hQ+hH.fromCharCode(hR);},""))))(a.btoa((new a.Uint8Array(hG.from(ck.ofSeq(hI.Y)).buffer)).reduce(function(hQ,hR){return hQ+hH.fromCharCode(hR);},""))))(hO))(a.btoa((new a.Uint8Array(hG.from(ck.ofSeq(hP)).buffer)).reduce(function(hQ,hR){return hQ+hH.fromCharCode(hR);},""))))))),hK)):eG.addAttribute("data-idd-name",hI.Name,(hK=eG.addAttribute("data-idd-datasource","InteractiveDataDisplay.readBase64",eG.addAttribute("data-idd-style",cS.Join("; ",ck.ofSeq((hL=hI.Palette,hL.$==1?hJ:new bY({$:1,$0:(function(hQ){return function(hR){return hQ("colorPalette: "+cA.toSafe(hR));};}(a.id))(hL.$0),$1:hJ})))),eG.addAttribute("data-idd-plot","heatmap",eG.createDiv()))),eG.addText((hM=hI.Data,(hN=hM.length,(hO=hM.length?hM[0].length:0,(hP=ck.ofSeq(co.delay(function(){return co.collect(function(hQ){return co.map(function(hR){return ck.get2D(hM,hQ,hR);},be.range(0,hO-1));},be.range(0,hN-1));})),(((((hB.Curried(function(hQ,hR,hS,hT,hU){return hQ("x float64.1D "+cA.toSafe(hR)+"\\ny float64.1D "+cA.toSafe(hS)+"\\nvalues float64.2D "+hH(hT)+" "+cA.toSafe(hU));},5))(a.id))(a.btoa((new a.Uint8Array(hG.from(ck.ofSeq(hI.X)).buffer)).reduce(function(hQ,hR){return hQ+hH.fromCharCode(hR);},""))))(a.btoa((new a.Uint8Array(hG.from(ck.ofSeq(hI.Y)).buffer)).reduce(function(hQ,hR){return hQ+hH.fromCharCode(hR);},""))))(hO))(a.btoa((new a.Uint8Array(hG.from(ck.ofSeq(hP)).buffer)).reduce(function(hQ,hR){return hQ+hH.fromCharCode(hR);},""))))))),hK)));};eH.polylineToDiv=function(hI){var hJ,hK,hL,hM,hN,hO,hP,hQ;hJ=bX.ofArray([(function(hR){return function(hS){return hR("thickness: "+hS.toFixed(1));};}(a.id))(hI.Thickness)]);hK=(hL=hI.Colour,hL.$==0?hJ:(hM=hL.$0,new bY({$:1,$0:((((hB.Curried(function(hR,hS,hT,hU){return hR("stroke: rgb("+hH(hS)+","+hH(hT)+","+hH(hU)+")");},4))(a.id))(hM.R))(hM.G))(hM.B),$1:hJ})));hN=new bY({$:1,$0:(function(hR){return function(hS){return hR("lineJoin: "+cA.toSafe(hS));};}(a.id))((hO=hI.LineJoin,hO.$==0?"bevel":hO.$==1?"round":"miter")),$1:hK});return cS.IsNullOrEmpty(hI.Name)?(hP=eG.addAttribute("data-idd-datasource","InteractiveDataDisplay.readBase64",eG.addAttribute("data-idd-style",cS.Join("; ",ck.ofSeq(new bY({$:1,$0:(function(hR){return function(hS){return hR("lineCap: "+cA.toSafe(hS));};}(a.id))((hQ=hI.LineCap,hQ.$==1?"round":hQ.$==2?"square":"butt")),$1:hN}))),eG.addAttribute("data-idd-plot","polyline",eG.createDiv()))),eG.addText(eH.getXYDataDom(hI.X,hI.Y),hP)):eG.addAttribute("data-idd-name",hI.Name,(hP=eG.addAttribute("data-idd-datasource","InteractiveDataDisplay.readBase64",eG.addAttribute("data-idd-style",cS.Join("; ",ck.ofSeq(new bY({$:1,$0:(function(hR){return function(hS){return hR("lineCap: "+cA.toSafe(hS));};}(a.id))((hQ=hI.LineCap,hQ.$==1?"round":hQ.$==2?"square":"butt")),$1:hN}))),eG.addAttribute("data-idd-plot","polyline",eG.createDiv()))),eG.addText(eH.getXYDataDom(hI.X,hI.Y),hP)));};eH.getXYDataDom=function(hI,hJ){return(((hB.Curried3(function(hK,hL,hM){return hK("x float64.1D "+cA.toSafe(hL)+"\\ny float64.1D "+cA.toSafe(hM));}))(a.id))(a.btoa((new a.Uint8Array(hG.from(ck.ofSeq(hI)).buffer)).reduce(function(hK,hL){return hK+hH.fromCharCode(hL);},""))))(a.btoa((new a.Uint8Array(hG.from(ck.ofSeq(hJ)).buffer)).reduce(function(hK,hL){return hK+hH.fromCharCode(hL);},"")));};eI.setTitle=function(hI,hJ){return fH.New(hI===null?null:{$:1,$0:hI},hJ.Charts,hJ.PlotWidth,hJ.PlotHeight,hJ.RowsCount,hJ.ColumnsCount,hJ.ExternalLegendSource,hJ.Margin,hJ.CommonVisibility,hJ.SyncHorizontalAxes,hJ.SyncVerticalAxes);};eI.createSubplots=function(hI,hJ,hK){var hL,hM;hL=be.range(0,hJ-1);hM=co.concat(co.map(function(hN){return co.map(function(hO){return[hN,hO];},hL);},be.range(0,hI-1)));return fH.New(null,co.fold(function(hN,hO){return hN.Add(hO,hK(hO[0],hO[1]));},new cj.New([]),hM),300,200,hI,hJ,null,{$:1,$0:20},true,null,null);};eI.setSubplotSize=function(hI,hJ,hK){return fH.New(hK.Title,hK.Charts,hI,hJ,hK.RowsCount,hK.ColumnsCount,hK.ExternalLegendSource,hK.Margin,hK.CommonVisibility,hK.SyncHorizontalAxes,hK.SyncVerticalAxes);};eI.subplotsToHtmlStructure=function(hI){var hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV;hJ=eI.slotGridToHtmlStructure(hI.PlotWidth,hI.PlotHeight,eI.subplotsToSlotGrid(hI));hK=eG.addAttribute("class","idd-subplots",eG.createDiv());hL=(hM=hI.Title,hM==null?hK:eG.addDiv(eG.addAttribute("class","idd-subplots-title",eG.addText(hM.$0,eG.createDiv())),hK));hN=eG.addAttribute("class","idd-subplots-legendholder",eG.createDiv());hO=(hP=eG.addTable(hJ,(hQ=hI.ExternalLegendSource,hQ==null?hN:eG.addAttribute("data-idd-ext-legend",((((hB.Curried(function(hW,hX,hY,hZ){return hW(cA.toSafe(hX)+" "+hH(hY)+" "+hH(hZ));},4))(a.id))(eH.placementToStr(hQ.$0[2])))(hQ.$0[0]))(hQ.$0[1]),hN))),eG.addAttribute("data-idd-common-visibility",(function(hW){return function(hX){return hW(hH(hX));};}(a.id))(hI.CommonVisibility),hP));hR=(hS=hI.Margin,hS==null?hO:eG.addAttribute("data-idd-style",(function(hW){return function(hX){return hW("subplots-margin: "+hH(hX)+"px; ");};}(a.id))(hS.$0),hO));hT=(hU=hI.SyncHorizontalAxes,hU==null?hR:eG.addAttribute("data-idd-horizontal-binding",(function(hW){return function(hX){return hW(hH(hX));};}(a.id))(hU.$0),hR));return{$:1,$0:eG.addDiv((hV=hI.SyncVerticalAxes,hV==null?hT:eG.addAttribute("data-idd-vertical-binding",(function(hW){return function(hX){return hW(hH(hX));};}(a.id))(hV.$0),hT)),hL)};};eI.slotGridToHtmlStructure=function(hI,hJ,hK){var hL,hM;hL=hK.length;hM=hK.length?hK[0].length:0;return{$:0,$0:bX.ofSeq(co.rev(co.map(function(hN){return{$:0,$0:bX.ofSeq(co.rev(co.map(function(hO){return{$:0,$0:eI.slotToHtmlStructure(hI,hJ,ck.get2D(hK,hN,hO))};},be.range(0,hM-1))))};},be.range(0,hL-1))))};};eI.subplotsToSlotGrid=function(hI){var hJ,hK,hL,hM,hN,hO;hJ=hI.RowsCount;hK=hI.ColumnsCount;hL=(hM=hK*3,(hN=ha.Empty,(hO=ck.init(hJ*3,function(){return ck.create(hM,hN);}),(hO.dims=2,hO))));co.iter(function(hP){co.iter(function(hQ){var hR,hS;hR=hI.Charts.get_Item([hP,hQ]);hR==null?void 0:(hS=hR.$0,ck.set2D(hL,hP*3+1,hQ*3+1,{$:0,$0:eI.chartToBareChart(hS)}),hS.Title!==null?ck.set2D(hL,hP*3,hQ*3+1,{$:2,$0:hS.Title}):void 0,ck.set2D(hL,hP*3+1,hQ*3,{$:1,$0:hS.Yaxis,$1:fG.Left,$2:hS.Ylabel}),ck.set2D(hL,hP*3+2,hQ*3+1,{$:1,$0:hS.Xaxis,$1:fG.Bottom,$2:hS.Xlabel}));},be.range(0,hK-1));},be.range(0,hJ-1));return hL;};eI.slotToHtmlStructure=function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU;function hV(hX){var hY,hZ,h0;return hL!==null?eG.addDiv(hM.$==3||(hM.$==1?false:hM.$!=0)?(hZ=eH.vertAxisLabelToHtmlStructue(hL,hM),eG.addAttribute("style",(function(h1){return function(h2){return h1("height: "+hH(h2)+"px; position: relative;");};}(a.id))(hJ),hZ)):(h0=eH.horAxisLabelToHtmlStructure(hL,hM),eG.addAttribute("style",(function(h1){return function(h2){return h1("width: "+hH(h2)+"px;");};}(a.id))(hI),h0)),hX):hX;}function hW(hX){var hY,hZ,h0;hY=eH.axisToHtmlStructure(hN,hM);return hY==null?hX:(hZ=hY.$0[0],eG.addDiv(hM.$==3?eG.addAttribute("class","idd-subplots-slot-right",hM.$==3||(hM.$==1?false:hM.$!=0)?eG.addAttribute("style",(function(h1){return function(h2){return h1("height: "+hH(h2)+"px;");};}(a.id))(hJ),hZ):eG.addAttribute("style",(function(h1){return function(h2){return h1("width: "+hH(h2)+"px;");};}(a.id))(hI),hZ)):hM.$==1?eG.addAttribute("class","idd-subplots-slot-top",hM.$==3||(hM.$==1?false:hM.$!=0)?eG.addAttribute("style",(function(h1){return function(h2){return h1("height: "+hH(h2)+"px;");};}(a.id))(hJ),hZ):eG.addAttribute("style",(function(h1){return function(h2){return h1("width: "+hH(h2)+"px;");};}(a.id))(hI),hZ)):hM.$==0?eG.addAttribute("class","idd-subplots-slot-bottom",hM.$==3||(hM.$==1?false:hM.$!=0)?eG.addAttribute("style",(function(h1){return function(h2){return h1("height: "+hH(h2)+"px;");};}(a.id))(hJ),hZ):eG.addAttribute("style",(function(h1){return function(h2){return h1("width: "+hH(h2)+"px;");};}(a.id))(hI),hZ)):eG.addAttribute("class","idd-subplots-slot-left",hM.$==3||(hM.$==1?false:hM.$!=0)?eG.addAttribute("style",(function(h1){return function(h2){return h1("height: "+hH(h2)+"px;");};}(a.id))(hJ),hZ):eG.addAttribute("style",(function(h1){return function(h2){return h1("width: "+hH(h2)+"px;");};}(a.id))(hI),hZ)),hX));}return hK.$==1?(hL=hK.$2,(hM=hK.$1,(hN=hK.$0,(hO=eG.createDiv(),{$:1,$0:hM.$==2?eG.addAttribute("class","idd-subplots-margin-left",hW(hV(eG.addAttribute("style",(function(hX){return function(hY){return hX("height: "+hH(hY)+"px; display: flex; justify-content: flex-end;");};}(a.id))(hJ),hO)))):hM.$==0?eG.addAttribute("class","idd-subplots-margin-bottom",hV(hW(eG.addAttribute("style",(function(hX){return function(hY){return hX("width: "+hH(hY)+"px; display: flex; flex-direction: column; justify-content: flex-start; margin-left: auto; margin-right: auto;");};}(a.id))(hI),hO)))):be.FailWith("Not supported exception")})))):hK.$==0?(hP=hK.$0,(hQ=eH.addVisibleRegionInfo(hP.VisibleRegion,(new cj.New([])).Add("data-idd-plot","plot").Add("class","idd-subplot").Add("style",(((hB.Curried3(function(hX,hY,hZ){return hX("height: "+hH(hY)+"px; width: "+hH(hZ)+"px;");}))(a.id))(hJ))(hI)),new cj.New([])),(hR=co.fold(function(hX,hY){return eG.addDiv(eH.plotToDiv(hY),hX);},eH.gridLinesToHtmlStructure(hP.GridLines,null,null,eG.addDiv(eG.addAttribute("data-idd-plot","subplots-trap",eG.createDiv()),eG.createDiv())),hP.Plots),(hS=hQ[1].Add("isLegendVisible",eH.getEffectiveLegendvisibility(hP.IsLegendEnabled,hP.Plots)?"true":"false"),(hT=hQ[0].Add("data-idd-navigation-enabled",hP.IsNavigationEnabled?"true":"false"),(hU=eH.createStyleAttributes(hS),{$:1,$0:eH.addAttributes(hT.Add(hU[0],hU[1]),hR)})))))):hK.$==2?{$:1,$0:eG.addAttribute("class","idd-subplot-title",eG.addText(hK.$0,eG.createDiv()))}:gM.Empty;};eI.chartToBareChart=function(hI){return hn.New(hI.GridLines,hI.Plots,hI.IsLegendEnabled,hI.IsNavigationEnabled,hI.IsTooltipPlotCoordsEnabled,hI.VisibleRegion);};eJ.Empty=function(){fI.$cctor();return fI.Empty;};eJ.addPolyline=function(hI,hJ){return eL.New(hJ.Width,hJ.Height,hJ.Title,hJ.Xlabel,hJ.Xaxis,hJ.Ylabel,hJ.Yaxis,hJ.GridLines,new bY({$:1,$0:{$:0,$0:hI},$1:hJ.Plots}),hJ.IsLegendEnabled,hJ.IsNavigationEnabled,hJ.IsTooltipPlotCoordsEnabled,hJ.VisibleRegion,hJ.TooltipDelay);};eJ.addMarkers=function(hI,hJ){return eL.New(hJ.Width,hJ.Height,hJ.Title,hJ.Xlabel,hJ.Xaxis,hJ.Ylabel,hJ.Yaxis,hJ.GridLines,new bY({$:1,$0:{$:1,$0:hI},$1:hJ.Plots}),hJ.IsLegendEnabled,hJ.IsNavigationEnabled,hJ.IsTooltipPlotCoordsEnabled,hJ.VisibleRegion,hJ.TooltipDelay);};eJ.setXlabel=function(hI,hJ){return eL.New(hJ.Width,hJ.Height,hJ.Title,hI,hJ.Xaxis,hJ.Ylabel,hJ.Yaxis,hJ.GridLines,hJ.Plots,hJ.IsLegendEnabled,hJ.IsNavigationEnabled,hJ.IsTooltipPlotCoordsEnabled,hJ.VisibleRegion,hJ.TooltipDelay);};eJ.setYlabel=function(hI,hJ){return eL.New(hJ.Width,hJ.Height,hJ.Title,hJ.Xlabel,hJ.Xaxis,hI,hJ.Yaxis,hJ.GridLines,hJ.Plots,hJ.IsLegendEnabled,hJ.IsNavigationEnabled,hJ.IsTooltipPlotCoordsEnabled,hJ.VisibleRegion,hJ.TooltipDelay);};eJ.setTitle=function(hI,hJ){return eL.New(hJ.Width,hJ.Height,hI,hJ.Xlabel,hJ.Xaxis,hJ.Ylabel,hJ.Yaxis,hJ.GridLines,hJ.Plots,hJ.IsLegendEnabled,hJ.IsNavigationEnabled,hJ.IsTooltipPlotCoordsEnabled,hJ.VisibleRegion,hJ.TooltipDelay);};eJ.setVisibleRegion=function(hI,hJ){return eL.New(hJ.Width,hJ.Height,hJ.Title,hJ.Xlabel,hJ.Xaxis,hJ.Ylabel,hJ.Yaxis,hJ.GridLines,hJ.Plots,hJ.IsLegendEnabled,hJ.IsNavigationEnabled,hJ.IsTooltipPlotCoordsEnabled,hI,hJ.TooltipDelay);};eJ.addHeatmap=function(hI,hJ){return eL.New(hJ.Width,hJ.Height,hJ.Title,hJ.Xlabel,hJ.Xaxis,hJ.Ylabel,hJ.Yaxis,hJ.GridLines,new bY({$:1,$0:{$:4,$0:hI},$1:hJ.Plots}),hJ.IsLegendEnabled,hJ.IsNavigationEnabled,hJ.IsTooltipPlotCoordsEnabled,hJ.VisibleRegion,hJ.TooltipDelay);};eJ.createLabelledAxis=function(hI,hJ){return{$:2,$0:fK.New(hI,hJ,0,false)};};eJ.createTiltedLabelledAxis=function(hI,hJ,hK){return{$:2,$0:fK.New(hI,hJ,hK,false)};};eJ.setXaxis=function(hI,hJ){return eL.New(hJ.Width,hJ.Height,hJ.Title,hJ.Xlabel,hI,hJ.Ylabel,hJ.Yaxis,hJ.GridLines,hJ.Plots,hJ.IsLegendEnabled,hJ.IsNavigationEnabled,hJ.IsTooltipPlotCoordsEnabled,hJ.VisibleRegion,hJ.TooltipDelay);};eJ.setLabelsVisibility=function(hI,hJ){var hK;return hJ.$==2?(hK=hJ.$0,{$:2,$0:fK.New(hK.Ticks,hK.Labels,hK.Angle,hI)}):be.FailWith("Force labels visibility can be set only on a labelled axis");};eJ.addHistogram=function(hI,hJ){return eL.New(hJ.Width,hJ.Height,hJ.Title,hJ.Xlabel,hJ.Xaxis,hJ.Ylabel,hJ.Yaxis,hJ.GridLines,new bY({$:1,$0:{$:3,$0:hI},$1:hJ.Plots}),hJ.IsLegendEnabled,hJ.IsNavigationEnabled,hJ.IsTooltipPlotCoordsEnabled,hJ.VisibleRegion,hJ.TooltipDelay);};eJ.DefaultGridLines=function(){fI.$cctor();return fI.DefaultGridLines;};eK.Grey=function(){fJ.$cctor();return fJ.Grey;};eK.Black=function(){fJ.$cctor();return fJ.Black;};eK.parse=function(hI){var hJ,hK,hL,hM,hN,hO,hP;function hQ(hR){var hS,hT;try{return{$:1,$0:a.parseInt(hR,16)&255};}catch(hU){if(hU instanceof fY||(hU instanceof gQ||hU instanceof gR))hS=null;else throw hU;return hS;}}return(hK=hI.length===7&&hI[0]==="#"?(hL=hQ(cS.Substring(hI,1,2)),(hM=hQ(cS.Substring(hI,3,2)),(hN=hQ(cS.Substring(hI,5,2)),hL!=null&&hL.$==1&&(hM!=null&&hM.$==1&&(hN!=null&&hN.$==1&&(hO=[hN.$0,hM.$0,hL.$0],true)))?{$:1,$0:{$:1,$0:gN.New(hO[2],hO[1],hO[0])}}:null))):null,hK!=null&&hK.$==1?(hJ=hK.$0,true):(hP=bW.TryFind(hI,eK.namesToColours()),hP!=null&&hP.$==1&&(hJ=hP.$0,true)))?{$:1,$0:hJ}:null;};eK.Gray=function(){fJ.$cctor();return fJ.Gray;};eK.DarkGrey=function(){fJ.$cctor();return fJ.DarkGrey;};eK.namesToColours=function(){fJ.$cctor();return fJ.namesToColours;};eK.createColour=function(hI,hJ,hK){return{$:1,$0:gN.New(hI,hJ,hK)};};eL.New=function(hI,hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV){return{Width:hI,Height:hJ,Title:hK,Xlabel:hL,Xaxis:hM,Ylabel:hN,Yaxis:hO,GridLines:hP,Plots:hQ,IsLegendEnabled:hR,IsNavigationEnabled:hS,IsTooltipPlotCoordsEnabled:hT,VisibleRegion:hU,TooltipDelay:hV};};eM.Visible={$:0};eM.Automatic={$:1};eO.createHeatmap=function(hI,hJ,hK){return fL.New(null,hI,hJ,hK,fM.Default,1);};eO.setPalette=function(hI,hJ){return fL.New(hJ.Name,hJ.X,hJ.Y,hJ.Data,hI,hJ.Opacity);};eO.setName=function(hI,hJ){return fL.New(hI,hJ.X,hJ.Y,hJ.Data,hJ.Palette,hJ.Opacity);};eP.init=function(hI,hJ,hK){var hL,hM,hN,hO,hP;hL=ck.zeroCreate2D(hI,hJ);for(hM=0,hN=hI-1;hM<=hN;hM++){for(hO=0,hP=hJ-1;hO<=hP;hO++)ck.set2D(hL,hM,hO,hK(hM,hO));}return hL;};eQ.createMarkers=function(hI,hJ){return fN.New(null,hI,hJ,10,fO.Default,fO.Default,eR.Box);};eQ.setShape=function(hI,hJ){return fN.New(hJ.Name,hJ.X,hJ.Y,hJ.Size,hJ.FillColour,hJ.BorderColour,hI);};eQ.setFillColour=function(hI,hJ){return fN.New(hJ.Name,hJ.X,hJ.Y,hJ.Size,hI,hJ.BorderColour,hJ.Shape);};eQ.setSize=function(hI,hJ){return fN.New(hJ.Name,hJ.X,hJ.Y,hI,hJ.FillColour,hJ.BorderColour,hJ.Shape);};eR.Circle={$:1};eR.Box={$:0};eS.createPolyline=function(hI,hJ){return fP.New(null,hI,hJ,fO.Default,1,fQ.Butt,fR.Miter);};eS.setThickness=function(hI,hJ){return fP.New(hJ.Name,hJ.X,hJ.Y,hJ.Colour,hI,hJ.LineCap,hJ.LineJoin);};eS.setStrokeColour=function(hI,hJ){return fP.New(hJ.Name,hJ.X,hJ.Y,hI,hJ.Thickness,hJ.LineCap,hJ.LineJoin);};eT.createHistogram=function(hI){return fS.New(null,hI,fO.Default,30);};eT.setBinCount=function(hI,hJ){return fS.New(hJ.Name,hJ.Samples,hJ.Colour,hI);};eU=dy.NamesMap=hB.Class({Item:function(hI){var hJ,hK;hJ=this;hK=ck.length(this.names);return function(hL){while(true)if(ck.get(hJ.names,hL)===hI)return hL;else if(hL===hK-1)return -1;else hL=hL+1;}(0);},get_Keys:function(){return this.names;}},b1,eU);eU.New=hB.Ctor(function(hI){b1.New.call(this);this.names=hI;},eU);eV.$cctor=function(){var hI,hJ,hK,hL,hM;eV.$cctor=a.ignore;function hN(hO){return true;}eV.start_pos=[0,0];eV.add_row=function(hO){return cR.add_rows(1,hO);};eV.lineSeparators=["\\r\\n","\\n"];eV.CommentSingle="//";eV.CommentStart="(*";eV.CommentEnd="*)";eV.newline=function(hO){var hP,hQ,hR;hP=hO[0];hQ=hO[1];hR=hQ[0];return cS.StartsWith(hP,"\\n")?{$:1,$0:"\\n",$1:[hP.substring(1),[hR+1,0]]}:cS.StartsWith(hP,"\\r\\n")?{$:1,$0:"\\n",$1:[hP.substring(2),[hR+1,0]]}:cS.StartsWith(hP,"\\r")?{$:1,$0:"\\n",$1:[hP.substring(1),[hR+1,0]]}:cR.mk_failEmpty([hR,hQ[1]],"linebreak");};eV.eof=function(hO){return hO[0]===""?{$:0,$0:null,$1:["",hO[1]]}:cR.mk_failEmpty(hO[1],"end of input");};eV.digits=cR.op_LessQmarkGreater(cR.manySatisfy(cR.isDigit),"an integer");eV.digits1=cR.op_LessQmarkGreater(cR.many1Satisfy(cR.isDigit),"an integer");eV.skipNewline=cR.op_BarGreaterGreater(cR.newline(),a.ignore);eV.keyword=cR.skipString;eV.linebreak=cR.op_BarGreaterGreater(cR.newline(),a.ignore);eV.sign=cR.op_BarGreaterGreater(cR.opt(cR.pstring("-")),function(hO){return hO==null?"":"-";});eV.forced_sign=cR.op_LessBarGreater(cR.pstring("-"),cR.pstring("+"));eV.opt_sign=cR.op_BarGreaterGreater(cR.opt(cR.op_LessBarGreater(cR.pstring("-"),cR.pstring("+"))),function(hO){return hO==null?"":hO.$0;});eV.pint32=cR.guarded(function(hO){return be.toInt(a.Number(hO));},cR.pTry(cR.op_DotGreaterGreaterDot(cR.sign(),cR.digits1())));eV.pfloat=cR.op_LessQmarkGreater(cR.guarded(a.Number,cR.pTry(cR.op_DotGreaterGreaterDot(cR.op_DotGreaterGreaterDot(cR.op_DotGreaterGreaterDot(cR.sign(),cR.digits1()),cR.opt(cR.op_GreaterGreaterDot(cR.pstring("."),cR.digits1()))),cR.opt(cR.op_DotGreaterGreaterDot(cR.op_GreaterGreaterDot(cR.op_LessBarGreater(cR.pstring("e"),cR.pstring("E")),cR.opt_sign()),cR.digits1()))))),"a float");eV.anyChar=function(hO){var hP,hQ,hR,hS;hP=hO[0];hQ=hO[1];hR=hQ[0];hS=[hR,hQ[1]];return hP.length>0&&cR.isLetter(hP[0])?cS.StartsWith(hP,"\\n")?{$:1,$0:"\\n",$1:[hP.substring(1),[hR+1,0]]}:cS.StartsWith(hP,"\\r\\n")?{$:1,$0:"\\n",$1:[hP.substring(2),[hR+1,0]]}:cS.StartsWith(hP,"\\r")?{$:1,$0:"\\n",$1:[hP.substring(1),[hR+1,0]]}:{$:1,$0:hP[0],$1:[hP.substring(1),cR.add_cols(1,hS)]}:cR.mk_failEmpty(hS,"a letter");};eV.whiteSpace=cR.op_LessQmarkGreater(cR.op_LessBarGreater(cR.linebreak(),function(hO){return cR.skipChar(cR.isWhiteSpace,hO[0],hO[1]);}),"a white space");eV.anyChar_INTERNAL=cR.op_LessQmarkGreater(function(hO){return cR.skipChar(hN,hO[0],hO[1]);},"any char");eV.eol=cR.op_LessBarGreater((hI=cR.choice(ck.map(cR.keyword(),cR.lineSeparators())),function(hO){return hI([hO[0],hO[1]]);}),cR.eof());eV.commentLine=cR.op_BarGreaterGreater(cR.op_GreaterGreaterGreaterGreater((cR.keyword())(cR.CommentSingle()),(hJ=cR.op_LessBarGreater(cR.linebreak(),cR.eof()),function(hO){return cR.manyUntil(cR.anyChar_INTERNAL(),hJ,hO[0],hO[1]);})),a.ignore);eV.spaces=function(hO){var hP;hP=(cR.many(cR.op_LessBarGreater(cR.op_LessBarGreater(cR.commentLine(),cR.commentMultiline()),cR.whiteSpace())))(hO);return hP.$==1?{$:0,$0:"",$1:hP.$1}:hP.$==2?{$:0,$0:"",$1:hO}:hP.$==3?{$:3,$0:hP.$0,$1:hP.$1}:{$:0,$0:"",$1:hP.$1};};eV.spaces1=function(hO){var hP;hP=(cR.many1(cR.op_LessBarGreater(cR.op_LessBarGreater(cR.commentLine(),cR.commentMultiline()),cR.whiteSpace())))(hO);return hP.$==1?{$:0,$0:"",$1:hP.$1}:hP.$==2?{$:0,$0:"",$1:hO}:hP.$==3?{$:3,$0:hP.$0,$1:hP.$1}:{$:0,$0:"",$1:hP.$1};};eV.name=cR.op_LessQmarkGreater(cR.op_BarGreaterGreater(cR.op_DotGreaterGreaterDot(cR.many1Satisfy(cR.isLetter),cR.manySatisfy(function(hO){return cR.isLetter(hO)||cR.isDigit(hO)||hO==="_"||hO==="\'";})),function(hO){return hO[0]+hO[1];}),"an identifier");eV.pcolour=(hK=cR.manySatisfy(function(hO){return cR.isLetter(hO)||cR.isDigit(hO);}),cR.op_DotGreaterGreater(cR.op_GreaterGreaterDot(cR.pstring("\\""),(hL=cR.choice([cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(cR.kw("#"),cR.many1Satisfy(function(hO){return"a"<=hO&&hO<="f"||"A"<=hO&&hO<="F"||cR.isDigit(hO);})),function(hO){return cR.preturn("#"+hO);}),hK]),function(hO){return hL([hO[0],hO[1]]);})),cR.kw("\\"")));eV.pbool=(hM=cR.choice([cR.op_GreaterGreaterPercent(cR.kw("true"),true),cR.op_GreaterGreaterPercent(cR.kw("True"),true),cR.op_GreaterGreaterPercent(cR.kw("false"),false),cR.op_GreaterGreaterPercent(cR.kw("False"),false)]),function(hO){return hM([hO[0],hO[1]]);});eV.parse=new fU.New();};eW.New=function(hI){return{map:hI};};eX.empty=function(){return eX.New([],new ct.New$5());};eX.add=function(hI,hJ){var hK;hK=ck.length(hI.to_species);hI.to_species.push(hJ);hI.from_species.Add(hJ,hK);return hK;};eX.index=function(hI,hJ){return hI.from_species.ContainsKey(hJ)?hI.from_species.get_Item(hJ):eX.add(hI,hJ);};eX.New=function(hI,hJ){return{to_species:hI,from_species:hJ};};eY.New=function(hI,hJ,hK){return{init:hI,react_st:hJ,index:hK};};eZ=bV.ValueCollection=hB.Class({GetEnumerator$1:function(){return df.Get(co.map(function(hI){return hI.V;},this.d));},GetEnumerator:function(){return this.GetEnumerator$1();},GetEnumerator0:function(){return this.GetEnumerator$1();}},b1,eZ);eZ.New=hB.Ctor(function(hI){b1.New.call(this);this.d=hI;},eZ);e0.New=function(hI,hJ,hK,hL,hM,hN){return{init:hI,current:hJ,advance:hK,refine:hL,get_time:hM,get_x:hN};};e1.init=function(hI,hJ,hK,hL){var hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW;hO=hJ.length;hP=(hK(hI))(hJ);hQ=hL.InitialStepSize===0?(hM=dK.map(function(hX){return 1/hL.RelativeTolerance*(hL.AbsoluteTolerance+hL.RelativeTolerance*hC.abs(hX));},hJ),(hN=dK.sum(dK.map2(function(hX){return function(hY){return hX*hX/hY/hY;};},hP,hM)),hC.min(hC.sqrt(hL.RelativeTolerance/(1/(hM[0]*hM[0])+1/hO*hN)),hL.MaxStep))):hC.min(hL.InitialStepSize,hL.MaxStep);hR=5;hS=dN.zeros(hO,hR+1);for(hT=0,hU=hO-1;hT<=hU;hT++){hV=hJ[hT];(ck.get(hS.MatrixData,hT))[0]=hV;hW=hQ*hP[hT];(ck.get(hS.MatrixData,hT))[1]=hW;}return e2.New(hI,hJ,hK,hQ,hS,2,0,0,1,hR,0,new hG(hO),false,hL);};e1.advance=function(hI){return e1.PredictorCorrector(e2.New(hI.t,hI.x,hI.f,hI.dt,hI.z,hI.q,hI.Dq,hI.delta,hI.r,hI.qmax,hI.nsuccess,new hG(hI.x.length),false,hI.opts));};e1.defaults=function(){return e3.New(0,1E-06,0.001,1.79769313486232E+308,0,1.1,0.9,5,fW.Absent);};e1.PredictorCorrector=function(hI){var hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS;hJ=dN.copy(hI.z);hK=dN.copyCol(hJ,0).length;hL=e1.NordsieckMatrix_init(hI.z);hM=e2.New(hI.t,dN.copyCol(hL,0),hI.f,hI.dt,hL,hI.q,hI.Dq,hI.delta,hI.r,hI.qmax,hI.nsuccess,new hG(hK),false,hI.opts);hN=hI.opts.MinStep;hO=hI.opts.MaxScale;hP=hI.opts.MinScale;hQ=e1.Corrector(hM);return hQ.isIterationFailed?(hR=hQ.dt/2,hR<1E-12?be.FailWith("Cannot generate numerical solution"):e1.PredictorCorrector(e2.New(hQ.t,hQ.x,hQ.f,hR,e1.NordsieckMatrix_rescale(hJ,0.5),hQ.q,hQ.Dq,hQ.delta,hQ.r,hQ.qmax,0,hQ.e,false,hQ.opts))):(hS=hC.min(1.1,hC.max(0.2,hQ.r)),hQ.delta>=1?(hQ.opts.MaxStep<1.79769313486232E+308?hS=hC.min(hS,hQ.opts.MaxStep/hQ.dt):void 0,hN>0?hS=hC.max(hS,hN/hQ.dt):void 0,hS=hC.min(hS,hO),hS=hC.max(hS,hP),e1.PredictorCorrector(e2.New(hQ.t,hQ.x,hQ.f,hQ.dt*hS,e1.NordsieckMatrix_rescale(hQ.z,hS),hQ.q,hQ.Dq,hQ.delta,hQ.r,hQ.qmax,hQ.nsuccess,hQ.e,false,hQ.opts))):(hQ.opts.MaxStep<1.79769313486232E+308?hS=hC.min(hS,hQ.opts.MaxStep/hQ.dt):void 0,hN>0?hS=hC.max(hS,hN/hQ.dt):void 0,hS=hC.min(hS,hO),hS=hC.max(hS,hP),e2.New(hQ.t+hQ.dt,hQ.x,hQ.f,hQ.dt*hS,e1.NordsieckMatrix_rescale(hQ.z,hS),hQ.q,hQ.Dq,hQ.delta,hQ.r,hQ.qmax,hQ.nsuccess,hQ.e,hQ.isIterationFailed,hQ.opts)));};e1.NordsieckMatrix_init=function(hI){var hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT;hJ=dN.numCols(hI);hK=dN.numRows(hI);hL=dN.copy(hI);for(hM=0,hN=hJ-2;hM<=hN;hM++){for(hO=hM+1,hP=hJ-1;hO<=hP;hO++){hQ=hJ+hM-hO;for(hR=0,hS=hK-1;hR<=hS;hR++){hT=(ck.get(hL.MatrixData,hR))[hQ]+(ck.get(hL.MatrixData,hR))[hQ-1];(ck.get(hL.MatrixData,hR))[hQ-1]=hT;}}}return hL;};e1.Corrector=function(hI){var hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h2,h3,h4,h5,h6,h7,h8,h9,h_,h$,ia,ib,ic,id,ie,_if,ig,ih,ii,ij,ik,il,im,_in,io,ip,iq,ir,is,it,iu;function h0(iv){return dN.subtract(dN.identity(h5,h5),dN.matrMultScal(iv,h_*h4[h8-1]));}function h1(iv){var iw,ix,iy,iz,iA,iB,iC,iD,iE,iF,iG,iH,iI,iJ,iK,iL,iM,iN,iO,iP,iQ,iR,iS,iT,iU,iV,iW,iX;iB=new hG(h5);iC=(h6(h$+h_))(iv.x);for(iD=0,iE=h5-1;iD<=iE;iD++)iB[iD]=h_*iC[iD]-(ia.get_Item(iD))[1]-iv.e[iD];iF=ic.$==1?hg.SolveCore(ic.$0,iB):ic.$==2?hg.SparseSolveCore(ic.$0,iB):be.FailWith("Failed to evaluate predictor matrix P");iG=new hG(h5);for(iH=0,iI=h5-1;iH<=iI;iH++)iG[iH]=iv.e[iH]+iF[iH];iJ=new hG(h5);for(iK=0,iL=h5-1;iK<=iL;iK++)iJ[iK]=h7[iK]+h4[h8-1]*iG[iK];iM=dN.vectorProduct(iG,ck.get(h3,h8-1));iN=dN.zeros(h5,h9+1);for(iO=0,iP=h5-1;iO<=iP;iO++){for(iQ=0,iR=h9;iQ<=iR;iQ++)if(iO<dN.numRows(iM)&&iQ<ck.get(h3,h8-1).length){iS=(ck.get(iM.MatrixData,iO))[iQ];(ck.get(iN.MatrixData,iO))[iQ]=iS;}else(ck.get(iN.MatrixData,iO))[iQ]=0;}iT=dN.add(ia,iN);iU=e1.ToleranceNorm(iG,id,ie,iv.x);iV=new hG(h5);for(iW=0,iX=h5-1;iW<=iX;iW++)iV[iW]=(iG[iW]-hI.e[iW])*(1/(h8+2)*(ck.get(h3,h8-1))[h8-1]);ix=e1.ToleranceNorm(iV,id,ie,iJ);iy=e1.ToleranceNorm(dN.copyCol(iT,h8-1),id,ie,iJ);iz=iU/(ib/(2*(h8+2)));iA=hf.New(iG,iU,ix,iy,iz,iJ,iT,iv.count+1);return iz>1&&iA.count<h2?h1(iA):iA;}h2=hI.opts.NumberOfIterations;h3=ck.map(dK.ofArray,[[1,1],[2/3,1,1/3],[6/11,1,6/11,1/11],[24/50,1,35/50,10/50,1/50],[120/274,1,225/274,85/274,15/274,1/274],[720/1764,1,1624/1764,735/1764,175/1764,1/1764]]);h4=dK.ofArray([1,2/3,6/11,24/50,120/274,720/1764]);h5=hI.x.length;h6=hI.f;h7=hI.x;h8=hI.q;h9=hI.qmax;h_=hI.dt;h$=hI.t;ia=dN.copy(hI.z);ib=1/(1/(h8+1)*e1.Factorial(h8)*(ck.get(h3,h8-1))[h8]);hJ=0;hK=0;hL=0;ic=(hN=hI.opts.Jacobian,hN.$==1?{$:1,$0:h0(hN.$0)}:hN.$==2?{$:2,$0:d3.Identity(h5,h5).minus(hN.$0.times$1(h_*h4[h8-1]))}:{$:1,$0:h0(e1.NordsieckMatrix_Jacobian(h$+h_,h7,function(iv,iw){return(h6(iv))(iw);}))});id=hI.opts.AbsoluteTolerance;ie=hI.opts.RelativeTolerance;_if=h1(hf.New(hI.e,0,0,0,0,h7,ia,0));hP=_if.count<h2?hI.nsuccess+1:0;hQ=_if.delta;hR=false;hS=0;hT=_if.z;hU=_if.e;hV=_if.x;hW=_if.Dq;hX=hI.q;hY=1;ig=hC.abs(_if.Dq);ih=hC.abs(_if.DqUp);ii=hC.abs(_if.DqDown);if(_if.count<h2){hR=false;hT=_if.z;for(ij=0,ik=h5-1;ij<=ik;ij++)hV[ij]=(_if.z.get_Item(ij))[0];hU=_if.e;}else{hR=true;hT=hI.z;for(il=0,im=h5-1;il<=im;il++)hV[il]=(hI.z.get_Item(il))[0];hU=hI.e;}hK=0;if(hI.q<hI.qmax)hK=1/1.4/(hC.pow(ih,1/(h8+2))+1E-06);hJ=1/1.2/(hC.pow(ig,1/(h8+1))+1E-06);hL=0;if(hI.q>1)hL=1/1.3/(hC.pow(ii,1/h8)+1E-06);hS=hP>=hI.q?0:hP;if(hJ>=hK){if(hJ<=hL&&hP>=hI.q&&hI.q>1){hX=hI.q-1;hW=ii;for(_in=0,io=h5-1;_in<=io;_in++){for(ip=hX+1,iq=h9;ip<=iq;ip++)(hT.get_Item(_in))[ip]=0;}hP=0;hY=hL;}else{hX=hI.q;hW=ig;hY=hJ;}}else if(hK>=hL){if(hK>=hJ&&hP>=hI.q&&hI.q<hI.qmax){hX=hI.q+1;hW=ih;hY=hK;hP=0;}else{hX=hI.q;hW=ig;hY=hJ;}}else if(hP>=hI.q&&hI.q>1){hX=hI.q-1;hW=ii;for(ir=0,is=h5-1;ir<=is;ir++){for(it=hX+1,iu=h9;it<=iu;it++)(hT.get_Item(ir))[it]=0;}hP=0;hY=hL;}else{hX=hI.q;hW=ig;hY=hJ;}hZ=e2.New(hI.t,hV,hI.f,hI.dt,hT,hX,hW,hQ,hY,hI.qmax,hS,hU,hR,hI.opts);return hZ;};e1.NordsieckMatrix_rescale=function(hI,hJ){var hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT;hK=1;hN=dN.numCols(hI);hO=dN.numRows(hI);hM=dN.copy(hI);for(hP=1,hQ=hN-1;hP<=hQ;hP++){hK=hK*hJ;for(hR=0,hS=hO-1;hR<=hS;hR++){hT=(ck.get(hM.MatrixData,hR))[hP]*hK;(ck.get(hM.MatrixData,hR))[hP]=hT;}}return hM;};e1.NordsieckMatrix_Jacobian=function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0,h1,h2,h3,h4,h5,h6;hL=hJ.length;hM=dN.zeros(hL,hL);hN=ck.create(hL,0);hO=new hG(hL);for(hP=0,hQ=hL-1;hP<=hQ;hP++){ck.set(hN,hP,hC.sqrt(1E-06*(hR=1E-05,(hS=hC.abs(hJ[hP]),cw.Compare(hR,hS)===1?hR:hS))));hO[hP]=hJ[hP];}hT=hK(hI,hJ);hU=dN.zeros(hL,hL);for(hV=0,hW=hL-1;hV<=hW;hV++){hO[hV]=hO[hV]+ck.get(hN,hV);hY=hK(hI,hO);for(hZ=0,h0=hL-1;hZ<=h0;hZ++){h1=hY[hZ];(ck.get(hU.MatrixData,hV))[hZ]=h1;}hO[hV]=hO[hV]-ck.get(hN,hV);}for(h2=0,h3=hL-1;h2<=h3;h2++){h4=hM.get_Item(h2);for(h5=0,h6=hL-1;h5<=h6;h5++)h4[h5]=((ck.get(hU.MatrixData,h5))[h2]-hT[h2])/ck.get(hN,h5);}return hM;};e1.ToleranceNorm=function(hI,hJ,hK,hL){var hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV;hO=hI.length;hP=hL.length;hM=0;hN=0;for(hQ=0,hR=hO-1;hQ<=hR;hQ++){hS=hC.abs(hI[hQ]);hM=hM>hS?hM:hS;}for(hT=0,hU=hP-1;hT<=hU;hT++){hV=hC.abs(hL[hT]);hN=hN>hV?hN:hV;}return hM/(hJ+hK*hN);};e1.Factorial=function(hI){return hI<0?-1:hI===0?1:hI*e1.Factorial(hI-1);};e2.New=function(hI,hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV){return{t:hI,x:hJ,f:hK,dt:hL,z:hM,q:hN,Dq:hO,delta:hP,r:hQ,qmax:hR,nsuccess:hS,e:hT,isIterationFailed:hU,opts:hV};};e3.New=function(hI,hJ,hK,hL,hM,hN,hO,hP,hQ){return{InitialStepSize:hI,AbsoluteTolerance:hJ,RelativeTolerance:hK,MaxStep:hL,MinStep:hM,MaxScale:hN,MinScale:hO,NumberOfIterations:hP,Jacobian:hQ};};e4.init=function(hI,hJ,hK,hL){var hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV;hM=7;hN=hJ.length;hO=e5.New(hI,hJ,hK,0,dN.zeros(hM,hN),1,0,hJ,hL);return e5.New(hI,hJ,hK,hL.InitialStepSize===0?(hP=dK.map(function(hW){return hL.AbsoluteTolerance+hL.RelativeTolerance*hC.abs(hW);},hJ),(hQ=(hO.f(hI))(hJ),(hR=dK.max(dK.map2(function(hW){return function(hX){return hC.abs(hW/hX);};},hJ,hP)),(hS=dK.max(dK.map2(function(hW){return function(hX){return hC.abs(hW/hX);};},hQ,hP)),(hT=hC.min(hR,hS)<1E-05?1E-06:0.01*(hR/hS),(hU=dK.max(dK.map2(function(hW){return function(hX){return hC.abs(hW/hX);};},dK.subtract(hQ,(hO.f(hI+hT))(dK.add(hJ,dK.scale(hT,hQ)))),dK.scale(hT,hP))),(hV=hC.max(hS,hU)<=1E-15?hC.max(1E-06,hT*0.001):hC.pow(0.01/hC.max(hS,hU),1/5),hV>100*hT?100*hT:hV))))))):hL.InitialStepSize,dN.zeros(hM,hN),1,0,hJ,hL);};e4.advance=function(hI){var hJ,hK,hL,hM,hN,hO,hP,hQ,hR;function hS(hT){var hU,hV,hW,hX,hY,hZ,h0,h1,h2,h3,h4,h5,h6,h7,h8,h9,h_,h$,ia,ib,ic,id,ie,_if,ig,ih,ii,ij,ik,il,im,_in,io,ip,iq,ir,is,it,iu,iv,iw,ix,iy,iz,iA,iB,iC,iD,iE,iF,iG,iH,iI,iJ,iK,iL,iM,iN,iO,iP,iQ,iR;iE=hT.dt;iF=e4.scaleTo(iE,(hU=dK.copy(hK),(hI.f(hJ+iE*ck.get(hO,0)))(hU)));iG=(hV=ck.get(hL,0),e4.scaleTo(iE,(hW=(hX=dK.copy(hK),e4.addTo(iF,ck.get(hV,0),hX)),(hI.f(hJ+iE*ck.get(hO,1)))(hW))));iH=(hY=ck.get(hL,1),e4.scaleTo(iE,(hZ=(h0=(h1=dK.copy(hK),e4.addTo(iF,ck.get(hY,0),h1)),e4.addTo(iG,ck.get(hY,1),h0)),(hI.f(hJ+iE*ck.get(hO,2)))(hZ))));iI=(h2=ck.get(hL,2),e4.scaleTo(iE,(h3=(h4=(h5=(h6=dK.copy(hK),e4.addTo(iF,ck.get(h2,0),h6)),e4.addTo(iG,ck.get(h2,1),h5)),e4.addTo(iH,ck.get(h2,2),h4)),(hI.f(hJ+iE*ck.get(hO,3)))(h3))));iJ=(h7=ck.get(hL,3),e4.scaleTo(iE,(h8=(h9=(h_=(h$=(ia=dK.copy(hK),e4.addTo(iF,ck.get(h7,0),ia)),e4.addTo(iG,ck.get(h7,1),h$)),e4.addTo(iH,ck.get(h7,2),h_)),e4.addTo(iI,ck.get(h7,3),h9)),(hI.f(hJ+iE*ck.get(hO,4)))(h8))));iK=(ib=ck.get(hL,4),e4.scaleTo(iE,(ic=(id=(ie=(_if=(ig=(ih=dK.copy(hK),e4.addTo(iF,ck.get(ib,0),ih)),e4.addTo(iG,ck.get(ib,1),ig)),e4.addTo(iH,ck.get(ib,2),_if)),e4.addTo(iI,ck.get(ib,3),ie)),e4.addTo(iJ,ck.get(ib,4),id)),(hI.f(hJ+iE*ck.get(hO,5)))(ic))));iL=(ii=ck.get(hL,5),e4.scaleTo(iE,(ij=(ik=(il=(im=(_in=(io=(ip=dK.copy(hK),e4.addTo(iF,ck.get(ii,0),ip)),e4.addTo(iG,ck.get(ii,1),io)),e4.addTo(iH,ck.get(ii,2),_in)),e4.addTo(iI,ck.get(ii,3),im)),e4.addTo(iJ,ck.get(ii,4),il)),e4.addTo(iK,ck.get(ii,5),ik)),(hI.f(hJ+iE*ck.get(hO,6)))(ij))));iM=dN.ofRows([iF,iG,iH,iI,iJ,iK,iL]);iN=(iq=(ir=(is=(it=(iu=(iv=(iw=dK.copy(hP),e4.addTo(iF,ck.get(hN,0),iw)),e4.addTo(iG,ck.get(hN,1),iv)),e4.addTo(iH,ck.get(hN,2),iu)),e4.addTo(iI,ck.get(hN,3),it)),e4.addTo(iJ,ck.get(hN,4),is)),e4.addTo(iK,ck.get(hN,5),ir)),e4.addTo(iL,ck.get(hN,6),iq));iO=(ix=(iy=(iz=(iA=(iB=(iC=(iD=dK.copy(hP),e4.addTo(iF,ck.get(hM,0),iD)),e4.addTo(iG,ck.get(hM,1),iC)),e4.addTo(iH,ck.get(hM,2),iB)),e4.addTo(iI,ck.get(hM,3),iA)),e4.addTo(iJ,ck.get(hM,4),iz)),e4.addTo(iK,ck.get(hM,5),iy)),e4.addTo(iL,ck.get(hM,6),ix));iP=dK.max(dK.mapi2(hB.Curried3(function(iS,iT,iU){return hC.abs(1*(iT-iU))/hC.max(hI.opts.AbsoluteTolerance,hI.opts.RelativeTolerance*hC.max(hC.abs(hP[iS]),hC.abs(iU)));}),iN,iO));iQ=iP===0?iE:iE*hC.min(5,hC.max(0.2,0.8*hC.pow(1/iP,1/5)*hC.pow(hQ,0.08)));iR=hI.opts.MaxStep<1.79769313486232E+308?hC.min(iQ,hI.opts.MaxStep):iQ;if(a.isNaN(iR))throw new fY.New$2("Derivatives function returned NaN");else if(iR<1E-12)throw new fY.New$2("Cannot generate numerical solution");else return iP<=1?fX.New(iO,iR,hT.dt,iP,iM):hS(fX.New(iO,iR,hT.dt,iP,iM));}hJ=hI.t;hK=hI.x;hL=[[1/5],[3/40,9/40],[44/45,-56/15,32/9],[19372/6561,-25360/2187,64448/6561,-212/729],[9017/3168,-355/33,46732/5247,49/176,-5103/18656],[35/384,0,500/1113,125/192,-2187/6784,11/84]];hM=[5179/57600,0,7571/16695,393/640,-92097/339200,187/2100,1/40];hN=[35/384,0,500/1113,125/192,-2187/6784,11/84,0];hO=[0,1/5,3/10,4/5,8/9,1,1];hP=hI.x;hQ=hI.prevErr;hR=hS(fX.New(hI.x,hI.dt,hI.dt,0,hI.k));return e5.New(hI.t+hR.prevDt,hR.x,hI.f,hR.dt,hR.k,hR.e,hI.t,hI.x,hI.opts);};e4.add_interpolate=function(hI,hJ){var hK,hL,hN,hO,hP,hQ,hR,hS,hT;function hM(hU){var hV,hW,hX;return hU>=hN-1?bY.Empty:new bY({$:1,$0:(hV=ck.get(hR,hU),(hW=hL.get_Item(hU),(hX=hU===0?hI.x:hL.get_Item(hU-1),e5.New(hV,hW,hI.f,hI.dt,hI.k,hI.prevErr,hU===0?hI.t:ck.get(hR,hU-1),hX,hI.opts)))),$1:hM(hU+1)});}hN=4;hO=new hG(hN-1);for(hP=0,hQ=hN-2;hP<=hQ;hP++)hO[hP]=(hP+1)/hN;hR=ck.create(hN,0);for(hS=0,hT=hN-2;hS<=hT;hS++)ck.set(hR,hS,hI.t+(hJ.t-hI.t)*hO[hS]);hL=e4.interp(hO,hI.x,hJ.k);return hM(0);};e4.defaults=function(){return e6.New(0,1E-06,0.001,1.79769313486232E+308,1E-12);};e4.scaleTo=function(hI,hJ){dK.setScaled(hI,hJ);return hJ;};e4.addTo=function(hI,hJ,hK){dK.setAddedScaled(hK,hI,hJ);return hK;};e4.interp=function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0,h1,h2,h3,h4,h5,h6;cw.Equals(hK,null)?be.FailWith("interpolation array k is empty."):null;hN=hJ.length;hO=dN.numRows(hK);hP=hI.length;hQ=dN.zeros(hP,hN);for(hR=0,hS=hP-1;hR<=hS;hR++)hQ.get_Item(hR).set(hJ);hT=dN.zeros(4,hP);for(hU=0,hV=hP-1;hU<=hV;hU++){(hT.get_Item(0))[hU]=hI[hU];for(hW=1,hX=3;hW<=hX;hW++)(hT.get_Item(hW))[hU]=hI[hU]*(hT.get_Item(hW-1))[hU];}hY=dN.ofArray([[1,-183/64,37/12,-145/128],[0,0,0,0],[0,1500/371,-1000/159,1000/371],[0,-125/32,125/12,-375/64],[0,9477/3392,-729/106,25515/6784],[0,-11/7,11/3,-55/28],[0,3/2,-4,5/2]]);hL=dN.zeros(hN,4);hM=dN.zeros(hN,hP);for(hZ=0,h0=hP-1;hZ<=h0;hZ++){for(h1=0,h2=hN-1;h1<=h2;h1++){(hM.get_Item(h1))[hZ]=0;for(h3=0,h4=3;h3<=h4;h3++){(hL.get_Item(h1))[h3]=0;for(h5=0,h6=hO-1;h5<=h6;h5++)(hL.get_Item(h1))[h3]=(hL.get_Item(h1))[h3]+(hK.get_Item(h5))[h1]*(hY.get_Item(h5))[h3];(hM.get_Item(h1))[hZ]=(hM.get_Item(h1))[hZ]+(hL.get_Item(h1))[h3]*(hT.get_Item(h3))[hZ];}(hQ.get_Item(hZ))[h1]=(hQ.get_Item(hZ))[h1]+(hM.get_Item(h1))[hZ];}}return hQ;};e5.New=function(hI,hJ,hK,hL,hM,hN,hO,hP,hQ){return{t:hI,x:hJ,f:hK,dt:hL,k:hM,prevErr:hN,prevT:hO,prevX:hP,opts:hQ};};e6.New=function(hI,hJ,hK,hL,hM){return{InitialStepSize:hI,AbsoluteTolerance:hJ,RelativeTolerance:hK,MaxStep:hL,MinStep:hM};};e7=d.OsloAbstract=hB.Class({evaluate:function(){var hI,hJ,hK,hL,hM,hN,hO,hP,hQ;function hR(hX){var hY;hY=hK.tryFind_index(hX);return hY==null?(function(hZ){return function(h0){return hZ("Attempting to look up non-existent species "+cA.toSafe(h0));};}(be.FailWith))(hX.name):hY.$0;}function hS(hX){function hY(hZ){return bq.map(hR,hZ);}return function(hZ){return br.map(hY,hZ);};}function hT(hX){return bq.eval_massaction(hI,hX);}function hU(hX){return bq.eval_function(hI,hN,hX);}function hV(hX){return bq.map(hR,hX);}function hW(hX){return bq.inline_keys(hI,hN,hX);}hI=cX.to_env(this.settings.parameters);hJ=_8.to_initialpops_events(hI,this.settings.simulation.initial,this.initials);hK=hJ[0];hL=hK.get_get_pop_array();hM=cF.create(hK,hJ[1],this.settings.simulation,1);hN=bq.inline_rates_env(hI,bW.Map(function(hX,hY){return(hS(hX))(hY);},this.settings.rates));hO=ck.map(function(hX){return _1.map2(hT,hU,hX);},this.rates);return cx.New(this.name,hM,ck.ofList(bX.map((hP=(hQ=function(hX){return hW(hV(hX));},function(hX){return br.expand(hQ,hX);}),function(hX){return br.simplify(hP(hX));}),hM.settings.plots)),this.settings.deterministic,dN.ofArray(this.matrix),this.powers,hO,dK.ofArray(hL));}},null,e7);e7.create=function(hI,hJ,hK,hL,hM,hN,hO){return e7.New(hI,hJ,hK,hL,hM,hN,hO);};e7.New=function(hI,hJ,hK,hL,hM,hN,hO){return new e7({name:hI,settings:hJ,matrix:hK,powers:hL,rates:hM,species:hN,initials:hO});};e8=eA.LCGRng=hB.Class({Microsoft_Research_Filzbach_Lib_IRng$NextDouble:function(){var hI;hI=this.Microsoft_Research_Filzbach_Lib_IRng$NextInt32();return[hI[0]*eA["lcg.d"](),hI[1]];},Microsoft_Research_Filzbach_Lib_IRng$NextInt32:function(){var hI;hI=(eA["lcg.a"]()*this.seed%eA["lcd.m"]()+eA["lcg.c"]())%eA["lcd.m"]();return[hI,new e8.New(hI)];}},b1,e8);e8.New=hB.Ctor(function(hI){b1.New.call(this);this.seed=hI;},e8);eA.fst3=a.id;eA["lcg.d"]=function(){hl.$cctor();return hl["lcg.d"];};eA["lcg.a"]=function(){hl.$cctor();return hl["lcg.a"];};eA["lcd.m"]=function(){hl.$cctor();return hl["lcd.m"];};eA["lcg.c"]=function(){hl.$cctor();return hl["lcg.c"];};eA.logOfNormPDF=function(hI,hJ,hK){var hL,hM;hL=hC.sqrt(6.28318530717959);hM=(hI-hK)/hJ;return -0.5*hM*hM-hC.log(hL*hJ);};eA.improbable=function(){hl.$cctor();return hl.improbable;};eA.normCDF=function(hI,hJ,hK){return 0.5*(1+eA.erf((hK-hI)/hJ/hC.sqrt(2)));};eA.erfinv=function(hI){var hJ,hK,hL,hM;hJ=-hC.log((1-hI)*(1+hI));hK=hJ<5?[bX.ofArray([2.81022636E-08,3.43273939E-07,-3.5233877E-06,-4.39150654E-06,0.00021858087,-0.00125372503,-0.00417768164,0.246640727,1.50140941]),hJ-2.5]:(hL=hC.sqrt(hJ)-3,[bX.ofArray([-0.000200214257,0.000100950558,0.00134934322,-0.00367342844,0.00573950773,-0.0076224613,0.00943887047,1.00167406,2.83297682]),hL]);hM=hK[1];return bX.reduce(function(hN,hO){return hN*hM+hO;},hK[0])*hI;};eA.erf=function(hI){var hJ;function hK(hL,hM){return function(hN){return[hL+hN*hM,hM*hJ];};}hJ=1/(1+0.5*hC.abs(hI));return hI<0?hJ*hC.exp((ck.fold(function(hL,hM){return(function(hN){return hK(hN[0],hN[1]);}(hL))(hM);},[-hI*hI,1],[-1.26551223,1.00002368,0.37409196,0.09678418,-0.18628806,0.27886807,-1.13520398,1.48851587,-0.82215223,0.17087277]))[0])-1:1-hJ*hC.exp((ck.fold(function(hL,hM){return(function(hN){return hK(hN[0],hN[1]);}(hL))(hM);},[-hI*hI,1],[-1.26551223,1.00002368,0.37409196,0.09678418,-0.18628806,0.27886807,-1.13520398,1.48851587,-0.82215223,0.17087277]))[0]);};e9=d.SundialsAbstract=hB.Class({evaluate:function(){var hI,hJ,hK,hL,hM,hN,hO,hP,hQ,hR;function hS(hV){var hW;hW=hL.tryFind_index(hV);return hW==null?(function(hX){return function(hY){return hX("Species "+cA.toSafe(hY)+" not found in model");};}(be.FailWith))(hV.name):hW.$0;}function hT(hV){return bq.inline_keys(hI,hJ,hV);}function hU(hV){return br.map(hP,hV);}hI=cX.to_env(this.settings.parameters);hJ=bq.inline_rates_env(hI,this.settings.rates);hK=_8.to_initialpops_events(hI,this.settings.simulation.initial,this.initials);hL=hK[0];hM=cF.create(hL,hK[1],this.settings.simulation,1);hN=hL.get_get_pop_array();hO=bX.map(function(hV){return dZ.fst3(hV[0],hV[1],hV[2]);},_2.get_sim_reactions_products(1,hL,hI,hJ,this.reactions));hP=function(hV){return es.map(hS,hV);};return cz.New(hM,ck.ofList(bX.map((hQ=(hR=function(hV){return br.expand(hT,hV);},function(hV){return br.simplify(hR(hV));}),function(hV){return hU(hQ(hV));}),hM.settings.plots)),hO,this.settings.deterministic,hN);}},null,e9);e9.create=function(hI,hJ,hK,hL){return e9.New(hI,hL,hJ,hK);};e9.New=function(hI,hJ,hK,hL){return new e9({species:hI,settings:hJ,reactions:hK,initials:hL});};e_=cB.anchor=hB.Class({toString:function(){return((((hB.Curried(function(hI,hJ,hK,hL){return hI(cA.toSafe(hJ)+":{"+hK.toFixed(6)+","+hL.toFixed(6)+"}");},4))(a.id))(this.anchor_id))(this.anchor_point.x))(this.anchor_point.y);}},null,e_);e_.New=function(hI,hJ){return new e_({anchor_id:hI,anchor_point:hJ});};e$.TridiagonalAlgorithm=function(hI,hJ,hK,hL){var hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV;hM=ck.length(hL);hN=ck.create(hM,0);hO=hL.slice();hP=ck.create(hM,0);ck.set(hN,0,ck.get(hK,0)/ck.get(hJ,0));ck.set(hO,0,ck.get(hO,0)/ck.get(hJ,0));for(hQ=1,hR=hM-2;hQ<=hR;hQ++){hS=ck.get(hJ,hQ)-ck.get(hI,hQ)*ck.get(hN,hQ-1);ck.set(hN,hQ,ck.get(hK,hQ)/hS);ck.set(hO,hQ,(ck.get(hO,hQ)-ck.get(hI,hQ)*ck.get(hO,hQ-1))/hS);}ck.set(hO,hM-1,(ck.get(hO,hM-1)-ck.get(hI,hM-1)*ck.get(hO,hM-2))/(ck.get(hJ,hM-1)-ck.get(hI,hM-1)*ck.get(hN,hM-2)));ck.set(hP,hM-1,ck.get(hO,hM-1));hT=be.step(hM-2,-1,0);hU=df.Get(hT);try{while(hU.MoveNext()){hV=hU.Current();ck.set(hP,hV,ck.get(hO,hV)-ck.get(hN,hV)*ck.get(hP,hV+1));}}finally{if(typeof hU=="object"&&"Dispose"in hU)hU.Dispose();}return hP;};e$.ApplySMInvertMatrix=function(hI,hJ,hK,hL,hM,hN){var hO,hP;hO=e$.TridiagonalAlgorithm(hI,hJ,hK,hL);hP=e$.DotProduct(hM,hO)/(1+e$.DotProduct(hM,hN));return ck.map2(function(hQ,hR){return hQ-hP*hR;},hO,hN);};e$.DotProduct=function(hI,hJ){return ck.fold2(function(hK,hL,hM){return hK+hL*hM;},0,hI,hJ);};fa.$cctor=function(){var hI,hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU;fa.$cctor=a.ignore;function hV(hY){return{$:1,$0:hY};}function hW(hY){return{$:0,$0:hY};}function hX(hY){return{$:1,$0:hY};}fa.parse_name=ea.pname(false);fa.parse_value_orig=cR.op_BarTwiddleGreater(br.parse(cR.op_DotGreaterGreater(ea.parse_name(),cR.spaces())),function(hY,hZ){return(function(h0){var h1,h2;h1=h0[0];h2=h0[1];return function(h3){return ea.map_value(h1,h2,h3);};}(hY))(hZ);});fa.pValue=br.parse(cR.pTry(cR.op_GreaterGreaterEquals(cR.op_DotGreaterGreater(ea.parse_name(),cR.spaces()),function(hY){return cR.op_LessBarGreater(cR.op_GreaterGreaterDot(cR.kw("("),cR.failParser("")),cR.preturn(hY));})));fa.parse_value=cR.op_BarTwiddleGreater(ea.pValue(),function(hY,hZ){return(function(h0){var h1,h2;h1=h0[0];h2=h0[1];return function(h3){return ea.map_value(h1,h2,h3);};}(hY))(hZ);});fa.parse_molecule_dots=(hI=cR.kw("::"),(hJ=cR.kw(":"),function(hY){return ea.do_parse_molecule(hI,hJ,true,hY);}));fa.parse_molecule=(hK=cR.kw("::"),(hL=cR.kw(":"),function(hY){return ea.do_parse_molecule(hK,hL,false,hY);}));fa.at_time=cR.opt(ea.op_AmpGreater("@",ea.parse_value()));fa.parse_string=(cR.bracket("\\"","\\""))(cR.manySatisfy(function(hY){return"\\""!==hY;}));fa.subdomain=cR.op_LessBarGreater(cR.pTry(cR.op_BarGreaterGreater(cR.op_DotGreaterGreater(ea.parse_name(),cR.pstring("*")),function(hY){return function(hZ){return hY(cA.toSafe(hZ)+"*");};}(a.id))),ea.parse_name());fa.binding=(hM=cR.choice(bX.ofArray([ea.op_AmpGreater("seq",cR.op_BarTwiddleGreater(ea.op_AmpGreater("=",ea.parse_name()),function(hY,hZ){return["seq",{$:0,$0:hZ,$1:ea.to_range(hY[0],hY[1])}];})),ea.op_AmpGreater("colour",cR.op_BarTwiddleGreater(ea.op_AmpGreater("=",ea.parse_string()),function(hY,hZ){return["colour",{$:2,$0:hZ,$1:ea.to_range(hY[0],hY[1])}];})),cR.op_GreaterGreaterEquals(cR.op_PlusGreaterGreater(ea.parse_name(),cR.kw("=")),function(hY){var hZ;hZ=cR.choice([cR.op_BarTwiddleGreater(cR.pTry(ea.after(cR.list_of1(ea.subdomain()),"*")),function(h0,h1){return[hY,{$:3,$0:[h1[0],h1[1]],$1:ea.to_range(h0[0],h0[1])}];}),cR.op_BarGreaterGreater(ea.parse_value(),function(h0){return[hY,{$:1,$0:h0}];})]);return function(h0){return hZ([h0[0],h0[1]]);};})])),function(hY){return hM([hY[0],hY[1]]);});fa.record=(hN=cR.sepEndBy1(ea.binding(),cR.skw(";")),(cR.bracket("{","}"))(hN));fa.int_name=cR.op_LessBarGreater(ea.parse_name(),cR.op_BarGreaterGreater(cR.pint32(),hH));fa.restriction=cR.op_GreaterGreaterEquals(cR.op_DotGreaterGreater(ea.int_name(),cR.spaces()),function(hY){var hZ;hZ=cR.choice([cR.op_BarGreaterGreater(ea.op_AmpGreater("@",cR.op_PlusGreaterGreaterPlus(ea.parse_value(),ea.op_AmpGreater(",",ea.parse_value_orig()))),function(h0){return[hY,bX.ofArray([["bind",{$:1,$0:h0[0]}],["unbind",{$:1,$0:h0[1]}]])];}),cR.op_DotGreaterGreaterDot(cR.op_GreaterGreaterDot(cR.kw("="),cR.preturn(hY)),ea.record()),cR.preturn([hY,bY.Empty])]);return function(h0){return hZ([h0[0],h0[1]]);};});fa.do_parse_param=cR.op_LessBarGreater(cR.op_GreaterGreaterEquals(function(hY){return ea.parse_parameters(hY[0],hY[1]);},function(hY){return cR.preturn(hV(hY));}),cR.op_GreaterGreaterEquals(ea.parse_name(),function(hY){return cR.preturn(hW(hY));}));fa.parse_ds=cR.op_GreaterGreaterDot(cR.spaces(),cR.op_BarGreaterGreater(ea.seq1((hO=cR.choice(bX.ofArray([cR.op_GreaterGreaterEquals(cR.op_DotGreaterGreater(ea.op_AmpGreater("def",ea.parse_name()),cR.spaces()),function(hY){return cR.op_LessBarGreater(cR.op_BarTwiddleGreater(cR.op_PlusGreaterGreaterPlus(function(hZ){return ea.parse_parameters(hZ[0],hZ[1]);},ea.op_AmpGreater("=",function(hZ){return ea.parse_proc(hZ[0],hZ[1]);})),function(hZ,h0){return{$:1,$0:[hY,ea.to_range(hZ[0],hZ[1]),h0[0],h0[1]]};}),cR.op_BarTwiddleGreater(ea.op_AmpGreater("=",cR.op_LessBarGreater(cR.op_GreaterGreaterEquals(ea.parse_value(),function(hZ){return cR.preturn(bX.ofArray([hZ]));}),function(hZ){return ea.parse_values(hZ[0],hZ[1]);})),function(hZ,h0){var h1;return{$:2,$0:[hY,h0.$==1&&(h0.$1.$==0&&(h1=h0.$0,true))?h1:{$:12,$0:h0,$1:ea.to_range(hZ[0],hZ[1])}]};}));}),cR.op_BarGreaterGreater(ea.op_AmpGreater("new",ea.restriction()),function(hY){return{$:0,$0:[hY,true]};}),cR.op_BarGreaterGreater(ea.op_AmpGreater("dom",cR.op_PlusGreaterGreaterPlus(ea.int_name(),ea.op_AmpGreater("=",ea.record()))),function(hY){return{$:0,$0:[hY,false]};}),cR.op_BarGreaterGreater(cR.op_PlusGreaterGreater(function(hY){return ea.parse_proc(hY[0],hY[1]);},cR.eof()),function(hY){return{$:3,$0:hY};})])),function(hY){return hO([hY[0],hY[1]]);})),ea.to_syntax));fa.parse_sg=(hP=b8.makeProvider(),(hQ=b5.psite(b5.engine(),hP,true),(hR=cR.between(cR.kw("["),cR.kw("]"),f4.psystem(hQ)),cR.op_DotGreaterGreater(cR.op_GreaterGreaterDot(cR.spaces(),cR.paren(cR.sepBy1(cR.op_DotGreaterGreaterDot(br.parse(cR.name()),hR),cR.kw("|")))),cR.eof()))));fa.speciesParser=cR.op_BarTwiddleGreater((ea.parse_molecule())(true),function(hY,hZ){return(function(h0){var h1,h2;h1=h0[0];h2=h0[1];return function(h3){return ea.to_species(h1,h2,h3);};}(hY))(hZ);});fa.plotParser=cR.op_LessBarGreater(cR.op_GreaterGreaterEquals(ea.speciesParser(),function(hY){return cR.preturn(hX(hY));}),cR.op_GreaterGreaterEquals(cR.op_DotGreaterGreater(cR.name(),cR.spaces()),function(hY){var hZ;hZ=cR.choice([cR.op_GreaterGreaterDot(cR.kw("_"),cR.preturn({$:2,$0:hY,$1:f5.All})),cR.op_GreaterGreaterEquals(cR.paren(cR.many(cT.parse())),function(h0){return cR.preturn({$:2,$0:hY,$1:{$:1,$0:h0}});}),cR.preturn({$:0,$0:hY})]);return function(h0){return hZ([h0[0],h0[1]]);};}));fa.dsdDirectivesParser=(hS=cR.op_LessBarGreater(cR.pTry(cR.op_BarGreaterGreater(ea.plotParser(),function(hY){return{$:0,$0:{$:2,$0:hY}};})),br.parse(bq.parse(ea.plotParser()))),(hT=cR.op_BarGreaterGreater(f6.parse(br.parse(bq.parse(ea.plotParser())),hS),function(hY){return{$:0,$0:hY};}),(hU=cR.op_BarGreaterGreater(bR.parse_option(),function(hY){return{$:1,$0:hY};}),cR.op_DotGreaterGreaterDot(m.parseTask(),cR.many(cR.op_GreaterGreaterDot(cR.kw("directive"),cR.op_LessBarGreater(hU,hT)))))));fa.parse_settings=cR.op_BarGreaterGreater(ea.dsdDirectivesParser(),function(hY){return ea.dsdCfg(hY[0],hY[1]);});fa.parser=cR.op_GreaterGreaterEquals(cR.op_BarGreaterGreater(ea.dsdDirectivesParser(),function(hY){return ea.dsdCfg(hY[0],hY[1]);}),function(hY){var hZ,h0,h1,h2,h3;hZ=hY[0];h0=hY[1];h1=h0[1];h2=h0[0];h3=bR.get_rules_program(h1);return h3!=null&&h3.$==1?cR.op_BarGreaterGreater(cR.op_DotGreaterGreater(cR.op_DotGreaterGreaterDot(cR.preturn([hZ,h2,h1,h3.$0]),ea.parse_ds()),cR.eof()),function(h4){var h5;h5=h4[0];return[[h5[0],h5[1],h5[2],{$:1,$0:h5[3]}],h4[1]];}):cR.op_BarGreaterGreater(cR.op_DotGreaterGreater(cR.op_DotGreaterGreaterDot(cR.preturn([hZ,h2,h1]),ea.parse_ds()),cR.eof()),function(h4){var h5;h5=h4[0];return[[h5[0],h5[1],h5[2],null],h4[1]];});});};fb.New=function(hI,hJ,hK){return{domain:hI,dom_colour:hJ,subdomains:hK};};fc.type_error=function(hI,hJ){var hK;if(hJ.$==1){hK=hJ.$1;if(hK.$==0)throw new f8.New(hI,{$:3,$0:hJ});else throw new f8.New(ec.getBeginPos(bX.head(hK)),{$:3,$0:hJ});}else throw new f8.New(hI,{$:3,$0:hJ});};fc.interacting_nontoehold_error=function(hI,hJ){throw new f8.New(null,{$:10,$0:hI,$1:hJ});};fc.dna_toe_error=function(hI){throw new f8.New(null,{$:6,$0:hI});};fc.dna_spec_error=function(hI){throw new f8.New(null,{$:7,$0:hI});};fc.dna_dup_error=function(hI){throw new f8.New(null,{$:5,$0:hI});};fc.dna_char_error=function(hI){throw new f8.New(null,{$:4,$0:hI});};fc.makeMessage=function(hI,hJ){var hK,hL;hK=fc.string_of_errorKind(hJ)+".";return hI!=null&&hI.$==1?(hL=hI.$0,ec.format_range(hL[0],hL[1])+": "+hK):hK;};fc.string_of_errorKind=function(hI){return hI.$==1?"Comment not terminated":hI.$==2?"Illegal character":hI.$==3?"Type error: "+fc.string_of_typeErrorKind(hI.$0):hI.$==4?"Illegal character \'"+dZ.string_of_char(hI.$0)+"\' in DNA sequence":hI.$==5?"Duplicate DNA sequence "+hI.$0:hI.$==6?"Toehold sequence "+hI.$0+" is longer than 9 nucleotides":hI.$==7?"Specificity sequence "+hI.$0+" is shorter than 10 nucleotides":hI.$==8?"Leak rate w "+dZ.paren(dZ.display_float(hI.$1))+" must be smaller than l "+dZ.paren(dZ.display_float(hI.$0)):hI.$==9?"Default toehold domain length "+dZ.paren(hH(hI.$0))+" must be shorter than default specificity domain lenghth "+dZ.paren(hH(hI.$1)):hI.$==10?"Non-toehold domains "+hI.$0+" and "+hI.$1+" are both exposed and could interact":hI.$==11?"Species "+hI.$0+" and "+hI.$1+" could interact to produce a polymer":hI.$==12?"Species "+hI.$0+" and "+hI.$1+" could interact to produce non-transient secondary structure":hI.$==13?"Species "+hI.$0+" contains neightbouring exposed toeholds "+hI.$1+" and "+hI.$2:"Syntax error: "+hI.$0;};fc.illegal_polymerisation_error=function(hI,hJ){throw new f8.New(null,{$:11,$0:hI,$1:hJ});};fc.string_of_typeErrorKind=function(hI){var hJ;return hI.$==1?"found "+ec.type_to_string(hI.$0)+" but expected "+ec.types_to_string(hI.$1)+"\\n("+hI.$2+")":hI.$==2?"module "+hI.$0+" applied to "+hH(hI.$1)+" arguments, expected "+hH(hI.$2):hI.$==4?(hJ=hI.$0,"domain is inconsistently used as a "+(hI.$1?" toe hold ":" normal strand ")+" but at "+ec.format_range(ec.rangeBegin(hJ),ec.rangeEnd(hJ))+" was used as the other"):hI.$==5?"species "+hI.$0+" within origami should contain one tethered domain":hI.$==6?"tethered domain "+hI.$0+" should not be found outside of an origami":hI.$==3?"module "+hI.$0+" applied to a tuple value of length "+hH(hI.$1)+", with a pattern expecting "+hH(hI.$2)+" values":hI.$==7?"declaration "+hI.$0+" contains more than one "+hI.$1+" specification":hI.$==8?"new "+hI.$0+" contains an unexpected seq specification":hI.$==9?"declaration "+hI.$0+" contains an unknown specification "+hI.$1:hI.$==10?"undefined module "+hI.$0+hI.$1:"unbound variable "+hI.$0;};fc.syntax_error=function(hI,hJ,hK){throw new f8.New({$:1,$0:[hI,hJ]},{$:0,$0:hK});};fd.New=function(hI,hJ,hK,hL,hM){return{ma_reactants:hI,ma_products:hJ,ma_catalysts:hK,ma_rate:hL,ma_reverseRate:hM};};fe.$cctor=function(){fe.$cctor=a.ignore;fe.empty=new cj.New([]);fe.filter=function(hI){return function(hJ){return bW.Filter(function(hK,hL){return(hI(hK))(hL);},hJ);};};};ff.$cctor=function(){ff.$cctor=a.ignore;ff.empty=el.New(bY.Empty,bY.Empty,bY.Empty);};fg.$cctor=function(){fg.$cctor=a.ignore;fg.bulge_lines=false;fg.debug_anchors=false;fg.empty_dstrand=gl.New(gm.DoubleStrand,bY.Empty);fg.empty_dsegment=gf.New(null,null,null,null,cM.empty_dstrand(),null,null,null);fg.branch_join_style="stroke-dasharray:4";fg.short_branch_join_style="";fg.short_branch_join=16;fg.half_separation=4;fg.font_size=15;fg.label_sep=11;fg.label_sep_rotated=7;fg.label_baseline=5;fg.label_baseline_nucleotides=4;fg.letter_width=8;fg.nucleotide_hairpin_factor=1.4;fg.pseudoknot_letter_width=9;fg.domain_pad=cM.letter_width()*4;fg.arc_domain_pad=cM.letter_width()*2;fg.arrow_angle=3.14159265358979/6;fg.arrow_length=15;fg.line_width=2.5;fg.margin=0.5;fg.extension_length=8;fg.overhang_angle=45;fg.base_class="svgdsd";fg.bulge_sep=16;fg.strut_len=cM.letter_width()*5;fg.species_skip=10;fg.origami_sep=dW.New(16,16);fg.origami_round=32;fg.palette=bX.ofArray(["red","green","blue","orange","purple","cyan","brown","magenta","dodgerblue","orchid","lawngreen","lightskyblue","darksalmon","teal","rosybrown","navajowhite","olive","darkseagreen","darkgoldenrod","pink"]);};fh.Adenine={$:0};fh.Cytosine={$:2};fh.Guanine={$:1};fh.Thymine={$:3};fi.Right={$:1};fi.Left={$:0};ei.free_names=function(hI){return hI.$==1?dZ.collect(eg.free_names,bX.append(hI.$0[0],bX.append(hI.$0[1],bX.append(hI.$0[2],hI.$0[3])))):dZ.collect(eg.free_names,bX.append(hI.$0[0],bX.append(hI.$0[1],bX.append(hI.$0[2],bX.append(hI.$0[3],hI.$0[4])))));};ei.matches=function(hI,hJ){return hI.$==1?hJ.$==1&&(eg.matches_list(hI.$0[0],hJ.$0[0])&&eg.matches_list(hI.$0[1],hJ.$0[1])&&eg.matches_list(hI.$0[2],hJ.$0[2])&&eg.matches_list(hI.$0[3],hJ.$0[3])&&cw.Equals(hI.$0[4],hJ.$0[4])):hJ.$==0&&(eg.matches_list(hI.$0[0],hJ.$0[0])&&eg.matches_list(hI.$0[1],hJ.$0[1])&&eg.matches_list(hI.$0[2],hJ.$0[2])&&eg.matches_list(hI.$0[3],hJ.$0[3])&&eg.matches_list(hI.$0[4],hJ.$0[4]));};ei.display=function(hI){var hJ;function hK(hL,hM){var hN;hN=hL?["<",">"]:["{","}"];return hM.$==0?"":hN[0]+eg.display_sequence(hM)+hN[1];}return hI.$==1?hI.$0[4].$==0?"<"+eg.display_sequence(hI.$0[3])+"}"+"["+eg.display_sequence(hI.$0[2])+"]"+hK(true,hI.$0[1])+hK(false,hI.$0[0]):(hJ="{"+eg.display_sequence(hI.$0[3])+">",hK(false,hI.$0[0])+hK(true,hI.$0[1])+"["+eg.display_sequence(hI.$0[2])+"]"+hJ):hK(false,hI.$0[0])+hK(true,hI.$0[1])+"["+eg.display_sequence(hI.$0[2])+"]"+hK(true,hI.$0[3])+hK(false,hI.$0[4]);};ei["eval"]=function(hI,hJ){function hK(hM){return eg.eval_sequence(hI,hM);}function hL(hM){return eg.eval_sequence(hI,hM);}return hJ.$==1?new ej({$:1,$0:[hK(hJ.$0[0]),hK(hJ.$0[1]),hK(hJ.$0[2]),hK(hJ.$0[3]),hJ.$0[4]]}):new ej({$:0,$0:[hL(hJ.$0[0]),hL(hJ.$0[1]),hL(hJ.$0[2]),hL(hJ.$0[3]),hL(hJ.$0[4])]});};ei.erasePosns=function(hI){function hJ(hK){return bX.map(eg.erasePosns,hK);}return hI.$==1?new ej({$:1,$0:[hJ(hI.$0[0]),hJ(hI.$0[1]),hJ(hI.$0[2]),hJ(hI.$0[3]),hI.$0[4]]}):new ej({$:0,$0:[hJ(hI.$0[0]),hJ(hI.$0[1]),hJ(hI.$0[2]),hJ(hI.$0[3]),hJ(hI.$0[4])]});};ei.domains=function(hI){return hI.$==1?bX.append(hI.$0[0],bX.append(hI.$0[1],bX.append(hI.$0[2],hI.$0[3]))):bX.append(hI.$0[0],bX.append(hI.$0[1],bX.append(hI.$0[2],bX.append(hI.$0[3],hI.$0[4]))));};ei.migrate_right_simple=function(hI,hJ){var hK;hK=ei.migrate_right(hI,hJ);return hK==null?[hI,hJ]:[hK.$0[0],hK.$0[1]];};ei.reverse=function(hI){return hI.$==1?hI.$0[4].$==1?new ej({$:1,$0:[bX.rev(hI.$0[0]),bX.rev(hI.$0[1]),bX.rev(hI.$0[2]),bX.rev(hI.$0[3]),fi.Left]}):new ej({$:1,$0:[bX.rev(hI.$0[0]),bX.rev(hI.$0[1]),bX.rev(hI.$0[2]),bX.rev(hI.$0[3]),fi.Right]}):new ej({$:0,$0:[bX.rev(hI.$0[4]),bX.rev(hI.$0[3]),bX.rev(hI.$0[2]),bX.rev(hI.$0[1]),bX.rev(hI.$0[0])]});};ei.mirror=function(hI){return hI.$==1?new ej({$:1,$0:[hI.$0[1],hI.$0[0],bX.map(eg.complement,hI.$0[2]),bX.rev(hI.$0[3]),hI.$0[4]]}):new ej({$:0,$0:[hI.$0[1],hI.$0[0],bX.map(eg.complement,hI.$0[2]),hI.$0[4],hI.$0[3]]});};ei.inferType=function(hI,hJ,hK){if(hK.$==1)bX.iter(function(hL){eg.inferType(hI,hJ,hL);},bX.append(hK.$0[0],bX.append(hK.$0[1],bX.append(hK.$0[2],hK.$0[3]))));else bX.iter(function(hL){eg.inferType(hI,hJ,hL);},bX.append(hK.$0[0],bX.append(hK.$0[1],bX.append(hK.$0[2],bX.append(hK.$0[3],hK.$0[4])))));};ei.migrate_right=function(hI,hJ){var hK,hL,hM,hN,hO,hP,hQ,hR,hS;switch(hI.$==1?hI.$0[0].$==0?hI.$0[4].$==0?hJ.$==1?hJ.$0[0].$==0?hJ.$0[4].$==1?(hK=[hI.$0[3],hJ.$0[3],hI.$0[1],hJ.$0[1],hI.$0[2],hJ.$0[2]],3):4:4:hJ.$0[0].$==0?(hK=[hI.$0[3],hJ.$0[1],hI.$0[1],hJ.$0[4],hJ.$0[3],hI.$0[2],hJ.$0[2]],1):4:4:4:hI.$0[4].$==0?hJ.$==1?hJ.$0[0].$==0?hJ.$0[4].$==1?(hK=[hJ.$0[3],hI.$0[0],hI.$0[1],hJ.$0[1],hI.$0[3],hI.$0[2],hJ.$0[2]],2):4:4:hJ.$0[0].$==0?(hK=[hI.$0[0],hI.$0[1],hJ.$0[1],hJ.$0[4],hI.$0[3],hJ.$0[3],hI.$0[2],hJ.$0[2]],0):4:4){case 0:hL=ei.swap_shared_domains_head(hK[7],hK[4]);return hL[0].$==0?null:hL[2].$==0?null:(hM=hL[1],{$:1,$0:[new ej({$:0,$0:[hK[0],hK[1],bX.append(hK[6],hL[0]),hL[3],bY.Empty]}),new ej({$:0,$0:[bY.Empty,bX.append(hK[2],hM),hL[2],hK[5],hK[3]]}),hM]});case 1:hN=ei.swap_shared_domains_head(hK[6],hK[2]);return hN[0].$==0?null:hN[2].$==0?null:(hO=hN[1],{$:1,$0:[new ej({$:1,$0:[bY.Empty,hN[3],bX.append(hK[5],hN[0]),hK[0],fi.Left]}),new ej({$:0,$0:[bY.Empty,bX.append(hK[1],hO),hN[2],hK[4],hK[3]]}),hO]});case 2:hP=ei.swap_shared_domains_head(hK[6],hK[4]);return hP[0].$==0?null:hP[2].$==0?null:(hQ=hP[1],{$:1,$0:[new ej({$:0,$0:[hK[1],hK[2],bX.append(hK[5],hP[0]),hP[3],bY.Empty]}),new ej({$:1,$0:[bY.Empty,bX.append(hK[3],hQ),hP[2],hK[0],fi.Right]}),hQ]});case 3:hR=ei.swap_shared_domains_head(hK[5],hK[2]);return hR[0].$==0?null:hR[2].$==0?null:(hS=hR[1],{$:1,$0:[new ej({$:1,$0:[bY.Empty,hR[3],bX.append(hK[4],hR[0]),hK[0],fi.Left]}),new ej({$:1,$0:[bY.Empty,bX.append(hK[3],hS),hR[2],hK[1],fi.Right]}),hS]});case 4:return null;}};ei.exposed_nontoeholds=function(hI){function hJ(hL){return!hL;}function hK(hL){return!hL;}return hI.$==1?bX.filter(function(hL){return hJ(eg.is_toehold(hL));},bX.append(hI.$0[0],hI.$0[1])):bX.filter(function(hL){return hK(eg.is_toehold(hL));},bX.append(hI.$0[0],bX.append(hI.$0[1],bX.append(hI.$0[3],hI.$0[4]))));};ei.leak_sg=function(hI,hJ){var hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0,h1,h2,h3,h4,h7,h8,h9,h_,h$;function h5(ib,ic){return!dZ.is_first(hU,ic)?bX.ofArray([[new ej({$:0,$0:[hO,ib,hV,ic,new bY({$:1,$0:eg.complement(hU),$1:hQ})]}),em.mk_upper(bX.append(hP,bX.append(hV,bX.append(bX.ofArray([hU]),hR)))),true]]):bY.Empty;}function h6(ib,ic){return!dZ.is_last(h3,ib)?bX.ofArray([[new ej({$:0,$0:[bX.append(hX,bX.ofArray([eg.complement(h3)])),ib,h4,ic,hZ]}),em.mk_upper(bX.append(hY,bX.append(bX.ofArray([h3]),bX.append(h4,h0)))),true]]):bY.Empty;}function ia(ib,ic){return[new ej({$:0,$0:[h7,ib,h$,ic,h9]}),em.mk_upper(bX.append(h8,bX.append(h$,h_))),true];}if(hI.$==0&&(hJ.$==0&&(hL=[hI.$0[0],hI.$0[1],hJ.$0,hI.$0[4],hI.$0[3],hI.$0[2]],true))){h7=hL[0];h8=hL[1];h9=hL[3];h_=hL[4];h$=hL[5];switch(h$.$==1?h$.$0.$==0?h$.$1.$==0?1:2:2:0){case 0:hK=be.FailWith("Segment.leak: empty double strand");break;case 1:hK=bY.Empty;break;case 2:hK=bX.map(function(ib){return ia(ib[0],ib[1]);},dZ.split_around_sublist(h$,hL[2]));break;}}else hK=bY.Empty;return bX.append(hK,bX.append(hI.$==0&&(hJ.$==0&&(hN=[hI.$0[0],hI.$0[1],hJ.$0,hI.$0[4],hI.$0[3],hI.$0[2]],true))?(hO=hN[0],(hP=hN[1],(hQ=hN[3],(hR=hN[4],(hS=dZ.get_last_element(hN[5]),hS!=null&&hS.$==1&&(hS.$0[1].$==0&&(hS.$0[0].$!==0&&(hT=[hS.$0[1],hS.$0[0]],true)))?(hU=hT[0],(hV=hT[1],dZ.collect(function(ib){return h5(ib[0],ib[1]);},dZ.split_around_sublist(hV,hN[2])))):bY.Empty))))):bY.Empty,bX.append(hI.$==0&&(hJ.$==0&&(hW=[hI.$0[0],hI.$0[1],hJ.$0,hI.$0[4],hI.$0[3],hI.$0[2]],true))?(hX=hW[0],(hY=hW[1],(hZ=hW[3],(h0=hW[4],(h1=hW[5],h1.$==1&&(h1.$0.$==0&&(h1.$1.$!==0&&(h2=[h1.$0,h1.$1],true)))?(h3=h2[0],(h4=h2[1],dZ.collect(function(ib){return h6(ib[0],ib[1]);},dZ.split_around_sublist(h4,hW[2])))):bY.Empty))))):bY.Empty,bY.Empty)));};ei.migrate_left_simple=function(hI,hJ){var hK;hK=ei.migrate_left(hI,hJ);return hK==null?[hI,hJ]:[hK.$0[0],hK.$0[1]];};ei.stick_sg=function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ,hR,hU,hV,hW,hY,hZ,h0;function hS(h2,h3){var h4,h5,h6;h4=h2[1];h5=h3[1];h6=ei.stick(h4[0],h4[1],h5[0],h5[1]);return[new ej({$:0,$0:[h3[0],h2[0],h6[1],h2[2],h3[2]]}),new ej({$:0,$0:[bY.Empty,hN,hR,hQ,hP]}),h6[0],false];}function hT(h2,h3){var h4,h5,h6;h4=h2[1];h5=h3[1];h6=ei.stick(h4[0],h4[1],h5[0],h5[1]);return[new ej({$:0,$0:[hM,hN,hR,hQ,h3[0]]}),new ej({$:0,$0:[bY.Empty,h2[0],h6[1],h2[2],h3[2]]}),h6[0],true];}function hX(h2,h3){var h4,h5,h6;h4=h2[1];h5=h3[1];h6=ei.stick(h4[0],h4[1],h5[0],h5[1]);return[new ej({$:0,$0:[h3[0],h2[0],h6[1],h2[2],h3[2]]}),new ej({$:1,$0:[bY.Empty,hV,hW,hU,fi.Right]}),h6[0],false];}function h1(h2,h3){var h4,h5,h6;h4=h2[1];h5=h3[1];h6=ei.stick(h4[0],h4[1],h5[0],h5[1]);return[new ej({$:1,$0:[h3[0],hZ,h0,hY,fi.Left]}),new ej({$:0,$0:[bY.Empty,h2[0],h6[1],h2[2],h3[2]]}),h6[0],true];}switch(hJ.$==1?hJ.$0[4].$==0?hK.$==0?(hL=[hJ.$0[3],hK.$0,hJ.$0[0],hJ.$0[1],hJ.$0[2]],2):3:hK.$==0?(hL=[hJ.$0[3],hK.$0,hJ.$0[0],hJ.$0[1],hJ.$0[2]],1):3:hK.$==0?(hL=[hJ.$0[0],hJ.$0[1],hK.$0,hJ.$0[4],hJ.$0[3],hJ.$0[2]],0):3){case 0:hM=hL[0];hN=hL[1];hO=hL[2];hP=hL[3];hQ=hL[4];hR=hL[5];return bX.append(bX.map(function(h2){return hS(h2[0],h2[1]);},eg.matching_toeholds(hI,hO,hM)),bX.map(function(h2){return hT(h2[0],h2[1]);},eg.matching_toeholds(hI,hO,hP)));case 1:hU=hL[0];hV=hL[3];hW=hL[4];return bX.map(function(h2){return hX(h2[0],h2[1]);},eg.matching_toeholds(hI,hL[1],hL[2]));case 2:hY=hL[0];hZ=hL[3];h0=hL[4];return bX.map(function(h2){return h1(h2[0],h2[1]);},eg.matching_toeholds(hI,hL[1],hL[2]));case 3:return bY.Empty;}};ei.migrate_left=function(hI,hJ){var hK,hL,hM,hN,hO,hP,hQ,hR,hS;switch(hI.$==1?hI.$0[0].$==0?hI.$0[4].$==0?hJ.$==1?hJ.$0[0].$==0?hJ.$0[4].$==1?(hK=[hI.$0[3],hJ.$0[3],hI.$0[1],hJ.$0[1],hI.$0[2],hJ.$0[2]],3):4:4:hJ.$0[0].$==0?(hK=[hI.$0[3],hJ.$0[1],hI.$0[1],hJ.$0[4],hJ.$0[3],hI.$0[2],hJ.$0[2]],1):4:4:4:hI.$0[4].$==0?hJ.$==1?hJ.$0[0].$==0?hJ.$0[4].$==1?(hK=[hJ.$0[3],hI.$0[0],hI.$0[1],hJ.$0[1],hI.$0[3],hI.$0[2],hJ.$0[2]],2):4:4:hJ.$0[0].$==0?(hK=[hI.$0[0],hI.$0[1],hJ.$0[1],hJ.$0[4],hI.$0[3],hJ.$0[3],hI.$0[2],hJ.$0[2]],0):4:4){case 0:hL=ei.swap_shared_domains_tail(hK[6],hK[2]);return hL[0].$==0?null:hL[2].$==0?null:(hM=hL[1],{$:1,$0:[new ej({$:0,$0:[hK[0],hK[1],hL[2],bX.append(hM,hK[4]),bY.Empty]}),new ej({$:0,$0:[bY.Empty,hL[3],bX.append(hL[0],hK[7]),hK[5],hK[3]]}),hM]});case 1:hN=ei.swap_shared_domains_tail(hK[5],hK[1]);return hN[0].$==0?null:hN[2].$==0?null:(hO=hN[1],{$:1,$0:[new ej({$:1,$0:[bY.Empty,bX.append(hO,hK[2]),hN[2],hK[0],fi.Left]}),new ej({$:0,$0:[bY.Empty,hN[3],bX.append(hN[0],hK[6]),hK[4],hK[3]]}),hO]});case 2:hP=ei.swap_shared_domains_tail(hK[5],hK[3]);return hP[0].$==0?null:hP[2].$==0?null:(hQ=hP[1],{$:1,$0:[new ej({$:0,$0:[hK[1],hK[2],hP[2],bX.append(hQ,hK[4]),bY.Empty]}),new ej({$:1,$0:[bY.Empty,hP[3],bX.append(hP[0],hK[6]),hK[0],fi.Right]}),hQ]});case 3:hR=ei.swap_shared_domains_tail(hK[4],hK[3]);return hR[0].$==0?null:hR[2].$==0?null:(hS=hR[1],{$:1,$0:[new ej({$:1,$0:[bY.Empty,bX.append(hS,hK[2]),hR[2],hK[0],fi.Left]}),new ej({$:1,$0:[bY.Empty,hR[3],bX.append(hR[0],hK[5]),hK[1],fi.Right]}),hS]});case 4:return null;}};ei.displace_left=function(hI,hJ){var hK,hL,hM,hN,hO;switch(hI.$==0?hI.$0[4].$==0?hJ.$==1?hJ.$0[0].$==0?hJ.$0[4].$==1?(hK=[hJ.$0[3],hI.$0[0],hI.$0[1],hJ.$0[1],hI.$0[3],hI.$0[2],hJ.$0[2]],1):2:2:hJ.$0[0].$==0?(hK=[hI.$0[0],hI.$0[1],hJ.$0[1],hJ.$0[4],hI.$0[3],hJ.$0[3],hI.$0[2],hJ.$0[2]],0):2:2:2){case 0:hL=hK[6];hM=ei.swap_shared_domains_tail(hL,hK[2]);return hM[0].$==0?null:hM[2].$==0?{$:1,$0:[new ej({$:0,$0:[hK[0],hM[3],bX.append(hM[0],hK[7]),hK[5],hK[3]]}),{$:0,$0:bX.append(hK[1],bX.append(hM[1],hK[4]))},hL]}:null;case 1:hN=hK[5];hO=ei.swap_shared_domains_tail(hN,hK[3]);return hO[0].$==0?null:hO[2].$==0?{$:1,$0:[new ej({$:1,$0:[hK[1],hO[3],bX.append(hO[0],hK[6]),hK[0],fi.Right]}),{$:0,$0:bX.append(hK[2],bX.append(hO[1],hK[4]))},hN]}:null;case 2:return null;}};ei.migrate_open_left=function(hI,hJ){var hK,hL,hM,hN,hO,hP;switch(hI.$==1?hI.$0[0].$==0?hI.$0[4].$==0?hJ.$==1?hJ.$0[0].$==0?hJ.$0[4].$==1?(hK=[hI.$0[3],hJ.$0[3],hJ.$0[1],hI.$0[2],hJ.$0[2]],1):2:2:hJ.$0[0].$==0?(hK=[hI.$0[3],hJ.$0[1],hI.$0[1],hJ.$0[4],hJ.$0[3],hI.$0[2],hJ.$0[2]],0):2:2:2:2){case 0:hL=ei.swap_shared_domains_tail(hK[5],hK[1]);return hL[0].$==0?null:hL[2].$==0?(hM=hL[1],{$:1,$0:[new ej({$:0,$0:[bX.append(bX.rev(hK[2]),bX.append(bX.rev(hM),hK[0])),hL[3],bX.append(hL[0],hK[6]),hK[4],hK[3]]}),hM]}):null;case 1:hN=hK[2];hO=ei.swap_shared_domains_tail(hK[3],hN);return hO[0].$==0?null:hO[2].$==0?(hP=hO[1],{$:1,$0:[new ej({$:1,$0:[bX.append(bX.rev(hN),bX.append(bX.rev(hP),hK[0])),hO[3],bX.append(hO[0],hK[4]),hK[1],fi.Right]}),hP]}):null;case 2:return null;}};ei.displace_right=function(hI,hJ){var hK,hL,hM,hN,hO;switch(hI.$==1?hI.$0[0].$==0?hI.$0[4].$==0?hJ.$==0?hJ.$0[0].$==0?(hK=[hI.$0[3],hJ.$0[1],hI.$0[1],hJ.$0[4],hJ.$0[3],hI.$0[2],hJ.$0[2]],1):2:2:2:2:hI.$0[4].$==0?hJ.$==0?hJ.$0[0].$==0?(hK=[hI.$0[0],hI.$0[1],hJ.$0[1],hJ.$0[4],hI.$0[3],hJ.$0[3],hI.$0[2],hJ.$0[2]],0):2:2:2){case 0:hL=hK[7];hM=ei.swap_shared_domains_head(hL,hK[4]);return hM[0].$==0?null:hM[2].$==0?{$:1,$0:[new ej({$:0,$0:[hK[0],hK[1],bX.append(hK[6],hM[0]),hM[3],hK[3]]}),{$:0,$0:bX.append(hK[2],bX.append(hM[1],hK[5]))},hL]}:null;case 1:hN=hK[6];hO=ei.swap_shared_domains_head(hN,hK[2]);return hO[0].$==0?null:hO[2].$==0?{$:1,$0:[new ej({$:1,$0:[hK[3],hO[3],bX.append(hK[5],hO[0]),hK[0],fi.Left]}),{$:0,$0:bX.append(hK[1],bX.append(hO[1],hK[4]))},hN]}:null;case 2:return null;}};ei.migrate_open_right=function(hI,hJ){var hK,hL,hM,hN,hO;switch(hI.$==1?hI.$0[0].$==0?hI.$0[4].$==0?hJ.$==1?hJ.$0[0].$==0?hJ.$0[4].$==1?(hK=[hI.$0[3],hJ.$0[3],hI.$0[1],hJ.$0[1],hI.$0[2],hJ.$0[2]],1):2:2:2:2:2:hI.$0[4].$==0?hJ.$==1?hJ.$0[0].$==0?hJ.$0[4].$==1?(hK=[hJ.$0[3],hI.$0[0],hI.$0[1],hJ.$0[1],hI.$0[3],hI.$0[2],hJ.$0[2]],0):2:2:2:2){case 0:hL=ei.swap_shared_domains_head(hK[6],hK[4]);return hL[0].$==0?null:hL[2].$==0?(hM=hL[1],{$:1,$0:[new ej({$:0,$0:[hK[1],hK[2],bX.append(hK[5],hL[0]),hL[3],bX.append(hK[0],bX.append(bX.rev(hM),bX.rev(hK[3])))]}),hM]}):null;case 1:hN=ei.swap_shared_domains_head(hK[5],hK[2]);return hN[0].$==0?null:hN[2].$==0?(hO=hN[1],{$:1,$0:[new ej({$:1,$0:[bX.append(hK[1],bX.append(bX.rev(hO),bX.rev(hK[3]))),hN[3],bX.append(hK[4],hN[0]),hK[0],fi.Left]}),hO]}):null;case 2:return null;}};ei.cover_left=function(hI){var hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU;return hI.$==1?hI.$0[4].$==1?(hJ=dZ.get_last_element(hI.$0[0]),(hK=dZ.get_last_element(hI.$0[1]),hJ!=null&&hJ.$==1&&(hJ.$0[1].$==0&&(hK!=null&&hK.$==1&&(hK.$0[1].$==0&&(hL=[hK.$0[1],hJ.$0[1],hJ.$0[0],hK.$0[0]],true))))?(hM=hL[0],(hN=hL[1],eg.are_complements(hM,hN)?(hO=eg.stick(hM,hN),{$:1,$0:[new ej({$:1,$0:[hL[2],hL[3],new bY({$:1,$0:hO,$1:hI.$0[2]}),hI.$0[3],fi.Right]}),hO]}):null)):null)):null:(hP=dZ.get_last_element(hI.$0[0]),(hQ=dZ.get_last_element(hI.$0[1]),hP!=null&&hP.$==1&&(hP.$0[1].$==0&&(hQ!=null&&hQ.$==1&&(hQ.$0[1].$==0&&(hR=[hP.$0[0],hQ.$0[0],hQ.$0[1],hP.$0[1]],true))))?(hS=hR[2],(hT=hR[3],eg.are_complements(hS,hT)?(hU=eg.stick(hS,hT),{$:1,$0:[new ej({$:0,$0:[hR[0],hR[1],new bY({$:1,$0:hU,$1:hI.$0[2]}),hI.$0[3],hI.$0[4]]}),hU]}):null)):null));};ei.cover_right=function(hI){var hJ,hK,hL,hM,hN,hO;switch(hI.$==1?hI.$0[0].$==1?hI.$0[0].$0.$==0?hI.$0[1].$==1?hI.$0[1].$0.$==0?hI.$0[4].$==0?(hJ=[hI.$0[3],hI.$0[0].$0,hI.$0[1].$0,hI.$0[0].$1,hI.$0[1].$1,hI.$0[2]],1):2:2:2:2:2:hI.$0[3].$==1?hI.$0[3].$0.$==0?hI.$0[4].$==1?hI.$0[4].$0.$==0?(hJ=[hI.$0[0],hI.$0[1],hI.$0[3].$0,hI.$0[4].$0,hI.$0[4].$1,hI.$0[3].$1,hI.$0[2]],0):2:2:2:2){case 0:hK=hJ[2];hL=hJ[3];return eg.are_complements(hK,hL)?(hM=eg.stick(hK,hL),{$:1,$0:[new ej({$:0,$0:[hJ[0],hJ[1],bX.append(hJ[6],bX.ofArray([hM])),hJ[5],hJ[4]]}),hM]}):null;case 1:hN=hJ[1];hO=hJ[2];return eg.are_complements(hN,hO)?{$:1,$0:[new ej({$:1,$0:[hJ[3],hJ[4],bX.append(hJ[5],bX.ofArray([eg.stick(hO,hN)])),hJ[0],fi.Left]}),hN]}:null;case 2:return null;}};ei.stick_ss=function(hI,hJ,hK){var hL;function hM(hN,hO){var hP,hQ,hR;hP=hN[1];hQ=hO[1];hR=ei.stick(hP[0],hP[1],hQ[0],hQ[1]);return[new ej({$:0,$0:[hO[0],hN[0],hR[1],hN[2],hO[2]]}),hR[0]];}return(hJ.$==1?hK.$==0&&(hL=[hJ.$0,hK.$0],true):hK.$==1&&(hL=[hK.$0,hJ.$0],true))?bX.map(function(hN){return hM(hN[0],hN[1]);},eg.matching_toeholds(hI,hL[1],hL[0])):bY.Empty;};ei.pin_strand=function(hI){return hI.$==1?bX.map(function(hJ){var hK;hK=ei.stick_simple(hJ[1],hJ[3]);return[new ej({$:1,$0:[hJ[4],hJ[0],hK[1],hJ[2],fi.Left]}),hK[0]];},eg.internal_complements(hI.$0)):bX.map(function(hJ){var hK;hK=ei.stick_simple(hJ[1],hJ[3]);return[new ej({$:1,$0:[hJ[4],hJ[0],hK[1],hJ[2],fi.Right]}),hK[0]];},eg.internal_complements(hI.$0));};ei.close_lower_left_open=function(hI){var hJ,hK,hL,hM;function hN(hO,hP,hQ,hR,hS){return hR.$==0?bY.Empty:bX.ofArray([[hO,new ej({$:1,$0:[bX.append(hK,bX.append(bX.rev(hM),bX.rev(hL))),hS,hP,hO,fi.Left]}),hQ]]);}switch(hI.$==1?hI.$0[0].$==0?0:hI.$0[4].$==1?(hJ=[hI.$0[3],hI.$0[0],hI.$0[1],hI.$0[2]],1):2:2){case 0:return bY.Empty;case 1:hK=hJ[0];hL=hJ[2];hM=hJ[3];return bX.collect(function(hO){return hN(hO[0],hO[1],hO[2],hO[3],hO[4]);},ei.swap_shared_domains_middle(hM,bX.rev(hJ[1])));case 2:return bY.Empty;}};ei.close_lower_left_displace=function(hI){var hJ,hK,hL;function hM(hN,hO,hP,hQ,hR){return hQ.$==0?bX.ofArray([[hN,new ej({$:1,$0:[hK,hR,hO,hN,fi.Left]}),{$:0,$0:bX.append(hJ,bX.append(hP,hL))},hP]]):bY.Empty;}return hI.$==0?hI.$0[0].$==0?bY.Empty:(hJ=hI.$0[1],(hK=hI.$0[4],(hL=hI.$0[3],bX.collect(function(hN){return hM(hN[0],hN[1],hN[2],hN[3],hN[4]);},ei.swap_shared_domains_middle(hI.$0[2],bX.rev(hI.$0[0])))))):bY.Empty;};ei.close_lower_left_migrate=function(hI){var hJ,hK,hL,hM,hN;function hO(hQ,hR,hS,hT,hU){return hT.$==0?bY.Empty:bX.ofArray([[hQ,new ej({$:1,$0:[bY.Empty,hU,hR,hQ,fi.Left]}),new ej({$:1,$0:[bY.Empty,bX.append(hK,hR),hT,hJ,fi.Right]}),hS]]);}function hP(hQ,hR,hS,hT,hU){return hT.$==0?bY.Empty:bX.ofArray([[hQ,new ej({$:1,$0:[bY.Empty,hU,hR,hQ,fi.Left]}),new ej({$:0,$0:[bY.Empty,bX.append(hL,hR),hT,hN,hM]}),hS]]);}return hI.$==1?hI.$0[0].$==0?bY.Empty:hI.$0[4].$==1?(hJ=hI.$0[3],(hK=hI.$0[1],bX.collect(function(hQ){return hO(hQ[0],hQ[1],hQ[2],hQ[3],hQ[4]);},ei.swap_shared_domains_middle(hI.$0[2],bX.rev(hI.$0[0]))))):bY.Empty:hI.$0[0].$==0?bY.Empty:(hL=hI.$0[1],(hM=hI.$0[4],(hN=hI.$0[3],bX.collect(function(hQ){return hP(hQ[0],hQ[1],hQ[2],hQ[3],hQ[4]);},ei.swap_shared_domains_middle(hI.$0[2],bX.rev(hI.$0[0]))))));};ei.pin_segment=function(hI){var hJ,hK,hL,hM,hN,hO,hP,hQ,hR;return hI.$==1?hI.$0[4].$==1?(hJ=hI.$0[1],(hK=hI.$0[2],bX.map(function(hS){var hT,hU;hT=hS[2];hU=ei.stick_simple(hS[1],hS[3]);return[new ej({$:1,$0:[hS[4],hS[0],hU[1],hT,fi.Left]}),new ej({$:1,$0:[bY.Empty,hJ,hK,hT,fi.Right]}),hU[0],false];},eg.internal_complements(hI.$0[0])))):(hL=hI.$0[1],(hM=hI.$0[2],bX.map(function(hS){var hT,hU;hT=hS[2];hU=ei.stick_simple(hS[3],hS[1]);return[new ej({$:1,$0:[bY.Empty,hL,hM,hT,fi.Left]}),new ej({$:1,$0:[hS[0],bX.rev(hS[4]),hU[1],hT,fi.Right]}),hU[0],true];},eg.internal_complements(hI.$0[0])))):(hN=hI.$0[0],(hO=hI.$0[1],(hP=hI.$0[4],(hQ=hI.$0[3],(hR=hI.$0[2],bX.append(bX.map(function(hS){var hT;hT=ei.stick_simple(hS[1],hS[3]);return[new ej({$:1,$0:[hS[4],hS[0],hT[1],hS[2],fi.Left]}),new ej({$:0,$0:[bY.Empty,hO,hR,hQ,hP]}),hT[0],false];},eg.internal_complements(hN)),bX.map(function(hS){var hT;hT=ei.stick_simple(hS[3],hS[1]);return[new ej({$:0,$0:[hN,hO,hR,hQ,bY.Empty]}),new ej({$:1,$0:[hS[0],bX.rev(hS[4]),hT[1],hS[2],fi.Right]}),hT[0],true];},eg.internal_complements(hP))))))));};ei.stick_gg=function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hY,hZ,h0,h1,h2,h3,h4,h5,h6,h9,h_,h$,ia,ib,ic,id,ie,_if,ii,ij,ik,il,im,_in,io,ip;function hW(is,it){var iu,iv,iw;iu=is[1];iv=it[1];iw=ei.stick(iu[0],iu[1],iv[0],iv[1]);return[new ej({$:0,$0:[hM,hO,hU,bY.Empty,hQ]}),new ej({$:0,$0:[it[0],is[0],iw[1],is[2],it[2]]}),new ej({$:0,$0:[bY.Empty,hP,hV,hT,hR]}),iw[0],true];}function hX(is,it){var iu,iv,iw;iu=is[1];iv=it[1];iw=ei.stick(iu[0],iu[1],iv[0],iv[1]);return[new ej({$:0,$0:[hM,hO,hU,hS,bY.Empty]}),new ej({$:0,$0:[it[0],is[0],iw[1],is[2],it[2]]}),new ej({$:0,$0:[hN,bY.Empty,hV,hT,hR]}),iw[0],false];}function h7(is,it){var iu,iv,iw;iu=is[1];iv=it[1];iw=ei.stick(iu[0],iu[1],iv[0],iv[1]);return[new ej({$:0,$0:[hZ,h0,h5,bY.Empty,h3]}),new ej({$:0,$0:[it[0],is[0],iw[1],is[2],it[2]]}),new ej({$:1,$0:[bY.Empty,h2,h6,hY,fi.Right]}),iw[0],true];}function h8(is,it){var iu,iv,iw;iu=is[1];iv=it[1];iw=ei.stick(iv[0],iv[1],iu[0],iu[1]);return[new ej({$:0,$0:[hZ,h0,h5,h4,bY.Empty]}),new ej({$:0,$0:[is[0],it[0],iw[1],it[2],is[2]]}),new ej({$:1,$0:[h1,bY.Empty,h6,hY,fi.Right]}),iw[0],false];}function ig(is,it){var iu,iv,iw;iu=is[1];iv=it[1];iw=ei.stick(iu[0],iu[1],iv[0],iv[1]);return[new ej({$:1,$0:[ia,bY.Empty,ie,h9,fi.Left]}),new ej({$:0,$0:[it[0],is[0],iw[1],is[2],it[2]]}),new ej({$:0,$0:[bY.Empty,h$,_if,id,ic]}),iw[0],true];}function ih(is,it){var iu,iv,iw;iu=is[1];iv=it[1];iw=ei.stick(iv[0],iv[1],iu[0],iu[1]);return[new ej({$:1,$0:[bY.Empty,ib,ie,h9,fi.Left]}),new ej({$:0,$0:[is[0],it[0],iw[1],it[2],is[2]]}),new ej({$:0,$0:[h_,bY.Empty,_if,id,ic]}),iw[0],false];}function iq(is,it){var iu,iv,iw;iu=is[1];iv=it[1];iw=ei.stick(iu[0],iu[1],iv[0],iv[1]);return[new ej({$:1,$0:[ik,bY.Empty,io,ii,fi.Left]}),new ej({$:0,$0:[it[0],is[0],iw[1],is[2],it[2]]}),new ej({$:1,$0:[bY.Empty,_in,ip,ij,fi.Right]}),iw[0],true];}function ir(is,it){var iu,iv,iw;iu=is[1];iv=it[1];iw=ei.stick(iv[0],iv[1],iu[0],iu[1]);return[new ej({$:1,$0:[bY.Empty,im,io,ii,fi.Left]}),new ej({$:0,$0:[is[0],it[0],iw[1],it[2],is[2]]}),new ej({$:1,$0:[il,bY.Empty,ip,ij,fi.Right]}),iw[0],false];}switch(hJ.$==1?hJ.$0[4].$==0?hK.$==1?hK.$0[4].$==1?(hL=[hJ.$0[3],hK.$0[3],hJ.$0[0],hK.$0[0],hJ.$0[1],hK.$0[1],hJ.$0[2],hK.$0[2]],3):4:(hL=[hJ.$0[3],hK.$0[0],hK.$0[1],hJ.$0[0],hJ.$0[1],hK.$0[4],hK.$0[3],hJ.$0[2],hK.$0[2]],2):4:hK.$==1?hK.$0[4].$==1?(hL=[hK.$0[3],hJ.$0[0],hJ.$0[1],hK.$0[0],hK.$0[1],hJ.$0[4],hJ.$0[3],hJ.$0[2],hK.$0[2]],1):4:(hL=[hJ.$0[0],hK.$0[0],hJ.$0[1],hK.$0[1],hJ.$0[4],hK.$0[4],hJ.$0[3],hK.$0[3],hJ.$0[2],hK.$0[2]],0)){case 0:hM=hL[0];hN=hL[1];hO=hL[2];hP=hL[3];hQ=hL[4];hR=hL[5];hS=hL[6];hT=hL[7];hU=hL[8];hV=hL[9];return bX.append(bX.map(function(is){return hW(is[0],is[1]);},eg.matching_toeholds(hI,hS,hN)),bX.map(function(is){return hX(is[0],is[1]);},eg.matching_toeholds(hI,hP,hQ)));case 1:hY=hL[0];hZ=hL[1];h0=hL[2];h1=hL[3];h2=hL[4];h3=hL[5];h4=hL[6];h5=hL[7];h6=hL[8];return bX.append(bX.map(function(is){return h7(is[0],is[1]);},eg.matching_toeholds(hI,h4,h1)),bX.map(function(is){return h8(is[0],is[1]);},eg.matching_toeholds(hI,h3,h2)));case 2:h9=hL[0];h_=hL[1];h$=hL[2];ia=hL[3];ib=hL[4];ic=hL[5];id=hL[6];ie=hL[7];_if=hL[8];return bX.append(bX.map(function(is){return ig(is[0],is[1]);},eg.matching_toeholds(hI,ib,h_)),bX.map(function(is){return ih(is[0],is[1]);},eg.matching_toeholds(hI,ia,h$)));case 3:ii=hL[0];ij=hL[1];ik=hL[2];il=hL[3];im=hL[4];_in=hL[5];io=hL[6];ip=hL[7];return bX.append(bX.map(function(is){return iq(is[0],is[1]);},eg.matching_toeholds(hI,im,il)),bX.map(function(is){return ir(is[0],is[1]);},eg.matching_toeholds(hI,ik,_in)));case 4:return bY.Empty;}};ei.unbind_open_gg_ucon=function(hI,hJ){var hK,hL;return hI.$==1&&(hI.$0[4].$==0&&(hJ.$==0&&(hK=[hJ.$0[0],hJ.$0[1],hJ.$0[4],hJ.$0[3],hJ.$0[2]],true)))?(hL=ei.unbind_open_down(hI),hL!=null&&hL.$==1?hL.$0[0].$==0?{$:1,$0:[new ej({$:0,$0:[hK[0],bX.append(hL.$0[0].$0,hK[1]),hK[4],hK[3],hK[2]]}),hL.$0[1]]}:be.FailWith("unbind_open_down only returns upper strands"):null):null;};ei.unbind_open_down=function(hI){var hJ,hK,hL;return hI.$==1&&(hI.$0[2].$==1&&(hI.$0[2].$0.$==0&&(hI.$0[2].$1.$==0&&(hI.$0[4].$==0&&(hJ=[hI.$0[3],hI.$0[0],hI.$0[1],hI.$0[2].$0],true)))))?(hK=eg.unstick(hJ[3]),(hL=hK[0],{$:1,$0:[{$:0,$0:bX.append(bX.rev(hJ[1]),bX.append(bX.ofArray([hK[1]]),bX.append(bX.rev(hJ[0]),bX.append(bX.ofArray([hL]),hJ[2]))))},hL]})):null;};ei.unbind_open_gg_lcon=function(hI,hJ){var hK,hL;return hI.$==1&&(hI.$0[4].$==0&&(hJ.$==0&&(hK=[hJ.$0[0],hJ.$0[1],hJ.$0[4],hJ.$0[3],hJ.$0[2]],true)))?(hL=ei.unbind_open_up(hI),hL!=null&&hL.$==1?hL.$0[0].$==1?{$:1,$0:[new ej({$:0,$0:[bX.append(hL.$0[0].$0,hK[0]),hK[1],hK[4],hK[3],hK[2]]}),hL.$0[1]]}:be.FailWith("unbind_open_up only returns lower strands"):null):null;};ei.unstick=function(hI,hJ){var hK,hL,hM,hN,hO,hP,hQ;switch(hJ.$==0?hJ.$0[2].$==1?hJ.$0[2].$0.$==0?hJ.$0[2].$1.$==0?(hK=[hJ.$0[0],hJ.$0[1],hJ.$0[2].$0,hJ.$0[4],hJ.$0[3]],0):(hK=[hJ.$0[0],hJ.$0[1],hJ.$0[4],hJ.$0[3],hJ.$0[2]],1):(hK=[hJ.$0[0],hJ.$0[1],hJ.$0[4],hJ.$0[3],hJ.$0[2]],1):(hK=[hJ.$0[0],hJ.$0[1],hJ.$0[4],hJ.$0[3],hJ.$0[2]],1):2){case 0:hL=hK[2];hM=eg.unstick(hL);return{$:1,$0:[{$:1,$0:bX.append(hK[0],bX.append(bX.ofArray([hM[1]]),hK[3]))},{$:0,$0:bX.append(hK[1],bX.append(bX.ofArray([hM[0]]),hK[4]))},hL]};case 1:hN=hK[4];hO=dD.tryFind(hI,bX.map(eg.get_name,hN));return hO!=null&&hO.$==1?(hP=hO.$0,eg.is_toehold(hP)?(hQ=bX.unzip(bX.map(eg.unstick,hN)),{$:1,$0:[{$:1,$0:bX.append(hK[0],bX.append(hQ[1],hK[2]))},{$:0,$0:bX.append(hK[1],bX.append(hQ[0],hK[3]))},hP]}):null):null;case 2:return null;}};ei.empty=function(){hv.$cctor();return hv.empty;};ei.swap_shared_domains_head=function(hI,hJ){var hK;function hL(hM,hN,hO,hP,hQ){var hR,hS,hT;switch(hO.$==1?hQ.$==1?hP.$==1?(hR=[hP.$0,hP.$1,hQ.$0,hQ.$1,hO.$0,hO.$1],3):4:(hR=[hP,hO],2):hP.$==0?hQ.$==0?0:(hR=hQ,1):hQ.$==0?(hR=[hP,hO],2):4){case 0:return[hM,hN,bY.Empty,bY.Empty];case 1:return[hM,hN,bY.Empty,hR];case 2:return[hM,hN,bX.map2(eg.stick,hR[1],hR[0]),bY.Empty];case 3:hS=hR[2];hT=hR[4];return eg.equal(hT,hS)?hL(bX.append(hM,bX.ofArray([eg.stick(hS,hR[0])])),bX.append(hN,bX.ofArray([hT])),hR[5],hR[1],hR[3]):[hM,hN,bX.map2(eg.stick,hO,hP),hQ];case 4:return be.FailWith("segment.swap_shared_domains_head did not have equal sized top and bottom lists");}}hK=eg.unstick_list(hI);return hL(bY.Empty,bY.Empty,hK[0],hK[1],hJ);};ei.stick=function(hI,hJ,hK,hL){var hM,hN,hO,hP,hQ,hR;hO=eg.stick(hI,hK);switch(hJ!=null&&hJ.$==1?hL!=null&&hL.$==1?(hN=[hJ.$0,hL.$0],1):2:hL==null?0:2){case 0:hM=[[hO,false],bX.ofArray([hO])];break;case 1:hM=(hP=hN[0],(hQ=hN[1],[[eg.set_tags((hR=dZ.intersection(cw.Equals,bX.concat(bX.choose(eg.get_tags,hP)),bX.concat(bX.choose(eg.get_tags,hQ))),hR.$==0?null:{$:1,$0:dZ.remove_duplicates(cw.Equals,hR)}),hO),true],bX.map2(eg.stick,hP,hQ)]));break;case 2:hM=be.FailWith("subdomains do not match");break;}return[hM[0],hM[1]];};ei.swap_shared_domains_tail=function(hI,hJ){var hK;hK=ei.swap_shared_domains_head(bX.rev(hI),bX.rev(hJ));return[bX.rev(hK[0]),bX.rev(hK[1]),bX.rev(hK[2]),bX.rev(hK[3])];};ei.stick_simple=function(hI,hJ){var hK;hK=eg.stick(hI,hJ);return[[hK,false],bX.ofArray([hK])];};ei.swap_shared_domains_middle=function(hI,hJ){function hK(hL,hM){var hN,hO,hP;return hM.$==1?(hN=hM.$1,(hO=hM.$0,(hP=ei.swap_shared_domains_head(hI,hM),hP[0].$==0?hK(new bY({$:1,$0:hO,$1:hL}),hN):new bY({$:1,$0:[hL,hP[0],hP[1],hP[2],hP[3]],$1:hK(new bY({$:1,$0:hO,$1:hL}),hN)})))):bY.Empty;}return hJ.$==1?hJ.$1.$==0?bY.Empty:hK(bX.ofArray([hJ.$0]),hJ.$1):bY.Empty;};ei.unbind_open_up=function(hI){var hJ,hK,hL;return hI.$==1&&(hI.$0[2].$==1&&(hI.$0[2].$0.$==0&&(hI.$0[2].$1.$==0&&(hI.$0[4].$==0&&(hJ=[hI.$0[3],hI.$0[0],hI.$0[1],hI.$0[2].$0],true)))))?(hK=eg.unstick(hJ[3]),(hL=hK[0],{$:1,$0:[{$:1,$0:bX.append(bX.rev(hJ[2]),bX.append(bX.ofArray([hL]),bX.append(hJ[0],bX.append(bX.ofArray([hK[1]]),hJ[1]))))},hL]})):null;};ei.set_tags=function(hI,hJ){function hK(hL){return eg.set_tags_list(hJ,hL);}return hI.$==1?new ej({$:1,$0:[hK(hI.$0[0]),hK(hI.$0[1]),hK(hI.$0[2]),hK(hI.$0[3]),hI.$0[4]]}):new ej({$:0,$0:[hK(hI.$0[0]),hK(hI.$0[1]),hK(hI.$0[2]),hK(hI.$0[3]),hK(hI.$0[4])]});};ei.tethered_tag_sets=function(hI){return ei.gotten_tag_sets(eg.all_tethered_tags_list,hI);};ei.add_tags=function(hI,hJ){function hK(hL){return eg.add_tags_list(hJ,hL);}return hI.$==1?new ej({$:1,$0:[hK(hI.$0[0]),hK(hI.$0[1]),hK(hI.$0[2]),hK(hI.$0[3]),hI.$0[4]]}):new ej({$:0,$0:[hK(hI.$0[0]),hK(hI.$0[1]),hK(hI.$0[2]),hK(hI.$0[3]),hK(hI.$0[4])]});};ei.tag_sets=function(hI){return ei.gotten_tag_sets(eg.all_tags_list,hI);};ei.double_stranded_region=function(hI){return hI.$==1?hI.$0[2]:hI.$0[2];};ei.top_right_overhang=function(hI){return hI.$==1?hI.$0[4].$==0?bY.Empty:hI.$0[1]:hI.$0[3];};ei.top_left_overhang=function(hI){return hI.$==1?hI.$0[4].$==1?bY.Empty:hI.$0[1]:hI.$0[1];};ei.bottom_right_overhang=function(hI){return hI.$==1?hI.$0[4].$==0?bY.Empty:hI.$0[0]:hI.$0[4];};ei.bottom_left_overhang=function(hI){return hI.$==1?hI.$0[4].$==1?bY.Empty:hI.$0[0]:hI.$0[0];};ei.gotten_tag_sets=function(hI,hJ){return hJ.$==1?hJ.$0[4].$==0?[null,eg.all_tags_list(bX.append(hJ.$0[0],hJ.$0[1]))]:[eg.all_tags_list(bX.append(hJ.$0[0],hJ.$0[1])),null]:[hI(bX.append(hJ.$0[0],hJ.$0[1])),hI(bX.append(hJ.$0[4],hJ.$0[3]))];};ei.tethered_domains=function(hI){function hJ(hK){return bX.filter(eg.is_tethered,hK);}return hI.$==1?bX.append(hJ(hI.$0[0]),bX.append(hJ(hI.$0[1]),hJ(hI.$0[2]))):bX.append(hJ(hI.$0[0]),bX.append(hJ(hI.$0[1]),bX.append(hJ(hI.$0[2]),bX.append(hJ(hI.$0[3]),hJ(hI.$0[4])))));};fj.$cctor=function(){var hI,hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0,h1,h2,h3,h4,h5,h6,h7,h8,h9,h_,h$,ia,ib,ic,id,ie,_if,ig,ih,ii,ij,ik,il,im,_in,io,ip,iq,ir;fj.$cctor=a.ignore;function is(jc){return{$:7,$0:jc};}function it(jc){return{$:3,$0:jc};}function iu(jc,jd){return{$:9,$0:jc,$1:jd};}function iv(jc){return{$:10,$0:jc};}function iw(jc){return{$:11,$0:jc};}function ix(jc){return{$:5,$0:jc};}function iy(jc){return{$:6,$0:jc};}function iz(jc){return{$:2,$0:jc};}function iA(jc){return{$:12,$0:jc};}function iB(jc){return{$:13,$0:jc};}function iC(jc){return{$:14,$0:jc};}function iD(jc){return{$:15,$0:jc};}function iE(jc,jd){return{$:0,$0:jc,$1:jd};}function iF(jc){return{$:16,$0:jc};}function iG(jc){return{$:1,$0:jc};}function iH(jc){return{$:16,$0:jc};}function iI(jc){return{$:2,$0:jc};}function iJ(jc){return{$:16,$0:jc};}function iK(jc){return{$:3,$0:jc};}function iL(jc){return{$:16,$0:jc};}function iM(jc){return{$:18,$0:jc};}function iN(jc,jd){return{$:19,$0:jc,$1:jd};}function iO(jc){return{$:20,$0:jc};}function iP(jc,jd,je,jf,jg){var jh;jh=cR.choice([cR.op_GreaterGreaterDot(cR.kw("fixedvar"),cR.preturn({$:1,$0:jc,$1:jd,$2:je,$3:jf,$4:jg,$5:gs.ParFixed})),cR.op_GreaterGreaterDot(cR.kw("fixed"),cR.preturn({$:1,$0:jc,$1:jd,$2:je,$3:jf,$4:jg,$5:gs.ParFixed})),cR.op_GreaterGreaterDot(cR.kw("randomized"),cR.preturn({$:1,$0:jc,$1:jd,$2:je,$3:jf,$4:jg,$5:gs.ParRandomized})),cR.op_GreaterGreaterDot(cR.kw("random"),cR.preturn({$:1,$0:jc,$1:jd,$2:je,$3:jf,$4:jg,$5:gs.ParRandomized})),cR.op_GreaterGreaterDot(cR.kw("init"),cR.preturn({$:1,$0:jc,$1:jd,$2:je,$3:jf,$4:jg,$5:gs.ParInitVal})),cR.op_GreaterGreaterDot(cR.kw("initval"),cR.preturn({$:1,$0:jc,$1:jd,$2:je,$3:jf,$4:jg,$5:gs.ParInitVal}))]);return function(ji){return jh([ji[0],ji[1]]);};}function iQ(jc){return{$:21,$0:jc};}function iR(jc,jd){return{$:0,$0:jc,$1:jd};}function iS(jc,jd){return{$:0,$0:jc,$1:jd};}function iT(jc){return{$:1,$0:jc};}function iU(jc){return bX.ofArray([jc]);}function iV(jc){return{$:22,$0:jc};}function iW(jc){return{$:0,$0:jc};}function iX(jc){return{$:1,$0:jc};}function iY(jc){return{$:2,$0:jc};}function iZ(jc){return{$:3,$0:jc};}function i0(jc){return{$:4,$0:jc};}function i1(jc){return{$:5,$0:jc};}function i2(jc){return{$:3,$0:jc};}function i3(jc){return{$:27,$0:jc};}function i4(jc){return{$:4,$0:jc};}function i5(jc){return{$:27,$0:jc};}function i6(jc){return{$:5,$0:jc};}function i7(jc){return{$:27,$0:jc};}function i8(jc){return{$:28,$0:jc};}function i9(jc){return{$:29,$0:jc};}function i_(jc){return{$:30,$0:jc};}function i$(jc){return{$:31,$0:jc};}function ja(jc){return{$:32,$0:jc};}function jb(jc){return{$:33,$0:jc};}fj.spFloat=cR.op_DotGreaterGreater(cR.pfloat(),cR.spaces());fj.spInt=cR.op_DotGreaterGreater(cR.pint32(),cR.spaces());fj.spBool=cR.op_DotGreaterGreater((hI=cR.choice([cR.op_GreaterGreaterDot(cR.kw("true"),cR.preturn(true)),cR.op_GreaterGreaterDot(cR.kw("false"),cR.preturn(false))]),function(jc){return hI([jc[0],jc[1]]);}),cR.spaces());fj.spName=cR.op_DotGreaterGreater(cR.name(),cR.spaces());fj.fpMsg="Floating point conversion not supported";fj.pOldValue=cR.op_BarTwiddleGreater(function(jc){return bZ.pOldVal(jc[0],jc[1]);},function(jc,jd){return(function(je){var jf,jg;jf=je[0];jg=je[1];return function(jh){return ea.map_value(jf,jg,jh);};}(jc))(jd);});fj.parseOldMolecule=bZ.pMolecule(cR.op_GreaterGreaterDot(cR.kw("::"),cR.preturn(true)),cR.op_GreaterGreaterDot(cR.kw(":"),cR.preturn(false)));fj.parseOldGroundSpecies=(hJ=cR.choice([cR.op_BarGreaterGreater(cR.op_DotGreaterGreaterDot(cR.op_PlusGreaterGreaterPlus(ea.parse_name(),function(jc){return bZ.pOldVals(jc[0],jc[1]);}),ea.at_time()),function(jc){var jd;jd=jc[0];return new fl({$:4,$0:jd[0],$1:null,$2:jd[1],$3:jc[1]});}),cR.op_GreaterGreaterEquals(cR.op_DotGreaterGreaterDot(bZ.parseOldMolecule(),ea.at_time()),function(jc){var jd,je;jd=jc[0];je=jc[1];return jd.$==0?cR.preturn(new fl({$:1,$0:jd.$0,$1:je})):jd.$==1?cR.preturn(new fl({$:2,$0:jd.$0,$1:je})):cR.failParser("a gate or a strand");})]),function(jc){return hJ([jc[0],jc[1]]);});fj.pOldSpecies=(hK=cR.choice([cR.op_BarGreaterGreater(cR.op_DotGreaterGreaterDot((hL=ea.sep_by_bars(bZ.parseOldGroundSpecies()),(cR.bracket("[[","]]"))(hL)),ea.at_time()),function(jc){return new fl({$:3,$0:jc[0],$1:jc[1]});}),bZ.parseOldGroundSpecies()]),function(jc){return hK([jc[0],jc[1]]);});fj.pValOrTuple=cR.op_LessBarGreater(bZ.pOldValue(),cR.op_BarTwiddleGreater(function(jc){return bZ.pOldVals(jc[0],jc[1]);},function(jc,jd){return{$:12,$0:jd,$1:ea.to_range(jc[0],jc[1])};}));fj.SAMPLE=cR.kw("sample");fj.ALL=cR.kw("all");fj.PLOT=cR.kw("plot");fj.POINTS=cR.kw("points");fj.DURATION=cR.kw("duration");fj.SCALE=cR.kw("scale");fj.SEED=cR.kw("seed");fj.SIMULATION=cR.kw("simulation");fj.DETERMINISTICSTIFF=cR.kw("deterministicstiff");fj.RELTOLERANCE=cR.kw("reltolerance");fj.TOLERANCE=cR.op_LessBarGreater(cR.kw("tolerance"),cR.kw("abstolerance"));fj.EVENT=cR.kw("event");fj.SPECMAX=cR.kw("specmax");fj.TIME=cR.kw("time");fj.CONCENTRATION=cR.kw("concentration");fj.DT=cR.kw("dt");fj.XMAX=cR.kw("xmax");fj.NX=cR.kw("nx");fj.THETA=cR.kw("theta");fj.COAXIALDANGLE=cR.kw("coaxialDangle");fj.DOUBLECOAXIALDANGLE=cR.kw("doubleCoaxialDangle");fj.COAXIALCORRECTION=cR.kw("coaxialCorrection");fj.TEMPERATURE=cR.kw("temperature");fj.TERMINALDANGLE=cR.kw("terminalDangle");fj.SPATIALIC=cR.kw("spatialic");fj.SPATIALBC=cR.kw("spatialbc");fj.SPATIALPLOT=cR.kw("spatialplot");fj.DECLARE=cR.kw("declare");fj.DEFAULTDIFFUSION=cR.kw("defaultdiffusion");fj.DIFFUSION=cR.kw("diffusion");fj.LEAKS=cR.kw("leaks");fj.PINLEAK=cR.kw("pinleak");fj.PINLEAKS=cR.kw("pinleaks");fj.LENGTHS=cR.kw("lengths");fj.MIGRATE=cR.kw("migrate");fj.LOCALCONCENTRATIONS=cR.kw("localconcentrations");fj.POLYMERS=cR.kw("polymers");fj.SEQUENCERATES=cR.kw("sequenceRates");fj.STABILITYCORRECTION=cR.kw("stabilityCorrection");fj.TAU=cR.kw("tau");fj.TOEHOLDS=cR.kw("toeholds");fj.UNPRODUCTIVE=cR.kw("unproductive");fj.VERIFICATION=cR.kw("verification");fj.FIT=cR.kw("fit");fj.FITRUN=cR.kw("fit_run");fj.KINETICS=cR.kw("kinetics");fj.PARAMETERS=cR.kw("parameters");fj.PLOTWINDOW=cR.kw("plotwindow");fj.PREDICATES=cR.kw("predicates");fj.SWEEP=cR.kw("sweep");fj.COMMA=cR.kw(",");fj.SEMI=cR.kw(";");fj.AT=cR.kw("@");fj.UNDERSCORE=cR.kw("_");fj.SUM=cR.kw("sum");fj.SUB=cR.kw("sub");fj.DIFF=cR.kw("diff");fj.PROD=cR.kw("prod");fj.DIV=cR.kw("div");fj.EQUAL=cR.kw("=");fj.DLBRACKET=cR.kw("[[");fj.DRBRACKET=cR.kw("]]");fj.BAR=cR.kw("|");fj.dirSamples=cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(bZ.SAMPLE(),br.parse(bZ.spFloat())),function(jc){var jd;function je(jf,jg,jh){return{$:0,$0:jf,$1:jg,$2:jh};}return cR.op_GreaterGreaterEquals((jd=cR.choice([cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(bZ.COMMA(),bZ.spFloat()),function(jf){var jg;jg=cR.choice([cR.op_GreaterGreaterDot(bZ.ALL(),cR.preturn([{$:1,$0:br["eval"](a.id,jc)},{$:1,$0:jf},{$:1,$0:0}])),cR.op_GreaterGreaterEquals(bZ.spInt(),function(jh){return cR.preturn([{$:1,$0:br["eval"](a.id,jc)},{$:1,$0:jf},{$:1,$0:jh}]);}),cR.preturn([{$:1,$0:br["eval"](a.id,jc)},{$:1,$0:jf},null])]);return function(jh){return jg([jh[0],jh[1]]);};}),cR.op_GreaterGreaterDot(bZ.ALL(),cR.preturn([null,{$:1,$0:br["eval"](a.id,jc)},{$:1,$0:0}])),cR.op_GreaterGreaterEquals(bZ.spInt(),function(jf){return cR.preturn([null,{$:1,$0:br["eval"](a.id,jc)},{$:1,$0:jf}]);}),cR.preturn([null,{$:1,$0:br["eval"](a.id,jc)},null])]),function(jf){return jd([jf[0],jf[1]]);}),function(jf){return cR.preturn(je.apply(null,jf));});});fj.dirDuration=cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(bZ.DURATION(),bZ.spFloat()),function(jc){var jd,je;function jf(jg,jh,ji){return{$:1,$0:jg,$1:jh,$2:ji};}return cR.op_GreaterGreaterEquals((jd=cR.choice([cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(bZ.COMMA(),bZ.spFloat()),function(jg){var jh,ji;jh=cR.choice([cR.op_GreaterGreaterDot(bZ.POINTS(),(ji=cR.choice([cR.op_GreaterGreaterDot(bZ.ALL(),cR.preturn([{$:1,$0:jc},{$:1,$0:jg},{$:1,$0:0}])),cR.op_GreaterGreaterEquals(bZ.spInt(),function(jj){return cR.preturn([{$:1,$0:jc},{$:1,$0:jg},{$:1,$0:jj}]);})]),function(jj){return ji([jj[0],jj[1]]);})),cR.preturn([{$:1,$0:jc},{$:1,$0:jg},null])]);return function(jj){return jh([jj[0],jj[1]]);};}),cR.op_GreaterGreaterDot(bZ.POINTS(),(je=cR.choice([cR.op_GreaterGreaterDot(bZ.ALL(),cR.preturn([null,{$:1,$0:jc},{$:1,$0:0}])),cR.op_GreaterGreaterEquals(bZ.spInt(),function(jg){return cR.preturn([null,{$:1,$0:jc},{$:1,$0:jg}]);})]),function(jg){return je([jg[0],jg[1]]);})),cR.preturn([null,{$:1,$0:jc},null])]),function(jg){return jd([jg[0],jg[1]]);}),function(jg){return cR.preturn(jf.apply(null,jg));});});fj.dirSeed=cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(bZ.SEED(),bZ.spInt()),function(jc){return cR.preturn(is(jc));});fj.pMol=bZ.parseOldMolecule();fj.dirPlot=cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(bZ.PLOT(),function(jc){return bZ.pPlots(jc[0],jc[1]);}),function(jc){return cR.preturn(it(jc));});fj.pOrigami=(hM=cR.sepBy1(bZ.pMol(),bZ.BAR()),cR.op_GreaterGreaterEquals(cR.op_DotGreaterGreater(cR.op_GreaterGreaterDot(bZ.DLBRACKET(),hM),bZ.DRBRACKET()),function(jc){return cR.preturn(function(jd){return new fl({$:3,$0:bX.map(function(je){return eb.from_species(null,je);},jc),$1:jd});});}));fj.pEvent=(hN=cR.choice([bZ.pOrigami(),cR.op_GreaterGreaterEquals(bZ.pMol(),function(jc){return cR.preturn(function(jd){return eb.from_species(jd,jc);});}),cR.op_GreaterGreaterEquals(cR.op_DotGreaterGreaterDot(cR.name(),cR.paren(cR.sepBy(bZ.pOldValue(),bZ.COMMA()))),function(jc){var jd,je;jd=jc[0];je=jc[1];return cR.preturn(function(jf){return new fl({$:4,$0:jd,$1:null,$2:je,$3:jf});});})]),function(jc){return hN([jc[0],jc[1]]);});fj.dirEvents=cR.op_GreaterGreaterEquals(cR.op_DotGreaterGreaterDot(cR.op_DotGreaterGreater(cR.op_DotGreaterGreaterDot(cR.op_GreaterGreaterDot(bZ.EVENT(),bZ.pEvent()),bZ.pOldValue()),bZ.AT()),bZ.pOldValue()),function(jc){var jd;jd=jc[0];return cR.preturn({$:8,$0:new fl({$:0,$0:jd[1],$1:false,$2:jd[0]({$:1,$0:jc[1]}),$3:null,$4:null})});});fj.dirSpecMax=cR.op_GreaterGreaterEquals(cR.op_DotGreaterGreaterDot(cR.op_GreaterGreaterDot(bZ.SPECMAX(),ea.speciesParser()),bZ.spInt()),function(jc){return cR.preturn(iu.apply(null,jc));});fj.dirTime=(hO=new R({$:0,$0:1}),(hP=new R({$:0,$0:6}),(hQ=new R({$:0,$0:3.6}),(hR=new R({$:0,$0:8.64}),(hS=function(jc){return cR.preturn(iv(jc));},cR.op_GreaterGreaterDot(bZ.TIME(),(hT=cR.choice([cR.op_GreaterGreaterDot(cR.kw("seconds"),hS(hO)),cR.op_GreaterGreaterDot(cR.kw("s"),hS(hO)),cR.op_GreaterGreaterDot(cR.kw("minutes"),hS(hP)),cR.op_GreaterGreaterDot(cR.kw("m"),hS(hP)),cR.op_GreaterGreaterDot(cR.kw("hours"),hS(hQ)),cR.op_GreaterGreaterDot(cR.kw("h"),hS(hQ)),cR.op_GreaterGreaterDot(cR.kw("days"),hS(hR)),cR.op_GreaterGreaterDot(cR.kw("d"),hS(hR))]),function(jc){return hT([jc[0],jc[1]]);})))))));fj.dirConcentration=(hU=new Q({$:0,$0:0}),(hV=new Q({$:0,$0:-3}),(hW=new Q({$:0,$0:-6}),(hX=new Q({$:0,$0:-9}),(hY=new Q({$:0,$0:-12}),(hZ=new Q({$:0,$0:-15}),(h0=new Q({$:0,$0:-18}),(h1=new Q({$:0,$0:-21}),(h2=new Q({$:0,$0:-24}),(h3=function(jc){return cR.preturn(iw(jc));},cR.op_GreaterGreaterDot(bZ.CONCENTRATION(),(h4=cR.choice([cR.op_GreaterGreaterDot(cR.kw("molar"),h3(hU)),cR.op_GreaterGreaterDot(cR.kw("M"),h3(hU)),cR.op_GreaterGreaterDot(cR.kw("milimolar"),h3(hV)),cR.op_GreaterGreaterDot(cR.kw("mM"),h3(hV)),cR.op_GreaterGreaterDot(cR.kw("millimolar"),h3(hV)),cR.op_GreaterGreaterDot(cR.kw("micromolar"),h3(hW)),cR.op_GreaterGreaterDot(cR.kw("uM"),h3(hW)),cR.op_GreaterGreaterDot(cR.kw("nanomolar"),h3(hX)),cR.op_GreaterGreaterDot(cR.kw("nM"),h3(hX)),cR.op_GreaterGreaterDot(cR.kw("picomolar"),h3(hY)),cR.op_GreaterGreaterDot(cR.kw("pM"),h3(hY)),cR.op_GreaterGreaterDot(cR.kw("femtomolar"),h3(hZ)),cR.op_GreaterGreaterDot(cR.kw("fM"),h3(hZ)),cR.op_GreaterGreaterDot(cR.kw("attomolar"),h3(h0)),cR.op_GreaterGreaterDot(cR.kw("aM"),h3(h0)),cR.op_GreaterGreaterDot(cR.kw("zeptomolar"),h3(h1)),cR.op_GreaterGreaterDot(cR.kw("zM"),h3(h1)),cR.op_GreaterGreaterDot(cR.kw("yoctomolar"),h3(h2)),cR.op_GreaterGreaterDot(cR.kw("yM"),h3(h2))]),function(jc){return h4([jc[0],jc[1]]);}))))))))))));fj.dirRelativeTolerance=cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(bZ.RELTOLERANCE(),bZ.spFloat()),function(jc){return cR.preturn(ix(jc));});fj.dirTolerance=cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(bZ.TOLERANCE(),bZ.spFloat()),function(jc){return cR.preturn(iy(jc));});fj.dirScale=cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(bZ.SCALE(),bZ.spFloat()),function(jc){return cR.preturn(iz(jc));});fj.dirSimulation=cR.op_GreaterGreaterDot(bZ.SIMULATION(),(h5=cR.choice([cR.op_GreaterGreaterDot(cR.kw("jit"),cR.preturn({$:4,$0:gq.JIT})),cR.op_GreaterGreaterDot(cR.kw("stochastic"),cR.preturn({$:4,$0:gq.SSA})),cR.op_GreaterGreaterDot(cR.kw("deterministicstiff"),cR.preturn({$:4,$0:{$:2,$0:true}})),cR.op_GreaterGreaterDot(cR.kw("deterministic"),cR.preturn({$:4,$0:{$:2,$0:false}})),cR.op_GreaterGreaterDot(cR.kw("spatial1d"),cR.preturn({$:4,$0:{$:3,$0:1}})),cR.op_GreaterGreaterDot(cR.kw("spatial2d"),cR.preturn({$:4,$0:{$:3,$0:2}})),cR.op_GreaterGreaterDot(cR.kw("sundials"),cR.preturn({$:4,$0:{$:4,$0:false}})),cR.op_GreaterGreaterDot(cR.kw("sundialsstiff"),cR.preturn({$:4,$0:{$:4,$0:true}})),cR.op_GreaterGreaterDot(cR.kw("cme"),cR.preturn({$:4,$0:{$:5,$0:false}})),cR.op_GreaterGreaterDot(cR.kw("cmestiff"),cR.preturn({$:4,$0:{$:5,$0:true}})),cR.op_GreaterGreaterDot(cR.kw("lna"),cR.preturn({$:4,$0:{$:6,$0:false}})),cR.op_GreaterGreaterDot(cR.kw("lnastiff"),cR.preturn({$:4,$0:{$:6,$0:true}}))]),function(jc){return h5([jc[0],jc[1]]);}));fj.dirDT=cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(bZ.DT(),bZ.spFloat()),function(jc){return cR.preturn(iA(jc));});fj.dirXMax=cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(bZ.XMAX(),bZ.spFloat()),function(jc){return cR.preturn(iB(jc));});fj.dirNX=cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(bZ.NX(),bZ.spInt()),function(jc){return cR.preturn(iC(jc));});fj.dirTheta=cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(bZ.THETA(),bZ.spFloat()),function(jc){return cR.preturn(iD(jc));});fj.coreRecord=cR.sepBy(function(jc){return bZ.coreElem(jc[0],jc[1]);},bZ.SEMI());fj.pointRecord=cR.sepBy(function(jc){return bZ.pointElem(jc[0],jc[1]);},bZ.SEMI());fj.dirSpatialic=cR.op_GreaterGreaterDot(bZ.SPATIALIC(),(h6=cR.choice([cR.op_GreaterGreaterDot(cR.kw("random"),(h7=cR.choice([cR.op_GreaterGreaterEquals(cR.op_DotGreaterGreaterDot(function(jc){return bZ.speciesParser(jc[0],jc[1]);},bZ.spFloat()),(h8=function(jc){return iF(iE.apply(null,jc));},function(jc){return cR.preturn(h8(jc));})),cR.op_GreaterGreaterEquals(bZ.spFloat(),(h9=function(jc){return iH(iG(jc));},function(jc){return cR.preturn(h9(jc));}))]),function(jc){return h7([jc[0],jc[1]]);})),cR.op_GreaterGreaterDot(cR.kw("centralcore"),(h_=cR.choice([cR.op_GreaterGreaterEquals(cR.op_DotGreaterGreaterDot(cR.op_DotGreaterGreaterDot(cR.op_DotGreaterGreaterDot(bZ.spFloat(),function(jc){return bZ.speciesParser(jc[0],jc[1]);}),bZ.spFloat()),bZ.spFloat()),function(jc){var jd;jd=jc[0];return cR.preturn({$:16,$0:{$:4,$0:jd[0][1],$1:jd[0][0],$2:jd[1],$3:{$:1,$0:jc[1]}}});}),cR.op_GreaterGreaterEquals(bZ.coreRecord(),(h$=function(jc){return iJ(iI(jc));},function(jc){return cR.preturn(h$(jc));}))]),function(jc){return h_([jc[0],jc[1]]);})),cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(cR.kw("point"),bZ.pointRecord()),(ia=function(jc){return iL(iK(jc));},function(jc){return cR.preturn(ia(jc));}))]),function(jc){return h6([jc[0],jc[1]]);}));fj.dirSpatialbc=cR.op_GreaterGreaterDot(bZ.SPATIALBC(),(ib=cR.choice([cR.op_GreaterGreaterDot(cR.kw("periodic"),cR.preturn({$:17,$0:gr.Periodic})),cR.op_GreaterGreaterDot(cR.kw("zeroflux"),cR.preturn({$:17,$0:gr.ZeroFlux}))]),function(jc){return ib([jc[0],jc[1]]);}));fj.dirSpatialPlot=cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(bZ.SPATIALPLOT(),function(jc){return bZ.speciesParser(jc[0],jc[1]);}),function(jc){return cR.preturn(iM(jc));});fj.dirDiffusion=cR.op_GreaterGreaterEquals(cR.op_DotGreaterGreaterDot(cR.op_GreaterGreaterDot(bZ.DIFFUSION(),function(jc){return bZ.speciesParser(jc[0],jc[1]);}),bZ.spFloat()),function(jc){return cR.preturn(iN.apply(null,jc));});fj.dirDefaultDiffusion=cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(bZ.DEFAULTDIFFUSION(),bZ.spFloat()),function(jc){return cR.preturn(iO(jc));});fj.paramP=cR.op_GreaterGreaterEquals(bZ.spName(),function(jc){var jd;jd=cR.choice([cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(bZ.EQUAL(),bZ.spFloat()),function(je){return cR.preturn({$:0,$0:jc,$1:je,$2:je,$3:je});}),cR.op_GreaterGreaterEquals(cR.op_DotGreaterGreater(cR.op_DotGreaterGreaterDot(cR.op_DotGreaterGreater(cR.op_GreaterGreaterDot(bZ.COMMA(),cR.paren(cR.op_DotGreaterGreaterDot(cR.op_DotGreaterGreater(bZ.spFloat(),bZ.COMMA()),bZ.spFloat()))),bZ.COMMA()),bZ.spFloat()),bZ.COMMA()),function(je){var jf,jg,jh,ji,jj;jf=je[0];jg=je[1];jh=jf[1];ji=jf[0];jj=cR.choice([cR.op_GreaterGreaterDot(cR.op_GreaterGreaterDot(cR.kw("realspace"),bZ.COMMA()),iP(jc,ji,jh,jg,gt.ParReal)),cR.op_GreaterGreaterDot(cR.op_GreaterGreaterDot(cR.kw("real"),bZ.COMMA()),iP(jc,ji,jh,jg,gt.ParReal)),cR.op_GreaterGreaterDot(cR.op_GreaterGreaterDot(cR.kw("log"),bZ.COMMA()),iP(jc,ji,jh,jg,gt.ParLog)),cR.op_GreaterGreaterDot(cR.op_GreaterGreaterDot(cR.kw("logspace"),bZ.COMMA()),iP(jc,ji,jh,jg,gt.ParLog))]);return function(jk){return jj([jk[0],jk[1]]);};})]);return function(je){return jd([je[0],je[1]]);};});fj.dirParameters=cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(bZ.PARAMETERS(),cR.sqBrackets(cR.sepBy1(bZ.paramP(),bZ.SEMI()))),function(jc){return cR.preturn(iQ(jc));});fj.namesList=cR.sepBy1(cR.name(),bZ.COMMA());fj.valList1=cR.sepBy1(bZ.pOldValue(),bZ.COMMA());fj.valList=cR.sepBy2(bZ.pOldValue(),bZ.COMMA());fj.valListP=cR.paren(bZ.valList());fj.valTuples=cR.sepBy1(bZ.valListP(),bZ.COMMA());fj.varSweep=(ic=cR.choice([cR.op_GreaterGreaterEquals(cR.op_DotGreaterGreaterDot(cR.op_DotGreaterGreater(cR.paren(bZ.namesList()),bZ.EQUAL()),cR.sqBrackets(bZ.valTuples())),function(jc){return cR.preturn(iR.apply(null,jc));}),cR.op_GreaterGreaterEquals(cR.op_DotGreaterGreaterDot(cR.op_DotGreaterGreater(bZ.spName(),bZ.EQUAL()),cR.sqBrackets(bZ.valList1())),function(jc){return cR.preturn({$:0,$0:bX.ofArray([jc[0]]),$1:bX.map(function(jd){return bX.ofArray([jd]);},jc[1])});})]),function(jc){return ic([jc[0],jc[1]]);});fj.combSweep=cR.sepBy1(bZ.varSweep(),bZ.COMMA());fj.dirSweep=cR.op_GreaterGreaterDot(bZ.SWEEP(),(id=cR.choice([cR.op_GreaterGreaterEquals(cR.op_DotGreaterGreaterDot(cR.op_DotGreaterGreater(cR.paren(bZ.namesList()),bZ.EQUAL()),cR.sqBrackets(bZ.valTuples())),(ie=(_if=(ig=function(jc){return iT(iS.apply(null,jc));},function(jc){return iU(ig(jc));}),function(jc){return iV(_if(jc));}),function(jc){return cR.preturn(ie(jc));})),cR.op_GreaterGreaterEquals(cR.op_DotGreaterGreater(bZ.spName(),bZ.EQUAL()),function(jc){var jd;jd=cR.choice([cR.op_GreaterGreaterEquals(cR.braces(bZ.combSweep()),function(je){return cR.preturn({$:22,$0:bX.ofArray([{$:0,$0:jc,$1:je}])});}),cR.op_GreaterGreaterEquals(cR.sqBrackets(bZ.valList1()),function(je){return cR.preturn({$:22,$0:bX.ofArray([{$:1,$0:{$:0,$0:bX.ofArray([jc]),$1:bX.map(function(jf){return bX.ofArray([jf]);},je)}}])});})]);return function(je){return jd([je[0],je[1]]);};})]),function(jc){return id([jc[0],jc[1]]);}));fj.dirFit=cR.op_GreaterGreaterDot(bZ.FIT(),cR.braces(cR.op_GreaterGreaterEquals(cR.op_DotGreaterGreater(cR.op_DotGreaterGreaterDot(cR.op_DotGreaterGreater(bZ.spName(),bZ.SEMI()),bZ.spName()),bZ.SEMI()),function(jc){var jd,je,jf;jd=jc[0];je=jc[1];jf=cR.choice([cR.op_GreaterGreaterEquals(cR.sqBrackets(function(jg){return bZ.pPlots(jg[0],jg[1]);}),function(jg){return cR.preturn({$:23,$0:jd,$1:je,$2:jg});}),cR.op_GreaterGreaterEquals(function(jg){return bZ.pPlot(jg[0],jg[1]);},function(jg){return cR.preturn({$:23,$0:jd,$1:je,$2:bX.ofArray([jg])});})]);return function(jg){return jf([jg[0],jg[1]]);};})));fj.fitElem=(ih=cR.choice([cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(cR.op_GreaterGreaterDot(cR.kw("burnin"),bZ.EQUAL()),bZ.spInt()),function(jc){return cR.preturn(iW(jc));}),cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(cR.op_GreaterGreaterDot(cR.kw("samples"),bZ.EQUAL()),bZ.spInt()),function(jc){return cR.preturn(iX(jc));}),cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(cR.op_GreaterGreaterDot(cR.kw("thin"),bZ.EQUAL()),bZ.spInt()),function(jc){return cR.preturn(iY(jc));}),cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(cR.op_GreaterGreaterDot(cR.kw("separatenoise"),bZ.EQUAL()),bZ.spBool()),function(jc){return cR.preturn(iZ(jc));}),cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(cR.op_GreaterGreaterDot(cR.kw("noisemodel"),bZ.EQUAL()),bZ.spInt()),function(jc){return cR.preturn(i0(jc));}),cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(cR.op_GreaterGreaterDot(cR.kw("prune"),bZ.EQUAL()),bZ.spBool()),function(jc){return cR.preturn(i1(jc));})]),function(jc){return ih([jc[0],jc[1]]);});fj.fitRecord=cR.braces(cR.sepBy1(bZ.fitElem(),bZ.SEMI()));fj.dirPlotWindow=cR.op_GreaterGreaterEquals(cR.op_DotGreaterGreaterDot(cR.op_DotGreaterGreaterDot(cR.op_DotGreaterGreaterDot(cR.op_GreaterGreaterDot(bZ.PLOTWINDOW(),bZ.spFloat()),bZ.spFloat()),bZ.spFloat()),bZ.spFloat()),function(jc){var jd;jd=jc[0];return cR.preturn({$:25,$0:jd[0][0],$1:jd[0][1],$2:jd[1],$3:jc[1]});});fj.dirKinectics=cR.op_GreaterGreaterDot(bZ.KINETICS(),(ii=cR.choice([cR.op_GreaterGreaterDot(cR.kw("contextual"),cR.preturn({$:26,$0:gu.KContextual})),cR.op_GreaterGreaterDot(cR.kw("stochastic"),cR.preturn({$:26,$0:gu.KStochastic})),cR.op_GreaterGreaterDot(cR.kw("deterministic"),cR.preturn({$:26,$0:gu.KDeterministic}))]),function(jc){return ii([jc[0],jc[1]]);}));fj.dirVerification=cR.op_GreaterGreaterDot(bZ.VERIFICATION(),(ij=cR.choice([cR.op_GreaterGreaterDot(cR.kw("encoding"),(ik=cR.choice([cR.op_GreaterGreaterDot(cR.kw("integer"),cR.preturn({$:27,$0:{$:0,$0:0}})),cR.op_GreaterGreaterDot(cR.kw("bitvector"),cR.preturn({$:27,$0:{$:0,$0:1}}))]),function(jc){return ik([jc[0],jc[1]]);})),cR.op_GreaterGreaterDot(cR.kw("abstraction"),(il=cR.choice([cR.op_GreaterGreaterDot(cR.kw("default"),cR.preturn({$:27,$0:{$:1,$0:0}})),cR.op_GreaterGreaterDot(cR.kw("stutter"),cR.preturn({$:27,$0:{$:1,$0:1}})),cR.op_GreaterGreaterDot(cR.kw("connected"),cR.preturn({$:27,$0:{$:1,$0:2}})),cR.op_GreaterGreaterDot(cR.kw("boolean"),cR.preturn({$:27,$0:{$:1,$0:3}}))]),function(jc){return il([jc[0],jc[1]]);})),cR.op_GreaterGreaterDot(cR.kw("enumeration"),(im=cR.choice([cR.op_GreaterGreaterDot(cR.kw("first"),cR.preturn({$:27,$0:{$:2,$0:-1}})),cR.op_GreaterGreaterDot(cR.kw("full"),cR.preturn({$:27,$0:{$:2,$0:-2}})),cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(cR.kw("limit"),bZ.spInt()),function(jc){return jc<0?cR.failParser("Positive enumeration limit required, but found "+hH(jc)):cR.preturn({$:27,$0:{$:2,$0:jc}});})]),function(jc){return im([jc[0],jc[1]]);})),cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(cR.kw("population_bound"),bZ.spInt()),(_in=function(jc){return i3(i2(jc));},function(jc){return cR.preturn(_in(jc));})),cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(cR.kw("null_reaction"),bZ.spBool()),(io=function(jc){return i5(i4(jc));},function(jc){return cR.preturn(io(jc));})),cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(cR.kw("enforce_initial"),bZ.spBool()),(ip=function(jc){return i7(i6(jc));},function(jc){return cR.preturn(ip(jc));}))]),function(jc){return ij([jc[0],jc[1]]);}));fj.dirStabilityCorrection=cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(bZ.STABILITYCORRECTION(),bZ.spFloat()),function(jc){return cR.preturn(i8(jc));});fj.dirCoaxialDAngle=cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(bZ.COAXIALDANGLE(),bZ.spFloat()),function(jc){return cR.preturn(i9(jc));});fj.dirDoubleCoaxialDangle=cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(bZ.DOUBLECOAXIALDANGLE(),bZ.spFloat()),function(jc){return cR.preturn(i_(jc));});fj.dirCoaxialCorrection=cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(bZ.COAXIALCORRECTION(),cT.parse()),(iq=function(jc){return i$(cT.to_engineValue(jc));},function(jc){return cR.preturn(iq(jc));}));fj.dirTemperature=cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(bZ.TEMPERATURE(),bZ.spFloat()),function(jc){return cR.preturn(ja(jc));});fj.dirTerminalDAngle=cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(bZ.TERMINALDANGLE(),bZ.spFloat()),function(jc){return cR.preturn(jb(jc));});fj.pOldDirectives=bX.ofArray([bZ.dirCoaxialCorrection(),bZ.dirCoaxialDAngle(),bZ.dirConcentration(),bZ.dirDT(),bZ.dirDefaultDiffusion(),bZ.dirDiffusion(),bZ.dirDoubleCoaxialDangle(),bZ.dirDuration(),bZ.dirEvents(),function(jc){return bZ.dirFitRun(jc[0],jc[1]);},bZ.dirFit(),bZ.dirKinectics(),bZ.dirNX(),bZ.dirParameters(),bZ.dirPlot(),bZ.dirPlotWindow(),bZ.dirRelativeTolerance(),bZ.dirSamples(),bZ.dirScale(),bZ.dirSeed(),bZ.dirSimulation(),bZ.dirSpatialbc(),bZ.dirSpatialic(),bZ.dirSpatialPlot(),bZ.dirSpecMax(),bZ.dirStabilityCorrection(),bZ.dirSweep(),bZ.dirTemperature(),bZ.dirTerminalDAngle(),bZ.dirTheta(),bZ.dirTime(),bZ.dirTolerance(),bZ.dirVerification(),bZ.dirXMax()]);fj.oldDirective=(ir=cR.choice(bX.append(bX.map(function(jc){function jd(je){return{$:0,$0:je};}return cR.op_GreaterGreaterEquals(jc,function(je){return cR.preturn(jd(je));});},bZ.pOldDirectives()),bX.map(function(jc){function jd(je){return{$:1,$0:je};}return cR.op_GreaterGreaterEquals(jc,function(je){return cR.preturn(jd(je));});},bR.optionParsers()))),function(jc){return ir([jc[0],jc[1]]);});};fk.$cctor=function(){var hI,hJ,hK,hL,hM,hN,hO,hP;fk.$cctor=a.ignore;function hQ(hS){return{$:12,$0:hS};}function hR(hS){return bX.ofArray([hS]);}fk.default_rendering=b4.New("Branches","Complement",false,"Babylon");fk.default_matching_degree=1;fk.default_toehold_bind_rate=0.0003;fk.default_toehold_unbind_rate=0.1126;fk.default_leak_rate_l=1E-09;fk.default_leak_rate_w=bR.default_leak_rate_l()/100;fk.default_tau_rate=bR.default_toehold_unbind_rate();fk.default_toehold_length=6;fk.default_specificity_length=20;fk.default_elementary_migration_rate=1/0.000125;fk.default_terminalDangleFactor=1;fk.default_coaxialCorrection=0;fk.default_stabilityCorrection=0;fk.default_coaxialDangle=2;fk.default_doubleCoaxialDangle=3.2;fk.default_options=(hI={$:1,$0:bR.default_coaxialCorrection()},bS.New("Default",false,false,false,false,false,23,bR.default_stabilityCorrection(),bR.default_coaxialDangle(),bR.default_doubleCoaxialDangle(),bR.default_terminalDangleFactor(),hI,false,true,true,"",gw.toeholds(),gw.specificities(),true,true,bR.default_toehold_bind_rate(),bR.default_toehold_unbind_rate(),{$:1,$0:bR.default_leak_rate_l()},{$:1,$0:bR.default_leak_rate_w()},null,{$:1,$0:bR.default_tau_rate()},{$:1,$0:bR.default_elementary_migration_rate()},bR.default_toehold_length(),bR.default_specificity_length(),bY.Empty,"No_predicates",bR.default_rendering(),false,null));fk.pfloatSp=cR.op_DotGreaterGreater(cR.pfloat(),cR.spaces());fk.pint32Sp=cR.op_DotGreaterGreater(cR.pint32(),cR.spaces());fk.nameSp=cR.op_DotGreaterGreater(cR.name(),cR.spaces());fk.intName=cR.op_LessBarGreater(bR.nameSp(),cR.op_BarGreaterGreater(bR.pint32Sp(),hH));fk.expParser=cR.op_DotGreaterGreater(br.parse(bR.nameSp()),cR.spaces());fk.localConc=cR.op_GreaterGreaterEquals(cR.sqBrackets(cR.sepBy(cR.paren(cR.op_DotGreaterGreaterDot(cR.op_DotGreaterGreater(bR.intName(),cR.kw(",")),bR.expParser())),cR.kw(";"))),function(hS){return cR.preturn(bX.ofArray([{$:24,$0:hS}]));});fk.localConc2=cR.op_GreaterGreaterEquals(cR.sqBrackets(cR.sepBy(cR.op_DotGreaterGreaterDot(cR.op_DotGreaterGreater(bR.intName(),cR.kw("=")),bR.expParser()),cR.kw(";"))),function(hS){return cR.preturn(bX.ofArray([{$:24,$0:hS}]));});fk.toeholds=cR.op_GreaterGreaterEquals(bR.pfloatSp(),function(hS){return cR.op_GreaterGreaterEquals(bR.pfloatSp(),function(hT){return cR.preturn(bX.ofArray([{$:15,$0:hS},{$:16,$0:hT}]));});});fk.leak=cR.op_GreaterGreaterEquals(bR.expParser(),function(hS){return cR.preturn(bX.ofArray([{$:17,$0:hS}]));});fk.pinLeak=cR.op_GreaterGreaterEquals(bR.expParser(),function(hS){return cR.preturn(bX.ofArray([{$:19,$0:{$:1,$0:hS}}]));});fk.tauRate=cR.op_GreaterGreaterEquals(bR.expParser(),function(hS){return cR.preturn(bX.ofArray([{$:20,$0:hS}]));});fk.elemMigrateRate=cR.op_GreaterGreaterEquals(bR.expParser(),function(hS){return cR.preturn(bX.ofArray([{$:21,$0:hS}]));});fk.lengths=cR.op_GreaterGreaterEquals(bR.pint32Sp(),function(hS){return cR.op_GreaterGreaterEquals(bR.pint32Sp(),function(hT){return cR.preturn(bX.ofArray([{$:22,$0:hS},{$:23,$0:hT}]));});});fk.KW_COMPLEMENT="complement";fk.KW_CONDENSED="condensed";fk.KW_NUCLEOTIDES="nucleotides";fk.KW_BRANCHES="branches";fk.KW_BABYLON="babylon";fk.KW_WIDE="wide";fk.KW_CIRCLES="circles";fk.KW_CLASSIC="classic";fk.KW_ROTATE_LABELS="rotate_labels";fk.cle=b5.engine();fk.optionParsers=bX.ofArray([cR.op_GreaterGreaterDot(cR.kw("compilation"),(hJ=cR.choice([cR.op_GreaterGreaterDot(cR.kw("detailed"),cR.preturn(bX.ofArray([{$:0,$0:"Detailed"}]))),cR.op_GreaterGreaterDot(cR.kw("infinite"),cR.preturn(bX.ofArray([{$:0,$0:"Infinite"}]))),cR.op_GreaterGreaterDot(cR.kw("finite"),cR.preturn(bX.ofArray([{$:0,$0:"Finite"}]))),cR.op_GreaterGreaterDot(cR.kw("default"),cR.preturn(bX.ofArray([{$:0,$0:"Default"}])))]),function(hS){return hJ([hS[0],hS[1]]);})),cR.op_GreaterGreaterDot(cR.kw("leaks"),cR.preturn(bX.ofArray([gx.Leaks]))),cR.op_GreaterGreaterDot(cR.kw("pinleaks"),cR.preturn(bX.ofArray([gx.PinLeaks]))),cR.op_GreaterGreaterDot(cR.kw("polymers"),cR.preturn(bX.ofArray([gx.Polymers]))),cR.op_GreaterGreaterDot(cR.kw("unproductive"),cR.preturn(bX.ofArray([gx.Unproductive]))),cR.op_GreaterGreaterDot(cR.kw("sequenceRates"),cR.preturn(bX.ofArray([gx.SequenceRates]))),cR.op_GreaterGreaterDot(cR.kw("declare"),cR.preturn(bX.ofArray([gx.DeclareDomains]))),cR.op_GreaterGreaterDot(cR.kw("toeholds"),bR.toeholds()),cR.op_GreaterGreaterDot(cR.kw("leak"),bR.leak()),cR.op_GreaterGreaterDot(cR.kw("pinleak"),bR.pinLeak()),cR.op_GreaterGreaterDot(cR.kw("tau"),bR.tauRate()),cR.op_GreaterGreaterDot(cR.kw("migrate"),bR.elemMigrateRate()),cR.op_GreaterGreaterDot(cR.kw("lengths"),bR.lengths()),cR.op_GreaterGreaterDot(cR.kw("localconcentrations"),bR.localConc()),cR.op_GreaterGreaterDot(cR.kw("locations"),bR.localConc2()),cR.op_GreaterGreaterDot(cR.kw("predicates"),(hK=cR.choice([cR.op_GreaterGreaterDot(cR.kw("all"),cR.preturn(bX.ofArray([{$:25,$0:"All_predicates"}]))),cR.op_GreaterGreaterDot(cR.kw("none"),cR.preturn(bX.ofArray([{$:25,$0:"No_predicates"}])))]),function(hS){return hK([hS[0],hS[1]]);})),cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(cR.kw("rendering"),cR.record(bR.default_rendering(),bX.ofArray([["renderer",(hL=cR.choice([cR.op_BarGreaterGreater(cR.kw(bR.KW_BRANCHES()),function(){return function(hS){return b4.New("Branches",hS.mode,hS.rotate_labels,hS.arrange);};}),cR.op_BarGreaterGreater(cR.kw(bR.KW_CLASSIC()),function(){return function(hS){return b4.New("No_predicates",hS.mode,hS.rotate_labels,hS.arrange);};}),cR.op_BarGreaterGreater(cR.kw(bR.KW_CIRCLES()),function(){return function(hS){return b4.New("Circles",hS.mode,hS.rotate_labels,hS.arrange);};})]),function(hS){return hL([hS[0],hS[1]]);})],["mode",(hM=cR.choice([cR.op_BarGreaterGreater(cR.kw(bR.KW_NUCLEOTIDES()),function(){return function(hS){return b4.New(hS.renderer,"Nucleotides",hS.rotate_labels,hS.arrange);};}),cR.op_BarGreaterGreater(cR.kw(bR.KW_COMPLEMENT()),function(){return function(hS){return b4.New(hS.renderer,"Complement",hS.rotate_labels,hS.arrange);};}),cR.op_BarGreaterGreater(cR.kw(bR.KW_CONDENSED()),function(){return function(hS){return b4.New(hS.renderer,"Condensed",hS.rotate_labels,hS.arrange);};})]),function(hS){return hM([hS[0],hS[1]]);})],["arrange",(hN=cR.choice([cR.op_BarGreaterGreater(cR.kw("babylon"),function(){return function(hS){return b4.New(hS.renderer,hS.mode,hS.rotate_labels,"Babylon");};}),cR.op_BarGreaterGreater(cR.kw("wide"),function(){return function(hS){return b4.New(hS.renderer,hS.mode,hS.rotate_labels,"Wide");};})]),function(hS){return hN([hS[0],hS[1]]);})],[bR.KW_ROTATE_LABELS(),cR.op_BarGreaterGreater(cR.pbool(),function(hS){return function(hT){return b4.New(hT.renderer,hT.mode,hS,hT.arrange);};})]]))),(hO=function(hS){return hR(hQ(hS));},function(hS){return cR.preturn(hO(hS));})),cR.op_GreaterGreaterDot(cR.kw("jit"),cR.preturn(bX.ofArray([{$:32,$0:true}]))),cR.op_BarGreaterGreater(cR.op_GreaterGreaterDot(cR.kw("rules"),cR.braces(f4.pprogram(bR.cle(),function(hS){return b5.psite(bR.cle(),hS,false);}))),function(hS){return bX.ofArray([{$:33,$0:bR.dictToMap(hS)}]);}),cR.op_GreaterGreaterDot(cR.kw("jit"),cR.preturn(bX.ofArray([{$:32,$0:true}]))),cR.op_BarGreaterGreater(cR.op_GreaterGreaterDot(cR.kw("rules"),cR.braces(f4.pprogram(bR.cle(),function(hS){return b5.psite(bR.cle(),hS,false);}))),function(hS){return bX.ofArray([{$:33,$0:bR.dictToMap(hS)}]);})]);fk.parse_option=(hP=cR.choice(bR.optionParsers()),function(hS){return hP([hS[0],hS[1]]);});};fl=eb.t=hB.Class({},null,fl);_3.to_string=function(hI){var hJ;return"{ "+cS.concat("; ",bX.filter(function(hK){return hK!=="";},bX.ofArray([hI.random!==_3.defaults().random?(function(hK){return function(hL){return hK("random = "+cS.PadLeft(hL.toFixed(3),1));};}(a.id))(hI.random):"",(hJ=hI.core,hJ!=null&&hJ.$==1?hJ.$0.to_string():""),!cw.Equals(hI.points,_3.defaults().points)?"points = ["+cS.concat("; ",bX.map(function(hK){return hK.to_string();},hI.points))+"]":"",!cw.Equals(hI.rectangles,_3.defaults().rectangles)?"rectangles = ["+cS.concat("; ",bX.map(function(hK){return hK.to_string();},hI.rectangles))+"]":""])))+" }";};_3.defaults=function(){gU.$cctor();return gU.defaults;};_3.distance_from_xy=function(hI,hJ,hK,hL){return hC.sqrt(hC.pow(hK-hI,2)+hC.pow(hL-hJ,2));};_3.parser=function(){gU.$cctor();return gU.parser;};_3.default_rectangle=function(){gU.$cctor();return gU.default_rectangle;};_3.default_point=function(){gU.$cctor();return gU.default_point;};_3.default_core=function(){gU.$cctor();return gU.default_core;};fm=b8.Variable=hB.Class({Equals:function(hI){return hI instanceof fm?cw.Equals(fm.ToVar(this),fm.ToVar(hI)):be.InvalidArg("yobj","cannot compare values of different types");},get_String:function(){var hI,hJ,hK,hL;return this.$==1?(hI=this.$0,b8.printVar(hI[0],hI[1])):this.$==2?(hJ=this.$0,b8.printVar(hJ[0],hJ[1])):this.$==3?(hK=this.$0,b8.printVar(hK[0],hK[1])):(hL=this.$0,b8.printVar(hL[0],hL[1]));},GetHashCode:function(){return cw.Hash(fm.ToVar(this));},CompareTo0:function(hI){return hI instanceof fm?cw.Compare(fm.ToVar(this),fm.ToVar(hI)):be.InvalidArg("yobj","cannot compare values of different types");}},null,fm);fm.ToVar=function(hI){return hI.$==2?hI.$0:hI.$==1?hI.$0:hI.$==3?hI.$0:hI.$0;};fn=bV.KeyCollection=hB.Class({GetEnumerator$1:function(){return df.Get(co.map(function(hI){return hI.K;},this.d));},GetEnumerator:function(){return this.GetEnumerator$1();},GetEnumerator0:function(){return this.GetEnumerator$1();}},b1,fn);fn.New=hB.Ctor(function(hI){b1.New.call(this);this.d=hI;},fn);fo.$cctor=function(){fo.$cctor=a.ignore;fo.empty=bY.Empty;};fq=fp.StringBuilder=hB.Class({Append:function(hI){this._str=this._str+hI;return this;}},b1,fq);fq.New$1=hB.Ctor(function(hI){b1.New.call(this);this._str="";this._str=hI;},fq);fq.New=hB.Ctor(function(){fq.New$1.call(this,"");},fq);fr.$cctor=function(){fr.$cctor=a.ignore;fr.newline="\\r\\n";fr.tab="\\u0009";fr.quotemark="\\"";fr.space=" ";fr.empty="";fr.equals="=";fr.indent_string=de.space()+de.space();fr.preamble=de.xmltag(bX.ofArray([["version",{$:1,$0:"1.0"}],["encoding",{$:1,$0:"UTF-8"}]]))+de.newline()+de.tagopen(0,"sbml",bX.ofArray([["xmlns",{$:1,$0:"http://www.sbml.org/sbml/level2/version4"}],["level",{$:1,$0:"2"}],["version",{$:1,$0:"4"}]]))+de.newline();fr.postamble=de.tagclose(0,"sbml");fr.openAngle="&lt;";fr.closeAngle=">";fr.empty_model=fs.New(null,null,bY.Empty,bY.Empty,bY.Empty,bY.Empty,bY.Empty,bY.Empty);};fs.New=function(hI,hJ,hK,hL,hM,hN,hO,hP){return{id:hI,name:hJ,listOfUnitDefinitions:hK,listOfCompartments:hL,listOfSpecies:hM,listOfParameters:hN,listOfInitialAssignments:hO,listOfReactions:hP};};ft.Mole={$:19};ft.Litre={$:15};ft.Dimensionless={$:4};ft.Second={$:24};fu.Times={$:4};fu.Plus={$:3};fv.Divide={$:1};fv.Power={$:2};fv.Subtract={$:3};fv.Mod={$:5};fw.IsLetterOrDigit=function(hI){return fw.IsLetter(hI)||fw.IsDigit(hI);};fw.IsLetter=function(hI){return hI>="A"&&hI<="Z"||hI>="a"&&hI<="z";};fw.IsDigit=function(hI){return hI>="0"&&hI<="9";};fw.IsWhiteSpace=function(hI){return hI.match(new a.RegExp("\\\\s"))!==null;};fw.IsUpper=function(hI){return hI>="A"&&hI<="Z";};fx.$cctor=function(){fx.$cctor=a.ignore;fx.activate_idd_script="\\r\\nvar objects = document.getElementsByClassName(\\"cliplot div.fsharp-idd\\");\\r\\nfor(var i = 0; i < objects.length; i++)\\r\\n  InteractiveDataDisplay.asPlot(objects.item(i));\\r\\nobjects = document.getElementsByClassName(\\"cliplot div.idd-subplots\\");\\r\\nfor(var i = 0; i < objects.length; i++)\\r\\n  InteractiveDataDisplay.asSubPlots(objects.item(i));\\r\\n";fx.prepare_idd_script=(function(hI){return function(hJ){return hI("\\r\\n<script type=\\"text/javascript\\">\\r\\n    window.addEventListener(\\"load\\", function(){"+cA.toSafe(hJ)+"});\\r\\n<\/script>");};}(a.id))(dg.activate_idd_script());fx.cdn_scripts="\\r\\n<link rel=\\"stylesheet\\" type=\\"text/css\\" href=\\"https://cdn.jsdelivr.net/npm/interactive-data-display@1.5.30/dist/idd.css\\" integrity=\\"sha384-c0Bubh+0uCjFanb6BoVtGLQAYmnD27PrMKjIlFp3QZ/ZjpWHo+q86s7zmX1bKAmU\\" crossorigin=\\"anonymous\\"/>\\r\\n<script src=\\"https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js\\" integrity=\\"sha384-bPV3mA2eo3edoq56VzcPBmG1N1QVUfjYMxVIJPPzyFJyFZ8GFfN7Npt06Zr23qts\\" crossorigin=\\"anonymous\\"><\/script>\\r\\n<script src=\\"https://code.jquery.com/jquery-2.1.4.min.js\\" integrity=\\"sha384-R4/ztc4ZlRqWjqIuvf6RX5yb/v90qNGx6fS48N0tRxiGkqveZETq72KgDVJCp2TC\\" crossorigin=\\"anonymous\\"><\/script>\\r\\n<script src=\\"https://cdnjs.cloudflare.com/ajax/libs/rxjs/3.1.2/rx.lite.min.js\\" integrity=\\"sha384-YYQgxpPVmcgxIB80jXrurb3n9UJCb8MOA+2Om6wfF3Fji0Khse2mz3Pz87kt2wba\\" crossorigin=\\"anonymous\\"><\/script>\\r\\n<script src=\\"https://cdnjs.cloudflare.com/ajax/libs/jquery-mousewheel/3.1.13/jquery.mousewheel.min.js\\" integrity=\\"sha384-jx+EoRqSnwNqHsZoMJl/OMDriDdzqdPXunQMsJOq6eUISEJxQkBgcR88EFkA2iHw\\" crossorigin=\\"anonymous\\"><\/script>\\r\\n<script src=\\"https://cdn.jsdelivr.net/npm/interactive-data-display@1.5.30/dist/idd.js\\" integrity=\\"sha384-Ys962FVdDdKVR+cU47Lb85HIpxUsV8oK/s7lb43z8kD7481L26ecJ4Q3yqUdgRBJ\\" crossorigin=\\"anonymous\\"><\/script>\\r\\n";fx.footer_scripts_idd="\\r\\n<script>\\r\\nfunction openTab(evt, group, tabName) {\\r\\n    var i, tabcontent, tablinks;\\r\\n    tabcontent = document.getElementsByClassName(\\"tabcontent cliplot \\"+group);\\r\\n    for (i = 0; i < tabcontent.length; i++) {\\r\\n        tabcontent[i].style.display = \\"none\\";\\r\\n    }\\r\\n    tablinks = document.getElementsByClassName(\\"tablinks cliplot \\"+group);\\r\\n    for (i = 0; i < tablinks.length; i++) {\\r\\n        tablinks[i].className = tablinks[i].className.replace(\\" active\\", \\"\\");\\r\\n    }\\r\\n    document.getElementById(group+tabName).style.display = \\"block\\";\\r\\n    evt.currentTarget.className += \\" active\\";\\r\\n    var objects = document.querySelectorAll(\\"#\\"+group+tabName+\\" div.fsharp-idd\\");\\r\\n    for(var i = 0; i < objects.length; i++)\\r\\n        InteractiveDataDisplay.asPlot(objects.item(i)).requestUpdateLayout();\\r\\n    objects = document.querySelectorAll(\\"#\\"+group+tabName+\\" div.idd-subplots\\");\\r\\n    for(var i = 0; i < objects.length; i++)\\r\\n        InteractiveDataDisplay.asSubPlots(objects.item(i));\\r\\n}\\r\\nfunction openComparison(evt, group, compName) {\\r\\n    var i, compcontent, complinks;\\r\\n    compcontent = document.getElementsByClassName(\\"compcontent cliplot \\"+group);\\r\\n    for (i = 0; i < compcontent.length; i++) {\\r\\n        compcontent[i].style.display = \\"none\\";\\r\\n    }\\r\\n    complinks = document.getElementsByClassName(\\"complinks cliplot \\"+group);\\r\\n    for (i = 0; i < complinks.length; i++) {\\r\\n        complinks[i].className = complinks[i].className.replace(\\" active\\", \\"\\");\\r\\n    }\\r\\n    document.getElementById(group+compName).style.display = \\"block\\";\\r\\n    evt.currentTarget.className += \\"active\\";\\r\\n    var objects = document.querySelectorAll(\\"#\\"+group+compName+\\" div.fsharp-idd\\");\\r\\n    for(var i = 0; i < objects.length; i++)\\r\\n        InteractiveDataDisplay.asPlot(objects.item(i)).requestUpdateLayout();\\r\\n    objects = document.querySelectorAll(\\"#\\"+group+compName+\\" div.idd-subplots\\");\\r\\n    for(var i = 0; i < objects.length; i++)\\r\\n        InteractiveDataDisplay.asSubPlots(objects.item(i));\\r\\n}\\r\\nwindow.addEventListener(\\"load\\", function() { document.getElementById(\\"cliplot_defaultOpen\\").click(); });\\r\\n<\/script>";fx.page_header_scripts=((((hB.Curried(function(hI,hJ,hK,hL){return hI(cA.toSafe(hJ)+" "+cA.toSafe(hK)+" "+cA.toSafe(hL));},4))(a.id))(dg.cdn_scripts()))(dg.prepare_idd_script()))(dg.footer_scripts_idd());fx.unified_scripts=(((hB.Curried3(function(hI,hJ,hK){return hI("<script>"+cA.toSafe(hJ)+"<\/script> "+cA.toSafe(hK));}))(a.id))(dg.activate_idd_script()))(dg.footer_scripts_idd());fx.local_styles="<style>\\r\\n    .cliplot {font-family: \\"Lato\\", sans-serif;}\\r\\n    \\r\\n    ul.tab.cliplot {\\r\\n\\u0009\\u0009list-style-type: none;\\r\\n\\u0009\\u0009margin: 0;\\r\\n\\u0009\\u0009padding: 0;\\r\\n\\u0009\\u0009overflow: hidden;\\r\\n\\u0009\\u0009border: 2px solid #ccc;\\r\\n\\u0009\\u0009background-color: #f1f1f1;\\r\\n\\u0009}\\r\\n\\r\\n\\u0009/* Float the list items side by side */\\r\\n\\u0009ul.tab.cliplot li {float: left;}\\r\\n\\r\\n\\u0009/* Style the links inside the list items */\\r\\n\\u0009ul.tab.cliplot li a {\\r\\n\\u0009\\u0009display: inline-block;\\r\\n\\u0009\\u0009color: black;\\r\\n\\u0009\\u0009text-align: center;\\r\\n\\u0009\\u0009padding: 14px 16px;\\r\\n\\u0009\\u0009text-decoration: none;\\r\\n\\u0009\\u0009transition: 0.3s;\\r\\n\\u0009\\u0009font-size: 17px;\\r\\n\\u0009}\\r\\n\\r\\n\\u0009/* Change background color of links on hover */\\r\\n\\u0009ul.tab.cliplot li a:hover {\\r\\n\\u0009\\u0009background-color: #ddd;\\r\\n\\u0009}\\r\\n\\r\\n\\u0009/* Create an active/current tablink class */\\r\\n\\u0009ul.tab.cliplot li a:focus, .active.cliplot {\\r\\n\\u0009\\u0009background-color: #ccc;\\r\\n\\u0009}\\r\\n\\r\\n\\u0009/* Style the tab content */\\r\\n\\u0009.tabcontent.cliplot {\\r\\n\\u0009\\u0009display: none;\\r\\n\\u0009\\u0009padding: 12px 12px;\\r\\n\\u0009\\u0009border: 2px solid #ccc;\\r\\n\\u0009\\u0009border-top: none;\\r\\n\\u0009}\\r\\n\\r\\n\\u0009/* Style the table cells*/\\r\\n\\u0009th.cliplot, td.cliplot { \\r\\n\\u0009\\u0009padding: 3px;\\r\\n\\u0009\\u0009min-width: 50px;\\r\\n\\u0009}\\u0009\\r\\n\\u0009th.cliplot {\\r\\n\\u0009\\u0009border-top: 2px solid #000;\\r\\n\\u0009\\u0009border-bottom: 1px solid #000;\\r\\n\\u0009}\\r\\n\\u0009table.cliplot#pTable {\\r\\n\\u0009\\u0009border-collapse: collapse;\\r\\n\\u0009\\u0009border-bottom: 2px solid #000;\\r\\n\\u0009}</style>";};dS.ode_solver_error=function(hI){throw new dU.New("ODE error: "+hI);};dS.negative_simulation=function(){throw new dU.New("Cannot evaluate a proportional-error noise model for non-positive simulation values.");};fy.get_variables=function(hI){return dZ.remove_duplicates(function(hJ,hK){return hJ===hK;},bX.collect(function(hJ){return hJ.get_variables();},hI));};fy.get_variable_dependencies=function(hI){return bX.collect(function(hJ){return bX.map(function(hK){return bX.choose(function(hL){return hL.$==0?{$:1,$0:hL.$0}:null;},hK);},hJ.values);},bX.map(function(hJ){return hJ.get_merge();},hI));};fy["eval"]=function(hI,hJ){return hJ.$===0?bX.ofArray([["",cY.empty()]]):bX.collect(function(hK){return bX.map(function(hL){return[hK.name,hL];},hK["eval"](hI));},hJ);};fy.add_multiples=function(hI,hJ,hK){return bX.unzip(bX.map(function(hL){return hL.add_multiples(hI,hJ);},hK));};fy.eval_label=function(hI,hJ){return hJ.$===0?bX.ofArray([["","",cY.empty(),""]]):bX.collect(function(hK){var hL;hL=hK.simplify_assignments().eval_label(hI);return bX.map2(function(hM,hN){return(function(hO){var hP,hQ;hP=hO[0];hQ=hO[1];return function(hR){return[hK.name,hP,hQ,hR[0]];};}(hM))(hN);},hK.eval_label(hI),hL);},hJ);};fz.New=function(hI,hJ,hK){return{rnorm_phase:hI,rnorm_2:hJ,rnorm_f:hK};};fA.New=function(hI,hJ,hK,hL,hM){return{name:hI,mle:hJ,summary:hK,qsummary:hL,range:hM};};fB.New=function(hI,hJ,hK,hL,hM){return{count:hI,min:hJ,max:hK,mean:hL,variance:hM};};fC.New=function(hI,hJ,hK,hL,hM,hN,hO){return{min:hI,lb95:hJ,lb68:hK,median:hL,ub68:hM,ub95:hN,max:hO};};fD.New=function(hI,hJ,hK){return{AIC:hI,BIC:hJ,DIC:hK};};fE.New=function(hI,hJ){return{Attributes:hI,Children:hJ};};fF.New=function(hI,hJ){return{Key:hI,Value:hJ};};fG.Left={$:2};fG.Bottom={$:0};fH.New=function(hI,hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS){return{Title:hI,Charts:hJ,PlotWidth:hK,PlotHeight:hL,RowsCount:hM,ColumnsCount:hN,ExternalLegendSource:hO,Margin:hP,CommonVisibility:hQ,SyncHorizontalAxes:hR,SyncVerticalAxes:hS};};fI.$cctor=function(){fI.$cctor=a.ignore;fI.DefaultGridLines={$:1,$0:eK.DarkGrey(),$1:1};fI.Empty=eL.New(800,600,null,null,{$:1,$0:true},null,{$:1,$0:true},eJ.DefaultGridLines(),bY.Empty,eM.Automatic,true,true,{$:0,$0:20},null);};fJ.$cctor=function(){fJ.$cctor=a.ignore;fJ.namesToColours=(new cj.New([])).Add("AliceBlue",eK.createColour(240&255,248&255,255&255)).Add("AntiqueWhite",eK.createColour(250&255,235&255,215&255)).Add("Aqua",eK.createColour(0&255,255&255,255&255)).Add("Aquamarine",eK.createColour(127&255,255&255,212&255)).Add("Azure",eK.createColour(240&255,255&255,255&255)).Add("Beige",eK.createColour(245&255,245&255,220&255)).Add("Bisque",eK.createColour(255&255,228&255,196&255)).Add("Black",eK.createColour(0&255,0&255,0&255)).Add("BlanchedAlmond",eK.createColour(255&255,235&255,205&255)).Add("Blue",eK.createColour(0&255,0&255,255&255)).Add("BlueViolet",eK.createColour(138&255,43&255,226&255)).Add("Brown",eK.createColour(165&255,42&255,42&255)).Add("BurlyWood",eK.createColour(222&255,184&255,135&255)).Add("CadetBlue",eK.createColour(95&255,158&255,160&255)).Add("Chartreuse",eK.createColour(127&255,255&255,0&255)).Add("Chocolate",eK.createColour(210&255,105&255,30&255)).Add("Coral",eK.createColour(255&255,127&255,80&255)).Add("CornflowerBlue",eK.createColour(100&255,149&255,237&255)).Add("Cornsilk",eK.createColour(255&255,248&255,220&255)).Add("Crimson",eK.createColour(220&255,20&255,60&255)).Add("Cyan",eK.createColour(0&255,255&255,255&255)).Add("DarkBlue",eK.createColour(0&255,0&255,139&255)).Add("DarkCyan",eK.createColour(0&255,139&255,139&255)).Add("DarkGoldenRod",eK.createColour(184&255,134&255,11&255)).Add("DarkGray",eK.createColour(169&255,169&255,169&255)).Add("DarkGrey",eK.createColour(169&255,169&255,169&255)).Add("DarkGreen",eK.createColour(0&255,100&255,0&255)).Add("DarkKhaki",eK.createColour(189&255,183&255,107&255)).Add("DarkMagenta",eK.createColour(139&255,0&255,139&255)).Add("DarkOliveGreen",eK.createColour(85&255,107&255,47&255)).Add("DarkOrange",eK.createColour(255&255,140&255,0&255)).Add("DarkOrchid",eK.createColour(153&255,50&255,204&255)).Add("DarkRed",eK.createColour(139&255,0&255,0&255)).Add("DarkSalmon",eK.createColour(233&255,150&255,122&255)).Add("DarkSeaGreen",eK.createColour(143&255,188&255,143&255)).Add("DarkSlateBlue",eK.createColour(72&255,61&255,139&255)).Add("DarkSlateGray",eK.createColour(47&255,79&255,79&255)).Add("DarkSlateGrey",eK.createColour(47&255,79&255,79&255)).Add("DarkTurquoise",eK.createColour(0&255,206&255,209&255)).Add("DarkViolet",eK.createColour(148&255,0&255,211&255)).Add("DeepPink",eK.createColour(255&255,20&255,147&255)).Add("DeepSkyBlue",eK.createColour(0&255,191&255,255&255)).Add("DimGray",eK.createColour(105&255,105&255,105&255)).Add("DimGrey",eK.createColour(105&255,105&255,105&255)).Add("DodgerBlue",eK.createColour(30&255,144&255,255&255)).Add("FireBrick",eK.createColour(178&255,34&255,34&255)).Add("FloralWhite",eK.createColour(255&255,250&255,240&255)).Add("ForestGreen",eK.createColour(34&255,139&255,34&255)).Add("Fuchsia",eK.createColour(255&255,0&255,255&255)).Add("Gainsboro",eK.createColour(220&255,220&255,220&255)).Add("GhostWhite",eK.createColour(248&255,248&255,255&255)).Add("Gold",eK.createColour(255&255,215&255,0&255)).Add("GoldenRod",eK.createColour(218&255,165&255,32&255)).Add("Gray",eK.createColour(128&255,128&255,128&255)).Add("Grey",eK.createColour(128&255,128&255,128&255)).Add("Green",eK.createColour(0&255,128&255,0&255)).Add("GreenYellow",eK.createColour(173&255,255&255,47&255)).Add("HoneyDew",eK.createColour(240&255,255&255,240&255)).Add("HotPink",eK.createColour(255&255,105&255,180&255)).Add("IndianRed",eK.createColour(205&255,92&255,92&255)).Add("Indigo",eK.createColour(75&255,0&255,130&255)).Add("Ivory",eK.createColour(255&255,255&255,240&255)).Add("Khaki",eK.createColour(240&255,230&255,140&255)).Add("Lavender",eK.createColour(230&255,230&255,250&255)).Add("LavenderBlush",eK.createColour(255&255,240&255,245&255)).Add("LawnGreen",eK.createColour(124&255,252&255,0&255)).Add("LemonChiffon",eK.createColour(255&255,250&255,205&255)).Add("LightBlue",eK.createColour(173&255,216&255,230&255)).Add("LightCoral",eK.createColour(240&255,128&255,128&255)).Add("LightCyan",eK.createColour(224&255,255&255,255&255)).Add("LightGoldenRodYellow",eK.createColour(250&255,250&255,210&255)).Add("LightGray",eK.createColour(211&255,211&255,211&255)).Add("LightGrey",eK.createColour(211&255,211&255,211&255)).Add("LightGreen",eK.createColour(144&255,238&255,144&255)).Add("LightPink",eK.createColour(255&255,182&255,193&255)).Add("LightSalmon",eK.createColour(255&255,160&255,122&255)).Add("LightSeaGreen",eK.createColour(32&255,178&255,170&255)).Add("LightSkyBlue",eK.createColour(135&255,206&255,250&255)).Add("LightSlateGray",eK.createColour(119&255,136&255,153&255)).Add("LightSlateGrey",eK.createColour(119&255,136&255,153&255)).Add("LightSteelBlue",eK.createColour(176&255,196&255,222&255)).Add("LightYellow",eK.createColour(255&255,255&255,224&255)).Add("Lime",eK.createColour(0&255,255&255,0&255)).Add("LimeGreen",eK.createColour(50&255,205&255,50&255)).Add("Linen",eK.createColour(250&255,240&255,230&255)).Add("Magenta",eK.createColour(255&255,0&255,255&255)).Add("Maroon",eK.createColour(128&255,0&255,0&255)).Add("MediumAquaMarine",eK.createColour(102&255,205&255,170&255)).Add("MediumBlue",eK.createColour(0&255,0&255,205&255)).Add("MediumOrchid",eK.createColour(186&255,85&255,211&255)).Add("MediumPurple",eK.createColour(147&255,112&255,219&255)).Add("MediumSeaGreen",eK.createColour(60&255,179&255,113&255)).Add("MediumSlateBlue",eK.createColour(123&255,104&255,238&255)).Add("MediumSpringGreen",eK.createColour(0&255,250&255,154&255)).Add("MediumTurquoise",eK.createColour(72&255,209&255,204&255)).Add("MediumVioletRed",eK.createColour(199&255,21&255,133&255)).Add("MidnightBlue",eK.createColour(25&255,25&255,112&255)).Add("MintCream",eK.createColour(245&255,255&255,250&255)).Add("MistyRose",eK.createColour(255&255,228&255,225&255)).Add("Moccasin",eK.createColour(255&255,228&255,181&255)).Add("NavajoWhite",eK.createColour(255&255,222&255,173&255)).Add("Navy",eK.createColour(0&255,0&255,128&255)).Add("OldLace",eK.createColour(253&255,245&255,230&255)).Add("Olive",eK.createColour(128&255,128&255,0&255)).Add("OliveDrab",eK.createColour(107&255,142&255,35&255)).Add("Orange",eK.createColour(255&255,165&255,0&255)).Add("OrangeRed",eK.createColour(255&255,69&255,0&255)).Add("Orchid",eK.createColour(218&255,112&255,214&255)).Add("PaleGoldenRod",eK.createColour(238&255,232&255,170&255)).Add("PaleGreen",eK.createColour(152&255,251&255,152&255)).Add("PaleTurquoise",eK.createColour(175&255,238&255,238&255)).Add("PaleVioletRed",eK.createColour(219&255,112&255,147&255)).Add("PapayaWhip",eK.createColour(255&255,239&255,213&255)).Add("PeachPuff",eK.createColour(255&255,218&255,185&255)).Add("Peru",eK.createColour(205&255,133&255,63&255)).Add("Pink",eK.createColour(255&255,192&255,203&255)).Add("Plum",eK.createColour(221&255,160&255,221&255)).Add("PowderBlue",eK.createColour(176&255,224&255,230&255)).Add("Purple",eK.createColour(128&255,0&255,128&255)).Add("RebeccaPurple",eK.createColour(102&255,51&255,153&255)).Add("Red",eK.createColour(255&255,0&255,0&255)).Add("RosyBrown",eK.createColour(188&255,143&255,143&255)).Add("RoyalBlue",eK.createColour(65&255,105&255,225&255)).Add("SaddleBrown",eK.createColour(139&255,69&255,19&255)).Add("Salmon",eK.createColour(250&255,128&255,114&255)).Add("SandyBrown",eK.createColour(244&255,164&255,96&255)).Add("SeaGreen",eK.createColour(46&255,139&255,87&255)).Add("SeaShell",eK.createColour(255&255,245&255,238&255)).Add("Sienna",eK.createColour(160&255,82&255,45&255)).Add("Silver",eK.createColour(192&255,192&255,192&255)).Add("SkyBlue",eK.createColour(135&255,206&255,235&255)).Add("SlateBlue",eK.createColour(106&255,90&255,205&255)).Add("SlateGray",eK.createColour(112&255,128&255,144&255)).Add("SlateGrey",eK.createColour(112&255,128&255,144&255)).Add("Snow",eK.createColour(255&255,250&255,250&255)).Add("SpringGreen",eK.createColour(0&255,255&255,127&255)).Add("SteelBlue",eK.createColour(70&255,130&255,180&255)).Add("Tan",eK.createColour(210&255,180&255,140&255)).Add("Teal",eK.createColour(0&255,128&255,128&255)).Add("Thistle",eK.createColour(216&255,191&255,216&255)).Add("Tomato",eK.createColour(255&255,99&255,71&255)).Add("Turquoise",eK.createColour(64&255,224&255,208&255)).Add("Violet",eK.createColour(238&255,130&255,238&255)).Add("Wheat",eK.createColour(245&255,222&255,179&255)).Add("White",eK.createColour(255&255,255&255,255&255)).Add("WhiteSmoke",eK.createColour(245&255,245&255,245&255)).Add("Yellow",eK.createColour(255&255,255&255,0&255)).Add("YellowGreen",eK.createColour(154&255,205&255,50&255));fJ.AliceBlue=eK.namesToColours().get_Item("AliceBlue");fJ.AntiqueWhite=eK.namesToColours().get_Item("AntiqueWhite");fJ.Aqua=eK.namesToColours().get_Item("Aqua");fJ.Aquamarine=eK.namesToColours().get_Item("Aquamarine");fJ.Azure=eK.namesToColours().get_Item("Azure");fJ.Beige=eK.namesToColours().get_Item("Beige");fJ.Bisque=eK.namesToColours().get_Item("Bisque");fJ.Black=eK.namesToColours().get_Item("Black");fJ.BlanchedAlmond=eK.namesToColours().get_Item("BlanchedAlmond");fJ.Blue=eK.namesToColours().get_Item("Blue");fJ.BlueViolet=eK.namesToColours().get_Item("BlueViolet");fJ.Brown=eK.namesToColours().get_Item("Brown");fJ.BurlyWood=eK.namesToColours().get_Item("BurlyWood");fJ.CadetBlue=eK.namesToColours().get_Item("CadetBlue");fJ.Chartreuse=eK.namesToColours().get_Item("Chartreuse");fJ.Chocolate=eK.namesToColours().get_Item("Chocolate");fJ.Coral=eK.namesToColours().get_Item("Coral");fJ.CornflowerBlue=eK.namesToColours().get_Item("CornflowerBlue");fJ.Cornsilk=eK.namesToColours().get_Item("Cornsilk");fJ.Crimson=eK.namesToColours().get_Item("Crimson");fJ.Cyan=eK.namesToColours().get_Item("Cyan");fJ.DarkBlue=eK.namesToColours().get_Item("DarkBlue");fJ.DarkCyan=eK.namesToColours().get_Item("DarkCyan");fJ.DarkGoldenRod=eK.namesToColours().get_Item("DarkGoldenRod");fJ.DarkGray=eK.namesToColours().get_Item("DarkGray");fJ.DarkGrey=eK.namesToColours().get_Item("DarkGrey");fJ.DarkGreen=eK.namesToColours().get_Item("DarkGreen");fJ.DarkKhaki=eK.namesToColours().get_Item("DarkKhaki");fJ.DarkMagenta=eK.namesToColours().get_Item("DarkMagenta");fJ.DarkOliveGreen=eK.namesToColours().get_Item("DarkOliveGreen");fJ.DarkOrange=eK.namesToColours().get_Item("DarkOrange");fJ.DarkOrchid=eK.namesToColours().get_Item("DarkOrchid");fJ.DarkRed=eK.namesToColours().get_Item("DarkRed");fJ.DarkSalmon=eK.namesToColours().get_Item("DarkSalmon");fJ.DarkSeaGreen=eK.namesToColours().get_Item("DarkSeaGreen");fJ.DarkSlateBlue=eK.namesToColours().get_Item("DarkSlateBlue");fJ.DarkSlateGray=eK.namesToColours().get_Item("DarkSlateGray");fJ.DarkSlateGrey=eK.namesToColours().get_Item("DarkSlateGrey");fJ.DarkTurquoise=eK.namesToColours().get_Item("DarkTurquoise");fJ.DarkViolet=eK.namesToColours().get_Item("DarkViolet");fJ.DeepPink=eK.namesToColours().get_Item("DeepPink");fJ.DeepSkyBlue=eK.namesToColours().get_Item("DeepSkyBlue");fJ.DimGray=eK.namesToColours().get_Item("DimGray");fJ.DimGrey=eK.namesToColours().get_Item("DimGrey");fJ.DodgerBlue=eK.namesToColours().get_Item("DodgerBlue");fJ.FireBrick=eK.namesToColours().get_Item("FireBrick");fJ.FloralWhite=eK.namesToColours().get_Item("FloralWhite");fJ.ForestGreen=eK.namesToColours().get_Item("ForestGreen");fJ.Fuchsia=eK.namesToColours().get_Item("Fuchsia");fJ.Gainsboro=eK.namesToColours().get_Item("Gainsboro");fJ.GhostWhite=eK.namesToColours().get_Item("GhostWhite");fJ.Gold=eK.namesToColours().get_Item("Gold");fJ.GoldenRod=eK.namesToColours().get_Item("GoldenRod");fJ.Gray=eK.namesToColours().get_Item("Gray");fJ.Grey=eK.namesToColours().get_Item("Grey");fJ.Green=eK.namesToColours().get_Item("Green");fJ.GreenYellow=eK.namesToColours().get_Item("GreenYellow");fJ.HoneyDew=eK.namesToColours().get_Item("HoneyDew");fJ.HotPink=eK.namesToColours().get_Item("HotPink");fJ.IndianRed=eK.namesToColours().get_Item("IndianRed");fJ.Indigo=eK.namesToColours().get_Item("Indigo");fJ.Ivory=eK.namesToColours().get_Item("Ivory");fJ.Khaki=eK.namesToColours().get_Item("Khaki");fJ.Lavender=eK.namesToColours().get_Item("Lavender");fJ.LavenderBlush=eK.namesToColours().get_Item("LavenderBlush");fJ.LawnGreen=eK.namesToColours().get_Item("LawnGreen");fJ.LemonChiffon=eK.namesToColours().get_Item("LemonChiffon");fJ.LightBlue=eK.namesToColours().get_Item("LightBlue");fJ.LightCoral=eK.namesToColours().get_Item("LightCoral");fJ.LightCyan=eK.namesToColours().get_Item("LightCyan");fJ.LightGoldenRodYellow=eK.namesToColours().get_Item("LightGoldenRodYellow");fJ.LightGray=eK.namesToColours().get_Item("LightGray");fJ.LightGrey=eK.namesToColours().get_Item("LightGrey");fJ.LightGreen=eK.namesToColours().get_Item("LightGreen");fJ.LightPink=eK.namesToColours().get_Item("LightPink");fJ.LightSalmon=eK.namesToColours().get_Item("LightSalmon");fJ.LightSeaGreen=eK.namesToColours().get_Item("LightSeaGreen");fJ.LightSkyBlue=eK.namesToColours().get_Item("LightSkyBlue");fJ.LightSlateGray=eK.namesToColours().get_Item("LightSlateGray");fJ.LightSlateGrey=eK.namesToColours().get_Item("LightSlateGrey");fJ.LightSteelBlue=eK.namesToColours().get_Item("LightSteelBlue");fJ.LightYellow=eK.namesToColours().get_Item("LightYellow");fJ.Lime=eK.namesToColours().get_Item("Lime");fJ.LimeGreen=eK.namesToColours().get_Item("LimeGreen");fJ.Linen=eK.namesToColours().get_Item("Linen");fJ.Magenta=eK.namesToColours().get_Item("Magenta");fJ.Maroon=eK.namesToColours().get_Item("Maroon");fJ.MediumAquaMarine=eK.namesToColours().get_Item("MediumAquaMarine");fJ.MediumBlue=eK.namesToColours().get_Item("MediumBlue");fJ.MediumOrchid=eK.namesToColours().get_Item("MediumOrchid");fJ.MediumPurple=eK.namesToColours().get_Item("MediumPurple");fJ.MediumSeaGreen=eK.namesToColours().get_Item("MediumSeaGreen");fJ.MediumSlateBlue=eK.namesToColours().get_Item("MediumSlateBlue");fJ.MediumSpringGreen=eK.namesToColours().get_Item("MediumSpringGreen");fJ.MediumTurquoise=eK.namesToColours().get_Item("MediumTurquoise");fJ.MediumVioletRed=eK.namesToColours().get_Item("MediumVioletRed");fJ.MidnightBlue=eK.namesToColours().get_Item("MidnightBlue");fJ.MintCream=eK.namesToColours().get_Item("MintCream");fJ.MistyRose=eK.namesToColours().get_Item("MistyRose");fJ.Moccasin=eK.namesToColours().get_Item("Moccasin");fJ.NavajoWhite=eK.namesToColours().get_Item("NavajoWhite");fJ.Navy=eK.namesToColours().get_Item("Navy");fJ.OldLace=eK.namesToColours().get_Item("OldLace");fJ.Olive=eK.namesToColours().get_Item("Olive");fJ.OliveDrab=eK.namesToColours().get_Item("OliveDrab");fJ.Orange=eK.namesToColours().get_Item("Orange");fJ.OrangeRed=eK.namesToColours().get_Item("OrangeRed");fJ.Orchid=eK.namesToColours().get_Item("Orchid");fJ.PaleGoldenRod=eK.namesToColours().get_Item("PaleGoldenRod");fJ.PaleGreen=eK.namesToColours().get_Item("PaleGreen");fJ.PaleTurquoise=eK.namesToColours().get_Item("PaleTurquoise");fJ.PaleVioletRed=eK.namesToColours().get_Item("PaleVioletRed");fJ.PapayaWhip=eK.namesToColours().get_Item("PapayaWhip");fJ.PeachPuff=eK.namesToColours().get_Item("PeachPuff");fJ.Peru=eK.namesToColours().get_Item("Peru");fJ.Pink=eK.namesToColours().get_Item("Pink");fJ.Plum=eK.namesToColours().get_Item("Plum");fJ.PowderBlue=eK.namesToColours().get_Item("PowderBlue");fJ.Purple=eK.namesToColours().get_Item("Purple");fJ.RebeccaPurple=eK.namesToColours().get_Item("RebeccaPurple");fJ.Red=eK.namesToColours().get_Item("Red");fJ.RosyBrown=eK.namesToColours().get_Item("RosyBrown");fJ.RoyalBlue=eK.namesToColours().get_Item("RoyalBlue");fJ.SaddleBrown=eK.namesToColours().get_Item("SaddleBrown");fJ.Salmon=eK.namesToColours().get_Item("Salmon");fJ.SandyBrown=eK.namesToColours().get_Item("SandyBrown");fJ.SeaGreen=eK.namesToColours().get_Item("SeaGreen");fJ.SeaShell=eK.namesToColours().get_Item("SeaShell");fJ.Sienna=eK.namesToColours().get_Item("Sienna");fJ.Silver=eK.namesToColours().get_Item("Silver");fJ.SkyBlue=eK.namesToColours().get_Item("SkyBlue");fJ.SlateBlue=eK.namesToColours().get_Item("SlateBlue");fJ.SlateGray=eK.namesToColours().get_Item("SlateGray");fJ.SlateGrey=eK.namesToColours().get_Item("SlateGrey");fJ.Snow=eK.namesToColours().get_Item("Snow");fJ.SpringGreen=eK.namesToColours().get_Item("SpringGreen");fJ.SteelBlue=eK.namesToColours().get_Item("SteelBlue");fJ.Tan=eK.namesToColours().get_Item("Tan");fJ.Teal=eK.namesToColours().get_Item("Teal");fJ.Thistle=eK.namesToColours().get_Item("Thistle");fJ.Tomato=eK.namesToColours().get_Item("Tomato");fJ.Turquoise=eK.namesToColours().get_Item("Turquoise");fJ.Violet=eK.namesToColours().get_Item("Violet");fJ.Wheat=eK.namesToColours().get_Item("Wheat");fJ.White=eK.namesToColours().get_Item("White");fJ.WhiteSmoke=eK.namesToColours().get_Item("WhiteSmoke");fJ.Yellow=eK.namesToColours().get_Item("Yellow");fJ.YellowGreen=eK.namesToColours().get_Item("YellowGreen");};fK.New=function(hI,hJ,hK,hL){return{Ticks:hI,Labels:hJ,Angle:hK,ForceLabelsVisibility:hL};};fL.New=function(hI,hJ,hK,hL,hM,hN){return{Name:hI,X:hJ,Y:hK,Data:hL,Palette:hM,Opacity:hN};};fM.Default={$:1};fN.New=function(hI,hJ,hK,hL,hM,hN,hO){return{Name:hI,X:hJ,Y:hK,Size:hL,FillColour:hM,BorderColour:hN,Shape:hO};};fO.Default={$:0};fP.New=function(hI,hJ,hK,hL,hM,hN,hO){return{Name:hI,X:hJ,Y:hK,Colour:hL,Thickness:hM,LineCap:hN,LineJoin:hO};};fQ.Butt={$:0};fR.Miter={$:2};fS.New=function(hI,hJ,hK,hL){return{Name:hI,Samples:hJ,Colour:hK,BinCount:hL};};fT.$cctor=function(){var hI;fT.$cctor=a.ignore;function hJ(hK){return hK.$==0?hK.$0.$==0?{$:0,$0:{$:2,$0:(bG.get_from_string())(hK.$0.$0)}}:hK:hK;}fT.parse=br.parse(bq.parse(bG.get_parse()));fT.parse_plot=(hI=br.parse(bq.parse(bG.get_parse())),function(hK){return gz.op_BarGreaterGreater(hI,hJ,hK[0],hK[1]);});};fU=cR.ParserBuilder=hB.Class({},b1,fU);fU.New=hB.Ctor(function(){b1.New.call(this);},fU);fV.kwList=function(){gS.$cctor();return gS.kwList;};fW.Absent={$:0};fX.New=function(hI,hJ,hK,hL,hM){return{x:hI,dt:hJ,prevDt:hK,e:hL,k:hM};};fY=bb.ArgumentException=hB.Class({},db,fY);fY.New$2=hB.Ctor(function(hI){this.message=hI;da.setPrototypeOf(this,fY.prototype);},fY);fY.New=hB.Ctor(function(hI,hJ){fY.New$2.call(this,hJ+"\\nParameter name: "+hI);},fY);fZ.New=function(hI,hJ,hK){return{path_class:hI,commands:hJ,path_label:hK};};f0.New=function(hI,hJ,hK,hL,hM){return{label_text:hI,label_anchor:hJ,label_class:hK,letter_width:hL,label_dir:hM};};f1.$cctor=function(){var hI;f1.$cctor=a.ignore;function hJ(hK){return" transform=\\"translate("+hK+")\\"";}f1.pi=3.14159265359;f1.origo=dW.New(0,0);f1.pointradius=1.25;f1.default_letter_width=8;f1.fontsize=15;f1.text_height=cB.fontsize()+2;f1.half_text_height=cB.text_height()/2;f1.translate_anchor_by=function(hK){function hL(hM){return cB.translate_point_by(hK,hM);}return function(hM){return cB.transform_anchor_by(hL,hM);};};f1.translate_path_command_by=function(hK){function hL(hM){return cB.translate_point_by(hK,hM);}return function(hM){return cB.transform_path_command_by(hL,hM);};};f1.translate_label_by=function(hK){function hL(hM){return cB.translate_point_by(hK,hM);}return function(hM){return cB.transform_label_by(hL,hM);};};f1.translate_path_by=function(hK){function hL(hM){return cB.translate_point_by(hK,hM);}return function(hM){return cB.transform_path_by(hL,hM);};};f1.translate_to_string=(hI=function(hK){return hJ(cB.point_to_string(hK));},function(hK){return cB.on_option(hI,"",hK);});f1.translate_group_by=function(hK){function hL(hM){return cB.translate_point_by(hK,hM);}return function(hM){return cB.transform_group_by(hL,hM);};};};f3=f2.SparseVector=hB.Class({get_Indices:function(){return this.indices;},get_Items:function(){return this.items;},get_Length:function(){return this.n;},minus:function(hI){function hJ(hK,hL){return hK-hL;}return this.binary(function(hK){return function(hL){return hJ(hK,hL);};},hI);},get_Count:function(){return this.count;},set_Item:function(hI,hJ){var hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW;if(hI<0||hI>=this.n)be.FailWith("index is out of range");else{hM=(hK=ck.tryFindIndex(function(hX){return hX===hI;},d1.array(this.indices,{$:1,$0:0},{$:1,$0:this.count-1})),hK==null?ck.forall(function(hX){return hX<hI;},d1.array(this.indices,{$:1,$0:0},{$:1,$0:this.count-1}))?~this.count:(hL=ck.tryFindIndex(function(hX){return hX>hI;},d1.array(this.indices,{$:1,$0:0},{$:1,$0:this.count-1})),hL==null?-1:~hL.$0):hK.$0);if(hM>=0)ck.set(this.items,hM,hJ);else{hN=~hM;if(this.count>=ck.length(this.items)){hO=hC.min(16,this.n-ck.length(this.items));hP=ck.create(this.indices.length+hO,0);hQ=ck.create(this.items.length+hO,0);for(hR=0,hS=this.indices.length-1;hR<=hS;hR++)ck.set(hP,hR,ck.get(this.indices,hR));for(hT=0,hU=this.items.length-1;hT<=hU;hT++)ck.set(hQ,hT,ck.get(this.items,hT));this.items=hQ;this.indices=hP;for(hV=0,hW=this.count-hN-1;hV<=hW;hV++){ck.set(this.indices,this.count-hV,ck.get(this.indices,this.count-hV-1));ck.set(this.items,this.count-hV,ck.get(this.items,this.count-hV-1));}this.count=this.count+1;ck.set(this.indices,hN,hI);ck.set(this.items,hN,hJ);}else void 0;}}},binary:function(hI,hJ){var hK,hL,hM;function hN(hO,hP,hQ){var hR;hR=ck.unzip(ck.ofList(bX.rev(hQ)));return new f3.New$1(hR[1].concat(d1.array(hO.get_Items(),{$:1,$0:hP},{$:1,$0:hO.get_Count()-1})),hR[0].concat(d1.array(hO.get_Indices(),{$:1,$0:hP},{$:1,$0:hO.get_Count()-1})),hO.get_Length());}hK=this;!(this.get_Length()===hJ.get_Length())?be.FailWith("Minus requires two vectors of the same length"):void 0;hL=this.get_Count();hM=hJ.get_Count();return hL===0?new f3.New$1(ck.map(hI(0),hJ.get_Items()),hJ.get_Indices(),hJ.get_Length()):hM===0?this:function(hO,hP,hQ){var hR,hS,hT,hU,hV,hW;while(true){hR=ck.get(hK.get_Indices(),hO);hS=ck.get(hJ.get_Indices(),hP);hT=hR-hS;if(hT<0){hU=new bY({$:1,$0:[hR,(hI(ck.get(hK.get_Items(),hR)))(0)],$1:hQ});if(hO<hK.get_Count()-1){hO=hO+1;hQ=hU;}else return hN(hJ,hP,hU);}else if(hT>0){hV=new bY({$:1,$0:[hS,(hI(0))(ck.get(hJ.get_Items(),hS))],$1:hQ});if(hP<hJ.get_Count()-1){hP=hP+1;hQ=hV;}else return hN(hK,hO,hV);}else if(hT===0){hW=new bY({$:1,$0:[hR,(hI(ck.get(hK.get_Items(),hO)))(ck.get(hJ.get_Items(),hP))],$1:hQ});if(hO<hK.get_Count()-1&&hP<hJ.get_Count()-1){hO=hO+1;hP=hP+1;hQ=hW;}else return hO<hK.get_Count()-1?hN(hK,hO+1,hW):hN(hJ,hP+1,hW);}else throw new hz.New("..\\\\Oslo.FSharp\\\\SparseVector.fs",97,16);}}(0,0,bY.Empty);}},b1,f3);f3.New$1=hB.Ctor(function(hI,hJ,hK){b1.New.call(this);this.n=hK;this.items=cw.Equals(hI,null)?be.FailWith("argument is null"):hI;this.indices=cw.Equals(hJ,null)?be.FailWith("argument is null"):hJ;this.count=ck.sumBy(function(hL){return hL*hL;},this.items)===0?0:this.items.length;},f3);co.enumWhile=function(hI,hJ){return{GetEnumerator:function(){return new ex.New(null,null,function(hK){var hL;while(true){hL=hK.s;if(cw.Equals(hL,null)){if(hI()){hK.s=df.Get(hJ);hK=hK;}else return false;}else if(hL.MoveNext()){hK.c=hL.Current();return true;}else{hL.Dispose();hK.s=null;hK=hK;}}},function(hK){var hL;hL=hK.s;!cw.Equals(hL,null)?hL.Dispose():void 0;});}};};co.enumUsing=function(hI,hJ){return{GetEnumerator:function(){var hK,hL;try{hK=df.Get(hJ(hI));}catch(hM){hL=hI;hL.Dispose();throw hM;}return new ex.New(null,null,function(hN){return hK.MoveNext()&&(hN.c=hK.Current(),true);},function(){var hN;hK.Dispose();hN=hI;hN.Dispose();});}};};f4.psystem=function(hI){return cR.op_BarGreaterGreater(cR.sepBy1(cR.between(cR.kw("<"),cR.kw(">"),cR.many1(hI)),cR.kw("|")),b$.OfList);};f4.pprogram=function(hI,hJ){return cR.op_BarGreaterGreater(cR.many(f4.pclause(hI,hJ,b8.idProvider)),b8.toProgram);};f4.pterm=function(hI,hJ,hK,hL,hM,hN){return f4.doPTerm(hI,hJ,false,false,hK,hL,hM,hN);};f4.pname=function(){hh.$cctor();return hh.pname;};f4.pclause=function(hI,hJ,hK){var hL,hM,hN;hL=hK();hM=hJ(hL);return cR.op_GreaterGreaterEquals(cR.op_DotGreaterGreaterDot(f4.pname(),cR.paren(cR.sepBy((hN=hI.domainKeywords,function(hO){return f4.pterm(hM,hI,hL,hN,hO[0],hO[1]);}),cR.kw(",")))),function(hO){var hP,hQ;hP=new cg({$:0,$0:hO[0],$1:hO[1]});return cR.op_BarGreaterGreater((hQ=cR.choice([cR.op_GreaterGreaterDot(cR.kw("."),cR.preturn(ci.Create(hP))),cR.op_GreaterGreaterEquals(cR.op_DotGreaterGreater(cR.op_GreaterGreaterDot(cR.kw(":-"),cR.sepBy1(f4.pliteral(hI,hM,hL,hI.domainKeywords),cR.kw(","))),cR.kw(".")),function(hR){return cR.preturn(ci.Create$1(hP,hR));})]),function(hR){return hQ([hR[0],hR[1]]);}),hI.disambiguateVars);});};f4.doPTerm=function(hI,hJ,hK,hL,hM,hN,hO,hP){var hQ,hR,hS,hT,hU,hV,hW,hX;function hY(h2,h3){return f4.doPTerm(hI,hJ,hK,hL,hM,hN,h2,h3);}function hZ(h2,h3){return f4.doPTerm(hI,hJ,true,hL,hM,hN,h2,h3);}function h0(h2){return(cR.op_BarGreaterGreater(br.parse(function(h3){return hZ(h3[0],h3[1]);}),ca.FromExpression))(h2);}function h1(h2){return(cR.op_BarGreaterGreater(cR.sepBy(cR.op_LessBarGreater(cR.op_BarGreaterGreater(cR.op_PlusGreaterGreaterPlus(cR.pint32(),function(h3){return hZ(h3[0],h3[1]);}),function(h3){return[h3[0],h3[1]];}),cR.op_BarGreaterGreater(function(h3){return hZ(h3[0],h3[1]);},function(h3){return[1,h3];})),cR.kw("+")),function(h3){return{$:7,$0:h3};}))(h2);}hQ=(hR=cR.choice([cR.op_GreaterGreaterDot(cR.kw("+"),cR.preturn(hp.PArithmetic)),cR.op_GreaterGreaterDot(cR.kw("-"),cR.preturn(hp.PArithmetic)),cR.op_GreaterGreaterDot(cR.kw("*"),cR.preturn(hp.PArithmetic)),cR.op_GreaterGreaterDot(cR.kw("/"),cR.preturn(hp.PArithmetic)),cR.op_GreaterGreaterDot(cR.kw("**"),cR.preturn(hp.PArithmetic)),cR.op_GreaterGreaterDot(cR.kw("%"),cR.preturn(hp.PArithmetic))]),function(h2){return hR([h2[0],h2[1]]);});return(cR.op_GreaterGreaterEquals((hS=cR.choice([cR.op_BarGreaterGreater(function(h2){return f4.pnil(h2[0],h2[1]);},function(h2){return{$:9,$0:h2};}),cR.paren(function(h2){return hY(h2[0],h2[1]);}),cR.op_GreaterGreaterEquals(cR.plookAheadWith(cR.op_GreaterGreaterDot(cR.op_GreaterGreaterDot(cR.pfloat(),cR.spaces()),(hT=cR.choice([hQ,cR.preturn(hp.PPattern)]),function(h2){return hT([h2[0],h2[1]]);}))),function(h2){return h2.$==2?h0:h2.$==1?cR.op_BarGreaterGreater(cR.op_DotGreaterGreater(cR.pfloat(),cR.spaces()),function(h3){return{$:2,$0:h3};}):be.FailWith("");}),cR.op_GreaterGreaterEquals(cR.plookAheadWith(cR.op_GreaterGreaterDot(cR.op_GreaterGreaterDot(cR.pint32(),cR.spaces()),(hU=cR.choice([hQ,cR.preturn(hp.PPattern)]),function(h2){return hU([h2[0],h2[1]]);}))),function(h2){function h3(h4){return{$:2,$0:h4};}return h2.$==2?h0:h2.$==1?cR.op_BarGreaterGreater(cR.op_DotGreaterGreater(cR.pint32(),cR.spaces()),function(h4){return h3(a.id(h4));}):be.FailWith("");}),cR.op_BarGreaterGreater(cR.op_BarGreaterGreater(cR.op_GreaterGreaterDot(cR.kw("\\""),cR.op_DotGreaterGreater(cR.manySatisfy(function(h2){return"\\""!==h2;}),cR.kw("\\""))),function(h2){return[h2].join("");}),function(h2){return{$:1,$0:h2};}),cR.sqBrackets((hV=cR.choice([cR.op_GreaterGreaterEquals(cR.sepBy(function(h2){return hY(h2[0],h2[1]);},cR.kw(";")),function(h2){var h3;h3=cR.choice([cR.op_BarGreaterGreater(cR.op_GreaterGreaterDot(cR.kw("#"),f4.pname()),function(h4){var h5;return bX.foldBack(function(h6,h7){return{$:5,$0:h6,$1:h7};},h2,(h5=h4==="_"?[-1,"_"]:hM(h4),{$:0,$0:h5[0],$1:h5[1]}));}),cR.preturn({$:4,$0:h2})]);return function(h4){return h3([h4[0],h4[1]]);};})]),function(h2){return hV([h2[0],h2[1]]);})),cR.op_BarGreaterGreater(f4.psystem(hI),function(h2){return{$:8,$0:h2};}),cR.op_BarGreaterGreater(cR.braces(cR.op_GreaterGreaterDot(cR.opt(cR.kw("|")),cR.sepBy1(cR.op_GreaterGreaterEquals(cR.op_DotGreaterGreaterDot(h1,(hW=cR.choice([cR.op_BarGreaterGreater(cR.op_GreaterGreaterDot(cR.kw("~"),h1),function(h2){return{$:1,$0:h2};}),cR.preturn(null)]),function(h2){return hW([h2[0],h2[1]]);})),function(h2){var h3,h4,h5,h6;function h7(h_){return(cR.op_BarGreaterGreater(br.parse(function(h$){return hY(h$[0],h$[1]);}),ca.FromExpression))(h_);}function h8(h_){return(cR.op_BarGreaterGreater(br.parse(bq.parse(function(h$){return hY(h$[0],h$[1]);})),ca.FromFuncExpression))(h_);}function h9(h_,h$){return(cR.choice([cR.op_BarGreaterGreater((cR.bracket("{","}"))(h7),function(ia){return{$:3,$0:hq.get_massActionRate(),$1:bX.ofArray([ia])};}),cR.op_BarGreaterGreater((cR.bracket("[","]"))(h8),function(ia){return{$:3,$0:hq.get_functionalRate(),$1:bX.ofArray([ia])};})]))([h_,h$]);}h3=h2[0];h4=h2[1];h5={$:2,$0:1};return cR.op_GreaterGreaterEquals(cR.op_DotGreaterGreaterDot((h6=cR.choice([cR.op_GreaterGreaterDot(cR.kw("->"),cR.op_LessBarGreater(cR.op_BarGreaterGreater(function(h_){return h9(h_[0],h_[1]);},function(h_){return[h_,null];}),cR.preturn([{$:3,$0:hq.get_massActionRate(),$1:bX.ofArray([h5])},null]))),cR.op_BarGreaterGreater(cR.op_GreaterGreaterDot(cR.kw("<->"),cR.op_LessBarGreater(cR.pTry(cR.op_PlusGreaterGreaterPlus(function(h_){return h9(h_[0],h_[1]);},function(h_){return h9(h_[0],h_[1]);})),cR.op_BarGreaterGreater(cR.op_LessBarGreater(cR.braces(cR.op_PlusGreaterGreaterPlus(cR.op_PlusGreaterGreater(h7,cR.kw(",")),h7)),cR.preturn([h5,h5])),function(h_){return[{$:3,$0:hq.get_massActionRate(),$1:bX.ofArray([h_[0]])},{$:3,$0:hq.get_massActionRate(),$1:bX.ofArray([h_[1]])}];}))),function(h_){return[h_[0],{$:1,$0:h_[1]}];})]),function(h_){return h6([h_[0],h_[1]]);}),h1),function(h_){var h$,ia,ib,ic;h$=h_[0];ia=h_[1];ib=h$[0];ic=h$[1];return cR.preturn(h4!=null&&h4.$==1?{$:3,$0:hq.get_reaction(),$1:bX.ofArray([h3,h4.$0,ib,ic!=null&&ic.$==1?ic.$0:{$:3,$0:"",$1:bY.Empty},ia])}:{$:3,$0:hq.get_reaction(),$1:bX.ofArray([{$:7,$0:bY.Empty},h3,ib,ic!=null&&ic.$==1?ic.$0:{$:3,$0:"",$1:bY.Empty},ia])});});}),cR.kw("|")))),function(h2){return{$:6,$0:h2};}),cR.op_GreaterGreaterEquals(cR.plookAheadWith((hX=cR.choice([cR.op_GreaterGreaterEquals(cR.op_LessBarGreater(f4.pname(),cR.kw("_")),function(h2){var h3,h4,h5;return h2==="_"||fw.IsUpper(h2[0])?(h3=cR.choice(bX.ofSeq(co.delay(function(){return co.append([cR.op_GreaterGreaterDot(cR.kw("->"),cR.preturn(hp.PVariable))],co.delay(function(){return co.append([cR.op_GreaterGreaterDot(cR.kw("<->"),cR.preturn(hp.PVariable))],co.delay(function(){return co.append([cR.op_GreaterGreaterDot(cR.kw("[["),cR.preturn(hp.PContext))],co.delay(function(){return co.append([cR.op_GreaterGreaterDot(cR.kw("["),cR.preturn(hp.PContext))],co.delay(function(){var h6;return co.append([cR.op_GreaterGreaterDot((h6=cR.choice(bX.map(cR.kw,hN)),function(h7){return h6([h7[0],h7[1]]);}),cR.preturn(hp.PPattern))],co.delay(function(){return co.append(hK?[cR.preturn(hp.PVariable)]:[hQ],co.delay(function(){return co.append([cR.op_GreaterGreaterDot(cR.kw("is"),cR.preturn(hp.PVariable))],co.delay(function(){return co.append([cR.op_GreaterGreaterDot(cR.kw(">="),cR.preturn(hp.PVariable))],co.delay(function(){return co.append([cR.op_GreaterGreaterDot(cR.kw("<="),cR.preturn(hp.PVariable))],co.delay(function(){return co.append([cR.op_GreaterGreaterDot(cR.kw("<"),cR.preturn(hp.PVariable))],co.delay(function(){return co.append([cR.op_GreaterGreaterDot(cR.kw(">"),cR.preturn(hp.PVariable))],co.delay(function(){return co.append([cR.op_GreaterGreaterDot(cR.kw("="),cR.preturn(hp.PVariable))],co.delay(function(){return co.append([cR.op_GreaterGreaterDot(cR.kw("->"),cR.preturn(hp.PVariable))],co.delay(function(){return co.append([cR.op_GreaterGreaterDot(cR.kw("<->"),cR.preturn(hp.PVariable))],co.delay(function(){return co.append([cR.op_GreaterGreaterDot(cR.kw(":"),cR.preturn(hp.PVariable))],co.delay(function(){return[cR.preturn(hp.PVariable)];}));}));}));}));}));}));}));}));}));}));}));}));}));}));}));}))),function(h6){return h3([h6[0],h6[1]]);}):bX.contains(h2,bX.ofArray(["sum","prod","log","ceiling","floor","round"]))?cR.preturn(hp.PArithmetic):(h4=cR.choice([cR.op_GreaterGreaterDot(cR.kw("("),cR.preturn(hp.PFunction)),cR.op_GreaterGreaterDot((h5=cR.choice(bX.map(cR.kw,hN)),function(h6){return h5([h6[0],h6[1]]);}),cR.preturn(hp.PPattern)),cR.op_GreaterGreaterDot(cR.kw("is"),cR.preturn(hp.PPattern)),cR.op_GreaterGreaterDot(cR.kw(">="),cR.preturn(hp.PPattern)),cR.op_GreaterGreaterDot(cR.kw("<="),cR.preturn(hp.PPattern)),cR.op_GreaterGreaterDot(cR.kw("<"),cR.preturn(hp.PPattern)),cR.op_GreaterGreaterDot(cR.kw(">"),cR.preturn(hp.PPattern)),cR.op_GreaterGreaterDot(cR.kw("="),cR.preturn(hp.PPattern)),cR.op_GreaterGreaterDot(cR.kw("@"),cR.preturn(hp.PPattern)),cR.op_GreaterGreaterDot(cR.kw("->"),cR.preturn(hp.PPattern)),cR.op_GreaterGreaterDot(cR.kw("<->"),cR.preturn(hp.PPattern)),cR.op_GreaterGreaterDot(cR.kw(":"),cR.preturn(hp.PPattern)),cR.op_GreaterGreaterDot(f4.pname(),cR.preturn(hp.PPattern)),cR.preturn(hp.PPattern)]),function(h6){return h4([h6[0],h6[1]]);});})]),function(h2){return hX([h2[0],h2[1]]);})),function(h2){var h3,h4,h5,h6;function h7(h_){return h_==="_"?[-1,"_"]:hM(h_);}function h8(h_,h$){return{$:0,$0:h_,$1:h$};}function h9(h_,h$){return{$:0,$0:h_,$1:h$};}if(!hL)h3=h2;else switch(h2.$==1?1:h2.$==3?2:h2.$==2?2:h2.$==4?3:0){case 0:h3=hp.PFunction;break;case 1:h3=hp.PPattern;break;case 2:h3=hp.PVariable;break;case 3:h3=h2;break;}return h3.$==1?cR.op_BarGreaterGreater(f4.ppattern(hI,hM),function(h_){return{$:9,$0:h_};}):h3.$==2?cR.op_BarGreaterGreater(br.parse(function(h_){return f4.doPTerm(hI,hJ,true,hL,hM,hN,h_[0],h_[1]);}),ca.FromExpression):h3.$==3?cR.op_GreaterGreaterEquals((h5=cR.choice([cR.op_BarGreaterGreater(f4.pname(),function(h_){return h8.apply(null,h7(h_));}),cR.op_BarGreaterGreater(cR.kw("_"),function(h_){return{$:0,$0:-1,$1:h_};})]),function(h_){return h5([h_[0],h_[1]]);}),function(h_){var h$;return hK?cR.preturn(h_):(h$=cR.choice([cR.op_BarGreaterGreater(cR.op_GreaterGreaterDot(cR.kw("|"),cR.sepBy1(function(ia){return hY(ia[0],ia[1]);},cR.kw("|"))),function(ia){return{$:4,$0:new bY({$:1,$0:h_,$1:ia})};}),cR.preturn(h_)]),function(ia){return h$([ia[0],ia[1]]);});}):h3.$==4?cR.op_GreaterGreaterEquals(cR.op_BarGreaterGreater(cR.op_DotGreaterGreaterDot(cR.op_LessBarGreater(f4.pname(),cR.kw("_")),(h6=cR.choice([cR.op_BarGreaterGreater(cR.op_DotGreaterGreater(cR.op_DotGreaterGreater(cR.op_GreaterGreaterDot(cR.kw("[["),cR.name()),cR.spaces()),cR.kw("]]")),function(h_){return h9.apply(null,h7(h_));}),cR.op_BarGreaterGreater(cR.many1(cR.sqBrackets(f4.ppattern(hI,hM))),function(h_){return{$:4,$0:bX.map(function(h$){return{$:9,$0:h$};},h_)};})]),function(h_){return h6([h_[0],h_[1]]);})),function(h_){var h$;return{$:3,$0:hq.get_context(),$1:bX.ofArray([(h$=h7(h_[0]),{$:0,$0:h$[0],$1:h$[1]}),h_[1]])};}),function(h_){var h$;h$=cR.choice([cR.op_BarGreaterGreater(cR.op_GreaterGreaterDot(cR.kw("|"),cR.sepBy1(function(ia){return hY(ia[0],ia[1]);},cR.kw("|"))),function(ia){return{$:3,$0:"|",$1:new bY({$:1,$0:h_,$1:ia})};}),cR.preturn(h_)]);return function(ia){return h$([ia[0],ia[1]]);};}):cR.op_BarGreaterGreater(cR.op_DotGreaterGreaterDot(f4.pname(),cR.paren(cR.sepBy(function(h_){return hY(h_[0],h_[1]);},cR.kw(",")))),function(h_){return{$:3,$0:h_[0],$1:h_[1]};});})]),function(h2){return hS([h2[0],h2[1]]);}),function(h2){var h3;return cR.op_GreaterGreaterEquals(cR.plookAheadWith((h3=cR.choice([cR.op_GreaterGreaterDot(cR.kw("::"),cR.preturn(false)),cR.op_GreaterGreaterDot(cR.kw(":"),cR.preturn(true)),cR.preturn(false)]),function(h4){return h3([h4[0],h4[1]]);})),function(h4){function h5(h6,h7){return f4.doPTerm(hI,hJ,hK,true,hM,hN,h6,h7);}return h4?cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(cR.kw(":"),cR.sepBy(function(h6){return h5(h6[0],h6[1]);},cR.kw(":"))),function(h6){return cR.preturn({$:7,$0:bX.map(function(h7){return[1,h7];},new bY({$:1,$0:h2,$1:h6}))});}):cR.preturn(h2);});}))([hO,hP]);};f4.pliteral=function(hI,hJ,hK,hL){var hM,hN;hM=cR.choice([cR.op_BarGreaterGreater(cR.op_GreaterGreaterDot(cR.kw("not"),(hN=cR.choice([cR.paren((f4.patom(hI,hJ,hK))(hL)),(f4.patom(hI,hJ,hK))(hL)]),function(hO){return hN([hO[0],hO[1]]);})),function(hO){return new ch({$:1,$0:hO});}),cR.op_BarGreaterGreater((f4.patom(hI,hJ,hK))(hL),function(hO){return new ch({$:0,$0:hO});})]);return function(hO){return hM([hO[0],hO[1]]);};};f4.pnil=function(hI,hJ){return(cR.op_GreaterGreaterDot(cR.kw("nil"),cR.preturn(b_.Nihil)))([hI,hJ]);};f4.ppattern=function(hI,hJ){var hK,hL;hK=cR.op_DotGreaterGreaterDot(hI,f4.plocation(hJ));hL=cR.choice([function(hM){return f4.pnil(hM[0],hM[1]);},cR.op_GreaterGreaterEquals(cR.op_GreaterGreaterDot(cR.kw("<"),cR.many1(hK)),function(hM){var hN;hN=cR.choice([cR.op_GreaterGreaterDot(cR.kw(">"),cR.preturn(new b_({$:2,$0:hM}))),cR.preturn(new b_({$:4,$0:hM}))]);return function(hO){return hN([hO[0],hO[1]]);};}),cR.op_GreaterGreaterEquals(cR.many1(cR.op_DotGreaterGreaterDot(hI,f4.plocation(hJ))),function(hM){var hN,hO;hN=cR.choice([cR.op_GreaterGreaterDot(cR.kw(">"),(hO=cR.choice([cR.op_BarGreaterGreater(cR.op_GreaterGreaterDot(cR.op_GreaterGreaterDot(cR.kw("|"),cR.kw("<")),cR.many(cR.op_DotGreaterGreaterDot(hI,f4.plocation(hJ)))),function(hP){return new b_({$:0,$0:hM,$1:hP});}),cR.preturn(new b_({$:3,$0:hM}))]),function(hP){return hO([hP[0],hP[1]]);})),cR.preturn(new b_({$:1,$0:hM}))]);return function(hP){return hN([hP[0],hP[1]]);};})]);return function(hM){return hL([hM[0],hM[1]]);};};f4.patom=function(hI,hJ,hK){return function(hL){return function(hM){return f4.ppredicate(hI,hJ,hK,hL,hM[0],hM[1]);};};};f4.plocation=function(hI){var hJ;function hK(hM){return hM==="_"?[-1,"_"]:hI(hM);}function hL(hM){return{$:1,$0:hM};}hJ=cR.choice([cR.op_BarGreaterGreater(cR.op_GreaterGreaterDot(cR.kw("@"),f4.pname()),function(hM){return hL(hK(hM));}),cR.preturn({$:1,$0:[-1,"_"]})]);return function(hM){return hJ([hM[0],hM[1]]);};};f4.ppredicate=function(hI,hJ,hK,hL,hM,hN){return(cR.op_GreaterGreaterEquals(function(hO){return f4.pterm(hJ,hI,hK,hL,hO[0],hO[1]);},function(hO){var hP;hP=cR.choice([cR.op_BarGreaterGreater(cR.op_GreaterGreaterDot(cR.kw("is"),function(hQ){return f4.pterm(hJ,hI,hK,hL,hQ[0],hQ[1]);}),function(hQ){return new cg({$:0,$0:"is",$1:bX.ofArray([hO,hQ])});}),cR.op_BarGreaterGreater(cR.op_GreaterGreaterDot(cR.kw(">="),function(hQ){return f4.pterm(hJ,hI,hK,hL,hQ[0],hQ[1]);}),function(hQ){return new cg({$:0,$0:">=",$1:bX.ofArray([hO,hQ])});}),cR.op_BarGreaterGreater(cR.op_GreaterGreaterDot(cR.kw("<="),function(hQ){return f4.pterm(hJ,hI,hK,hL,hQ[0],hQ[1]);}),function(hQ){return new cg({$:0,$0:"<=",$1:bX.ofArray([hO,hQ])});}),cR.op_BarGreaterGreater(cR.op_GreaterGreaterDot(cR.kw("<"),function(hQ){return f4.pterm(hJ,hI,hK,hL,hQ[0],hQ[1]);}),function(hQ){return new cg({$:0,$0:"<",$1:bX.ofArray([hO,hQ])});}),cR.op_BarGreaterGreater(cR.op_GreaterGreaterDot(cR.kw(">"),function(hQ){return f4.pterm(hJ,hI,hK,hL,hQ[0],hQ[1]);}),function(hQ){return new cg({$:0,$0:">",$1:bX.ofArray([hO,hQ])});}),cR.op_BarGreaterGreater(cR.op_GreaterGreaterDot(cR.kw("="),function(hQ){return f4.pterm(hJ,hI,hK,hL,hQ[0],hQ[1]);}),function(hQ){var hR,hS,hT;switch(hO.$==3?hO.$0==="_ctx"?hO.$1.$==1?hO.$1.$0.$==0?hO.$1.$1.$==1?hO.$1.$1.$0.$==4?hO.$1.$1.$1.$==0?(hR=[hO.$1.$0.$1,hO.$1.$1.$0.$0,hO.$1.$0.$0],0):3:hO.$1.$1.$0.$==0?hO.$1.$1.$1.$==0?(hR=[hO.$1.$0.$1,hO.$1.$1.$0.$1,hO.$1.$0.$0,hO.$1.$1.$0.$0],1):3:3:3:3:3:hO.$0==="|"?2:3:3){case 0:return new cg({$:0,$0:"is",$1:bX.ofArray([hQ,{$:0,$0:hR[2],$1:hR[0]},{$:4,$0:hR[1]}])});case 1:return new cg({$:0,$0:"is",$1:bX.ofArray([hQ,{$:0,$0:hR[2],$1:hR[0]},{$:0,$0:hR[3],$1:hR[1]}])});case 2:return new cg({$:0,$0:"is",$1:bX.ofArray([hQ,hO])});case 3:switch(hQ.$==3?hQ.$0==="_ctx"?hQ.$1.$==1?hQ.$1.$0.$==0?hQ.$1.$1.$==1?hQ.$1.$1.$0.$==4?hQ.$1.$1.$1.$==0?(hT=[hQ.$1.$0.$1,hQ.$1.$1.$0.$0,hQ.$1.$0.$0],0):3:hQ.$1.$1.$0.$==0?hQ.$1.$1.$1.$==0?(hT=[hQ.$1.$0.$1,hQ.$1.$1.$0.$1,hQ.$1.$0.$0,hQ.$1.$1.$0.$0],1):3:3:3:3:3:hQ.$0==="|"?2:3:3){case 0:hS=new cg({$:0,$0:"is",$1:bX.ofArray([hO,{$:0,$0:hT[2],$1:hT[0]},{$:4,$0:hT[1]}])});break;case 1:hS=new cg({$:0,$0:"is",$1:bX.ofArray([hO,{$:0,$0:hT[2],$1:hT[0]},{$:0,$0:hT[3],$1:hT[1]}])});break;case 2:hS=new cg({$:0,$0:"is",$1:bX.ofArray([hO,hQ])});break;case 3:hS=new cg({$:0,$0:"=",$1:bX.ofArray([hO,hQ])});break;}return hS;}}),hO.$==3?cR.preturn(new cg({$:0,$0:hO.$0,$1:hO.$1})):cR.failParser((function(hQ){return function(hR){return hQ("Unexpected predicate "+cA.toSafe(hR));};}(a.id))(ca.ToStringWith(hI,hO)))]);return function(hQ){return hP([hQ[0],hQ[1]]);};}))([hM,hN]);};f5.All={$:0};f6.parse=function(hI,hJ){var hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0,h1,h2,h3,h4,h5,h6,h7,h8,h9,h_,h$,ia,ib,ic,id,ie,_if,ig,ih,ii,ij,ik,il,im,_in,io,ip,iq,ir,is,it,iu;function iv(iL){return co.fold(function(iM,iN){var iO;iO=iN[0];if(iM.ContainsKey(iO))throw new dT.New((function(iP){return function(iQ){return iP("Failed trying to parse duplicate rate expression "+cA.toSafe(iQ));};}(a.id))(iO));else return iM.Add(iO,iN[1]);},new cj.New([]),iL);}function iw(iL){return{$:4,$0:iL};}function ix(iL){return{$:3,$0:iL};}function iy(iL){return{$:1,$0:iL};}function iz(iL){return{$:0,$0:iL};}function iA(iL){return{$:2,$0:iL};}function iB(iL){return{$:6,$0:iL};}function iC(iL){return{$:8,$0:iL};}function iD(iL){return{$:9,$0:iL};}function iE(iL){return{$:5,$0:iL};}function iF(iL){return{$:10,$0:iL};}function iG(iL){return{$:7,$0:iL};}function iH(iL){return{$:11,$0:iL};}function iI(iL){return{$:13,$0:iL};}function iJ(iL){return{$:14,$0:iL};}function iK(iL){return{$:12,$0:iL};}hK=(hL=cR.list_of((hM=(hN=cR.skw("="),function(iL){return gz.op_GreaterGreaterDot(hN,hI,iL[0],iL[1]);}),function(iL){return gz.op_DotGreaterGreaterDot(cR.name(),hM,iL[0],iL[1]);})),(hO=function(iL){return cR.preturn(iv(iL));},function(iL){return gz.op_GreaterGreaterEquals(hL,hO,iL[0],iL[1]);}));hP=cR.choice([(hQ=(hR=cR.kw("deterministic"),(hS=w.get_parse(),function(iL){return gz.op_GreaterGreaterDot(hR,hS,iL[0],iL[1]);})),function(iL){return gz.op_BarGreaterGreater(hQ,iw,iL[0],iL[1]);}),(hT=(hU=cR.kw("stochastic"),(hV=v.get_parse(),function(iL){return gz.op_GreaterGreaterDot(hU,hV,iL[0],iL[1]);})),function(iL){return gz.op_BarGreaterGreater(hT,ix,iL[0],iL[1]);}),(hW=(hX=cR.kw("simulations"),(hY=cR.list_of(bx.parse_named(hJ)),function(iL){return gz.op_GreaterGreaterDot(hX,hY,iL[0],iL[1]);})),function(iL){return gz.op_BarGreaterGreater(hW,iy,iL[0],iL[1]);}),(hZ=(h0=cR.kw("simulation"),(h1=bx.parse(hJ),function(iL){return gz.op_GreaterGreaterDot(h0,h1,iL[0],iL[1]);})),function(iL){return gz.op_BarGreaterGreater(hZ,iz,iL[0],iL[1]);}),(h2=(h3=cR.kw("simulator"),(h4=U.get_parse(),function(iL){return gz.op_GreaterGreaterDot(h3,h4,iL[0],iL[1]);})),function(iL){return gz.op_BarGreaterGreater(h2,iA,iL[0],iL[1]);}),(h5=(h6=cR.kw("parameters"),(h7=cR.list_of(F.get_parse()),function(iL){return gz.op_GreaterGreaterDot(h6,h7,iL[0],iL[1]);})),function(iL){return gz.op_BarGreaterGreater(h5,iB,iL[0],iL[1]);}),(h8=(h9=cR.kw("sweeps"),(h_=cR.list_of(W.get_parse()),function(iL){return gz.op_GreaterGreaterDot(h9,h_,iL[0],iL[1]);})),function(iL){return gz.op_BarGreaterGreater(h8,iC,iL[0],iL[1]);}),(h$=(ia=cR.kw("data"),(ib=cR.list_of(cR.name()),function(iL){return gz.op_GreaterGreaterDot(ia,ib,iL[0],iL[1]);})),function(iL){return gz.op_BarGreaterGreater(h$,iD,iL[0],iL[1]);}),(ic=(id=cR.kw("inference"),(ie=J.get_parse(),function(iL){return gz.op_GreaterGreaterDot(id,ie,iL[0],iL[1]);})),function(iL){return gz.op_BarGreaterGreater(ic,iE,iL[0],iL[1]);}),(_if=(ig=cR.kw("spatial"),(ih=(G.get_parse())(hJ),function(iL){return gz.op_GreaterGreaterDot(ig,ih,iL[0],iL[1]);})),function(iL){return gz.op_BarGreaterGreater(_if,iF,iL[0],iL[1]);}),(ii=(ij=cR.kw("rates"),function(iL){return gz.op_GreaterGreaterDot(ij,hK,iL[0],iL[1]);}),function(iL){return gz.op_BarGreaterGreater(ii,iG,iL[0],iL[1]);}),(ik=(il=cR.kw("plot_settings"),(im=X.parse(hJ),function(iL){return gz.op_GreaterGreaterDot(il,im,iL[0],iL[1]);})),function(iL){return gz.op_BarGreaterGreater(ik,iH,iL[0],iL[1]);}),(_in=(io=cR.kw("moments"),function(iL){return gz.op_GreaterGreaterDot(io,K.parse(),iL[0],iL[1]);}),function(iL){return gz.op_BarGreaterGreater(_in,iI,iL[0],iL[1]);}),(ip=(iq=cR.kw("synthesis"),(ir=M.get_parse(),function(iL){return gz.op_GreaterGreaterDot(iq,ir,iL[0],iL[1]);})),function(iL){return gz.op_BarGreaterGreater(ip,iJ,iL[0],iL[1]);}),(is=(it=cR.kw("units"),(iu=T.get_parse(),function(iL){return gz.op_GreaterGreaterDot(it,iu,iL[0],iL[1]);})),function(iL){return gz.op_BarGreaterGreater(is,iK,iL[0],iL[1]);})]);return function(iL){return hP([iL[0],iL[1]]);};};f6.parse_list=function(hI,hJ){var hK,hL;return cR.sepBy((hK=cR.kw("directive"),(hL=f6.parse(hI,hJ),function(hM){return gz.op_GreaterGreaterDot(hK,hL,hM[0],hM[1]);})),cR.spaces());};f7.Minus={$:1};f7.Mul={$:2};f7.Div={$:3};f7.Power={$:4};f7.Max={$:5};f7.Modulo={$:6};f7.Plus={$:0};f8=fc.DSDException=hB.Class({},dc,f8);f8.New=hB.Ctor(function(hI,hJ){dc.New.call(this,fc.makeMessage(hI,hJ),hI!=null&&hI.$==1?[dd.New(hI.$0[0][0],hI.$0[0][1],fc.string_of_errorKind(hJ))]:[]);this.r=hI;},f8);f9.$cctor=function(){f9.$cctor=a.ignore;f9.emprange=null;};f_.New=function(hI,hJ){return{tags:hI,pos:hJ};};f$.New=function(hI,hJ,hK){return{name:hI,complemented:hJ,toehold:hK};};ga.New=function(hI,hJ){return{domain:hI,doc:hJ};};gb=ee.svg_domain=hB.Class({get_text:function(){return this.$==1?"X":this.$==2?"O":cS.Replace(hH(this.$0),"^","");},get_compl:function(){var hI;return this.$==0?(hI=this.$0,new gb({$:0,$0:gd.New(hI.name,!hI.isComplementary,hI.isToehold,hI.tag)})):this;}},null,gb);gb.Hole=new gb({$:2});gc.New=function(hI,hJ,hK,hL,hM,hN){return{center:hI,angle:hJ,radius:hK,ports:hL,children:hM,edges:hN};};gd=b5.DomainC=hB.Class({toString:function(){return this.name+(this.isToehold?"^":"")+(this.isComplementary?"*":"");}},null,gd);gd.New=function(hI,hJ,hK,hL){return new gd({name:hI,isComplementary:hJ,isToehold:hK,tag:hL});};ge.New=function(hI,hJ){return{strand:hI,site:hJ};};gf=cM.DSegment=hB.Class({toString:function(){var hI,hJ,hK,hL,hM,hN;return cS.Join(";",ck.ofSeq(bX.choose(a.id,bX.ofArray([{$:1,$0:"ds:"+hH(this.double_strand)},(hI=this.hairpin_left,hI!=null&&hI.$==1?{$:1,$0:"hl:"+hH(hI.$0)}:null),(hJ=this.top_left,hJ!=null&&hJ.$==1?{$:1,$0:"tl:"+hH(hJ.$0)}:null),(hK=this.bottom_left,hK!=null&&hK.$==1?{$:1,$0:"bl:"+hH(hK.$0)}:null),(hL=this.top_right,hL!=null&&hL.$==1?{$:1,$0:"tr:"+hH(hL.$0)}:null),(hM=this.bottom_right,hM!=null&&hM.$==1?{$:1,$0:"br:"+hH(hM.$0)}:null),(hN=this.hairpin_right,hN!=null&&hN.$==1?{$:1,$0:"hr:"+hH(hN.$0)}:null)]))))+cM.conn_to_string(this.connection);}},null,gf);gf.New=function(hI,hJ,hK,hL,hM,hN,hO,hP){return new gf({top_left:hI,top_right:hJ,bottom_left:hK,bottom_right:hL,double_strand:hM,hairpin_left:hN,hairpin_right:hO,connection:hP});};gg=cM.DGate=hB.Class({toString:function(){return cM.conn_to_string(this.left_connection)+cS.Join("",[hH(this.segments)]);}},null,gg);gg.New=function(hI,hJ){return new gg({left_connection:hI,segments:hJ});};gh.DoubleLink={$:2};gh.BottomLink={$:1};gh.TopLink={$:0};gi.New=function(hI,hJ){return{gate:hI,children:hJ};};gj=cM.LSite=hB.Class({toString:function(){return this.$==0?hH(this.$0)+"."+hH(this.$1):this.$==1?hH(this.$0):hH(this.$0)+"/"+hH(this.$1);}},null,gj);gk.New=function(hI,hJ){return{gate:hI,child:hJ};};gl=cM.DStrand=hB.Class({toString:function(){var hI,hJ,hK,hL,hM;hI="";hJ=this.domains;while(true){if(hJ.$==1){hL=hJ.$1;hM=hJ.$0;hI=hI+" "+(hK=hM,hH(hK));hJ=hL;}else return hI;}}},null,gl);gl.New=function(hI,hJ){return new gl({kind:hI,domains:hJ});};gm.DoubleStrand={$:2};gm.BottomStrand={$:1};gm.TopStrand={$:0};gm.RightHairpinStrand={$:4};gm.LeftHairpinStrand={$:3};gn.New=function(hI,hJ){return{leading:hI,edges:hJ};};go.New=function(hI,hJ,hK,hL,hM){return{rx:hI,ry:hJ,large_flag:hK,sweep_flag:hL,angle:hM};};gp.Float2Int={$:0};gp.Int2Float={$:1};gp.Sqrt={$:2};gq.JIT={$:0};gq.SSA={$:1};gr.Periodic={$:0};gr.ZeroFlux={$:1};gs.ParFixed={$:0};gs.ParRandomized={$:1};gs.ParInitVal={$:2};gt.ParReal={$:0};gt.ParLog={$:1};gu.KContextual={$:0};gu.KStochastic={$:1};gu.KDeterministic={$:2};gv.$cctor=function(){var hI;gv.$cctor=a.ignore;gv.defaults=L.New(3,1E-16,false,bY.Empty);gv.pmonomial=K.op_BarGreaterGreater(K.op_GreaterGreaterDot(cR.spaces(),cR.angleBrackets(cR.sepBy1(K.op_DotGreaterGreaterDot(K.op_BarGreaterGreater(K.op_DotGreaterGreater(cR.name(),cR.spaces()),bG.create),(hI=cR.choice([K.op_BarGreaterGreater(K.op_DotGreaterGreater(K.op_GreaterGreaterDot(cR.kw("^"),cR.pint32()),cR.spaces()),be.toInt),cR.preturn(1)]),function(hJ){return hI([hJ[0],hJ[1]]);})),cR.kw("*")))),K.canonicalMonomial);gv.pplot=br.parse(K.pmonomial());gv.parse=K.parse_defaults(K.defaults());};gw.toeholds=function(){g5.$cctor();return g5.toeholds;};gw.specificities=function(){g5.$cctor();return g5.specificities;};gx.Leaks={$:1};gx.PinLeaks={$:2};gx.Polymers={$:3};gx.Unproductive={$:4};gx.SequenceRates={$:5};gx.DeclareDomains={$:6};gy.New=function(hI,hJ,hK,hL){return{n:hI,index:hJ,lowlink:hK,onStack:hL};};gz.op_GreaterGreaterEquals=function(hI,hJ,hK,hL){return(cR.op_GreaterGreaterEquals(hI,hJ))([hK,hL]);};gz.op_BarGreaterGreater=function(hI,hJ,hK,hL){return(cR.op_BarGreaterGreater(hI,hJ))([hK,hL]);};gz.op_GreaterGreaterDot=function(hI,hJ,hK,hL){return(cR.op_GreaterGreaterDot(hI,hJ))([hK,hL]);};gz.op_DotGreaterGreaterDot=function(hI,hJ,hK,hL){return(cR.op_DotGreaterGreaterDot(hI,hJ))([hK,hL]);};gz.op_DotGreaterGreater=function(hI,hJ,hK,hL){return(cR.op_DotGreaterGreater(hI,hJ))([hK,hL]);};gz.op_PlusGreaterGreaterPlus=function(hI,hJ,hK,hL){return(cR.op_PlusGreaterGreaterPlus(hI,hJ))([hK,hL]);};gz.op_PlusGreaterGreater=function(hI,hJ,hK,hL){return(cR.op_PlusGreaterGreater(hI,hJ))([hK,hL]);};gz.op_LessBarGreater=function(hI,hJ,hK,hL){return(cR.op_LessBarGreater(hI,hJ))([hK,hL]);};gz.op_GreaterGreaterPercent=function(hI,hJ,hK,hL){return(cR.op_GreaterGreaterPercent(hI,hJ))([hK,hL]);};gA.New=function(hI,hJ,hK){return{id:hI,name:hJ,listOfUnits:hK};};gB.New=function(hI,hJ,hK,hL,hM,hN,hO,hP){return{id:hI,name:hJ,compartmentType:hK,spatialDimensions:hL,size:hM,units:hN,outside:hO,constant:hP};};gC.New=function(hI,hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS){return{id:hI,name:hJ,speciesType:hK,compartment:hL,initialAmount:hM,initialConcentration:hN,substanceUnits:hO,hasOnlySubstanceUnits:hP,boundaryCondition:hQ,charge:hR,constant:hS};};gD.New=function(hI,hJ,hK,hL,hM){return{id:hI,name:hJ,value:hK,units:hL,constant:hM};};gE.New=function(hI,hJ){return{symbol:hI,math:hJ};};gF.New=function(hI,hJ,hK,hL,hM,hN,hO){return{id:hI,name:hJ,reversible:hK,fast:hL,listOfReactants:hM,listOfProducts:hN,kineticLaw:hO};};gG.New=function(hI,hJ,hK,hL,hM){return{kind:hI,exponent:hJ,scale:hK,multiplier:hL,offset:hM};};gH.New=function(hI,hJ,hK,hL){return{id:hI,name:hJ,species:hK,stoichiometry:hL};};gI.New=function(hI,hJ){return{math:hI,listOfParameters:hJ};};gJ.Abs={$:2};gJ.Ceiling={$:32};gJ.Floor={$:5};gK=dy.NamedObject=hB.Class({get_Name:function(){return this.name;},get_Data:function(){return this.data;}},b1,gK);gK.New=hB.Ctor(function(hI,hJ){b1.New.call(this);this.name=hI;this.data=hJ;},gK);gL=dy.BayesTable=hB.Class({get_ColumnNames:function(){return this.columnNames.get_Keys();},get_ColumnCount:function(){return ck.length(this.data);},GetColumn:function(hI){return ck.get(this.data,this.columnNames.Item(hI));}},b1,gL);gL.New=hB.Ctor(function(hI,hJ){b1.New.call(this);this.data=hI;this.columnNames=hJ;},gL);gM.Empty={$:3};gN.New=function(hI,hJ,hK){return{R:hI,G:hJ,B:hK};};gP.New=function(hI,hJ,hK,hL,hM,hN,hO){return{Name:hI,BarCenters:hJ,BarHeights:hK,BarWidth:hL,FillColour:hM,BorderColour:hN,Shadow:hO};};gQ=bb.FormatException=hB.Class({},db,gQ);gR=bb.OverflowException=hB.Class({},db,gR);gS.$cctor=function(){gS.$cctor=a.ignore;gS.kwList=bX.ofArray(["module","system","inference","directive","with"]);};gT.ClosePath={$:3};gU.$cctor=function(){var hI,hJ,hK,hL,hM,hN,hO;gU.$cctor=a.ignore;function hP(ih,ii){return gz.op_DotGreaterGreater(cR.pfloat(),cR.spaces(),ih,ii);}function hQ(ih,ii){return _4.New(ih,ii.outer,ii.width);}function hR(ih,ii){return gz.op_DotGreaterGreater(cR.pfloat(),cR.spaces(),ih,ii);}function hS(ih,ii){return _4.New(ii.inner,ih,ii.width);}function hT(ih,ii){return gz.op_DotGreaterGreater(cR.pfloat(),cR.spaces(),ih,ii);}function hU(ih,ii){return _4.New(ii.inner,ii.outer,ih);}function hV(ih,ii){return gz.op_DotGreaterGreater(cR.pfloat(),cR.spaces(),ih,ii);}function hW(ih,ii){return _5.New(ih,ii.y,ii.width,ii.value);}function hX(ih,ii){return gz.op_DotGreaterGreater(cR.pfloat(),cR.spaces(),ih,ii);}function hY(ih,ii){return _5.New(ii.x,ih,ii.width,ii.value);}function hZ(ih,ii){return gz.op_DotGreaterGreater(cR.pfloat(),cR.spaces(),ih,ii);}function h0(ih,ii){return _5.New(ii.x,ii.y,ih,ii.value);}function h1(ih,ii){return gz.op_DotGreaterGreater(cR.pfloat(),cR.spaces(),ih,ii);}function h2(ih,ii){return _5.New(ii.x,ii.y,ii.width,ih);}function h3(ih,ii){return gz.op_DotGreaterGreater(cR.pfloat(),cR.spaces(),ih,ii);}function h4(ih,ii){return _6.New(ih,ii.xmax,ii.ymin,ii.ymax,ii.value);}function h5(ih,ii){return gz.op_DotGreaterGreater(cR.pfloat(),cR.spaces(),ih,ii);}function h6(ih,ii){return _6.New(ii.xmin,ih,ii.ymin,ii.ymax,ii.value);}function h7(ih,ii){return gz.op_DotGreaterGreater(cR.pfloat(),cR.spaces(),ih,ii);}function h8(ih,ii){return _6.New(ii.xmin,ii.xmax,ih,ii.ymax,ii.value);}function h9(ih,ii){return gz.op_DotGreaterGreater(cR.pfloat(),cR.spaces(),ih,ii);}function h_(ih,ii){return _6.New(ii.xmin,ii.xmax,ii.ymin,ih,ii.value);}function h$(ih,ii){return gz.op_DotGreaterGreater(cR.pfloat(),cR.spaces(),ih,ii);}function ia(ih,ii){return _6.New(ii.xmin,ii.xmax,ii.ymin,ii.ymax,ih);}function ib(ih,ii){return gz.op_DotGreaterGreater(cR.pfloat(),cR.spaces(),ih,ii);}function ic(ih,ii){return _7.New(ih,ii.core,ii.points,ii.rectangles);}function id(ih,ii){return gz.op_DotGreaterGreater(hI,cR.spaces(),ih,ii);}function ie(ih,ii){return _7.New(ii.random,{$:1,$0:ih},ii.points,ii.rectangles);}function _if(ih,ii){return _7.New(ii.random,ii.core,ih,ii.rectangles);}function ig(ih,ii){return _7.New(ii.random,ii.core,ii.points,ih);}gU.default_core=_4.New(0,0,0);gU.default_point=_5.New(0,0,0,0);gU.default_rectangle=_6.New(0,1,0,1,0);gU.defaults=_7.New(0,null,bY.Empty,bY.Empty);gU.CONSTANT="constant";gU.INIT="init";gU.SPATIAL="spatial";gU.parser=(hI=cR.record(_3.default_core(),bX.ofArray([["inner",function(ih){return gz.op_BarGreaterGreater(function(ii){return hP(ii[0],ii[1]);},function(ii){return function(ij){return hQ(ii,ij);};},ih[0],ih[1]);}],["outer",function(ih){return gz.op_BarGreaterGreater(function(ii){return hR(ii[0],ii[1]);},function(ii){return function(ij){return hS(ii,ij);};},ih[0],ih[1]);}],["width",function(ih){return gz.op_BarGreaterGreater(function(ii){return hT(ii[0],ii[1]);},function(ii){return function(ij){return hU(ii,ij);};},ih[0],ih[1]);}]])),(hJ=cR.record(_3.default_point(),bX.ofArray([["x",function(ih){return gz.op_BarGreaterGreater(function(ii){return hV(ii[0],ii[1]);},function(ii){return function(ij){return hW(ii,ij);};},ih[0],ih[1]);}],["y",function(ih){return gz.op_BarGreaterGreater(function(ii){return hX(ii[0],ii[1]);},function(ii){return function(ij){return hY(ii,ij);};},ih[0],ih[1]);}],["width",function(ih){return gz.op_BarGreaterGreater(function(ii){return hZ(ii[0],ii[1]);},function(ii){return function(ij){return h0(ii,ij);};},ih[0],ih[1]);}],["value",function(ih){return gz.op_BarGreaterGreater(function(ii){return h1(ii[0],ii[1]);},function(ii){return function(ij){return h2(ii,ij);};},ih[0],ih[1]);}]])),(hK=cR.record(_3.default_rectangle(),bX.ofArray([["xmin",function(ih){return gz.op_BarGreaterGreater(function(ii){return h3(ii[0],ii[1]);},function(ii){return function(ij){return h4(ii,ij);};},ih[0],ih[1]);}],["xmax",function(ih){return gz.op_BarGreaterGreater(function(ii){return h5(ii[0],ii[1]);},function(ii){return function(ij){return h6(ii,ij);};},ih[0],ih[1]);}],["ymin",function(ih){return gz.op_BarGreaterGreater(function(ii){return h7(ii[0],ii[1]);},function(ii){return function(ij){return h8(ii,ij);};},ih[0],ih[1]);}],["ymax",function(ih){return gz.op_BarGreaterGreater(function(ii){return h9(ii[0],ii[1]);},function(ii){return function(ij){return h_(ii,ij);};},ih[0],ih[1]);}],["value",function(ih){return gz.op_BarGreaterGreater(function(ii){return h$(ii[0],ii[1]);},function(ii){return function(ij){return ia(ii,ij);};},ih[0],ih[1]);}]])),cR.record(_3.defaults(),bX.ofArray([["random",function(ih){return gz.op_BarGreaterGreater(function(ii){return ib(ii[0],ii[1]);},function(ii){return function(ij){return ic(ii,ij);};},ih[0],ih[1]);}],["centralcore",function(ih){return gz.op_BarGreaterGreater(function(ii){return id(ii[0],ii[1]);},function(ii){return function(ij){return ie(ii,ij);};},ih[0],ih[1]);}],["points",(hL=(hM=cR.list_of(hJ),function(ih){return gz.op_DotGreaterGreater(hM,cR.spaces(),ih[0],ih[1]);}),function(ih){return gz.op_BarGreaterGreater(hL,function(ii){return function(ij){return _if(ii,ij);};},ih[0],ih[1]);})],["rectangles",(hN=(hO=cR.list_of(hK),function(ih){return gz.op_DotGreaterGreater(hO,cR.spaces(),ih[0],ih[1]);}),function(ih){return gz.op_BarGreaterGreater(hN,function(ii){return function(ij){return ig(ii,ij);};},ih[0],ih[1]);})]])))));};gV.$cctor=function(){var hI,hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU;gV.$cctor=a.ignore;function hV(h2,h3){return{$:0,$0:h2,$1:h3};}function hW(h2,h3){return{$:1,$0:h2,$1:h3};}function hX(h2,h3){return{$:4,$0:h2,$1:h3};}function hY(h2,h3){return{$:5,$0:h2,$1:h3};}function hZ(h2,h3){return{$:6,$0:h2,$1:h3};}function h0(h2,h3){return{$:7,$0:h2,$1:h3};}function h1(h2,h3){return{$:7,$0:h2,$1:h3};}gV.punder=cR.kw("_");gV.parseString=function(h2){return cT.parseWithPos(cR.name(),function(h3){return hV(h3[0],h3[1]);},function(h3,h4){var h5;h5=[h3,h4];return h5;},h2[0],h2[1]);};gV.parseInt=(hI=cR.op_DotGreaterGreater(cR.pint32(),cR.spaces()),function(h2){return cT.parseWithPos(hI,function(h3){return hW(h3[0],h3[1]);},function(h3,h4){var h5;h5=[h3,h4];return h5;},h2[0],h2[1]);});gV.parseBool=(hJ=cR.op_DotGreaterGreater(cR.pbool(),cR.spaces()),function(h2){return cT.parseWithPos(hJ,function(h3){return hX(h3[0],h3[1]);},function(h3,h4){var h5;h5=[h3,h4];return h5;},h2[0],h2[1]);});gV.parseChar=(hK=cR.op_DotGreaterGreater(cR.anyChar(),cR.spaces()),function(h2){return cT.parseWithPos(hK,function(h3){return hY(h3[0],h3[1]);},function(h3,h4){var h5;h5=[h3,h4];return h5;},h2[0],h2[1]);});gV.parseFloat=(hL=cR.op_DotGreaterGreater(cR.pfloat(),cR.spaces()),function(h2){return cT.parseWithPos(hL,function(h3){return hZ(h3[0],h3[1]);},function(h3,h4){var h5;h5=[h3,h4];return h5;},h2[0],h2[1]);});gV.parseName=(hM=cR.op_DotGreaterGreater(cR.name(),cR.spaces()),function(h2){return cT.parseWithPos(hM,function(h3){return h0(h3[0],h3[1]);},function(h3,h4){var h5;h5=[h3,h4];return h5;},h2[0],h2[1]);});gV.parseUScore=(hN=cR.op_DotGreaterGreater(cT.punder(),cR.spaces()),function(h2){return cT.parseWithPos(hN,function(h3){return h1(h3[0],h3[1]);},function(h3,h4){var h5;h5=[h3,h4];return h5;},h2[0],h2[1]);});gV.parseIntToFloat=(hO=gp.Int2Float,function(h2){return cT.parseFun("float_of_int",hO,h2);});gV.parseFloatToInt=(hP=gp.Float2Int,function(h2){return cT.parseFun("int_of_float",hP,h2);});gV.parseAdd=(hQ=f7.Plus,function(h2){return cT.parseOp("+",hQ,h2);});gV.parseSub=(hR=f7.Minus,function(h2){return cT.parseOp("-",hR,h2);});gV.parseMul=(hS=f7.Mul,function(h2){return cT.parseOp("*",hS,h2);});gV.parseDiv=(hT=f7.Div,function(h2){return cT.parseOp("/",hT,h2);});gV.parsePow=(hU=f7.Power,function(h2){return cT.parseOp("**",hU,h2);});gV.parse=function(h2){return(cT.do_parse())(h2);};};gW.BottomT={$:0};gX.New=function(hI,hJ,hK,hL,hM){return{upper_left:hI,lower_left:hJ,middle:hK,upper_right:hL,lower_right:hM};};gY.New=function(hI,hJ,hK,hL){return{loop:hI,middle:hJ,upper_left:hK,lower_left:hL};};gZ.New=function(hI,hJ,hK,hL){return{loop:hI,middle:hJ,upper_right:hK,lower_right:hL};};g0.NoTagC={$:0};g0.AnyTagC={$:1};g1.$cctor=function(){g1.$cctor=a.ignore;g1.pi=3.14159265358979;g1.twopi=2*ee.pi();g1.min_side_length=100;g1.xing_length_per_char=30;g1.pad=12;g1.overhang_to_hole=0.2;};g2.New=function(hI,hJ,hK){return{left_overhang:hI,middle:hJ,right_overhang:hK};};g3.New=function(hI,hJ,hK,hL){return{strand:hI,start_anchor:hJ,end_anchor:hK,east_anchor:hL};};g4.$cctor=function(){g4.$cctor=a.ignore;function hI(hJ){return ep.letterwidth()*hJ;}g4.bend_angle=45;g4.arrow_vector=dW.New(-7,-4);g4.segment_sep_complement=dW.New(0,8);g4.segment_sep_condensed=dW.New(0,18);g4.segment_sep_nucleotides=dW.New(0,34);g4.segment_skip=7;g4.species_skip=10;g4.origami_sep=dW.New(16,16);g4.origami_round=32;g4.letterwidth=8;g4.toehold_pad=3;g4.normal_pad=4;g4.fontsize=15;g4.linewidth=2.5;g4.cross_gap=ep.fontsize()+2;g4.inlabel_gap=2*ep.letterwidth();g4.baseline_height=5;g4.label_sep_complement=8;g4.label_sep_condensed_upper=ep.segment_sep_condensed().y/2+ep.fontsize()/2-ep.linewidth();g4.label_sep_condensed_lower=ep.segment_sep_condensed().y/2+ep.fontsize()/2-ep.linewidth()-1.5;g4.label_sep_nucleotides_lower=14;g4.label_sep_nucleotides_upper=15;g4.len_dom_name=function(hJ){return hI(eg.display_length(hJ));};g4.baseClass="svgdsd";g4.translate_strand_by=function(hJ){function hK(hL){return cB.translate_point_by(hJ,hL);}return function(hL){return ep.transform_strand_by(hK,hL);};};g4.palette=bX.ofArray(["red","green","blue","orange","purple","cyan","brown","magenta","dodgerblue","orchid","lawngreen","lightskyblue","darksalmon","teal","rosybrown","navajowhite","olive","darkseagreen","darkgoldenrod","pink"]);};g5.$cctor=function(){g5.$cctor=a.ignore;g5.toeholds="TATTCC\\r\\nGCTA\\r\\nGTCA\\r\\nTACCAA\\r\\nCATCG\\r\\nACTACAC\\r\\nCTCAG\\r\\nCTCAATC\\r\\nCCTACG\\r\\nTCTCCA\\r\\nCCCT\\r\\nGACA\\r\\nACCT\\r\\nTAGCCA\\r\\nCACACA\\r\\nAGAC";g5.specificities="CCCAAAACAAAACAAAACAA\\r\\nCCCTTTTCTAAACTAAACAA\\r\\nCCCTTTACATTACATAACAA\\r\\nCCCTTATCATATCAATACAA\\r\\nCCCTTAACTTAACAAATCTA\\r\\nCCCTATTCAATTCAAATCAA\\r\\nCCCTATACTATACAATACTA\\r\\nCCCTAATCTAATCATAACTA\\r\\nCCCTAAACTTATCTAAACAT\\r\\nCCCATTTCAAATCAAAACTT\\r\\nCCCATTACTAATCAATTCAA\\r\\nCCCATATCTATACATTACAA\\r\\nCCCATAACTATTCTAAACTA\\r\\nCCCAATTCTTAACATATCAA\\r\\nCCCAATACTATTCATAACAT\\r\\nCCCAAATCTTAACTATACTA\\r\\nCCTATACCTTAACTTAACAA\\r\\nCCATATCCATAACTTTACAA\\r\\nCCATAACCTATACTTATCAA\\r\\nCCATTTCCTTTTCTTAACTA\\r\\nCCATTACCATATCTTATCAT\\r\\nCCAAAACCATAACATAACTT\\r\\nCCAATTCCAAAACTTATCTA\\r\\nCCAATACCATTACTATTCAA\\r\\nCCTTAACCTTTACTTTACTT\\r\\nCCTTTTCCTAATCTTTACAT\\r\\nCCTTTACCAAAACATTTCAA\\r\\nCCTAATCCTTATCATTACTA\\r\\nCCTATTCCTTTACAAATCAT\\r\\nCCAAAACAAAACCTATACAA\\r\\nCCTTTACATAACCTAATCAA\\r\\nCCTTATCTAAACCAATACAT\\r\\nCCTTATCAATACCTATTCTA\\r\\nCCTTAACAAATCCAAAACTA\\r\\nCCTATTCAAATCCTTTTCAA\\r\\nCCTATACAATACCATTACAT\\r\\nCCTAAACTTATCCTATTCAT\\r\\nCCTAAACATTACCTAAACTT\\r\\nCCATTACTTAACCTTTACTA\\r\\nCCATAACAATTCCAATTCAT\\r\\nCCAATTCATAACCAAAACAT\\r\\nCCAATACTAATCCAATACTT\\r\\nCCAAATCTTAACCAATTCTA\\r\\nCCAAATCAATTCCTTAACAT\\r\\nCCATATCAAAACAAAACCAA\\r\\nCCTATACTAAACTAAACCAA\\r\\nCCTAATCTTTACATAACCAA\\r\\nCCTAATCATATCTATACCAA\\r\\nCCTTTTCTTATCAAATCCAA\\r\\nCCTTTTCATTACAATACCTA\\r\\nCCTTAACTATTCAATACCAA\\r\\nCCAATACAAATCATAACCTA\\r\\nCCAATTCTATACAATTCCAA\\r\\nCCAAAACTAAACATTACCAT\\r\\nCCATTACATTACTAATCCAA\\r\\nCCATTTCTATTCTTAACCAA\\r\\nCCATATCTTATCTAAACCTT\\r\\nCCTTTACTTTACAAAACAAC\\r\\nCCATAACTATACTTATCAAC\\r\\nCCATTTCAATTCAAATCAAC\\r\\nCCTATTCTAATCAATACAAC\\r\\nCTTAACCCAAATCTAATCTA\\r\\nCAATACCCATATCATATCTA\\r\\nCAAATCCCAATTCTATTCTT\\r\\nCATTACCCTATTCTTTTCTA\\r\\nCATAACCCTAAACAATTCTT\\r\\nCTTTTCCCAATACTAATCAT\\r\\nCTTATCCCATTTCATTTCTA\\r\\nCTTTACCTATACCAAATCTT\\r\\nCTTATCCTAAACCTTAACTT\\r\\nCTTAACCATATCCATTACTT\\r\\nCTAATCCATTACCATATCTT\\r\\nCATAACCTATTCCTATACTT\\r\\nCAATACCTAATCCTTATCTT\\r\\nCTATACCAAATCTTTACCAA\\r\\nCATAACCAATACTTTTCCAA\\r\\nCATTTCCAAAACTTAACCTA\\r\\nCAAATCCATATCATTTCCAA\\r\\nCAATTCCTAATCTATTCCTA\\r\\nCAATACCATTTCTTATCCTA\\r\\nCTTAACCTTATCATTACCTA\\r\\nCTTTTCCAATTCATATCCAA\\r\\nCTTTACCATAACTTATCCAT\\r\\nCTAAACCTTAACTATTCCAA\\r\\nCAAATCCTTTTCTAAACAAC\\r\\nCTTTTCCTATTCTATTCAAC\\r\\nCTTATCCATTTCATTACAAC\\r\\nCTATACCTTTACTATACATC\\r\\nCTATTCCTTATCTTATCTAC\\r\\nCTAAACCAATTCTAATCTAC\\r\\nCATATCCTATACATATCAAC\\r\\nCAATTCCATAACATAACAAC\\r\\nCTTTACAATACCCTAATCTT\\r\\nCTTAACATAACCCATATCAT\\r\\nCTATACAAATCCCATTTCTT\\r\\nCATAACTAAACCCTTTTCTT\\r\\nCAAAACAAAACCAAATCCTA\\r\\nCTTTTCAATACCTAATCCTA\\r\\nCTTTACTTAACCATATCCTA\\r\\nCTTATCTAATCCAATTCCTA\\r\\nCTATTCATATCCAAAACCTA\\r\\nCTAATCATAACCATTTCCTT\\r\\nCTAAACAATTCCTATACCTA\\r\\nCATATCAAAACCTTAACAAC\\r\\nCTATTCTTAACCTTTACAAC\\r\\nCTATTCAAATCCTTATCATC\\r\\nCTAATCTAAACCATAACTTC\\r\\nCTTAACTATACCTATACAAC\\r\\nCTTATCTTATCCTAAACTAC\\r\\nCTTATCATTACCAAAACATC\\r\\nCAAAACTAATCCTTTACTAC\\r\\nCAAAACATTACCTTTTCAAC\\r\\nCAAATCAATTCCATATCTAC\\r\\nCATTTCTATTCCTAATCAAC\\r\\nCATATCTTTACCATTACTAC\\r\\nCATTTCAAAACAAAACCCAA\\r\\nCTAATCTTAACATAACCCAA\\r\\nCTAATCAATACTATACCCAA\\r\\nCTATACTATACAAATCCCAA\\r\\nCTATACATAACAATACCCAT\\r\\nCTATTCTAAACTAAACCCTT\\r\\nCTTAACAAATCATTACCCAA\\r\\nCTTTTCTTATCAATTCCCAA\\r\\nCTTTTCATTACTAATCCCAT\\r\\nCAATACATATCATATCCCAA\\r\\nCAATTCATAACTTTACCCTA\\r\\nCAATTCAATTCTTAACCCAT\\r\\nCATATCTATACATTTCCCAA\\r\\nCATTACTAAACTTATCCCTA\\r\\nCAAAACTTTTCAAAACCAAC\\r\\nCTTTACATTTCTATACCAAC\\r\\nCTTAACTTATCTAATCCATC\\r\\nCTATACTTATCATAACCTTC\\r\\nCTAAACTATTCTTTACCATC\\r\\nCATTTCTTTTCTAAACCTTC\\r\\nCATTACAATTCAAATCCTAC\\r\\nCATTACTTTACATTACCTAC\\r\\nCATATCATTTCTTATCCAAC\\r\\nCAATTCTTTACAATTCCATC\\r\\nCATTACATTACAAAACAACC\\r\\nCTAAACTTTACTAAACATCC\\r\\nCTAAACATTTCATATCAACC\\r\\nCTTTTCTATACTTAACAACC\\r\\nCTTTACTAATCAATACAACC\\r\\nCAATACAAAACTTAACTACC\\r\\nCATAACTTAACTATACTACC\\r\\nCATAACAATACTTTTCAACC\\r\\nCATAACATATCTTAACATCC\\r\\nATTTCCCATATCTTTTCCTA\\r\\nTTATCCCATTACTTTACCTT\\r\\nAAATCCCTAAACAATTCAAC\\r\\nTTTACCCAAAACATTTCAAC\\r\\nTTTTCCCTTAACAAATCTAC\\r\\nTATACCCTATACTATTCTAC\\r\\nTATTCCCAATACAAATCATC\\r\\nTAAACCCAAATCAATTCTTC\\r\\nATAACCCTATTCATTTCTAC\\r\\nAATTCCATTTCCTTTTCTAC\\r\\nTTATCCTTTTCCATTTCTTC\\r\\nTTATCCATATCCTTAACTAC\\r\\nTTTTCCATAACCTATTCTTC\\r\\nTATACCTTTACCTTATCTTC\\r\\nATATCCAATACCAATTCTAC\\r\\nAATTCCTATTCCAATACTTC\\r\\nAAAACCAAATCTTTTCCCTA\\r\\nTTTTCCAATTCTATTCCCTA\\r\\nTTATCCTATACTATTCCAAC\\r\\nAATTCCTTAACTTTTCCAAC\\r\\nATAACCTATTCATTTCCTAC\\r\\nTAATCCTAAACATATCCTAC\\r\\nTTAACCAAAACATTACAACC\\r\\nAATACCATAACATTTCATCC\\r\\nAATACCAATTCATTACTACC\\r\\nAAAACCTAATCTTTACATCC\\r\\nATAACCTTAACAAATCAACC\\r\\nATAACCATTACTTTACTTCC\\r\\nTAAACCATATCTATTCAACC\\r\\nTTTACCAATACATATCTTCC\\r\\nTTATCCAAATCAAATCTACC\\r\\nAAAACAAATCCCTATACTAC\\r\\nTTTACTAATCCCAAAACTAC\\r\\nTTAACATATCCCAATACATC\\r\\nTTAACAATTCCCTAATCTTC\\r\\nTATACAAAACCCTAAACATC\\r\\nAAATCATAACCCTATTCATC\\r\\nAAAACTATTCCCATTACATC\\r\\nAAAACTAAACCCAAATCTTC\\r\\nATTTCAAAACCTTAACCAAC\\r\\nTAATCTAAACCATTACCAAC\\r\\nTAATCAATACCTAAACCATC\\r\\nTATTCAAATCCTATACCTAC\\r\\nTTTACATAACCTTTACCTTC\\r\\nTTTACAATACCAAATCCAAC\\r\\nTTTTCTTTACCATAACCATC\\r\\nTTTTCTAATCCTTATCCTTC\\r\\nAATTCTTAACCAAAACCTAC\\r\\nAATTCAATTCCATATCCATC\\r\\nATTTCTATACCTATTCCTAC\\r\\nATTTCATATCCAATACCATC\\r\\nAAAACTTAACCTTATCTACC\\r\\nTTTACTTTTCCTTTTCTACC\\r\\nTTATCTTATCCTAAACTACC\\r\\nTTAACATTACCTAATCTTCC\\r\\nAATACATTTCCTTAACTTCC\\r\\nAAATCATTACCAATTCTACC\\r\\nAAATCAAAACAAAACCCAAC\\r\\nTTTTCATAACATATCCCAAC\\r\\nTTAACTAATCAATACCCAAC\\r\\nTTAACAAAACTTAACCCTAC\\r\\nTTATCTATACAAATCCCATC\\r\\nTATACTAAACATAACCCATC\\r\\nTATTCAATACTATACCCTAC\\r\\nTAAACATAACAATTCCCTAC\\r\\nTAATCATATCTAAACCCTTC\\r\\nATAACAATACATTTCCCAAC\\r\\nATATCTTAACATTACCCATC\\r\\nATATCTAATCTAATCCCTAC\\r\\nATTACAATTCAAAACCAACC\\r\\nTAAACTTTTCAAATCCAACC\\r\\nTATTCTATTCATTACCAACC\\r\\nTATACATATCATAACCATCC\\r\\nTATACATTACTAAACCTACC\\r\\nTTATCAATTCTATTCCAACC\\r\\nTTTACTATACTAATCCATCC\\r\\nTTTACAAATCTTTACCTACC\\r\\nAATTCATTTCAATTCCATCC\\r\\nAATACTATTCTTATCCTACC\\r\\nATAACTTTACAATACCATCC\\r\\nTTTTCATTACAAAACAACCC\\r\\nAAATCTTTACATATCAACCC\\r\\nAATTCTAAACAATACAACCC\\r\\nAATTCTTTTCTAAACTACCC\\r\\nATAACATTTCATAACATCCC\\r\\nATTACTTAACAAATCTACCC\\r\\nTAATCATTTCTATACATCCC\\r\\nTATTCTTATCAAATCATCCC\\r\\nTTATCAAATCAAAACTTCCC\\r\\nCATTACCTTTTCAAAACACA\\r\\nCAAAACCATTACATTACACA\\r\\nCAATACTATTCAATACCTCA\\r\\nCAAATCATATCAAAACACCA\\r\\nCTTATCAAATCTATACACCT\\r\\nCATTTCATTTCAATTCACCT\\r\\nCAATTCTAATCATTTCACCA\\r\\nCAAATCTATTCTAATCTCCA\\r\\nCAATACTTTTCTTTTCACAC\\r\\nAAAACCCTAATCATATCACA\\r\\nATTACCTTATCCATAACACA\\r\\nTTTACCTTTTCATAACACCA\\r\\nATATCCTTATCTTATCACCA\\r\\nATTTCCATTACATAACTCCT\\r\\nTATTCCTTTACTTATCTCCA\\r\\nAAATCCAAAACTATTCACAC\\r\\nAATACTTTACCCAATTCACA\\r\\nTTAACTATACCCATTTCACT\\r\\nTAAACTTATCCATTTCCACA\\r\\nATATCTTTTCCAATTCCTCA\\r\\nAAATCTATTCCATTACACCA\\r\\nTTTACTTATCTTTTCCCTCA\\r\\nCCTTATCCATTACAAACAAA\\r\\nCCAAATCCTATTCAATCAAA\\r\\nCCTAAACCTTTTCATACTAA\\r\\nCTAATCCCTTATCTTACAAA\\r\\nCATTACCAAAACCATACAAA\\r\\nCATTTCCTTTACCTTACTAA\\r\\nCAAAACCTAAACTTACCAAA\\r\\nCAAATCTTTTCCCATTCAAA\\r\\nAAAACCCATTTCCTAACAAA\\r\\nTTTACCCTTTTCCAAACTAA\\r\\nTAATCCCTTATCCAAACATA\\r\\nATATCCTAATCCCTTTCAAA\\r\\nATTACCTATACCCTTACATA\\r\\nTTTACCTAAACCTAACCAAA\\r\\nTTATCCCTTTACACAAAACA\\r\\nTATACCATTTCACCAAAACA\\r\\nCTATTCCCAAACAATACTAA\\r\\nCATATCCCTAACTATACTTA\\r\\nCAATTCCCTATCAAAACTTT\\r\\nCTATACCCTTTCATAACTAA\\r\\nCTATTCCAATCTAAACAAAC\\r\\nCATATCCAAACTAATCTAAC\\r\\nTAAACCCTTACAATACTAAC\\r\\nTATTCCCTAACAATTCAATC\\r\\nTAAACCAATCCCATATCATA\\r\\nAAAACCTTTCCTAATCCTAA\\r\\nTTAACCATACCTTTTCCTAA\\r\\nAAATCCTATCCATAACAAAC\\r\\nTTTTCCTTTCCAAAACATAC\\r\\nTTTTCCTAACCATTTCAAAC\\r\\nAAATCCATACTTTACCCAAA\\r\\nTATACCAAACTATTCCCAAA\\r\\nTAAACCTTACTTATCCCATA\\r\\nTAATCCTTTCTTAACCAAAC\\r\\nAATTCCAATCATATCCAAAC\\r\\nTATACCTATCTATACCAATC\\r\\nTAATCCATTCATTTCCTTAC\\r\\nTTAACCTAACTAAACAAACC\\r\\nATTTCCTTACTATTCAAACC\\r\\nATTTCCTATCTTAACATACC\\r\\nTAAACCTATCATTACATACC\\r\\nTAAACAATCCCTTTACAAAC\\r\\nATTACTTTCCCTATACAAAC\\r\\nATTACAAACCCTTTTCATAC\\r\\nATATCATTCCCTTATCAAAC\\r\\nATAACTATCCCATAACTAAC\\r\\nAAAACATACCCAATACATAC\\r\\nTAATCTATCCCTAATCATAC\\r\\nTAAACTAACCCTATTCTATC\\r\\nTAAACATTCCCATATCTATC\\r\\nTTTTCTTACCTTTACCAAAC\\r\\nAAATCTAACCTTTTCCTAAC\\r\\nAATACATACCATTACCTAAC\\r\\nATATCATACCTATACCTTAC\\r\\nATTTCAATCCTTAACCTAAC\\r\\nTATTCTTTCCTATTCCTATC\\r\\nTTAACTTACCATTTCCATTC\\r\\nTTTTCAAACCTTATCCATTC\\r\\nATTACTATCCTTTACAAACC\\r\\nTATACAATCCATTTCATACC\\r\\nTTAACTTTCCTTATCATACC\\r\\nTTTTCTATCCAATACATTCC\\r\\nTTTACATTCCTATACTATCC\\r\\nAATACTAACCTAAACATTCC\\r\\nATTTCTAACCATAACTATCC\\r\\nTAAACAAACAAAACCCAAAC\\r\\nATTACTAACTAATCCCAAAC\\r\\nATTACATACATAACCCTAAC\\r\\nATATCAATCAATACCCATAC\\r\\nATATCAAACTAAACCCTATC\\r\\nATAACTAACATTACCCAATC\\r\\nAATTCAAACATATCCCATAC\\r\\nAAAACTTTCAAATCCCTAAC\\r\\nTATTCATACAATTCCCAATC\\r\\nTAAACTATCTTAACCCTTAC\\r\\nAATTCTATCAAAACCAAACC\\r\\nTTATCTTTCTAATCCAAACC\\r\\nTTATCTAACAATACCATACC\\r\\nTAATCTTTCATTACCTAACC\\r\\nTATACTTACAAATCCAATCC\\r\\nTATACTATCTATACCTATCC\\r\\nTATTCATTCTAAACCTTACC\\r\\nTATTCTAACTTATCCTAACC\\r\\nATTTCATTCAATTCCATACC\\r\\nATTTCTTTCTTTACCAATCC\\r\\nATAACATACAAAACAAACCC\\r\\nTAATCTTACTAAACATACCC\\r\\nTAATCAAACAATTCAAACCC\\r\\nAATACAAACTTAACTAACCC\\r\\nAAATCAATCTAAACAATCCC\\r\\nATAACAAACTATTCTTACCC\\r\\nTAATCCAATCCTTTACTACA\\r\\nATTTCCAAACCTATACTTCA\\r\\nATTACCATACATAACAACCA\\r\\nAAAACCATTCTAATCAACCA\\r\\nAATACCTAACATTTCAACCT\\r\\nTATTCCATACAATTCTACAC\\r\\nAAATCCTTACATTACTTCAC\\r\\nTTTACCATTCAATACTTCTC\\r\\nATATCTATCTTTTCCCAACA\\r\\nTATACTTTCATAACCTTCCA\\r\\nCAAAACCCTTACAAACAAAA\\r\\nCTTTACCCAAACTAACAAAA\\r\\nCTAAACCCAATCATTCAAAA\\r\\nCATTTCCCATTCAATCAAAA\\r\\nCTAATCCTATCCTATCAAAA\\r\\nAATACCCATACCTTACAAAA\\r\\nTTAACCCAATCCATACAAAA\\r\\nTAATCCCAAACCTTTCTAAA\\r\\nATTACCCTAACCAAACATAA\\r\\nAATTCCCTTTCCAAACTAAA\\r\\nAATTCCCATTCCATTCATAT\\r\\nATTACCCATTCAAACCAAAA\\r\\nTTAACCCTTTCTTACCATAA\\r\\nAAATCCCATACTAACCATAA\\r\\nATATCCCTATCATTCCAAAA\\r\\nATATCCCAATCTTACTTAAC\\r\\nAATACCTTACCCTTACTTAA\\r\\nTATACCCAACCATATCATAA\\r\\nAATACCCTTCCAAATCATTT\\r\\nTTTTCCCAACTTTTCCATAA\\r\\nATAACCCATCAATTCAAAAC\\r\\nTATTCCAACCCAAAACTTAA\\r\\nATATCCATCCCAAATCTTTA\\r\\nTATTCCTACCCATTTCTTTT\\r\\nATAACCAACCAAATCCTAAA\\r\\nTTAACCTTCCTAATCCTTAT\\r\\nATTACCAACCTATTCTTTAC\\r\\nTTTACATCCCAATTCCTAAA\\r\\nAAAACAACCCAATACCTATA\\r\\nAATTCTTCCCAAAACCTAAA\\r\\nATTACTTCCCATATCCTTTA\\r\\nTTTTCATCCCTAAACCAATA\\r\\nTATACAACCCTTAACAAAAC\\r\\nATAACATCCCTTATCTAAAC\\r\\nAAATCAACCCATTACTAAAC\\r\\nAAAACTTCCCTATACAAAAC\\r\\nAATACTACCCTAATCTAATC\\r\\nTTAACTACCCAAATCAAAAC\\r\\nTATTCTACCCTTTTCTATAC\\r\\nTTTACAACCTATACCCAAAA\\r\\nAAAACTACCTATTCCCATAA\\r\\nAAAACATCCTTTACCCTAAA\\r\\nATTACTACCATTTCCCTAAA\\r\\nTTTTCAACCTTATCCCTTAA\\r\\nTAATCATCCTTAACCAAAAC\\r\\nATATCTTCCAAAACCTAAAC\\r\\nATATCAACCATATCCATAAC\\r\\nAATACATCCTAAACCATTAC\\r\\nAAATCTTCCTTTTCCATTAC\\r\\nTTTTCTTCCATAACCATATC\\r\\nATATCTACCTTAACAAAACC\\r\\nTTTTCTACCAAAACATATCC\\r\\nTTAACAACCATTACTAAACC\\r\\nTTAACTTCCTATACAAATCC\\r\\nTTATCATCCATATCATAACC\\r\\nAATACTTCCTTATCAATACC\\r\\nTAATCTACAAAACCCAAAAC\\r\\nATTTCAACATAACCCTAAAC\\r\\nATTTCTTCAATACCCAATAC\\r\\nATAACAACAAATCCCAAATC\\r\\nATAACTACTTAACCCATAAC\\r\\nAATTCTACTAAACCCTTTAC\\r\\nTTATCAACTATACCCTATAC\\r\\nTTATCTTCTAATCCCATTAC\\r\\nTTATCTACTTATCCCTAATC\\r\\nTATACTACATATCCCTTAAC\\r\\nTATTCAACAATTCCCATATC\\r\\nTAAACTACATTTCCCAATTC\\r\\nTAATCTTCATTACCCTTATC\\r\\nAAATCATCAATTCCAAAACC\\r\\nTTAACATCTTTTCCAATACC\\r\\nTATACTTCTATTCCTAAACC\\r\\nTATACATCATTTCCATATCC\\r\\nTATTCATCTAAACCAAATCC\\r\\nTAAACAACTAATCCATAACC\\r\\nTAAACATCAAAACCTATACC\\r\\nTAATCAACATTACCAATTCC\\r\\nATATCATCTTATCCTAATCC\\r\\nAATACAACAATACCTTAACC\\r\\nATTACATCAATACAAAACCC\\r\\nTTTACTACTTTACTAAACCC\\r\\nTTTACTTCAAAACTATTCCC\\r\\nAATTCATCATAACTAATCCC\\r\\nATAACTTCTTTTCAATACCC\\r\\nATTTCTACAATTCATTACCC\\r\\nATTTCATCTTTACATTTCCC\\r\\nATTACAACATATCTATACCC\\r\\nATTTCCCTACTTAACTTTCA\\r\\nAATTCAACCCTATTCATACA\\r\\nAAATCTACCCATTTCTTTCA\\r\\nTATTCTTCTTTACCCATTCA\\r\\nTAAACTTCATAACCAAACCA\\r\\nCAAAACTCCTATTCAAAACA\\r\\nCTTTTCTCCAATTCTAAACA\\r\\nCTTTACACCTTTTCATAACA\\r\\nCTTATCACCTAATCAAATCA\\r\\nCTTAACACCAATACAATACA\\r\\nCTTAACTCCATTTCAAATCT\\r\\nCTATACACCTAAACTAAACA\\r\\nCTATACTCCAAATCATTACA\\r\\nCTAATCACCTTTACAAAACT\\r\\nCTAATCTCCTAATCTTAACT\\r\\nCATATCTCCATTACATAACA\\r\\nCAATTCACCAATTCATATCA\\r\\nCAAATCACCAAATCTATACA\\r\\nCAAAACACCATAACAAATCA\\r\\nCTAAACTCTATACCTAAACA\\r\\nCATTACTCTTAACCTAATCA\\r\\nCATAACACTTTTCCTATACA\\r\\nCAATACTCAAATCCTTAACA\\r\\nCTATTCACTTTACCTTTACA\\r\\nCTAAACACTATTCCATTTCA\\r\\nCATAACTCATTTCAAAACCA\\r\\nCTTTACTCATAACAATACCT\\r\\nCTTATCTCTTATCAAATCCT\\r\\nCAATTCTCTTTTCTAATCCA\\r\\nCAATACACATTACTTAACCA\\r\\nCATATCACAATACATATCCA\\r\\nCATTTCACAAATCTTAACAC\\r\\nCTATTCTCAATTCTTTACTC\\r\\nCTTTTCACTAAACATTACTC\\r\\nCATTACACTATACTATACAC\\r\\nATAACCTCCAATACTTAACA\\r\\nTTATCCTCATATCCATTACA\\r\\nAAAACCTCTAATCTATTCCA\\r\\nTAATCCTCAATACTTTTCCA\\r\\nAATACCACATTTCTTATCTC\\r\\nAAAACACCCTTTTCTTAACA\\r\\nTTTTCACCCATTTCTTTACA\\r\\nTTTACTCCCTTATCTTATCA\\r\\nTTATCACCCTATACTTATCA\\r\\nTATACACCCATATCTAAACT\\r\\nTAATCTCCCTTTACTATACA\\r\\nATAACTCCCTATTCTATTCA\\r\\nAAATCACCCAAAACTTTACA\\r\\nAAAACTCCCATAACTTATCT\\r\\nATATCTCCAATACCATAACA\\r\\nTAAACTCCTATACCAATACA\\r\\nAATTCTCCTTAACCATATCA\\r\\nATTACTCCAAATCCAAATCA\\r\\nATTTCTCCATTTCCTTTTCA\\r\\nATAACACCTAAACCTTATCA\\r\\nTAAACACCAAATCATTTCCA\\r\\nTTATCTCCTAAACTTTTCAC\\r\\nAAATCTCAAAACCCAATTCA\\r\\nTTTTCACTAAACCCTATTCA\\r\\nTTATCTCTATACCCATTTCT\\r\\nTTATCTCATATCCCAAATCT\\r\\nTATTCTCTAATCCCAATACT\\r\\nAATTCTCATTACCCTATACT\\r\\nAAATCTCTTATCCCTTTTCT\\r\\nAAATCACATATCCTAAACCA\\r\\nTTTTCACATTTCCATAACCA\\r\\nTAAACACTTTTCCTTTACCA\\r\\nTAATCACTATTCCAAATCCA\\r\\nATTACACTTTACCATTTCAC\\r\\nTATTCACTATACCTTATCAC\\r\\nAAAACTCATTTCAATTCCCA\\r\\nTTAACACAATACATTTCCCA\\r\\nTTAACTCAAATCTAATCCCA\\r\\nATATCTCAATACTAAACACC\\r\\nTAAACTCTTTACTTAACACC\\r\\nTAATCACAAAACTAATCTCC\\r\\nTTTACTCAATTCTTTACACC\\r\\nATATCACTAATCTTAACTCC\\r\\nATATCTCTTTTCTTTTCACC\\r\\nAATTCACCCTTAACTTACAA\\r\\nTAATCACCTTATCCAAACAA\\r\\nATTTCACCTAATCCTATCAA\\r\\nAAATCTCCATATCCTTACTA\\r\\nTTAACACCATTTCTAACCAA\\r\\nATTTCTCTATTCCCTAACAA\\r\\nATTACTCATAACAATCCCTA\\r\\nTAAACACATAACTAACCCTA\\r\\nTATACACTTAACATTCCCTT\\r\\nATAACTCTTAACTTTCCCAT\\r\\nAATACACCAATTCCTACAAA\\r\\nCAAATCTCAAAACACCAAAA\\r\\nCATTTCTCTATTCTCCAAAA\\r\\nAATTCCACAAAACTCCTAAA\\r\\nTTAACCACATAACACCTAAA\\r\\nTTATCCACTAATCTCCTATA\\r\\nTTTACCACAATTCTCCTTAA\\r\\nTTTTCCTCTAAACACCTTAA\\r\\nTTTTCCACTTAACTCCAAAT\\r\\nTATTCCTCATTACTCCATAA\\r\\nAAATCCACATATCACCAATA\\r\\nTAAACCACTTATCACAAAAC\\r\\nAATACCTCTTTACTCAAAAC\\r\\nTATTCTCCCTAAACACAAAA\\r\\nATATCACCAATACACCATAA\\r\\nTTAACTCCAATTCACCAAAT\\r\\nAAAACACAAATCTCCCAAAA\\r\\nTTTACACAATTCACCCATAA\\r\\nTTAACACTTATCACCCAATA\\r\\nATAACACATTACACCCAAAT\\r\\nAATACTCTAAACTCCCTATA\\r\\nTTAACCTCAAACTTTACTTC\\r\\nATTTCCACATTCTATACACA\\r\\nAATACTCCTAACATATCTCA\\r\\nATTTCACAATCCAAATCACA\\r\\nAAAACCACCAAACTATCAAA\\r\\nTTTACCTCCATACTATCTAA\\r\\nTATTCCACCTATCTATCATA\\r\\nTATACCTCCTAACAATCAAT\\r\\nTAATCCACCTTACAATCTAA\\r\\nTAAACCTCCTTACTTTCATA\\r\\nATTACCACCTAACATTCTAA\\r\\nATATCCTCCAAACATTCATA\\r\\nATATCCACCATTCTTTCTAA\\r\\nAAATCCTCCTATCTTTCAAT\\r\\nTATACCACTTTCCTTACTTA\\r\\nATAACCACTATCCATACTTT\\r\\nATTACCTCATTCCTTTCTTT\\r\\nAATTCCTCTTTCCAATCTTA\\r\\nTATACTCCCAATCTAACTAA\\r\\nATTACACCCTAACTAACTTA\\r\\nTTTTCTCCCATTCAAACAAT\\r\\nTATTCACCAAACCAAACTTA\\r\\nTTTACACCTTACCAATCATA\\r\\nAATACACAAACCCATTCTTA\\r\\nTTTACACTAACCCTATCTTT\\r\\nTATTCACATACCCAATCTAT\\r\\nTATACTCATTCCCATACATA\\r\\nTTTTCTCATACCATACCAAA\\r\\nAATACTCAAACCATTCCAAT\\r\\nATATCACATTCCTTACCTAA\\r\\nATTTCACTTACCTATCCAAA\\r\\nTATTCTCAATCCTAACCTAA\\r\\nTTAACTCTAACCTTACCATA\\r\\nTTTACTCTATCCATTCCTAA\\r\\nTTTTCTCTTACCAATCCTTT\\r\\nTATACTCTTTCCTATCTAAC\\r\\nAAAACACTATCCAATCTTAC\\r\\nTAATCTCTAACTAACCCAAA\\r\\nATTTCTCAAACAAACCCATA\\r\\nAATTCTCTTTCTATCCCTAA\\r\\nTAAACTCAATCATACCCATA\\r\\nTAATCTCATTCAATCCCAAT\\r\\nTATACACATTCTTTCCAAAC\\r\\nAATTCACTTTCTAACCAATC\\r\\nAATTCACAAACTATCCTAAC\\r\\nATTACTCTTACTATCAAACC\\r\\nATAACTCATACATACTAACC\\r\\nATTACACATACATTCATTCC\\r\\nATTTCCTCCTTTCAACAAAA\\r\\nTTATCACAACCAATACTTAC\\r\\nTTATCACTTCCTATTCATTC\\r\\nAAAACTCTACTTTTCTTCCA\\r\\nATAACACTACCCTTTCATTA\\r\\nAATACACTACTTACCCTTAA\\r\\nAAATCACTCCCATTACTTTA\\r\\nAAACCAATTCATATCTAACC\\r\\nTTTCCAAATCATTTCTATCC\\r\\nTATCCATATCTTATCTTACC\\r\\nATACCATTTCTTTTCAATCC\\r\\nAAACCTTATCTATTCTAACC\\r\\nAAACCAAAACTAATCTTTCC\\r\\nTTACAAATCCCAATTCATAC\\r\\nTATCAAATCCATAACCTTAC\\r\\nAAACAATACCTTAACTAACC\\r\\nTTACTATTCCTAAACTTACC\\r\\nTAACAATTCCATTACAATCC\\r\\nAAACTATACCATATCATTCC\\r\\nAAACAAATCTATTCCTTACC\\r\\nTTTCAAAACTTTTCCTTTCC\\r\\nTAACTAATCATTTCCTATCC\\r\\nATACTAATCTTATCCATTCC\\r\\nAATCATAACTATACCATTCC\\r\\nTATCTAATCTAATCTAACCC\\r\\nATTCAAATCAAATCAATCCC\\r\\nATTCTATACTAATCATACCC\\r\\nATTCTATTCTATACTATCCC\\r\\nAAACTAAACAAATCTTTCCC\\r\\nAATCTTATCTTTACTTACCC\\r\\nTTTCATTTCTTATCTATCCC\\r\\nTATCTTTTCTATTCATTCCC\\r\\nTATCCTAAACTTTACTACCA\\r\\nATACCTTAACTATACTTCCA\\r\\nAATCCAATTCTTTACATCCA\\r\\nTAACCATAACTTATCAACAC\\r\\nTATCTATTCCATATCTTCCA\\r\\nATTCTTTTCCTTTTCATCCA\\r\\nATTCTAATCCAATTCTTCCT\\r\\nAAACTTTTCCAAAACATCCA\\r\\nTATCAATACCAATTCATCCT\\r\\nTAACAAAACCAATACTACAC\\r\\nATACTTTACCAAAACTACAC\\r\\nAAACATATCCAAATCTTCAC\\r\\nTTACAATACTATTCCAACCA\\r\\nAAACATTACATTTCCATCCA\\r\\nATTCATTACTTTACCTACCA\\r\\nATACAATTCATATCCTACCA\\r\\nTTACTATACTTAACCTACCT\\r\\nTATCTTTACATTACAACCCA\\r\\nATACTTAACATAACTACCCA\\r\\nATACTTTTCAATACATCCCA\\r\\nATTCTAAACATTTCATCCCA\\r\\nAAACTATTCTTTTCAACCCA\\r\\nTTTCAATACAATACTACCCT\\r\\nTTTCATATCATTACTTCCCA\\r\\nTTTCTTATCATATCAACCCT\\r\\nTATCTATACATATCTTCCCT\\r\\nAATCATTTCATTTCTACCAC\\r\\nTAACTTATCAATTCTTCCAC\\r\\nAATCAATTCTTAACATCCAC\\r\\nTAACTTTACTTTTCTACACC\\r\\nAAACATAACTTTACATCACC\\r\\nTAACATTTCAAAACTACACC\\r\\nTTTCAATTCCCTAAACACAA\\r\\nAATCATATCCCTTAACACTA\\r\\nTATCAAAACCTAATCACCAA\\r\\nTTACATTACTATACACCCAA\\r\\nCCCAAACATATCAATCTAAA\\r\\nCCCTTTCTTTTCATTCTAAA\\r\\nCCCTTACATTTCTAACTATA\\r\\nTATCCCATAACTATCTTAAC\\r\\nATTCCTTAACCCATACTAAA\\r\\nTATCCTTATCCCTAACTAAT\\r\\nTTTCCTTTTCCCTTACATAA\\r\\nATTCCAATACCCAAACAATA\\r\\nATTCCATTTCCCAAACTTAT\\r\\nTAACCAAATCCATACCAAAA\\r\\nATACCTATTCCTTACCAATA\\r\\nAATCCTAATCCAATCCATAA\\r\\nAAACCATATCCTATCCAATA\\r\\nTATCCAAAACCAATCCTATA\\r\\nTAACCTATACCATTCCTTAA\\r\\nATACCTAAACCTTTCTAAAC\\r\\nTAACCTTTACCTTACTATAC\\r\\nATACCAATACAAACCCATTA\\r\\nTATCCTATTCAATCCCATTA\\r\\nTAACCATTACATTCCCTTTA\\r\\nTTTCCTATACATACCCTATA\\r\\nATTCCTTTACTATCCCAATA\\r\\nAAACCTTTTCATTCCAAAAC\\r\\nTTACCTAATCTTTCCAATAC\\r\\nAATCCATTACTTTCCTTAAC\\r\\nATTCTTAACCCATACCTAAA\\r\\nTATCATTACCCTTACCTTAA\\r\\nTTACTAAACCCTAACCTATA\\r\\nTTTCTTTACCCAAACCATTA\\r\\nTTACATTTCCCATTCTTAAC\\r\\nATTCATAACCCAATCTTATC\\r\\nTTACATAACCAAACCCTTTA\\r\\nTAACTTAACCTTACCCATTT\\r\\nTTACTTATCCTATCCCTATT\\r\\nAATCTAAACCATACCTTAAC\\r\\nTTACATATCAATCCCTATTC\\r\\nTTACAAAACAAACCATTACC\\r\\nTATCTTAACAATCCTTTACC\\r\\nATTCCATAACCATACAAACA\\r\\nTAACCCTAAACTCTATACAT\\r\\nAATCCCAATACTCATACTTA\\r\\nTTTCCCTATTCTCTTACTTT\\r\\nTAACCCATTTCTCTTTCTTA\\r\\nTATCCCTTTACACAAACTTT\\r\\nATACCCTATACACATTCTTT\\r\\nAATCCCTAATCACATACATT\\r\\nAAACCCTTTTCTCTACAAAA\\r\\nTTTCCCTTATCACTACTAAA\\r\\nATACCCATATCACAACATAA\\r\\nCTTACAATCATAACATAACC\\r\\nATACAAACCCTTTACTTTAC\\r\\nCTTTCATACTTATCATTCCA\\r\\nAAACAATCCCATAACACAAA\\r\\nAAACTATCATTACACCCAAA\\r\\nTTTCTTTCATTTCTCCCAAA\\r\\nTTACAAACATTTCACCCTAA\\r\\nTTACTATCTATTCACCCATA\\r\\nTAACTTACAATACTCCCTAA\\r\\nATACTTACATAACTCCCATA\\r\\nAAACTTTCATATCTCCCTAT\\r\\nAAACAAACTTTTCTCCTAAC\\r\\nTATCTAACTTTACACCTATC\\r\\nTAACATTCTATACTCCTATC\\r\\nTAACATACAAATCACCTAAC\\r\\nATACATTCTTATCTCCAATC\\r\\nAAACTTACTTTTCACAAACC\\r\\nTAACTAACTAAACTCAAACC\\r\\nTAACAATCAAATCTCCATCA\\r\\nCCAAACAAACAAACATTACA\\r\\nCCTTTCTAACATACATTTCA\\r\\nCCTTTCAATCAAACAATACT\\r\\nCCTTACTAACAATCTTTACT\\r\\nCCTTACATTCAAACTTTTCA\\r\\nCCTTACAAACTTTCAATACA\\r\\nCCTATCATACTATCATTTCA\\r\\nCCTATCAAACTTACTTTACT\\r\\nCCTAACTATCTAACAATTCA\\r\\nCCTAACAATCATTCATTTCT\\r\\nCCATTCAAACTAACTATTCA\\r\\nCCATACTTACTAACATTTCT\\r\\nCCATACAATCTTACATATCA\\r\\nCCAATCTTACAAACTATACT\\r\\nCCAAACTATCAATCAAAACT\\r\\nCTATCTTACCAATCAATTCA\\r\\nCTTACTTACCTAACTAATCA\\r\\nCTAACATTCTATCCAATTCT\\r\\nCATACATTCATACCTATTCT\\r\\nCAATCATACATTCCTTATCT\\r\\nCAAACTTACATACAATTCCA\\r\\nCATTCTTACATTCATATCAC\\r\\nCAATCATTCATTCAATTCTC\\r\\nAAACCCAAACATTCTTTTCA\\r\\nTTACCCTAACTTTCTAATCA\\r\\nTTACCCAATCAATCTATTCT\\r\\nATACCCTTTCATACTTTTCT\\r\\nAATCCCATTCTTTCTTATCT\\r\\nTTACCTATCCATACTAATCT\\r\\nTTACCATTCCAATCATATCT\\r\\nTATCCAATCCAAACTTAACT\\r\\nAATCCTTTCCATACAATTCT\\r\\nTATCATTCCCAATCTAATCT\\r\\nTAACTATCCCATTCAATTCT\\r\\nAAACATACCCTATCTTTTCT\\r\\nATACTAACCAATCTTTTCCT\\r\\nTTTCTAACATACCCTAATCT\\r\\nTTTCATACTAACCCATATCT\\r\\nTTACTAACAATCCCATAACT\\r\\nTTACAATCTAACCCTAAACT\\r\\nTATCATACATTCCCAAAACT\\r\\nAATCAAACTTACCCTTAACT\\r\\nTTTCAATCAATCCTAATCCT\\r\\nATACTTTCAATCCATATCCT\\r\\nAATCAATCATTCCATTTCCT\\r\\nATACATACATACCATAACAC\\r\\nATTCAAACTAACTTTTCTCC\\r\\nCCAATCTAACTTACAAACAA\\r\\nCCTTACTTTCTTTCAAACAA\\r\\nCCTTTCATACTTACTAACTA\\r\\nCCTATCTTTCTAACATACTA\\r\\nCCTATCTATCAAACTAACAT\\r\\nCCATACTAACTATCTTACAA\\r\\nCCATTCATACATTCATACAA\\r\\nCCATTCTATCATACATACTT\\r\\nCCAAACATTCTTACTATCAA\\r\\nCCAAACTTACATACTTACTA\\r\\nCCAATCATTCTATCAAACAT\\r\\nCTAACAATCTTACCTTACAA\\r\\nCATTCAATCATTCCATACAA\\r\\nATTCCCAATCTATCTAACAA\\r\\nTTTCCCATACTAACTTTCAA\\r\\nTTTCCATTCCTTTCATTCAA\\r\\nAATCCATACCTTTCTATCTA\\r\\nTTACCAAACCATTCTATCAA\\r\\nAATCCTATCTAACCATTCAA\\r\\nTTTCCATACTAACCTTTCAA\\r\\nTTTCCTAACTTTCCATTCTA\\r\\nTAACCAATCAAACCAATCTA\\r\\nTAACCTAACTATCCTTTCAT\\r\\nTATCCATTCTTACCATACTA\\r\\nAAACCTATCATACCAAACAT\\r\\nAATCCTTACTTACCTATCAT\\r\\nTTTCCAATCTTTCAAACCAA\\r\\nAATCCAAACATTCTTACCAA\\r\\nATACCTTTCTATCATACCAA\\r\\nATACCATACTTTCTATCCAA\\r\\nATTCCAAACTTTCATTCCTT\\r\\nTTTCCTTACAATCAATCCAA\\r\\nTTACCTTACTATCTAACAAC\\r\\nTTACCAATCTATCAATCATC\\r\\nTTACTTACCCTTACATTCAA\\r\\nATTCTTTCCCTTTCTTTCAT\\r\\nTTACATTCCCTAACAAACTA\\r\\nATTCTTACCAATCCAATCAA\\r\\nTTACATACCATTCCTATCTA\\r\\nAATCATACCTTTCCAAACTA\\r\\nAATCTTTCCAAACCTAACTA\\r\\nATTCTAACCTAACCTATCTT\\r\\nAAACATTCCTTACATTCCAA\\r\\nTTTCATTCCATACATACCAT\\r\\nTTACTTTCCTAACTTTCCTA\\r\\nTATCTATCCTTTCTTTCCAA\\r\\nTAACAAACCATACTTTCCAT\\r\\nAATCTTACCTTACTATCCAT\\r\\nATACTATCCAAACTTACAAC\\r\\nTATCAATCCAATCATACAAC\\r\\nATACAATCCTATCAAACTAC\\r\\nTTTCAAACAAACCCTTTCTA\\r\\nTATCTTTCTATCCAATCCTA\\r\\nATTCAATCTTTCCTATCCTA\\r\\nAATCATTCAAACCTAACCTA\\r\\nTTTCTTACTATCCTTACCTT\\r\\nTATCTTACAAACCATTCCAT\\r\\nTAACTTTCTAACCTATCAAC\\r\\nAATCTATCTTACCTTTCTAC\\r\\nTTTCTATCAAACATACCCTA\\r\\nATTCATACAATCAAACCCTA\\r\\nTATCAAACATACTTACCCTT\\r\\nATTCATTCATACATACCTTC\\r\\nAAACTAACATTCTTTCCTTC\\r\\nAAACCATTCAAACAAACACA\\r\\nATTCTATCCATTCTAACACA\\r\\nAATCTAACCATTCATTCTCA\\r\\nCCAATCAATCTAACTTCAAA\\r\\nCCTTTCTTTCAATCTTCAAA\\r\\nAATCCCTTACAATCAACAAA\\r\\nATTCCCTAACAAACTTCTAA\\r\\nATTCCTATCCTAACATCAAA\\r\\nCCTAACATTCATACACATAA\\r\\nCCTAACTTTCTATCTCATAT\\r\\nCCATACATACAACTATCTTA\\r\\nCCATTCTTACTTCAATCTTT\\r\\nAAACCCTATCAACTAACATA\\r\\nATTCCCTTTCTACTTACATT\\r\\nTAACCTTACATCCTATCATT\\r\\nTATCCCAAACTTCATCAAAA\\r\\nTAACCCTTACTCTAAACTTA\\r\\nAAACCCATACACATTACTTA\\r\\nTTACCCATTCACTTAACTTT\\r\\nTATCCCTATCTCTTTTCTTA\\r\\nTAACATCATTTCCCATACTT\\r\\nAAACTTCTTTACCCAATCTT\\r\\nAATCATCTTTTCCCAACAAA\\r\\nTTTCATCATAACTCCCAATT\\r\\nTTTCAACTAATCACCCTATT\\r\\nTATCAACAATACTCCCTTTT\\r\\nTAACTTCAATACACCCTAAT\\r\\nATACTACAATTCTCCCATTT\\r\\nAAACAACTTTTCACCCTTTT\\r\\nTTACTTCAAAACTCCTAAAC\\r\\nAATCTACAAAACACCTATAC\\r\\nAAACATCTAATCTCCTATAC\\r\\nAAACTTCATATCACCTAATC\\r\\nATTCTTCTAAACACCATAAC\\r\\nATACATCTATACTCCAAATC\\r\\nTAACTACATATCTCCTTTAC\\r\\nTTTCTTCATTTCTCCTTATC\\r\\nTTACAACATAACACCAATAC\\r\\nTTACATCAAATCACCTTTTC\\r\\nTTACTACTATACACCTTTAC\\r\\nAATCTACTTATCTCAAAACC\\r\\nTTTCTACTATTCTCTTAACC\\r\\nTATCAACTTTACTCTATACC\\r\\nTATCTTCTTAACACTTAACC\\r\\nATACAACTTAACTCATTACC\\r\\nATTCAACATTTCACAATACC\\r\\nAATCATCATTACTCAAATCC\\r\\nTTTCATCTATTCACCAAACA\\r\\nATACTACTTTTCTCTAACCA\\r\\nCTTTCCATCAAACATACAAT\\r\\nCTATCCTACATACTAACAAT\\r\\nCTATCCAACTATCATTCATT\\r\\nCTAACCTACTAACATACTAT\\r\\nCATACCAACTTACTAACTAT\\r\\nCAAACCTTCATACATTCAAT\\r\\nCAAACCTACAATCTATCTAT\\r\\nCATTCTTCATACCTAACATT\\r\\nCATTCAACTAACCTTACAAT\\r\\nCTATCAACAAACAAACCAAA\\r\\nCATACAACTTACAATCCAAA\\r\\nCAAACAACATTCATACCTAA\\r\\nCAATCTACTATCTAACCATA\\r\\nCTTACTACAAACTATCCTAA\\r\\nCTTACAACTATCATACCATA\\r\\nCTTTCTACTTTCAAACCTAA\\r\\nCTAACTTCAATCAATCCATA\\r\\nCTAACATCATACTTTCCAAA\\r\\nCTATCTACATACTATCCATT\\r\\nCTATCATCATTCTAACCTTA\\r\\nCTAACTACAATCTTACTAAC\\r\\nCATACTTCATTCTTACAATC\\r\\nCAAACATCTATCTTTCTTAC\\r\\nCTAACAACTTTCTTTCAATC\\r\\nAATCCAACATACAAACCTTA\\r\\nTTTCCTACTTACATTCCTTA\\r\\nTATCCATCAATCTATCCTTA\\r\\nAATCCATCTTTCTTACCTTT\\r\\nAAACCAACAATCTAACTTAC\\r\\nTTACCTACATTCAAACTTTC\\r\\nTAACCATCTTACTAACATAC\\r\\nATTCCTTCTATCTATCTTAC\\r\\nATACCATCTAACTTACTTTC\\r\\nAAACCTACTAACAAACATTC\\r\\nTTACTACCCATACAAACTAT\\r\\nAAACATCCAATCTTTCCATA\\r\\nTTTCAACCATTCATTCCATA\\r\\nAAACAACCAAACATTCTTAC\\r\\nTATCTACCATACAATCTTTC\\r\\nTAACATCCTTACTTTCTTTC\\r\\nAATCAACCTTACATACTATC\\r\\nTATCATCAATCCCTAACTTT\\r\\nAATCAACATACCAAACCATA\\r\\nATTCATCAAACCTATCATAC\\r\\nTAACAACAAACCAATCATTC\\r\\nAAACTACAAACTTTCCCTAA\\r\\nTTTCTACATACTTACCCTTA\\r\\nTTACAACTAACATTCCCTTA\\r\\nATTCTACAATCAAACCCTAA\\r\\nAATCTTCAAACATACCCTTT\\r\\nAAACAACATTCATTCCCATA\\r\\nTAACAACTATCTATCCTTAC\\r\\nATACTTCTATCAATCCTTTC\\r\\nTAACTACTTACATTCCATAC\\r\\nTAACATCTTACAAACCTTTC\\r\\nATTCTACTTTCATACTTACC\\r\\nTATCTACTAACTTACTTTCC\\r\\nTTACTTCTTACTTTCTTACC\\r\\nTTTCTTCTTTCAATCTATCC\\r\\nATACAACAATCATTCTTTCC\\r\\nCAATCTTCTTACTTACAACA\\r\\nAATCCTTCTTTCTATCAACA\\r\\nATACATCCATACATTCAACA\\r\\nTTACAACCATACTAACTACA\\r\\nATTCATCCTATCATTCTTCA\\r\\nATTCTTCAATCTTTCCTACA\\r\\nATACATCATACTTTCCATCA\\r\\nATACTTCATTCATACCTTCT\\r\\nATTCAACTTACTTACAACCA\\r\\nTATCATCTAACTTTCTACCA\\r\\nTTACATCTTTCATTCAACCA\\r\\nTAACTTCTAACAAACAACAC\\r\\nTATCTTCATACTATCTACAC\\r\\nTAACAACCTATCTTACACAA\\r\\nAAACTACCTTACTATCACAA\\r\\nTTACTACATTCTAACACCAA\\r\\nCAATCCAACAAACTTCAAAA\\r\\nCTTACCATCTAACTTCTAAA\\r\\nCTTTCCTTCAATCTTCATAA\\r\\nCTTTCCTACAAACAACAATA\\r\\nCTTTCCAACTTTCTTCAATA\\r\\nCTAACCATCATACTACATAA\\r\\nCATACCTTCAAACTACAAAT\\r\\nCATACCATCAATCATCAATA\\r\\nCATTCCATCTTACATCATAA\\r\\nCAAACCAACTAACAACTTAA\\r\\nCAATCCTTCTTACTACAATA\\r\\nCAATCCTACTTACTTCTTAT\\r\\nCAATCCATCTATCTACTAAT\\r\\nCAAACTTCTAACAACCTTAA\\r\\nCTATCTTCAAACTACCATAT\\r\\nATACCCAACATACATCTAAA\\r\\nTTACCCTTCTAACATCTTAA\\r\\nATTCCCATCATTCTACTATA\\r\\nTAACCAACCTTTCTACTTAA\\r\\nATACAACCCAATCAACTAAA\\r\\nTATCAACCCTATCATCTATA\\r\\nTTACATCCCTTTCATCTAAT\\r\\nTTACTTCCAAACCTTCTTAA\\r\\nAATCTTCCTAACCATCTTTA\\r\\nAAACTTCCTATCCTACTTAT\\r\\nATTCTACCAATCCTTCATTA\\r\\nATTCTTCCATACCAACTTAT\\r\\nTTTCTTCCTTTCTACCATTA\\r\\nAATCATCCATTCTTCCATTT\\r\\nAATCTACCTTTCAACCAATT\\r\\nTATCTTCCAATCAACCATAT\\r\\nTTTCTACCTAACTTCCTATA\\r\\nTAACTACCAAACTTCATAAC\\r\\nATACTACCATTCTACTAACA\\r\\nTAACTTCCATTCACATATCT\\r\\nCTTTCATCAAACTCTTTCAA\\r\\nTATCATCCTTTCACTAACAA\\r\\nTTTCATCCAAACACATACAA\\r\\nATTCAACCTAACACAACAAA\\r\\nATACTTCCTTACACTACTAA\\r\\nCATACCTACATCATACTTAA\\r\\nCTTACCTTCTACATACATTA\\r\\nCATTCATCCAACTTTCAAAA\\r\\nCATACATCTTCCTAACATTA\\r\\nCTTTCTTCTACCTAACTTTT\\r\\nCTTACTTCTTCCAATCAATT\\r\\nCAAACTACTACAATCCAAAA\\r\\nCAATCATCTACTATCCATAT\\r\\nCTTTCAACTTCTAACTAAAC\\r\\nCATTCTACATCAAACATAAC\\r\\nCTTACATCTACAAACTTTAC\\r\\nTTTCCCAACAACAATCATAA\\r\\nTAACCCAACTTCATTCATTA\\r\\nATACCTTCCTACTTTCATAA\\r\\nTTTCCATCCTTCATACATAA\\r\\nTTTCCTTCCAACTATCAATA\\r\\nTTACCATCCTACATTCTATA\\r\\nATTCCTACCAACTTACATTT\\r\\nATACCAACCATCTATCATTA\\r\\nATACCTACCTTCTTTCTATT\\r\\nTATCCTACAACCATACTTTA\\r\\nATTCCAACTACCATTCTTTT\\r\\nAAACCTTCATCCTTACTATA\\r\\nAAACCATCATCTAACCTTTA\\r\\nTTACCAACATCTTACCTATT\\r\\nTAACCTTCTTCAAACTTAAC\\r\\nAATCCTACTACTAACTTATC\\r\\nTTACCTTCAACTTACATAAC\\r\\nTATCCAACTTCATACATTAC\\r\\nATTCATCTTCCCTATCTTTA\\r\\nAAACATCAACCCAATCTATA\\r\\nAATCAACTACCTTTCCTTTA\\r\\nAAACTACTACCAATCATAAC\\r\\nTATCTACATCCATTCATATC\\r\\nAATCTTCTACCTAACAAATC\\r\\nTTTCCAACAACTTTCAAACA\\r\\nTTTCAACAACCTTACATTCA\\r\\nCAAACCATCTCTATTCTTAA\\r\\nCTTACCTACTCTTATCTTAA\\r\\nTAACCTACCACATAACATAA\\r\\nTATCCTTCACTAATCATTAC\\r\\nCAATCAACTCATAACTTACA\\r\\nCATACTACTCAATACACAAA\\r\\nATTCCATCTCTATTCACAAA\\r\\nAAACACTAAACAATCCCTTA\\r\\nTTTCACAATACAATCAATCC\\r\\nTTACACTAATCTAACAATCC\\r\\nAAACTCATTTCCATACTCAA\\r\\nAATCACTTTACCCAACATTA\\r\\nTTACACATTTCCCTACATTA\\r\\nTTTCACTATTCCCAACTATA\\r\\nTTTCACTTATCCCATCATTT\\r\\nAATCACATATCCCTTCTTTA\\r\\nTAACTCTATACCATCCTTAA\\r\\nAAACACTTTTCCTTCCTTAT\\r\\nAAACACAAAACACATTACCA\\r\\nTTACTCATAACACTATACCA\\r\\nTTACTCAAAACTCATAACCT\\r\\nTATCTCAATACACTTTACCT\\r\\nTAACTCAAATCACTTATCCA\\r\\nTAACACATAACTCAATTCCT\\r\\nAATCACAAATCTCTTAACCT\\r\\nAAACTCTAATCTCAAAACAC\\r\\nTTTCTCTTATCTCATTACAC\\r\\nTTTCTCTATTCACAAAACTC\\r\\nTTACTCTTAACTCTAATCAC\\r\\nTATCTCTAAACACAATTCAC\\r\\nTAACACAATTCTCAATACTC\\r\\nATACACTATACTCAAATCTC\\r\\nAATCTCATATCTCTATTCAC\\r\\nAAACTCTTTTCACTTAACTC\\r\\nTTACACTTAACACCTTACTT\\r\\nTATCACATTACTCCTAACTT\\r\\nATACTCATTACACCTAACAT\\r\\nATACTCAATTCACCATTCTT\\r\\nAATCTCTTTACTCATTCAAC\\r\\nCCTTACTCAATCATACAATA\\r\\nAATCCACTTACTAACATTAC\\r\\nTTACCACTTTCAAACAATAC\\r\\nTATCCTCATTCTATCATTTC\\r\\nATTCCTCTATCTTTCATTAC\\r\\nAAACCACTATCTTACAATTC\\r\\nATTCACCTTACATACCATTT\\r\\nTATCTCCAATCAATCTTTAC\\r\\nAAACACCTATCAAACTATAC\\r\\nAAACTCCAAACATTCTATTC\\r\\nTTACTCTATCCCATTCAATA\\r\\nATTCTCTAACCTATCTATAC\\r\\nTATCACTATCCTTTCAATAC\\r\\nTTTCTCATTCCTAACTATTC\\r\\nATTCTCAAACCAAACATTTC\\r\\nATTCTCTTTCCATTCTAATC\\r\\nAAACCTCTAACATACATACA\\r\\nTTACACAATCCAAACTAACA\\r\\nATACACATACCATACTTTCA\\r\\nATACACTTTCAAACCATACA\\r\\nATACACAAACATACCAAACT\\r\\nTAACACTATCTTTCATACCA\\r\\nAAACCTCAATCTATCTTCAA\\r\\nATTCTCCATTCTTACTACAA\\r\\nTTTCTCCTATCTAACTTCTA\\r\\nATTCACCATACAAACATCAA\\r\\nATTCACATTCCAATCTACAA\\r\\nTATCACTTACCAAACTTCAA\\r\\nTATCTCTTACCTATCACAAA\\r\\nTTACCTCAAACTACTATTCT\\r\\nATACCACTAACTACATTACT\\r\\nAAACCACAAACATCAATCAA\\r\\nTTTCCACATTCAACAATCAA\\r\\nTATCCACAATCTTCATTCTA\\r\\nTAACCTCTTACATCTATCAT\\r\\nAATCCACATACTACAATCTT\\r\\nTTACACCAAACTTCAATCTA\\r\\nAATCACCTAACTTCTTTCTA\\r\\nAATCACCAATCATCAAACTA\\r\\nAAACACCATTCTACTATCTA\\r\\nATACTCCTTACTTCATACTA\\r\\nTAACTCCTAACATCTAACTA\\r\\nTTACACCTTTCAACATTCTA\\r\\nTTTCTCAATCCTACTTTCTA\\r\\nATTCACAAACCATCTTTCTT\\r\\nTATCACAATCTACCAATCAT\\r\\nAATCACTAACATCCATTCAT\\r\\nAAACACATTCTACCTTTCTT\\r\\nTAACACTTACAACATTCCTA\\r\\nATACTCTAACAACAATCCTT\\r\\nTTTCACATACTTCATACCTA\\r\\nTAACTCTTACTACTAACCTT\\r\\nAAACTCAATCATCAATCTAC\\r\\nATACTCTTTCTTCTATCTTC\\r\\nAATCTCTATCTTCTTACTAC\\r\\nAAACTCCTTTCATCTACAAA\\r\\nTTACTCCATACTTCTACTAA\\r\\nATTCTCATACCAACTACAAA\\r\\nATTCACTTTCCTTCTACATA\\r\\nTAACTCATACTCATATCTTC\\r\\nATACCTCTTTCACAATCATT\\r\\nTTTCCTCATACTCTACTTTA\\r\\nTTACCACATCTATCATACTT\\r\\nTATCCACTACATTCTAACTT\\r\\nATTCCTCAACTATCAATCTT\\r\\nAATCTCAACCAATCTTACTA\\r\\nTATCTCATCTTTCTTACACA\\r\\nATACCACAACAATCATCAAA\\r\\nTAACCACTTCAAACATCTAA\\r\\nTTACCTCTACAAACAACATA\\r\\nATACCTCATCATTCTACAAT\\r\\nATACACCTACTTTCATCTAA\\r\\nTATCACCTTCATTCTTCTAA\\r\\nTAACACCAACATTCAACTAT\\r\\nTAACACCTTCTTACAACTTA\\r\\nTTTCACCAACTAACAACTAA\\r\\nTTACTCCTACTATCTACTAT\\r\\nATACACCATCTTACTTCATA\\r\\nATTCACTACCTATCATCTTA\\r\\nATTCCACTTCTAACTCAAAA\\r\\nTTTCCTCTTCAATCACTAAA\\r\\nTATCTCCTACAATCTCAAAA\\r\\nAATCTCCATCTTTCTCTAAA\\r\\nTTTCTCCAACATACTCTTAA\\r\\nTAACTCCATCATACTCAAAT\\r\\nATTCCACAACTTCAACTTTA\\r\\nAATCCTCTACTACATCTTTT\\r\\nATTCTCCTTCATCATCATTA\\r\\nTTTCACCTACATCTACATTT\\r\\nATACTCCAACTTCTTCATTT\\r\\nTATCACCATCACTAATCATA\\r\\nCTTTCACACTAAACTTACTT\\r\\nCATACACTCTATACATTCTT\\r\\nCAAACTCTCAATTCACAAAA\\r\\nCTTTCTCACAAATCACATAA\\r\\nCTTTCTCTCTATTCTCAATA\\r\\nCTTACACACAATACACTAAA\\r\\nCTTACACTCATTTCACATTA\\r\\nCTTACTCACATTTCTCAAAT\\r\\nCTATCTCACTATTCACTAAT\\r\\nCTATCTCTCATTACACTTAA\\r\\nCTAACACTCTTTACACAAAT\\r\\nCATACTCACTTTTCACTTAA\\r\\nCATACTCTCTTATCACAATT\\r\\nCAATCTCACATAACACAATA\\r\\nCAAACACACTATACTCATAA\\r\\nCAAACACTCAAAACACTTTA\\r\\nCAAACTCACTAATCTCTATA\\r\\nTATCCTCTCATAACTCTAAA\\r\\nTTTCCACTCTAAACTCTTTA\\r\\nTAACCACACTTATCTCTTAA\\r\\nAATCTCCTCTTTTCTCATTA\\r\\nAAACTCTCTTTCAATCTTCA\\r\\nCATTCACTCATACTTCTATA\\r\\nCTATCACACAAACATCTATT\\r\\nTAACCTCACTTACAACTTTT\\r\\nTTACTCACTTACCATCAATT\\r\\nTATCTCACAATCCAACTAAT\\r\\nTATCACACATACCTTCAAAT\\r\\nATTCTCACATTCCTACAATT\\r\\nTTACACACAATCATCCATTA\\r\\nAATCACACTATCTTCCAATA\\r\\nAAACTCACAAACATCCTTTT\\r\\nATTCACTCAAACAACCATTT\\r\\nATACACTCATTCATCCTATT\\r\\nTAACACTCTAACATCCAATT\\r\\nTAACACACTAACTACCTTTA\\r\\nTTTCTCTCAATCTTCCTTTT\\r\\nATTCTCTCTTACATCAATAC\\r\\nTAACTCTCATACAACAATTC\\r\\nTTTCACACTTTCATCAAATC\\r\\nATACACACTTACTTCATTTC\\r\\nATACTCTCTATCATCTTTTC\\r\\nTAACTCACTATCAACAAACA\\r\\nAATCACTCATACTACAACAA\\r\\nATACTCACATACATCTCTAA\\r\\nTATCTCTCTAACTCAAACTT\\r\\nAATCTCACTAACACTATCAT\\r\\nAATCTCTCATTCTCAACTAA\\r\\nTTTCACTCTTTCTCATCTAT\\r\\nTATCACTCTATCTCTCATAA\\r\\nCATTCTCTCAACAAACTATA\\r\\nCAATCTCTCTTCTATCTATT\\r\\nCATTCACACATCTAACAATT\\r\\nAAACACACATCAATCAAACA\\r\\nTTACTCTCAACTAACAACAA\\r\\nTTACACTCTTCAATCATCAA\\r\\nTTTCTCACTTCTATCTCAAA\\r\\nATTCACACAACAAACTCAAA\\r\\nAAACACTCAACTTCTATACT\\r\\nCTTTCACTCTCATAACTTAA\\r\\nCAATCACACTCTAAACTTTA\\r\\nCATACACACTCAAAACTAAT\\r\\nCTATCACTCACTTTTCTTAT\\r\\nAATCCTCACTCATTACATTA\\r\\nATCAAAACTATCCCATTACT\\r\\nAACCATTACCTTACAATCAT\\r\\nTTCCAAAACATACTTACCTA\\r\\nTTCCTATACAAACTAACCAT\\r\\nTTCCAATTCAATCAAACCTA\\r\\nTACCTTAACTTACATACTTC\\r\\nAACAATACTTACCTATCTAC\\r\\nTTCTATACTTTCCATTCTAC\\r\\nATCCATATCTTACTTACTCA\\r\\nAACAAAACCAAACAATCTCA\\r\\nAACCCAATACTTTCTTCTTA\\r\\nTACCTAAACCTTTCAACTTA\\r\\nAACCTTATCCATTCATCATA\\r\\nTACCATATCCTTACTACATA\\r\\nTTCCATTACAAACCTTCAAA\\r\\nAACCAATACATACCATCTAA\\r\\nATCCATAACATACCTTCTTT\\r\\nTTCCTTTTCTTTCCTTCTAA\\r\\nTACCAAATCATACAACCAAA\\r\\nATCCTAATCAATCTACCAAA\\r\\nAACCAATTCTAACTACCATA\\r\\nTACCAAAACTATCTTCCAAA\\r\\nTACCTTTTCATTCTTCTAAC\\r\\nAACAAATCCCAAACTACTTA\\r\\nTTCTAAACCCATACTTCTTA\\r\\nTACTAATCCCTATCAACATA\\r\\nAACATTTCCTATCCATCAAA\\r\\nTTCATATCCTAACCAACTAA\\r\\nTACTTTTCCAATCCTACTAA\\r\\nTACAATTCCATTCCAACAAT\\r\\nAACATAACCTTACCAACATA\\r\\nATCTAATCATACCCAACTTA\\r\\nTACAAATCAAACCCATCATA\\r\\nTACTATTCTTTCCCTACTTA\\r\\nTTCTTTTCTTACCCATCTTT\\r\\nATCAATTCATTCCCTTCATA\\r\\nATCTTATCTATCCCTACATA\\r\\nAACTAAACATTCCAACCTAA\\r\\nATCATAACTTACTACCCTAA\\r\\nTTCTAATCTTACAACCCTTA\\r\\nAACATATCATTCAACCCTAT\\r\\nATCCATTTCCATTCTCTTTA\\r\\nTTCCTAAACTAACCACAAAA\\r\\nATCCTTATCTATCCTCAATA\\r\\nAACCTTTACTAACTCCTTTA\\r\\nTTCCAATACTTACACTAAAC\\r\\nAACTTAACCCAAACACATTA\\r\\nTACTTTACCCAATCACAAAT\\r\\nAACTATTCCCTTACTCATTA\\r\\nTTCAATTCCTTTCCTCAAAA\\r\\nATCTATACCATACCTCTAAA\\r\\nATCAAATCCATACCACAATA\\r\\nTACTTATCCTTACCTCATAA\\r\\nTTCAATACCAAACCACATAA\\r\\nTACAATACCTATCACCTTTA\\r\\nTACTATACCTAACTCTAAAC\\r\\nTACAAAACTTTCCCACTAAA\\r\\nAACATTACAATCCTCCATTA\\r\\nTTCATTACATACACCATTTC\\r\\nTACTTAACTATCTCCAATTC\\r\\nAACAATTCAATCTCCATATC\\r\\nAACTTTACTAACTCTAAACC\\r\\nTACATTACTTTCTCTTTACC\\r\\nATCAATACAAACACTAATCC\\r\\nATCTATTCTATCACTATACC\\r\\nATCTTAACAAACTCATATCC\\r\\nAACTTTTCATACTCAATTCC\\r\\nTTCATTTCATTCACCTTACA\\r\\nATCTTTACTTACTCCTTACA\\r\\nATCATATCTTTCACCATTCT\\r\\nTTCTTATCAATCACCAATCA\\r\\nATCTAAACAATCACTTACCA\\r\\nAACCTATTCAACCTTTCATT\\r\\nATCCAAATCTTCAAACAACA\\r\\nTACCATTTCTACAATCAACA\\r\\nTACATATCCAACATACAACA\\r\\nATCATTTCCATCAAACTACA\\r\\nTTCATAACCATCAATCATCA\\r\\nTTCAAAACATCCTTTCAACA\\r\\nAACTAATCAACTATCATCCA\\r\\nATCTTTTCAACAATCTTCCT\\r\\nTACATAACATCATACAACAC\\r\\nAACTTATCTTCTTTCAACAC\\r\\nTTCAAATCATCATTCATCTC\\r\\nTACATTTCTTCTTACATCTC\\r\\nATCCTTTACAACATTCACAA\\r\\nTTCTATTCCTTCTAACACAA\\r\\nTACTAAACCAACTAACTCAA\\r\\nTTCTTTACCATCTTTCACTA\\r\\nAACTATACATCCAAACACTA\\r\\nTTCCCATATCAACATCAAAT\\r\\nTTCCCAAATCTACTACTATT\\r\\nTACCCTATTCTACAACATTT\\r\\nAACCCTAATCATCTTCTATT\\r\\nTACCTATACCTACTTCAATT\\r\\nATCCTTAACCATCAACATAT\\r\\nTTCTTAACCTACTACCAATT\\r\\nATCATTACCTACAACCTAAT\\r\\nATCCCTTTTCTCATTTCATA\\r\\nTACCCATTTCACTTTACATA\\r\\nTTCCCTAAACACTTTTCATA\\r\\nAACCCTATACTCTTAACATA\\r\\nAACCTAATCCTCAATTCATA\\r\\nTTCCTATTCTCTAATCAAAC\\r\\nAACCATAACTCATTTCTACA\\r\\nTACAAACTATCATACTACCT\\r\\nAACAAACTTTCTTTCTTCAC\\r\\nAACATTCAAACTTACCACAA\\r\\nTTCTAACCAATCTACCAAAT\\r\\nATCAAACTTACCCTACTTTT\\r\\nTTCTAACATTCCAACCTATT\\r\\nTTCATACTAACCATCCAAAT\\r\\nTACATACATACCTACCTAAT\\r\\nAACTTACAATCCTTCCAAAT\\r\\nAACTAACTAACCTACAATAC\\r\\nTTCTTACTATCCTTCAATTC\\r\\nTACTATCTTACCTTCAAATC\\r\\nAACATACTTACCATCAATTC\\r\\nAACTATCATTCCTACTATTC\\r\\nAACAAACAAACAACCCAATT\\r\\nAACAATCATTCTTCCCAAAT\\r\\nTTCTTACATACAACCTATTC\\r\\nTTCATACAATCTACCAAATC\\r\\nTACAATCTATCATCCATTTC\\r\\nATCAATCAATCAACCTTATC\\r\\nAACAATCTTTCCATCTAACA\\r\\nATCTATCTTTCTTCCAAACA\\r\\nAACTATCTATCTACCTTTCA\\r\\nATCTAACTTACAACCATTCA\\r\\nTACATACTATCAACTTTCCA\\r\\nAACTTACTAACAACAAACAC\\r\\nCATCTATCATACACATAACT\\r\\nTTCAATCTAACCACTAAACT\\r\\nTTCAAACTAACTCTTATCCT\\r\\nTACTAACAATCTCTAAACCT\\r\\nTTCATTCAATCACAATACAC\\r\\nATCATACATTCACTAAACTC\\r\\nTACATTCATACACTATTCTC\\r\\nCAACATACTATCACAATCTA\\r\\nTACTTTCAATCCACTAACTT\\r\\nTACAATCAAACTCCTTACAT\\r\\nAACATTCTTACACCATACAT\\r\\nTTCTATCTAACACATACCTT\\r\\nATCTATCAAACACTTTCAAC\\r\\nATCAATCTTACTCTTACATC\\r\\nATCTAACAAACTCAAACATC\\r\\nTTCAAACATTCTCATACACA\\r\\nATCTTACTTTCTCAAACTCA\\r\\nTTCATTCTATCTCAATCACA\\r\\nCTTCTTACATTCTCTACTTA\\r\\nTACTAACTTTCCACATCTTA\\r\\nAACTTTCTATCCTCATCTTT\\r\\nTACTATCAATCTCCTTCTTA\\r\\nATCATTCATTCTCCATCTTA\\r\\nTACATTCTAACTCCTACTTT\\r\\nTACTTACTTACTCAACCATA\\r\\nAACTAACATACACAACCTTT\\r\\nATCTTACAAACCTCACTTTA\\r\\nTTCTATCATACCTCTCTTTT\\r\\nAACTTTCATTCCACACTATA\\r\\nATCATACTTTCCTCACAATA\\r\\nAACATACAAACACCTCTTAA\\r\\nATCATTCTTTCTCTCTATAC\\r\\nCTACAAACTACTTACTAATC\\r\\nTTCAATCATCAATCCTATTC\\r\\nCTACTATCAACATTCAATCA\\r\\nCATCATTCTACATACAATCA\\r\\nATCCTAACATCTATCAATCA\\r\\nTACTTTCTTCTTTCCTAACA\\r\\nATCTTTCATCTAACCTATCA\\r\\nTTCTTTCAACTTACCTTACT\\r\\nTTCTAACTACATACAAACCA\\r\\nCTACATTCAACATACTTCAA\\r\\nCATCAATCTACATTCTTCTA\\r\\nCTACTTACTACTTTCATCAA\\r\\nCTACTTTCTTCATTCTACTA\\r\\nTACAAACATCCTAACATCTA\\r\\nATCAAACAACAAACCAACAA\\r\\nTACTTACATCAAACCTACAA\\r\\nATCTTTCTACTAACCATCAA\\r\\nCTACAATCATCTTTCTCAAA\\r\\nAACATACCAACTTCATTACT\\r\\nCTTCTAACTACAACATACAT\\r\\nCTACATACTTCAACTATCTT\\r\\nCAACATTCATCATCATTCTT\\r\\nTTCCATACAACATCATACAT\\r\\nTACCTAACAACTACTTACAT\\r\\nAACCATACATCTTCTTACTT\\r\\nCAACAAACAACAACATCATA\\r\\nCAACTATCTTCATCTTCATA\\r\\nCAACAATCTTCTACAACATT\\r\\nTACCTTACATCTACATCATT\\r\\nATCCTATCTACTTCAACATT\\r\\nAACCTTTCTACAACTTCATT\\r\\nAACCTTACTTCATCAACTTT\\r\\nAACCTATCATCAACTACTAT\\r\\nTTCATACCATCAACATCTTT\\r\\nTTCAATCCTACATCATCATT\\r\\nTTCAAACCTACTACTACTTT\\r\\nTACTATCCAACTACAACTAT\\r\\nATCAATCCATCTACTACAAT\\r\\nAACAATCCAACATCTTCTAT\\r\\nCTACTAACTTCTTCACTATA\\r\\nAACCAATCAACAACTCTATA\\r\\nTACAATCCTTCTACTCAATA\\r\\nAACTAACCTTCTTCTCTATT\\r\\nAACATTCCATCATCTCAATT\\r\\nTACATTCCTTCAACACTAAT\\r\\nCATCTTTCAACTCAACTATT\\r\\nCCTTCAAACTCAATTCTTTA\\r\\nCCTACAAACACTATACATTT\\r\\nCTACCTAACACTTATCATTT\\r\\nCTTCTTTCTCTTTACTCAAA\\r\\nCATCATACTCATTACTCTTA\\r\\nCATCTAACACTTTACACTAA\\r\\nCATCTTACTCTAATCTCATA\\r\\nCTTCATTCTCAAATCTCAAT\\r\\nCTTCTATCTCAAAACACTAA\\r\\nAACCAAACACAAAACTCTAA\\r\\nTTCCTTTCACAATACTCTAA\\r\\nTTCCAATCACTAAACTCATA\\r\\nTTCCAAACTCAATTCTCTTA\\r\\nTACCATTCACATATCTCTTA\\r\\nATCCTTACACATAACTCAAT\\r\\nAACCTAACTCTTAACTCTTT\\r\\nAACCATTCTCTAAACACTTA\\r\\nATCTATCCACTATTCTCTAA\\r\\nTACAAACCACAATTCACTAA\\r\\nTACTTTCCACTTATCTCTAT\\r\\nTTCTTACCACTTTTCACTTA\\r\\nTTCTTTCCTCTATACTCATA\\r\\nAACTATCCTCATATCACTAA\\r\\nATCATTCCTCTTTTCTCTTT\\r\\nTTCTTTCTCTAATCACCAAA\\r\\nTTCCTATCACAATCTACATT\\r\\nTACTTACCTCTAACTACATT\\r\\nTTCCTTACTCAAACTCAATT\\r\\nTACCATACTCTTACACTATT\\r\\nTACCAATCTCTAACACATAT\\r\\nTACTAACCACTATCACTTTT\\r\\nAACAAACCTCTCATAACATA\\r\\nAACTTCAAACAATCCATACA\\r\\nAACAACTAACTTCTATACTC\\r\\nAACAACCTATCTTCTAACAT\\r\\nTTCATCAAACATCTATCCTT\\r\\nTTCAACATACTACAATCCAT\\r\\nTACTACAATCAACTTACCAT\\r\\nAACTACTATCATCATTCTTC\\r\\nAACATCATTCAACTTTCTTC\\r\\nAACTTCATTCTTCATTCACA\\r\\nTACTTCTATCTACTTTCTCA\\r\\nTACTTCTTACATCATACTCA\\r\\nATCTTCAATCTTCTAACTCA\\r\\nAACATCTTTCATCAAACACT\\r\\nAACTTCTAACTACATACACT\\r\\nTACATCAATCCATCTACTTT\\r\\nATCAACTATCCAACTTCTTT\\r\\nAACTACATACCTACTTCAAT\\r\\nAACAACAAACTACTTCCTAA\\r\\nTTCATCCATACATCACATTT\\r\\nTACTACCTTACTACACATTT\\r\\nTACATCTTACCATCACTATT\\r\\nAACATCTATCCTACACTTTT\\r\\nAACAACATTCCTTCACATAT\\r\\nTACAACTTTCACAATACACA\\r\\nATCTTCTTTCTCAATACTCA\\r\\nATCTACTTACACTATTCACA\\r\\nTTCATCTAACACAAAACTCA\\r\\nTTCAACAATCTCTATACTCA\\r\\nTTCAACTTACTCATTACTCT\\r\\nTACTACATTCTCAAATCTCA\\r\\nATCAACCTAACACTTACTAT\\r\\nTTCTACAAACACAATCTACA\\r\\nTTCATCATACACTTTCTACT\\r\\nAACTACCAATCTCATCATAT\\r\\nTACATCTACATTCTATCACA\\r\\nTTCAACTACCATACATCAAT\\r\\nTACAACAACATTCAACCTTA\\r\\nATCATCTACTATCAACTTAC\\r\\nATCTACAACCTAACACTTAT\\r\\nTTCATCTTCATTCCTCATTA\\r\\nAACTTCTTCTTTCACCATTA\\r\\nTACTACTTCTATCTCCTTTT\\r\\nAACATCAACAATCACTTAAC\\r\\nTACAACTACTTTCACATAAC\\r\\nATCATCAACTACTATCTACA\\r\\nTACATCATCTACAAACTTCA\\r\\nTTCTTCTACTACTTACTACT\\r\\nATCTTCATCTTCTTACTTCA\\r\\nTACCAACTACAACTTCTTTT\\r\\nAACCTACAACATCATCTTAT\\r\\nTACAACATCCAACTTCATAT\\r\\nTACTACTACAACCTACATAT\\r\\nAACTACAACTACCTTCTAAT\\r\\nTACTTCAACATCAACCTTTT\\r\\nATCAACATCAACTTCCATAT\\r\\nTACTTCATCAACATCTATTC\\r\\nATCTACTACTACAACTTTTC\\r\\nATCTACATCATCTACATTTC\\r\\nATCATCATCATCAACTAATC\\r\\nAACAACTTCTTCTACAAATC\\r\\nATCAACTTCATCTTCTAACA\\r\\nTTCTTCTTCAACTACTTACA\\r\\nATCAACAACTTCTTCATACT\\r\\nTTCTACTTCAACAACAACTA\\r\\nTTCTTCAACTCAAATCACAA\\r\\nCTTCAACTCAAATCTCATTT\\r\\nCTACTACTCAATACTCTATT\\r\\nCAACTACTCTTAACTCATTT\\r\\nCAACATCACATTACTCTTTT\\r\\nCAACAACTCATATCTCTAAT\\r\\nAACAACTCTTACTCATAACT\\r\\nATCAACACTACTACATCTAT\\r\\nAACATCACAACTCATTTCAT\\r\\nAACAACACACATTACACTTA\\r\\nTTCTACACACTTAACACTTT\\r\\nTTCATCACTCATTTCACATA\\r\\nTACTTCACACAAATCACTTA\\r\\nTACATCTCACTATACACATA\\r\\nATCAACTCACATTTCTCATT\\r\\nAACTACACTCAATCATTCAT\\r\\nATCTCATAACTAACCCATAT\\r\\nTACACTAAACTATCCTTTTC\\r\\nATCTCATTTCCATACATCAA\\r\\nAACACTTATCATTCCTACAA\\r\\nTACACTTTTCTTACCAACTA\\r\\nAACACTTTACTTACATCCAA\\r\\nTTCTCTATACTTCTTTCACA\\r\\nTACACTTAACTTCCATCATT\\r\\nAACACAAAACATCAACTCAA\\r\\nATCTCAAAACTCTTATCACA\\r\\nTACACATATCTCTAATCACA\\r\\nTACTCTAATCACTTATCTCA\\r\\nTTCTCTTAACTCTATTCTCA\\r\\nTTCTCAATACACTAAACTCA\\r\\nAACTCATTACTCTTTACTCA\\r\\nATCACAAATCACATTTCTCA\\r\\nTACACAATACTCAATCCTAT\\r\\nATCACTAATCTCATACTACA\\r\\nTACACTATTCACATACTTCT\\r\\nTTCACAATTCTCTTACATCA\\r\\nAACTCTTATCTCAAACATCA\\r\\nTTCTCTAAACTCATACACAA\\r\\nATCACTATACACAAACACAT\\r\\nATCTCTTTACTCAAACTCTA\\r\\nTACTCAAATCTCAATCTCAA\\r\\nTTCACATAACTCTTTCTCAA\\r\\nTTCTCTTTTCACATTCTCAA\\r\\nTACACATTACACATCCTAAT\\r\\nAACTCATATCACTACTTTTC\\r\\nTACTCTATTCTCATCTTACA\\r\\nATCTCAATTCACAACATACA\\r\\nAACACATTTCTCTTCTTACT\\r\\nAACTCTATCATTCATCCAAA\\r\\nTACTCATACTATCCACTTAA\\r\\nAACTCTTTCAATCCTCTTAT\\r\\nTTCACATTCTTTCTCTTAAC\\r\\nATCACTTTCTTACACATTAC\\r\\nTTCACTAACAAACACAAACA\\r\\nATCACATACTTCAACATATC\\r\\nAACTCTAACTACATCATATC\\r\\nAACACAATCTACTTCTTTTC\\r\\nTTCTCATTCTTCATCATACA\\r\\nATCTCTATCTACATCTTTCA\\r\\nTTCACAAACATCTTCATTCA\\r\\nTACTCTTACAACTTCAACAA\\r\\nATCTCTAACATCATCAACTA\\r\\nTTCACTTACTACTACTACTA\\r\\nAACTCAAACTTCTACTCTTT\\r\\nAACACTATCATCATCTCTTT\\r\\nATCACAATCAACTCTTACAT\\r\\nAACACTAACTTCTCTATCTT\\r\\nTACTCAATCACTTAACCTTT\\r\\nATCTCTTACTCATATCTCAA\\r\\nTTCTCAAACACATTACTCAA\\r\\nTTCTCATACACAAATCTCTT\\r\\nTACTCATTCACAATCATTCT\\r\\nAACACATACACTAACTACAA\\r\\nTTCACTATCTCAAACTCTTA\\r\\nTACACAAACTCTAACTCATT\\r\\nAACTCAACTACTCTATCAAT\\r\\nTACTCATCTCTTATCACATA\\r\\nTACTCTACTCATACAACAAT\\r\\nAACACTACACTTACTCTAAT\\r\\nACAAAACATACTCCACATTA\\r\\nACAAAACTTCTATCCTATCA\\r\\nACTATACATCCTTACTTCTA\\r\\nACTTATCTTCATACCATCTA\\r\\nTCTAAACAACCATTCTCATA\\r\\nTCTAATCAACTTTCCACAAA\\r\\nACAATTCAACATCTTTCCTT\\r\\nACATTACAACTACTATCATC\\r\\nTCATAACATCTACATTCTCT\\r\\nACATAACTTCATCTTACTCT\\r\\nACAATACCTACTTCTTCATT\\r\\nACAAATCTACCTTCATCAAT\\r\\nTCTTAACATCATCCTACATT\\r\\nTCTAATCTACATCCAACTTT\\r\\nTCTAAACTACTACCTTCATT\\r\\nTCATATCTACAACCTACAAT\\r\\nTCAATACTTCAACCATCAAT\\r\\nACAATACATCTTCCAACTAT\\r\\nTCTTTACAACAACATCCTAA\\r\\nACATTTCATCAACAACCTAT\\r\\nACTTTACTACTTCTACCTAA\\r\\nTCTATTCATCTTCATCCTTA\\r\\nACTATTCTTCAACTACTTAC\\r\\nACTATACTTCTTCAACATTC\\r\\nACAATTCTTCTACATCAACA\\r\\nACTTTTCAACAACTACACAA\\r\\nTCATATCATCATCTACTCAA\\r\\nACTTATCATCTACCTCTTTA\\r\\nACATTTCTTCATCCTCTATA\\r\\nACATTACTACATCACCATAT\\r\\nACTTTTCTACACAATTCTCA\\r\\nTCTTAACTTCTCTTTCATCA\\r\\nTCAAATCATCTCATTCTCTA\\r\\nTCAAAACACTTAACACCAAA\\r\\nACTTTACACTTTACTCCAAA\\r\\nACTTAACACATATCACCTAA\\r\\nACTAAACACAAAACTCCATA\\r\\nTCAATACACAATTCTCCAAA\\r\\nTCTATACACTAACTTACTTC\\r\\nACAATACTCAAACTTTCACT\\r\\nACTAATCACAATCCATCTAT\\r\\nTCAAATCTCTTTCCACTTTA\\r\\nTCTTATCTCAATCCACTATT\\r\\nTCAATTCACATTCCACAATT\\r\\nTCAAAACTCTAACCTCATTT\\r\\nTCATTACACATTCACCTATA\\r\\nACATATCACATACTCCAATA\\r\\nTCTTTTCTCATACACCTTTT\\r\\nACTATTCACAAACTCATAAC\\r\\nTCATTTCACTATCTCATTAC\\r\\nTCAATTCTCATTCTCATATC\\r\\nTCTTATCACTAACACATATC\\r\\nTCTATTCTCTTACTCTTTAC\\r\\nACTAAACTCAATCTCTTATC\\r\\nACTAATCTCTAACTCAATTC\\r\\nTCTTTTCACTTTCTCAAACA\\r\\nTCATTACTCTATCACTAACA\\r\\nTCTATACTCATTCACAATCA\\r\\nACATAACACAATCTCAACAA\\r\\nTCATTTCTCAAACACTCTAA\\r\\nACTTAACTCTACAACATTCA\\r\\nTCTTTACTCTTCAACTATCT\\r\\nTCATAACTCTTCTTCTACAA\\r\\nACAAATCACTTCATCTACTA\\r\\nACATATCTCTACTACACTTT\\r\\nTCTAACATACATCTTCCTTA\\r\\nACATTCATTCATCCACAAAT\\r\\nACAATCAAACCTCATTCTAT\\r\\nACAAACTAACACTAACTTCA\\r\\nTCTATCAATCACTATCTTCA\\r\\nACTTACATACTCTATCTCTA\\r\\nTCATACTATCTCATCATTCA\\r\\nACAAACAACAACCAACAATT\\r\\nACATACAACATCTACCTTAT\\r\\nTCAATCTACAACTACATATC\\r\\nTCAAACTACATCTCAATACT\\r\\nACAAACATCTTCACTTTCTT\\r\\nTCATACATCTACTCAACAAT\\r\\nACTTACTACTTCACAACTTT\\r\\nTCTAACAACACTAAACTCAA\\r\\nACTTTCAACACAAAACTCTT\\r\\nACTTACAACTCTTTACTCTA\\r\\nACTATCTACTCTATACTCAT\\r\\nACTATCATCACTAATCACTA\\r\\nACTAACTACACAATACACTA\\r\\nACTAACATCACAATTCTCAT\\r\\nTCAATCATCTCTTAACTCTA\\r\\nTCTTACATCACTTTACACAT\\r\\nTCAAACTTCACAAACTACTA\\r\\nACTTACTTCACTAACACATA\\r\\nTCATTCTTCTCTTACACATT\\r\\nTCTAACTTCTCAATCACATT\\r\\nTCTTTCTACACTATCACTTT\\r\\nACATACTACTCAAACACAAT\\r\\nACTTTCATCACATTCACATT\\r\\nACTAACACATTCACTCATAT\\r\\nTCAACATTCAACTCAATCAT\\r\\nACTACATACTACACATTCAT\\r\\nACAACTATCAACACTTCTAT\\r\\nTCAACATACTCAATACTCTA\\r\\nACTACATTCTCTTTTCTCTA\\r\\nTCTACTAACACATACTCAAT\\r\\nACTACAATCTCATACACTAT\\r\\nACATCTTACACTTACTCATT\\r\\nACAACTAACTCAACTCTTAT\\r\\nACTCTAAACTTACCACTATA\\r\\nTCACTTAACTACTTCAATCT\\r\\nTCACATAACAACATCAACAA\\r\\nACACAAATCACATATCACTA\\r\\nTCTCAATTCACATTTCTCTT\\r\\nTCACAATACACTTTCACAAT\\r\\nACTCAATACTCATTCACTTT\\r\\nACACTATACACATCACTTAT\\r\\nTATCACCCATAACCTACTAT\\r\\nTTACACCCTTTACCACATTT\\r\\nAAACTCCCTATACACTTTAC\\r\\nTTTCTCCCTTAACACTATAC\\r\\nTAACACCCTAATCACTATTC\\r\\nCTTTCTCCTATCTACTATCA\\r\\nCATACTCCATACTTCTATCA\\r\\nCATTCACCTTTCTTCTTTCT\\r\\nAATCCCACATACTCTTCTTT\\r\\nCTAACACACATACACAATAC\\r\\nCTAACTCACACTATTCTCTT\\r\\nTTCCCAATTCCTATCAACTT\\r\\nAACCCTTAACACATAACTCA\\r\\nATCCCAAAACACTATCATCA\\r\\nTACCCTTTACACTTACACTA\\r\\nTACCCTTATCACAATCACTT\\r\\nAACCCATAACACTTCTTCAA\\r\\nTACATACCCTAATCCTAATC\\r\\nATCAAACCCAAATCCTTTCA\\r\\nATCATACCTATTCCCAAACA\\r\\nTTCTATCCCAATACCTTCAA\\r\\nAACTTACCCAATTCCTTCTA\\r\\nAACTTTCCCATTACCATCAT\\r\\nTTCATTCCCATACTCAATAC\\r\\nATCTTACCCTTACTCATTTC\\r\\nATCTTTCCCTATCTCTAACA\\r\\nATCTAACCCATTCTCTATCT\\r\\nTTCCATTCTTCCTTTCTTCA\\r\\nATCCATACTACCTTTCACAA\\r\\nATCCAATCCATCTACTTTCT\\r\\nTACCAAACTTCCAACAATCA\\r\\nTACCTTTCATCTTCCATTCA\\r\\nATCCAAACATCAACCACATA\\r\\nCAACCAAACAACACAAATCT\\r\\nCATCAAACCTACACTTTCAT\\r\\nCAACCATACAACTCTCTTAT\\r\\nCAACTTTCCACAATCTAACT\\r\\nTACCTATCTCCAATCAACAT\\r\\nATCCTTTCTCAATCCAACAA\\r\\nAACATCCAATACCCTTTACT\\r\\nTTCTTCCAAATCCCTCAATT\\r\\nTACATCCTTAACCCTCTATT\\r\\nTTCTTCATACCCTAACAACA\\r\\nTTCATCCTTTCTACATACCA\\r\\nAACTACTTTCCCTACATTCT\\r\\nTTCTACTAACCTTCCAATCT\\r\\nTACATCCATTCATCCTTCAA\\r\\nTTCCATCATTCACATATCTC\\r\\nAACTTCCTATCACATTTCTC\\r\\nAACCAACTTTCACTATCTCA\\r\\nTACTTCCTTACACTAACTCT\\r\\nATCCTACTATCTCTTCCATA\\r\\nATCATCCTAACTCATCTTTC\\r\\nTTCAACCATTCACCTCAAAT\\r\\nAACAACCAAACACACAATTC\\r\\nTTCTACCATACTCACATTTC\\r\\nATCCAACATCAACCTTCTAT\\r\\nAACCTTCAACTACAACTAAC\\r\\nTTCTTCCTTCTTCTTCTTAC\\r\\nATCTACCTACAACAACTACA\\r\\nAACCTACTTCTACCACTTTT\\r\\nAACCATCTACTTCCACATAT\\r\\nTACTTCCATCAACTCCATTT\\r\\nTACAACCTTCTACTCTATTC\\r\\nAACATCCTACTTCACTAATC\\r\\nTACAACCATCTACTCATACA\\r\\nTACTACCATCATCACTTTCA\\r\\nTTCTACCTTCAACACAACAA\\r\\nTACCATCAACACATTCATCA\\r\\nTACCAACAACTCTAACATCT\\r\\nTTCCATCTTCACTAACACTT\\r\\nATCAACCAACTCATTCACTA\\r\\nATCTTCCTACACATACACTT\\r\\nTTCCTTCTACTCATCTATCA\\r\\nAACCTTCTTCTCAACTTTCT\\r\\nTACCTACTACTCTTCAAACT\\r\\nTTCCTTCATCACAACTAACT\\r\\nTTCCTACATCTCTACATCTA\\r\\nAACCATCATCACTTCATCTA\\r\\nTTCCAACTTCACATCTTCTA\\r\\nTTCAACCTCTAACACTTTTC\\r\\nCAACTACACTATCACATACA\\r\\nTACATCACCATACACTATCA\\r\\nTACTACACAAACCTCTTACA\\r\\nAACTTCTCAAACCACATTCA\\r\\nAACTACCTCAATCACATCAA\\r\\nTACAACTCAACCTTCCTAAT\\r\\nTACTACTCATCCTACAAACT\\r\\nATCTACACTTCCATCAAACT\\r\\nAACTTCACTACCAACTTACT\\r\\nAACATCTCTACATCTTACCA\\r\\nTTCTTCACATCCATCATCTA\\r\\nATCATCTCAACCAACATCTT\\r\\nTTCTTCTCTACCTTCTTCTT\\r\\nTTCTACTCAACATCCATCAA\\r\\nTTCAACACAACTTCCTACTA\\r\\nTTCAACTCTACTACCAACAT\\r\\nATCATCACATCATCCTCAAA\\r\\nTTCATCTCTTCTTCCTCTTA\\r\\nATCTTCTCATCACTAATCTC\\r\\nAACTACTCTTCTCTAACTTC\\r\\nATCTTCACTTCACTACCTTA\\r\\nTACTTCTCTTCACATCCATA\\r\\nATCTACTCTACACTTCCATT\\r\\nTACAACACTTCTCTTCAAAC\\r\\nTACACCAAACAACACTTACA\\r\\nAACACCTTTCAACTCTTTCA\\r\\nAACCTCATTCTCTATCACTT\\r\\nAACCTCAAACTCTACTTATC\\r\\nTTCCTCTAACTCAACTACTT\\r\\nTACCACTATCACATCATCAT\\r\\nAACCACTAACTCTCTTCAAT\\r\\nATCACAACTTCCTACATACT\\r\\nATCTCATCTTCAACCTAACA\\r\\nTTCACATCATCCAACTACAT\\r\\nTACACTTCAACCTACTTCTT\\r\\nATCACTACTTCTACCTACTA\\r\\nAACACAACTACATCCAACTA\\r\\nTTCTCATCAACCATCTCATT\\r\\nTACTCAACATCACTTTTCTC\\r\\nTTCACTTCTACACAATCTTC\\r\\nAACACATCAACTCTTTCATC\\r\\nTTCTCTACAACTCTACCATT\\r\\nTACACAACAACACAACAAAC\\r\\nAACTCATCATCACATCAATC\\r\\nTACTCTTCAACACTACATTC\\r\\nATCACTTCATCTCAACAACA\\r\\nTTCTCTTCTTCTCATCTACT\\r\\nTTCACTACAACACTTCACAA\\r\\nATCTCTACTTCACACTTCAA\\r\\nTTCTCAACACTAACCTTTCT\\r\\nTTCACAACACATTCCATCTA\\r\\nAACACTTCTCATACTACTAC\\r\\nAACTCTTCTCTATCTTCTTC\\r\\nATCTCAACTCTTTCTACTCA\\r\\nATCTCTTCACTTACCACAAA\\r\\nAACTCTACACAAACCTCATA\\r\\nTACACATCTCATTCACCTTA\\r\\nTACACTACTCTATCACACAA\\r\\nAACTCACTATCACTTCCTTT\\r\\nAACACACTTACACATCTACA\\r\\nAACTCTCTATCACCACTAAT\\r\\nAACACACAATCACTCATTCA\\r\\nATCACTCAACCTAACTCTAT\\r\\nAACACTCTTCTCTAACTCTT\\r\\nATCTCTCTACTCTACAATCT\\r\\nTTCACACTACACTACATCAT\\r\\nATCTCACATCTCAACATCAT\\r\\nATCACACTTCACTTCTACTT\\r\\nTCATTACCTATCCACCATTT\\r\\nACAAATCCCAAACTCTATCA\\r\\nACTTATCCTAACTCCAATCA\\r\\nTCTAAACCATCTTCAAACTC\\r\\nCTCTAAACTACCTACTACAT\\r\\nCACAATTCTACCATCTACAT\\r\\nACATTTCCAACAACCTTCTA\\r\\nTCTATACCCATCAACACTAT\\r\\nACAATTCCCAACTTCTCAAT\\r\\nACAAAACCTTCATCCACTAA\\r\\nACCATTTCTACTCAATCTCT\\r\\nCACAAATCTACTCCTTCAAT\\r\\nTCATATCCTACTCATCCATT\\r\\nTCAATTCCTACACTACCAAT\\r\\nTCTTTACCTTCACTTCAACA\\r\\nACTTAACCAACACATCATCA\\r\\nTCTTTTCCATCTCTACTACT\\r\\nACATAACCATCACTCCTTAT\\r\\nTCTATTCCAACTCACAAATC\\r\\nCACAATACATCACACTACAA\\r\\nCACTAAACTCCTATCTTTCT\\r\\nTCCAATACACAATCCTTACT\\r\\nCTCTATACACTATCCATCTT\\r\\nCTCATATCACATACCTACAT\\r\\nCTCAATTCTCTTACCTCTAA\\r\\nCACATAACTCTAACCACTAA\\r\\nCTCTATTCACAAACTCCTAA\\r\\nCACATTTCACTTTCTCCTAA\\r\\nCACAAAACACATACACCTAA\\r\\nCTCTTAACTCATTCTCATAC\\r\\nCTCTTTACACTTTCACAATC\\r\\nACCATAACACCTTTCACTAT\\r\\nACCTAATCACATTCTCCTTA\\r\\nTCCAATTCACTATCTCCATA\\r\\nACCTTATCTCTTTCACCTAT\\r\\nACTATACCACAAACACCTTA\\r\\nACTAATCCACATTCACTTCA\\r\\nCTCATTACTCATCAACCAAT\\r\\nCTCAAATCTCAACTTCCAAT\\r\\nCACTTAACACTACTACCTAT\\r\\nCACTAATCTCTTCTACATAC\\r\\nCTCATTTCTCTACTTCTCAA\\r\\nCACATATCTCATCTCAAATC\\r\\nACCTAAACACTTCTCCATAT\\r\\nACCATTACACTACACTTATC\\r\\nCTCAATACTCTACACATACT\\r\\nCACTTATCACTTCACATTCT\\r\\nTCCTTTACTCTTCTCAATCA\\r\\nTCCTTTTCACATCTCTTTCT\\r\\nCACTATACTCAACTCATCAA\\r\\nCACTTTTCTCATCACAACAT\\r\\nTCCAAATCACAACACATCTA\\r\\nACCAAAACTCTTCACTTCTA\\r\\nACCTATTCTCACTACACAAT\\r\\nTCAAATCCACTCATCACTAT\\r\\nACTAACAAACCCATTCTACA\\r\\nACTAACTTACCTTCTATCCA\\r\\nTCAAACAATCCCTTCAACTA\\r\\nTCATACAAACCTTCAACCAA\\r\\nACATTCTAACCAACAACCTA\\r\\nTCTTTCATTCCATCAACCTA\\r\\nACAATCTTTCCCATCACAAT\\r\\nACTATCTTACTCCAATCAAC\\r\\nTCTAACTAACCACTTACACT\\r\\nACAAACTTTCCACTATCACT\\r\\nACAATCTATCTCCTACCTTT\\r\\nACTTTCTATCCACTACAACA\\r\\nTCTTACAATCCTCAACATCA\\r\\nACATTCTTTCCTCTTCTTCA\\r\\nACAATCATACCTCTACACTA\\r\\nTCATTCTACCATTCCTCTAA\\r\\nTCTTTCTTCCAAACCACTTA\\r\\nTCATTCATCCAATCCTCATT\\r\\nTCAATCTTCCTATCACCATA\\r\\nACATACTTCCTTACACCATT\\r\\nTCTATCTTCTACCATACTAC\\r\\nTCATTCAACCTACATCCTTT\\r\\nACTATCAACTTCCATCCAAT\\r\\nTCAATCAACCATCTTCAACT\\r\\nACATACCTACTACTCTTCAA\\r\\nACAAACCAACCACAAACATT\\r\\nTCTATCACTACTTCCAACTT\\r\\nACAAACTCATCTCCTCTTTT\\r\\nTCATACACTACACTCTTTTC\\r\\nTCTTACACATCTCACTATCT\\r\\nTCTTTCTCAACACACTCAAA\\r\\nTCTAACTCACTAACACCTAT\\r\\nACAATCTCTCAAACACTACA\\r\\nTCATTCACTCAACACTAACT\\r\\nTCAATCTCACAACTCTACAA\\r\\nACTATCACACATCACTACTA\\r\\nTCTAACACTCACTTACTCTT\\r\\nACAATCACACTCTTACTCAT\\r\\nACAACTTACTTTCCCTAACA\\r\\nACAACAAACCTATCCACTTA\\r\\nTCTTCATACCAAACTCTACA\\r\\nACTACTTTCTACTAACCACA\\r\\nACTTCTTACTTCCTACTAAC\\r\\nTCTTCAATCTTCCTTCTATC\\r\\nTCATCAAACCAACAACACAA\\r\\nACATCTTTCCAACATCTCAA\\r\\nACTTCATTCCATCTCATCTA\\r\\nTCTTCTAACACCATACATCA\\r\\nTCAACAATCACCAATCTCTA\\r\\nACATCTATCACCTATCTCAT\\r\\nACAACTTTCTCTATCCACAA\\r\\nTCTTCTTTCACTTTCCTCAA\\r\\nACATCATTCTCATTCCTCAT\\r\\nTCATCTAACTCTTACTCCAA\\r\\nACTTCTATCTCTTTCACCTA\\r\\nTCTACTATCACTATCTCTCA\\r\\nTCATCATACTCTACTAACCA\\r\\nACTACTTACTCTTCATCCAA\\r\\nACATCAATCCACTACTCTAT\\r\\nTCAACTACACATCCTCATAT\\r\\nACAACATCACTACTCAACTA\\r\\nACAACACAACACAACACATT\\r\\nACTCATTTCCTAACTCCTTA\\r\\nACTCATATCTACCAAACAAC\\r\\nACACTATTCATCATTCCTCT\\r\\nACACATTACCATCATCCTAT\\r\\nTCTCAAATCTCTAACCCTTT\\r\\nACTCTTTTCACATACCTCTA\\r\\nTCTCATAACACAATCCTCTA\\r\\nTCTCTATTCACTTACACCAA\\r\\nTCACTTTACACATTCTCCAA\\r\\nACACAAAACTCATACTCTCA\\r\\nACTCTTAACTCTACATTCCA\\r\\nTCTCTAATCACTACAAACTC\\r\\nTCACAATTCTCAACTAACTC\\r\\nTCACTAAACTCCAACTTCAT\\r\\nTCACATATCTCATCCTACTT\\r\\nACTCTTTACTCAACCATCTT\\r\\nACTCATTACACAACTACCAA\\r\\nACACATTTCTCTTCTACCTA\\r\\nTCTCAAAACACAACAACAAC\\r\\nACACTTTTCTCATCATCTCA\\r\\nTCACTTATCTCTACTTCTCT\\r\\nACTCTATCTAACACCTTCTT\\r\\nACACAATCACCACTTTCTAT\\r\\nCTATCCTTCATCCATCAAAC\\r\\nCATTCCTTCCTTCATCTCTA\\r\\nTTACTCCCTTTTCCCTTTCA\\r\\nATTCTCCCATTACCTAACCA\\r\\nATACTCCCAAAACCATACCT\\r\\nCTTACCACTAACCAACTCTA\\r\\nCTATCCTCTTACCACCTATT\\r\\nCTATCCACAATCTCTTTTCC\\r\\nCTTTCACCATTCCTCCAATT\\r\\nCAAACTCCATTCCACCTTAT\\r\\nTTACCACCTAACCTCTAATC\\r\\nAATCCACCAATCACATTACC\\r\\nCTTACCTCTATCCTCAATCT\\r\\nCTAACTCCTTTCCACAAACT\\r\\nCTATCACCTATCACCATACT\\r\\nAAACCCTCCATTCACTTACT\\r\\nTTACCCTCTAACCACTTTCT\\r\\nTTACCCACTTACACCTAACT\\r\\nTAACCTCCTTACCTCATTCT\\r\\nTTTCCTCCAAACTCCATTCT\\r\\nTATCTCCCAATCTCATTCCT\\r\\nTAACTCCCATACACTTACAC\\r\\nCAAACCTCATACCACAACTA\\r\\nCAATCACCATACCTCTTCTA\\r\\nTTACCTCCAATCCACTTCTT\\r\\nAATCACCCTATCTCATCCTA\\r\\nCTAACCACCTTTCACTCTTA\\r\\nCAAACCACAACCACAAACTT\\r\\nCAATCTCCTTCACAACTATC\\r\\nCAATCCTCTACTCTTCTACA\\r\\nCTTACTCCTTCTCAACTTCA\\r\\nCATACCTCAACTCCTCTAAT\\r\\nAAACCACCCAACACACAATT\\r\\nCATACACCTACTCTCATACT\\r\\nCATTCCACTACTCACTACAT\\r\\nCATTCTCCAACACTCTACTA\\r\\nTATCCACCTTCTCTCAACTT\\r\\nTTTCCACCTACACACACAAA\\r\\nATACCACCAACTCTCACATA\\r\\nCAAACACCTCATACCTCTTA\\r\\nCATTCTCACCTAACCTCAAA\\r\\nCTTACTCTCCTTTCCTCATA\\r\\nCTAACTCTCCAATCTCCTTT\\r\\nATACCTCCTCAATCTCTTTC\\r\\nCTTACACCACTAACTCTTCA\\r\\nTAACCACCACTTACACATCA\\r\\nAAACCCACACAACAAACTCT\\r\\nAACCCATTACCCTACAACTA\\r\\nCAACCTTTCATCCTAACTAC\\r\\nATCCCATACATCCATTCATC\\r\\nTACCCAATCATCTTACCCAT\\r\\nCATCCTAACAACCTTCATAC\\r\\nCAACTAACCTTCCAACATAC\\r\\nCTTCATACCAACATCCCAAA\\r\\nCTTCAATCCTTCTTCCCAAT\\r\\nTTCCCATTCTACCTACAAAC\\r\\nATCCATTCCTACCATCTAAC\\r\\nCTTCCTTTCAACCATCATCT\\r\\nAACCCAAACTACCAACACTA\\r\\nTTCCTAACCCTTCTACTCTA\\r\\nAACCCTTTCTTCACATTTCC\\r\\nATCCCTATCTTCTCAAACCA\\r\\nCTTCAAACCCAACACTCATA\\r\\nTACCCTAACCAACTCACAAA\\r\\nCAACTTACCTCTTTCCCATT\\r\\nTTCCCTTACCTCATCAATCT\\r\\nATCCCAATCTCTTCCACTTT\\r\\nTTCCCTTTCACAACACCATA\\r\\nATCCATCTATCCCAATACCA\\r\\nATCTACCAAACCCTAAACAC\\r\\nATCTTCCATTCCCTTCATCA\\r\\nAACATCCCTTTCCTCCTATT\\r\\nATCTACCCATTCTCCAACAT\\r\\nTACTTCCCTTACTCTCAAAC\\r\\nAACTTCCAACAACCTTACCA\\r\\nATCATCCAACTACCATTCCT\\r\\nAACCCTACATCTCTCATCAT\\r\\nCTTCATCTCTATCCCATACA\\r\\nCATCAACTCTTACCCAAACT\\r\\nCAACAACACTTTCCTAACAC\\r\\nCTTCTACACTTACCCTACAA\\r\\nCTACAACCTCTTACTCCTTT\\r\\nCTACAACACCAATCCACATA\\r\\nCAACATCTCCATACCACATT\\r\\nCATCTACACCATACTCCTAT\\r\\nCTACATCACCATTCACATCA\\r\\nCTTCAACACCTATCTCTCAA\\r\\nAACCAACACAACCCAAACTT\\r\\nCATCATCACTACCATTCACT\\r\\nCTTCTTCACATCCAACAACT\\r\\nCTACTACACATCCTTCTTCT\\r\\nCTTCATCACAACAACTACCA\\r\\nCTTCTACTCCTACTACACTT\\r\\nCTACATCTCAACCTCCTAAT\\r\\nCATCTACTCATCCACCTAAT\\r\\nCTACTTCTCATCACTTTACC\\r\\nCATCTTCTCTACACTATTCC\\r\\nCAACTTCACTTCTCATTTCC\\r\\nTACCATCTCATCTCTATTCC\\r\\nTACCTTCACAACTCCTTTCT\\r\\nATCCTTCACTACTCTAACAC\\r\\nCTACTTCACCATCTCTACTT\\r\\nCAACTTCTCTTCCACTACTT\\r\\nCATCAACACATCACAACCAA\\r\\nTTCCTACTCTACCACATCTT\\r\\nATCCTACACAACACTACCTA\\r\\nCTTCTTCTCCAACTCTCAAA\\r\\nCATCATCTCCTTCACTCAAT\\r\\nCATCTTCACCTTCTCACTAA\\r\\nCTACAACTCCTTCTCTCTAA\\r\\nATCCATCACCTACACACTAA\\r\\nATCCAACTCCATCACACAAT\\r\\nTTCCAACACTACCTCACTTA\\r\\nATCCTTCTCACATCTACCAA\\r\\nTACCTACACTCTTCTTCTCA\\r\\nTACCTTCTCTCAACAACTCA\\r\\nATCACCTAACCCTTCATCAT\\r\\nATCCACAAACTCAAAACCCA\\r\\nTACACCTATCCTCTAACATC\\r\\nAACCACTTTCTCCTATCTCT\\r\\nATCCTCTATCACTTTCCTCA\\r\\nAACCACAATCACAAACTCAC\\r\\nTTCTCCATTCCACATACTCT\\r\\nATCTCCTTACCACTAACACT\\r\\nATCCACATACACCTTCCTAT\\r\\nTACCTCAATCTCCATCTTAC\\r\\nTACCTCTTTCACTACCCATT\\r\\nATCACCATACTCCATCATAC\\r\\nTTCTCCAAACTCCAACTTTC\\r\\nATCTCCTAACTCCTTCAATC\\r\\nAACCTCTTACACCTACTACA\\r\\nTACCACATTCACCAACTACT\\r\\nTACACCATTCCTCATCAACT\\r\\nTTCACCTTACACAACCAACA\\r\\nTACACCCAAACTCTTCACTA\\r\\nTACTCCATACCACATCACAA\\r\\nAACTCCTATCACCTTCTCTA\\r\\nTTCACCAATCACCATCACTA\\r\\nTACTCCAATCTCACTTTTCC\\r\\nAACTCCTTTCACCTCAAACT\\r\\nCAACTCATCCTTTCTCACAA\\r\\nATCACATCCATCATCCTCAA\\r\\nAACCTCTACATCCCACTTAT\\r\\nAACACCTACTTCTCCCTAAT\\r\\nCTACACTTCTACTCCTATCT\\r\\nCAACTCTTCATCACATACCT\\r\\nATCTCCAACATCCTCTAACT\\r\\nCAACTCTACTTCCACATCAT\\r\\nCTTCTCAACAACTCATCAAC\\r\\nCTACTCTACCAACACACTTA\\r\\nCAACACAACCTTCACACATA\\r\\nCAACACTTCCTACACTCTTT\\r\\nCATCTCTTCTTCCTCTCTTA\\r\\nTTCCACATCCTACTCTCATA\\r\\nCATCTCTACCTCAATCACAT\\r\\nCTACTCAACTCTATCACCTA\\r\\nCAACTCAACACTTCCCTTAT\\r\\nCTACACTACACCATCTTCAT\\r\\nTTCACCTACACTTCATCTTC\\r\\nCTTCTCTTCACATCAACACA\\r\\nCAACACTACCACTTCTCTAT\\r\\nCTTCACATCTCAACCTCTTT\\r\\nCTTCACAACTCATCTCCAAT\\r\\nCATCACTTCTCTACACCAAT\\r\\nTACACCTTCACTTCTCCATT\\r\\nCTACACAACACATCTCTTCA\\r\\nTACTCCTACTCATCACAACA\\r\\nCTTCTCTACACACTACTTTC\\r\\nCTACTCATCTCACATCTTCT\\r\\nAACACCATCACTCTACATCA\\r\\nATCACCAACACACAACTTCT\\r\\nATCTCCATCACACTTCTCTT\\r\\nATCACCTTCTCACTCAACAT\\r\\nAACTCCAACTCTCTCTTCTT\\r\\nCATCACTACTCTCACACTAT\\r\\nTTCTCACTAACACCCTTACA\\r\\nTTCTCTCTTCCTTTCCACAA\\r\\nATCTCTCAACTTCCCATTTC\\r\\nAACACTCATCCAACATCCTA\\r\\nATCACACAACCTACAACCTT\\r\\nTTCACTCTACCATCCACAAT\\r\\nTACTCTCATCCTTCCACATT\\r\\nTACTCACAACTCCTACTCAT\\r\\nTTCACACATCACTCTAATCC\\r\\nTACTCACTTCTCACCTATCT\\r\\nTACACACTCCATTCCACTAT\\r\\nTACACACACTTCACTATCCA\\r\\nTACACTCTCATCCTCATCTT\\r\\nATCTCACTCAACACATCAAC\\r\\nTTCTCACACCTACTCACTTT\\r\\nATCACTCTCTACCTCTCATT\\r\\nAACTCTCACTTCCTCACAAT\\r\\nAACTCACACACAAACACCTA\\r\\nTACTCTCTCACTACTTCCAA\\r\\nTTCACTCACTCTACCACTTT\\r\\nCTCAAAACCTATCCTACCAA\\r\\nTCTAATCCCTAACCCAACAA\\r\\nACTAAACCCTTTCCCATCTA\\r\\nTCAATACCCAAACCCTACTA\\r\\nACTATTCCCTTACACCAATC\\r\\nCACTATTCATCCCTATTCCT\\r\\nCACTTTACAACCCAAATCAC\\r\\nCTCATAACAACCTAAACCCA\\r\\nTCCTTAACATCCCATAACTC\\r\\nTCCTAAACCTTCATCCCTTT\\r\\nACATTACCCTACATCCCTAT\\r\\nCTCTTATCCATCCTACATCT\\r\\nTCCATATCAACCCATCTTCA\\r\\nTCTTATCCCTACTTCCAACA\\r\\nACTTTTCCCTTCAACCTACA\\r\\nTCATAACCCTTCTACCTACT\\r\\nACCAAATCCTACTCTTATCC\\r\\nTCCTATACAACCTCCCATAT\\r\\nCTCTTTTCCTACACAATCCA\\r\\nACATATCCCATCTCATACCT\\r\\nTCAAAACCCTACTCATTCAC\\r\\nACCTTTACCTTCACCTACTT\\r\\nTCCTATTCCATCTCTTCCAA\\r\\nTCTTAACCCAACTCTACAAC\\r\\nTCCATTTCCCATCACTCATT\\r\\nACCTTAACCAACACTCAAAC\\r\\nCTCTAATCCTCAAACCTATC\\r\\nCACATTACCACTAACCTCAA\\r\\nTCCTAATCCACAAACCACAA\\r\\nACTTTACCCACTTACCTCAA\\r\\nTCATTTCCCACATACACCTA\\r\\nACCCTTATCACAACTTACCT\\r\\nACCCATATCACTTCCATCAT\\r\\nTCCCTTAACACTACCTCAAT\\r\\nTCCCATTTCACTCATCACTT\\r\\nACCCTAAACACTCTCTTACT\\r\\nTCTAACCTTTCCCAAAACCT\\r\\nACAATCCTTACCCATTACCT\\r\\nTCTTACTATCCCTTAACCCA\\r\\nACATACATTCCCTTTTCCCA\\r\\nACTTTCTTACCCATAACCCT\\r\\nACCTAACTATCCCTACTATC\\r\\nTCTATCTAACCCAACCATCA\\r\\nTCTATCATTCCCAACCTCTA\\r\\nTCTTACCTAACCTCCAAACT\\r\\nTCAATCCAATCCTCCTAACT\\r\\nACTTACCATTCCTCTTTCCA\\r\\nTCAAACCATACCACTTTCCT\\r\\nTCTTTCAAACCCTCATACAC\\r\\nTCAAACATACCCACATACTC\\r\\nTCATTCCAAACCACTTCCTA\\r\\nTCCTTTCATACCCTCACATT\\r\\nTCTAACCCATACTCCTCTTT\\r\\nACCAATCTTCTTCCTATTCC\\r\\nACCAAACTTCCATCTTCCTA\\r\\nACCTATCAACCATCATCCTT\\r\\nACCATTCTTCCTACTACCTT\\r\\nTCTATCCTACCTACATCCTT\\r\\nACCTTACTTCCAACTCCAAT\\r\\nACCAATCAACCTTCTCTTAC\\r\\nACTAACCATCCATCCTCTAT\\r\\nTCTTTCCAACCAACTCATAC\\r\\nTCCTATCTACCAACACAACA\\r\\nTCCATACATCACATATCCCA\\r\\nACAAACCTTCACAAATCCCA\\r\\nTCCTATCATCCACTTCATTC\\r\\nACTAACCTACACTTCCCTAT\\r\\nTCCTTACAACCTCTTCATCT\\r\\nTCATTCCTACTCAACAACCT\\r\\nTCCTTACTACCTCAACTCTT\\r\\nACCATTCAACTCTTCCTCTA\\r\\nACCTAACAACACTACCACTA\\r\\nTCTATCCATCCACATCTCTT\\r\\nACATTCCATCTCTTCCACTT\\r\\nTCCATACTACACACTTATCC\\r\\nACTATCCTTCTCTCAATCCA\\r\\nACAATCCATCACACAAACCT\\r\\nACTATCCAACACTCTATCAC\\r\\nACCATACAACTCACTACAAC\\r\\nTCAAACCTACCTCTCTACAT\\r\\nACATACCATCCTCACTTCAT\\r\\nTCTAACCAACACACATCTAC\\r\\nACATTCCTTCACTCATCTCT\\r\\nTCATACCTTCTCCACACTTT\\r\\nTCTTACCACATACCCTTTTC\\r\\nACTTACCTCATTCCCTATCA\\r\\nACTTTCCTCATACCCATACT\\r\\nACTTTCCACAATCATTCCCA\\r\\nTCATACCACTTTCAATCCCA\\r\\nTCAATCCTCAAACCTCAACA\\r\\nACAAACACCCTTTCACTACA\\r\\nTCATACTCCCATACACTTCA\\r\\nTCAAACTCTTCCCTTTACAC\\r\\nTCTATCTCATCCATTACCCA\\r\\nTCAAACACATCCTATTCCCA\\r\\nTCAATCACTTCCCAATCACT\\r\\nACATTCACCTACTCCATACT\\r\\nACATTCTCCATCACTACCAT\\r\\nTCTTTCACCTTCTCTTCTAC\\r\\nCTCAATCACATCTCCTCAAT\\r\\nCACTTACACTACACCTCTAT\\r\\nACTATCTCCTTCTCACCATT\\r\\nTCTTACTCCTTCACACAAAC\\r\\nACTTACACCAACTCACTAAC\\r\\nACATACACCATCACACACAA\\r\\nCACAAACTCACCTTTCCTAT\\r\\nCACAATCACTCAATCCACTA\\r\\nACTTTCTCCTCATACCACTT\\r\\nACTAACTCCTCAATCTCCAA\\r\\nTCATTCTCTCCATTCCACTA\\r\\nACTTACTCTCCTAACCACTA\\r\\nACTTTCACACCATTCACCAA\\r\\nACATACTCACCAATCTCACA\\r\\nCTCAATCTCTCTTCAACTCA\\r\\nCACTATCTCACTTCACCAAT\\r\\nCTCATACACACTACTCATCA\\r\\nCACTAACACTCACTTCTACT\\r\\nCTCTTTCACACTCAACACAT\\r\\nCTCTAACTCACACTCTCTTT\\r\\nCACATACTCACTCACTCTAT\\r\\nACTACCTTTCTCTACTCCTA\\r\\nACATCCTAACACCTCTCTAT\\r\\nACATCCAAACACTCACAAAC\\r\\nTCAACATCCACATTCCTACT\\r\\nACTACTTCCACTTTCTCTAC\\r\\nTCTACTACACCTATCCTCTT\\r\\nACAACAACTCCTTTCTCCTA\\r\\nTCTACATCTCCATACTCCTT\\r\\nACTTCATCCTCATTCTCTCA\\r\\nACATCTACTCCTTACACTCA\\r\\nTCTACTTCTCCAAACACTCA\\r\\nTCATCATCACATCCCAATCA\\r\\nACTTCTTCACAACCCTATCT\\r\\nACAACTTCTCTTCCTTTCCA\\r\\nTCATCTTCTCAACATACCCA\\r\\nTCATCAACCTCAACTTCCAT\\r\\nACTACAACTCAACCCTTCAA\\r\\nTCTTCAACACAACCAACCAA\\r\\nACTTCTACCTCTACTCCATT\\r\\nTCTTCATCACCTACACCTTT\\r\\nACTACATCACCATCTCCTAT\\r\\nTCAACTTCACCTTCACTTTC\\r\\nTCTTCTTCCTCTTCTCAACA\\r\\nACTTCAACCACAACTCAACA\\r\\nACAACTACTCCATCTCTACA\\r\\nTCAACAACACCTACTCTACT\\r\\nACATCATCTCCTTCTCATCA\\r\\nTCATCTACACTCTACCCAAT\\r\\nTCTTCTACTCTCTTCACACA\\r\\nTCTACAACACTCACTTCAAC\\r\\nTCTACTCATCACCTACACAT\\r\\nACTACTCTACACCATCTCAT\\r\\nTCTTCACTACTCACATTCCT\\r\\nACAACTCATCTCTCTTTCTC\\r\\nACAACTCTTCACACTACACA\\r\\nTCATCACTACCACTCACTAT\\r\\nACTACACATCCTCTCTCAAT\\r\\nACATCACTCTACTCTCTAAC\\r\\nACTCTATACCCTATCTCCTA\\r\\nACTCTTATCCCAACTCTCAA\\r\\nTCACTAATCCCTACTCACAT\\r\\nTCTCCATTCATCTCACTTAC\\r\\nACACATACACCCTTCTTATC\\r\\nACACAAACACCAACCAATTC\\r\\nTCTCAAACTCTACCCTAACT\\r\\nACTCATTCACTTCCAATCCA\\r\\nACACTATCTCTACAAACCCA\\r\\nTCACTAACACATCTAACCCA\\r\\nTCACTTTCACTACCCATCAA\\r\\nTCTCATACACTTCCCTTCAT\\r\\nTCACATTCTCCATCACCTTT\\r\\nACACATTCCACTACACTCAA\\r\\nTCTCATTCCTCAACACACAT\\r\\nTCACTTACTCCAACACTCTA\\r\\nACTCAATCACACTATACCCA\\r\\nTCACAATCTCACATCCATAC\\r\\nTCACTATCACTCAACCTCAT\\r\\nTCTCTAACTCACTCAACCAT\\r\\nACTCAAACACTCTCATCACA\\r\\nACTCATCTACACTCATACTC\\r\\nTCACTCATTCACACACTAAC\\r\\nTAACCCTCAATCCCTTATCC\\r\\nCCAAACCACAAACCCACAAA\\r\\nCCTATCCACTATCCCTCTAA\\r\\nCCAATCCACATTCTCCCTTA\\r\\nCCATTCCACTTACTCCCAAT\\r\\nCTATCCCACTAACCCTCTTA\\r\\nTATCCCACCAATCACCCTTA\\r\\nATTCCCACTACCCTATACCT\\r\\nAATCCCTCTACCAATACCCA\\r\\nAATCTCCCTACCCTTTCTCT\\r\\nCTTTCCTCAACCCTACAACT\\r\\nTATCCCTCATCTACCCAACA\\r\\nAAACCTCCATCCTTCTACCT\\r\\nAATCCTCCTACAACCCTACA\\r\\nCAATCCACTTCCTTCTCCTT\\r\\nATTCCACCATCCACCCTTAT\\r\\nAAACACCCAACCCACCAATT\\r\\nATTCACCCTTCACCTTTTCC\\r\\nCAAACCCACAACCACAATCT\\r\\nCTAACCTCTTCCTCTATCCT\\r\\nATACCCACAACACCTATCCA\\r\\nATTCCTCCTTCCTCAAACAC\\r\\nATACACCCATCTCCATTCCA\\r\\nCAAACCCTCTTCTCCTACAT\\r\\nCCTAACCTCTTCACCACTAT\\r\\nTATCCTCCACTTTCCCATTC\\r\\nTTTCACCCACAATCACCCTA\\r\\nCCTAACTCTCATCCATACCA\\r\\nCCAAACTCCACTTCCTTCAT\\r\\nCCTTACACTCTTCCCTACTT\\r\\nCCATACTCTCTACCATCCTA\\r\\nCCATTCACACTACCTACCTT\\r\\nTAACCCACTCATCCCTTCTA\\r\\nTTTCCCTCTCAACCTCCAAA\\r\\nCCTTTCACTCTACTCCTTCA\\r\\nTTTCCCACCTCTTCACACTA\\r\\nCCTATCTCTCTCATCCCATT\\r\\nCCATACACACACATCTACCA\\r\\nATTCCCTCACACAACTTCCA\\r\\nCCATTCTCACACTTCACCAT\\r\\nATACCCTCACTCTTCTCACA\\r\\nCCAAACACTCTCACAACACA\\r\\nCCTTTCTCTCACACTCTAAC\\r\\nCTTCCCAAATCCATCCTACA\\r\\nCTACCCTTAACCCTTCACAT\\r\\nTACCCATACCCTTCTTCCTT\\r\\nATCCCTAACTCCTACCAACA\\r\\nCCAACCAAACCACACAACTT\\r\\nAACCTACCTTCCCATCTATC\\r\\nTTCCTACCTACCCATCACAT\\r\\nTACCTACCATCTCATATCCC\\r\\nCTACATCCTACCTCTAACTC\\r\\nTACCCTACTTCCACAATCAC\\r\\nAACCCATCTACCTCAATCTC\\r\\nATCCCATCTTCTCCTATCCT\\r\\nTTCCTTCCTACCACATTCTC\\r\\nATCCAACCTTCCACTTACTC\\r\\nTTCCATCCATCACCCTTTCT\\r\\nTTCTTCCCAACTCCCATTCT\\r\\nAACAACCCAACACCAATCCT\\r\\nTTCTACCCTACACCTTTCCT\\r\\nATCAACCCATCACAAACCAC\\r\\nCATCAACCAACCTCTACTAC\\r\\nTTCCCATCAACACCCAACTA\\r\\nTTCATCCCATCCTCTACCTT\\r\\nAACTACCCTTCTCCCTACAT\\r\\nATCTTCCCTACTCCATCCAA\\r\\nCTTCTTCCCATCACCTCATT\\r\\nCTTCTACCCTTCACTCTTAC\\r\\nCATCCCAACTACACTCTCTA\\r\\nAACCTTCCAACCACTCACAA\\r\\nTACAACCCTCTTTCCCTTCA\\r\\nATCATCCCTCTATCCAACCT\\r\\nCTACTACCTCATTCCCACAA\\r\\nAACCAACCACTTCCTTCCAA\\r\\nATCCTACCACTACCAACCTA\\r\\nTACCTTCCTCATCCTTCACA\\r\\nAACCATCCTCAACCACCAAA\\r\\nATCCTTCCACATCCACCATT\\r\\nTACATCCCACAACCTCTACA\\r\\nAACCCAACACCACAACCATT\\r\\nCCTTCATCTCACTTCCTTCA\\r\\nCTACCAACTCTCTACCTCAT\\r\\nCCTACTTCACACTCCTTCTT\\r\\nCCAACATCTCTCTCTACCAT\\r\\nCTACCATCACACACAACTAC\\r\\nTACCATCCACACTCTTCATC\\r\\nTACTACCCACTCACCTTCAT\\r\\nTACCCATCACTCTCTCAATC\\r\\nCTTCCTACACACACTCACTA\\r\\nTACCAACCTCACTCTCTCTA\\r\\nTTCACCCATAACCCTTACCT\\r\\nATCTCCCAATTCCCATTCAC\\r\\nTTCTCCCTTACCACTATCTC\\r\\nTACACCCTATCCACTTCATC\\r\\nCTACTCTTCCCAAACTCCAA\\r\\nTACCTCATCCATCCTAACCT\\r\\nTTCACCATCTTCCCTTTCAC\\r\\nCTTCACTTCCATCCATCCTT\\r\\nTTCTCCTACCTTCCTACCTA\\r\\nTACTCCTTCCAACTACCCAA\\r\\nAACTCCATCCTTCTTCCTCT\\r\\nCATCACAACCAACCCACTAA\\r\\nTTCCACTTCCCTACACAATC\\r\\nATCACCCAACATCCCTCAAA\\r\\nAACTCCCATCTTCTCTACCA\\r\\nCTTCTCATCCCATCTCACTT\\r\\nATCCTCAACCTCATTCCCAT\\r\\nCAACACATCCACATACCACA\\r\\nCATCACATCACCATTCACCA\\r\\nTTCCTCTTCCTCAAACCACA\\r\\nTACCACTTCACCTTACTCCA\\r\\nTTCTCCTTCTCCTATCCTCA\\r\\nAACACCAACTCCATTCTCCA\\r\\nTTCCTCATCACCTTCACCTT\\r\\nTTCACCCTACTCTCAACATC\\r\\nAACACCCATCTCACACTTAC\\r\\nAACTCCTCCATCTTCCCTTT\\r\\nAACACCACATCACCTTCCTA\\r\\nCAACACCACACAACCAACTT\\r\\nATCACACCTCTTCCACCTAA\\r\\nTTCTCTCACCAACCACTTAC\\r\\nAACACACCACACCAAACCTT\\r\\nTACACTCACCTCTTTCCCTT\\r\\nAACACTCCACTCCTCTTCAT\\r\\nATCCTCACTCTCTCACATAC\\r\\nAACCACTCACTCACACATTC\\r\\nATCACTCCTCTCACTCAATC\\r\\nTCCATAACCCTAACCAACCA\\r\\nTCCCTTTTCCCAATCACCTT\\r\\nTCCCAATTCCTTCCCAACAT\\r\\nACCCTTTACCTACAACCCAA\\r\\nACCCAAATCCTTCAACCCTA\\r\\nTCCATTACCCATCCCATCAT\\r\\nACCCATAACCTTCCCTCATA\\r\\nACCTTTTCCCTACCCACTTA\\r\\nTCCAAAACCCTACCTCCTAA\\r\\nACCATATCCCTTCCTCCATA\\r\\nTCCTTATCCCAACTCCCTTT\\r\\nACCAATACCCTTCACCTTAC\\r\\nACCTATACCCAACCTCACTA\\r\\nACCAATTCCCTCTATCCCAT\\r\\nACCCTATACTCCAATCCACA\\r\\nTCCCATTACTCCTTTCCACT\\r\\nACCCTAATCTCCTAACTCCA\\r\\nACCTTTCTAACCCAACCAAC\\r\\nACCAAACAATCCCAACCTCA\\r\\nTCCCTTTCAAACACCCTTCA\\r\\nTCCATTCTACCCTATCCCTT\\r\\nACCATACTTCCCAATCACCA\\r\\nTCTTTCCTTCCCATACACCA\\r\\nTCCATTCATCCTACCCTTTC\\r\\nTCCTAACATCCCTACCTTCA\\r\\nTCCAAACTACCCATCCATCA\\r\\nTCCTAACTTCCTTCCCACTT\\r\\nACCTATCTTCCTCCAAACCT\\r\\nTCCAATCTACTCCCAAACAC\\r\\nCTCTATCTCCCTTACTCTAC\\r\\nCACAATCTCCTAACCCTCAA\\r\\nCACATTCTCCCATACACACA\\r\\nCACATACACTTCCCAATCAC\\r\\nCACTTACTCAACCCATTCTC\\r\\nCACTTTCTCCATCTACCCTA\\r\\nCACAAACACCATCCTCCTTA\\r\\nCTCTTACACCTTCCACTAAC\\r\\nCTCAAACTCCAACACCATCA\\r\\nCTCATTCTCAACTCCACCTA\\r\\nCACTAACTCCTCTTACCACA\\r\\nCTCATACTCCACATTCCACA\\r\\nCTCTATCACCACTTACCTCT\\r\\nCACATTCACTCCAAACCTCA\\r\\nCTCTTACTCTCCATACCTCT\\r\\nCTCTAACACACCAAACTCCA\\r\\nCTCAAACACTCCTTACACCT\\r\\nCACTATCACACCTACCATCA\\r\\nCTCATTCACACATCCCTACA\\r\\nTCCTTTCTCACCAACCTTCA\\r\\nCACTTTCACCACAACTCCTA\\r\\nTCCAATCACCTCAACACAAC\\r\\nACCTTTCACTCACATAACCC\\r\\nACCTTACACACACCAACAAC\\r\\nTCCAAACACACTCTTCCCAA\\r\\nTCTTCCATTCTCCCTTACAC\\r\\nTCCAACCTTACCTCATCCAT\\r\\nTCCTACCTTTCTCCAACACA\\r\\nTCTTCCTACTACCCATACAC\\r\\nTCATCCATCATCCTTTCCCA\\r\\nTCAACCTTCTTCAATCCCAC\\r\\nCACTTCTACCTACCCTTCTT\\r\\nACTACCTACCATCCACTCAA\\r\\nACATCTTCACCCTTTACCCA\\r\\nACCAACAACCACAATCCTCA\\r\\nTCCAACTTCCACTAACCTCT\\r\\nACTACCATCCACTTTCACCT\\r\\nCACTACATCCTCATCCTTCA\\r\\nCACATCTTCCACATCTCCAT\\r\\nTCCTACTTCCCACTACTCTT\\r\\nTCCTACTACCTCTACCACAT\\r\\nTCCATCATCCTCTACACCAT\\r\\nTCCATCTTCTCCATCCACTT\\r\\nACCAACATCTCCTTCACAAC\\r\\nTCCTACAACACCTTCTCATC\\r\\nACAACCTACCTCCTTCTCAT\\r\\nACTACTACCTCCTACTCATC\\r\\nACCATCTACCACATCACACA\\r\\nTCTTCCAACACCAACACACA\\r\\nTCCTACATCTCTCTTTACCC\\r\\nACATCAACACCCACTTCTCA\\r\\nTCATCCAACCTCTCTCTTCT\\r\\nACCTTCAACCACTCACTCAA\\r\\nTCAACCCAACTCTCACTCTA\\r\\nTCTTCTCAACCCTTATCCCT\\r\\nTCAACACTTCCCTTCCACAT\\r\\nTCTTCACATCCCAACTCAAC\\r\\nTCTTCTCTACCCAACACTTC\\r\\nTCTACTCTTCCACCATTTCC\\r\\nTCATCTCAACACCCTATCAC\\r\\nTCAACTCAACTCCCATCAAC\\r\\nACAACACTCCCTAACACTAC\\r\\nACATCTCTCCTACCACCTTA\\r\\nACAACCACACACCCAACATT\\r\\nTCAACTCTCTCTACCCTCTT\\r\\nACTTCACTCCTCAACTCACA\\r\\nACTTCTCTCCACACTAACCT\\r\\nACTTCTCACTCCTCATTCTC\\r\\nTCTACACACCTCACATCTCA\\r\\nTCATCACACCACACTTCACT\\r\\nACACCCAAAACCCACACATT\\r\\nACTCTTTCCTTCCATACCAC\\r\\nTCACATACCTACCCTTCAAC\\r\\nTCTCTATCCCTACACCACAA\\r\\nACACTAACCCATCTCCACAA\\r\\nTCCACTTTCACCTAACACCT\\r\\nTCACAAACTCCCTTTCTCCA\\r\\nTCTCTTACACCTTACCCACA\\r\\nACTCTTACCCACTACCTATC\\r\\nCACACATTCACTACCATCCA\\r\\nACCACAAACCACCAACATCT\\r\\nTCTCAATCTCCTACCTTCCT\\r\\nACTCCTATCACATCCTCCAA\\r\\nACACTTACCACCAACTCTAC\\r\\nACACTTTCTCCCATCTCCTT\\r\\nACTCCTTTCTCACAAATCCC\\r\\nCACACTTACACCTCTTACCT\\r\\nACACCAATCCTCTCTTACTC\\r\\nTCTCTTTCACCACATTCACC\\r\\nCTCTCAATCTCCACTACATC\\r\\nACCTCTTTCTCCTCAACCTT\\r\\nTCTCCAATCACACATCCCAA\\r\\nTCACCAAACTCCTCTTCACA\\r\\nACTCCATACACCACATCACA\\r\\nCACACTTTCCACACACATAC\\r\\nTCCACATACCTCACTCTATC\\r\\nTCTCCTTACCACTCTCATTC\\r\\nACACCTATCTCCTCTCAACT\\r\\nACACCATTCTCCACACACTA\\r\\nTCACTACTTCACCTTTTCCC\\r\\nACACTTCAACCTCCCTTACT\\r\\nTCACATCATCCTCCTTTCTC\\r\\nTCTCTACTTCCTCTATCCCA\\r\\nTCACTTCATCTCCAAACCCT\\r\\nACACAACTACTCCTAACCAC\\r\\nTCACAACATCTCCTTACACC\\r\\nACCTCTTCATCACCATCCAT\\r\\nACTCTTCATCCCACATCCAT\\r\\nTCACTTCTTCCCACTACTTC\\r\\nACTCTTCTTCACCCTACAAC\\r\\nACACATCTTCTCCTTCCCTT\\r\\nACTCTACAACCCTCTACACA\\r\\nTCTCAACATCCACCTACTCA\\r\\nTCCTCTACTACCACTCTTTC\\r\\nTCCACTACATCCTCACTACT\\r\\nTCTCATCTCACCTACACTAC\\r\\nTCACAACTCTCACTTACCCA\\r\\nACTCAACACTCTCATTCCAC\\r\\nACTCTACTCTCTCTACCTTC\\r\\nACACATCACTCTCTTCTCCA\\r\\nTCACATCTCTCACACCAACA\\r\\nTCACTCAAACACCTTACCAC\\r\\nACTCTCTACTCCATCTCTCT\\r\\nCCTTTCCTACCACCATCACA\\r\\nCCTTACCTTCCACAACTCCA\\r\\nCCTTTCCATCCCTCTCATCT\\r\\nCCATACCAACCTCACCTACA\\r\\nCCATTCCTCAACCAATCCAC\\r\\nCCTATCCTCATCCCTTCCTT\\r\\nCCATACCTCTACCCTACTAC\\r\\nCCAATCTCCAACCCTTCTAC\\r\\nCATACCACCATCCCATCTAC\\r\\nCCTAACCACTACCCTCAAAC\\r\\nCCTAACACCTACCTCCTTAC\\r\\nCTTTCCCACATCCCTCCTTT\\r\\nCTTTCCACCAACCACCATAC\\r\\nCTATCTCCCAACCCACCATA\\r\\nCCAATCACCCTACTCCACTA\\r\\nCTAACCCACCATCACCTCAA\\r\\nCCTATCACCACTATCCCACA\\r\\nCATACCCACTCATCCCATCA\\r\\nCCCAATCTCACAACCTCCTA\\r\\nCTTTCCCTCTCCTACACCTT\\r\\nCATTCCTCCCTCATCTCAAC\\r\\nCTAACACCCACTACCCACAA\\r\\nCCAAACCTCACCATCACTCA\\r\\nCTTACCCTCACTCCATACTC\\r\\nCCCATTCTCTCTCATCCCTA\\r\\nCATACCCTCTCTCCTACACA\\r\\nCTTACCCACACTCCAACTCT\\r\\nCAATCCCTCACACCTTCTCA\\r\\nCATTCCCACTCTCCACTACT\\r\\nCAATCCCACACACTCATCCA\\r\\nCTTCCCATTACCCTTCCAAC\\r\\nCAACCCAATTCCCTCCAAAC\\r\\nTTCCAACCATCCCAAACACC\\r\\nCCATCTACCATCCACTAACC\\r\\nCATCCCATCTACCCACAAAC\\r\\nCTACCCATCAACCCTCATTC\\r\\nCATCCAACCTACCACTTACC\\r\\nTTCCCAACCAACCTCATACC\\r\\nTTCAACCCTTCCCTCTTTCC\\r\\nCTACCCTACAACACCCATCA\\r\\nCCATCTTCCCTTCTCCTCAA\\r\\nCTTCAACCCATCCTCCTCTA\\r\\nCATCTTCCCTACACCACCAA\\r\\nCCTTCTACACCAAACCTCCA\\r\\nAACTTCCCACCTTCCCTATC\\r\\nCAACCTTCCACATCCACCAA\\r\\nCTTCCATCACCCTACTCCAT\\r\\nCAACAACCCTCTTCCCTCAA\\r\\nCTTCATCCCTCAACCCTCTA\\r\\nTACCCTTCCTCCATCACCAT\\r\\nCAACTTCCCTCTACCTCTCA\\r\\nAACCCTTCTCCCTTCTCTCT\\r\\nCTACCTTCTCTCCCTATCTC\\r\\nCTACCTACTCACCTATCCAC\\r\\nCTACTTCCCACTCTAACCTC\\r\\nTTCCCTACCTCACTTTCCCT\\r\\nCCAACAACCTCTCAACCTAC\\r\\nATCCCTACTCCCTCATCATC\\r\\nCCTTCAACTCCACCTTCACT\\r\\nCATCTACCCACACCATCTCA\\r\\nCAACTACCCTCACCTACACT\\r\\nTACCCAACTCACAACCCACA\\r\\nCCTACAACCACTCCCACATA\\r\\nCATCCCTTCTCTCTCCATTC\\r\\nCCAACTACCACTCACCTTCA\\r\\nCCTTCTTCTCCTCTCCAACA\\r\\nCTTCCCTTCACACACATCCA\\r\\nCAACCATCCACTCCACTTCA\\r\\nCAACATCCCACACTCCTACA\\r\\nTACCACAACCCATCCCTCTA\\r\\nATCCACTACCCAACCCACTT\\r\\nAACCCACAACCCACAATTCC\\r\\nTACTCCCTTCACCATACCTC\\r\\nATCTCCCTACACCCTTCCAT\\r\\nTTCCCTCAACCACCAACTCA\\r\\nTTCCACCTTCCCTCAACACT\\r\\nTACCTCCTACCCTCTTCTCT\\r\\nTACTCCCAACACCAACCACA\\r\\nTACCCTCTACCTCCTCCAAT\\r\\nTACCCACTTCCACTCTAACC\\r\\nATCCTCCTTCCTCACCAACT\\r\\nCTTCACTCCAATCTCCCATC\\r\\nTACCTCACAACCCTTAACCC\\r\\nATCTCCACATCCCTTACCCT\\r\\nCAACACACCTTCCCTCTAAC\\r\\nTTCCCACTCTTCCCACCTTT\\r\\nTACCACTCTACCCTCCATAC\\r\\nTACCTCTCTTCCACCTTTCC\\r\\nATCTCCTCATCCCACATACC\\r\\nTTCCACACTACCTCCCTACT\\r\\nTACTCACCAACCCTCAACCA\\r\\nCTACCTCACAACCTCTCCAA\\r\\nCTTCTCACCATCTCCACCAT\\r\\nTTCACCTCTCCAACCTACTC\\r\\nTTCTCTCCCACCTTCCATCT\\r\\nTTCTCACCTCCATCCCAACT\\r\\nCTTCTCTCCCACCTTCACTT\\r\\nAACCACACTCCTTCCTCCTA\\r\\nAACTCCACTCCTACTCCCAA\\r\\nCTACTCTCCTCTCTATCTCC\\r\\nATCCTCTCACCTCATACCCT\\r\\nTTCCACTCTCTCCATTCCCT\\r\\nTACCACACACTCCATACACC\\r\\nATCACCACTCTCCTTTCACC\\r\\nAACTCTCCACCTCTTACCTC\\r\\nTTCTCCTCCTCACCCATCTT\\r\\nCTTCTCCTCCACTCTACTCT\\r\\nTACTCTCCCTCACTACACCA\\r\\nATCTCTCCTCCTCTACTCCA\\r\\nCTACTCCTCTCACCCTCAAT\\r\\nCTACTCCACTCACCTCTATC\\r\\nAACCTCACCTCTCCTCCTAT\\r\\nATCACCTCACCCTCTCTATC\\r\\nTACTCCTCTCACCCTCTTAC\\r\\nATCTCACCACTCTCCCTTAC\\r\\nCATCACACCTCACCACAACA\\r\\nCAACACTCCACACCTCATCT\\r\\nCATCTCTCCACTCTCCTTCT\\r\\nTTCCTCTCTCCCACTCATCT\\r\\nTTCTCCACCTCCACTCAACT\\r\\nTTCACCACACCACCACATCA\\r\\nCTTCCTCACACACACCACTA\\r\\nTTCCTCCTCACCTCACACAT\\r\\nTTCCTCACACCTCTCACCAA\\r\\nTACACCACCACCTCTCACTA\\r\\nAACACCTCCACCACACTCTT\\r\\nTTCACACCCTCTCACCTCTA\\r\\nACCCTATTCCCAACCTCACA\\r\\nTCCCAAAACCCAACACCTCA\\r\\nACCCAATACCCACTTCCCTA\\r\\nCACTATCCCTTCCACCAAAC\\r\\nACCTATCCATCCCTCTATCC\\r\\nCACCATTCCAACACCACAAC\\r\\nCTCATTCCACCTACCACCTA\\r\\nACCCATACACACCTTTCCAC\\r\\nACAAACCCACCACCCAATCT\\r\\nTCTTTCCCTCACCATTCTCC\\r\\nTCTATCCCACTCCCTACCAT\\r\\nTCATTCCCTCTCCCAACTAC\\r\\nCCTCTATCACCTCCATCACT\\r\\nCACATACCTCTCCAACACCA\\r\\nTCTTACCCTCTCAACCACAC\\r\\nCCACTATCCTCTCCCTCTTT\\r\\nCACCAAACCACACCCACATT\\r\\nCTCCTTTCCTCACTCTTACC\\r\\nCACCATACCACACACTTTCC\\r\\nCTCTAACCTCCTCCCACTAT\\r\\nACCAATCCTCACCCACATAC\\r\\nCCACATACTCCTCCTCATCA\\r\\nCCACTAACTCCTCACAACCA\\r\\nTCCAATCCACCACTCTTCCA\\r\\nACCATACCACTCCACAACAC\\r\\nACTTACCCACACCTCATCAC\\r\\nTCAAACCCTCACACCATCAC\\r\\nCCACAAACCTCACACACCAA\\r\\nCCACTTACACTCCCACACAA\\r\\nACTATCCCTCCACACTCCAA\\r\\nACTTTCCCACACACCCACTA\\r\\nTCCCATACCTCTCTCACTCA\\r\\nACCATCAACCCTACCTCCAA\\r\\nTCCTTCTTCCCTTCACCCAA\\r\\nTCATCCTTCCCATCACACCT\\r\\nTCTACCTTCCACCCTAACTC\\r\\nTCATCCTACCACCTACCAAC\\r\\nTCAACCATCCTCCAACCATC\\r\\nTCCTTCATCCCTCATCTCCA\\r\\nTCTTCCCATCACCACTACCA\\r\\nTCATCCCTACCCACTCTCAT\\r\\nACCAACCTACTCCACTCACA\\r\\nCACAACCACCCACAACACTT\\r\\nCTCTTCTCCACCTACTCTCT\\r\\nACATCTCACCCTCTTCCTAC\\r\\nTCCATCTCTCCTCCACCAAT\\r\\nTCAACTCCTCCACCCTCTAT\\r\\nACAACACCACCACACCATTC\\r\\nTCCTACTCTCACTCCAACTC\\r\\nTCTTCACCTCACCTCCAACT\\r\\nACATCACCTCTCTCCTTCCA\\r\\nACCTTCTCACCACCTCACAA\\r\\nACCAACTCTCCACCACTCTA\\r\\nACCTTCACTCCACTCCTCAT\\r\\nACCTACTCACACCACTCCTA\\r\\nTCAACCACTCACCACACCTA\\r\\nTCAACACACCCACCTCTCAA\\r\\nACTACTCACCCACTCTCCTA\\r\\nACTTCACACCCTCACACCTT\\r\\nACCACATTCCACAAACCCAC\\r\\nTCTCCAAACCTCTAACCCAC\\r\\nTCCTCTTACCCTCCAACCAT\\r\\nACCTCTATCCTCCCTTCTTC\\r\\nTCCTCATTCCTCCATCCCTT\\r\\nTCCACTATCCACCATCCTAC\\r\\nTCACCTAACCTCTTCATCCC\\r\\nACCTCAAACCCACATCCTCA\\r\\nACACCTTTCCTCCTACACCT\\r\\nTCCACTAACCACCCACTACA\\r\\nTCACCATACCACCACTTCCA\\r\\nACTCATACCCACACCAACAC\\r\\nCTCTCTTTCCCACACACTCA\\r\\nTCCACAACATCCACTCCCTA\\r\\nTCTCAACTCCCTTCTCCCAA\\r\\nTCTCTACACACCCTAACACC\\r\\nACACTTCTCCCTCTACCCAT\\r\\nACTCATCCTCTCCTCCTTTC\\r\\nACACTACACCTCCCTCATAC\\r\\nACACAACCACCCACACATCT\\r\\nTCTCTACCACCTCACTCCAT\\r\\nACCACACTTTCCCTTATCCC\\r\\nCTATCCCTCCTTCCTTACCC\\r\\nCCCAAACTCTCCCTATCACC\\r\\nCTAACCCTCCTCATACCCAC\\r\\nCCCTATCACTCCCTTCCCAT\\r\\nCCCTATCTCTCCAACACCCA\\r\\nCCCTTACTCCTCCACCCTAT\\r\\nCCCATTCACCTCCTCTACCT\\r\\nCCCTAACACCACCTCTACAC\\r\\nCCCATACACCACTCCACTAC\\r\\nCATTCCCTCCACCTCACCTA\\r\\nCTTCCCTACTCCCATCCCAT\\r\\nCATCCCTACACCCTTCTACC\\r\\nCTTCCAACCCTCTACTACCC\\r\\nCATCCTTCCCACTTCCACCA\\r\\nTTCCCTTCCCTCCTCCCATT\\r\\nCAACCCTTCCTCTCCATCAC\\r\\nCAACCCATCTCCCACTTCAC\\r\\nCCATCATCCCACTCCCACTA\\r\\nCATCCATCCCTCACACCCTA\\r\\nCATCCTACCCTCACCACACA\\r\\nTTCCACCATCCCATCCCTCA\\r\\nAACCTCCAACCCTACCCTCA\\r\\nCAACCTCCCTTCTCCACAAC\\r\\nCATCACCTCCATCCCTACCA\\r\\nATCCACTCCCAACCCTCCAA\\r\\nTTCCCTCTCACCCATACTCC\\r\\nCTACACACCACCCTACCTAC\\r\\nTTCACTCCCTCCCTACCATC\\r\\nCTTCCTCTCTCCCAACACAC\\r\\nCAACTCCACACCCATCCACA\\r\\nCATCACTCCTCCAACCCTCA\\r\\nAACTCACCCACCCAACTCAC\\r\\nCTTCTCCACCTCCACTATCC\\r\\nCTACCTCTCCTCCTCAACAC\\r\\nCATCCACACTCCACCTACAC\\r\\nCTACCACTCACCACCAACTC\\r\\nATCCCACACACCTCCTTCAC\\r\\nCATCACCACCCTCCTCTCTA\\r\\nCAACTCCTCCCTCCACACTT\\r\\nCAACACCTCCTCTCACCTAC\\r\\nATCCACCACCTCTCCTCTAC\\r\\nCAACCACTCTCCTCCACTCA\\r\\nATCCACCTCTCCACCACTCA\\r\\nTACTCCACACCCTCCACACA\\r\\nTCCCTAACCTCCTTCCCATC\\r\\nCCACAATCCACCCACTACAC\\r\\nTCATACCCTCCCTCCTACCT\\r\\nACATACCCACCTCCTACCCA\\r\\nCCACATTCACCCACCTCAAC\\r\\nCTCCCAAACACCCTCTCAAC\\r\\nCACCCATTCACCACTCCAAC\\r\\nCACCAATCCTCCCTCACTAC\\r\\nCTCAATCCCTCCTCCCTCAT\\r\\nACCCTTTCCCACACTCCTAC\\r\\nACAATCCCACCCTCACCAAC\\r\\nCACCCTTACTCCCTCTCTCA\\r\\nCACAACACCCACAACCTCCT\\r\\nCTCTTCCTCCCACTCAATCC\\r\\nACCAACCACACCACCCATTC\\r\\nCTCTTCCACTCCCACCTACT\\r\\nCTCATCCTCCTCCCACTCAT\\r\\nCTCTTCACCTCCCACACTAC\\r\\nACCCTTCTCCTCACCCTCAT\\r\\nTCCAACACTCCCACACCTAC\\r\\nTCTTCTCCACACCCTCCCTA\\r\\nCTCATCTCCTCCTCACCTCA\\r\\nACCTCTAACCCACCCTTCCA\\r\\nTCCTCAATCCCACCCACCTA\\r\\nACCACTTACCCACCACCTAC\\r\\nACACCAACCCACCAATCTCC\\r\\nTCTCCCTTCCCTCAACCCAT\\r\\nCACTCTTCCACCCTCCTACT\\r\\nCTCCTCTACCCTCTCCTCTT\\r\\nACACTACTCCCTCACCCACA\\r\\nCTACCCTCCTTCCCATCCCA\\r\\nCTACCACCCTTCCTCCCTAC\\r\\nCATCCACTCCACCCATCCAC\\r\\nCAACTCACCCACCTCCCAAC\\r\\nCCAACTCACCACCCTCACCA\\r\\nCTACACTCCCTCTCCCACCA\\r\\nCTACTCACCACCACCTCCCA\\r\\nCTCCTATCCACCATCCCACC\\r\\nCACATTCCCTCCACCCAACC\\r\\nTCCATACCCACCTCCACCCA\\r\\nCACCAACCCACTCCTCAACC\\r\\nTCTACACCTCCCACCCTACC\\r\\nTCCACCAACCCTCCCAACCA\\r\\nTCCTCCTTCACCCACCCAAC\\r\\nCTCTCTCTCCCTACCCATCC";};g6.unbindRateExpression=function(hI,hJ,hK){return br.simplify(br.mul(hJ,br.power$1(g6.e(100000000),g6.exponent(hI,hK))));};g6.tempCintoK=function(hI){return hI*1+273.15;};g6.energyExpression_minus=function(hI,hJ){return hj.New(br.sub(hI.dHE,hJ.dHE),br.sub(hI.dSE,hJ.dSE));};g6.getSpeciesEnergy=function(hI,hJ,hK){return hK.$==1?g6.getGateEnergy(hI,hJ,hK.$0):hK.$==0?g6.makeExpression(g6.empty()):be.FailWith("only gates supported for energy calculation");};g6.energyExpression_plus=function(hI,hJ){return hj.New(br.add(hI.dHE,hJ.dHE),br.add(hI.dSE,hJ.dSE));};g6.getGateEnergy=function(hI,hJ,hK){var hL;hL=g6.makeExpression(g6.initializeTerms(hI,hK));return g6.segmentIterator(hI,bX.append(new bY({$:1,$0:bX.ofArray([ei.empty()]),$1:hK}),bX.ofArray([bX.ofArray([ei.empty()])])),hJ,hL);};g6.energyExpression_lmul=function(hI,hJ){return hj.New(br.mul({$:1,$0:hI},hJ.dHE),br.mul({$:1,$0:hI},hJ.dSE));};g6.e=function(hI){return{$:1,$0:2.71828182845905};};g6.exponent=function(hI,hJ){return br.div(g6.getDG(hI,hJ),br.mul(g6.r(1000000000),g6.temperature(hI)));};g6.makeExpression=function(hI){return hj.New(g6.entalpy(hI.dH),g6.entropy(hI.dS));};g6.empty=function(){hu.$cctor();return hu.empty;};g6.segmentIterator=function(hI,hJ,hK,hL){var hM,hN,hO,hP,hQ,hR;switch(hJ.$==1?hJ.$0.$==1?hJ.$0.$1.$==0?hJ.$1.$==0?0:(hM=[hJ.$0.$0,hJ.$1],1):(hM=[hJ.$0.$0,hJ.$1,hJ.$0.$1],2):3:3){case 0:return hL;case 1:hN=hM[0];hO=hM[1];return g6.segmentIterator(hI,hO,hK,g6.energyExpression_plus(hL,g6.energyExpression_div(g6.joinsViaTop(hI,hN,bX.head(bX.head(hO)),hK),g6.NNTermsInSegment(hN,hK))));case 2:hP=hM[0];hQ=hM[2];hR=g6.energyExpression_plus(hL,g6.energyExpression_div(g6.joinsViaBottom(hI,hP,bX.head(hQ),hK),g6.NNTermsInSegment(hP,hK)));return g6.segmentIterator(hI,new bY({$:1,$0:hQ,$1:hM[1]}),hK,hR);case 3:return be.FailWith("should not reach - segment iterator");}};g6.initializeTerms=function(hI,hJ){var hK;hK=bX.length(cN.melt(new cO({$:1,$0:hJ})));return g6.energy_rmul(g6.init(hI),hK-1);};g6.r=function(hI){return{$:1,$0:0.0019872041};};g6.temperature=function(hI){return{$:1,$0:hI};};g6.getDG=function(hI,hJ){return br.sub(hJ.dHE,br.mul(hJ.dSE,br.mul(g6.temperature(hI),g6.CalInKcal(0.001))));};g6.entalpy=function(hI){return{$:1,$0:hI};};g6.entropy=function(hI){return{$:1,$0:hI};};g6.joinsViaTop=function(hI,hJ,hK,hL){var hM,hN,hO,hP,hQ;hM=ei.double_stranded_region(hJ);hN=ei.double_stranded_region(hK);hO=bX.append(ei.top_right_overhang(hJ),ei.top_left_overhang(hK));hP=ei.bottom_right_overhang(hJ);hQ=ei.bottom_left_overhang(hK);return hM.$==0?g6.makeExpression(g6.leftDangles(hI,hL,hO,hQ,hN)):hN.$==0?g6.makeExpression(g6.rightDangles(hI,hL,hO,hP,hM)):hO.$==0?g6.energyExpression_div(g6.coaxialDangleBottom(hI,hP,hQ),g6.nickAtBottom(hL,hM,hN)):g6.makeExpression(g6.energy_plus(g6.topDangleEnergyConnectedViaTop(hI,hL,hM,hN,hO),g6.bottomDangleEnergyConnectedViaTop(hI,hL,hM,hN,hP,hQ)));};g6.energyExpression_div=function(hI,hJ){return hj.New(br.add(g6.entalpy(hJ.dH),hI.dHE),br.add(g6.entropy(hJ.dS),hI.dSE));};g6.NNTermsInSegment=function(hI,hJ){var hK;hK=g6.appendSequence(ei.double_stranded_region(hI),hJ,bY.Empty);return g6.freeEnergyProcessorOnlyNN(g6.empty(),hK);};g6.joinsViaBottom=function(hI,hJ,hK,hL){var hM,hN,hO,hP,hQ;hM=ei.double_stranded_region(hJ);hN=ei.double_stranded_region(hK);hO=bX.append(ei.bottom_right_overhang(hJ),ei.bottom_left_overhang(hK));hP=ei.top_right_overhang(hJ);hQ=ei.top_left_overhang(hK);return hM.$==0?g6.makeExpression(g6.leftDangles(hI,hL,hO,hQ,hN)):hN.$==0?g6.makeExpression(g6.rightDangles(hI,hL,hO,hP,hM)):hO.$==0?g6.energyExpression_div(g6.coaxialDangleTop(hI,hP,hQ),g6.nickAtTop(hL,hM,hN)):g6.makeExpression(g6.energy_plus(g6.bottomDangleEnergyConnectedViaBottom(hI,hL,hM,hN,hO),g6.topDangleEnergyConnectedViaBottom(hI,hL,hM,hN,hP,hQ)));};g6.init=function(hI){return g6.energy_plus(ht.New(0.2,-5.7),g6.diffCorrection(bR.getStabilityCorrection(hI)));};g6.energy_rmul=function(hI,hJ){return ht.New(hJ*hI.dH,hJ*hI.dS);};g6.prim_to_string=function(){hu.$cctor();return hu.prim_to_string;};g6.CalInKcal=function(hI){return{$:1,$0:hI};};g6.concTris=function(){hu.$cctor();return hu.concTris;};g6.concNa=function(){hu.$cctor();return hu.concNa;};g6.concMg=function(){hu.$cctor();return hu.concMg;};g6.preCalc=function(){hu.$cctor();return hu.preCalc;};g6.saltCorr=function(){hu.$cctor();return hu.saltCorr;};g6.leftDangles=function(hI,hJ,hK,hL,hM){return hL.$==0?hK.$==0?g6.leftTerminalTerm(hJ,hM):g6.dangleEnergyTopRight(hI,hJ,hK,hM):g6.energy_plus(hK.$==0?g6.leftTerminalTerm(hJ,hM):g6.dangleEnergyTopRight(hI,hJ,hK,hM),g6.dangleEnergyBottomRight(hI,hJ,hL,hM));};g6.rightDangles=function(hI,hJ,hK,hL,hM){return hL.$==0?hK.$==0?g6.rightTerminalTerm(hJ,hM):g6.dangleEnergyTopLeft(hI,hJ,hM,hK):g6.energy_plus(hK.$==0?g6.rightTerminalTerm(hJ,hM):g6.dangleEnergyTopLeft(hI,hJ,hM,hK),g6.dangleEnergyBottomLeft(hI,hJ,hM,hL));};g6.coaxialDangleBottom=function(hI,hJ,hK){return hJ.$==0?hK.$==0?g6.makeExpression(g6.empty()):g6.energyExpression_div(g6.energyExpression_lmul(0.5,g6.coaxialDangleFivePrimeCorrection(hI)),g6.coaxialDangleTerm(hI)):hK.$==0?g6.energyExpression_div(g6.energyExpression_lmul(-0.5,g6.coaxialDangleFivePrimeCorrection(hI)),g6.coaxialDangleTerm(hI)):g6.makeExpression(g6.doubleCoaxialDangleTerm(hI));};g6.nickAtBottom=function(hI,hJ,hK){var hL;hL=g6.rightMostBaseTop(hI,hJ);return g6.nick(ef.complement_dnabase(g6.leftMostBaseTop(hI,hK)),ef.complement_dnabase(hL));};g6.topDangleEnergyConnectedViaTop=function(hI,hJ,hK,hL,hM){return g6.energy_plus(g6.dangleEnergyTopLeft(hI,hJ,hK,hM),g6.dangleEnergyTopRight(hI,hJ,hM,hL));};g6.energy_plus=function(hI,hJ){return ht.New(hI.dH+hJ.dH,hI.dS+hJ.dS);};g6.bottomDangleEnergyConnectedViaTop=function(hI,hJ,hK,hL,hM,hN){return hN.$==0?hM.$==0?g6.empty():g6.dangleEnergyBottomLeft(hI,hJ,hK,hM):g6.energy_plus(hM.$==0?g6.empty():g6.dangleEnergyBottomLeft(hI,hJ,hK,hM),g6.dangleEnergyBottomRight(hI,hJ,hN,hL));};g6.freeEnergyProcessorOnlyNN=function(hI,hJ){var hK;return hJ.$==1?hJ.$1.$==0?hI:(hK=hJ.$1,g6.freeEnergyProcessorOnlyNN(g6.energy_plus(hI,g6.getEnergies(hJ.$0,bX.head(hK))),hK)):hI;};g6.appendSequence=function(hI,hJ,hK){return hI.$==1?g6.appendSequence(hI.$1,hJ,bX.append(hK,g6.getDomain(hJ,hI.$0))):hK;};g6.coaxialDangleTop=function(hI,hJ,hK){return hJ.$==0?hK.$==0?g6.makeExpression(g6.empty()):g6.energyExpression_div(g6.energyExpression_lmul(-0.5,g6.coaxialDangleFivePrimeCorrection(hI)),g6.coaxialDangleTerm(hI)):hK.$==0?g6.energyExpression_div(g6.energyExpression_lmul(0.5,g6.coaxialDangleFivePrimeCorrection(hI)),g6.coaxialDangleTerm(hI)):g6.makeExpression(g6.doubleCoaxialDangleTerm(hI));};g6.nickAtTop=function(hI,hJ,hK){return g6.nick(g6.rightMostBaseTop(hI,hJ),g6.leftMostBaseTop(hI,hK));};g6.bottomDangleEnergyConnectedViaBottom=function(hI,hJ,hK,hL,hM){return g6.energy_plus(g6.dangleEnergyBottomLeft(hI,hJ,hK,hM),g6.dangleEnergyBottomRight(hI,hJ,hM,hL));};g6.topDangleEnergyConnectedViaBottom=function(hI,hJ,hK,hL,hM,hN){return hN.$==0?hM.$==0?g6.empty():g6.dangleEnergyTopLeft(hI,hJ,hK,hM):g6.energy_plus(hM.$==0?g6.empty():g6.dangleEnergyTopLeft(hI,hJ,hK,hM),g6.dangleEnergyTopRight(hI,hJ,hN,hL));};g6.diffCorrection=function(hI){return g6.inferDSFromDG(hI,g6.temp60C());};g6.leftTerminalTerm=function(hI,hJ){return g6.getTailEnergy(g6.leftMostBaseTop(hI,hJ));};g6.dangleEnergyTopRight=function(hI,hJ,hK,hL){return g6.energy_plus(g6.dangleFive(hI,g6.rightMostBaseTop(hJ,hK),g6.leftMostBaseTop(hJ,hL)),g6.leftTerminalTerm(hJ,hL));};g6.dangleEnergyBottomRight=function(hI,hJ,hK,hL){return g6.dangleThree(hI,g6.rightMostBaseBottom(hJ,hK),ef.complement_dnabase(g6.leftMostBaseTop(hJ,hL)));};g6.rightTerminalTerm=function(hI,hJ){return g6.getTailEnergy(g6.rightMostBaseTop(hI,hJ));};g6.dangleEnergyTopLeft=function(hI,hJ,hK,hL){return g6.energy_plus(g6.dangleThree(hI,g6.leftMostBaseTop(hJ,hL),g6.rightMostBaseTop(hJ,hK)),g6.rightTerminalTerm(hJ,hK));};g6.dangleEnergyBottomLeft=function(hI,hJ,hK,hL){return g6.dangleFive(hI,g6.leftMostBaseBottom(hJ,hL),ef.complement_dnabase(g6.rightMostBaseTop(hJ,hK)));};g6.coaxialDangleFivePrimeCorrection=function(hI){return g6.inferDSEFromDGE(bR.getCoaxialCorrection(hI),g6.temp25C());};g6.coaxialDangleTerm=function(hI){return g6.inferDSFromDG(bR.getCoaxialDangle(hI),g6.temp25C());};g6.doubleCoaxialDangleTerm=function(hI){return g6.inferDSFromDG(bR.getDoubleCoaxialDangle(hI),g6.temp25C());};g6.nick=function(hI,hJ){return g6.energy_lmul(1,hI.$==3?hJ.$==0?g6.interpolatedEnergy(g6.nickTA()):hJ.$==1?g6.interpolatedEnergy(g6.nickTG()):hJ.$==2?g6.interpolatedEnergy(g6.nickTC()):g6.interpolatedEnergy(g6.nickTT()):hI.$==2?hJ.$==3?g6.interpolatedEnergy(g6.nickCT()):hJ.$==1?g6.interpolatedEnergy(g6.nickCG()):hJ.$==2?g6.interpolatedEnergy(g6.nickCC()):g6.interpolatedEnergy(g6.nickCA()):hI.$==1?hJ.$==0?g6.interpolatedEnergy(g6.nickGA()):hJ.$==2?g6.interpolatedEnergy(g6.nickGC()):hJ.$==1?g6.interpolatedEnergy(g6.nickGG()):g6.interpolatedEnergy(g6.nickGT()):hJ.$==3?g6.interpolatedEnergy(g6.nickAT()):hJ.$==2?g6.interpolatedEnergy(g6.nickAC()):hJ.$==1?g6.interpolatedEnergy(g6.nickAG()):g6.interpolatedEnergy(g6.nickAA()));};g6.leftMostBaseTop=function(hI,hJ){return hJ.$==1?g6.selectLeftMostBase(hI,hJ.$0):be.FailWith(" did not find base in top dangle -- are all domains mapped to a sequence? ");};g6.rightMostBaseTop=function(hI,hJ){return hJ.$==1?g6.selectRightMostBase(hI,bX.head(bX.rev(hJ))):be.FailWith(" did not find base in top dangle -- are all domains mapped to a sequence? ");};g6.getEnergies=function(hI,hJ){return hI.$==3?hJ.$==0?g6.energy_plus(g6.TA(),g6.saltCorrectionPerNN()):hJ.$==1?g6.energy_plus(g6.CA(),g6.saltCorrectionPerNN()):hJ.$==2?g6.energy_plus(g6.GA(),g6.saltCorrectionPerNN()):g6.energy_plus(g6.AA(),g6.saltCorrectionPerNN()):hI.$==2?hJ.$==3?g6.energy_plus(g6.CT(),g6.saltCorrectionPerNN()):hJ.$==1?g6.energy_plus(g6.CG(),g6.saltCorrectionPerNN()):hJ.$==2?g6.energy_plus(g6.GG(),g6.saltCorrectionPerNN()):g6.energy_plus(g6.CA(),g6.saltCorrectionPerNN()):hI.$==1?hJ.$==0?g6.energy_plus(g6.GA(),g6.saltCorrectionPerNN()):hJ.$==2?g6.energy_plus(g6.GC(),g6.saltCorrectionPerNN()):hJ.$==1?g6.energy_plus(g6.GG(),g6.saltCorrectionPerNN()):g6.energy_plus(g6.GT(),g6.saltCorrectionPerNN()):hJ.$==3?g6.energy_plus(g6.AT(),g6.saltCorrectionPerNN()):hJ.$==2?g6.energy_plus(g6.GT(),g6.saltCorrectionPerNN()):hJ.$==1?g6.energy_plus(g6.CT(),g6.saltCorrectionPerNN()):g6.energy_plus(g6.AA(),g6.saltCorrectionPerNN());};g6.getDomain=function(hI,hJ){var hK,hL;hL=ef.get_domain(hI,hJ);switch(hL==null?2:hL.$0==null?2:hL.$0.$0.$==0?0:(hK=hL.$0.$0,1)){case 0:return be.FailWith("error in getDomain: empty sequence");case 1:return hK;case 2:return be.FailWith("error in getDomain: sequence unknown");}};g6.inferDSFromDG=function(hI,hJ){return ht.New(0,g6.kcalIntoCal(hI)/-hJ);};g6.temp60C=function(){hu.$cctor();return hu.temp60C;};g6.getTailEnergy=function(hI){var hJ;return hI.$==3||(hI.$==2?false:hI.$!=1)?g6.termAT():g6.termCG();};g6.dangleFive=function(hI,hJ,hK){return g6.energy_lmul(bR.getTerminalDangleFactor(hI),hJ.$==3?hK.$==0?g6.fiveTA():hK.$==1?g6.fiveTG():hK.$==2?g6.fiveTC():g6.fiveTT():hJ.$==2?hK.$==3?g6.fiveCT():hK.$==1?g6.fiveCG():hK.$==2?g6.fiveCC():g6.fiveCA():hJ.$==1?hK.$==0?g6.fiveGA():hK.$==2?g6.fiveGC():hK.$==1?g6.fiveGG():g6.fiveGT():hK.$==3?g6.fiveAT():hK.$==2?g6.fiveAC():hK.$==1?g6.fiveAG():g6.fiveAA());};g6.dangleThree=function(hI,hJ,hK){return g6.energy_lmul(bR.getTerminalDangleFactor(hI),hK.$==3?hJ.$==0?g6.TAthree():hJ.$==1?g6.TGthree():hJ.$==2?g6.TCthree():g6.TTthree():hK.$==2?hJ.$==3?g6.CTthree():hJ.$==1?g6.CGthree():hJ.$==2?g6.CCthree():g6.CAthree():hK.$==1?hJ.$==0?g6.GAthree():hJ.$==2?g6.GCthree():hJ.$==1?g6.GGthree():g6.GTthree():hJ.$==3?g6.ATthree():hJ.$==2?g6.ACthree():hJ.$==1?g6.AGthree():g6.AAthree());};g6.rightMostBaseBottom=function(hI,hJ){return hJ.$==1?g6.selectLeftMostBase(hI,bX.head(bX.rev(hJ))):be.FailWith(" did not find base in top dangle -- are all domains mapped to a sequence? ");};g6.leftMostBaseBottom=function(hI,hJ){return hJ.$==1?g6.selectRightMostBase(hI,hJ.$0):be.FailWith(" did not find base in bottom dangle -- are all domains mapped to a sequence? ");};g6.inferDSEFromDGE=function(hI,hJ){var hK;hK=br.div(br.mul(g6.KcalInCal(1000),hI),g6.temperature(-hJ));return hj.New(g6.entalpy(0),hK);};g6.temp25C=function(){hu.$cctor();return hu.temp25C;};g6.energy_lmul=function(hI,hJ){return ht.New(hI*hJ.dH,hI*hJ.dS);};g6.interpolatedEnergy=function(hI){var hJ,hK;hJ=0.0027;hK=hI.dG/(1-g6.temp37C()*hJ);return ht.New(hK,hJ*g6.kcalIntoCal(hK));};g6.nickTA=function(){hu.$cctor();return hu.nickTA;};g6.nickTG=function(){hu.$cctor();return hu.nickTG;};g6.nickTC=function(){hu.$cctor();return hu.nickTC;};g6.nickTT=function(){hu.$cctor();return hu.nickTT;};g6.nickCT=function(){hu.$cctor();return hu.nickCT;};g6.nickCG=function(){hu.$cctor();return hu.nickCG;};g6.nickCC=function(){hu.$cctor();return hu.nickCC;};g6.nickCA=function(){hu.$cctor();return hu.nickCA;};g6.nickGA=function(){hu.$cctor();return hu.nickGA;};g6.nickGC=function(){hu.$cctor();return hu.nickGC;};g6.nickGG=function(){hu.$cctor();return hu.nickGG;};g6.nickGT=function(){hu.$cctor();return hu.nickGT;};g6.nickAT=function(){hu.$cctor();return hu.nickAT;};g6.nickAC=function(){hu.$cctor();return hu.nickAC;};g6.nickAG=function(){hu.$cctor();return hu.nickAG;};g6.nickAA=function(){hu.$cctor();return hu.nickAA;};g6.selectLeftMostBase=function(hI,hJ){return bX.head(g6.getDomain(hI,hJ));};g6.selectRightMostBase=function(hI,hJ){return bX.head(bX.rev(g6.getDomain(hI,hJ)));};g6.TA=function(){hu.$cctor();return hu.TA;};g6.saltCorrectionPerNN=function(){hu.$cctor();return hu.saltCorrectionPerNN;};g6.CA=function(){hu.$cctor();return hu.CA;};g6.GA=function(){hu.$cctor();return hu.GA;};g6.AA=function(){hu.$cctor();return hu.AA;};g6.CT=function(){hu.$cctor();return hu.CT;};g6.CG=function(){hu.$cctor();return hu.CG;};g6.GG=function(){hu.$cctor();return hu.GG;};g6.GC=function(){hu.$cctor();return hu.GC;};g6.GT=function(){hu.$cctor();return hu.GT;};g6.AT=function(){hu.$cctor();return hu.AT;};g6.kcalIntoCal=function(hI){return 1000*hI;};g6.termAT=function(){hu.$cctor();return hu.termAT;};g6.termCG=function(){hu.$cctor();return hu.termCG;};g6.fiveTA=function(){hu.$cctor();return hu.fiveTA;};g6.fiveTG=function(){hu.$cctor();return hu.fiveTG;};g6.fiveTC=function(){hu.$cctor();return hu.fiveTC;};g6.fiveTT=function(){hu.$cctor();return hu.fiveTT;};g6.fiveCT=function(){hu.$cctor();return hu.fiveCT;};g6.fiveCG=function(){hu.$cctor();return hu.fiveCG;};g6.fiveCC=function(){hu.$cctor();return hu.fiveCC;};g6.fiveCA=function(){hu.$cctor();return hu.fiveCA;};g6.fiveGA=function(){hu.$cctor();return hu.fiveGA;};g6.fiveGC=function(){hu.$cctor();return hu.fiveGC;};g6.fiveGG=function(){hu.$cctor();return hu.fiveGG;};g6.fiveGT=function(){hu.$cctor();return hu.fiveGT;};g6.fiveAT=function(){hu.$cctor();return hu.fiveAT;};g6.fiveAC=function(){hu.$cctor();return hu.fiveAC;};g6.fiveAG=function(){hu.$cctor();return hu.fiveAG;};g6.fiveAA=function(){hu.$cctor();return hu.fiveAA;};g6.TAthree=function(){hu.$cctor();return hu.TAthree;};g6.TGthree=function(){hu.$cctor();return hu.TGthree;};g6.TCthree=function(){hu.$cctor();return hu.TCthree;};g6.TTthree=function(){hu.$cctor();return hu.TTthree;};g6.CTthree=function(){hu.$cctor();return hu.CTthree;};g6.CGthree=function(){hu.$cctor();return hu.CGthree;};g6.CCthree=function(){hu.$cctor();return hu.CCthree;};g6.CAthree=function(){hu.$cctor();return hu.CAthree;};g6.GAthree=function(){hu.$cctor();return hu.GAthree;};g6.GCthree=function(){hu.$cctor();return hu.GCthree;};g6.GGthree=function(){hu.$cctor();return hu.GGthree;};g6.GTthree=function(){hu.$cctor();return hu.GTthree;};g6.ATthree=function(){hu.$cctor();return hu.ATthree;};g6.ACthree=function(){hu.$cctor();return hu.ACthree;};g6.AGthree=function(){hu.$cctor();return hu.AGthree;};g6.AAthree=function(){hu.$cctor();return hu.AAthree;};g6.KcalInCal=function(hI){return{$:1,$0:hI};};g6.temp37C=function(){hu.$cctor();return hu.temp37C;};c1.findAllMatches=function(hI,hJ,hK){return c1.fam(hI,hJ,hK,new cK.New$1(null),0);};c1.patternMatches=function(hI,hJ,hK,hL){var hM,hN;return hK.$==1?hJ.$==1?(hM=hJ.$1,(hN=hK.$1,bX.collect(function(hO){return c1.patternMatches(hI,hM,hN,c4.Compose(hL,hO,hI));},cV.unifyHoleEntry(hI,hL.Apply$3(hJ.$0,hI),hL.Apply$3(hK.$0,hI))))):bY.Empty:bX.ofArray([hL]);};c1.fam=function(hI,hJ,hK,hL,hM){return hJ.$==1?hK.$==0?hL:hJ.get_Length()<hK.get_Length()?hL:c1.fam(hI,hJ.$1,hK,new cK.New$1(c6.OfSeq(co.append(hL,new cK.New$1(c6.OfSeq(bX.map(function(hN){return[hN,hM];},c1.patternMatches(hI,hJ,hK,c4.get_id()))))))),hM+1):hL;};g7.concat=function(hI){var hJ,hK;hJ=[];for(var hL in hI)hJ.push.apply(hJ,hI[hL]);return hJ;};g8=de.NotId=hB.Class({},db,g8);g8.New=function(hI){return new g8({Data0:hI});};g9.$cctor=function(){g9.$cctor=a.ignore;g9.commit_number="0";g9.default_matching_degree=1;g9.default_toehold_bind_rate=0.0003;g9.default_toehold_unbind_rate=0.1126;g9.default_leak_rate_l=1E-09;g9.default_leak_rate_w=dZ.default_leak_rate_l()/100;g9.default_tau_rate=dZ.default_toehold_unbind_rate();g9.default_toehold_length=6;g9.default_specificity_length=20;g9.default_elementary_migration_rate=1/0.000125;g9.default_tolerance=1E-06;g9.array_of_list=ck.ofList;g9.newline="\\r\\n";};g_.$cctor=function(){g_.$cctor=a.ignore;g_.empty=new cj.New([]);};g$.Rejected={$:1};ha.Empty={$:3};hb.buildHistogram=function(hI,hJ){var hK,hL,hM,hN,hO,hP;hK=1E-06;hL=co.min(hI)-hK;hM=(co.max(hI)+hK-hL)/hJ;hN=bX.init(hJ,function(hQ){return hL+hM*0.5+hQ*hM;});hO=ck.init(hJ,function(hQ){return hL+hQ*hM;});hP=ck.create(hJ,0);co.iter(function(hQ){ck.set(hP,hQ,ck.get(hP,hQ)+1);},co.map(function(hQ){return hQ<0?~hQ-1:hQ;},co.map(function(hQ){return ck.binarySearch(hO,function(hR){return cw.Compare(hQ,hR);},0,ck.length(hO));},hI)));return hc.New(hN,bX.ofArray(hP),hM);};hc.New=function(hI,hJ,hK){return{BinCentres:hI,BinCounters:hJ,BinWidth:hK};};hd.WithoutShadow={$:0};he=bb.IndexOutOfRangeException=hB.Class({},db,he);he.New=hB.Ctor(function(){he.New$1.call(this,"Index was outside the bounds of the array.");},he);he.New$1=hB.Ctor(function(hI){this.message=hI;da.setPrototypeOf(this,he.prototype);},he);d3.Identity=function(hI,hJ){var hK,hL,hM,hN;hK=hC.min(hI,hJ);hL=new d4.New(hI,hJ);for(hM=0,hN=hK-1;hM<=hN;hM++)hL.get_Item(hM).set_Item(hM,1);return hL;};hf.New=function(hI,hJ,hK,hL,hM,hN,hO,hP){return{e:hI,Dq:hJ,DqUp:hK,DqDown:hL,delta:hM,x:hN,z:hO,count:hP};};hg.SolveCore=function(hI,hJ){var hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU;hK=dN.numRows(hI);hL=dN.copy(hI);hM=dK.copy(hJ);ho.solveCore(hL,hM);hN=new hG(hK);for(hO=0,hP=hK-1;hO<=hP;hO++){hQ=hM[hO];hS=hL.get_Item(hO);for(hT=hK-hO,hU=hK-1;hT<=hU;hT++)hQ=hQ-hN[hT]*hS[hT];hN[hK-hO-1]=hQ;}return hN;};hg.SparseSolveCore=function(hI,hJ){var hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0,h1,h2,h3,h4,h5,h6,h7;hN=hI.get_RowDimension();hK=ck.ofSeq(co.delay(function(){return co.map(function(h8){return hJ[h8];},be.range(0,hN-1));}));hL=ck.ofSeq(co.delay(function(){return co.map(a.id,be.range(0,hN-1));}));hM=ck.create(hN,0);for(hO=0,hP=hN-1;hO<=hP;hO++){hQ=0;hR=hI.get_Items(hQ,hO);hS=0;for(hV=0,hW=hN-hO-1;hV<=hW;hV++){hS=hI.get_Items(hV,hO);hC.abs(hS)>hC.abs(hR)?(hQ=hV,hR=hS):void 0;}hC.abs(hR)<1E-12?be.FailWith("Cannot apply Gauss method"):void 0;hI.ScaleRow(hQ,hO+1,hN-1,1/hR);ck.set(hK,hQ,ck.get(hK,hQ)/hR);hI.set_Items(hQ,hO,1);hQ!==hN-hO-1?(hI.SwitchRows(hQ,hN-hO-1),hT=ck.get(hK,hN-hO-1),ck.set(hK,hN-hO-1,ck.get(hK,hQ)),ck.set(hK,hQ,hT),hU=ck.get(hL,hN-hO-1),ck.set(hL,hN-hO-1,ck.get(hL,hQ)),ck.set(hL,hQ,hU)):void 0;for(hX=0,hY=hN-hO-2;hX<=hY;hX++){hS=hI.get_Item$1(hX,hO);if(hS!==0){for(hZ=hO+1,h0=hN-1;hZ<=h0;hZ++)hI.set_Item$1(hX,hZ,hS-hI.get_Item$1(hN-hO-1,hZ));ck.set(hK,hX,ck.get(hK,hX)-hS*ck.get(hK,hN-hO-1));hI.set_Item$1(hX,hO,0);}else void 0;}}for(h1=0,h2=hN-1;h1<=h2;h1++){h3=ck.get(hK,h1);h5=hI.get_Item(h1);for(h6=0,h7=h5.get_Count()-1;h6<=h7;h6++)if(ck.get(h5.get_Indices(),h6)>=hN-h1)h3=h3-ck.get(hM,ck.get(h5.get_Indices(),h6))*ck.get(hI.get_Item(h1).get_Items(),h6);ck.set(hM,hN-h1-1,h3);}return dK.ofArray(hM);};hh.$cctor=function(){hh.$cctor=a.ignore;hh.pname=cR.op_LessBarGreater(cR.op_DotGreaterGreater(cR.name(),cR.spaces()),cR.kw("_"));hh.pnick=cR.op_GreaterGreaterDot(cR.op_GreaterGreaterDot(cR.kw(">"),cR.kw("|")),cR.kw("<"));};hi.UpperInner={$:1};hi.LowerInner={$:3};hi.UpperOuter={$:0};hi.LowerOuter={$:2};hj=g6.energyExpression=hB.Class({toString:function(){return(((((((hB.Curried(function(hI,hJ,hK,hL,hM,hN,hO){return hI("dH = "+cA.toSafe(hJ)+cA.toSafe(hK)+", dS = "+cA.toSafe(hL)+cA.toSafe(hM)+", dG = "+hN.toFixed(6)+cA.toSafe(hO));},7))(a.id))((g6.prim_to_string())(this.dHE)))(" kcal/mol"))((g6.prim_to_string())(this.dSE)))(" cal/(mol*K)"))(a.Number((g6.prim_to_string())(this.dHE))-0.001*(273.15+25)*a.Number((g6.prim_to_string())(this.dSE))))(" kcal/mol - 25.0");}},null,hj);hj.New=function(hI,hJ){return new hj({dHE:hI,dSE:hJ});};hk.$cctor=function(){hk.$cctor=a.ignore;hk.GT=1;hk.LT=-1;hk.EQ=0;};hl.$cctor=function(){hl.$cctor=a.ignore;hl.improbable=4.94065645841247E-324;hl.log_improbable=hC.log(eA.improbable());hl["lcg.a"]=1664525;hl["lcg.c"]=1013904223;hl["lcd.m"]=hC.pow(2,32);hl["lcg.d"]=1/eA["lcd.m"]();};hm.parse=function(hI,hJ){var hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h0,h1,h2,h3,h4,h5,h6,h7,h8,h9,h_,h$,ia,ib,ic,id,ie,_if;function ig(ik){return{$:1,$0:ik};}function ih(ik){return{$:0,$0:ik};}function ii(ik,il){return{$:2,$0:ik,$1:il};}function ij(ik,il){return gz.op_LessBarGreater(hV,hT,ik,il);}hK=br.zero();hL=br.one();hM=(hN=cR.name_kw(fV.kwList()),function(ik){return gz.op_DotGreaterGreater(hN,cR.spaces(),ik[0],ik[1]);});hO=br.parse(hM);hP=br.parse(bq.parse(hI));hQ=cR.kw(",");hR=(hS=_8.parse(hI,hO,hK),function(ik){return gz.op_BarGreaterGreater(hS,ig,ik[0],ik[1]);});hT=(hU=_2.parse(hI,hO,hP,hL),function(ik){return gz.op_BarGreaterGreater(hU,ih,ik[0],ik[1]);});hV=(hW=(hX=(hY=cR.pTry((hZ=cR.kw("("),function(ik){return gz.op_DotGreaterGreater(hM,hZ,ik[0],ik[1]);})),(h0=cR.sepBy(hO,hQ),function(ik){return gz.op_DotGreaterGreaterDot(hY,h0,ik[0],ik[1]);})),(h1=cR.kw(")"),function(ik){return gz.op_DotGreaterGreater(hX,h1,ik[0],ik[1]);})),function(ik){return gz.op_BarGreaterGreater(hW,function(il){return ii(il[0],il[1]);},ik[0],ik[1]);});h2=function(ik){return gz.op_LessBarGreater(function(il){return ij(il[0],il[1]);},hR,ik[0],ik[1]);};h3=cR.kw("|");h4=(h5=(h6=cR.many((h7=(h8=(h9=(h_=cR.kw("module"),function(ik){return gz.op_GreaterGreaterDot(h_,cR.name(),ik[0],ik[1]);}),(h$=cR.paren(cR.sepBy(cR.name(),hQ)),function(ik){return gz.op_DotGreaterGreaterDot(h9,h$,ik[0],ik[1]);})),(ia=cR.kw("="),function(ik){return gz.op_DotGreaterGreater(h8,ia,ik[0],ik[1]);})),(ib=cR.braces((ic=cR.opt(h3),(id=cR.sepBy(h2,h3),function(ik){return gz.op_GreaterGreaterDot(ic,id,ik[0],ik[1]);}))),function(ik){return gz.op_DotGreaterGreaterDot(h7,ib,ik[0],ik[1]);}))),function(ik){return gz.op_GreaterGreaterDot(cR.spaces(),h6,ik[0],ik[1]);}),(ie=cR.opt(h3),function(ik){return gz.op_DotGreaterGreater(h5,ie,ik[0],ik[1]);}));_if=cR.sepBy(h2,h3);return function(ik){return gz.op_DotGreaterGreaterDot(h4,_if,ik[0],ik[1]);};};hm.convert_instructions=function(hI,hJ){var hK;function hL(hM,hN){return function(hO){var hP,hQ,hR,hS,hT,hU,hV;function hW(h6,h7){return h6[0]===hP&&hQ.get_Length()===h6[1].get_Length();}function hX(h6,h7){return h6[0]===hP;}function hY(h6){var h7;function h8(h_){return h_[0];}function h9(h_){return h6===h_;}h7=co.tryFind(function(h_){return h9(h8(h_));},hV);return h7==null?null:{$:1,$0:h7.$0[1]};}function hZ(h6,h7){var h8,h9;h8=hY(h7);return h8==null?h7:(h9=h8.$0,h9.$==0?h9.$0:be.FailWith(((((hB.Curried(function(h_,h$,ia,ib){return h_("Module invokation failed: cannot substitute expression \\""+cA.toSafe(h$)+"\\" for \\""+cA.toSafe(ia)+"\\" in module \\""+cA.toSafe(ib)+"\\"");},4))(a.id))(br.to_string(a.id,h9)))(h7))(h6)));}function h0(h6,h7){return bG.New(hZ(h6,h7.name));}function h1(h6){var h7;h7=hY(h6);return h7!=null&&h7.$==1?h7.$0:{$:0,$0:h6};}function h2(h6,h7){function h8(h9){var h_,h$;return h9.$==0?(h_=h9.$0,(h$=hY(h_),h$!=null&&h$.$==1?br.map(function(ia){return{$:0,$0:ia};},h$.$0):{$:0,$0:{$:0,$0:h_}})):h9.$==1?{$:0,$0:{$:1,$0:hZ(h6,h9.$0)}}:h9.$==2?{$:0,$0:{$:2,$0:h0(h6,h9.$0)}}:{$:0,$0:bq.Time};}return h7.map(function(h9){return br.expand(h1,h9);},function(h9){return br.expand(h8,h9);});}function h3(h6,h7){var h8;return _2.create$4(Z.map(function(h9){return h0(h6,h9);},h7.catalysts),Z.map(function(h9){return h0(h6,h9);},h7.reactants),(h8=h7.reverse,h8!=null&&h8.$==1?{$:1,$0:h2(h6,h8.$0)}:null),h2(h6,h7.rate),Z.map(function(h9){return h0(h6,h9);},h7.products));}function h4(h6,h7){var h8,h9;h8=h0(h6,h7.species);return _8.create$4(h7.constant,br.expand(h1,h7.value),h8,(h9=h7.time,h9==null?null:{$:1,$0:br.expand(h1,h9.$0)}),h7.spatial);}function h5(h6,h7){var h8,h9;h8=h7[0];h9=h7[1];return function(h_){var h$;return h_.$==1?[h8,new bY({$:1,$0:h4(h6,h_.$0),$1:h9})]:h_.$==2?(h$=bX.map(function(ia){return br.expand(h1,ia);},h_.$1),(function(ia){return hL(ia[0],ia[1]);}([h8,h9]))({$:2,$0:h_.$0,$1:h$})):[new bY({$:1,$0:h3(h6,h_.$0),$1:h8}),h9];};}return hO.$==1?[hM,new bY({$:1,$0:hO.$0,$1:hN})]:hO.$==2?(hP=hO.$0,(hQ=hO.$1,(hR=(hS=co.tryFind(function(h6){return hW(h6[0],h6[1]);},hI),hS==null?(hT=(((hB.Curried3(function(h6,h7,h8){return h6(cA.toSafe(h7)+"("+cA.toSafe(h8)+")");}))(a.id))(hP))(cS.concat(", ",bX.map(function(h6){return br.to_string(a.id,h6);},hQ))),be.FailWith((hU=co.tryFind(function(h6){return hX(h6[0],h6[1]);},hI),hU!=null&&hU.$==1?(((hB.Curried3(function(h6,h7,h8){return h6("No module definition with "+hH(h7)+" arguments found for invokation \\""+cA.toSafe(h8)+"\\"");}))(a.id))(hQ.get_Length()))(hT):(function(h6){return function(h7){return h6("No module definition found for module invocation \\""+cA.toSafe(h7)+"\\"");};}(a.id))(hT)))):[hS.$0[0][1],hS.$0[1]]),(hV=bX.zip(hR[0],hQ),co.fold(function(h6,h7){return(function(h8){return h5(hP,h8);}(h6))(h7);},[hM,hN],hR[1]))))):[new bY({$:1,$0:hO.$0,$1:hM}),hN];};}hK=co.fold(function(hM,hN){return(function(hO){return hL(hO[0],hO[1]);}(hM))(hN);},[bY.Empty,bY.Empty],hJ);return[bX.rev(hK[0]),bX.rev(hK[1])];};bg.createNormal=function(hI,hJ){return hJ>0?{$:0,$0:bm.New(hI,hJ)}:be.FailWith("Cannot create Normal distribution with non-positive sigma. Value supplied: "+hH(hJ));};bg.createLogNormal=function(hI,hJ){return hJ>0?{$:1,$0:bl.New(hI,hJ)}:be.FailWith("Cannot create LogNormal distribution with non-positive sigma. Value supplied: "+hH(hJ));};bg.createTruncatedNormal=function(hI,hJ,hK,hL){return{$:2,$0:bk.New(hI,hJ,hK,hL,eA.normCDF(hI,hJ,hL)-eA.normCDF(hI,hJ,hK))};};hn.New=function(hI,hJ,hK,hL,hM,hN){return{GridLines:hI,Plots:hJ,IsLegendEnabled:hK,IsNavigationEnabled:hL,IsTooltipPlotCoordsEnabled:hM,VisibleRegion:hN};};ho.solveCore=function(hI,hJ){var hK,hL,hM,hN,hO,hP,hQ,hR;hK=0;for(hL=0,hM=dN.numRows(hI)-1;hL<=hM;hL++){hP=dN.numRows(hI)-hL-1;hK=0;for(hQ=0,hR=hP;hQ<=hR;hQ++)if(hC.abs((hI.get_Item(hQ))[hL])>hC.abs((hI.get_Item(hK))[hL]))hK=hQ;hC.abs((hI.get_Item(hK))[hL])<1E-12?be.FailWith("Cannot apply Gauss method"):void 0;hN=hI.get_Item(hK);hO=hN[hL];ho.divideFrom(hN,hO,hL+1);hJ[hK]=hJ[hK]/hO;hN[hL]=1;hK!==hP?(ho.flipRows(hI,hK,hP),ho.flipValues(hJ,hK,hP)):void 0;ho.processOtherRows(hI,hJ,hL);}};ho.divideFrom=function(hI,hJ,hK){var hL,hM;for(hL=hK,hM=hI.length-1;hL<=hM;hL++)hI[hL]=hI[hL]/hJ;};ho.flipRows=function(hI,hJ,hK){var hL,hM,hN,hO,hP;hL=hI.get_Item(hJ);hM=hI.get_Item(hK);for(hN=0,hO=hL.length-1;hN<=hO;hN++){hP=hL[hN];hL[hN]=hM[hN];hM[hN]=hP;}};ho.flipValues=function(hI,hJ,hK){var hL;hL=hI[hJ];hI[hJ]=hI[hK];hI[hK]=hL;};ho.processOtherRows=function(hI,hJ,hK){var hL,hM,hN,hO,hP,hQ,hR,hS;hL=hI.MatrixData;hM=hL.length-hK-1|0;hN=+hJ[hM];hO=hL[hM];hP=0;for(;hP<hM;hP++){hQ=hL[hP];hR=+hQ[hK];if(hR!==0){hS=hK|0+1;for(;hS<hQ.length;hS++)hQ[hS]=+hQ[hS]-hR*+hO[hS];hJ[hP]=+hJ[hP]-hR*hN;hQ[hK]=0;}}};hp.PArithmetic={$:2};hp.PPattern={$:1};hp.PVariable={$:3};hp.PContext={$:4};hp.PFunction={$:0};hq.get_massActionRate=function(){return"_massActionRate";};hq.get_functionalRate=function(){return"_functionalRate";};hq.get_reaction=function(){return"_rxn";};hq.get_context=function(){return"_ctx";};hr=b5.SiteC=hB.Class({toString:function(){return this.$==1?hH(this.$0):hH(this.$0)+"."+hH(this.$1);}},null,hr);hs.$cctor=function(){hs.$cctor=a.ignore;function hI(hK){return hK.$==0;}function hJ(hK){return hK.$==0;}hs.remove_strand=(hB.Curried3(dZ.remove_first))(function(hK){return function(hL){return em.equal(hK,hL);};});hs.is_strand_free=function(hK){return hI(em.tethered_domains(hK));};hs.is_gate_free=function(hK){return hJ(eo.tethered_domains(hK));};};ht=g6.energy=hB.Class({toString:function(){return(((((((hB.Curried(function(hI,hJ,hK,hL,hM,hN,hO){return hI("dH = "+hJ.toFixed(6)+cA.toSafe(hK)+", dS = "+hL.toFixed(6)+cA.toSafe(hM)+", dG37 = "+hN.toFixed(6)+cA.toSafe(hO));},7))(a.id))(this.dH))(" kcal/mol"))(this.dS))(" cal/(mol*K)"))(this.dH-0.001*(273.15+37)*this.dS))(" kcal/mol-37");}},null,ht);ht.New=function(hI,hJ){return new ht({dH:hI,dS:hJ});};hu.$cctor=function(){hu.$cctor=a.ignore;hu.prim_to_string=function(hI){return br.to_string(a.id,hI);};hu.R=1.9872;hu.temp25C=273.15+25;hu.temp37C=273.15+37;hu.temp60C=273.15+60;hu.AA=ht.New(-7.6,-21.3);hu.AT=ht.New(-7.2,-20.4);hu.TA=ht.New(-7.2,-21.3);hu.CA=ht.New(-8.5,-22.7);hu.GT=ht.New(-8.4,-22.4);hu.CT=ht.New(-7.8,-21);hu.GA=ht.New(-8.2,-22.2);hu.CG=ht.New(-10.6,-27.2);hu.GC=ht.New(-9.8,-24.4);hu.GG=ht.New(-8,-19.9);hu.termAT=ht.New(2.2,6.9);hu.termCG=ht.New(0,0);hu.empty=ht.New(0,0);hu.concMg=0.0125;hu.concTris=0.5*0.04;hu.concNa=0;hu.preCalc=0.5*g6.concTris()+g6.concNa()+3.3*hC.sqrt(g6.concMg());hu.saltCorr=1*0.368*hC.log(g6.preCalc());hu.saltCorrectionPerNN=ht.New(g6.empty().dH,g6.saltCorr());hu.fiveAA=ht.New(0.2,2.3);hu.fiveAC=ht.New(-6.3,-17.1);hu.fiveAG=ht.New(-3.7,-10);hu.fiveAT=ht.New(-2.9,-7.6);hu.fiveCA=ht.New(0.6,3.3);hu.fiveCC=ht.New(-4.4,-12.6);hu.fiveCG=ht.New(-4,-11.9);hu.fiveCT=ht.New(-4.1,-13);hu.fiveGA=ht.New(-1.1,-1.6);hu.fiveGC=ht.New(-5.1,-14);hu.fiveGG=ht.New(-3.9,-10.9);hu.fiveGT=ht.New(-4.2,-15);hu.fiveTA=ht.New(-6.9,-20);hu.fiveTC=ht.New(-4,-10.9);hu.fiveTG=ht.New(-4.9,-13.8);hu.fiveTT=ht.New(-0.2,-0.5);hu.TAthree=ht.New(-0.7,-0.8);hu.GAthree=ht.New(-2.1,-3.9);hu.CAthree=ht.New(-5.9,-16.5);hu.AAthree=ht.New(-0.5,-1.1);hu.TCthree=ht.New(4.4,14.9);hu.GCthree=ht.New(-0.2,-0.1);hu.CCthree=ht.New(-2.6,-7.4);hu.ACthree=ht.New(4.7,14.2);hu.TGthree=ht.New(-1.6,-3.6);hu.GGthree=ht.New(-3.9,-11.2);hu.CGthree=ht.New(-3.2,-10.4);hu.AGthree=ht.New(-4.1,-13.1);hu.TTthree=ht.New(2.9,10.4);hu.GTthree=ht.New(-4.4,-13.1);hu.CTthree=ht.New(-5.2,-15);hu.ATthree=ht.New(-3.8,-12.6);hu.nickAA=hw.New(-1.04);hu.nickAT=hw.New(-1.27);hu.nickAG=hw.New(-1.29);hu.nickAC=hw.New(-2.04);hu.nickTA=hw.New(-0.12);hu.nickTT=hw.New(-1.04);hu.nickTG=hw.New(-0.78);hu.nickTC=hw.New(-1.66);hu.nickGA=hw.New(-1.66);hu.nickGT=hw.New(-2.04);hu.nickGG=hw.New(-1.97);hu.nickGC=hw.New(-2.7);hu.nickCA=hw.New(-0.78);hu.nickCT=hw.New(-1.29);hu.nickCG=hw.New(-1.44);hu.nickCC=hw.New(-1.97);};hv.$cctor=function(){hv.$cctor=a.ignore;hv.empty=new ej({$:0,$0:[bY.Empty,bY.Empty,bY.Empty,bY.Empty,bY.Empty]});};ck.binarySearch=function(hI,hJ,hK,hL){var hM,hN,hO,hP;hM=hK;hN=hL-1;if(hK<0)throw new hy.New("index","Non-negative number required.");else null;if(hL>ck.length(hI))throw new fY.New$2("Offset and length were out of bounds for the array or count is greater than the number of elements from index to the end of the source collection.");else null;if(hL<hK)throw new hy.New("length","Non-negative number required.");else null;while(true)if(hM>hN)return~hM;else{hO=(hM+hN)/2>>0;hP=hJ(ck.get(hI,hO));if(hM===hN)return hP===0?hM:hP>0?~(hM+1):~hM;else if(hP<=0)hN=hO;else hM=hO+1;}};hw=g6.gibbs=hB.Class({toString:function(){return(((hB.Curried3(function(hI,hJ,hK){return hI("dG = "+hJ.toFixed(4)+cA.toSafe(hK));}))(a.id))(this.dG))(" kcal/mol");}},null,hw);hw.New=function(hI){return new hw({dG:hI});};hx.$cctor=function(){hx.$cctor=a.ignore;hx.zero={$:1,$0:0};hx.one={$:1,$0:1};};hy=bb.ArgumentOutOfRangeException=hB.Class({},db,hy);hy.New=hB.Ctor(function(hI,hJ){this.message=hJ+"\\nParameter name: "+hI;da.setPrototypeOf(this,hy.prototype);},hy);hz=bb.MatchFailureException=hB.Class({},db,hz);hz.New=hB.Ctor(function(hI,hJ,hK){this.message=hI+" at "+hH(hJ)+":"+hH(hK);da.setPrototypeOf(this,hz.prototype);},hz);}());\r\n\r\n\r\nif (typeof IntelliFactory !==\'undefined\') {\r\n  IntelliFactory.Runtime.ScriptBasePath = \'/Content/\';\r\n  IntelliFactory.Runtime.Start();\r\n}\r\n'},function(e,t,n){"use strict";n.r(t);var h=n(1),r=n.n(h),i=n(2),f=n.n(i),o=function(){function e(e){this.Module=e,this.extractionCache={},this.writeCache={},this.sizeOfFloat64=8,this.fnSundialsSolverWasm=this.Module.cwrap("fnSundialsSolver","number",["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"]),this.fnSundialsCMESolverWasm=this.Module.cwrap("fnSundialsCMESolver","number",["number","number","number","number","number","number","number","number","number","number","number","number","number"])}return e.prototype.allocEmHeap=function(e){return this.Module._malloc(e)},e.prototype.allocFloat64EmHeapAndCopyTo=function(e){var t=new Float64Array(e),n=t.length*t.BYTES_PER_ELEMENT,h=this.Module._malloc(n),r=new Uint8Array(this.Module.HEAPU8.buffer,h,n);return r.set(new Uint8Array(t.buffer)),r.byteOffset},e.prototype.allocInt32EmHeapAndCopyTo=function(e){var t=new Int32Array(e),n=t.length*t.BYTES_PER_ELEMENT,h=this.Module._malloc(n),r=new Uint8Array(this.Module.HEAPU8.buffer,h,n);return r.set(new Uint8Array(t.buffer)),r.byteOffset},e.prototype.freeEmHeap=function(e){this.Module._free(e)},e.prototype.extractFloat64ArrayFromEmMemory=function(e,t){var n=e+"_"+t;return this.extractionCache[n]||(this.extractionCache[n]=new Float64Array(this.Module.HEAPU8.buffer,e,t)),this.extractionCache[n]},e.prototype.writeNumArrayToEmMemory=function(e,t){var n=t.length,h=e+"_"+n;this.writeCache[h]||(this.writeCache[h]=new Float64Array(this.Module.HEAPU8.buffer,e,n)),this.writeCache[h].set(t)},e.prototype.fnSundialsSolver=function(e){var t=this,n=e.sundialsOutput,h=this.Module.addFunction((function(e,h,r){var i=t.extractFloat64ArrayFromEmMemory(h,r);n(e,i)}),"ddii"),r=e.functionalRates,i=this.Module.addFunction((function(e,n,h,i){var f=t.extractFloat64ArrayFromEmMemory(h,i),o=r(e,f);t.writeNumArrayToEmMemory(n,o)}),"vdiii"),f=this.allocInt32EmHeapAndCopyTo(e.stoichM),o=this.allocInt32EmHeapAndCopyTo(e.powersM),a=this.allocFloat64EmHeapAndCopyTo(e.ratesM),u=this.allocInt32EmHeapAndCopyTo(e.stoichF),c=this.allocFloat64EmHeapAndCopyTo(e.concs),s=this.allocFloat64EmHeapAndCopyTo(e.t),$=this.allocEmHeap(e.rNM*this.sizeOfFloat64),l=this.allocEmHeap(e.rNF*this.sizeOfFloat64),C=this.fnSundialsSolverWasm(e.sN,e.rNM,f,o,a,e.rNF,u,i,c,s,e.tN,h,e.stiff,e.abstol,e.reltol,$,l),d=this.extractFloat64ArrayFromEmMemory(c,e.concs.length);return e.conc=d,this.Module.removeFunction(i),this.Module.removeFunction(h),this.freeEmHeap(l),this.freeEmHeap($),this.freeEmHeap(s),this.freeEmHeap(c),this.freeEmHeap(u),this.freeEmHeap(a),this.freeEmHeap(o),this.freeEmHeap(f),C},e.prototype.fnSundialsCMESolver=function(e){var t=this,n=e.sundialsOutput,h=this.Module.addFunction((function(e,h,r){var i=t.extractFloat64ArrayFromEmMemory(h,r);n(e,i)}),"ddii"),r=(this.allocInt32EmHeapAndCopyTo(e.stoichM),this.allocFloat64EmHeapAndCopyTo(e.propensities)),i=this.allocInt32EmHeapAndCopyTo(e.sources),f=this.allocInt32EmHeapAndCopyTo(e.targets),o=this.allocFloat64EmHeapAndCopyTo(e.diagonals),a=this.allocFloat64EmHeapAndCopyTo(e.prob_mass),u=this.allocFloat64EmHeapAndCopyTo(e.timesToReturnParam),c=this.fnSundialsCMESolverWasm(e.stateN,e.transN,r,i,f,o,a,u,e.numTimesToReturnParam,h,e.stiff,e.abstol,e.reltol),s=this.extractFloat64ArrayFromEmMemory(a,e.prob_mass.length);return e.prob_mass=s,this.freeEmHeap(u),this.freeEmHeap(a),this.freeEmHeap(o),this.freeEmHeap(f),this.freeEmHeap(i),this.freeEmHeap(r),this.Module.removeFunction(h),c},e}(),a=n(3);eval.call(null,a);var u,c,s,$,l,C,d,A,T,p,_,b,m,g,I,J,L,K,N={contents:!1},v={loader:function(){var e=n(6);e=e.replace(/('|")use strict('|");?/,""),eval.call(null,e)},isJITfunc:null,getJITfunc:null,processMessage:q};r()({locateFile:function(e){return"SundialsSolver.wasm"==e?f.a:e}}).then((function(e){var t=new o(e);!function(e,t){(function(e,t){var n=self;n.window=self,n.window.WS_EM_GLUE=t,e(),delete n.window})(e.loader,t),function(e,t){"undefined"==typeof Microsoft&&console.log("Worker initialization failed: Microsoft namespace not defined. Bad F# bundle import?");u=Microsoft.Research.CRNEngine.JSONAPI.user_parse_code,c=Microsoft.Research.CRNEngine.JSONAPI.user_get_exports,s=Microsoft.Research.CRNEngine.JSONAPI.user_get_export,$=Microsoft.Research.CRNEngine.JSONAPI.user_infer_gui,l=Microsoft.Research.CRNEngine.JSONAPI.user_get_sim_runs,C=Microsoft.Research.CRNEngine.JSONAPI.simulateFloat,d=Microsoft.Research.CRNEngine.JSONAPI.simulateFloatJIT,A=Microsoft.Research.CRNEngine.JSONAPI.simulateMeanStdev,T=Microsoft.Research.CRNEngine.JSONAPI.simulateMeanStdevProbabilities,p=Microsoft.Research.CRNEngine.JSONAPI.simulateSpatial1D,_=Microsoft.Research.CRNEngine.JSONAPI.simulateSpatial2D,b=Microsoft.Research.CRNEngine.JSONAPI.simulateMeanStdevTable,m=Microsoft.Research.CRNEngine.JSONAPI.getProbabilityMap,g=Microsoft.Research.CRNEngine.JSONAPI.user_state_space,I=Microsoft.Research.CRNEngine.JSONAPI.user_state_space_jit,Microsoft.Research.CRNEngine.JSONAPI.expression_to_string,Microsoft.Research.CRNEngine.JSONAPI.mcplot_to_string,L=null==e?function(e){return!1}:e,J=t}(e.isJITfunc,e.getJITfunc);var n=P;P=null;for(var h=0,r=n;h<r.length;h++){z(r[h])}}(v,t)})),void 0===K&&(K={now:function(){return 0}});var w,D,M,y,R,E,B,G,S,O,P=[];function X(){self.postMessage({mtype:"finished"},void 0)}function k(e){var t={mtype:"model",model:e};return self.postMessage(t,void 0),e}function F(e){var t={mtype:"export",export:e};self.postMessage(t,void 0)}function j(e){return function(t){var n={mtype:"simresult",row:{instance:e,time:t.time,values:t.values}};self.postMessage(n,void 0)}}function x(e){return function(t){var n={mtype:"simtable",table:{instance:e,time:t.times,values:t.columns.map((function(e){return e.values}))}};self.postMessage(n,void 0)}}function U(e){return function(t){var n={mtype:"newplottable",plottable:{instance:e,plottable:t}};self.postMessage(n,void 0)}}function Q(e){return function(e){var t={mtype:"statespace",statespace:e};self.postMessage(t,void 0)}}function W(e){var t={mtype:"parameterdefinitions",nodeId:e.nodeId,parameters:e.parameters};self.postMessage(t,void 0)}function Y(e){var t={mtype:"summary",nodeId:e.nodeId,summary:e.summary};self.postMessage(t,void 0);var n={mtype:"inferenceprogress",nodeId:e.nodeId,progress:e.iteration};self.postMessage(n,void 0);var h=void 0,r=-1/0;if(null!=e.state.BurninPhase){var i=e.state.BurninPhase;h=i.mle,r=i.mle.lglk}else{var f=e.state.SamplingPhase;h=f.mle,r=f.mle.lglk;var o=f.chain[0];if(o&&0==f.thinningSkippedCount){var a={mtype:"inferencechainupdate",nodeId:e.nodeId,update:o};self.postMessage(a,void 0)}}if(e.lkincreased){var u={mtype:"parameterresult",nodeId:e.nodeId,values:h};self.postMessage(u,void 0)}if(null!=e.mlesims){var c=e.mlesims;console.log("MLE lglk increased to "+r+". sending "+c.length+" simulations");for(var s=0;s<c.length;s++){var $={result:c[s],sim_id:s},l={mtype:"inferenceresult",nodeId:e.nodeId,result:$};self.postMessage(l,void 0)}}}function Z(e,t){if(null!=e.task&&"Parse"==e.task.task_type)throw"this model is designed for parsing only";!function(e,t){k(e);var n=e.nodes[t],h={mtype:"node",node:n};self.postMessage(h,void 0);var r=l(e,n.top.name),i={mtype:"simtype",simtype:r.value_type};self.postMessage(i,void 0);var f=r.instances.map((function(e,t){return{id:t,crnName:n.top.name,instance:e}})),o={mtype:"instancedefinitions",nodeId:t,definitions:f};self.postMessage(o,void 0);for(var a=0;a<f.length;a++){var u=f[a],c=u.instance,s=j(u.id),$=x(u.id),m=K.now();switch(r.value_type){case"Float":if(L(n)){var g=U(u.id),I=J(n,c);d(n,I,s,g,F,k,N)}else C(e,n.top.name,c,s,F,N);break;case"MeanStdev":A(e,n.top.name,c,s,F,N);break;case"MeanStdevProbabilities":var v=Q(u.id),w=T(e,n.top.name,c,v,s,F,N),D={mtype:"probabilities",probabilities:{instance:u.instance,probabilities:w}};self.postMessage(D,void 0);break;case"Spatial1D":p(e,n.top.name,c,s,F,N);break;case"Spatial2D":_(e,n.top.name,c,s,F,N);break;case"MeanStdevTable":b(e,n.top.name,c,$,F,N)}var M=K.now();console.log("Simulation took "+(M-m)+" milliseconds")}}(e,t)}function V(e,t){var n=l(e,t),h={mtype:"simtype",simtype:n.value_type};self.postMessage(h,void 0);var r={mtype:"instancedefinitions",nodeId:t,definitions:n.instances.map((function(e,t){return{id:t,instance:e}}))};self.postMessage(r,void 0)}function H(e){var t="function"==typeof e.get_Message?e.get_Message():null==e.message?""+e:e.message;if(null!=e.errors){var n={mtype:"error",error:{message:t,positions:e.errors}};self.postMessage(n,void 0)}else{n={mtype:"error",error:{message:t}};self.postMessage(n,void 0)}}function q(e){var t,n,h,r,i,f,o,a,v=e.data;console.log("worker request: "+v.mtype);try{switch(v.mtype){case"parsecode":null==(a=v.code)&&(a=""),k(u(a));break;case"generateexports":!function(e,t){for(var n=0,h=c(!1,e,t);n<h.length;n++){F(h[n])}}(v.model,v.nodeId);break;case"generateexport":i=v.model,f=v.nodeId,o=v.id,F(s(i,f,o));break;case"simulategui":Z(v.model,v.nodeId);break;case"simulatesingle":!function(e,t,n){var h=l(e,t),r=n.instance,i=j(n.id),f=x(n.id),o=K.now();switch(h.value_type){case"Float":var a=e.nodes[t];if(L(a)){var u=U(n.id),c=J(a,r);d(a,c,i,u,F,k,N)}else C(e,t,r,i,F,N);break;case"MeanStdev":A(e,t,r,i,F,N);break;case"MeanStdevProbabilities":var s=Q(n.id),$=T(e,t,r,s,i,F,N),m={mtype:"probabilities",probabilities:{instance:n.instance,probabilities:$}};self.postMessage(m,void 0);break;case"Spatial1D":p(e,t,r,i,F,N);break;case"Spatial2D":_(e,t,r,i,F,N);break;case"MeanStdevTable":b(e,t,r,f,F,N)}var g=K.now();console.log("Simulation took "+(g-o)+" milliseconds")}(v.model,v.nodeId,v.definition);break;case"infergui":!function(e){if(null!=e.task&&"Parse"==e.task.task_type)throw"this model is designed for parsing only";for(var t in e.nodes)V(e,t);$(e,F,W,Y,N)}(v.model);break;case"getsimrunsgui":!function(e,t){if(null!=e.task&&"Parse"==e.task.task_type)throw"this model is designed for parsing only";var n={mtype:"node",node:e.nodes[t]};self.postMessage(n,void 0),V(e,t)}(v.model,v.nodeId);break;case"statespace":!function(e,t){if(null!=e.task&&"Parse"==e.task.task_type)throw"this model is designed for parsing only";var n=null;for(var h in e.nodes){n=e.nodes[h];break}if(t){var r=l(e,n.top.name).instances[0],i=J(n,r),f=I(i);Q()(f)}else{f=g(e);Q()(f)}}(v.model,v.jit);break;case"getprobabilitymap":t=v.probabilities,n=v.species,h=v.lowerBound,r={mtype:"probabilitymap",map:m(t,n,h)},self.postMessage(r,void 0);break;case"getcloudcapabilities":self.postMessage({mtype:"pools",account:"",pools:[]},void 0);break;case"synthesis":self.postMessage({mtype:"error",error:{message:"Synthesis not available for run-in-browser"}},void 0)}X()}catch(e){H(e)}}function z(e){null==P?v.processMessage(e):P.push(e)}self.addEventListener("message",z),v.loader=function(){var e=n(7);e=e.replace(/('|")use strict('|");?/,""),eval.call(null,e),w=Microsoft.Research.DNA.JSONAPI.user_parse,D=Microsoft.Research.DNA.JSONAPI.user_parse_oldsyntax,M=Microsoft.Research.DNA.JSONAPI.user_expand,y=Microsoft.Research.DNA.JSONAPI.user_compile,R=Microsoft.Research.DNA.JSONAPI.user_compile_oldsyntax,E=Microsoft.Research.DNA.JSAPI.is_jit,B=Microsoft.Research.DNA.JSAPI.is_classic,G=Microsoft.Research.DNA.JSAPI.get_jit_classic,S=Microsoft.Research.DNA.JSAPI.get_jit_rules,O=Microsoft.Research.DNA.JSONAPI.set_options},v.isJITfunc=function(e){return null!=te&&E(te.bundle)},v.getJITfunc=function(e,t){return B(te.bundle)?G(te.bundle):S(te.bundle)},v.processMessage=function(e){var t=e.data;console.log("worker request: "+t.mtype);try{switch(t.mtype){case"dsd.compile":!function(e,t){var n=t?R(e):y(e),h={nodes:{"":n},edges:{},expanded:!1};self.postMessage({mtype:"dsd.isjit",isJIT:!1},void 0);var r=ne(h);self.postMessage({mtype:"dsd.parseresult",result:{crn:n,settings:te.settings,code:r}},void 0)}(t.code,t.oldSyntax);break;case"dsd.parse":!function(e,t){var n=he(e,t);self.postMessage({mtype:"dsd.isjit",isJIT:E(te.bundle)},void 0);var h=ne(n);self.postMessage({mtype:"dsd.parseresult",result:{model:n,settings:te.settings,code:h}},void 0)}(t.code,t.oldSyntax);break;case"dsd.expand":!function(e,t,n,h){(function(e){return null!=ee&&e.code==ee.code&&e.specificities==ee.specificities&&e.toeholds==ee.toeholds})(e)&&null!=te||he(e,h);void 0!==te.settings.rulesProgram&&(n.rulesProgram=te.settings.rulesProgram);te=O(te,n);var r=E(te.bundle)?te.unexpanded:{nodes:{"":M(te.bundle)},edges:{},expanded:!1};null!=t.task&&(r.task=t.task);var i=null;for(var f in r.nodes){i=r.nodes[f];break}var o=null;for(var f in t.nodes){o=t.nodes[f];break}var a=null;for(var f in te.unexpanded.nodes){a=te.unexpanded.nodes[f];break}var u=o.top.settings.simulation.plots,c=a.top.settings.simulation.plots;if(function(e,t){if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!=t[n])return!1;return!0}(u,c)||!(u.length>0))for(var s in o.top.settings.simulation.plots=i.top.settings.simulation.plots,o.top.settings.simulations)o.top.settings.simulations[s].plots=i.top.settings.simulations[s].plots;i.top.settings=o.top.settings,self.postMessage({mtype:"dsd.isjit",isJIT:E(te.bundle)},void 0);var $=ne(r);self.postMessage({mtype:"dsd.parseresult",result:{model:r,settings:te.settings,code:$}},void 0)}(t.code,t.model,t.settings,t.oldSyntax);break;default:return void q(e)}X()}catch(e){H(e)}};var ee=null,te=null;function ne(e){return s(e,"","code").content[0]}function he(e,t){return ee=null,te=null,te=t?D(e):w(e),ee=e,te.unexpanded}}]);
//# sourceMappingURL=ClassicDSD.worker.d626340e28d14f759f85.js.map